slurm submission log: 2025-04-17 00:36:35.130348
created following sbatch script: 

###############################

#!/bin/bash

#SBATCH --account=nlp
#SBATCH --cpus-per-task=16
#SBATCH --gres=gpu:1
#SBATCH --job-name=askhan1-job-2797334
#SBATCH --mem=100G
#SBATCH --nodelist=jagupard39
#SBATCH --open-mode=append
#SBATCH --output=askhan1-job-2797334.out
#SBATCH --partition=jag-hi
#SBATCH --time=14-0

# activate your desired anaconda environment


# cd to working directory
cd .

# launch commands
srun --unbuffered run_as_child_processes './run.sh'

###############################

submission to slurm complete!


###############################
slurm submission output

Submitted batch job 10215713



###############################

###############################
start time: 2025-04-17 00:38:01.867720
machine: jagupard39
conda env: nemo
###############################
running following processes

	./run.sh


###############################
command outputs: 


INFO:speechbrain.utils.quirks:Applied quirks (see `speechbrain.utils.quirks`): [allow_tf32, disable_jit_profiling]
INFO:speechbrain.utils.quirks:Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
Using:
Manifest: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
CKPT: /nlp/scr/askhan1/train_ahmed_hf/checkpoints-noisy/ckpt-1.pt
vad_manifest_path: null.json


Manifest file found at: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
/nlp/scr/askhan1/miniconda3/envs/nemo/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py:1725: FutureWarning: The method `freeze_feature_extractor` is deprecated and will be removed in Transformers v5. Please use the equivalent `freeze_feature_encoder` method instead.
  warnings.warn(
VAD Model loaded and ready for inference.
  0%|          | 0/4 [00:00<?, ?it/s]Trying /nlp/scr/askhan1/clipped_umd/data/noisy/clipped/Longfellow-Block-2.wav

VAD Processing:   0%|          | 0/2400 [00:00<?, ?it/s][A
VAD Processing:   0%|          | 1/2400 [00:00<05:33,  7.20it/s][A
VAD Processing:   0%|          | 10/2400 [00:00<00:49, 48.17it/s][A
VAD Processing:   1%|          | 19/2400 [00:00<00:36, 64.49it/s][A
VAD Processing:   1%|          | 28/2400 [00:00<00:32, 72.89it/s][A
VAD Processing:   2%|▏         | 37/2400 [00:00<00:30, 77.78it/s][A
VAD Processing:   2%|▏         | 46/2400 [00:00<00:29, 80.82it/s][A
VAD Processing:   2%|▏         | 55/2400 [00:00<00:28, 82.81it/s][A
VAD Processing:   3%|▎         | 64/2400 [00:00<00:27, 84.09it/s][A
VAD Processing:   3%|▎         | 73/2400 [00:00<00:27, 84.36it/s][A
VAD Processing:   3%|▎         | 82/2400 [00:01<00:27, 85.12it/s][A
VAD Processing:   4%|▍         | 91/2400 [00:01<00:26, 85.67it/s][A
VAD Processing:   4%|▍         | 100/2400 [00:01<00:26, 86.06it/s][A
VAD Processing:   5%|▍         | 109/2400 [00:01<00:26, 86.23it/s][A
VAD Processing:   5%|▍         | 118/2400 [00:01<00:26, 86.34it/s][A
VAD Processing:   5%|▌         | 127/2400 [00:01<00:26, 86.52it/s][A
VAD Processing:   6%|▌         | 136/2400 [00:01<00:26, 86.65it/s][A
VAD Processing:   6%|▌         | 145/2400 [00:01<00:25, 86.73it/s][A
VAD Processing:   6%|▋         | 154/2400 [00:01<00:25, 86.79it/s][A
VAD Processing:   7%|▋         | 163/2400 [00:02<00:25, 86.80it/s][A
VAD Processing:   7%|▋         | 172/2400 [00:02<00:25, 86.82it/s][A
VAD Processing:   8%|▊         | 181/2400 [00:02<00:25, 86.82it/s][A
VAD Processing:   8%|▊         | 190/2400 [00:02<00:25, 86.84it/s][A
VAD Processing:   8%|▊         | 199/2400 [00:02<00:25, 86.85it/s][A
VAD Processing:   9%|▊         | 208/2400 [00:02<00:25, 86.84it/s][A
VAD Processing:   9%|▉         | 217/2400 [00:02<00:25, 86.82it/s][A
VAD Processing:   9%|▉         | 226/2400 [00:02<00:25, 86.81it/s][A
VAD Processing:  10%|▉         | 235/2400 [00:02<00:25, 86.25it/s][A
VAD Processing:  10%|█         | 244/2400 [00:02<00:24, 86.45it/s][A
VAD Processing:  11%|█         | 253/2400 [00:03<00:24, 86.55it/s][A
VAD Processing:  11%|█         | 262/2400 [00:03<00:24, 86.66it/s][A
VAD Processing:  11%|█▏        | 271/2400 [00:03<00:24, 86.70it/s][A
VAD Processing:  12%|█▏        | 280/2400 [00:03<00:24, 86.71it/s][A
VAD Processing:  12%|█▏        | 289/2400 [00:03<00:24, 86.81it/s][A
VAD Processing:  12%|█▏        | 298/2400 [00:03<00:24, 86.83it/s][A
VAD Processing:  13%|█▎        | 307/2400 [00:03<00:24, 86.83it/s][A
VAD Processing:  13%|█▎        | 316/2400 [00:03<00:24, 86.72it/s][A
VAD Processing:  14%|█▎        | 325/2400 [00:03<00:23, 86.87it/s][A
VAD Processing:  14%|█▍        | 334/2400 [00:03<00:23, 86.82it/s][A
VAD Processing:  14%|█▍        | 343/2400 [00:04<00:23, 86.89it/s][A
VAD Processing:  15%|█▍        | 352/2400 [00:04<00:23, 86.95it/s][A
VAD Processing:  15%|█▌        | 361/2400 [00:04<00:23, 87.00it/s][A
VAD Processing:  15%|█▌        | 370/2400 [00:04<00:23, 86.98it/s][A
VAD Processing:  16%|█▌        | 379/2400 [00:04<00:23, 87.00it/s][A
VAD Processing:  16%|█▌        | 388/2400 [00:04<00:23, 86.99it/s][A
VAD Processing:  17%|█▋        | 397/2400 [00:04<00:23, 86.61it/s][A
VAD Processing:  17%|█▋        | 406/2400 [00:04<00:23, 86.65it/s][A
VAD Processing:  17%|█▋        | 415/2400 [00:04<00:22, 86.76it/s][A
VAD Processing:  18%|█▊        | 424/2400 [00:05<00:22, 86.76it/s][A
VAD Processing:  18%|█▊        | 433/2400 [00:05<00:22, 86.82it/s][A
VAD Processing:  18%|█▊        | 442/2400 [00:05<00:22, 86.82it/s][A
VAD Processing:  19%|█▉        | 451/2400 [00:05<00:22, 86.90it/s][A
VAD Processing:  19%|█▉        | 460/2400 [00:05<00:22, 86.91it/s][A
VAD Processing:  20%|█▉        | 469/2400 [00:05<00:22, 86.93it/s][A
VAD Processing:  20%|█▉        | 478/2400 [00:05<00:22, 86.95it/s][A
VAD Processing:  20%|██        | 487/2400 [00:05<00:21, 86.99it/s][A
VAD Processing:  21%|██        | 496/2400 [00:05<00:21, 86.94it/s][A
VAD Processing:  21%|██        | 505/2400 [00:05<00:21, 86.96it/s][A
VAD Processing:  21%|██▏       | 514/2400 [00:06<00:21, 86.93it/s][A
VAD Processing:  22%|██▏       | 523/2400 [00:06<00:21, 86.93it/s][A
VAD Processing:  22%|██▏       | 532/2400 [00:06<00:21, 86.93it/s][A
VAD Processing:  23%|██▎       | 541/2400 [00:06<00:21, 86.95it/s][A
VAD Processing:  23%|██▎       | 550/2400 [00:06<00:21, 86.95it/s][A
VAD Processing:  23%|██▎       | 559/2400 [00:06<00:21, 86.67it/s][A
VAD Processing:  24%|██▎       | 568/2400 [00:06<00:21, 86.76it/s][A
VAD Processing:  24%|██▍       | 577/2400 [00:06<00:20, 86.86it/s][A
VAD Processing:  24%|██▍       | 586/2400 [00:06<00:20, 86.97it/s][A
VAD Processing:  25%|██▍       | 595/2400 [00:06<00:20, 86.97it/s][A
VAD Processing:  25%|██▌       | 604/2400 [00:07<00:20, 86.12it/s][A
VAD Processing:  26%|██▌       | 613/2400 [00:07<00:20, 86.29it/s][A
VAD Processing:  26%|██▌       | 622/2400 [00:07<00:20, 86.43it/s][A
VAD Processing:  26%|██▋       | 631/2400 [00:07<00:20, 86.55it/s][A
VAD Processing:  27%|██▋       | 640/2400 [00:07<00:20, 86.60it/s][A
VAD Processing:  27%|██▋       | 649/2400 [00:07<00:20, 86.70it/s][A
VAD Processing:  27%|██▋       | 658/2400 [00:07<00:20, 86.73it/s][A
VAD Processing:  28%|██▊       | 667/2400 [00:07<00:19, 86.82it/s][A
VAD Processing:  28%|██▊       | 676/2400 [00:07<00:19, 86.84it/s][A
VAD Processing:  29%|██▊       | 685/2400 [00:08<00:19, 86.82it/s][A
VAD Processing:  29%|██▉       | 694/2400 [00:08<00:19, 86.85it/s][A
VAD Processing:  29%|██▉       | 703/2400 [00:08<00:19, 86.85it/s][A
VAD Processing:  30%|██▉       | 712/2400 [00:08<00:19, 86.78it/s][A
VAD Processing:  30%|███       | 721/2400 [00:08<00:19, 86.92it/s][A
VAD Processing:  30%|███       | 730/2400 [00:08<00:19, 86.92it/s][A
VAD Processing:  31%|███       | 739/2400 [00:08<00:19, 86.87it/s][A
VAD Processing:  31%|███       | 748/2400 [00:08<00:19, 86.88it/s][A
VAD Processing:  32%|███▏      | 757/2400 [00:08<00:18, 86.87it/s][A
VAD Processing:  32%|███▏      | 766/2400 [00:08<00:18, 86.85it/s][A
VAD Processing:  32%|███▏      | 775/2400 [00:09<00:18, 86.89it/s][A
VAD Processing:  33%|███▎      | 784/2400 [00:09<00:18, 86.92it/s][A
VAD Processing:  33%|███▎      | 793/2400 [00:09<00:18, 86.94it/s][A
VAD Processing:  33%|███▎      | 802/2400 [00:09<00:18, 86.93it/s][A
VAD Processing:  34%|███▍      | 811/2400 [00:09<00:18, 86.96it/s][A
VAD Processing:  34%|███▍      | 820/2400 [00:09<00:18, 86.16it/s][A
VAD Processing:  35%|███▍      | 829/2400 [00:09<00:18, 86.33it/s][A
VAD Processing:  35%|███▍      | 838/2400 [00:09<00:18, 86.44it/s][A
VAD Processing:  35%|███▌      | 847/2400 [00:09<00:17, 86.58it/s][A
VAD Processing:  36%|███▌      | 856/2400 [00:09<00:17, 86.75it/s][A
VAD Processing:  36%|███▌      | 865/2400 [00:10<00:17, 86.75it/s][A
VAD Processing:  36%|███▋      | 874/2400 [00:10<00:17, 86.84it/s][A
VAD Processing:  37%|███▋      | 883/2400 [00:10<00:17, 86.83it/s][A
VAD Processing:  37%|███▋      | 892/2400 [00:10<00:17, 86.81it/s][A
VAD Processing:  38%|███▊      | 901/2400 [00:10<00:17, 86.82it/s][A
VAD Processing:  38%|███▊      | 910/2400 [00:10<00:17, 86.84it/s][A
VAD Processing:  38%|███▊      | 919/2400 [00:10<00:17, 86.89it/s][A
VAD Processing:  39%|███▊      | 928/2400 [00:10<00:16, 86.92it/s][A
VAD Processing:  39%|███▉      | 937/2400 [00:10<00:16, 86.90it/s][A
VAD Processing:  39%|███▉      | 946/2400 [00:11<00:16, 86.87it/s][A
VAD Processing:  40%|███▉      | 955/2400 [00:11<00:16, 86.87it/s][A
VAD Processing:  40%|████      | 964/2400 [00:11<00:16, 86.86it/s][A
VAD Processing:  41%|████      | 973/2400 [00:11<00:16, 86.88it/s][A
VAD Processing:  41%|████      | 982/2400 [00:11<00:16, 87.03it/s][A
VAD Processing:  41%|████▏     | 991/2400 [00:11<00:16, 86.99it/s][A
VAD Processing:  42%|████▏     | 1000/2400 [00:11<00:16, 86.95it/s][A
VAD Processing:  42%|████▏     | 1009/2400 [00:11<00:16, 86.93it/s][A
VAD Processing:  42%|████▏     | 1018/2400 [00:11<00:15, 86.98it/s][A
VAD Processing:  43%|████▎     | 1027/2400 [00:11<00:15, 86.47it/s][A
VAD Processing:  43%|████▎     | 1036/2400 [00:12<00:15, 86.56it/s][A
VAD Processing:  44%|████▎     | 1045/2400 [00:12<00:15, 86.65it/s][A
VAD Processing:  44%|████▍     | 1054/2400 [00:12<00:15, 86.71it/s][A
VAD Processing:  44%|████▍     | 1063/2400 [00:12<00:15, 86.79it/s][A
VAD Processing:  45%|████▍     | 1072/2400 [00:12<00:15, 86.77it/s][A
VAD Processing:  45%|████▌     | 1081/2400 [00:12<00:15, 86.75it/s][A
VAD Processing:  45%|████▌     | 1090/2400 [00:12<00:15, 86.73it/s][A
VAD Processing:  46%|████▌     | 1099/2400 [00:12<00:14, 86.78it/s][A
VAD Processing:  46%|████▌     | 1108/2400 [00:12<00:14, 86.77it/s][A
VAD Processing:  47%|████▋     | 1117/2400 [00:12<00:14, 86.76it/s][A
VAD Processing:  47%|████▋     | 1126/2400 [00:13<00:14, 86.78it/s][A
VAD Processing:  47%|████▋     | 1135/2400 [00:13<00:14, 86.81it/s][A
VAD Processing:  48%|████▊     | 1144/2400 [00:13<00:14, 86.90it/s][A
VAD Processing:  48%|████▊     | 1153/2400 [00:13<00:14, 86.96it/s][A
VAD Processing:  48%|████▊     | 1162/2400 [00:13<00:14, 86.99it/s][A
VAD Processing:  49%|████▉     | 1171/2400 [00:13<00:14, 86.97it/s][A
VAD Processing:  49%|████▉     | 1180/2400 [00:13<00:14, 86.95it/s][A
VAD Processing:  50%|████▉     | 1189/2400 [00:13<00:13, 86.94it/s][A
VAD Processing:  50%|████▉     | 1198/2400 [00:13<00:13, 86.93it/s][A
VAD Processing:  50%|█████     | 1207/2400 [00:14<00:13, 86.91it/s][A
VAD Processing:  51%|█████     | 1216/2400 [00:14<00:13, 86.82it/s][A
VAD Processing:  51%|█████     | 1225/2400 [00:14<00:13, 86.90it/s][A
VAD Processing:  51%|█████▏    | 1234/2400 [00:14<00:13, 86.91it/s][A
VAD Processing:  52%|█████▏    | 1243/2400 [00:14<00:13, 86.76it/s][A
VAD Processing:  52%|█████▏    | 1252/2400 [00:14<00:13, 86.82it/s][A
VAD Processing:  53%|█████▎    | 1261/2400 [00:14<00:13, 86.83it/s][A
VAD Processing:  53%|█████▎    | 1270/2400 [00:14<00:13, 86.85it/s][A
VAD Processing:  53%|█████▎    | 1279/2400 [00:14<00:12, 86.83it/s][A
VAD Processing:  54%|█████▎    | 1288/2400 [00:14<00:12, 86.86it/s][A
VAD Processing:  54%|█████▍    | 1297/2400 [00:15<00:12, 86.85it/s][A
VAD Processing:  54%|█████▍    | 1306/2400 [00:15<00:12, 86.86it/s][A
VAD Processing:  55%|█████▍    | 1315/2400 [00:15<00:12, 86.83it/s][A
VAD Processing:  55%|█████▌    | 1324/2400 [00:15<00:12, 86.83it/s][A
VAD Processing:  56%|█████▌    | 1333/2400 [00:15<00:12, 86.84it/s][A
VAD Processing:  56%|█████▌    | 1342/2400 [00:15<00:12, 86.83it/s][A
VAD Processing:  56%|█████▋    | 1351/2400 [00:15<00:12, 86.86it/s][A
VAD Processing:  57%|█████▋    | 1360/2400 [00:15<00:11, 86.80it/s][A
VAD Processing:  57%|█████▋    | 1369/2400 [00:15<00:11, 86.81it/s][A
VAD Processing:  57%|█████▋    | 1378/2400 [00:16<00:11, 86.75it/s][A
VAD Processing:  58%|█████▊    | 1387/2400 [00:16<00:11, 86.75it/s][A
VAD Processing:  58%|█████▊    | 1396/2400 [00:16<00:11, 86.77it/s][A
VAD Processing:  59%|█████▊    | 1405/2400 [00:16<00:11, 86.76it/s][A
VAD Processing:  59%|█████▉    | 1414/2400 [00:16<00:11, 86.72it/s][A
VAD Processing:  59%|█████▉    | 1423/2400 [00:16<00:11, 86.77it/s][A
VAD Processing:  60%|█████▉    | 1432/2400 [00:16<00:11, 86.79it/s][A
VAD Processing:  60%|██████    | 1441/2400 [00:16<00:11, 86.85it/s][A
VAD Processing:  60%|██████    | 1450/2400 [00:16<00:10, 86.86it/s][A
VAD Processing:  61%|██████    | 1459/2400 [00:16<00:10, 86.83it/s][A
VAD Processing:  61%|██████    | 1468/2400 [00:17<00:10, 86.83it/s][A
VAD Processing:  62%|██████▏   | 1477/2400 [00:17<00:10, 86.76it/s][A
VAD Processing:  62%|██████▏   | 1486/2400 [00:17<00:10, 86.78it/s][A
VAD Processing:  62%|██████▏   | 1495/2400 [00:17<00:10, 86.03it/s][A
VAD Processing:  63%|██████▎   | 1504/2400 [00:17<00:10, 86.25it/s][A
VAD Processing:  63%|██████▎   | 1513/2400 [00:17<00:10, 86.42it/s][A
VAD Processing:  63%|██████▎   | 1522/2400 [00:17<00:10, 86.55it/s][A
VAD Processing:  64%|██████▍   | 1531/2400 [00:17<00:10, 86.65it/s][A
VAD Processing:  64%|██████▍   | 1540/2400 [00:17<00:09, 86.68it/s][A
VAD Processing:  65%|██████▍   | 1549/2400 [00:17<00:09, 86.73it/s][A
VAD Processing:  65%|██████▍   | 1558/2400 [00:18<00:09, 86.75it/s][A
VAD Processing:  65%|██████▌   | 1567/2400 [00:18<00:09, 86.72it/s][A
VAD Processing:  66%|██████▌   | 1576/2400 [00:18<00:09, 86.75it/s][A
VAD Processing:  66%|██████▌   | 1585/2400 [00:18<00:09, 86.76it/s][A
VAD Processing:  66%|██████▋   | 1594/2400 [00:18<00:09, 86.77it/s][A
VAD Processing:  67%|██████▋   | 1603/2400 [00:18<00:09, 86.78it/s][A
VAD Processing:  67%|██████▋   | 1612/2400 [00:18<00:09, 86.77it/s][A
VAD Processing:  68%|██████▊   | 1621/2400 [00:18<00:08, 86.82it/s][A
VAD Processing:  68%|██████▊   | 1630/2400 [00:18<00:08, 86.84it/s][A
VAD Processing:  68%|██████▊   | 1639/2400 [00:19<00:08, 86.87it/s][A
VAD Processing:  69%|██████▊   | 1648/2400 [00:19<00:08, 86.88it/s][A
VAD Processing:  69%|██████▉   | 1657/2400 [00:19<00:08, 86.86it/s][A
VAD Processing:  69%|██████▉   | 1666/2400 [00:19<00:08, 86.96it/s][A
VAD Processing:  70%|██████▉   | 1675/2400 [00:19<00:08, 86.94it/s][A
VAD Processing:  70%|███████   | 1684/2400 [00:19<00:08, 86.92it/s][A
VAD Processing:  71%|███████   | 1693/2400 [00:19<00:08, 86.90it/s][A
VAD Processing:  71%|███████   | 1702/2400 [00:19<00:08, 86.90it/s][A
VAD Processing:  71%|███████▏  | 1711/2400 [00:19<00:07, 86.89it/s][A
VAD Processing:  72%|███████▏  | 1720/2400 [00:19<00:07, 86.86it/s][A
VAD Processing:  72%|███████▏  | 1729/2400 [00:20<00:07, 86.90it/s][A
VAD Processing:  72%|███████▏  | 1738/2400 [00:20<00:07, 86.92it/s][A
VAD Processing:  73%|███████▎  | 1747/2400 [00:20<00:07, 86.05it/s][A
VAD Processing:  73%|███████▎  | 1756/2400 [00:20<00:07, 86.28it/s][A
VAD Processing:  74%|███████▎  | 1765/2400 [00:20<00:07, 86.41it/s][A
VAD Processing:  74%|███████▍  | 1774/2400 [00:20<00:07, 86.40it/s][A
VAD Processing:  74%|███████▍  | 1783/2400 [00:20<00:07, 86.65it/s][A
VAD Processing:  75%|███████▍  | 1792/2400 [00:20<00:07, 86.68it/s][A
VAD Processing:  75%|███████▌  | 1801/2400 [00:20<00:06, 86.73it/s][A
VAD Processing:  75%|███████▌  | 1810/2400 [00:20<00:06, 86.73it/s][A
VAD Processing:  76%|███████▌  | 1819/2400 [00:21<00:06, 86.72it/s][A
VAD Processing:  76%|███████▌  | 1828/2400 [00:21<00:06, 86.76it/s][A
VAD Processing:  77%|███████▋  | 1837/2400 [00:21<00:06, 86.78it/s][A
VAD Processing:  77%|███████▋  | 1846/2400 [00:21<00:06, 86.83it/s][A
VAD Processing:  77%|███████▋  | 1855/2400 [00:21<00:06, 86.88it/s][A
VAD Processing:  78%|███████▊  | 1864/2400 [00:21<00:06, 86.86it/s][A
VAD Processing:  78%|███████▊  | 1873/2400 [00:21<00:06, 86.89it/s][A
VAD Processing:  78%|███████▊  | 1882/2400 [00:21<00:05, 86.88it/s][A
VAD Processing:  79%|███████▉  | 1891/2400 [00:21<00:05, 86.87it/s][A
VAD Processing:  79%|███████▉  | 1900/2400 [00:22<00:05, 86.19it/s][A
VAD Processing:  80%|███████▉  | 1909/2400 [00:22<00:05, 83.80it/s][A
VAD Processing:  80%|███████▉  | 1918/2400 [00:22<00:05, 81.32it/s][A
VAD Processing:  80%|████████  | 1927/2400 [00:22<00:05, 80.48it/s][A
VAD Processing:  81%|████████  | 1936/2400 [00:22<00:05, 79.63it/s][A
VAD Processing:  81%|████████  | 1944/2400 [00:22<00:05, 79.33it/s][A
VAD Processing:  81%|████████▏ | 1953/2400 [00:22<00:05, 79.75it/s][A
VAD Processing:  82%|████████▏ | 1962/2400 [00:22<00:05, 81.07it/s][A
VAD Processing:  82%|████████▏ | 1971/2400 [00:22<00:05, 82.96it/s][A
VAD Processing:  82%|████████▎ | 1980/2400 [00:23<00:04, 84.18it/s][A
VAD Processing:  83%|████████▎ | 1989/2400 [00:23<00:04, 83.81it/s][A
VAD Processing:  83%|████████▎ | 1998/2400 [00:23<00:04, 81.02it/s][A
VAD Processing:  84%|████████▎ | 2007/2400 [00:23<00:04, 80.75it/s][A
VAD Processing:  84%|████████▍ | 2016/2400 [00:23<00:04, 80.04it/s][A
VAD Processing:  84%|████████▍ | 2025/2400 [00:23<00:04, 80.10it/s][A
VAD Processing:  85%|████████▍ | 2034/2400 [00:23<00:04, 80.22it/s][A
VAD Processing:  85%|████████▌ | 2043/2400 [00:23<00:04, 80.27it/s][A
VAD Processing:  86%|████████▌ | 2052/2400 [00:23<00:04, 80.24it/s][A
VAD Processing:  86%|████████▌ | 2061/2400 [00:24<00:04, 79.15it/s][A
VAD Processing:  86%|████████▌ | 2069/2400 [00:24<00:04, 79.35it/s][A
VAD Processing:  87%|████████▋ | 2078/2400 [00:24<00:04, 79.68it/s][A
VAD Processing:  87%|████████▋ | 2086/2400 [00:24<00:03, 79.43it/s][A
VAD Processing:  87%|████████▋ | 2095/2400 [00:24<00:03, 79.70it/s][A
VAD Processing:  88%|████████▊ | 2104/2400 [00:24<00:03, 79.95it/s][A
VAD Processing:  88%|████████▊ | 2113/2400 [00:24<00:03, 80.09it/s][A
VAD Processing:  88%|████████▊ | 2122/2400 [00:24<00:03, 80.14it/s][A
VAD Processing:  89%|████████▉ | 2131/2400 [00:24<00:03, 80.22it/s][A
VAD Processing:  89%|████████▉ | 2140/2400 [00:25<00:03, 80.27it/s][A
VAD Processing:  90%|████████▉ | 2149/2400 [00:25<00:03, 80.28it/s][A
VAD Processing:  90%|████████▉ | 2158/2400 [00:25<00:03, 80.31it/s][A
VAD Processing:  90%|█████████ | 2167/2400 [00:25<00:02, 80.36it/s][A
VAD Processing:  91%|█████████ | 2176/2400 [00:25<00:02, 80.38it/s][A
VAD Processing:  91%|█████████ | 2185/2400 [00:25<00:02, 80.32it/s][A
VAD Processing:  91%|█████████▏| 2194/2400 [00:25<00:02, 81.74it/s][A
VAD Processing:  92%|█████████▏| 2203/2400 [00:25<00:02, 83.16it/s][A
VAD Processing:  92%|█████████▏| 2212/2400 [00:25<00:02, 84.14it/s][A
VAD Processing:  93%|█████████▎| 2221/2400 [00:25<00:02, 84.81it/s][A
VAD Processing:  93%|█████████▎| 2230/2400 [00:26<00:01, 85.39it/s][A
VAD Processing:  93%|█████████▎| 2239/2400 [00:26<00:01, 85.76it/s][A
VAD Processing:  94%|█████████▎| 2248/2400 [00:26<00:01, 86.05it/s][A
VAD Processing:  94%|█████████▍| 2257/2400 [00:26<00:01, 86.23it/s][A
VAD Processing:  94%|█████████▍| 2266/2400 [00:26<00:01, 86.36it/s][A
VAD Processing:  95%|█████████▍| 2275/2400 [00:26<00:01, 86.47it/s][A
VAD Processing:  95%|█████████▌| 2284/2400 [00:26<00:01, 86.61it/s][A
VAD Processing:  96%|█████████▌| 2293/2400 [00:26<00:01, 86.77it/s][A
VAD Processing:  96%|█████████▌| 2302/2400 [00:26<00:01, 86.79it/s][A
VAD Processing:  96%|█████████▋| 2311/2400 [00:27<00:01, 86.76it/s][A
VAD Processing:  97%|█████████▋| 2320/2400 [00:27<00:00, 84.54it/s][A
VAD Processing:  97%|█████████▋| 2329/2400 [00:27<00:00, 82.59it/s][A
VAD Processing:  97%|█████████▋| 2338/2400 [00:27<00:00, 81.51it/s][A
VAD Processing:  98%|█████████▊| 2347/2400 [00:27<00:00, 81.94it/s][A
VAD Processing:  98%|█████████▊| 2356/2400 [00:27<00:00, 83.36it/s][A
VAD Processing:  99%|█████████▊| 2365/2400 [00:27<00:00, 83.61it/s][A
VAD Processing:  99%|█████████▉| 2374/2400 [00:27<00:00, 81.96it/s][A
VAD Processing:  99%|█████████▉| 2383/2400 [00:27<00:00, 81.06it/s][A
VAD Processing: 100%|█████████▉| 2392/2400 [00:28<00:00, 80.45it/s][AVAD Processing: 100%|██████████| 2400/2400 [00:28<00:00, 85.29it/s]
Saving frames in vad_output_frames/Longfellow-Block-2.frame
 25%|██▌       | 1/4 [00:52<02:37, 52.37s/it]Trying /nlp/scr/askhan1/clipped_umd/data/noisy/clipped/Harker-ES.wav

VAD Processing:   0%|          | 0/11511 [00:00<?, ?it/s][A
VAD Processing:   0%|          | 9/11511 [00:00<02:15, 85.07it/s][A
VAD Processing:   0%|          | 18/11511 [00:00<02:15, 84.69it/s][A
VAD Processing:   0%|          | 27/11511 [00:00<02:15, 84.80it/s][A
VAD Processing:   0%|          | 36/11511 [00:00<02:15, 84.94it/s][A
VAD Processing:   0%|          | 45/11511 [00:00<02:14, 84.96it/s][A
VAD Processing:   0%|          | 54/11511 [00:00<02:14, 84.90it/s][A
VAD Processing:   1%|          | 63/11511 [00:00<02:14, 84.91it/s][A
VAD Processing:   1%|          | 72/11511 [00:00<02:14, 84.90it/s][A
VAD Processing:   1%|          | 81/11511 [00:00<02:14, 84.87it/s][A
VAD Processing:   1%|          | 90/11511 [00:01<02:14, 84.83it/s][A
VAD Processing:   1%|          | 99/11511 [00:01<02:14, 84.83it/s][A
VAD Processing:   1%|          | 108/11511 [00:01<02:14, 84.86it/s][A
VAD Processing:   1%|          | 117/11511 [00:01<02:14, 84.85it/s][A
VAD Processing:   1%|          | 126/11511 [00:01<02:14, 84.85it/s][A
VAD Processing:   1%|          | 135/11511 [00:01<02:14, 84.86it/s][A
VAD Processing:   1%|▏         | 144/11511 [00:01<02:13, 84.88it/s][A
VAD Processing:   1%|▏         | 153/11511 [00:01<02:13, 84.90it/s][A
VAD Processing:   1%|▏         | 162/11511 [00:01<02:13, 84.79it/s][A
VAD Processing:   1%|▏         | 171/11511 [00:02<02:13, 84.93it/s][A
VAD Processing:   2%|▏         | 180/11511 [00:02<02:13, 84.84it/s][A
VAD Processing:   2%|▏         | 189/11511 [00:02<02:13, 84.86it/s][A
VAD Processing:   2%|▏         | 198/11511 [00:02<02:13, 84.87it/s][A
VAD Processing:   2%|▏         | 207/11511 [00:02<02:13, 84.83it/s][A
VAD Processing:   2%|▏         | 216/11511 [00:02<02:13, 84.86it/s][A
VAD Processing:   2%|▏         | 225/11511 [00:02<02:12, 84.86it/s][A
VAD Processing:   2%|▏         | 234/11511 [00:02<02:12, 84.86it/s][A
VAD Processing:   2%|▏         | 243/11511 [00:02<02:12, 84.90it/s][A
VAD Processing:   2%|▏         | 252/11511 [00:02<02:12, 84.88it/s][A
VAD Processing:   2%|▏         | 261/11511 [00:03<02:12, 84.89it/s][A
VAD Processing:   2%|▏         | 270/11511 [00:03<02:12, 84.86it/s][A
VAD Processing:   2%|▏         | 279/11511 [00:03<02:12, 84.87it/s][A
VAD Processing:   3%|▎         | 288/11511 [00:03<02:12, 84.79it/s][A
VAD Processing:   3%|▎         | 297/11511 [00:03<02:12, 84.77it/s][A
VAD Processing:   3%|▎         | 306/11511 [00:03<02:12, 84.59it/s][A
VAD Processing:   3%|▎         | 315/11511 [00:03<02:12, 84.69it/s][A
VAD Processing:   3%|▎         | 324/11511 [00:03<02:12, 84.72it/s][A
VAD Processing:   3%|▎         | 333/11511 [00:03<02:11, 84.76it/s][A
VAD Processing:   3%|▎         | 342/11511 [00:04<02:11, 84.80it/s][A
VAD Processing:   3%|▎         | 351/11511 [00:04<02:11, 84.78it/s][A
VAD Processing:   3%|▎         | 360/11511 [00:04<02:11, 84.80it/s][A
VAD Processing:   3%|▎         | 369/11511 [00:04<02:11, 84.85it/s][A
VAD Processing:   3%|▎         | 378/11511 [00:04<02:11, 84.86it/s][A
VAD Processing:   3%|▎         | 387/11511 [00:04<02:11, 84.87it/s][A
VAD Processing:   3%|▎         | 396/11511 [00:04<02:11, 84.84it/s][A
VAD Processing:   4%|▎         | 405/11511 [00:04<02:10, 84.81it/s][A
VAD Processing:   4%|▎         | 414/11511 [00:04<02:10, 84.83it/s][A
VAD Processing:   4%|▎         | 423/11511 [00:04<02:10, 84.89it/s][A
VAD Processing:   4%|▍         | 432/11511 [00:05<02:10, 84.82it/s][A
VAD Processing:   4%|▍         | 441/11511 [00:05<02:10, 84.86it/s][A
VAD Processing:   4%|▍         | 450/11511 [00:05<02:10, 84.89it/s][A
VAD Processing:   4%|▍         | 459/11511 [00:05<02:10, 84.84it/s][A
VAD Processing:   4%|▍         | 468/11511 [00:05<02:10, 84.91it/s][A
VAD Processing:   4%|▍         | 477/11511 [00:05<02:09, 84.89it/s][A
VAD Processing:   4%|▍         | 486/11511 [00:05<02:09, 84.93it/s][A
VAD Processing:   4%|▍         | 495/11511 [00:05<02:09, 84.99it/s][A
VAD Processing:   4%|▍         | 504/11511 [00:05<02:09, 84.95it/s][A
VAD Processing:   4%|▍         | 513/11511 [00:06<02:09, 84.93it/s][A
VAD Processing:   5%|▍         | 522/11511 [00:06<02:09, 84.90it/s][A
VAD Processing:   5%|▍         | 531/11511 [00:06<02:09, 84.95it/s][A
VAD Processing:   5%|▍         | 540/11511 [00:06<02:09, 84.98it/s][A
VAD Processing:   5%|▍         | 549/11511 [00:06<02:09, 84.55it/s][A
VAD Processing:   5%|▍         | 558/11511 [00:06<02:09, 84.60it/s][A
VAD Processing:   5%|▍         | 567/11511 [00:06<02:09, 84.69it/s][A
VAD Processing:   5%|▌         | 576/11511 [00:06<02:09, 84.75it/s][A
VAD Processing:   5%|▌         | 585/11511 [00:06<02:08, 84.81it/s][A
VAD Processing:   5%|▌         | 594/11511 [00:07<02:08, 84.84it/s][A
VAD Processing:   5%|▌         | 603/11511 [00:07<02:08, 84.78it/s][A
VAD Processing:   5%|▌         | 612/11511 [00:07<02:08, 84.76it/s][A
VAD Processing:   5%|▌         | 621/11511 [00:07<02:08, 84.82it/s][A
VAD Processing:   5%|▌         | 630/11511 [00:07<02:08, 84.84it/s][A
VAD Processing:   6%|▌         | 639/11511 [00:07<02:08, 84.78it/s][A
VAD Processing:   6%|▌         | 648/11511 [00:07<02:08, 84.79it/s][A
VAD Processing:   6%|▌         | 657/11511 [00:07<02:07, 84.86it/s][A
VAD Processing:   6%|▌         | 666/11511 [00:07<02:07, 84.87it/s][A
VAD Processing:   6%|▌         | 675/11511 [00:07<02:07, 84.86it/s][A
VAD Processing:   6%|▌         | 684/11511 [00:08<02:07, 84.86it/s][A
VAD Processing:   6%|▌         | 693/11511 [00:08<02:07, 84.84it/s][A
VAD Processing:   6%|▌         | 702/11511 [00:08<02:07, 84.78it/s][A
VAD Processing:   6%|▌         | 711/11511 [00:08<02:07, 84.77it/s][A
VAD Processing:   6%|▋         | 720/11511 [00:08<02:07, 84.77it/s][A
VAD Processing:   6%|▋         | 729/11511 [00:08<02:06, 85.23it/s][A
VAD Processing:   6%|▋         | 738/11511 [00:08<02:06, 85.19it/s][A
VAD Processing:   6%|▋         | 747/11511 [00:08<02:06, 85.11it/s][A
VAD Processing:   7%|▋         | 756/11511 [00:08<02:06, 85.05it/s][A
VAD Processing:   7%|▋         | 765/11511 [00:09<02:06, 85.06it/s][A
VAD Processing:   7%|▋         | 774/11511 [00:09<02:06, 85.04it/s][A
VAD Processing:   7%|▋         | 783/11511 [00:09<02:06, 85.02it/s][A
VAD Processing:   7%|▋         | 792/11511 [00:09<02:06, 84.95it/s][A
VAD Processing:   7%|▋         | 801/11511 [00:09<02:06, 84.93it/s][A
VAD Processing:   7%|▋         | 810/11511 [00:09<02:06, 84.91it/s][A
VAD Processing:   7%|▋         | 819/11511 [00:09<02:05, 84.90it/s][A
VAD Processing:   7%|▋         | 828/11511 [00:09<02:05, 84.92it/s][A
VAD Processing:   7%|▋         | 837/11511 [00:09<02:06, 84.46it/s][A
VAD Processing:   7%|▋         | 846/11511 [00:09<02:06, 84.55it/s][A
VAD Processing:   7%|▋         | 855/11511 [00:10<02:05, 84.67it/s][A
VAD Processing:   8%|▊         | 864/11511 [00:10<02:05, 84.76it/s][A
VAD Processing:   8%|▊         | 873/11511 [00:10<02:05, 84.73it/s][A
VAD Processing:   8%|▊         | 882/11511 [00:10<02:05, 84.85it/s][A
VAD Processing:   8%|▊         | 891/11511 [00:10<02:05, 84.82it/s][A
VAD Processing:   8%|▊         | 900/11511 [00:10<02:05, 84.79it/s][A
VAD Processing:   8%|▊         | 909/11511 [00:10<02:05, 84.81it/s][A
VAD Processing:   8%|▊         | 918/11511 [00:10<02:04, 84.86it/s][A
VAD Processing:   8%|▊         | 927/11511 [00:10<02:04, 84.82it/s][A
VAD Processing:   8%|▊         | 936/11511 [00:11<02:04, 84.81it/s][A
VAD Processing:   8%|▊         | 945/11511 [00:11<02:04, 84.86it/s][A
VAD Processing:   8%|▊         | 954/11511 [00:11<02:04, 84.83it/s][A
VAD Processing:   8%|▊         | 963/11511 [00:11<02:04, 84.84it/s][A
VAD Processing:   8%|▊         | 972/11511 [00:11<02:03, 85.43it/s][A
VAD Processing:   9%|▊         | 981/11511 [00:11<02:03, 85.25it/s][A
VAD Processing:   9%|▊         | 990/11511 [00:11<02:03, 85.27it/s][A
VAD Processing:   9%|▊         | 999/11511 [00:11<02:03, 85.16it/s][A
VAD Processing:   9%|▉         | 1008/11511 [00:11<02:03, 85.09it/s][A
VAD Processing:   9%|▉         | 1017/11511 [00:11<02:03, 85.05it/s][A
VAD Processing:   9%|▉         | 1026/11511 [00:12<02:03, 84.99it/s][A
VAD Processing:   9%|▉         | 1035/11511 [00:12<02:03, 84.96it/s][A
VAD Processing:   9%|▉         | 1044/11511 [00:12<02:03, 84.95it/s][A
VAD Processing:   9%|▉         | 1053/11511 [00:12<02:03, 84.92it/s][A
VAD Processing:   9%|▉         | 1062/11511 [00:12<02:02, 85.61it/s][A
VAD Processing:   9%|▉         | 1071/11511 [00:12<02:01, 86.20it/s][A
VAD Processing:   9%|▉         | 1080/11511 [00:12<02:00, 86.38it/s][A
VAD Processing:   9%|▉         | 1089/11511 [00:12<02:00, 86.34it/s][A
VAD Processing:  10%|▉         | 1098/11511 [00:12<02:00, 86.52it/s][A
VAD Processing:  10%|▉         | 1107/11511 [00:13<02:00, 86.67it/s][A
VAD Processing:  10%|▉         | 1116/11511 [00:13<01:59, 86.91it/s][A
VAD Processing:  10%|▉         | 1125/11511 [00:13<01:59, 87.18it/s][A
VAD Processing:  10%|▉         | 1134/11511 [00:13<01:58, 87.27it/s][A
VAD Processing:  10%|▉         | 1143/11511 [00:13<01:59, 86.55it/s][A
VAD Processing:  10%|█         | 1152/11511 [00:13<01:59, 86.87it/s][A
VAD Processing:  10%|█         | 1161/11511 [00:13<01:58, 87.09it/s][A
VAD Processing:  10%|█         | 1170/11511 [00:13<01:58, 87.35it/s][A
VAD Processing:  10%|█         | 1179/11511 [00:13<01:58, 87.39it/s][A
VAD Processing:  10%|█         | 1188/11511 [00:13<01:58, 87.47it/s][A
VAD Processing:  10%|█         | 1197/11511 [00:14<01:57, 87.58it/s][A
VAD Processing:  10%|█         | 1206/11511 [00:14<01:57, 87.55it/s][A
VAD Processing:  11%|█         | 1215/11511 [00:14<01:57, 87.57it/s][A
VAD Processing:  11%|█         | 1224/11511 [00:14<01:57, 87.60it/s][A
VAD Processing:  11%|█         | 1233/11511 [00:14<01:57, 87.61it/s][A
VAD Processing:  11%|█         | 1242/11511 [00:14<01:57, 87.48it/s][A
VAD Processing:  11%|█         | 1251/11511 [00:14<01:57, 87.38it/s][A
VAD Processing:  11%|█         | 1260/11511 [00:14<01:57, 87.50it/s][A
VAD Processing:  11%|█         | 1269/11511 [00:14<01:57, 87.42it/s][A
VAD Processing:  11%|█         | 1278/11511 [00:14<01:56, 87.49it/s][A
VAD Processing:  11%|█         | 1287/11511 [00:15<01:56, 87.52it/s][A
VAD Processing:  11%|█▏        | 1296/11511 [00:15<01:56, 87.59it/s][A
VAD Processing:  11%|█▏        | 1305/11511 [00:15<01:56, 87.76it/s][A
VAD Processing:  11%|█▏        | 1314/11511 [00:15<01:56, 87.77it/s][A
VAD Processing:  11%|█▏        | 1323/11511 [00:15<01:56, 87.81it/s][A
VAD Processing:  12%|█▏        | 1332/11511 [00:15<01:56, 87.24it/s][A
VAD Processing:  12%|█▏        | 1341/11511 [00:15<01:57, 86.68it/s][A
VAD Processing:  12%|█▏        | 1350/11511 [00:15<01:57, 86.28it/s][A
VAD Processing:  12%|█▏        | 1359/11511 [00:15<01:57, 86.04it/s][A
VAD Processing:  12%|█▏        | 1368/11511 [00:16<01:58, 85.62it/s][A
VAD Processing:  12%|█▏        | 1377/11511 [00:16<01:58, 85.28it/s][A
VAD Processing:  12%|█▏        | 1386/11511 [00:16<01:58, 85.37it/s][A
VAD Processing:  12%|█▏        | 1395/11511 [00:16<01:58, 85.42it/s][A
VAD Processing:  12%|█▏        | 1404/11511 [00:16<01:58, 85.61it/s][A
VAD Processing:  12%|█▏        | 1413/11511 [00:16<01:57, 85.67it/s][A
VAD Processing:  12%|█▏        | 1422/11511 [00:16<01:57, 85.59it/s][A
VAD Processing:  12%|█▏        | 1431/11511 [00:16<01:57, 85.47it/s][A
VAD Processing:  13%|█▎        | 1440/11511 [00:16<01:57, 85.42it/s][A
VAD Processing:  13%|█▎        | 1449/11511 [00:16<01:57, 85.50it/s][A
VAD Processing:  13%|█▎        | 1458/11511 [00:17<01:57, 85.39it/s][A
VAD Processing:  13%|█▎        | 1467/11511 [00:17<01:57, 85.31it/s][A
VAD Processing:  13%|█▎        | 1476/11511 [00:17<01:57, 85.28it/s][A
VAD Processing:  13%|█▎        | 1485/11511 [00:17<01:57, 85.20it/s][A
VAD Processing:  13%|█▎        | 1494/11511 [00:17<01:57, 85.13it/s][A
VAD Processing:  13%|█▎        | 1503/11511 [00:17<01:57, 85.05it/s][A
VAD Processing:  13%|█▎        | 1512/11511 [00:17<01:57, 85.03it/s][A
VAD Processing:  13%|█▎        | 1521/11511 [00:17<01:57, 85.03it/s][A
VAD Processing:  13%|█▎        | 1530/11511 [00:17<01:57, 84.99it/s][A
VAD Processing:  13%|█▎        | 1539/11511 [00:18<01:57, 85.00it/s][A
VAD Processing:  13%|█▎        | 1548/11511 [00:18<01:57, 85.00it/s][A
VAD Processing:  14%|█▎        | 1557/11511 [00:18<01:57, 85.00it/s][A
VAD Processing:  14%|█▎        | 1566/11511 [00:18<01:57, 84.96it/s][A
VAD Processing:  14%|█▎        | 1575/11511 [00:18<01:56, 85.01it/s][A
VAD Processing:  14%|█▍        | 1584/11511 [00:18<01:56, 85.00it/s][A
VAD Processing:  14%|█▍        | 1593/11511 [00:18<01:56, 85.19it/s][A
VAD Processing:  14%|█▍        | 1602/11511 [00:18<01:56, 85.27it/s][A
VAD Processing:  14%|█▍        | 1611/11511 [00:18<01:56, 85.20it/s][A
VAD Processing:  14%|█▍        | 1620/11511 [00:18<01:56, 85.10it/s][A
VAD Processing:  14%|█▍        | 1629/11511 [00:19<01:56, 85.00it/s][A
VAD Processing:  14%|█▍        | 1638/11511 [00:19<01:56, 85.01it/s][A
VAD Processing:  14%|█▍        | 1647/11511 [00:19<01:55, 85.06it/s][A
VAD Processing:  14%|█▍        | 1656/11511 [00:19<01:55, 85.05it/s][A
VAD Processing:  14%|█▍        | 1665/11511 [00:19<01:55, 85.07it/s][A
VAD Processing:  15%|█▍        | 1674/11511 [00:19<01:55, 85.04it/s][A
VAD Processing:  15%|█▍        | 1683/11511 [00:19<01:55, 85.02it/s][A
VAD Processing:  15%|█▍        | 1692/11511 [00:19<01:55, 85.02it/s][A
VAD Processing:  15%|█▍        | 1701/11511 [00:19<01:55, 85.01it/s][A
VAD Processing:  15%|█▍        | 1710/11511 [00:20<01:55, 85.04it/s][A
VAD Processing:  15%|█▍        | 1719/11511 [00:20<01:54, 85.18it/s][A
VAD Processing:  15%|█▌        | 1728/11511 [00:20<01:54, 85.39it/s][A
VAD Processing:  15%|█▌        | 1737/11511 [00:20<01:54, 85.47it/s][A
VAD Processing:  15%|█▌        | 1746/11511 [00:20<01:54, 85.30it/s][A
VAD Processing:  15%|█▌        | 1755/11511 [00:20<01:54, 85.25it/s][A
VAD Processing:  15%|█▌        | 1764/11511 [00:20<01:54, 85.17it/s][A
VAD Processing:  15%|█▌        | 1773/11511 [00:20<01:54, 85.16it/s][A
VAD Processing:  15%|█▌        | 1782/11511 [00:20<01:54, 85.16it/s][A
VAD Processing:  16%|█▌        | 1791/11511 [00:20<01:53, 85.29it/s][A
VAD Processing:  16%|█▌        | 1800/11511 [00:21<01:54, 84.74it/s][A
VAD Processing:  16%|█▌        | 1809/11511 [00:21<01:54, 84.82it/s][A
VAD Processing:  16%|█▌        | 1818/11511 [00:21<01:53, 85.28it/s][A
VAD Processing:  16%|█▌        | 1827/11511 [00:21<01:53, 85.30it/s][A
VAD Processing:  16%|█▌        | 1836/11511 [00:21<01:53, 85.11it/s][A
VAD Processing:  16%|█▌        | 1845/11511 [00:21<01:53, 85.12it/s][A
VAD Processing:  16%|█▌        | 1854/11511 [00:21<01:53, 85.31it/s][A
VAD Processing:  16%|█▌        | 1863/11511 [00:21<01:53, 85.28it/s][A
VAD Processing:  16%|█▋        | 1872/11511 [00:21<01:53, 85.13it/s][A
VAD Processing:  16%|█▋        | 1881/11511 [00:22<01:53, 85.11it/s][A
VAD Processing:  16%|█▋        | 1890/11511 [00:22<01:53, 85.03it/s][A
VAD Processing:  16%|█▋        | 1899/11511 [00:22<01:53, 84.98it/s][A
VAD Processing:  17%|█▋        | 1908/11511 [00:22<01:53, 84.93it/s][A
VAD Processing:  17%|█▋        | 1917/11511 [00:22<01:52, 84.94it/s][A
VAD Processing:  17%|█▋        | 1926/11511 [00:22<01:52, 84.94it/s][A
VAD Processing:  17%|█▋        | 1935/11511 [00:22<01:52, 84.80it/s][A
VAD Processing:  17%|█▋        | 1944/11511 [00:22<01:52, 84.80it/s][A
VAD Processing:  17%|█▋        | 1953/11511 [00:22<01:52, 84.84it/s][A
VAD Processing:  17%|█▋        | 1962/11511 [00:23<01:52, 84.90it/s][A
VAD Processing:  17%|█▋        | 1971/11511 [00:23<01:52, 84.94it/s][A
VAD Processing:  17%|█▋        | 1980/11511 [00:23<01:52, 84.94it/s][A
VAD Processing:  17%|█▋        | 1989/11511 [00:23<01:51, 85.29it/s][A
VAD Processing:  17%|█▋        | 1998/11511 [00:23<01:51, 85.60it/s][A
VAD Processing:  17%|█▋        | 2007/11511 [00:23<01:50, 85.75it/s][A
VAD Processing:  18%|█▊        | 2016/11511 [00:23<01:50, 85.68it/s][A
VAD Processing:  18%|█▊        | 2025/11511 [00:23<01:50, 85.58it/s][A
VAD Processing:  18%|█▊        | 2034/11511 [00:23<01:51, 85.36it/s][A
VAD Processing:  18%|█▊        | 2043/11511 [00:23<01:51, 85.23it/s][A
VAD Processing:  18%|█▊        | 2052/11511 [00:24<01:50, 85.55it/s][A
VAD Processing:  18%|█▊        | 2061/11511 [00:24<01:50, 85.47it/s][A
VAD Processing:  18%|█▊        | 2070/11511 [00:24<01:50, 85.34it/s][A
VAD Processing:  18%|█▊        | 2079/11511 [00:24<01:50, 85.21it/s][A
VAD Processing:  18%|█▊        | 2088/11511 [00:24<01:50, 85.06it/s][A
VAD Processing:  18%|█▊        | 2097/11511 [00:24<01:50, 85.13it/s][A
VAD Processing:  18%|█▊        | 2106/11511 [00:24<01:50, 85.24it/s][A
VAD Processing:  18%|█▊        | 2115/11511 [00:24<01:50, 85.24it/s][A
VAD Processing:  18%|█▊        | 2124/11511 [00:24<01:50, 85.15it/s][A
VAD Processing:  19%|█▊        | 2133/11511 [00:25<01:50, 85.11it/s][A
VAD Processing:  19%|█▊        | 2142/11511 [00:25<01:50, 85.07it/s][A
VAD Processing:  19%|█▊        | 2151/11511 [00:25<01:49, 85.21it/s][A
VAD Processing:  19%|█▉        | 2160/11511 [00:25<01:50, 84.86it/s][A
VAD Processing:  19%|█▉        | 2169/11511 [00:25<01:49, 85.33it/s][A
VAD Processing:  19%|█▉        | 2178/11511 [00:25<01:49, 85.53it/s][A
VAD Processing:  19%|█▉        | 2187/11511 [00:25<01:48, 85.68it/s][A
VAD Processing:  19%|█▉        | 2196/11511 [00:25<01:48, 85.73it/s][A
VAD Processing:  19%|█▉        | 2205/11511 [00:25<01:48, 85.84it/s][A
VAD Processing:  19%|█▉        | 2214/11511 [00:25<01:47, 86.24it/s][A
VAD Processing:  19%|█▉        | 2223/11511 [00:26<01:47, 86.06it/s][A
VAD Processing:  19%|█▉        | 2232/11511 [00:26<01:48, 85.79it/s][A
VAD Processing:  19%|█▉        | 2241/11511 [00:26<01:48, 85.72it/s][A
VAD Processing:  20%|█▉        | 2250/11511 [00:26<01:47, 85.79it/s][A
VAD Processing:  20%|█▉        | 2259/11511 [00:26<01:47, 86.02it/s][A
VAD Processing:  20%|█▉        | 2268/11511 [00:26<01:47, 86.13it/s][A
VAD Processing:  20%|█▉        | 2277/11511 [00:26<01:47, 85.99it/s][A
VAD Processing:  20%|█▉        | 2286/11511 [00:26<01:47, 85.82it/s][A
VAD Processing:  20%|█▉        | 2295/11511 [00:26<01:47, 85.94it/s][A
VAD Processing:  20%|██        | 2304/11511 [00:26<01:47, 85.94it/s][A
VAD Processing:  20%|██        | 2313/11511 [00:27<01:46, 86.17it/s][A
VAD Processing:  20%|██        | 2322/11511 [00:27<01:47, 85.79it/s][A
VAD Processing:  20%|██        | 2331/11511 [00:27<01:47, 85.65it/s][A
VAD Processing:  20%|██        | 2340/11511 [00:27<01:47, 85.68it/s][A
VAD Processing:  20%|██        | 2349/11511 [00:27<01:47, 85.62it/s][A
VAD Processing:  20%|██        | 2358/11511 [00:27<01:46, 85.80it/s][A
VAD Processing:  21%|██        | 2367/11511 [00:27<01:46, 85.98it/s][A
VAD Processing:  21%|██        | 2376/11511 [00:27<01:46, 86.02it/s][A
VAD Processing:  21%|██        | 2385/11511 [00:27<01:45, 86.13it/s][A
VAD Processing:  21%|██        | 2394/11511 [00:28<01:45, 86.04it/s][A
VAD Processing:  21%|██        | 2403/11511 [00:28<01:46, 85.90it/s][A
VAD Processing:  21%|██        | 2412/11511 [00:28<01:46, 85.67it/s][A
VAD Processing:  21%|██        | 2421/11511 [00:28<01:46, 85.74it/s][A
VAD Processing:  21%|██        | 2430/11511 [00:28<01:45, 85.72it/s][A
VAD Processing:  21%|██        | 2439/11511 [00:28<01:46, 85.52it/s][A
VAD Processing:  21%|██▏       | 2448/11511 [00:28<01:46, 85.47it/s][A
VAD Processing:  21%|██▏       | 2457/11511 [00:28<01:45, 85.63it/s][A
VAD Processing:  21%|██▏       | 2466/11511 [00:28<01:45, 85.94it/s][A
VAD Processing:  22%|██▏       | 2475/11511 [00:28<01:44, 86.22it/s][A
VAD Processing:  22%|██▏       | 2484/11511 [00:29<01:44, 86.12it/s][A
VAD Processing:  22%|██▏       | 2493/11511 [00:29<01:45, 85.83it/s][A
VAD Processing:  22%|██▏       | 2502/11511 [00:29<01:44, 85.91it/s][A
VAD Processing:  22%|██▏       | 2511/11511 [00:29<01:44, 85.75it/s][A
VAD Processing:  22%|██▏       | 2520/11511 [00:29<01:45, 84.91it/s][A
VAD Processing:  22%|██▏       | 2529/11511 [00:29<01:45, 84.92it/s][A
VAD Processing:  22%|██▏       | 2538/11511 [00:29<01:45, 85.06it/s][A
VAD Processing:  22%|██▏       | 2547/11511 [00:29<01:45, 85.18it/s][A
VAD Processing:  22%|██▏       | 2556/11511 [00:29<01:45, 85.18it/s][A
VAD Processing:  22%|██▏       | 2565/11511 [00:30<01:44, 85.43it/s][A
VAD Processing:  22%|██▏       | 2574/11511 [00:30<01:44, 85.55it/s][A
VAD Processing:  22%|██▏       | 2583/11511 [00:30<01:44, 85.60it/s][A
VAD Processing:  23%|██▎       | 2592/11511 [00:30<01:44, 85.60it/s][A
VAD Processing:  23%|██▎       | 2601/11511 [00:30<01:44, 85.55it/s][A
VAD Processing:  23%|██▎       | 2610/11511 [00:30<01:44, 85.31it/s][A
VAD Processing:  23%|██▎       | 2619/11511 [00:30<01:43, 85.54it/s][A
VAD Processing:  23%|██▎       | 2628/11511 [00:30<01:43, 85.65it/s][A
VAD Processing:  23%|██▎       | 2637/11511 [00:30<01:43, 85.57it/s][A
VAD Processing:  23%|██▎       | 2646/11511 [00:30<01:43, 85.56it/s][A
VAD Processing:  23%|██▎       | 2655/11511 [00:31<01:43, 85.45it/s][A
VAD Processing:  23%|██▎       | 2664/11511 [00:31<01:43, 85.53it/s][A
VAD Processing:  23%|██▎       | 2673/11511 [00:31<01:42, 85.82it/s][A
VAD Processing:  23%|██▎       | 2682/11511 [00:31<01:42, 86.22it/s][A
VAD Processing:  23%|██▎       | 2691/11511 [00:31<01:42, 86.44it/s][A
VAD Processing:  23%|██▎       | 2700/11511 [00:31<01:42, 86.25it/s][A
VAD Processing:  24%|██▎       | 2709/11511 [00:31<01:42, 86.06it/s][A
VAD Processing:  24%|██▎       | 2718/11511 [00:31<01:42, 86.20it/s][A
VAD Processing:  24%|██▎       | 2727/11511 [00:31<01:41, 86.46it/s][A
VAD Processing:  24%|██▍       | 2736/11511 [00:32<01:41, 86.50it/s][A
VAD Processing:  24%|██▍       | 2745/11511 [00:32<01:41, 86.23it/s][A
VAD Processing:  24%|██▍       | 2754/11511 [00:32<01:42, 85.82it/s][A
VAD Processing:  24%|██▍       | 2763/11511 [00:32<01:41, 85.93it/s][A
VAD Processing:  24%|██▍       | 2772/11511 [00:32<01:41, 85.74it/s][A
VAD Processing:  24%|██▍       | 2781/11511 [00:32<01:42, 85.50it/s][A
VAD Processing:  24%|██▍       | 2790/11511 [00:32<01:42, 85.40it/s][A
VAD Processing:  24%|██▍       | 2799/11511 [00:32<01:42, 85.31it/s][A
VAD Processing:  24%|██▍       | 2808/11511 [00:32<01:41, 85.46it/s][A
VAD Processing:  24%|██▍       | 2817/11511 [00:32<01:41, 85.65it/s][A
VAD Processing:  25%|██▍       | 2826/11511 [00:33<01:41, 85.81it/s][A
VAD Processing:  25%|██▍       | 2835/11511 [00:33<01:41, 85.65it/s][A
VAD Processing:  25%|██▍       | 2844/11511 [00:33<01:41, 85.63it/s][A
VAD Processing:  25%|██▍       | 2853/11511 [00:33<01:41, 85.62it/s][A
VAD Processing:  25%|██▍       | 2862/11511 [00:33<01:41, 85.48it/s][A
VAD Processing:  25%|██▍       | 2871/11511 [00:33<01:41, 85.25it/s][A
VAD Processing:  25%|██▌       | 2880/11511 [00:33<01:41, 85.26it/s][A
VAD Processing:  25%|██▌       | 2889/11511 [00:33<01:40, 85.43it/s][A
VAD Processing:  25%|██▌       | 2898/11511 [00:33<01:40, 85.77it/s][A
VAD Processing:  25%|██▌       | 2907/11511 [00:34<01:39, 86.33it/s][A
VAD Processing:  25%|██▌       | 2916/11511 [00:34<01:39, 86.39it/s][A
VAD Processing:  25%|██▌       | 2925/11511 [00:34<01:39, 86.42it/s][A
VAD Processing:  25%|██▌       | 2934/11511 [00:34<01:39, 86.28it/s][A
VAD Processing:  26%|██▌       | 2943/11511 [00:34<01:39, 86.40it/s][A
VAD Processing:  26%|██▌       | 2952/11511 [00:34<01:39, 86.40it/s][A
VAD Processing:  26%|██▌       | 2961/11511 [00:34<01:39, 86.09it/s][A
VAD Processing:  26%|██▌       | 2970/11511 [00:34<01:39, 85.93it/s][A
VAD Processing:  26%|██▌       | 2979/11511 [00:34<01:39, 85.70it/s][A
VAD Processing:  26%|██▌       | 2988/11511 [00:34<01:39, 85.49it/s][A
VAD Processing:  26%|██▌       | 2997/11511 [00:35<01:39, 85.40it/s][A
VAD Processing:  26%|██▌       | 3006/11511 [00:35<01:39, 85.31it/s][A
VAD Processing:  26%|██▌       | 3015/11511 [00:35<01:39, 85.29it/s][A
VAD Processing:  26%|██▋       | 3024/11511 [00:35<01:39, 85.20it/s][A
VAD Processing:  26%|██▋       | 3033/11511 [00:35<01:39, 85.35it/s][A
VAD Processing:  26%|██▋       | 3042/11511 [00:35<01:38, 86.24it/s][A
VAD Processing:  27%|██▋       | 3051/11511 [00:35<01:37, 86.87it/s][A
VAD Processing:  27%|██▋       | 3060/11511 [00:35<01:37, 87.07it/s][A
VAD Processing:  27%|██▋       | 3069/11511 [00:35<01:36, 87.45it/s][A
VAD Processing:  27%|██▋       | 3078/11511 [00:36<01:36, 87.81it/s][A
VAD Processing:  27%|██▋       | 3087/11511 [00:36<01:36, 87.64it/s][A
VAD Processing:  27%|██▋       | 3096/11511 [00:36<01:36, 87.29it/s][A
VAD Processing:  27%|██▋       | 3105/11511 [00:36<01:36, 87.56it/s][A
VAD Processing:  27%|██▋       | 3114/11511 [00:36<01:35, 87.68it/s][A
VAD Processing:  27%|██▋       | 3123/11511 [00:36<01:35, 87.95it/s][A
VAD Processing:  27%|██▋       | 3132/11511 [00:36<01:35, 87.79it/s][A
VAD Processing:  27%|██▋       | 3141/11511 [00:36<01:35, 87.89it/s][A
VAD Processing:  27%|██▋       | 3150/11511 [00:36<01:35, 87.92it/s][A
VAD Processing:  27%|██▋       | 3159/11511 [00:36<01:35, 87.21it/s][A
VAD Processing:  28%|██▊       | 3168/11511 [00:37<01:36, 86.46it/s][A
VAD Processing:  28%|██▊       | 3177/11511 [00:37<01:36, 86.04it/s][A
VAD Processing:  28%|██▊       | 3186/11511 [00:37<01:37, 85.74it/s][A
VAD Processing:  28%|██▊       | 3195/11511 [00:37<01:37, 85.54it/s][A
VAD Processing:  28%|██▊       | 3204/11511 [00:37<01:37, 85.36it/s][A
VAD Processing:  28%|██▊       | 3213/11511 [00:37<01:37, 85.25it/s][A
VAD Processing:  28%|██▊       | 3222/11511 [00:37<01:37, 85.18it/s][A
VAD Processing:  28%|██▊       | 3231/11511 [00:37<01:37, 85.08it/s][A
VAD Processing:  28%|██▊       | 3240/11511 [00:37<01:37, 85.21it/s][A
VAD Processing:  28%|██▊       | 3249/11511 [00:37<01:36, 85.56it/s][A
VAD Processing:  28%|██▊       | 3258/11511 [00:38<01:36, 85.41it/s][A
VAD Processing:  28%|██▊       | 3267/11511 [00:38<01:36, 85.24it/s][A
VAD Processing:  28%|██▊       | 3276/11511 [00:38<01:36, 85.17it/s][A
VAD Processing:  29%|██▊       | 3285/11511 [00:38<01:36, 85.12it/s][A
VAD Processing:  29%|██▊       | 3294/11511 [00:38<01:36, 85.05it/s][A
VAD Processing:  29%|██▊       | 3303/11511 [00:38<01:36, 85.01it/s][A
VAD Processing:  29%|██▉       | 3312/11511 [00:38<01:37, 84.47it/s][A
VAD Processing:  29%|██▉       | 3321/11511 [00:38<01:36, 84.59it/s][A
VAD Processing:  29%|██▉       | 3330/11511 [00:38<01:36, 84.80it/s][A
VAD Processing:  29%|██▉       | 3339/11511 [00:39<01:36, 85.01it/s][A
VAD Processing:  29%|██▉       | 3348/11511 [00:39<01:36, 85.01it/s][A
VAD Processing:  29%|██▉       | 3357/11511 [00:39<01:35, 84.98it/s][A
VAD Processing:  29%|██▉       | 3366/11511 [00:39<01:35, 84.98it/s][A
VAD Processing:  29%|██▉       | 3375/11511 [00:39<01:35, 85.02it/s][A
VAD Processing:  29%|██▉       | 3384/11511 [00:39<01:34, 85.63it/s][A
VAD Processing:  29%|██▉       | 3393/11511 [00:39<01:34, 85.75it/s][A
VAD Processing:  30%|██▉       | 3402/11511 [00:39<01:34, 85.47it/s][A
VAD Processing:  30%|██▉       | 3411/11511 [00:39<01:34, 85.33it/s][A
VAD Processing:  30%|██▉       | 3420/11511 [00:40<01:34, 85.19it/s][A
VAD Processing:  30%|██▉       | 3429/11511 [00:40<01:34, 85.09it/s][A
VAD Processing:  30%|██▉       | 3438/11511 [00:40<01:34, 85.06it/s][A
VAD Processing:  30%|██▉       | 3447/11511 [00:40<01:34, 85.01it/s][A
VAD Processing:  30%|███       | 3456/11511 [00:40<01:34, 85.00it/s][A
VAD Processing:  30%|███       | 3465/11511 [00:40<01:34, 84.97it/s][A
VAD Processing:  30%|███       | 3474/11511 [00:40<01:34, 84.97it/s][A
VAD Processing:  30%|███       | 3483/11511 [00:40<01:34, 84.99it/s][A
VAD Processing:  30%|███       | 3492/11511 [00:40<01:34, 84.95it/s][A
VAD Processing:  30%|███       | 3501/11511 [00:40<01:34, 84.95it/s][A
VAD Processing:  30%|███       | 3510/11511 [00:41<01:34, 84.94it/s][A
VAD Processing:  31%|███       | 3519/11511 [00:41<01:34, 84.96it/s][A
VAD Processing:  31%|███       | 3528/11511 [00:41<01:33, 84.96it/s][A
VAD Processing:  31%|███       | 3537/11511 [00:41<01:33, 84.97it/s][A
VAD Processing:  31%|███       | 3546/11511 [00:41<01:33, 84.95it/s][A
VAD Processing:  31%|███       | 3555/11511 [00:41<01:33, 84.94it/s][A
VAD Processing:  31%|███       | 3564/11511 [00:41<01:33, 84.94it/s][A
VAD Processing:  31%|███       | 3573/11511 [00:41<01:33, 84.96it/s][A
VAD Processing:  31%|███       | 3582/11511 [00:41<01:33, 85.00it/s][A
VAD Processing:  31%|███       | 3591/11511 [00:42<01:33, 85.00it/s][A
VAD Processing:  31%|███▏      | 3600/11511 [00:42<01:33, 84.99it/s][A
VAD Processing:  31%|███▏      | 3609/11511 [00:42<01:32, 85.02it/s][A
VAD Processing:  31%|███▏      | 3618/11511 [00:42<01:32, 85.03it/s][A
VAD Processing:  32%|███▏      | 3627/11511 [00:42<01:32, 85.00it/s][A
VAD Processing:  32%|███▏      | 3636/11511 [00:42<01:32, 85.00it/s][A
VAD Processing:  32%|███▏      | 3645/11511 [00:42<01:32, 85.02it/s][A
VAD Processing:  32%|███▏      | 3654/11511 [00:42<01:32, 85.09it/s][A
VAD Processing:  32%|███▏      | 3663/11511 [00:42<01:32, 85.05it/s][A
VAD Processing:  32%|███▏      | 3672/11511 [00:42<01:32, 85.01it/s][A
VAD Processing:  32%|███▏      | 3681/11511 [00:43<01:32, 85.05it/s][A
VAD Processing:  32%|███▏      | 3690/11511 [00:43<01:31, 85.03it/s][A
VAD Processing:  32%|███▏      | 3699/11511 [00:43<01:31, 85.03it/s][A
VAD Processing:  32%|███▏      | 3708/11511 [00:43<01:31, 85.00it/s][A
VAD Processing:  32%|███▏      | 3717/11511 [00:43<01:31, 85.04it/s][A
VAD Processing:  32%|███▏      | 3726/11511 [00:43<01:31, 85.01it/s][A
VAD Processing:  32%|███▏      | 3735/11511 [00:43<01:32, 84.31it/s][A
VAD Processing:  33%|███▎      | 3744/11511 [00:43<01:31, 84.53it/s][A
VAD Processing:  33%|███▎      | 3753/11511 [00:43<01:31, 84.77it/s][A
VAD Processing:  33%|███▎      | 3762/11511 [00:44<01:31, 84.82it/s][A
VAD Processing:  33%|███▎      | 3771/11511 [00:44<01:31, 84.88it/s][A
VAD Processing:  33%|███▎      | 3780/11511 [00:44<01:30, 84.96it/s][A
VAD Processing:  33%|███▎      | 3789/11511 [00:44<01:30, 85.01it/s][A
VAD Processing:  33%|███▎      | 3798/11511 [00:44<01:30, 85.00it/s][A
VAD Processing:  33%|███▎      | 3807/11511 [00:44<01:30, 84.99it/s][A
VAD Processing:  33%|███▎      | 3816/11511 [00:44<01:30, 84.96it/s][A
VAD Processing:  33%|███▎      | 3825/11511 [00:44<01:30, 84.98it/s][A
VAD Processing:  33%|███▎      | 3834/11511 [00:44<01:30, 84.99it/s][A
VAD Processing:  33%|███▎      | 3843/11511 [00:44<01:30, 85.03it/s][A
VAD Processing:  33%|███▎      | 3852/11511 [00:45<01:30, 84.98it/s][A
VAD Processing:  34%|███▎      | 3861/11511 [00:45<01:29, 85.00it/s][A
VAD Processing:  34%|███▎      | 3870/11511 [00:45<01:29, 85.00it/s][A
VAD Processing:  34%|███▎      | 3879/11511 [00:45<01:29, 85.03it/s][A
VAD Processing:  34%|███▍      | 3888/11511 [00:45<01:29, 85.04it/s][A
VAD Processing:  34%|███▍      | 3897/11511 [00:45<01:29, 84.95it/s][A
VAD Processing:  34%|███▍      | 3906/11511 [00:45<01:29, 85.00it/s][A
VAD Processing:  34%|███▍      | 3915/11511 [00:45<01:29, 85.01it/s][A
VAD Processing:  34%|███▍      | 3924/11511 [00:45<01:29, 85.00it/s][A
VAD Processing:  34%|███▍      | 3933/11511 [00:46<01:29, 85.01it/s][A
VAD Processing:  34%|███▍      | 3942/11511 [00:46<01:29, 85.00it/s][A
VAD Processing:  34%|███▍      | 3951/11511 [00:46<01:28, 85.00it/s][A
VAD Processing:  34%|███▍      | 3960/11511 [00:46<01:28, 84.98it/s][A
VAD Processing:  34%|███▍      | 3969/11511 [00:46<01:28, 84.95it/s][A
VAD Processing:  35%|███▍      | 3978/11511 [00:46<01:28, 84.97it/s][A
VAD Processing:  35%|███▍      | 3987/11511 [00:46<01:28, 84.94it/s][A
VAD Processing:  35%|███▍      | 3996/11511 [00:46<01:28, 84.91it/s][A
VAD Processing:  35%|███▍      | 4005/11511 [00:46<01:28, 84.93it/s][A
VAD Processing:  35%|███▍      | 4014/11511 [00:46<01:28, 84.92it/s][A
VAD Processing:  35%|███▍      | 4023/11511 [00:47<01:28, 84.95it/s][A
VAD Processing:  35%|███▌      | 4032/11511 [00:47<01:28, 84.95it/s][A
VAD Processing:  35%|███▌      | 4041/11511 [00:47<01:27, 85.01it/s][A
VAD Processing:  35%|███▌      | 4050/11511 [00:47<01:27, 85.02it/s][A
VAD Processing:  35%|███▌      | 4059/11511 [00:47<01:27, 85.02it/s][A
VAD Processing:  35%|███▌      | 4068/11511 [00:47<01:27, 84.97it/s][A
VAD Processing:  35%|███▌      | 4077/11511 [00:47<01:27, 84.98it/s][A
VAD Processing:  35%|███▌      | 4086/11511 [00:47<01:27, 85.00it/s][A
VAD Processing:  36%|███▌      | 4095/11511 [00:47<01:27, 84.97it/s][A
VAD Processing:  36%|███▌      | 4104/11511 [00:48<01:27, 84.98it/s][A
VAD Processing:  36%|███▌      | 4113/11511 [00:48<01:27, 85.01it/s][A
VAD Processing:  36%|███▌      | 4122/11511 [00:48<01:26, 85.00it/s][A
VAD Processing:  36%|███▌      | 4131/11511 [00:48<01:26, 84.98it/s][A
VAD Processing:  36%|███▌      | 4140/11511 [00:48<01:26, 84.98it/s][A
VAD Processing:  36%|███▌      | 4149/11511 [00:48<01:26, 84.96it/s][A
VAD Processing:  36%|███▌      | 4158/11511 [00:48<01:26, 84.93it/s][A
VAD Processing:  36%|███▌      | 4167/11511 [00:48<01:27, 84.26it/s][A
VAD Processing:  36%|███▋      | 4176/11511 [00:48<01:26, 84.47it/s][A
VAD Processing:  36%|███▋      | 4185/11511 [00:49<01:26, 84.61it/s][A
VAD Processing:  36%|███▋      | 4194/11511 [00:49<01:26, 84.65it/s][A
VAD Processing:  37%|███▋      | 4203/11511 [00:49<01:26, 84.76it/s][A
VAD Processing:  37%|███▋      | 4212/11511 [00:49<01:26, 84.85it/s][A
VAD Processing:  37%|███▋      | 4221/11511 [00:49<01:25, 84.90it/s][A
VAD Processing:  37%|███▋      | 4230/11511 [00:49<01:25, 85.14it/s][A
VAD Processing:  37%|███▋      | 4239/11511 [00:49<01:25, 85.32it/s][A
VAD Processing:  37%|███▋      | 4248/11511 [00:49<01:25, 85.22it/s][A
VAD Processing:  37%|███▋      | 4257/11511 [00:49<01:25, 85.15it/s][A
VAD Processing:  37%|███▋      | 4266/11511 [00:49<01:25, 85.11it/s][A
VAD Processing:  37%|███▋      | 4275/11511 [00:50<01:25, 85.05it/s][A
VAD Processing:  37%|███▋      | 4284/11511 [00:50<01:25, 84.96it/s][A
VAD Processing:  37%|███▋      | 4293/11511 [00:50<01:24, 84.94it/s][A
VAD Processing:  37%|███▋      | 4302/11511 [00:50<01:24, 84.88it/s][A
VAD Processing:  37%|███▋      | 4311/11511 [00:50<01:24, 84.98it/s][A
VAD Processing:  38%|███▊      | 4320/11511 [00:50<01:24, 84.94it/s][A
VAD Processing:  38%|███▊      | 4329/11511 [00:50<01:24, 85.01it/s][A
VAD Processing:  38%|███▊      | 4338/11511 [00:50<01:24, 84.96it/s][A
VAD Processing:  38%|███▊      | 4347/11511 [00:50<01:24, 84.96it/s][A
VAD Processing:  38%|███▊      | 4356/11511 [00:51<01:24, 84.99it/s][A
VAD Processing:  38%|███▊      | 4365/11511 [00:51<01:24, 84.99it/s][A
VAD Processing:  38%|███▊      | 4374/11511 [00:51<01:23, 85.03it/s][A
VAD Processing:  38%|███▊      | 4383/11511 [00:51<01:23, 85.01it/s][A
VAD Processing:  38%|███▊      | 4392/11511 [00:51<01:23, 84.98it/s][A
VAD Processing:  38%|███▊      | 4401/11511 [00:51<01:23, 84.95it/s][A
VAD Processing:  38%|███▊      | 4410/11511 [00:51<01:23, 84.98it/s][A
VAD Processing:  38%|███▊      | 4419/11511 [00:51<01:23, 85.03it/s][A
VAD Processing:  38%|███▊      | 4428/11511 [00:51<01:23, 85.06it/s][A
VAD Processing:  39%|███▊      | 4437/11511 [00:51<01:23, 85.04it/s][A
VAD Processing:  39%|███▊      | 4446/11511 [00:52<01:23, 85.05it/s][A
VAD Processing:  39%|███▊      | 4455/11511 [00:52<01:22, 85.03it/s][A
VAD Processing:  39%|███▉      | 4464/11511 [00:52<01:22, 84.99it/s][A
VAD Processing:  39%|███▉      | 4473/11511 [00:52<01:22, 85.04it/s][A
VAD Processing:  39%|███▉      | 4482/11511 [00:52<01:22, 85.17it/s][A
VAD Processing:  39%|███▉      | 4491/11511 [00:52<01:22, 85.07it/s][A
VAD Processing:  39%|███▉      | 4500/11511 [00:52<01:22, 85.05it/s][A
VAD Processing:  39%|███▉      | 4509/11511 [00:52<01:22, 85.03it/s][A
VAD Processing:  39%|███▉      | 4518/11511 [00:52<01:22, 85.02it/s][A
VAD Processing:  39%|███▉      | 4527/11511 [00:53<01:22, 85.10it/s][A
VAD Processing:  39%|███▉      | 4536/11511 [00:53<01:22, 85.02it/s][A
VAD Processing:  39%|███▉      | 4545/11511 [00:53<01:21, 84.99it/s][A
VAD Processing:  40%|███▉      | 4554/11511 [00:53<01:21, 84.97it/s][A
VAD Processing:  40%|███▉      | 4563/11511 [00:53<01:21, 84.98it/s][A
VAD Processing:  40%|███▉      | 4572/11511 [00:53<01:21, 85.00it/s][A
VAD Processing:  40%|███▉      | 4581/11511 [00:53<01:21, 85.01it/s][A
VAD Processing:  40%|███▉      | 4590/11511 [00:53<01:21, 84.67it/s][A
VAD Processing:  40%|███▉      | 4599/11511 [00:53<01:21, 84.79it/s][A
VAD Processing:  40%|████      | 4608/11511 [00:53<01:21, 84.88it/s][A
VAD Processing:  40%|████      | 4617/11511 [00:54<01:21, 84.91it/s][A
VAD Processing:  40%|████      | 4626/11511 [00:54<01:21, 84.92it/s][A
VAD Processing:  40%|████      | 4635/11511 [00:54<01:20, 84.96it/s][A
VAD Processing:  40%|████      | 4644/11511 [00:54<01:20, 84.97it/s][A
VAD Processing:  40%|████      | 4653/11511 [00:54<01:20, 84.95it/s][A
VAD Processing:  41%|████      | 4662/11511 [00:54<01:20, 84.95it/s][A
VAD Processing:  41%|████      | 4671/11511 [00:54<01:20, 84.98it/s][A
VAD Processing:  41%|████      | 4680/11511 [00:54<01:20, 84.95it/s][A
VAD Processing:  41%|████      | 4689/11511 [00:54<01:20, 84.94it/s][A
VAD Processing:  41%|████      | 4698/11511 [00:55<01:20, 85.00it/s][A
VAD Processing:  41%|████      | 4707/11511 [00:55<01:20, 84.97it/s][A
VAD Processing:  41%|████      | 4716/11511 [00:55<01:19, 84.97it/s][A
VAD Processing:  41%|████      | 4725/11511 [00:55<01:19, 84.93it/s][A
VAD Processing:  41%|████      | 4734/11511 [00:55<01:19, 85.02it/s][A
VAD Processing:  41%|████      | 4743/11511 [00:55<01:19, 84.98it/s][A
VAD Processing:  41%|████▏     | 4752/11511 [00:55<01:19, 84.97it/s][A
VAD Processing:  41%|████▏     | 4761/11511 [00:55<01:19, 84.96it/s][A
VAD Processing:  41%|████▏     | 4770/11511 [00:55<01:19, 84.93it/s][A
VAD Processing:  42%|████▏     | 4779/11511 [00:56<01:19, 84.97it/s][A
VAD Processing:  42%|████▏     | 4788/11511 [00:56<01:19, 84.99it/s][A
VAD Processing:  42%|████▏     | 4797/11511 [00:56<01:19, 84.92it/s][A
VAD Processing:  42%|████▏     | 4806/11511 [00:56<01:18, 85.02it/s][A
VAD Processing:  42%|████▏     | 4815/11511 [00:56<01:18, 84.99it/s][A
VAD Processing:  42%|████▏     | 4824/11511 [00:56<01:18, 84.94it/s][A
VAD Processing:  42%|████▏     | 4833/11511 [00:56<01:18, 84.89it/s][A
VAD Processing:  42%|████▏     | 4842/11511 [00:56<01:18, 84.97it/s][A
VAD Processing:  42%|████▏     | 4851/11511 [00:56<01:18, 85.21it/s][A
VAD Processing:  42%|████▏     | 4860/11511 [00:56<01:18, 85.14it/s][A
VAD Processing:  42%|████▏     | 4869/11511 [00:57<01:18, 85.08it/s][A
VAD Processing:  42%|████▏     | 4878/11511 [00:57<01:18, 85.02it/s][A
VAD Processing:  42%|████▏     | 4887/11511 [00:57<01:17, 85.04it/s][A
VAD Processing:  43%|████▎     | 4896/11511 [00:57<01:17, 85.02it/s][A
VAD Processing:  43%|████▎     | 4905/11511 [00:57<01:17, 85.00it/s][A
VAD Processing:  43%|████▎     | 4914/11511 [00:57<01:17, 84.99it/s][A
VAD Processing:  43%|████▎     | 4923/11511 [00:57<01:17, 85.02it/s][A
VAD Processing:  43%|████▎     | 4932/11511 [00:57<01:17, 84.90it/s][A
VAD Processing:  43%|████▎     | 4941/11511 [00:57<01:17, 85.00it/s][A
VAD Processing:  43%|████▎     | 4950/11511 [00:58<01:17, 85.00it/s][A
VAD Processing:  43%|████▎     | 4959/11511 [00:58<01:17, 84.97it/s][A
VAD Processing:  43%|████▎     | 4968/11511 [00:58<01:17, 84.94it/s][A
VAD Processing:  43%|████▎     | 4977/11511 [00:58<01:16, 84.95it/s][A
VAD Processing:  43%|████▎     | 4986/11511 [00:58<01:16, 84.95it/s][A
VAD Processing:  43%|████▎     | 4995/11511 [00:58<01:16, 85.00it/s][A
VAD Processing:  43%|████▎     | 5004/11511 [00:58<01:16, 84.96it/s][A
VAD Processing:  44%|████▎     | 5013/11511 [00:58<01:16, 84.95it/s][A
VAD Processing:  44%|████▎     | 5022/11511 [00:58<01:16, 84.95it/s][A
VAD Processing:  44%|████▎     | 5031/11511 [00:58<01:16, 84.92it/s][A
VAD Processing:  44%|████▍     | 5040/11511 [00:59<01:16, 84.98it/s][A
VAD Processing:  44%|████▍     | 5049/11511 [00:59<01:15, 85.07it/s][A
VAD Processing:  44%|████▍     | 5058/11511 [00:59<01:15, 85.02it/s][A
VAD Processing:  44%|████▍     | 5067/11511 [00:59<01:15, 85.01it/s][A
VAD Processing:  44%|████▍     | 5076/11511 [00:59<01:15, 84.97it/s][A
VAD Processing:  44%|████▍     | 5085/11511 [00:59<01:15, 84.94it/s][A
VAD Processing:  44%|████▍     | 5094/11511 [00:59<01:15, 85.06it/s][A
VAD Processing:  44%|████▍     | 5103/11511 [00:59<01:15, 85.02it/s][A
VAD Processing:  44%|████▍     | 5112/11511 [00:59<01:15, 84.97it/s][A
VAD Processing:  44%|████▍     | 5121/11511 [01:00<01:15, 84.93it/s][A
VAD Processing:  45%|████▍     | 5130/11511 [01:00<01:15, 84.95it/s][A
VAD Processing:  45%|████▍     | 5139/11511 [01:00<01:15, 84.92it/s][A
VAD Processing:  45%|████▍     | 5148/11511 [01:00<01:15, 84.48it/s][A
VAD Processing:  45%|████▍     | 5157/11511 [01:00<01:15, 84.66it/s][A
VAD Processing:  45%|████▍     | 5166/11511 [01:00<01:14, 84.76it/s][A
VAD Processing:  45%|████▍     | 5175/11511 [01:00<01:14, 84.82it/s][A
VAD Processing:  45%|████▌     | 5184/11511 [01:00<01:14, 84.88it/s][A
VAD Processing:  45%|████▌     | 5193/11511 [01:00<01:14, 84.89it/s][A
VAD Processing:  45%|████▌     | 5202/11511 [01:00<01:14, 84.91it/s][A
VAD Processing:  45%|████▌     | 5211/11511 [01:01<01:14, 84.94it/s][A
VAD Processing:  45%|████▌     | 5220/11511 [01:01<01:14, 84.80it/s][A
VAD Processing:  45%|████▌     | 5229/11511 [01:01<01:14, 84.88it/s][A
VAD Processing:  46%|████▌     | 5238/11511 [01:01<01:13, 84.92it/s][A
VAD Processing:  46%|████▌     | 5247/11511 [01:01<01:13, 84.93it/s][A
VAD Processing:  46%|████▌     | 5256/11511 [01:01<01:13, 84.92it/s][A
VAD Processing:  46%|████▌     | 5265/11511 [01:01<01:13, 84.96it/s][A
VAD Processing:  46%|████▌     | 5274/11511 [01:01<01:13, 84.85it/s][A
VAD Processing:  46%|████▌     | 5283/11511 [01:01<01:13, 84.89it/s][A
VAD Processing:  46%|████▌     | 5292/11511 [01:02<01:13, 84.93it/s][A
VAD Processing:  46%|████▌     | 5301/11511 [01:02<01:13, 84.96it/s][A
VAD Processing:  46%|████▌     | 5310/11511 [01:02<01:12, 85.01it/s][A
VAD Processing:  46%|████▌     | 5319/11511 [01:02<01:12, 85.01it/s][A
VAD Processing:  46%|████▋     | 5328/11511 [01:02<01:12, 84.98it/s][A
VAD Processing:  46%|████▋     | 5337/11511 [01:02<01:12, 85.02it/s][A
VAD Processing:  46%|████▋     | 5346/11511 [01:02<01:12, 85.03it/s][A
VAD Processing:  47%|████▋     | 5355/11511 [01:02<01:12, 85.03it/s][A
VAD Processing:  47%|████▋     | 5364/11511 [01:02<01:12, 85.01it/s][A
VAD Processing:  47%|████▋     | 5373/11511 [01:02<01:12, 85.01it/s][A
VAD Processing:  47%|████▋     | 5382/11511 [01:03<01:12, 85.03it/s][A
VAD Processing:  47%|████▋     | 5391/11511 [01:03<01:12, 84.91it/s][A
VAD Processing:  47%|████▋     | 5400/11511 [01:03<01:11, 84.91it/s][A
VAD Processing:  47%|████▋     | 5409/11511 [01:03<01:11, 84.98it/s][A
VAD Processing:  47%|████▋     | 5418/11511 [01:03<01:11, 84.95it/s][A
VAD Processing:  47%|████▋     | 5427/11511 [01:03<01:11, 84.95it/s][A
VAD Processing:  47%|████▋     | 5436/11511 [01:03<01:11, 84.97it/s][A
VAD Processing:  47%|████▋     | 5445/11511 [01:03<01:11, 84.91it/s][A
VAD Processing:  47%|████▋     | 5454/11511 [01:03<01:11, 84.90it/s][A
VAD Processing:  47%|████▋     | 5463/11511 [01:04<01:11, 84.94it/s][A
VAD Processing:  48%|████▊     | 5472/11511 [01:04<01:11, 84.97it/s][A
VAD Processing:  48%|████▊     | 5481/11511 [01:04<01:10, 85.01it/s][A
VAD Processing:  48%|████▊     | 5490/11511 [01:04<01:10, 85.04it/s][A
VAD Processing:  48%|████▊     | 5499/11511 [01:04<01:10, 84.99it/s][A
VAD Processing:  48%|████▊     | 5508/11511 [01:04<01:10, 85.02it/s][A
VAD Processing:  48%|████▊     | 5517/11511 [01:04<01:10, 85.02it/s][A
VAD Processing:  48%|████▊     | 5526/11511 [01:04<01:10, 85.00it/s][A
VAD Processing:  48%|████▊     | 5535/11511 [01:04<01:10, 85.01it/s][A
VAD Processing:  48%|████▊     | 5544/11511 [01:05<01:10, 84.98it/s][A
VAD Processing:  48%|████▊     | 5553/11511 [01:05<01:10, 84.98it/s][A
VAD Processing:  48%|████▊     | 5562/11511 [01:05<01:09, 84.99it/s][A
VAD Processing:  48%|████▊     | 5571/11511 [01:05<01:09, 84.98it/s][A
VAD Processing:  48%|████▊     | 5580/11511 [01:05<01:09, 84.97it/s][A
VAD Processing:  49%|████▊     | 5589/11511 [01:05<01:09, 84.95it/s][A
VAD Processing:  49%|████▊     | 5598/11511 [01:05<01:09, 84.95it/s][A
VAD Processing:  49%|████▊     | 5607/11511 [01:05<01:09, 85.01it/s][A
VAD Processing:  49%|████▉     | 5616/11511 [01:05<01:09, 85.07it/s][A
VAD Processing:  49%|████▉     | 5625/11511 [01:05<01:09, 85.02it/s][A
VAD Processing:  49%|████▉     | 5634/11511 [01:06<01:09, 84.98it/s][A
VAD Processing:  49%|████▉     | 5643/11511 [01:06<01:09, 84.98it/s][A
VAD Processing:  49%|████▉     | 5652/11511 [01:06<01:08, 85.00it/s][A
VAD Processing:  49%|████▉     | 5661/11511 [01:06<01:08, 85.01it/s][A
VAD Processing:  49%|████▉     | 5670/11511 [01:06<01:08, 85.00it/s][A
VAD Processing:  49%|████▉     | 5679/11511 [01:06<01:08, 84.96it/s][A
VAD Processing:  49%|████▉     | 5688/11511 [01:06<01:08, 84.97it/s][A
VAD Processing:  49%|████▉     | 5697/11511 [01:06<01:08, 84.34it/s][A
VAD Processing:  50%|████▉     | 5706/11511 [01:06<01:08, 84.47it/s][A
VAD Processing:  50%|████▉     | 5715/11511 [01:07<01:08, 84.64it/s][A
VAD Processing:  50%|████▉     | 5724/11511 [01:07<01:08, 84.75it/s][A
VAD Processing:  50%|████▉     | 5733/11511 [01:07<01:08, 84.81it/s][A
VAD Processing:  50%|████▉     | 5742/11511 [01:07<01:07, 84.85it/s][A
VAD Processing:  50%|████▉     | 5751/11511 [01:07<01:07, 84.92it/s][A
VAD Processing:  50%|█████     | 5760/11511 [01:07<01:07, 84.98it/s][A
VAD Processing:  50%|█████     | 5769/11511 [01:07<01:07, 84.96it/s][A
VAD Processing:  50%|█████     | 5778/11511 [01:07<01:07, 85.00it/s][A
VAD Processing:  50%|█████     | 5787/11511 [01:07<01:07, 85.03it/s][A
VAD Processing:  50%|█████     | 5796/11511 [01:07<01:07, 85.03it/s][A
VAD Processing:  50%|█████     | 5805/11511 [01:08<01:07, 84.94it/s][A
VAD Processing:  51%|█████     | 5814/11511 [01:08<01:07, 84.96it/s][A
VAD Processing:  51%|█████     | 5823/11511 [01:08<01:06, 84.98it/s][A
VAD Processing:  51%|█████     | 5832/11511 [01:08<01:06, 85.00it/s][A
VAD Processing:  51%|█████     | 5841/11511 [01:08<01:06, 84.96it/s][A
VAD Processing:  51%|█████     | 5850/11511 [01:08<01:06, 84.93it/s][A
VAD Processing:  51%|█████     | 5859/11511 [01:08<01:06, 84.95it/s][A
VAD Processing:  51%|█████     | 5868/11511 [01:08<01:06, 84.93it/s][A
VAD Processing:  51%|█████     | 5877/11511 [01:08<01:06, 84.97it/s][A
VAD Processing:  51%|█████     | 5886/11511 [01:09<01:06, 85.02it/s][A
VAD Processing:  51%|█████     | 5895/11511 [01:09<01:06, 85.06it/s][A
VAD Processing:  51%|█████▏    | 5904/11511 [01:09<01:05, 85.04it/s][A
VAD Processing:  51%|█████▏    | 5913/11511 [01:09<01:05, 85.08it/s][A
VAD Processing:  51%|█████▏    | 5922/11511 [01:09<01:05, 85.06it/s][A
VAD Processing:  52%|█████▏    | 5931/11511 [01:09<01:05, 85.01it/s][A
VAD Processing:  52%|█████▏    | 5940/11511 [01:09<01:05, 85.00it/s][A
VAD Processing:  52%|█████▏    | 5949/11511 [01:09<01:05, 85.01it/s][A
VAD Processing:  52%|█████▏    | 5958/11511 [01:09<01:05, 84.95it/s][A
VAD Processing:  52%|█████▏    | 5967/11511 [01:09<01:05, 85.00it/s][A
VAD Processing:  52%|█████▏    | 5976/11511 [01:10<01:05, 85.01it/s][A
VAD Processing:  52%|█████▏    | 5985/11511 [01:10<01:05, 84.97it/s][A
VAD Processing:  52%|█████▏    | 5994/11511 [01:10<01:04, 84.94it/s][A
VAD Processing:  52%|█████▏    | 6003/11511 [01:10<01:04, 84.96it/s][A
VAD Processing:  52%|█████▏    | 6012/11511 [01:10<01:04, 85.08it/s][A
VAD Processing:  52%|█████▏    | 6021/11511 [01:10<01:04, 84.99it/s][A
VAD Processing:  52%|█████▏    | 6030/11511 [01:10<01:04, 85.04it/s][A
VAD Processing:  52%|█████▏    | 6039/11511 [01:10<01:04, 85.06it/s][A
VAD Processing:  53%|█████▎    | 6048/11511 [01:10<01:04, 85.01it/s][A
VAD Processing:  53%|█████▎    | 6057/11511 [01:11<01:04, 85.02it/s][A
VAD Processing:  53%|█████▎    | 6066/11511 [01:11<01:04, 85.04it/s][A
VAD Processing:  53%|█████▎    | 6075/11511 [01:11<01:03, 84.99it/s][A
VAD Processing:  53%|█████▎    | 6084/11511 [01:11<01:03, 84.97it/s][A
VAD Processing:  53%|█████▎    | 6093/11511 [01:11<01:03, 84.96it/s][A
VAD Processing:  53%|█████▎    | 6102/11511 [01:11<01:03, 84.96it/s][A
VAD Processing:  53%|█████▎    | 6111/11511 [01:11<01:03, 84.91it/s][A
VAD Processing:  53%|█████▎    | 6120/11511 [01:11<01:03, 84.88it/s][A
VAD Processing:  53%|█████▎    | 6129/11511 [01:11<01:03, 84.98it/s][A
VAD Processing:  53%|█████▎    | 6138/11511 [01:11<01:03, 85.04it/s][A
VAD Processing:  53%|█████▎    | 6147/11511 [01:12<01:03, 85.03it/s][A
VAD Processing:  53%|█████▎    | 6156/11511 [01:12<01:03, 84.97it/s][A
VAD Processing:  54%|█████▎    | 6165/11511 [01:12<01:02, 84.99it/s][A
VAD Processing:  54%|█████▎    | 6174/11511 [01:12<01:02, 85.01it/s][A
VAD Processing:  54%|█████▎    | 6183/11511 [01:12<01:02, 84.89it/s][A
VAD Processing:  54%|█████▍    | 6192/11511 [01:12<01:02, 84.87it/s][A
VAD Processing:  54%|█████▍    | 6201/11511 [01:12<01:02, 84.80it/s][A
VAD Processing:  54%|█████▍    | 6210/11511 [01:12<01:02, 84.92it/s][A
VAD Processing:  54%|█████▍    | 6219/11511 [01:12<01:02, 85.00it/s][A
VAD Processing:  54%|█████▍    | 6228/11511 [01:13<01:02, 85.13it/s][A
VAD Processing:  54%|█████▍    | 6237/11511 [01:13<01:01, 85.15it/s][A
VAD Processing:  54%|█████▍    | 6246/11511 [01:13<01:01, 85.13it/s][A
VAD Processing:  54%|█████▍    | 6255/11511 [01:13<01:02, 84.64it/s][A
VAD Processing:  54%|█████▍    | 6264/11511 [01:13<01:01, 84.89it/s][A
VAD Processing:  54%|█████▍    | 6273/11511 [01:13<01:01, 84.79it/s][A
VAD Processing:  55%|█████▍    | 6282/11511 [01:13<01:01, 84.63it/s][A
VAD Processing:  55%|█████▍    | 6291/11511 [01:13<01:01, 84.58it/s][A
VAD Processing:  55%|█████▍    | 6300/11511 [01:13<01:01, 84.79it/s][A
VAD Processing:  55%|█████▍    | 6309/11511 [01:14<01:01, 84.85it/s][A
VAD Processing:  55%|█████▍    | 6318/11511 [01:14<01:01, 84.89it/s][A
VAD Processing:  55%|█████▍    | 6327/11511 [01:14<01:00, 85.03it/s][A
VAD Processing:  55%|█████▌    | 6336/11511 [01:14<01:00, 84.99it/s][A
VAD Processing:  55%|█████▌    | 6345/11511 [01:14<01:00, 85.00it/s][A
VAD Processing:  55%|█████▌    | 6354/11511 [01:14<01:00, 85.00it/s][A
VAD Processing:  55%|█████▌    | 6363/11511 [01:14<01:00, 85.13it/s][A
VAD Processing:  55%|█████▌    | 6372/11511 [01:14<01:00, 85.04it/s][A
VAD Processing:  55%|█████▌    | 6381/11511 [01:14<01:00, 85.15it/s][A
VAD Processing:  56%|█████▌    | 6390/11511 [01:14<01:00, 85.04it/s][A
VAD Processing:  56%|█████▌    | 6399/11511 [01:15<01:00, 85.14it/s][A
VAD Processing:  56%|█████▌    | 6408/11511 [01:15<00:59, 85.12it/s][A
VAD Processing:  56%|█████▌    | 6417/11511 [01:15<01:01, 83.31it/s][A
VAD Processing:  56%|█████▌    | 6426/11511 [01:15<01:03, 80.56it/s][A
VAD Processing:  56%|█████▌    | 6435/11511 [01:15<01:03, 80.34it/s][A
VAD Processing:  56%|█████▌    | 6444/11511 [01:15<01:01, 82.13it/s][A
VAD Processing:  56%|█████▌    | 6453/11511 [01:15<01:00, 83.54it/s][A
VAD Processing:  56%|█████▌    | 6462/11511 [01:15<00:59, 84.48it/s][A
VAD Processing:  56%|█████▌    | 6471/11511 [01:15<00:59, 85.16it/s][A
VAD Processing:  56%|█████▋    | 6480/11511 [01:16<00:58, 85.63it/s][A
VAD Processing:  56%|█████▋    | 6489/11511 [01:16<00:58, 85.97it/s][A
VAD Processing:  56%|█████▋    | 6498/11511 [01:16<00:58, 86.19it/s][A
VAD Processing:  57%|█████▋    | 6507/11511 [01:16<00:57, 86.30it/s][A
VAD Processing:  57%|█████▋    | 6516/11511 [01:16<00:57, 86.40it/s][A
VAD Processing:  57%|█████▋    | 6525/11511 [01:16<00:57, 86.63it/s][A
VAD Processing:  57%|█████▋    | 6534/11511 [01:16<00:57, 86.63it/s][A
VAD Processing:  57%|█████▋    | 6543/11511 [01:16<00:57, 86.82it/s][A
VAD Processing:  57%|█████▋    | 6552/11511 [01:16<00:57, 86.95it/s][A
VAD Processing:  57%|█████▋    | 6561/11511 [01:16<00:56, 87.04it/s][A
VAD Processing:  57%|█████▋    | 6570/11511 [01:17<00:56, 87.09it/s][A
VAD Processing:  57%|█████▋    | 6579/11511 [01:17<00:56, 87.08it/s][A
VAD Processing:  57%|█████▋    | 6588/11511 [01:17<00:56, 87.07it/s][A
VAD Processing:  57%|█████▋    | 6597/11511 [01:17<00:56, 87.01it/s][A
VAD Processing:  57%|█████▋    | 6606/11511 [01:17<00:56, 86.86it/s][A
VAD Processing:  57%|█████▋    | 6615/11511 [01:17<00:56, 86.83it/s][A
VAD Processing:  58%|█████▊    | 6624/11511 [01:17<00:56, 86.76it/s][A
VAD Processing:  58%|█████▊    | 6633/11511 [01:17<00:56, 86.76it/s][A
VAD Processing:  58%|█████▊    | 6642/11511 [01:17<00:56, 86.74it/s][A
VAD Processing:  58%|█████▊    | 6651/11511 [01:18<00:56, 86.72it/s][A
VAD Processing:  58%|█████▊    | 6660/11511 [01:18<00:55, 86.66it/s][A
VAD Processing:  58%|█████▊    | 6669/11511 [01:18<00:55, 86.83it/s][A
VAD Processing:  58%|█████▊    | 6678/11511 [01:18<00:55, 86.96it/s][A
VAD Processing:  58%|█████▊    | 6687/11511 [01:18<00:55, 87.05it/s][A
VAD Processing:  58%|█████▊    | 6696/11511 [01:18<00:55, 87.06it/s][A
VAD Processing:  58%|█████▊    | 6705/11511 [01:18<00:55, 86.93it/s][A
VAD Processing:  58%|█████▊    | 6714/11511 [01:18<00:55, 86.95it/s][A
VAD Processing:  58%|█████▊    | 6723/11511 [01:18<00:55, 86.94it/s][A
VAD Processing:  58%|█████▊    | 6732/11511 [01:18<00:55, 86.82it/s][A
VAD Processing:  59%|█████▊    | 6741/11511 [01:19<00:54, 86.82it/s][A
VAD Processing:  59%|█████▊    | 6750/11511 [01:19<00:54, 86.80it/s][A
VAD Processing:  59%|█████▊    | 6759/11511 [01:19<00:54, 86.67it/s][A
VAD Processing:  59%|█████▉    | 6768/11511 [01:19<00:54, 86.84it/s][A
VAD Processing:  59%|█████▉    | 6777/11511 [01:19<00:54, 86.80it/s][A
VAD Processing:  59%|█████▉    | 6786/11511 [01:19<00:54, 86.84it/s][A
VAD Processing:  59%|█████▉    | 6795/11511 [01:19<00:54, 86.86it/s][A
VAD Processing:  59%|█████▉    | 6804/11511 [01:19<00:54, 86.83it/s][A
VAD Processing:  59%|█████▉    | 6813/11511 [01:19<00:54, 86.76it/s][A
VAD Processing:  59%|█████▉    | 6822/11511 [01:19<00:53, 86.93it/s][A
VAD Processing:  59%|█████▉    | 6831/11511 [01:20<00:53, 87.11it/s][A
VAD Processing:  59%|█████▉    | 6840/11511 [01:20<00:53, 86.98it/s][A
VAD Processing:  59%|█████▉    | 6849/11511 [01:20<00:53, 86.92it/s][A
VAD Processing:  60%|█████▉    | 6858/11511 [01:20<00:53, 86.85it/s][A
VAD Processing:  60%|█████▉    | 6867/11511 [01:20<00:53, 86.93it/s][A
VAD Processing:  60%|█████▉    | 6876/11511 [01:20<00:53, 86.81it/s][A
VAD Processing:  60%|█████▉    | 6885/11511 [01:20<00:53, 86.76it/s][A
VAD Processing:  60%|█████▉    | 6894/11511 [01:20<00:53, 86.70it/s][A
VAD Processing:  60%|█████▉    | 6903/11511 [01:20<00:53, 86.82it/s][A
VAD Processing:  60%|██████    | 6912/11511 [01:21<00:53, 86.74it/s][A
VAD Processing:  60%|██████    | 6921/11511 [01:21<00:52, 86.69it/s][A
VAD Processing:  60%|██████    | 6930/11511 [01:21<00:52, 86.70it/s][A
VAD Processing:  60%|██████    | 6939/11511 [01:21<00:52, 86.68it/s][A
VAD Processing:  60%|██████    | 6948/11511 [01:21<00:52, 86.64it/s][A
VAD Processing:  60%|██████    | 6957/11511 [01:21<00:52, 86.61it/s][A
VAD Processing:  61%|██████    | 6966/11511 [01:21<00:52, 86.64it/s][A
VAD Processing:  61%|██████    | 6975/11511 [01:21<00:52, 86.64it/s][A
VAD Processing:  61%|██████    | 6984/11511 [01:21<00:52, 86.64it/s][A
VAD Processing:  61%|██████    | 6993/11511 [01:21<00:52, 86.67it/s][A
VAD Processing:  61%|██████    | 7002/11511 [01:22<00:52, 86.71it/s][A
VAD Processing:  61%|██████    | 7011/11511 [01:22<00:51, 86.75it/s][A
VAD Processing:  61%|██████    | 7020/11511 [01:22<00:51, 86.77it/s][A
VAD Processing:  61%|██████    | 7029/11511 [01:22<00:51, 86.77it/s][A
VAD Processing:  61%|██████    | 7038/11511 [01:22<00:51, 86.79it/s][A
VAD Processing:  61%|██████    | 7047/11511 [01:22<00:51, 86.79it/s][A
VAD Processing:  61%|██████▏   | 7056/11511 [01:22<00:51, 86.80it/s][A
VAD Processing:  61%|██████▏   | 7065/11511 [01:22<00:51, 86.81it/s][A
VAD Processing:  61%|██████▏   | 7074/11511 [01:22<00:51, 86.82it/s][A
VAD Processing:  62%|██████▏   | 7083/11511 [01:22<00:51, 86.81it/s][A
VAD Processing:  62%|██████▏   | 7092/11511 [01:23<00:50, 86.80it/s][A
VAD Processing:  62%|██████▏   | 7101/11511 [01:23<00:50, 86.76it/s][A
VAD Processing:  62%|██████▏   | 7110/11511 [01:23<00:50, 86.76it/s][A
VAD Processing:  62%|██████▏   | 7119/11511 [01:23<00:50, 86.77it/s][A
VAD Processing:  62%|██████▏   | 7128/11511 [01:23<00:50, 86.77it/s][A
VAD Processing:  62%|██████▏   | 7137/11511 [01:23<00:50, 86.79it/s][A
VAD Processing:  62%|██████▏   | 7146/11511 [01:23<00:50, 86.79it/s][A
VAD Processing:  62%|██████▏   | 7155/11511 [01:23<00:50, 86.78it/s][A
VAD Processing:  62%|██████▏   | 7164/11511 [01:23<00:50, 86.77it/s][A
VAD Processing:  62%|██████▏   | 7173/11511 [01:24<00:49, 86.81it/s][A
VAD Processing:  62%|██████▏   | 7182/11511 [01:24<00:49, 86.80it/s][A
VAD Processing:  62%|██████▏   | 7191/11511 [01:24<00:49, 86.82it/s][A
VAD Processing:  63%|██████▎   | 7200/11511 [01:24<00:49, 86.80it/s][A
VAD Processing:  63%|██████▎   | 7209/11511 [01:24<00:49, 86.61it/s][A
VAD Processing:  63%|██████▎   | 7218/11511 [01:24<00:49, 86.70it/s][A
VAD Processing:  63%|██████▎   | 7227/11511 [01:24<00:49, 86.73it/s][A
VAD Processing:  63%|██████▎   | 7236/11511 [01:24<00:49, 86.74it/s][A
VAD Processing:  63%|██████▎   | 7245/11511 [01:24<00:49, 86.72it/s][A
VAD Processing:  63%|██████▎   | 7254/11511 [01:24<00:49, 86.70it/s][A
VAD Processing:  63%|██████▎   | 7263/11511 [01:25<00:48, 86.75it/s][A
VAD Processing:  63%|██████▎   | 7272/11511 [01:25<00:48, 86.77it/s][A
VAD Processing:  63%|██████▎   | 7281/11511 [01:25<00:48, 86.75it/s][A
VAD Processing:  63%|██████▎   | 7290/11511 [01:25<00:48, 86.76it/s][A
VAD Processing:  63%|██████▎   | 7299/11511 [01:25<00:48, 86.80it/s][A
VAD Processing:  63%|██████▎   | 7308/11511 [01:25<00:48, 86.82it/s][A
VAD Processing:  64%|██████▎   | 7317/11511 [01:25<00:48, 86.82it/s][A
VAD Processing:  64%|██████▎   | 7326/11511 [01:25<00:48, 86.82it/s][A
VAD Processing:  64%|██████▎   | 7335/11511 [01:25<00:48, 86.81it/s][A
VAD Processing:  64%|██████▍   | 7344/11511 [01:25<00:48, 86.79it/s][A
VAD Processing:  64%|██████▍   | 7353/11511 [01:26<00:47, 86.80it/s][A
VAD Processing:  64%|██████▍   | 7362/11511 [01:26<00:47, 86.77it/s][A
VAD Processing:  64%|██████▍   | 7371/11511 [01:26<00:47, 86.83it/s][A
VAD Processing:  64%|██████▍   | 7380/11511 [01:26<00:47, 86.69it/s][A
VAD Processing:  64%|██████▍   | 7389/11511 [01:26<00:47, 86.72it/s][A
VAD Processing:  64%|██████▍   | 7398/11511 [01:26<00:47, 86.60it/s][A
VAD Processing:  64%|██████▍   | 7407/11511 [01:26<00:47, 86.66it/s][A
VAD Processing:  64%|██████▍   | 7416/11511 [01:26<00:47, 86.71it/s][A
VAD Processing:  65%|██████▍   | 7425/11511 [01:26<00:47, 86.74it/s][A
VAD Processing:  65%|██████▍   | 7434/11511 [01:27<00:46, 86.78it/s][A
VAD Processing:  65%|██████▍   | 7443/11511 [01:27<00:46, 86.82it/s][A
VAD Processing:  65%|██████▍   | 7452/11511 [01:27<00:46, 86.83it/s][A
VAD Processing:  65%|██████▍   | 7461/11511 [01:27<00:46, 86.79it/s][A
VAD Processing:  65%|██████▍   | 7470/11511 [01:27<00:46, 86.88it/s][A
VAD Processing:  65%|██████▍   | 7479/11511 [01:27<00:46, 86.97it/s][A
VAD Processing:  65%|██████▌   | 7488/11511 [01:27<00:46, 86.94it/s][A
VAD Processing:  65%|██████▌   | 7497/11511 [01:27<00:46, 86.96it/s][A
VAD Processing:  65%|██████▌   | 7506/11511 [01:27<00:46, 86.90it/s][A
VAD Processing:  65%|██████▌   | 7515/11511 [01:27<00:45, 86.87it/s][A
VAD Processing:  65%|██████▌   | 7524/11511 [01:28<00:45, 86.86it/s][A
VAD Processing:  65%|██████▌   | 7533/11511 [01:28<00:45, 86.88it/s][A
VAD Processing:  66%|██████▌   | 7542/11511 [01:28<00:45, 87.04it/s][A
VAD Processing:  66%|██████▌   | 7551/11511 [01:28<00:45, 86.58it/s][A
VAD Processing:  66%|██████▌   | 7560/11511 [01:28<00:45, 86.71it/s][A
VAD Processing:  66%|██████▌   | 7569/11511 [01:28<00:45, 86.71it/s][A
VAD Processing:  66%|██████▌   | 7578/11511 [01:28<00:45, 86.77it/s][A
VAD Processing:  66%|██████▌   | 7587/11511 [01:28<00:45, 86.68it/s][A
VAD Processing:  66%|██████▌   | 7596/11511 [01:28<00:45, 86.80it/s][A
VAD Processing:  66%|██████▌   | 7605/11511 [01:28<00:44, 87.30it/s][A
VAD Processing:  66%|██████▌   | 7614/11511 [01:29<00:44, 87.29it/s][A
VAD Processing:  66%|██████▌   | 7623/11511 [01:29<00:44, 87.21it/s][A
VAD Processing:  66%|██████▋   | 7632/11511 [01:29<00:44, 87.14it/s][A
VAD Processing:  66%|██████▋   | 7641/11511 [01:29<00:44, 87.11it/s][A
VAD Processing:  66%|██████▋   | 7650/11511 [01:29<00:44, 87.09it/s][A
VAD Processing:  67%|██████▋   | 7659/11511 [01:29<00:44, 87.52it/s][A
VAD Processing:  67%|██████▋   | 7668/11511 [01:29<00:43, 87.46it/s][A
VAD Processing:  67%|██████▋   | 7677/11511 [01:29<00:43, 87.32it/s][A
VAD Processing:  67%|██████▋   | 7686/11511 [01:29<00:43, 87.16it/s][A
VAD Processing:  67%|██████▋   | 7695/11511 [01:30<00:43, 87.10it/s][A
VAD Processing:  67%|██████▋   | 7704/11511 [01:30<00:43, 87.07it/s][A
VAD Processing:  67%|██████▋   | 7713/11511 [01:30<00:43, 87.06it/s][A
VAD Processing:  67%|██████▋   | 7722/11511 [01:30<00:43, 86.99it/s][A
VAD Processing:  67%|██████▋   | 7731/11511 [01:30<00:43, 87.01it/s][A
VAD Processing:  67%|██████▋   | 7740/11511 [01:30<00:43, 86.94it/s][A
VAD Processing:  67%|██████▋   | 7749/11511 [01:30<00:43, 86.96it/s][A
VAD Processing:  67%|██████▋   | 7758/11511 [01:30<00:43, 86.88it/s][A
VAD Processing:  67%|██████▋   | 7767/11511 [01:30<00:43, 86.90it/s][A
VAD Processing:  68%|██████▊   | 7776/11511 [01:30<00:43, 86.73it/s][A
VAD Processing:  68%|██████▊   | 7785/11511 [01:31<00:42, 86.81it/s][A
VAD Processing:  68%|██████▊   | 7794/11511 [01:31<00:42, 86.83it/s][A
VAD Processing:  68%|██████▊   | 7803/11511 [01:31<00:42, 86.91it/s][A
VAD Processing:  68%|██████▊   | 7812/11511 [01:31<00:42, 86.92it/s][A
VAD Processing:  68%|██████▊   | 7821/11511 [01:31<00:42, 86.94it/s][A
VAD Processing:  68%|██████▊   | 7830/11511 [01:31<00:42, 86.94it/s][A
VAD Processing:  68%|██████▊   | 7839/11511 [01:31<00:42, 87.00it/s][A
VAD Processing:  68%|██████▊   | 7848/11511 [01:31<00:41, 87.36it/s][A
VAD Processing:  68%|██████▊   | 7857/11511 [01:31<00:41, 87.21it/s][A
VAD Processing:  68%|██████▊   | 7866/11511 [01:31<00:41, 87.15it/s][A
VAD Processing:  68%|██████▊   | 7875/11511 [01:32<00:41, 86.89it/s][A
VAD Processing:  68%|██████▊   | 7884/11511 [01:32<00:41, 86.92it/s][A
VAD Processing:  69%|██████▊   | 7893/11511 [01:32<00:41, 86.84it/s][A
VAD Processing:  69%|██████▊   | 7902/11511 [01:32<00:41, 87.39it/s][A
VAD Processing:  69%|██████▊   | 7911/11511 [01:32<00:41, 87.26it/s][A
VAD Processing:  69%|██████▉   | 7920/11511 [01:32<00:41, 87.20it/s][A
VAD Processing:  69%|██████▉   | 7929/11511 [01:32<00:41, 87.11it/s][A
VAD Processing:  69%|██████▉   | 7938/11511 [01:32<00:41, 87.11it/s][A
VAD Processing:  69%|██████▉   | 7947/11511 [01:32<00:40, 87.02it/s][A
VAD Processing:  69%|██████▉   | 7956/11511 [01:33<00:40, 86.93it/s][A
VAD Processing:  69%|██████▉   | 7965/11511 [01:33<00:40, 86.84it/s][A
VAD Processing:  69%|██████▉   | 7974/11511 [01:33<00:40, 86.73it/s][A
VAD Processing:  69%|██████▉   | 7983/11511 [01:33<00:40, 86.75it/s][A
VAD Processing:  69%|██████▉   | 7992/11511 [01:33<00:40, 86.81it/s][A
VAD Processing:  70%|██████▉   | 8001/11511 [01:33<00:40, 86.83it/s][A
VAD Processing:  70%|██████▉   | 8010/11511 [01:33<00:40, 86.76it/s][A
VAD Processing:  70%|██████▉   | 8019/11511 [01:33<00:40, 86.85it/s][A
VAD Processing:  70%|██████▉   | 8028/11511 [01:33<00:40, 86.92it/s][A
VAD Processing:  70%|██████▉   | 8037/11511 [01:33<00:39, 86.86it/s][A
VAD Processing:  70%|██████▉   | 8046/11511 [01:34<00:39, 86.75it/s][A
VAD Processing:  70%|██████▉   | 8055/11511 [01:34<00:39, 86.71it/s][A
VAD Processing:  70%|███████   | 8064/11511 [01:34<00:39, 86.78it/s][A
VAD Processing:  70%|███████   | 8073/11511 [01:34<00:39, 86.87it/s][A
VAD Processing:  70%|███████   | 8082/11511 [01:34<00:39, 86.89it/s][A
VAD Processing:  70%|███████   | 8091/11511 [01:34<00:39, 86.93it/s][A
VAD Processing:  70%|███████   | 8100/11511 [01:34<00:39, 86.85it/s][A
VAD Processing:  70%|███████   | 8109/11511 [01:34<00:39, 86.89it/s][A
VAD Processing:  71%|███████   | 8118/11511 [01:34<00:39, 86.90it/s][A
VAD Processing:  71%|███████   | 8127/11511 [01:34<00:38, 86.91it/s][A
VAD Processing:  71%|███████   | 8136/11511 [01:35<00:38, 86.85it/s][A
VAD Processing:  71%|███████   | 8145/11511 [01:35<00:38, 86.89it/s][A
VAD Processing:  71%|███████   | 8154/11511 [01:35<00:38, 87.07it/s][A
VAD Processing:  71%|███████   | 8163/11511 [01:35<00:38, 87.34it/s][A
VAD Processing:  71%|███████   | 8172/11511 [01:35<00:38, 87.23it/s][A
VAD Processing:  71%|███████   | 8181/11511 [01:35<00:38, 87.12it/s][A
VAD Processing:  71%|███████   | 8190/11511 [01:35<00:38, 87.06it/s][A
VAD Processing:  71%|███████   | 8199/11511 [01:35<00:38, 87.03it/s][A
VAD Processing:  71%|███████▏  | 8208/11511 [01:35<00:37, 86.98it/s][A
VAD Processing:  71%|███████▏  | 8217/11511 [01:36<00:37, 86.98it/s][A
VAD Processing:  71%|███████▏  | 8226/11511 [01:36<00:37, 86.93it/s][A
VAD Processing:  72%|███████▏  | 8235/11511 [01:36<00:37, 86.96it/s][A
VAD Processing:  72%|███████▏  | 8244/11511 [01:36<00:37, 86.90it/s][A
VAD Processing:  72%|███████▏  | 8253/11511 [01:36<00:37, 86.95it/s][A
VAD Processing:  72%|███████▏  | 8262/11511 [01:36<00:37, 86.82it/s][A
VAD Processing:  72%|███████▏  | 8271/11511 [01:36<00:37, 86.88it/s][A
VAD Processing:  72%|███████▏  | 8280/11511 [01:36<00:37, 86.83it/s][A
VAD Processing:  72%|███████▏  | 8289/11511 [01:36<00:37, 86.28it/s][A
VAD Processing:  72%|███████▏  | 8298/11511 [01:36<00:37, 86.33it/s][A
VAD Processing:  72%|███████▏  | 8307/11511 [01:37<00:37, 86.52it/s][A
VAD Processing:  72%|███████▏  | 8316/11511 [01:37<00:36, 86.57it/s][A
VAD Processing:  72%|███████▏  | 8325/11511 [01:37<00:36, 86.72it/s][A
VAD Processing:  72%|███████▏  | 8334/11511 [01:37<00:36, 86.82it/s][A
VAD Processing:  72%|███████▏  | 8343/11511 [01:37<00:36, 86.90it/s][A
VAD Processing:  73%|███████▎  | 8352/11511 [01:37<00:36, 86.87it/s][A
VAD Processing:  73%|███████▎  | 8361/11511 [01:37<00:36, 86.93it/s][A
VAD Processing:  73%|███████▎  | 8370/11511 [01:37<00:36, 86.94it/s][A
VAD Processing:  73%|███████▎  | 8379/11511 [01:37<00:36, 86.91it/s][A
VAD Processing:  73%|███████▎  | 8388/11511 [01:38<00:35, 86.93it/s][A
VAD Processing:  73%|███████▎  | 8397/11511 [01:38<00:35, 86.91it/s][A
VAD Processing:  73%|███████▎  | 8406/11511 [01:38<00:35, 86.89it/s][A
VAD Processing:  73%|███████▎  | 8415/11511 [01:38<00:35, 86.88it/s][A
VAD Processing:  73%|███████▎  | 8424/11511 [01:38<00:35, 86.93it/s][A
VAD Processing:  73%|███████▎  | 8433/11511 [01:38<00:35, 86.94it/s][A
VAD Processing:  73%|███████▎  | 8442/11511 [01:38<00:35, 86.77it/s][A
VAD Processing:  73%|███████▎  | 8451/11511 [01:38<00:35, 86.81it/s][A
VAD Processing:  73%|███████▎  | 8460/11511 [01:38<00:35, 86.83it/s][A
VAD Processing:  74%|███████▎  | 8469/11511 [01:38<00:35, 86.87it/s][A
VAD Processing:  74%|███████▎  | 8478/11511 [01:39<00:34, 86.76it/s][A
VAD Processing:  74%|███████▎  | 8487/11511 [01:39<00:34, 86.82it/s][A
VAD Processing:  74%|███████▍  | 8496/11511 [01:39<00:34, 86.78it/s][A
VAD Processing:  74%|███████▍  | 8505/11511 [01:39<00:34, 86.85it/s][A
VAD Processing:  74%|███████▍  | 8514/11511 [01:39<00:34, 86.87it/s][A
VAD Processing:  74%|███████▍  | 8523/11511 [01:39<00:34, 86.84it/s][A
VAD Processing:  74%|███████▍  | 8532/11511 [01:39<00:34, 86.88it/s][A
VAD Processing:  74%|███████▍  | 8541/11511 [01:39<00:34, 86.64it/s][A
VAD Processing:  74%|███████▍  | 8550/11511 [01:39<00:34, 86.51it/s][A
VAD Processing:  74%|███████▍  | 8559/11511 [01:39<00:34, 86.50it/s][A
VAD Processing:  74%|███████▍  | 8568/11511 [01:40<00:34, 86.56it/s][A
VAD Processing:  75%|███████▍  | 8577/11511 [01:40<00:33, 86.59it/s][A
VAD Processing:  75%|███████▍  | 8586/11511 [01:40<00:33, 86.62it/s][A
VAD Processing:  75%|███████▍  | 8595/11511 [01:40<00:33, 86.68it/s][A
VAD Processing:  75%|███████▍  | 8604/11511 [01:40<00:33, 86.72it/s][A
VAD Processing:  75%|███████▍  | 8613/11511 [01:40<00:33, 86.71it/s][A
VAD Processing:  75%|███████▍  | 8622/11511 [01:40<00:33, 86.68it/s][A
VAD Processing:  75%|███████▍  | 8631/11511 [01:40<00:33, 86.68it/s][A
VAD Processing:  75%|███████▌  | 8640/11511 [01:40<00:33, 86.68it/s][A
VAD Processing:  75%|███████▌  | 8649/11511 [01:41<00:33, 86.68it/s][A
VAD Processing:  75%|███████▌  | 8658/11511 [01:41<00:32, 86.68it/s][A
VAD Processing:  75%|███████▌  | 8667/11511 [01:41<00:32, 86.67it/s][A
VAD Processing:  75%|███████▌  | 8676/11511 [01:41<00:32, 86.66it/s][A
VAD Processing:  75%|███████▌  | 8685/11511 [01:41<00:32, 86.66it/s][A
VAD Processing:  76%|███████▌  | 8694/11511 [01:41<00:32, 86.64it/s][A
VAD Processing:  76%|███████▌  | 8703/11511 [01:41<00:32, 86.70it/s][A
VAD Processing:  76%|███████▌  | 8712/11511 [01:41<00:32, 86.71it/s][A
VAD Processing:  76%|███████▌  | 8721/11511 [01:41<00:32, 86.74it/s][A
VAD Processing:  76%|███████▌  | 8730/11511 [01:41<00:32, 86.72it/s][A
VAD Processing:  76%|███████▌  | 8739/11511 [01:42<00:31, 86.71it/s][A
VAD Processing:  76%|███████▌  | 8748/11511 [01:42<00:31, 86.68it/s][A
VAD Processing:  76%|███████▌  | 8757/11511 [01:42<00:31, 86.71it/s][A
VAD Processing:  76%|███████▌  | 8766/11511 [01:42<00:31, 86.73it/s][A
VAD Processing:  76%|███████▌  | 8775/11511 [01:42<00:31, 86.74it/s][A
VAD Processing:  76%|███████▋  | 8784/11511 [01:42<00:31, 86.74it/s][A
VAD Processing:  76%|███████▋  | 8793/11511 [01:42<00:31, 86.76it/s][A
VAD Processing:  76%|███████▋  | 8802/11511 [01:42<00:31, 86.73it/s][A
VAD Processing:  77%|███████▋  | 8811/11511 [01:42<00:31, 86.74it/s][A
VAD Processing:  77%|███████▋  | 8820/11511 [01:42<00:31, 86.80it/s][A
VAD Processing:  77%|███████▋  | 8829/11511 [01:43<00:30, 86.75it/s][A
VAD Processing:  77%|███████▋  | 8838/11511 [01:43<00:30, 86.73it/s][A
VAD Processing:  77%|███████▋  | 8847/11511 [01:43<00:30, 86.73it/s][A
VAD Processing:  77%|███████▋  | 8856/11511 [01:43<00:30, 86.70it/s][A
VAD Processing:  77%|███████▋  | 8865/11511 [01:43<00:30, 86.69it/s][A
VAD Processing:  77%|███████▋  | 8874/11511 [01:43<00:30, 86.67it/s][A
VAD Processing:  77%|███████▋  | 8883/11511 [01:43<00:30, 86.69it/s][A
VAD Processing:  77%|███████▋  | 8892/11511 [01:43<00:30, 86.70it/s][A
VAD Processing:  77%|███████▋  | 8901/11511 [01:43<00:30, 86.66it/s][A
VAD Processing:  77%|███████▋  | 8910/11511 [01:44<00:30, 86.61it/s][A
VAD Processing:  77%|███████▋  | 8919/11511 [01:44<00:29, 86.63it/s][A
VAD Processing:  78%|███████▊  | 8928/11511 [01:44<00:29, 86.63it/s][A
VAD Processing:  78%|███████▊  | 8937/11511 [01:44<00:29, 86.68it/s][A
VAD Processing:  78%|███████▊  | 8946/11511 [01:44<00:29, 86.69it/s][A
VAD Processing:  78%|███████▊  | 8955/11511 [01:44<00:29, 86.69it/s][A
VAD Processing:  78%|███████▊  | 8964/11511 [01:44<00:29, 86.72it/s][A
VAD Processing:  78%|███████▊  | 8973/11511 [01:44<00:29, 86.72it/s][A
VAD Processing:  78%|███████▊  | 8982/11511 [01:44<00:29, 86.71it/s][A
VAD Processing:  78%|███████▊  | 8991/11511 [01:44<00:29, 86.71it/s][A
VAD Processing:  78%|███████▊  | 9000/11511 [01:45<00:28, 86.69it/s][A
VAD Processing:  78%|███████▊  | 9009/11511 [01:45<00:28, 86.63it/s][A
VAD Processing:  78%|███████▊  | 9018/11511 [01:45<00:28, 86.68it/s][A
VAD Processing:  78%|███████▊  | 9027/11511 [01:45<00:28, 86.02it/s][A
VAD Processing:  78%|███████▊  | 9036/11511 [01:45<00:28, 86.19it/s][A
VAD Processing:  79%|███████▊  | 9045/11511 [01:45<00:28, 86.32it/s][A
VAD Processing:  79%|███████▊  | 9054/11511 [01:45<00:28, 86.43it/s][A
VAD Processing:  79%|███████▊  | 9063/11511 [01:45<00:28, 86.55it/s][A
VAD Processing:  79%|███████▉  | 9072/11511 [01:45<00:28, 86.66it/s][A
VAD Processing:  79%|███████▉  | 9081/11511 [01:45<00:28, 86.71it/s][A
VAD Processing:  79%|███████▉  | 9090/11511 [01:46<00:27, 86.69it/s][A
VAD Processing:  79%|███████▉  | 9099/11511 [01:46<00:27, 86.71it/s][A
VAD Processing:  79%|███████▉  | 9108/11511 [01:46<00:27, 86.64it/s][A
VAD Processing:  79%|███████▉  | 9117/11511 [01:46<00:27, 86.68it/s][A
VAD Processing:  79%|███████▉  | 9126/11511 [01:46<00:27, 86.69it/s][A
VAD Processing:  79%|███████▉  | 9135/11511 [01:46<00:27, 86.67it/s][A
VAD Processing:  79%|███████▉  | 9144/11511 [01:46<00:27, 86.66it/s][A
VAD Processing:  80%|███████▉  | 9153/11511 [01:46<00:27, 86.69it/s][A
VAD Processing:  80%|███████▉  | 9162/11511 [01:46<00:27, 86.70it/s][A
VAD Processing:  80%|███████▉  | 9171/11511 [01:47<00:26, 86.69it/s][A
VAD Processing:  80%|███████▉  | 9180/11511 [01:47<00:26, 86.72it/s][A
VAD Processing:  80%|███████▉  | 9189/11511 [01:47<00:26, 86.73it/s][A
VAD Processing:  80%|███████▉  | 9198/11511 [01:47<00:26, 86.71it/s][A
VAD Processing:  80%|███████▉  | 9207/11511 [01:47<00:26, 86.73it/s][A
VAD Processing:  80%|████████  | 9216/11511 [01:47<00:26, 86.71it/s][A
VAD Processing:  80%|████████  | 9225/11511 [01:47<00:26, 86.71it/s][A
VAD Processing:  80%|████████  | 9234/11511 [01:47<00:26, 86.72it/s][A
VAD Processing:  80%|████████  | 9243/11511 [01:47<00:26, 86.74it/s][A
VAD Processing:  80%|████████  | 9252/11511 [01:47<00:26, 86.73it/s][A
VAD Processing:  80%|████████  | 9261/11511 [01:48<00:25, 86.71it/s][A
VAD Processing:  81%|████████  | 9270/11511 [01:48<00:25, 86.69it/s][A
VAD Processing:  81%|████████  | 9279/11511 [01:48<00:25, 86.70it/s][A
VAD Processing:  81%|████████  | 9288/11511 [01:48<00:25, 86.69it/s][A
VAD Processing:  81%|████████  | 9297/11511 [01:48<00:25, 86.66it/s][A
VAD Processing:  81%|████████  | 9306/11511 [01:48<00:25, 86.66it/s][A
VAD Processing:  81%|████████  | 9315/11511 [01:48<00:25, 86.70it/s][A
VAD Processing:  81%|████████  | 9324/11511 [01:48<00:25, 86.72it/s][A
VAD Processing:  81%|████████  | 9333/11511 [01:48<00:25, 86.71it/s][A
VAD Processing:  81%|████████  | 9342/11511 [01:49<00:25, 86.70it/s][A
VAD Processing:  81%|████████  | 9351/11511 [01:49<00:24, 86.70it/s][A
VAD Processing:  81%|████████▏ | 9360/11511 [01:49<00:24, 86.71it/s][A
VAD Processing:  81%|████████▏ | 9369/11511 [01:49<00:24, 86.73it/s][A
VAD Processing:  81%|████████▏ | 9378/11511 [01:49<00:24, 86.71it/s][A
VAD Processing:  82%|████████▏ | 9387/11511 [01:49<00:24, 86.68it/s][A
VAD Processing:  82%|████████▏ | 9396/11511 [01:49<00:24, 86.73it/s][A
VAD Processing:  82%|████████▏ | 9405/11511 [01:49<00:24, 86.75it/s][A
VAD Processing:  82%|████████▏ | 9414/11511 [01:49<00:24, 86.76it/s][A
VAD Processing:  82%|████████▏ | 9423/11511 [01:49<00:24, 86.65it/s][A
VAD Processing:  82%|████████▏ | 9432/11511 [01:50<00:23, 86.79it/s][A
VAD Processing:  82%|████████▏ | 9441/11511 [01:50<00:23, 86.77it/s][A
VAD Processing:  82%|████████▏ | 9450/11511 [01:50<00:23, 86.79it/s][A
VAD Processing:  82%|████████▏ | 9459/11511 [01:50<00:23, 86.79it/s][A
VAD Processing:  82%|████████▏ | 9468/11511 [01:50<00:23, 86.78it/s][A
VAD Processing:  82%|████████▏ | 9477/11511 [01:50<00:23, 86.79it/s][A
VAD Processing:  82%|████████▏ | 9486/11511 [01:50<00:23, 86.79it/s][A
VAD Processing:  82%|████████▏ | 9495/11511 [01:50<00:23, 86.78it/s][A
VAD Processing:  83%|████████▎ | 9504/11511 [01:50<00:23, 86.77it/s][A
VAD Processing:  83%|████████▎ | 9513/11511 [01:50<00:23, 86.77it/s][A
VAD Processing:  83%|████████▎ | 9522/11511 [01:51<00:22, 86.75it/s][A
VAD Processing:  83%|████████▎ | 9531/11511 [01:51<00:22, 86.73it/s][A
VAD Processing:  83%|████████▎ | 9540/11511 [01:51<00:22, 86.75it/s][A
VAD Processing:  83%|████████▎ | 9549/11511 [01:51<00:22, 86.76it/s][A
VAD Processing:  83%|████████▎ | 9558/11511 [01:51<00:22, 86.75it/s][A
VAD Processing:  83%|████████▎ | 9567/11511 [01:51<00:22, 86.75it/s][A
VAD Processing:  83%|████████▎ | 9576/11511 [01:51<00:22, 86.74it/s][A
VAD Processing:  83%|████████▎ | 9585/11511 [01:51<00:22, 86.74it/s][A
VAD Processing:  83%|████████▎ | 9594/11511 [01:51<00:22, 86.76it/s][A
VAD Processing:  83%|████████▎ | 9603/11511 [01:52<00:21, 86.78it/s][A
VAD Processing:  84%|████████▎ | 9612/11511 [01:52<00:21, 86.74it/s][A
VAD Processing:  84%|████████▎ | 9621/11511 [01:52<00:21, 86.75it/s][A
VAD Processing:  84%|████████▎ | 9630/11511 [01:52<00:21, 86.75it/s][A
VAD Processing:  84%|████████▎ | 9639/11511 [01:52<00:21, 86.78it/s][A
VAD Processing:  84%|████████▍ | 9648/11511 [01:52<00:21, 86.80it/s][A
VAD Processing:  84%|████████▍ | 9657/11511 [01:52<00:21, 86.83it/s][A
VAD Processing:  84%|████████▍ | 9666/11511 [01:52<00:21, 86.80it/s][A
VAD Processing:  84%|████████▍ | 9675/11511 [01:52<00:21, 86.80it/s][A
VAD Processing:  84%|████████▍ | 9684/11511 [01:52<00:21, 86.80it/s][A
VAD Processing:  84%|████████▍ | 9693/11511 [01:53<00:20, 86.80it/s][A
VAD Processing:  84%|████████▍ | 9702/11511 [01:53<00:20, 86.78it/s][A
VAD Processing:  84%|████████▍ | 9711/11511 [01:53<00:20, 86.79it/s][A
VAD Processing:  84%|████████▍ | 9720/11511 [01:53<00:20, 86.76it/s][A
VAD Processing:  85%|████████▍ | 9729/11511 [01:53<00:20, 86.77it/s][A
VAD Processing:  85%|████████▍ | 9738/11511 [01:53<00:20, 86.74it/s][A
VAD Processing:  85%|████████▍ | 9747/11511 [01:53<00:20, 86.74it/s][A
VAD Processing:  85%|████████▍ | 9756/11511 [01:53<00:20, 86.74it/s][A
VAD Processing:  85%|████████▍ | 9765/11511 [01:53<00:20, 86.42it/s][A
VAD Processing:  85%|████████▍ | 9774/11511 [01:53<00:20, 86.50it/s][A
VAD Processing:  85%|████████▍ | 9783/11511 [01:54<00:19, 86.59it/s][A
VAD Processing:  85%|████████▌ | 9792/11511 [01:54<00:19, 86.64it/s][A
VAD Processing:  85%|████████▌ | 9801/11511 [01:54<00:19, 86.67it/s][A
VAD Processing:  85%|████████▌ | 9810/11511 [01:54<00:19, 86.69it/s][A
VAD Processing:  85%|████████▌ | 9819/11511 [01:54<00:19, 86.71it/s][A
VAD Processing:  85%|████████▌ | 9828/11511 [01:54<00:19, 86.67it/s][A
VAD Processing:  85%|████████▌ | 9837/11511 [01:54<00:19, 86.68it/s][A
VAD Processing:  86%|████████▌ | 9846/11511 [01:54<00:19, 86.66it/s][A
VAD Processing:  86%|████████▌ | 9855/11511 [01:54<00:19, 86.68it/s][A
VAD Processing:  86%|████████▌ | 9864/11511 [01:55<00:19, 86.68it/s][A
VAD Processing:  86%|████████▌ | 9873/11511 [01:55<00:18, 86.70it/s][A
VAD Processing:  86%|████████▌ | 9882/11511 [01:55<00:18, 86.71it/s][A
VAD Processing:  86%|████████▌ | 9891/11511 [01:55<00:18, 86.73it/s][A
VAD Processing:  86%|████████▌ | 9900/11511 [01:55<00:18, 86.71it/s][A
VAD Processing:  86%|████████▌ | 9909/11511 [01:55<00:18, 86.73it/s][A
VAD Processing:  86%|████████▌ | 9918/11511 [01:55<00:18, 86.69it/s][A
VAD Processing:  86%|████████▌ | 9927/11511 [01:55<00:18, 86.70it/s][A
VAD Processing:  86%|████████▋ | 9936/11511 [01:55<00:18, 86.76it/s][A
VAD Processing:  86%|████████▋ | 9945/11511 [01:55<00:18, 86.74it/s][A
VAD Processing:  86%|████████▋ | 9954/11511 [01:56<00:17, 86.74it/s][A
VAD Processing:  87%|████████▋ | 9963/11511 [01:56<00:17, 86.76it/s][A
VAD Processing:  87%|████████▋ | 9972/11511 [01:56<00:17, 86.72it/s][A
VAD Processing:  87%|████████▋ | 9981/11511 [01:56<00:17, 86.82it/s][A
VAD Processing:  87%|████████▋ | 9990/11511 [01:56<00:17, 86.79it/s][A
VAD Processing:  87%|████████▋ | 9999/11511 [01:56<00:17, 86.76it/s][A
VAD Processing:  87%|████████▋ | 10008/11511 [01:56<00:17, 86.75it/s][A
VAD Processing:  87%|████████▋ | 10017/11511 [01:56<00:17, 86.75it/s][A
VAD Processing:  87%|████████▋ | 10026/11511 [01:56<00:17, 86.76it/s][A
VAD Processing:  87%|████████▋ | 10035/11511 [01:56<00:17, 86.72it/s][A
VAD Processing:  87%|████████▋ | 10044/11511 [01:57<00:16, 86.67it/s][A
VAD Processing:  87%|████████▋ | 10053/11511 [01:57<00:16, 86.58it/s][A
VAD Processing:  87%|████████▋ | 10062/11511 [01:57<00:16, 86.59it/s][A
VAD Processing:  87%|████████▋ | 10071/11511 [01:57<00:16, 86.55it/s][A
VAD Processing:  88%|████████▊ | 10080/11511 [01:57<00:16, 86.58it/s][A
VAD Processing:  88%|████████▊ | 10089/11511 [01:57<00:16, 86.62it/s][A
VAD Processing:  88%|████████▊ | 10098/11511 [01:57<00:16, 86.69it/s][A
VAD Processing:  88%|████████▊ | 10107/11511 [01:57<00:16, 86.65it/s][A
VAD Processing:  88%|████████▊ | 10116/11511 [01:57<00:16, 86.75it/s][A
VAD Processing:  88%|████████▊ | 10125/11511 [01:58<00:15, 86.78it/s][A
VAD Processing:  88%|████████▊ | 10134/11511 [01:58<00:15, 86.76it/s][A
VAD Processing:  88%|████████▊ | 10143/11511 [01:58<00:15, 86.65it/s][A
VAD Processing:  88%|████████▊ | 10152/11511 [01:58<00:15, 86.77it/s][A
VAD Processing:  88%|████████▊ | 10161/11511 [01:58<00:15, 86.76it/s][A
VAD Processing:  88%|████████▊ | 10170/11511 [01:58<00:15, 86.77it/s][A
VAD Processing:  88%|████████▊ | 10179/11511 [01:58<00:15, 86.75it/s][A
VAD Processing:  89%|████████▊ | 10188/11511 [01:58<00:15, 86.76it/s][A
VAD Processing:  89%|████████▊ | 10197/11511 [01:58<00:15, 86.84it/s][A
VAD Processing:  89%|████████▊ | 10206/11511 [01:58<00:15, 86.78it/s][A
VAD Processing:  89%|████████▊ | 10215/11511 [01:59<00:14, 86.78it/s][A
VAD Processing:  89%|████████▉ | 10224/11511 [01:59<00:14, 86.73it/s][A
VAD Processing:  89%|████████▉ | 10233/11511 [01:59<00:14, 86.74it/s][A
VAD Processing:  89%|████████▉ | 10242/11511 [01:59<00:14, 86.76it/s][A
VAD Processing:  89%|████████▉ | 10251/11511 [01:59<00:14, 86.70it/s][A
VAD Processing:  89%|████████▉ | 10260/11511 [01:59<00:14, 86.59it/s][A
VAD Processing:  89%|████████▉ | 10269/11511 [01:59<00:14, 86.57it/s][A
VAD Processing:  89%|████████▉ | 10278/11511 [01:59<00:14, 86.58it/s][A
VAD Processing:  89%|████████▉ | 10287/11511 [01:59<00:14, 86.62it/s][A
VAD Processing:  89%|████████▉ | 10296/11511 [02:00<00:14, 86.65it/s][A
VAD Processing:  90%|████████▉ | 10305/11511 [02:00<00:13, 86.67it/s][A
VAD Processing:  90%|████████▉ | 10314/11511 [02:00<00:13, 86.67it/s][A
VAD Processing:  90%|████████▉ | 10323/11511 [02:00<00:13, 86.68it/s][A
VAD Processing:  90%|████████▉ | 10332/11511 [02:00<00:13, 86.69it/s][A
VAD Processing:  90%|████████▉ | 10341/11511 [02:00<00:13, 86.71it/s][A
VAD Processing:  90%|████████▉ | 10350/11511 [02:00<00:13, 86.69it/s][A
VAD Processing:  90%|████████▉ | 10359/11511 [02:00<00:13, 86.70it/s][A
VAD Processing:  90%|█████████ | 10368/11511 [02:00<00:13, 86.62it/s][A
VAD Processing:  90%|█████████ | 10377/11511 [02:00<00:13, 86.67it/s][A
VAD Processing:  90%|█████████ | 10386/11511 [02:01<00:12, 86.68it/s][A
VAD Processing:  90%|█████████ | 10395/11511 [02:01<00:12, 86.65it/s][A
VAD Processing:  90%|█████████ | 10404/11511 [02:01<00:12, 86.69it/s][A
VAD Processing:  90%|█████████ | 10413/11511 [02:01<00:12, 86.71it/s][A
VAD Processing:  91%|█████████ | 10422/11511 [02:01<00:12, 86.65it/s][A
VAD Processing:  91%|█████████ | 10431/11511 [02:01<00:12, 86.77it/s][A
VAD Processing:  91%|█████████ | 10440/11511 [02:01<00:12, 86.73it/s][A
VAD Processing:  91%|█████████ | 10449/11511 [02:01<00:12, 86.75it/s][A
VAD Processing:  91%|█████████ | 10458/11511 [02:01<00:12, 86.76it/s][A
VAD Processing:  91%|█████████ | 10467/11511 [02:01<00:12, 86.77it/s][A
VAD Processing:  91%|█████████ | 10476/11511 [02:02<00:11, 86.60it/s][A
VAD Processing:  91%|█████████ | 10485/11511 [02:02<00:11, 86.80it/s][A
VAD Processing:  91%|█████████ | 10494/11511 [02:02<00:11, 86.91it/s][A
VAD Processing:  91%|█████████ | 10503/11511 [02:02<00:11, 86.85it/s][A
VAD Processing:  91%|█████████▏| 10512/11511 [02:02<00:11, 86.80it/s][A
VAD Processing:  91%|█████████▏| 10521/11511 [02:02<00:11, 86.78it/s][A
VAD Processing:  91%|█████████▏| 10530/11511 [02:02<00:11, 86.76it/s][A
VAD Processing:  92%|█████████▏| 10539/11511 [02:02<00:11, 86.76it/s][A
VAD Processing:  92%|█████████▏| 10548/11511 [02:02<00:11, 86.76it/s][A
VAD Processing:  92%|█████████▏| 10557/11511 [02:03<00:10, 86.74it/s][A
VAD Processing:  92%|█████████▏| 10566/11511 [02:03<00:10, 86.72it/s][A
VAD Processing:  92%|█████████▏| 10575/11511 [02:03<00:10, 86.70it/s][A
VAD Processing:  92%|█████████▏| 10584/11511 [02:03<00:10, 86.59it/s][A
VAD Processing:  92%|█████████▏| 10593/11511 [02:03<00:10, 86.63it/s][A
VAD Processing:  92%|█████████▏| 10602/11511 [02:03<00:10, 86.67it/s][A
VAD Processing:  92%|█████████▏| 10611/11511 [02:03<00:10, 86.59it/s][A
VAD Processing:  92%|█████████▏| 10620/11511 [02:03<00:10, 86.61it/s][A
VAD Processing:  92%|█████████▏| 10629/11511 [02:03<00:10, 86.60it/s][A
VAD Processing:  92%|█████████▏| 10638/11511 [02:03<00:10, 86.11it/s][A
VAD Processing:  92%|█████████▏| 10647/11511 [02:04<00:10, 86.27it/s][A
VAD Processing:  93%|█████████▎| 10656/11511 [02:04<00:09, 86.40it/s][A
VAD Processing:  93%|█████████▎| 10665/11511 [02:04<00:09, 86.47it/s][A
VAD Processing:  93%|█████████▎| 10674/11511 [02:04<00:09, 86.55it/s][A
VAD Processing:  93%|█████████▎| 10683/11511 [02:04<00:09, 86.59it/s][A
VAD Processing:  93%|█████████▎| 10692/11511 [02:04<00:09, 86.62it/s][A
VAD Processing:  93%|█████████▎| 10701/11511 [02:04<00:09, 86.64it/s][A
VAD Processing:  93%|█████████▎| 10710/11511 [02:04<00:09, 86.66it/s][A
VAD Processing:  93%|█████████▎| 10719/11511 [02:04<00:09, 86.68it/s][A
VAD Processing:  93%|█████████▎| 10728/11511 [02:04<00:09, 86.68it/s][A
VAD Processing:  93%|█████████▎| 10737/11511 [02:05<00:08, 86.71it/s][A
VAD Processing:  93%|█████████▎| 10746/11511 [02:05<00:08, 86.66it/s][A
VAD Processing:  93%|█████████▎| 10755/11511 [02:05<00:08, 86.67it/s][A
VAD Processing:  94%|█████████▎| 10764/11511 [02:05<00:08, 86.60it/s][A
VAD Processing:  94%|█████████▎| 10773/11511 [02:05<00:08, 86.72it/s][A
VAD Processing:  94%|█████████▎| 10782/11511 [02:05<00:08, 86.72it/s][A
VAD Processing:  94%|█████████▎| 10791/11511 [02:05<00:08, 86.73it/s][A
VAD Processing:  94%|█████████▍| 10800/11511 [02:05<00:08, 86.72it/s][A
VAD Processing:  94%|█████████▍| 10809/11511 [02:05<00:08, 86.74it/s][A
VAD Processing:  94%|█████████▍| 10818/11511 [02:06<00:07, 86.75it/s][A
VAD Processing:  94%|█████████▍| 10827/11511 [02:06<00:07, 86.77it/s][A
VAD Processing:  94%|█████████▍| 10836/11511 [02:06<00:07, 86.78it/s][A
VAD Processing:  94%|█████████▍| 10845/11511 [02:06<00:07, 86.69it/s][A
VAD Processing:  94%|█████████▍| 10854/11511 [02:06<00:07, 86.72it/s][A
VAD Processing:  94%|█████████▍| 10863/11511 [02:06<00:07, 86.73it/s][A
VAD Processing:  94%|█████████▍| 10872/11511 [02:06<00:07, 86.75it/s][A
VAD Processing:  95%|█████████▍| 10881/11511 [02:06<00:07, 86.71it/s][A
VAD Processing:  95%|█████████▍| 10890/11511 [02:06<00:07, 86.71it/s][A
VAD Processing:  95%|█████████▍| 10899/11511 [02:06<00:07, 86.69it/s][A
VAD Processing:  95%|█████████▍| 10908/11511 [02:07<00:06, 86.77it/s][A
VAD Processing:  95%|█████████▍| 10917/11511 [02:07<00:06, 86.69it/s][A
VAD Processing:  95%|█████████▍| 10926/11511 [02:07<00:06, 86.70it/s][A
VAD Processing:  95%|█████████▍| 10935/11511 [02:07<00:06, 86.72it/s][A
VAD Processing:  95%|█████████▌| 10944/11511 [02:07<00:06, 86.75it/s][A
VAD Processing:  95%|█████████▌| 10953/11511 [02:07<00:06, 86.73it/s][A
VAD Processing:  95%|█████████▌| 10962/11511 [02:07<00:06, 86.70it/s][A
VAD Processing:  95%|█████████▌| 10971/11511 [02:07<00:06, 86.72it/s][A
VAD Processing:  95%|█████████▌| 10980/11511 [02:07<00:06, 86.74it/s][A
VAD Processing:  95%|█████████▌| 10989/11511 [02:08<00:06, 86.73it/s][A
VAD Processing:  96%|█████████▌| 10998/11511 [02:08<00:05, 86.72it/s][A
VAD Processing:  96%|█████████▌| 11007/11511 [02:08<00:05, 86.75it/s][A
VAD Processing:  96%|█████████▌| 11016/11511 [02:08<00:05, 86.73it/s][A
VAD Processing:  96%|█████████▌| 11025/11511 [02:08<00:05, 86.71it/s][A
VAD Processing:  96%|█████████▌| 11034/11511 [02:08<00:05, 86.71it/s][A
VAD Processing:  96%|█████████▌| 11043/11511 [02:08<00:05, 86.59it/s][A
VAD Processing:  96%|█████████▌| 11052/11511 [02:08<00:05, 86.59it/s][A
VAD Processing:  96%|█████████▌| 11061/11511 [02:08<00:05, 86.63it/s][A
VAD Processing:  96%|█████████▌| 11070/11511 [02:08<00:05, 86.68it/s][A
VAD Processing:  96%|█████████▌| 11079/11511 [02:09<00:04, 86.74it/s][A
VAD Processing:  96%|█████████▋| 11088/11511 [02:09<00:04, 86.71it/s][A
VAD Processing:  96%|█████████▋| 11097/11511 [02:09<00:04, 86.70it/s][A
VAD Processing:  96%|█████████▋| 11106/11511 [02:09<00:04, 86.71it/s][A
VAD Processing:  97%|█████████▋| 11115/11511 [02:09<00:04, 86.70it/s][A
VAD Processing:  97%|█████████▋| 11124/11511 [02:09<00:04, 86.79it/s][A
VAD Processing:  97%|█████████▋| 11133/11511 [02:09<00:04, 86.71it/s][A
VAD Processing:  97%|█████████▋| 11142/11511 [02:09<00:04, 86.68it/s][A
VAD Processing:  97%|█████████▋| 11151/11511 [02:09<00:04, 86.73it/s][A
VAD Processing:  97%|█████████▋| 11160/11511 [02:09<00:04, 86.71it/s][A
VAD Processing:  97%|█████████▋| 11169/11511 [02:10<00:03, 86.70it/s][A
VAD Processing:  97%|█████████▋| 11178/11511 [02:10<00:03, 86.70it/s][A
VAD Processing:  97%|█████████▋| 11187/11511 [02:10<00:03, 86.71it/s][A
VAD Processing:  97%|█████████▋| 11196/11511 [02:10<00:03, 86.73it/s][A
VAD Processing:  97%|█████████▋| 11205/11511 [02:10<00:03, 86.75it/s][A
VAD Processing:  97%|█████████▋| 11214/11511 [02:10<00:03, 86.75it/s][A
VAD Processing:  97%|█████████▋| 11223/11511 [02:10<00:03, 86.74it/s][A
VAD Processing:  98%|█████████▊| 11232/11511 [02:10<00:03, 86.74it/s][A
VAD Processing:  98%|█████████▊| 11241/11511 [02:10<00:03, 86.81it/s][A
VAD Processing:  98%|█████████▊| 11250/11511 [02:11<00:03, 86.74it/s][A
VAD Processing:  98%|█████████▊| 11259/11511 [02:11<00:02, 86.74it/s][A
VAD Processing:  98%|█████████▊| 11268/11511 [02:11<00:02, 86.74it/s][A
VAD Processing:  98%|█████████▊| 11277/11511 [02:11<00:02, 86.74it/s][A
VAD Processing:  98%|█████████▊| 11286/11511 [02:11<00:02, 86.74it/s][A
VAD Processing:  98%|█████████▊| 11295/11511 [02:11<00:02, 86.71it/s][A
VAD Processing:  98%|█████████▊| 11304/11511 [02:11<00:02, 86.70it/s][A
VAD Processing:  98%|█████████▊| 11313/11511 [02:11<00:02, 86.74it/s][A
VAD Processing:  98%|█████████▊| 11322/11511 [02:11<00:02, 86.75it/s][A
VAD Processing:  98%|█████████▊| 11331/11511 [02:11<00:02, 86.74it/s][A
VAD Processing:  99%|█████████▊| 11340/11511 [02:12<00:01, 86.75it/s][A
VAD Processing:  99%|█████████▊| 11349/11511 [02:12<00:01, 86.75it/s][A
VAD Processing:  99%|█████████▊| 11358/11511 [02:12<00:01, 86.75it/s][A
VAD Processing:  99%|█████████▊| 11367/11511 [02:12<00:01, 86.75it/s][A
VAD Processing:  99%|█████████▉| 11376/11511 [02:12<00:01, 86.72it/s][A
VAD Processing:  99%|█████████▉| 11385/11511 [02:12<00:01, 86.38it/s][A
VAD Processing:  99%|█████████▉| 11394/11511 [02:12<00:01, 86.27it/s][A
VAD Processing:  99%|█████████▉| 11403/11511 [02:12<00:01, 86.32it/s][A
VAD Processing:  99%|█████████▉| 11412/11511 [02:12<00:01, 86.46it/s][A
VAD Processing:  99%|█████████▉| 11421/11511 [02:12<00:01, 86.60it/s][A
VAD Processing:  99%|█████████▉| 11430/11511 [02:13<00:00, 86.60it/s][A
VAD Processing:  99%|█████████▉| 11439/11511 [02:13<00:00, 86.68it/s][A
VAD Processing:  99%|█████████▉| 11448/11511 [02:13<00:00, 86.64it/s][A
VAD Processing: 100%|█████████▉| 11457/11511 [02:13<00:00, 86.63it/s][A
VAD Processing: 100%|█████████▉| 11466/11511 [02:13<00:00, 86.59it/s][A
VAD Processing: 100%|█████████▉| 11475/11511 [02:13<00:00, 86.19it/s][A
VAD Processing: 100%|█████████▉| 11484/11511 [02:13<00:00, 86.28it/s][A
VAD Processing: 100%|█████████▉| 11493/11511 [02:13<00:00, 86.40it/s][A
VAD Processing: 100%|█████████▉| 11502/11511 [02:13<00:00, 85.77it/s][A
VAD Processing: 100%|██████████| 11511/11511 [02:14<00:00, 85.99it/s][AVAD Processing: 100%|██████████| 11511/11511 [02:14<00:00, 85.88it/s]
Saving frames in vad_output_frames/Harker-ES.frame
 50%|█████     | 2/4 [03:12<03:28, 104.11s/it]Trying /nlp/scr/askhan1/clipped_umd/data/noisy/clipped/Harker-MN.wav

VAD Processing:   0%|          | 0/2400 [00:00<?, ?it/s][A
VAD Processing:   0%|          | 9/2400 [00:00<00:27, 86.60it/s][A
VAD Processing:   1%|          | 18/2400 [00:00<00:27, 86.80it/s][A
VAD Processing:   1%|          | 27/2400 [00:00<00:27, 86.94it/s][A
VAD Processing:   2%|▏         | 36/2400 [00:00<00:27, 86.99it/s][A
VAD Processing:   2%|▏         | 45/2400 [00:00<00:27, 87.00it/s][A
VAD Processing:   2%|▏         | 54/2400 [00:00<00:26, 87.01it/s][A
VAD Processing:   3%|▎         | 63/2400 [00:00<00:26, 87.00it/s][A
VAD Processing:   3%|▎         | 72/2400 [00:00<00:26, 86.98it/s][A
VAD Processing:   3%|▎         | 81/2400 [00:00<00:26, 86.98it/s][A
VAD Processing:   4%|▍         | 90/2400 [00:01<00:26, 86.99it/s][A
VAD Processing:   4%|▍         | 99/2400 [00:01<00:26, 87.00it/s][A
VAD Processing:   4%|▍         | 108/2400 [00:01<00:26, 86.99it/s][A
VAD Processing:   5%|▍         | 117/2400 [00:01<00:26, 87.01it/s][A
VAD Processing:   5%|▌         | 126/2400 [00:01<00:26, 86.97it/s][A
VAD Processing:   6%|▌         | 135/2400 [00:01<00:26, 86.96it/s][A
VAD Processing:   6%|▌         | 144/2400 [00:01<00:25, 87.01it/s][A
VAD Processing:   6%|▋         | 153/2400 [00:01<00:25, 87.02it/s][A
VAD Processing:   7%|▋         | 162/2400 [00:01<00:25, 87.05it/s][A
VAD Processing:   7%|▋         | 171/2400 [00:01<00:25, 87.03it/s][A
VAD Processing:   8%|▊         | 180/2400 [00:02<00:25, 87.03it/s][A
VAD Processing:   8%|▊         | 189/2400 [00:02<00:25, 87.04it/s][A
VAD Processing:   8%|▊         | 198/2400 [00:02<00:25, 86.99it/s][A
VAD Processing:   9%|▊         | 207/2400 [00:02<00:25, 87.02it/s][A
VAD Processing:   9%|▉         | 216/2400 [00:02<00:25, 87.02it/s][A
VAD Processing:   9%|▉         | 225/2400 [00:02<00:24, 87.02it/s][A
VAD Processing:  10%|▉         | 234/2400 [00:02<00:24, 87.02it/s][A
VAD Processing:  10%|█         | 243/2400 [00:02<00:24, 87.04it/s][A
VAD Processing:  10%|█         | 252/2400 [00:02<00:24, 87.02it/s][A
VAD Processing:  11%|█         | 261/2400 [00:03<00:24, 86.99it/s][A
VAD Processing:  11%|█▏        | 270/2400 [00:03<00:24, 86.98it/s][A
VAD Processing:  12%|█▏        | 279/2400 [00:03<00:24, 86.93it/s][A
VAD Processing:  12%|█▏        | 288/2400 [00:03<00:24, 86.92it/s][A
VAD Processing:  12%|█▏        | 297/2400 [00:03<00:24, 86.94it/s][A
VAD Processing:  13%|█▎        | 306/2400 [00:03<00:24, 86.95it/s][A
VAD Processing:  13%|█▎        | 315/2400 [00:03<00:23, 86.92it/s][A
VAD Processing:  14%|█▎        | 324/2400 [00:03<00:23, 86.96it/s][A
VAD Processing:  14%|█▍        | 333/2400 [00:03<00:23, 87.00it/s][A
VAD Processing:  14%|█▍        | 342/2400 [00:03<00:23, 86.98it/s][A
VAD Processing:  15%|█▍        | 351/2400 [00:04<00:23, 86.99it/s][A
VAD Processing:  15%|█▌        | 360/2400 [00:04<00:23, 86.96it/s][A
VAD Processing:  15%|█▌        | 369/2400 [00:04<00:23, 86.97it/s][A
VAD Processing:  16%|█▌        | 378/2400 [00:04<00:23, 86.98it/s][A
VAD Processing:  16%|█▌        | 387/2400 [00:04<00:23, 87.01it/s][A
VAD Processing:  16%|█▋        | 396/2400 [00:04<00:23, 87.01it/s][A
VAD Processing:  17%|█▋        | 405/2400 [00:04<00:22, 86.97it/s][A
VAD Processing:  17%|█▋        | 414/2400 [00:04<00:22, 86.99it/s][A
VAD Processing:  18%|█▊        | 423/2400 [00:04<00:22, 86.97it/s][A
VAD Processing:  18%|█▊        | 432/2400 [00:04<00:22, 86.94it/s][A
VAD Processing:  18%|█▊        | 441/2400 [00:05<00:22, 86.93it/s][A
VAD Processing:  19%|█▉        | 450/2400 [00:05<00:22, 86.92it/s][A
VAD Processing:  19%|█▉        | 459/2400 [00:05<00:22, 86.91it/s][A
VAD Processing:  20%|█▉        | 468/2400 [00:05<00:22, 86.87it/s][A
VAD Processing:  20%|█▉        | 477/2400 [00:05<00:22, 86.88it/s][A
VAD Processing:  20%|██        | 486/2400 [00:05<00:22, 86.90it/s][A
VAD Processing:  21%|██        | 495/2400 [00:05<00:21, 86.91it/s][A
VAD Processing:  21%|██        | 504/2400 [00:05<00:21, 86.78it/s][A
VAD Processing:  21%|██▏       | 513/2400 [00:05<00:21, 86.89it/s][A
VAD Processing:  22%|██▏       | 522/2400 [00:06<00:21, 86.83it/s][A
VAD Processing:  22%|██▏       | 531/2400 [00:06<00:21, 86.82it/s][A
VAD Processing:  22%|██▎       | 540/2400 [00:06<00:21, 86.85it/s][A
VAD Processing:  23%|██▎       | 549/2400 [00:06<00:21, 86.88it/s][A
VAD Processing:  23%|██▎       | 558/2400 [00:06<00:21, 86.86it/s][A
VAD Processing:  24%|██▎       | 567/2400 [00:06<00:21, 86.88it/s][A
VAD Processing:  24%|██▍       | 576/2400 [00:06<00:20, 86.92it/s][A
VAD Processing:  24%|██▍       | 585/2400 [00:06<00:20, 86.93it/s][A
VAD Processing:  25%|██▍       | 594/2400 [00:06<00:20, 86.91it/s][A
VAD Processing:  25%|██▌       | 603/2400 [00:06<00:20, 86.92it/s][A
VAD Processing:  26%|██▌       | 612/2400 [00:07<00:20, 86.89it/s][A
VAD Processing:  26%|██▌       | 621/2400 [00:07<00:20, 86.90it/s][A
VAD Processing:  26%|██▋       | 630/2400 [00:07<00:20, 86.85it/s][A
VAD Processing:  27%|██▋       | 639/2400 [00:07<00:20, 86.90it/s][A
VAD Processing:  27%|██▋       | 648/2400 [00:07<00:20, 86.92it/s][A
VAD Processing:  27%|██▋       | 657/2400 [00:07<00:20, 86.93it/s][A
VAD Processing:  28%|██▊       | 666/2400 [00:07<00:19, 86.92it/s][A
VAD Processing:  28%|██▊       | 675/2400 [00:07<00:19, 86.91it/s][A
VAD Processing:  28%|██▊       | 684/2400 [00:07<00:19, 86.91it/s][A
VAD Processing:  29%|██▉       | 693/2400 [00:07<00:19, 86.95it/s][A
VAD Processing:  29%|██▉       | 702/2400 [00:08<00:19, 86.94it/s][A
VAD Processing:  30%|██▉       | 711/2400 [00:08<00:19, 86.95it/s][A
VAD Processing:  30%|███       | 720/2400 [00:08<00:19, 86.97it/s][A
VAD Processing:  30%|███       | 729/2400 [00:08<00:19, 86.92it/s][A
VAD Processing:  31%|███       | 738/2400 [00:08<00:19, 86.91it/s][A
VAD Processing:  31%|███       | 747/2400 [00:08<00:19, 86.92it/s][A
VAD Processing:  32%|███▏      | 756/2400 [00:08<00:18, 86.91it/s][A
VAD Processing:  32%|███▏      | 765/2400 [00:08<00:18, 86.81it/s][A
VAD Processing:  32%|███▏      | 774/2400 [00:08<00:19, 85.04it/s][A
VAD Processing:  33%|███▎      | 783/2400 [00:09<00:19, 83.87it/s][A
VAD Processing:  33%|███▎      | 792/2400 [00:09<00:19, 83.05it/s][A
VAD Processing:  33%|███▎      | 801/2400 [00:09<00:19, 83.03it/s][A
VAD Processing:  34%|███▍      | 810/2400 [00:09<00:19, 83.31it/s][A
VAD Processing:  34%|███▍      | 819/2400 [00:09<00:19, 82.46it/s][A
VAD Processing:  34%|███▍      | 828/2400 [00:09<00:18, 83.74it/s][A
VAD Processing:  35%|███▍      | 837/2400 [00:09<00:18, 84.63it/s][A
VAD Processing:  35%|███▌      | 846/2400 [00:09<00:18, 85.33it/s][A
VAD Processing:  36%|███▌      | 855/2400 [00:09<00:17, 85.85it/s][A
VAD Processing:  36%|███▌      | 864/2400 [00:09<00:17, 86.16it/s][A
VAD Processing:  36%|███▋      | 873/2400 [00:10<00:17, 86.45it/s][A
VAD Processing:  37%|███▋      | 882/2400 [00:10<00:17, 86.66it/s][A
VAD Processing:  37%|███▋      | 891/2400 [00:10<00:17, 86.78it/s][A
VAD Processing:  38%|███▊      | 900/2400 [00:10<00:17, 86.86it/s][A
VAD Processing:  38%|███▊      | 909/2400 [00:10<00:17, 86.91it/s][A
VAD Processing:  38%|███▊      | 918/2400 [00:10<00:17, 86.82it/s][A
VAD Processing:  39%|███▊      | 927/2400 [00:10<00:16, 86.91it/s][A
VAD Processing:  39%|███▉      | 936/2400 [00:10<00:16, 86.92it/s][A
VAD Processing:  39%|███▉      | 945/2400 [00:10<00:16, 87.03it/s][A
VAD Processing:  40%|███▉      | 954/2400 [00:11<00:16, 87.01it/s][A
VAD Processing:  40%|████      | 963/2400 [00:11<00:16, 87.02it/s][A
VAD Processing:  40%|████      | 972/2400 [00:11<00:16, 87.04it/s][A
VAD Processing:  41%|████      | 981/2400 [00:11<00:16, 87.06it/s][A
VAD Processing:  41%|████▏     | 990/2400 [00:11<00:16, 87.09it/s][A
VAD Processing:  42%|████▏     | 999/2400 [00:11<00:16, 87.07it/s][A
VAD Processing:  42%|████▏     | 1008/2400 [00:11<00:15, 87.01it/s][A
VAD Processing:  42%|████▏     | 1017/2400 [00:11<00:15, 87.10it/s][A
VAD Processing:  43%|████▎     | 1026/2400 [00:11<00:15, 87.11it/s][A
VAD Processing:  43%|████▎     | 1035/2400 [00:11<00:15, 87.09it/s][A
VAD Processing:  44%|████▎     | 1044/2400 [00:12<00:15, 87.10it/s][A
VAD Processing:  44%|████▍     | 1053/2400 [00:12<00:15, 87.09it/s][A
VAD Processing:  44%|████▍     | 1062/2400 [00:12<00:15, 87.11it/s][A
VAD Processing:  45%|████▍     | 1071/2400 [00:12<00:15, 87.10it/s][A
VAD Processing:  45%|████▌     | 1080/2400 [00:12<00:15, 87.10it/s][A
VAD Processing:  45%|████▌     | 1089/2400 [00:12<00:15, 87.11it/s][A
VAD Processing:  46%|████▌     | 1098/2400 [00:12<00:14, 87.10it/s][A
VAD Processing:  46%|████▌     | 1107/2400 [00:12<00:14, 87.06it/s][A
VAD Processing:  46%|████▋     | 1116/2400 [00:12<00:14, 87.12it/s][A
VAD Processing:  47%|████▋     | 1125/2400 [00:12<00:14, 87.07it/s][A
VAD Processing:  47%|████▋     | 1134/2400 [00:13<00:14, 87.02it/s][A
VAD Processing:  48%|████▊     | 1143/2400 [00:13<00:14, 87.04it/s][A
VAD Processing:  48%|████▊     | 1152/2400 [00:13<00:14, 87.02it/s][A
VAD Processing:  48%|████▊     | 1161/2400 [00:13<00:14, 87.02it/s][A
VAD Processing:  49%|████▉     | 1170/2400 [00:13<00:14, 87.00it/s][A
VAD Processing:  49%|████▉     | 1179/2400 [00:13<00:14, 86.98it/s][A
VAD Processing:  50%|████▉     | 1188/2400 [00:13<00:13, 86.97it/s][A
VAD Processing:  50%|████▉     | 1197/2400 [00:13<00:13, 86.99it/s][A
VAD Processing:  50%|█████     | 1206/2400 [00:13<00:13, 86.89it/s][A
VAD Processing:  51%|█████     | 1215/2400 [00:14<00:13, 86.96it/s][A
VAD Processing:  51%|█████     | 1224/2400 [00:14<00:13, 86.99it/s][A
VAD Processing:  51%|█████▏    | 1233/2400 [00:14<00:13, 86.98it/s][A
VAD Processing:  52%|█████▏    | 1242/2400 [00:14<00:13, 86.99it/s][A
VAD Processing:  52%|█████▏    | 1251/2400 [00:14<00:13, 86.99it/s][A
VAD Processing:  52%|█████▎    | 1260/2400 [00:14<00:13, 87.00it/s][A
VAD Processing:  53%|█████▎    | 1269/2400 [00:14<00:13, 86.98it/s][A
VAD Processing:  53%|█████▎    | 1278/2400 [00:14<00:12, 86.99it/s][A
VAD Processing:  54%|█████▎    | 1287/2400 [00:14<00:12, 86.99it/s][A
VAD Processing:  54%|█████▍    | 1296/2400 [00:14<00:12, 86.95it/s][A
VAD Processing:  54%|█████▍    | 1305/2400 [00:15<00:12, 87.06it/s][A
VAD Processing:  55%|█████▍    | 1314/2400 [00:15<00:12, 86.98it/s][A
VAD Processing:  55%|█████▌    | 1323/2400 [00:15<00:12, 87.00it/s][A
VAD Processing:  56%|█████▌    | 1332/2400 [00:15<00:12, 86.98it/s][A
VAD Processing:  56%|█████▌    | 1341/2400 [00:15<00:12, 86.98it/s][A
VAD Processing:  56%|█████▋    | 1350/2400 [00:15<00:12, 86.87it/s][A
VAD Processing:  57%|█████▋    | 1359/2400 [00:15<00:11, 86.94it/s][A
VAD Processing:  57%|█████▋    | 1368/2400 [00:15<00:11, 86.95it/s][A
VAD Processing:  57%|█████▋    | 1377/2400 [00:15<00:11, 87.00it/s][A
VAD Processing:  58%|█████▊    | 1386/2400 [00:15<00:11, 87.01it/s][A
VAD Processing:  58%|█████▊    | 1395/2400 [00:16<00:11, 87.08it/s][A
VAD Processing:  58%|█████▊    | 1404/2400 [00:16<00:11, 86.98it/s][A
VAD Processing:  59%|█████▉    | 1413/2400 [00:16<00:11, 87.01it/s][A
VAD Processing:  59%|█████▉    | 1422/2400 [00:16<00:11, 87.07it/s][A
VAD Processing:  60%|█████▉    | 1431/2400 [00:16<00:11, 87.04it/s][A
VAD Processing:  60%|██████    | 1440/2400 [00:16<00:11, 87.06it/s][A
VAD Processing:  60%|██████    | 1449/2400 [00:16<00:10, 87.04it/s][A
VAD Processing:  61%|██████    | 1458/2400 [00:16<00:10, 87.02it/s][A
VAD Processing:  61%|██████    | 1467/2400 [00:16<00:10, 87.02it/s][A
VAD Processing:  62%|██████▏   | 1476/2400 [00:17<00:10, 86.97it/s][A
VAD Processing:  62%|██████▏   | 1485/2400 [00:17<00:10, 86.99it/s][A
VAD Processing:  62%|██████▏   | 1494/2400 [00:17<00:10, 87.09it/s][A
VAD Processing:  63%|██████▎   | 1503/2400 [00:17<00:10, 87.07it/s][A
VAD Processing:  63%|██████▎   | 1512/2400 [00:17<00:10, 87.10it/s][A
VAD Processing:  63%|██████▎   | 1521/2400 [00:17<00:10, 87.05it/s][A
VAD Processing:  64%|██████▍   | 1530/2400 [00:17<00:09, 87.02it/s][A
VAD Processing:  64%|██████▍   | 1539/2400 [00:17<00:09, 86.99it/s][A
VAD Processing:  64%|██████▍   | 1548/2400 [00:17<00:09, 86.99it/s][A
VAD Processing:  65%|██████▍   | 1557/2400 [00:17<00:09, 86.97it/s][A
VAD Processing:  65%|██████▌   | 1566/2400 [00:18<00:09, 86.99it/s][A
VAD Processing:  66%|██████▌   | 1575/2400 [00:18<00:09, 86.96it/s][A
VAD Processing:  66%|██████▌   | 1584/2400 [00:18<00:09, 86.94it/s][A
VAD Processing:  66%|██████▋   | 1593/2400 [00:18<00:09, 86.98it/s][A
VAD Processing:  67%|██████▋   | 1602/2400 [00:18<00:09, 86.97it/s][A
VAD Processing:  67%|██████▋   | 1611/2400 [00:18<00:09, 87.01it/s][A
VAD Processing:  68%|██████▊   | 1620/2400 [00:18<00:08, 86.97it/s][A
VAD Processing:  68%|██████▊   | 1629/2400 [00:18<00:08, 86.98it/s][A
VAD Processing:  68%|██████▊   | 1638/2400 [00:18<00:08, 86.98it/s][A
VAD Processing:  69%|██████▊   | 1647/2400 [00:18<00:08, 87.00it/s][A
VAD Processing:  69%|██████▉   | 1656/2400 [00:19<00:08, 86.98it/s][A
VAD Processing:  69%|██████▉   | 1665/2400 [00:19<00:08, 87.01it/s][A
VAD Processing:  70%|██████▉   | 1674/2400 [00:19<00:08, 86.98it/s][A
VAD Processing:  70%|███████   | 1683/2400 [00:19<00:08, 87.00it/s][A
VAD Processing:  70%|███████   | 1692/2400 [00:19<00:08, 86.54it/s][A
VAD Processing:  71%|███████   | 1701/2400 [00:19<00:08, 86.68it/s][A
VAD Processing:  71%|███████▏  | 1710/2400 [00:19<00:07, 86.76it/s][A
VAD Processing:  72%|███████▏  | 1719/2400 [00:19<00:07, 86.84it/s][A
VAD Processing:  72%|███████▏  | 1728/2400 [00:19<00:07, 86.78it/s][A
VAD Processing:  72%|███████▏  | 1737/2400 [00:20<00:07, 87.00it/s][A
VAD Processing:  73%|███████▎  | 1746/2400 [00:20<00:07, 86.97it/s][A
VAD Processing:  73%|███████▎  | 1755/2400 [00:20<00:07, 86.96it/s][A
VAD Processing:  74%|███████▎  | 1764/2400 [00:20<00:07, 86.91it/s][A
VAD Processing:  74%|███████▍  | 1773/2400 [00:20<00:07, 86.90it/s][A
VAD Processing:  74%|███████▍  | 1782/2400 [00:20<00:07, 86.94it/s][A
VAD Processing:  75%|███████▍  | 1791/2400 [00:20<00:07, 86.94it/s][A
VAD Processing:  75%|███████▌  | 1800/2400 [00:20<00:06, 86.94it/s][A
VAD Processing:  75%|███████▌  | 1809/2400 [00:20<00:06, 86.98it/s][A
VAD Processing:  76%|███████▌  | 1818/2400 [00:20<00:06, 86.99it/s][A
VAD Processing:  76%|███████▌  | 1827/2400 [00:21<00:06, 86.98it/s][A
VAD Processing:  76%|███████▋  | 1836/2400 [00:21<00:06, 87.02it/s][A
VAD Processing:  77%|███████▋  | 1845/2400 [00:21<00:06, 87.01it/s][A
VAD Processing:  77%|███████▋  | 1854/2400 [00:21<00:06, 87.01it/s][A
VAD Processing:  78%|███████▊  | 1863/2400 [00:21<00:06, 87.00it/s][A
VAD Processing:  78%|███████▊  | 1872/2400 [00:21<00:06, 87.01it/s][A
VAD Processing:  78%|███████▊  | 1881/2400 [00:21<00:05, 87.00it/s][A
VAD Processing:  79%|███████▉  | 1890/2400 [00:21<00:05, 86.97it/s][A
VAD Processing:  79%|███████▉  | 1899/2400 [00:21<00:05, 86.98it/s][A
VAD Processing:  80%|███████▉  | 1908/2400 [00:21<00:05, 86.96it/s][A
VAD Processing:  80%|███████▉  | 1917/2400 [00:22<00:05, 86.93it/s][A
VAD Processing:  80%|████████  | 1926/2400 [00:22<00:05, 86.94it/s][A
VAD Processing:  81%|████████  | 1935/2400 [00:22<00:05, 86.98it/s][A
VAD Processing:  81%|████████  | 1944/2400 [00:22<00:05, 86.98it/s][A
VAD Processing:  81%|████████▏ | 1953/2400 [00:22<00:05, 86.97it/s][A
VAD Processing:  82%|████████▏ | 1962/2400 [00:22<00:05, 86.97it/s][A
VAD Processing:  82%|████████▏ | 1971/2400 [00:22<00:04, 86.95it/s][A
VAD Processing:  82%|████████▎ | 1980/2400 [00:22<00:04, 86.98it/s][A
VAD Processing:  83%|████████▎ | 1989/2400 [00:22<00:04, 87.00it/s][A
VAD Processing:  83%|████████▎ | 1998/2400 [00:23<00:04, 87.02it/s][A
VAD Processing:  84%|████████▎ | 2007/2400 [00:23<00:04, 86.99it/s][A
VAD Processing:  84%|████████▍ | 2016/2400 [00:23<00:04, 87.01it/s][A
VAD Processing:  84%|████████▍ | 2025/2400 [00:23<00:04, 86.96it/s][A
VAD Processing:  85%|████████▍ | 2034/2400 [00:23<00:04, 86.90it/s][A
VAD Processing:  85%|████████▌ | 2043/2400 [00:23<00:04, 87.05it/s][A
VAD Processing:  86%|████████▌ | 2052/2400 [00:23<00:04, 86.99it/s][A
VAD Processing:  86%|████████▌ | 2061/2400 [00:23<00:03, 86.96it/s][A
VAD Processing:  86%|████████▋ | 2070/2400 [00:23<00:03, 87.03it/s][A
VAD Processing:  87%|████████▋ | 2079/2400 [00:23<00:03, 87.07it/s][A
VAD Processing:  87%|████████▋ | 2088/2400 [00:24<00:03, 87.04it/s][A
VAD Processing:  87%|████████▋ | 2097/2400 [00:24<00:03, 87.00it/s][A
VAD Processing:  88%|████████▊ | 2106/2400 [00:24<00:03, 87.01it/s][A
VAD Processing:  88%|████████▊ | 2115/2400 [00:24<00:03, 87.01it/s][A
VAD Processing:  88%|████████▊ | 2124/2400 [00:24<00:03, 87.02it/s][A
VAD Processing:  89%|████████▉ | 2133/2400 [00:24<00:03, 87.02it/s][A
VAD Processing:  89%|████████▉ | 2142/2400 [00:24<00:02, 86.96it/s][A
VAD Processing:  90%|████████▉ | 2151/2400 [00:24<00:02, 86.96it/s][A
VAD Processing:  90%|█████████ | 2160/2400 [00:24<00:02, 86.96it/s][A
VAD Processing:  90%|█████████ | 2169/2400 [00:24<00:02, 86.95it/s][A
VAD Processing:  91%|█████████ | 2178/2400 [00:25<00:02, 86.96it/s][A
VAD Processing:  91%|█████████ | 2187/2400 [00:25<00:02, 87.00it/s][A
VAD Processing:  92%|█████████▏| 2196/2400 [00:25<00:02, 86.98it/s][A
VAD Processing:  92%|█████████▏| 2205/2400 [00:25<00:02, 86.98it/s][A
VAD Processing:  92%|█████████▏| 2214/2400 [00:25<00:02, 86.97it/s][A
VAD Processing:  93%|█████████▎| 2223/2400 [00:25<00:02, 86.98it/s][A
VAD Processing:  93%|█████████▎| 2232/2400 [00:25<00:01, 86.99it/s][A
VAD Processing:  93%|█████████▎| 2241/2400 [00:25<00:01, 86.95it/s][A
VAD Processing:  94%|█████████▍| 2250/2400 [00:25<00:01, 86.96it/s][A
VAD Processing:  94%|█████████▍| 2259/2400 [00:26<00:01, 86.95it/s][A
VAD Processing:  94%|█████████▍| 2268/2400 [00:26<00:01, 86.98it/s][A
VAD Processing:  95%|█████████▍| 2277/2400 [00:26<00:01, 86.94it/s][A
VAD Processing:  95%|█████████▌| 2286/2400 [00:26<00:01, 87.08it/s][A
VAD Processing:  96%|█████████▌| 2295/2400 [00:26<00:01, 87.06it/s][A
VAD Processing:  96%|█████████▌| 2304/2400 [00:26<00:01, 87.10it/s][A
VAD Processing:  96%|█████████▋| 2313/2400 [00:26<00:00, 87.01it/s][A
VAD Processing:  97%|█████████▋| 2322/2400 [00:26<00:00, 86.94it/s][A
VAD Processing:  97%|█████████▋| 2331/2400 [00:26<00:00, 86.93it/s][A
VAD Processing:  98%|█████████▊| 2340/2400 [00:26<00:00, 86.93it/s][A
VAD Processing:  98%|█████████▊| 2349/2400 [00:27<00:00, 86.91it/s][A
VAD Processing:  98%|█████████▊| 2358/2400 [00:27<00:00, 86.88it/s][A
VAD Processing:  99%|█████████▊| 2367/2400 [00:27<00:00, 86.84it/s][A
VAD Processing:  99%|█████████▉| 2376/2400 [00:27<00:00, 86.84it/s][A
VAD Processing:  99%|█████████▉| 2385/2400 [00:27<00:00, 86.87it/s][A
VAD Processing: 100%|█████████▉| 2394/2400 [00:27<00:00, 86.84it/s][AVAD Processing: 100%|██████████| 2400/2400 [00:27<00:00, 86.85it/s]
Saving frames in vad_output_frames/Harker-MN.frame
 75%|███████▌  | 3/4 [03:41<01:09, 69.81s/it] Trying /nlp/scr/askhan1/clipped_umd/data/noisy/clipped/Longfellow-Block-1.wav

VAD Processing:   0%|          | 0/2400 [00:00<?, ?it/s][A
VAD Processing:   0%|          | 9/2400 [00:00<00:27, 86.23it/s][A
VAD Processing:   1%|          | 18/2400 [00:00<00:27, 86.66it/s][A
VAD Processing:   1%|          | 27/2400 [00:00<00:27, 86.61it/s][A
VAD Processing:   2%|▏         | 36/2400 [00:00<00:27, 86.63it/s][A
VAD Processing:   2%|▏         | 45/2400 [00:00<00:27, 86.60it/s][A
VAD Processing:   2%|▏         | 54/2400 [00:00<00:27, 86.57it/s][A
VAD Processing:   3%|▎         | 63/2400 [00:00<00:26, 86.68it/s][A
VAD Processing:   3%|▎         | 72/2400 [00:00<00:26, 86.79it/s][A
VAD Processing:   3%|▎         | 81/2400 [00:00<00:26, 86.84it/s][A
VAD Processing:   4%|▍         | 90/2400 [00:01<00:26, 86.80it/s][A
VAD Processing:   4%|▍         | 99/2400 [00:01<00:26, 86.74it/s][A
VAD Processing:   4%|▍         | 108/2400 [00:01<00:26, 86.73it/s][A
VAD Processing:   5%|▍         | 117/2400 [00:01<00:26, 86.70it/s][A
VAD Processing:   5%|▌         | 126/2400 [00:01<00:26, 86.71it/s][A
VAD Processing:   6%|▌         | 135/2400 [00:01<00:26, 86.70it/s][A
VAD Processing:   6%|▌         | 144/2400 [00:01<00:26, 86.65it/s][A
VAD Processing:   6%|▋         | 153/2400 [00:01<00:25, 86.73it/s][A
VAD Processing:   7%|▋         | 162/2400 [00:01<00:25, 86.71it/s][A
VAD Processing:   7%|▋         | 171/2400 [00:01<00:25, 86.70it/s][A
VAD Processing:   8%|▊         | 180/2400 [00:02<00:25, 86.71it/s][A
VAD Processing:   8%|▊         | 189/2400 [00:02<00:25, 86.69it/s][A
VAD Processing:   8%|▊         | 198/2400 [00:02<00:25, 86.62it/s][A
VAD Processing:   9%|▊         | 207/2400 [00:02<00:25, 86.64it/s][A
VAD Processing:   9%|▉         | 216/2400 [00:02<00:25, 86.65it/s][A
VAD Processing:   9%|▉         | 225/2400 [00:02<00:25, 86.64it/s][A
VAD Processing:  10%|▉         | 234/2400 [00:02<00:24, 86.74it/s][A
VAD Processing:  10%|█         | 243/2400 [00:02<00:24, 86.68it/s][A
VAD Processing:  10%|█         | 252/2400 [00:02<00:24, 86.61it/s][A
VAD Processing:  11%|█         | 261/2400 [00:03<00:24, 86.65it/s][A
VAD Processing:  11%|█▏        | 270/2400 [00:03<00:24, 86.67it/s][A
VAD Processing:  12%|█▏        | 279/2400 [00:03<00:24, 86.67it/s][A
VAD Processing:  12%|█▏        | 288/2400 [00:03<00:24, 86.62it/s][A
VAD Processing:  12%|█▏        | 297/2400 [00:03<00:24, 86.64it/s][A
VAD Processing:  13%|█▎        | 306/2400 [00:03<00:24, 85.71it/s][A
VAD Processing:  13%|█▎        | 315/2400 [00:03<00:24, 85.98it/s][A
VAD Processing:  14%|█▎        | 324/2400 [00:03<00:24, 86.18it/s][A
VAD Processing:  14%|█▍        | 333/2400 [00:03<00:23, 86.31it/s][A
VAD Processing:  14%|█▍        | 342/2400 [00:03<00:23, 86.37it/s][A
VAD Processing:  15%|█▍        | 351/2400 [00:04<00:23, 86.43it/s][A
VAD Processing:  15%|█▌        | 360/2400 [00:04<00:23, 86.46it/s][A
VAD Processing:  15%|█▌        | 369/2400 [00:04<00:23, 86.52it/s][A
VAD Processing:  16%|█▌        | 378/2400 [00:04<00:23, 86.57it/s][A
VAD Processing:  16%|█▌        | 387/2400 [00:04<00:23, 86.57it/s][A
VAD Processing:  16%|█▋        | 396/2400 [00:04<00:23, 86.57it/s][A
VAD Processing:  17%|█▋        | 405/2400 [00:04<00:23, 86.55it/s][A
VAD Processing:  17%|█▋        | 414/2400 [00:04<00:23, 85.64it/s][A
VAD Processing:  18%|█▊        | 423/2400 [00:04<00:23, 84.29it/s][A
VAD Processing:  18%|█▊        | 432/2400 [00:05<00:23, 84.40it/s][A
VAD Processing:  18%|█▊        | 441/2400 [00:05<00:23, 85.12it/s][A
VAD Processing:  19%|█▉        | 450/2400 [00:05<00:22, 85.54it/s][A
VAD Processing:  19%|█▉        | 459/2400 [00:05<00:22, 85.91it/s][A
VAD Processing:  20%|█▉        | 468/2400 [00:05<00:22, 86.11it/s][A
VAD Processing:  20%|█▉        | 477/2400 [00:05<00:22, 84.74it/s][A
VAD Processing:  20%|██        | 486/2400 [00:05<00:22, 84.80it/s][A
VAD Processing:  21%|██        | 495/2400 [00:05<00:22, 85.34it/s][A
VAD Processing:  21%|██        | 504/2400 [00:05<00:22, 85.73it/s][A
VAD Processing:  21%|██▏       | 513/2400 [00:05<00:21, 86.06it/s][A
VAD Processing:  22%|██▏       | 522/2400 [00:06<00:21, 86.21it/s][A
VAD Processing:  22%|██▏       | 531/2400 [00:06<00:21, 86.34it/s][A
VAD Processing:  22%|██▎       | 540/2400 [00:06<00:21, 86.42it/s][A
VAD Processing:  23%|██▎       | 549/2400 [00:06<00:21, 86.52it/s][A
VAD Processing:  23%|██▎       | 558/2400 [00:06<00:21, 86.53it/s][A
VAD Processing:  24%|██▎       | 567/2400 [00:06<00:21, 86.56it/s][A
VAD Processing:  24%|██▍       | 576/2400 [00:06<00:21, 86.58it/s][A
VAD Processing:  24%|██▍       | 585/2400 [00:06<00:20, 86.61it/s][A
VAD Processing:  25%|██▍       | 594/2400 [00:06<00:20, 86.65it/s][A
VAD Processing:  25%|██▌       | 603/2400 [00:06<00:20, 86.69it/s][A
VAD Processing:  26%|██▌       | 612/2400 [00:07<00:20, 86.75it/s][A
VAD Processing:  26%|██▌       | 621/2400 [00:07<00:20, 86.67it/s][A
VAD Processing:  26%|██▋       | 630/2400 [00:07<00:20, 86.68it/s][A
VAD Processing:  27%|██▋       | 639/2400 [00:07<00:20, 86.65it/s][A
VAD Processing:  27%|██▋       | 648/2400 [00:07<00:20, 86.61it/s][A
VAD Processing:  27%|██▋       | 657/2400 [00:07<00:20, 86.63it/s][A
VAD Processing:  28%|██▊       | 666/2400 [00:07<00:20, 86.67it/s][A
VAD Processing:  28%|██▊       | 675/2400 [00:07<00:19, 86.70it/s][A
VAD Processing:  28%|██▊       | 684/2400 [00:07<00:19, 86.69it/s][A
VAD Processing:  29%|██▉       | 693/2400 [00:08<00:19, 86.69it/s][A
VAD Processing:  29%|██▉       | 702/2400 [00:08<00:19, 86.65it/s][A
VAD Processing:  30%|██▉       | 711/2400 [00:08<00:19, 86.64it/s][A
VAD Processing:  30%|███       | 720/2400 [00:08<00:19, 86.60it/s][A
VAD Processing:  30%|███       | 729/2400 [00:08<00:19, 86.58it/s][A
VAD Processing:  31%|███       | 738/2400 [00:08<00:19, 86.63it/s][A
VAD Processing:  31%|███       | 747/2400 [00:08<00:19, 86.59it/s][A
VAD Processing:  32%|███▏      | 756/2400 [00:08<00:18, 86.55it/s][A
VAD Processing:  32%|███▏      | 765/2400 [00:08<00:18, 86.58it/s][A
VAD Processing:  32%|███▏      | 774/2400 [00:08<00:18, 86.72it/s][A
VAD Processing:  33%|███▎      | 783/2400 [00:09<00:18, 86.71it/s][A
VAD Processing:  33%|███▎      | 792/2400 [00:09<00:18, 86.81it/s][A
VAD Processing:  33%|███▎      | 801/2400 [00:09<00:18, 86.84it/s][A
VAD Processing:  34%|███▍      | 810/2400 [00:09<00:18, 86.78it/s][A
VAD Processing:  34%|███▍      | 819/2400 [00:09<00:18, 86.71it/s][A
VAD Processing:  34%|███▍      | 828/2400 [00:09<00:18, 86.63it/s][A
VAD Processing:  35%|███▍      | 837/2400 [00:09<00:18, 86.60it/s][A
VAD Processing:  35%|███▌      | 846/2400 [00:09<00:17, 86.55it/s][A
VAD Processing:  36%|███▌      | 855/2400 [00:09<00:17, 86.54it/s][A
VAD Processing:  36%|███▌      | 864/2400 [00:09<00:17, 86.56it/s][A
VAD Processing:  36%|███▋      | 873/2400 [00:10<00:17, 86.58it/s][A
VAD Processing:  37%|███▋      | 882/2400 [00:10<00:17, 86.59it/s][A
VAD Processing:  37%|███▋      | 891/2400 [00:10<00:17, 86.62it/s][A
VAD Processing:  38%|███▊      | 900/2400 [00:10<00:17, 86.58it/s][A
VAD Processing:  38%|███▊      | 909/2400 [00:10<00:17, 86.61it/s][A
VAD Processing:  38%|███▊      | 918/2400 [00:10<00:17, 86.70it/s][A
VAD Processing:  39%|███▊      | 927/2400 [00:10<00:16, 86.66it/s][A
VAD Processing:  39%|███▉      | 936/2400 [00:10<00:16, 86.65it/s][A
VAD Processing:  39%|███▉      | 945/2400 [00:10<00:16, 86.62it/s][A
VAD Processing:  40%|███▉      | 954/2400 [00:11<00:16, 86.60it/s][A
VAD Processing:  40%|████      | 963/2400 [00:11<00:16, 86.57it/s][A
VAD Processing:  40%|████      | 972/2400 [00:11<00:16, 86.68it/s][A
VAD Processing:  41%|████      | 981/2400 [00:11<00:16, 86.70it/s][A
VAD Processing:  41%|████▏     | 990/2400 [00:11<00:16, 86.67it/s][A
VAD Processing:  42%|████▏     | 999/2400 [00:11<00:16, 86.67it/s][A
VAD Processing:  42%|████▏     | 1008/2400 [00:11<00:16, 86.58it/s][A
VAD Processing:  42%|████▏     | 1017/2400 [00:11<00:15, 86.64it/s][A
VAD Processing:  43%|████▎     | 1026/2400 [00:11<00:15, 86.59it/s][A
VAD Processing:  43%|████▎     | 1035/2400 [00:11<00:15, 86.76it/s][A
VAD Processing:  44%|████▎     | 1044/2400 [00:12<00:15, 86.75it/s][A
VAD Processing:  44%|████▍     | 1053/2400 [00:12<00:15, 86.72it/s][A
VAD Processing:  44%|████▍     | 1062/2400 [00:12<00:15, 86.74it/s][A
VAD Processing:  45%|████▍     | 1071/2400 [00:12<00:15, 86.70it/s][A
VAD Processing:  45%|████▌     | 1080/2400 [00:12<00:15, 86.67it/s][A
VAD Processing:  45%|████▌     | 1089/2400 [00:12<00:15, 86.63it/s][A
VAD Processing:  46%|████▌     | 1098/2400 [00:12<00:15, 86.60it/s][A
VAD Processing:  46%|████▌     | 1107/2400 [00:12<00:14, 86.76it/s][A
VAD Processing:  46%|████▋     | 1116/2400 [00:12<00:14, 86.70it/s][A
VAD Processing:  47%|████▋     | 1125/2400 [00:13<00:14, 86.67it/s][A
VAD Processing:  47%|████▋     | 1134/2400 [00:13<00:14, 86.63it/s][A
VAD Processing:  48%|████▊     | 1143/2400 [00:13<00:14, 86.64it/s][A
VAD Processing:  48%|████▊     | 1152/2400 [00:13<00:14, 86.69it/s][A
VAD Processing:  48%|████▊     | 1161/2400 [00:13<00:14, 86.69it/s][A
VAD Processing:  49%|████▉     | 1170/2400 [00:13<00:14, 86.64it/s][A
VAD Processing:  49%|████▉     | 1179/2400 [00:13<00:14, 86.58it/s][A
VAD Processing:  50%|████▉     | 1188/2400 [00:13<00:14, 86.55it/s][A
VAD Processing:  50%|████▉     | 1197/2400 [00:13<00:13, 86.55it/s][A
VAD Processing:  50%|█████     | 1206/2400 [00:13<00:13, 86.53it/s][A
VAD Processing:  51%|█████     | 1215/2400 [00:14<00:13, 86.50it/s][A
VAD Processing:  51%|█████     | 1224/2400 [00:14<00:13, 86.64it/s][A
VAD Processing:  51%|█████▏    | 1233/2400 [00:14<00:13, 86.66it/s][A
VAD Processing:  52%|█████▏    | 1242/2400 [00:14<00:13, 86.69it/s][A
VAD Processing:  52%|█████▏    | 1251/2400 [00:14<00:13, 86.64it/s][A
VAD Processing:  52%|█████▎    | 1260/2400 [00:14<00:13, 86.64it/s][A
VAD Processing:  53%|█████▎    | 1269/2400 [00:14<00:13, 86.61it/s][A
VAD Processing:  53%|█████▎    | 1278/2400 [00:14<00:12, 86.62it/s][A
VAD Processing:  54%|█████▎    | 1287/2400 [00:14<00:12, 86.59it/s][A
VAD Processing:  54%|█████▍    | 1296/2400 [00:14<00:12, 86.73it/s][A
VAD Processing:  54%|█████▍    | 1305/2400 [00:15<00:12, 86.64it/s][A
VAD Processing:  55%|█████▍    | 1314/2400 [00:15<00:12, 86.66it/s][A
VAD Processing:  55%|█████▌    | 1323/2400 [00:15<00:12, 86.63it/s][A
VAD Processing:  56%|█████▌    | 1332/2400 [00:15<00:12, 86.73it/s][A
VAD Processing:  56%|█████▌    | 1341/2400 [00:15<00:12, 86.70it/s][A
VAD Processing:  56%|█████▋    | 1350/2400 [00:15<00:12, 85.91it/s][A
VAD Processing:  57%|█████▋    | 1359/2400 [00:15<00:12, 86.10it/s][A
VAD Processing:  57%|█████▋    | 1368/2400 [00:15<00:11, 86.35it/s][A
VAD Processing:  57%|█████▋    | 1377/2400 [00:15<00:11, 86.41it/s][A
VAD Processing:  58%|█████▊    | 1386/2400 [00:16<00:11, 86.47it/s][A
VAD Processing:  58%|█████▊    | 1395/2400 [00:16<00:11, 86.55it/s][A
VAD Processing:  58%|█████▊    | 1404/2400 [00:16<00:11, 86.54it/s][A
VAD Processing:  59%|█████▉    | 1413/2400 [00:16<00:11, 86.60it/s][A
VAD Processing:  59%|█████▉    | 1422/2400 [00:16<00:11, 86.56it/s][A
VAD Processing:  60%|█████▉    | 1431/2400 [00:16<00:11, 86.64it/s][A
VAD Processing:  60%|██████    | 1440/2400 [00:16<00:11, 86.60it/s][A
VAD Processing:  60%|██████    | 1449/2400 [00:16<00:10, 86.59it/s][A
VAD Processing:  61%|██████    | 1458/2400 [00:16<00:10, 86.59it/s][A
VAD Processing:  61%|██████    | 1467/2400 [00:16<00:10, 86.62it/s][A
VAD Processing:  62%|██████▏   | 1476/2400 [00:17<00:10, 86.53it/s][A
VAD Processing:  62%|██████▏   | 1485/2400 [00:17<00:10, 86.58it/s][A
VAD Processing:  62%|██████▏   | 1494/2400 [00:17<00:10, 86.60it/s][A
VAD Processing:  63%|██████▎   | 1503/2400 [00:17<00:10, 86.72it/s][A
VAD Processing:  63%|██████▎   | 1512/2400 [00:17<00:10, 86.69it/s][A
VAD Processing:  63%|██████▎   | 1521/2400 [00:17<00:10, 86.65it/s][A
VAD Processing:  64%|██████▍   | 1530/2400 [00:17<00:10, 86.66it/s][A
VAD Processing:  64%|██████▍   | 1539/2400 [00:17<00:09, 86.60it/s][A
VAD Processing:  64%|██████▍   | 1548/2400 [00:17<00:09, 86.59it/s][A
VAD Processing:  65%|██████▍   | 1557/2400 [00:17<00:09, 86.49it/s][A
VAD Processing:  65%|██████▌   | 1566/2400 [00:18<00:09, 86.52it/s][A
VAD Processing:  66%|██████▌   | 1575/2400 [00:18<00:09, 86.56it/s][A
VAD Processing:  66%|██████▌   | 1584/2400 [00:18<00:09, 86.54it/s][A
VAD Processing:  66%|██████▋   | 1593/2400 [00:18<00:09, 86.51it/s][A
VAD Processing:  67%|██████▋   | 1602/2400 [00:18<00:09, 86.54it/s][A
VAD Processing:  67%|██████▋   | 1611/2400 [00:18<00:09, 86.52it/s][A
VAD Processing:  68%|██████▊   | 1620/2400 [00:18<00:09, 86.54it/s][A
VAD Processing:  68%|██████▊   | 1629/2400 [00:18<00:08, 86.52it/s][A
VAD Processing:  68%|██████▊   | 1638/2400 [00:18<00:08, 86.57it/s][A
VAD Processing:  69%|██████▊   | 1647/2400 [00:19<00:08, 86.59it/s][A
VAD Processing:  69%|██████▉   | 1656/2400 [00:19<00:08, 86.61it/s][A
VAD Processing:  69%|██████▉   | 1665/2400 [00:19<00:08, 86.57it/s][A
VAD Processing:  70%|██████▉   | 1674/2400 [00:19<00:08, 86.49it/s][A
VAD Processing:  70%|███████   | 1683/2400 [00:19<00:08, 86.55it/s][A
VAD Processing:  70%|███████   | 1692/2400 [00:19<00:08, 86.56it/s][A
VAD Processing:  71%|███████   | 1701/2400 [00:19<00:08, 86.55it/s][A
VAD Processing:  71%|███████▏  | 1710/2400 [00:19<00:07, 86.56it/s][A
VAD Processing:  72%|███████▏  | 1719/2400 [00:19<00:07, 86.46it/s][A
VAD Processing:  72%|███████▏  | 1728/2400 [00:19<00:07, 86.69it/s][A
VAD Processing:  72%|███████▏  | 1737/2400 [00:20<00:07, 86.68it/s][A
VAD Processing:  73%|███████▎  | 1746/2400 [00:20<00:07, 86.60it/s][A
VAD Processing:  73%|███████▎  | 1755/2400 [00:20<00:07, 86.58it/s][A
VAD Processing:  74%|███████▎  | 1764/2400 [00:20<00:07, 86.60it/s][A
VAD Processing:  74%|███████▍  | 1773/2400 [00:20<00:07, 85.94it/s][A
VAD Processing:  74%|███████▍  | 1782/2400 [00:20<00:07, 84.52it/s][A
VAD Processing:  75%|███████▍  | 1791/2400 [00:20<00:07, 83.58it/s][A
VAD Processing:  75%|███████▌  | 1800/2400 [00:20<00:07, 83.99it/s][A
VAD Processing:  75%|███████▌  | 1809/2400 [00:20<00:06, 84.84it/s][A
VAD Processing:  76%|███████▌  | 1818/2400 [00:21<00:06, 85.35it/s][A
VAD Processing:  76%|███████▌  | 1827/2400 [00:21<00:06, 85.88it/s][A
VAD Processing:  76%|███████▋  | 1836/2400 [00:21<00:06, 86.22it/s][A
VAD Processing:  77%|███████▋  | 1845/2400 [00:21<00:06, 86.38it/s][A
VAD Processing:  77%|███████▋  | 1854/2400 [00:21<00:06, 86.49it/s][A
VAD Processing:  78%|███████▊  | 1863/2400 [00:21<00:06, 86.59it/s][A
VAD Processing:  78%|███████▊  | 1872/2400 [00:21<00:06, 86.77it/s][A
VAD Processing:  78%|███████▊  | 1881/2400 [00:21<00:05, 86.73it/s][A
VAD Processing:  79%|███████▉  | 1890/2400 [00:21<00:05, 86.72it/s][A
VAD Processing:  79%|███████▉  | 1899/2400 [00:21<00:05, 86.83it/s][A
VAD Processing:  80%|███████▉  | 1908/2400 [00:22<00:05, 86.80it/s][A
VAD Processing:  80%|███████▉  | 1917/2400 [00:22<00:05, 86.74it/s][A
VAD Processing:  80%|████████  | 1926/2400 [00:22<00:05, 86.71it/s][A
VAD Processing:  81%|████████  | 1935/2400 [00:22<00:05, 86.86it/s][A
VAD Processing:  81%|████████  | 1944/2400 [00:22<00:05, 86.77it/s][A
VAD Processing:  81%|████████▏ | 1953/2400 [00:22<00:05, 86.77it/s][A
VAD Processing:  82%|████████▏ | 1962/2400 [00:22<00:05, 86.75it/s][A
VAD Processing:  82%|████████▏ | 1971/2400 [00:22<00:04, 86.72it/s][A
VAD Processing:  82%|████████▎ | 1980/2400 [00:22<00:04, 86.70it/s][A
VAD Processing:  83%|████████▎ | 1989/2400 [00:22<00:04, 86.72it/s][A
VAD Processing:  83%|████████▎ | 1998/2400 [00:23<00:04, 86.73it/s][A
VAD Processing:  84%|████████▎ | 2007/2400 [00:23<00:04, 86.75it/s][A
VAD Processing:  84%|████████▍ | 2016/2400 [00:23<00:04, 86.67it/s][A
VAD Processing:  84%|████████▍ | 2025/2400 [00:23<00:04, 86.80it/s][A
VAD Processing:  85%|████████▍ | 2034/2400 [00:23<00:04, 86.74it/s][A
VAD Processing:  85%|████████▌ | 2043/2400 [00:23<00:04, 86.74it/s][A
VAD Processing:  86%|████████▌ | 2052/2400 [00:23<00:04, 86.76it/s][A
VAD Processing:  86%|████████▌ | 2061/2400 [00:23<00:03, 86.76it/s][A
VAD Processing:  86%|████████▋ | 2070/2400 [00:23<00:03, 86.74it/s][A
VAD Processing:  87%|████████▋ | 2079/2400 [00:24<00:03, 86.71it/s][A
VAD Processing:  87%|████████▋ | 2088/2400 [00:24<00:03, 86.69it/s][A
VAD Processing:  87%|████████▋ | 2097/2400 [00:24<00:03, 86.69it/s][A
VAD Processing:  88%|████████▊ | 2106/2400 [00:24<00:03, 86.77it/s][A
VAD Processing:  88%|████████▊ | 2115/2400 [00:24<00:03, 86.76it/s][A
VAD Processing:  88%|████████▊ | 2124/2400 [00:24<00:03, 86.74it/s][A
VAD Processing:  89%|████████▉ | 2133/2400 [00:24<00:03, 86.77it/s][A
VAD Processing:  89%|████████▉ | 2142/2400 [00:24<00:02, 86.77it/s][A
VAD Processing:  90%|████████▉ | 2151/2400 [00:24<00:02, 86.77it/s][A
VAD Processing:  90%|█████████ | 2160/2400 [00:24<00:02, 86.72it/s][A
VAD Processing:  90%|█████████ | 2169/2400 [00:25<00:02, 86.68it/s][A
VAD Processing:  91%|█████████ | 2178/2400 [00:25<00:02, 86.66it/s][A
VAD Processing:  91%|█████████ | 2187/2400 [00:25<00:02, 86.68it/s][A
VAD Processing:  92%|█████████▏| 2196/2400 [00:25<00:02, 86.65it/s][A
VAD Processing:  92%|█████████▏| 2205/2400 [00:25<00:02, 86.70it/s][A
VAD Processing:  92%|█████████▏| 2214/2400 [00:25<00:02, 86.64it/s][A
VAD Processing:  93%|█████████▎| 2223/2400 [00:25<00:02, 86.68it/s][A
VAD Processing:  93%|█████████▎| 2232/2400 [00:25<00:01, 86.68it/s][A
VAD Processing:  93%|█████████▎| 2241/2400 [00:25<00:01, 86.69it/s][A
VAD Processing:  94%|█████████▍| 2250/2400 [00:26<00:01, 86.71it/s][A
VAD Processing:  94%|█████████▍| 2259/2400 [00:26<00:01, 86.71it/s][A
VAD Processing:  94%|█████████▍| 2268/2400 [00:26<00:01, 86.75it/s][A
VAD Processing:  95%|█████████▍| 2277/2400 [00:26<00:01, 86.72it/s][A
VAD Processing:  95%|█████████▌| 2286/2400 [00:26<00:01, 86.75it/s][A
VAD Processing:  96%|█████████▌| 2295/2400 [00:26<00:01, 86.67it/s][A
VAD Processing:  96%|█████████▌| 2304/2400 [00:26<00:01, 86.68it/s][A
VAD Processing:  96%|█████████▋| 2313/2400 [00:26<00:01, 86.71it/s][A
VAD Processing:  97%|█████████▋| 2322/2400 [00:26<00:00, 86.75it/s][A
VAD Processing:  97%|█████████▋| 2331/2400 [00:26<00:00, 86.76it/s][A
VAD Processing:  98%|█████████▊| 2340/2400 [00:27<00:00, 86.72it/s][A
VAD Processing:  98%|█████████▊| 2349/2400 [00:27<00:00, 86.68it/s][A
VAD Processing:  98%|█████████▊| 2358/2400 [00:27<00:00, 86.69it/s][A
VAD Processing:  99%|█████████▊| 2367/2400 [00:27<00:00, 86.68it/s][A
VAD Processing:  99%|█████████▉| 2376/2400 [00:27<00:00, 86.71it/s][A
VAD Processing:  99%|█████████▉| 2385/2400 [00:27<00:00, 86.26it/s][A
VAD Processing: 100%|█████████▉| 2394/2400 [00:27<00:00, 86.36it/s][AVAD Processing: 100%|██████████| 2400/2400 [00:27<00:00, 86.51it/s]
Saving frames in vad_output_frames/Longfellow-Block-1.frame
100%|██████████| 4/4 [04:10<00:00, 53.71s/it]100%|██████████| 4/4 [04:10<00:00, 62.68s/it]
Skipping /nlp/scr/askhan1/clipped_umd/data/noisy/clipped/Longfellow-Block-2.wav, output already exists.
Skipping /nlp/scr/askhan1/clipped_umd/data/noisy/clipped/Harker-ES.wav, output already exists.
Skipping /nlp/scr/askhan1/clipped_umd/data/noisy/clipped/Harker-MN.wav, output already exists.
Skipping /nlp/scr/askhan1/clipped_umd/data/noisy/clipped/Longfellow-Block-1.wav, output already exists.
--------------------------------------------------
Running with alpha=1.0, onset=0.30, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.3, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:04<00:13,  4.58s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:07<00:06,  3.49s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:07<00:02,  2.17s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:08<00:00,  1.54s/it]Processing Audio: 100%|██████████| 4/4 [00:08<00:00,  2.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:48:09 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:48:09 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:48:09 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:48:09 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:48:09 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:48:10 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:48:10 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:48:10 features:305] PADDING: 16
[NeMo I 2025-04-17 00:48:10 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:48:10 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:48:11 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:48:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:48:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:48:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:48:11 collections:880] Dataset successfully loaded with 2553 items and total duration provided from manifest is  1.88 hours.
[NeMo I 2025-04-17 00:48:11 collections:886] # 2553 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][1/6] extract embeddings:   2%|▎         | 1/40 [00:12<07:51, 12.08s/it][1/6] extract embeddings:  10%|█         | 4/40 [00:12<01:24,  2.35s/it][1/6] extract embeddings:  15%|█▌        | 6/40 [00:12<00:48,  1.42s/it][1/6] extract embeddings:  18%|█▊        | 7/40 [00:12<00:37,  1.13s/it][1/6] extract embeddings:  20%|██        | 8/40 [00:13<00:28,  1.12it/s][1/6] extract embeddings:  22%|██▎       | 9/40 [00:13<00:21,  1.43it/s][1/6] extract embeddings:  25%|██▌       | 10/40 [00:13<00:17,  1.76it/s][1/6] extract embeddings:  28%|██▊       | 11/40 [00:13<00:13,  2.10it/s][1/6] extract embeddings:  30%|███       | 12/40 [00:13<00:11,  2.49it/s][1/6] extract embeddings:  32%|███▎      | 13/40 [00:14<00:09,  2.88it/s][1/6] extract embeddings:  35%|███▌      | 14/40 [00:14<00:07,  3.27it/s][1/6] extract embeddings:  38%|███▊      | 15/40 [00:14<00:06,  3.61it/s][1/6] extract embeddings:  40%|████      | 16/40 [00:14<00:05,  4.02it/s][1/6] extract embeddings:  42%|████▎     | 17/40 [00:14<00:05,  4.38it/s][1/6] extract embeddings:  45%|████▌     | 18/40 [00:15<00:04,  4.66it/s][1/6] extract embeddings:  48%|████▊     | 19/40 [00:15<00:04,  4.87it/s][1/6] extract embeddings:  50%|█████     | 20/40 [00:15<00:04,  4.96it/s][1/6] extract embeddings:  52%|█████▎    | 21/40 [00:15<00:03,  5.13it/s][1/6] extract embeddings:  55%|█████▌    | 22/40 [00:15<00:03,  5.41it/s][1/6] extract embeddings:  57%|█████▊    | 23/40 [00:16<00:03,  5.48it/s][1/6] extract embeddings:  60%|██████    | 24/40 [00:16<00:02,  5.44it/s][1/6] extract embeddings:  62%|██████▎   | 25/40 [00:16<00:02,  5.42it/s][1/6] extract embeddings:  65%|██████▌   | 26/40 [00:16<00:02,  5.50it/s][1/6] extract embeddings:  68%|██████▊   | 27/40 [00:16<00:02,  5.27it/s][1/6] extract embeddings:  70%|███████   | 28/40 [00:17<00:02,  5.15it/s][1/6] extract embeddings:  72%|███████▎  | 29/40 [00:17<00:02,  4.91it/s][1/6] extract embeddings:  75%|███████▌  | 30/40 [00:17<00:02,  4.82it/s][1/6] extract embeddings:  78%|███████▊  | 31/40 [00:17<00:01,  4.77it/s][1/6] extract embeddings:  80%|████████  | 32/40 [00:17<00:01,  5.07it/s][1/6] extract embeddings:  82%|████████▎ | 33/40 [00:18<00:01,  5.25it/s][1/6] extract embeddings:  85%|████████▌ | 34/40 [00:18<00:01,  5.01it/s][1/6] extract embeddings:  88%|████████▊ | 35/40 [00:18<00:01,  4.92it/s][1/6] extract embeddings:  90%|█████████ | 36/40 [00:18<00:00,  4.81it/s][1/6] extract embeddings:  92%|█████████▎| 37/40 [00:18<00:00,  4.69it/s][1/6] extract embeddings:  95%|█████████▌| 38/40 [00:19<00:00,  4.65it/s][1/6] extract embeddings:  98%|█████████▊| 39/40 [00:19<00:00,  4.91it/s][1/6] extract embeddings: 100%|██████████| 40/40 [00:19<00:00,  5.01it/s][1/6] extract embeddings: 100%|██████████| 40/40 [00:19<00:00,  2.05it/s]
[NeMo I 2025-04-17 00:48:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:48:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:48:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:48:30 collections:880] Dataset successfully loaded with 3044 items and total duration provided from manifest is  1.92 hours.
[NeMo I 2025-04-17 00:48:30 collections:886] # 3044 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/48 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/48 [00:03<02:46,  3.55s/it][2/6] extract embeddings:   6%|▋         | 3/48 [00:03<00:43,  1.03it/s][2/6] extract embeddings:  10%|█         | 5/48 [00:03<00:22,  1.95it/s][2/6] extract embeddings:  15%|█▍        | 7/48 [00:03<00:13,  3.07it/s][2/6] extract embeddings:  19%|█▉        | 9/48 [00:04<00:09,  4.33it/s][2/6] extract embeddings:  23%|██▎       | 11/48 [00:04<00:06,  5.70it/s][2/6] extract embeddings:  27%|██▋       | 13/48 [00:04<00:04,  7.04it/s][2/6] extract embeddings:  31%|███▏      | 15/48 [00:04<00:04,  8.23it/s][2/6] extract embeddings:  35%|███▌      | 17/48 [00:04<00:03,  9.36it/s][2/6] extract embeddings:  40%|███▉      | 19/48 [00:04<00:02, 10.08it/s][2/6] extract embeddings:  44%|████▍     | 21/48 [00:05<00:02, 10.93it/s][2/6] extract embeddings:  48%|████▊     | 23/48 [00:05<00:02, 11.84it/s][2/6] extract embeddings:  52%|█████▏    | 25/48 [00:05<00:01, 12.39it/s][2/6] extract embeddings:  56%|█████▋    | 27/48 [00:05<00:01, 12.65it/s][2/6] extract embeddings:  60%|██████    | 29/48 [00:05<00:01, 12.85it/s][2/6] extract embeddings:  65%|██████▍   | 31/48 [00:05<00:01, 12.82it/s][2/6] extract embeddings:  69%|██████▉   | 33/48 [00:05<00:01, 13.07it/s][2/6] extract embeddings:  73%|███████▎  | 35/48 [00:06<00:00, 13.19it/s][2/6] extract embeddings:  77%|███████▋  | 37/48 [00:06<00:00, 13.18it/s][2/6] extract embeddings:  81%|████████▏ | 39/48 [00:06<00:00, 13.09it/s][2/6] extract embeddings:  85%|████████▌ | 41/48 [00:06<00:00, 13.24it/s][2/6] extract embeddings:  90%|████████▉ | 43/48 [00:06<00:00, 13.36it/s][2/6] extract embeddings:  94%|█████████▍| 45/48 [00:06<00:00, 13.53it/s][2/6] extract embeddings:  98%|█████████▊| 47/48 [00:06<00:00, 13.45it/s][2/6] extract embeddings: 100%|██████████| 48/48 [00:07<00:00,  6.82it/s]
[NeMo I 2025-04-17 00:48:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:48:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:48:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:48:38 collections:880] Dataset successfully loaded with 3807 items and total duration provided from manifest is  1.97 hours.
[NeMo I 2025-04-17 00:48:38 collections:886] # 3807 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/60 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/60 [00:01<01:19,  1.35s/it][3/6] extract embeddings:   5%|▌         | 3/60 [00:01<00:22,  2.51it/s][3/6] extract embeddings:   8%|▊         | 5/60 [00:01<00:12,  4.37it/s][3/6] extract embeddings:  12%|█▏        | 7/60 [00:01<00:08,  6.27it/s][3/6] extract embeddings:  15%|█▌        | 9/60 [00:01<00:06,  7.85it/s][3/6] extract embeddings:  18%|█▊        | 11/60 [00:02<00:05,  9.63it/s][3/6] extract embeddings:  22%|██▏       | 13/60 [00:02<00:04, 11.54it/s][3/6] extract embeddings:  25%|██▌       | 15/60 [00:02<00:03, 12.80it/s][3/6] extract embeddings:  28%|██▊       | 17/60 [00:02<00:03, 13.94it/s][3/6] extract embeddings:  32%|███▏      | 19/60 [00:02<00:02, 14.80it/s][3/6] extract embeddings:  35%|███▌      | 21/60 [00:02<00:02, 15.51it/s][3/6] extract embeddings:  40%|████      | 24/60 [00:02<00:02, 16.60it/s][3/6] extract embeddings:  43%|████▎     | 26/60 [00:02<00:02, 16.90it/s][3/6] extract embeddings:  47%|████▋     | 28/60 [00:02<00:01, 16.47it/s][3/6] extract embeddings:  50%|█████     | 30/60 [00:03<00:01, 17.30it/s][3/6] extract embeddings:  53%|█████▎    | 32/60 [00:03<00:01, 17.89it/s][3/6] extract embeddings:  57%|█████▋    | 34/60 [00:03<00:01, 18.01it/s][3/6] extract embeddings:  60%|██████    | 36/60 [00:03<00:01, 17.31it/s][3/6] extract embeddings:  63%|██████▎   | 38/60 [00:03<00:01, 17.95it/s][3/6] extract embeddings:  67%|██████▋   | 40/60 [00:03<00:01, 17.86it/s][3/6] extract embeddings:  70%|███████   | 42/60 [00:03<00:00, 18.04it/s][3/6] extract embeddings:  73%|███████▎  | 44/60 [00:03<00:00, 17.45it/s][3/6] extract embeddings:  77%|███████▋  | 46/60 [00:03<00:00, 17.45it/s][3/6] extract embeddings:  80%|████████  | 48/60 [00:04<00:00, 17.46it/s][3/6] extract embeddings:  83%|████████▎ | 50/60 [00:04<00:00, 17.43it/s][3/6] extract embeddings:  87%|████████▋ | 52/60 [00:04<00:00, 16.99it/s][3/6] extract embeddings:  90%|█████████ | 54/60 [00:04<00:00, 16.24it/s][3/6] extract embeddings:  93%|█████████▎| 56/60 [00:04<00:00, 15.81it/s][3/6] extract embeddings:  97%|█████████▋| 58/60 [00:04<00:00, 15.61it/s][3/6] extract embeddings: 100%|██████████| 60/60 [00:04<00:00, 16.59it/s][3/6] extract embeddings: 100%|██████████| 60/60 [00:04<00:00, 12.30it/s]
[NeMo I 2025-04-17 00:48:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:48:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:48:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:48:43 collections:880] Dataset successfully loaded with 5092 items and total duration provided from manifest is  2.02 hours.
[NeMo I 2025-04-17 00:48:43 collections:886] # 5092 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/80 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/80 [00:01<01:34,  1.20s/it][4/6] extract embeddings:   5%|▌         | 4/80 [00:01<00:20,  3.78it/s][4/6] extract embeddings:   8%|▊         | 6/80 [00:01<00:12,  5.82it/s][4/6] extract embeddings:  10%|█         | 8/80 [00:01<00:09,  7.96it/s][4/6] extract embeddings:  12%|█▎        | 10/80 [00:01<00:07,  9.86it/s][4/6] extract embeddings:  16%|█▋        | 13/80 [00:01<00:05, 12.88it/s][4/6] extract embeddings:  20%|██        | 16/80 [00:01<00:04, 14.70it/s][4/6] extract embeddings:  24%|██▍       | 19/80 [00:02<00:03, 16.95it/s][4/6] extract embeddings:  28%|██▊       | 22/80 [00:02<00:03, 17.72it/s][4/6] extract embeddings:  31%|███▏      | 25/80 [00:02<00:02, 18.51it/s][4/6] extract embeddings:  35%|███▌      | 28/80 [00:02<00:02, 19.11it/s][4/6] extract embeddings:  39%|███▉      | 31/80 [00:02<00:02, 19.04it/s][4/6] extract embeddings:  42%|████▎     | 34/80 [00:02<00:02, 19.66it/s][4/6] extract embeddings:  46%|████▋     | 37/80 [00:02<00:02, 19.72it/s][4/6] extract embeddings:  50%|█████     | 40/80 [00:03<00:02, 19.86it/s][4/6] extract embeddings:  54%|█████▍    | 43/80 [00:03<00:01, 19.77it/s][4/6] extract embeddings:  56%|█████▋    | 45/80 [00:03<00:01, 18.74it/s][4/6] extract embeddings:  59%|█████▉    | 47/80 [00:03<00:01, 17.75it/s][4/6] extract embeddings:  61%|██████▏   | 49/80 [00:03<00:01, 16.52it/s][4/6] extract embeddings:  64%|██████▍   | 51/80 [00:03<00:01, 16.13it/s][4/6] extract embeddings:  66%|██████▋   | 53/80 [00:03<00:01, 15.77it/s][4/6] extract embeddings:  69%|██████▉   | 55/80 [00:04<00:01, 15.53it/s][4/6] extract embeddings:  71%|███████▏  | 57/80 [00:04<00:01, 15.11it/s][4/6] extract embeddings:  74%|███████▍  | 59/80 [00:04<00:01, 15.37it/s][4/6] extract embeddings:  76%|███████▋  | 61/80 [00:04<00:01, 15.09it/s][4/6] extract embeddings:  79%|███████▉  | 63/80 [00:04<00:01, 15.34it/s][4/6] extract embeddings:  81%|████████▏ | 65/80 [00:04<00:00, 15.22it/s][4/6] extract embeddings:  84%|████████▍ | 67/80 [00:04<00:00, 15.58it/s][4/6] extract embeddings:  86%|████████▋ | 69/80 [00:05<00:00, 15.20it/s][4/6] extract embeddings:  89%|████████▉ | 71/80 [00:05<00:00, 15.74it/s][4/6] extract embeddings:  91%|█████████▏| 73/80 [00:05<00:00, 15.97it/s][4/6] extract embeddings:  94%|█████████▍| 75/80 [00:05<00:00, 15.32it/s][4/6] extract embeddings:  96%|█████████▋| 77/80 [00:05<00:00, 14.99it/s][4/6] extract embeddings:  99%|█████████▉| 79/80 [00:05<00:00, 15.60it/s][4/6] extract embeddings: 100%|██████████| 80/80 [00:05<00:00, 14.01it/s]
[NeMo I 2025-04-17 00:48:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:48:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:48:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:48:49 collections:880] Dataset successfully loaded with 7691 items and total duration provided from manifest is  2.08 hours.
[NeMo I 2025-04-17 00:48:49 collections:886] # 7691 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/121 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/121 [00:01<03:03,  1.53s/it][5/6] extract embeddings:   3%|▎         | 4/121 [00:01<00:38,  3.07it/s][5/6] extract embeddings:   5%|▍         | 6/121 [00:01<00:23,  4.84it/s][5/6] extract embeddings:   7%|▋         | 9/121 [00:01<00:14,  7.72it/s][5/6] extract embeddings:   9%|▉         | 11/121 [00:02<00:11,  9.52it/s][5/6] extract embeddings:  12%|█▏        | 14/121 [00:02<00:08, 12.62it/s][5/6] extract embeddings:  14%|█▍        | 17/121 [00:02<00:06, 15.03it/s][5/6] extract embeddings:  17%|█▋        | 20/121 [00:02<00:06, 15.49it/s][5/6] extract embeddings:  18%|█▊        | 22/121 [00:02<00:06, 15.85it/s][5/6] extract embeddings:  20%|█▉        | 24/121 [00:02<00:05, 16.66it/s][5/6] extract embeddings:  21%|██▏       | 26/121 [00:02<00:05, 17.03it/s][5/6] extract embeddings:  24%|██▍       | 29/121 [00:02<00:05, 17.87it/s][5/6] extract embeddings:  26%|██▌       | 31/121 [00:03<00:04, 18.38it/s][5/6] extract embeddings:  27%|██▋       | 33/121 [00:03<00:04, 18.30it/s][5/6] extract embeddings:  30%|██▉       | 36/121 [00:03<00:04, 19.79it/s][5/6] extract embeddings:  32%|███▏      | 39/121 [00:03<00:04, 18.98it/s][5/6] extract embeddings:  35%|███▍      | 42/121 [00:03<00:03, 20.21it/s][5/6] extract embeddings:  37%|███▋      | 45/121 [00:03<00:03, 20.76it/s][5/6] extract embeddings:  40%|███▉      | 48/121 [00:03<00:03, 21.55it/s][5/6] extract embeddings:  42%|████▏     | 51/121 [00:03<00:03, 22.71it/s][5/6] extract embeddings:  45%|████▍     | 54/121 [00:04<00:02, 23.88it/s][5/6] extract embeddings:  47%|████▋     | 57/121 [00:04<00:02, 24.27it/s][5/6] extract embeddings:  50%|████▉     | 60/121 [00:04<00:02, 24.37it/s][5/6] extract embeddings:  52%|█████▏    | 63/121 [00:04<00:02, 24.80it/s][5/6] extract embeddings:  55%|█████▍    | 66/121 [00:04<00:02, 24.77it/s][5/6] extract embeddings:  57%|█████▋    | 69/121 [00:04<00:02, 24.61it/s][5/6] extract embeddings:  60%|█████▉    | 72/121 [00:04<00:01, 24.78it/s][5/6] extract embeddings:  62%|██████▏   | 75/121 [00:04<00:01, 24.42it/s][5/6] extract embeddings:  64%|██████▍   | 78/121 [00:05<00:01, 24.79it/s][5/6] extract embeddings:  67%|██████▋   | 81/121 [00:05<00:01, 24.59it/s][5/6] extract embeddings:  69%|██████▉   | 84/121 [00:05<00:01, 24.47it/s][5/6] extract embeddings:  72%|███████▏  | 87/121 [00:05<00:01, 22.86it/s][5/6] extract embeddings:  74%|███████▍  | 90/121 [00:05<00:01, 22.31it/s][5/6] extract embeddings:  77%|███████▋  | 93/121 [00:05<00:01, 22.32it/s][5/6] extract embeddings:  79%|███████▉  | 96/121 [00:05<00:01, 22.42it/s][5/6] extract embeddings:  82%|████████▏ | 99/121 [00:06<00:01, 21.08it/s][5/6] extract embeddings:  84%|████████▍ | 102/121 [00:06<00:00, 20.43it/s][5/6] extract embeddings:  87%|████████▋ | 105/121 [00:06<00:00, 19.63it/s][5/6] extract embeddings:  88%|████████▊ | 107/121 [00:06<00:00, 19.55it/s][5/6] extract embeddings:  90%|█████████ | 109/121 [00:06<00:00, 18.90it/s][5/6] extract embeddings:  92%|█████████▏| 111/121 [00:06<00:00, 18.52it/s][5/6] extract embeddings:  94%|█████████▍| 114/121 [00:06<00:00, 19.01it/s][5/6] extract embeddings:  96%|█████████▌| 116/121 [00:06<00:00, 18.33it/s][5/6] extract embeddings:  98%|█████████▊| 118/121 [00:07<00:00, 18.46it/s][5/6] extract embeddings:  99%|█████████▉| 120/121 [00:07<00:00, 17.54it/s][5/6] extract embeddings: 100%|██████████| 121/121 [00:07<00:00, 16.51it/s]
[NeMo I 2025-04-17 00:48:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:48:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:48:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:48:56 collections:880] Dataset successfully loaded with 15549 items and total duration provided from manifest is  2.13 hours.
[NeMo I 2025-04-17 00:48:56 collections:886] # 15549 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/243 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/243 [00:01<04:47,  1.19s/it][6/6] extract embeddings:   2%|▏         | 4/243 [00:01<01:02,  3.81it/s][6/6] extract embeddings:   3%|▎         | 7/243 [00:01<00:34,  6.77it/s][6/6] extract embeddings:   4%|▎         | 9/243 [00:01<00:27,  8.48it/s][6/6] extract embeddings:   5%|▍         | 12/243 [00:01<00:20, 11.43it/s][6/6] extract embeddings:   6%|▌         | 14/243 [00:01<00:17, 12.97it/s][6/6] extract embeddings:   7%|▋         | 17/243 [00:01<00:15, 14.94it/s][6/6] extract embeddings:   8%|▊         | 20/243 [00:02<00:13, 16.99it/s][6/6] extract embeddings:   9%|▉         | 23/243 [00:02<00:12, 17.67it/s][6/6] extract embeddings:  10%|█         | 25/243 [00:02<00:12, 17.94it/s][6/6] extract embeddings:  12%|█▏        | 28/243 [00:02<00:11, 17.93it/s][6/6] extract embeddings:  12%|█▏        | 30/243 [00:02<00:11, 17.89it/s][6/6] extract embeddings:  14%|█▎        | 33/243 [00:02<00:10, 19.66it/s][6/6] extract embeddings:  15%|█▍        | 36/243 [00:02<00:10, 20.55it/s][6/6] extract embeddings:  16%|█▌        | 39/243 [00:03<00:09, 21.00it/s][6/6] extract embeddings:  17%|█▋        | 42/243 [00:03<00:09, 21.73it/s][6/6] extract embeddings:  19%|█▊        | 45/243 [00:03<00:09, 21.07it/s][6/6] extract embeddings:  20%|█▉        | 48/243 [00:03<00:09, 21.23it/s][6/6] extract embeddings:  21%|██        | 51/243 [00:03<00:09, 21.06it/s][6/6] extract embeddings:  22%|██▏       | 54/243 [00:03<00:08, 21.54it/s][6/6] extract embeddings:  23%|██▎       | 57/243 [00:03<00:08, 21.39it/s][6/6] extract embeddings:  25%|██▍       | 60/243 [00:04<00:08, 21.02it/s][6/6] extract embeddings:  26%|██▌       | 63/243 [00:04<00:08, 20.27it/s][6/6] extract embeddings:  27%|██▋       | 66/243 [00:04<00:09, 19.31it/s][6/6] extract embeddings:  28%|██▊       | 68/243 [00:04<00:09, 18.93it/s][6/6] extract embeddings:  29%|██▉       | 71/243 [00:04<00:08, 19.53it/s][6/6] extract embeddings:  30%|███       | 73/243 [00:04<00:08, 19.46it/s][6/6] extract embeddings:  31%|███▏      | 76/243 [00:04<00:08, 19.38it/s][6/6] extract embeddings:  33%|███▎      | 79/243 [00:05<00:08, 19.97it/s][6/6] extract embeddings:  34%|███▎      | 82/243 [00:05<00:07, 20.81it/s][6/6] extract embeddings:  35%|███▍      | 85/243 [00:05<00:07, 21.31it/s][6/6] extract embeddings:  36%|███▌      | 88/243 [00:05<00:07, 21.25it/s][6/6] extract embeddings:  37%|███▋      | 91/243 [00:05<00:07, 21.29it/s][6/6] extract embeddings:  39%|███▊      | 94/243 [00:05<00:06, 21.51it/s][6/6] extract embeddings:  40%|███▉      | 97/243 [00:05<00:06, 22.04it/s][6/6] extract embeddings:  41%|████      | 100/243 [00:05<00:06, 21.99it/s][6/6] extract embeddings:  42%|████▏     | 103/243 [00:06<00:06, 22.07it/s][6/6] extract embeddings:  44%|████▎     | 106/243 [00:06<00:06, 20.97it/s][6/6] extract embeddings:  45%|████▍     | 109/243 [00:06<00:06, 20.57it/s][6/6] extract embeddings:  46%|████▌     | 112/243 [00:06<00:06, 20.64it/s][6/6] extract embeddings:  47%|████▋     | 115/243 [00:06<00:06, 20.61it/s][6/6] extract embeddings:  49%|████▊     | 118/243 [00:06<00:06, 20.60it/s][6/6] extract embeddings:  50%|████▉     | 121/243 [00:07<00:06, 19.94it/s][6/6] extract embeddings:  51%|█████     | 124/243 [00:07<00:06, 19.80it/s][6/6] extract embeddings:  52%|█████▏    | 127/243 [00:07<00:05, 20.18it/s][6/6] extract embeddings:  53%|█████▎    | 130/243 [00:07<00:05, 21.19it/s][6/6] extract embeddings:  55%|█████▍    | 133/243 [00:07<00:05, 20.75it/s][6/6] extract embeddings:  56%|█████▌    | 136/243 [00:07<00:05, 21.34it/s][6/6] extract embeddings:  57%|█████▋    | 139/243 [00:07<00:04, 21.08it/s][6/6] extract embeddings:  58%|█████▊    | 142/243 [00:08<00:04, 20.87it/s][6/6] extract embeddings:  60%|█████▉    | 145/243 [00:08<00:04, 21.62it/s][6/6] extract embeddings:  61%|██████    | 148/243 [00:08<00:04, 22.19it/s][6/6] extract embeddings:  62%|██████▏   | 151/243 [00:08<00:04, 22.27it/s][6/6] extract embeddings:  63%|██████▎   | 154/243 [00:08<00:04, 21.57it/s][6/6] extract embeddings:  65%|██████▍   | 157/243 [00:08<00:03, 21.52it/s][6/6] extract embeddings:  66%|██████▌   | 160/243 [00:08<00:03, 21.31it/s][6/6] extract embeddings:  67%|██████▋   | 163/243 [00:08<00:03, 21.52it/s][6/6] extract embeddings:  68%|██████▊   | 166/243 [00:09<00:03, 20.96it/s][6/6] extract embeddings:  70%|██████▉   | 169/243 [00:09<00:03, 21.84it/s][6/6] extract embeddings:  71%|███████   | 173/243 [00:09<00:02, 25.03it/s][6/6] extract embeddings:  72%|███████▏  | 176/243 [00:09<00:02, 26.10it/s][6/6] extract embeddings:  74%|███████▍  | 180/243 [00:09<00:02, 27.71it/s][6/6] extract embeddings:  76%|███████▌  | 184/243 [00:09<00:01, 29.52it/s][6/6] extract embeddings:  77%|███████▋  | 188/243 [00:09<00:01, 31.30it/s][6/6] extract embeddings:  79%|███████▉  | 192/243 [00:09<00:01, 31.74it/s][6/6] extract embeddings:  81%|████████  | 196/243 [00:10<00:01, 31.62it/s][6/6] extract embeddings:  82%|████████▏ | 200/243 [00:10<00:01, 31.45it/s][6/6] extract embeddings:  84%|████████▍ | 204/243 [00:10<00:01, 32.08it/s][6/6] extract embeddings:  86%|████████▌ | 208/243 [00:10<00:01, 32.27it/s][6/6] extract embeddings:  87%|████████▋ | 212/243 [00:10<00:01, 29.46it/s][6/6] extract embeddings:  89%|████████▉ | 216/243 [00:10<00:00, 28.51it/s][6/6] extract embeddings:  90%|█████████ | 219/243 [00:10<00:00, 27.69it/s][6/6] extract embeddings:  92%|█████████▏| 223/243 [00:11<00:00, 28.93it/s][6/6] extract embeddings:  93%|█████████▎| 227/243 [00:11<00:00, 29.34it/s][6/6] extract embeddings:  95%|█████████▌| 231/243 [00:11<00:00, 30.04it/s][6/6] extract embeddings:  97%|█████████▋| 235/243 [00:11<00:00, 31.33it/s][6/6] extract embeddings:  98%|█████████▊| 239/243 [00:11<00:00, 31.53it/s][6/6] extract embeddings: 100%|██████████| 243/243 [00:11<00:00, 31.18it/s][6/6] extract embeddings: 100%|██████████| 243/243 [00:11<00:00, 20.84it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:02<00:06,  2.23s/it]clustering:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]clustering:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it]clustering: 100%|██████████| 4/4 [00:04<00:00,  1.19it/s]clustering: 100%|██████████| 4/4 [00:04<00:00,  1.16s/it]
[NeMo I 2025-04-17 00:49:13 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:49:14 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              31.309118   444.120  ...   14.560021  3.278398
    Harker-ES                       25.366989  2178.782  ...   94.937810  4.357380
    Harker-MN                       38.287527   366.767  ...   30.845060  8.409988
    Longfellow-Block-1              16.022146   492.417  ...   14.093004  2.862006
    TOTAL                           26.164294  3482.086  ...  154.435896  4.435155
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:49:14 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.1081 | MISS: 0.1092 | CER: 0.0444 | DER: 0.2616 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.35, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.35, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:02<00:06,  2.20s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:04<00:04,  2.11s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.34s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:05<00:00,  1.03it/s]Processing Audio: 100%|██████████| 4/4 [00:05<00:00,  1.27s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:49:29 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:49:29 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:49:29 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:49:29 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:49:29 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:49:30 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:49:30 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:49:30 features:305] PADDING: 16
[NeMo I 2025-04-17 00:49:30 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:49:30 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:49:30 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:49:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:49:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:49:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:49:30 collections:880] Dataset successfully loaded with 2521 items and total duration provided from manifest is  1.85 hours.
[NeMo I 2025-04-17 00:49:30 collections:886] # 2521 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][1/6] extract embeddings:   2%|▎         | 1/40 [00:02<01:24,  2.17s/it][1/6] extract embeddings:  10%|█         | 4/40 [00:02<00:16,  2.24it/s][1/6] extract embeddings:  15%|█▌        | 6/40 [00:02<00:09,  3.49it/s][1/6] extract embeddings:  20%|██        | 8/40 [00:02<00:06,  4.84it/s][1/6] extract embeddings:  25%|██▌       | 10/40 [00:02<00:04,  6.19it/s][1/6] extract embeddings:  30%|███       | 12/40 [00:02<00:03,  7.38it/s][1/6] extract embeddings:  35%|███▌      | 14/40 [00:03<00:03,  8.49it/s][1/6] extract embeddings:  40%|████      | 16/40 [00:03<00:02,  9.22it/s][1/6] extract embeddings:  45%|████▌     | 18/40 [00:03<00:02, 10.03it/s][1/6] extract embeddings:  50%|█████     | 20/40 [00:03<00:01, 10.73it/s][1/6] extract embeddings:  55%|█████▌    | 22/40 [00:03<00:01, 11.16it/s][1/6] extract embeddings:  60%|██████    | 24/40 [00:03<00:01, 11.59it/s][1/6] extract embeddings:  65%|██████▌   | 26/40 [00:04<00:01, 11.87it/s][1/6] extract embeddings:  70%|███████   | 28/40 [00:04<00:01, 11.78it/s][1/6] extract embeddings:  75%|███████▌  | 30/40 [00:04<00:00, 11.75it/s][1/6] extract embeddings:  80%|████████  | 32/40 [00:04<00:00, 12.23it/s][1/6] extract embeddings:  85%|████████▌ | 34/40 [00:04<00:00, 11.84it/s][1/6] extract embeddings:  90%|█████████ | 36/40 [00:04<00:00, 12.19it/s][1/6] extract embeddings:  95%|█████████▌| 38/40 [00:05<00:00, 12.22it/s][1/6] extract embeddings: 100%|██████████| 40/40 [00:05<00:00, 13.54it/s][1/6] extract embeddings: 100%|██████████| 40/40 [00:05<00:00,  7.69it/s]
[NeMo I 2025-04-17 00:49:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:49:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:49:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:49:36 collections:880] Dataset successfully loaded with 3008 items and total duration provided from manifest is  1.89 hours.
[NeMo I 2025-04-17 00:49:36 collections:886] # 3008 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/47 [00:01<01:08,  1.48s/it][2/6] extract embeddings:   6%|▋         | 3/47 [00:01<00:19,  2.27it/s][2/6] extract embeddings:  11%|█         | 5/47 [00:01<00:10,  3.92it/s][2/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:07,  5.54it/s][2/6] extract embeddings:  19%|█▉        | 9/47 [00:02<00:05,  7.05it/s][2/6] extract embeddings:  23%|██▎       | 11/47 [00:02<00:04,  8.52it/s][2/6] extract embeddings:  28%|██▊       | 13/47 [00:02<00:03,  9.64it/s][2/6] extract embeddings:  32%|███▏      | 15/47 [00:02<00:02, 10.73it/s][2/6] extract embeddings:  36%|███▌      | 17/47 [00:02<00:02, 12.14it/s][2/6] extract embeddings:  40%|████      | 19/47 [00:02<00:02, 13.06it/s][2/6] extract embeddings:  45%|████▍     | 21/47 [00:02<00:01, 14.01it/s][2/6] extract embeddings:  49%|████▉     | 23/47 [00:03<00:01, 15.05it/s][2/6] extract embeddings:  53%|█████▎    | 25/47 [00:03<00:01, 14.98it/s][2/6] extract embeddings:  57%|█████▋    | 27/47 [00:03<00:01, 15.06it/s][2/6] extract embeddings:  62%|██████▏   | 29/47 [00:03<00:01, 15.19it/s][2/6] extract embeddings:  66%|██████▌   | 31/47 [00:03<00:01, 15.49it/s][2/6] extract embeddings:  70%|███████   | 33/47 [00:03<00:00, 15.83it/s][2/6] extract embeddings:  74%|███████▍  | 35/47 [00:03<00:00, 15.15it/s][2/6] extract embeddings:  79%|███████▊  | 37/47 [00:03<00:00, 14.71it/s][2/6] extract embeddings:  83%|████████▎ | 39/47 [00:04<00:00, 15.18it/s][2/6] extract embeddings:  87%|████████▋ | 41/47 [00:04<00:00, 15.61it/s][2/6] extract embeddings:  91%|█████████▏| 43/47 [00:04<00:00, 14.94it/s][2/6] extract embeddings:  96%|█████████▌| 45/47 [00:04<00:00, 14.04it/s][2/6] extract embeddings: 100%|██████████| 47/47 [00:04<00:00, 14.12it/s][2/6] extract embeddings: 100%|██████████| 47/47 [00:04<00:00, 10.07it/s]
[NeMo I 2025-04-17 00:49:40 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:49:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:49:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:49:41 collections:880] Dataset successfully loaded with 3756 items and total duration provided from manifest is  1.94 hours.
[NeMo I 2025-04-17 00:49:41 collections:886] # 3756 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/59 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/59 [00:01<01:09,  1.19s/it][3/6] extract embeddings:   5%|▌         | 3/59 [00:01<00:19,  2.86it/s][3/6] extract embeddings:   8%|▊         | 5/59 [00:01<00:10,  5.02it/s][3/6] extract embeddings:  12%|█▏        | 7/59 [00:01<00:07,  7.15it/s][3/6] extract embeddings:  15%|█▌        | 9/59 [00:01<00:05,  8.99it/s][3/6] extract embeddings:  19%|█▊        | 11/59 [00:01<00:04, 10.89it/s][3/6] extract embeddings:  22%|██▏       | 13/59 [00:01<00:03, 12.72it/s][3/6] extract embeddings:  25%|██▌       | 15/59 [00:02<00:03, 13.69it/s][3/6] extract embeddings:  29%|██▉       | 17/59 [00:02<00:02, 14.55it/s][3/6] extract embeddings:  32%|███▏      | 19/59 [00:02<00:02, 15.78it/s][3/6] extract embeddings:  36%|███▌      | 21/59 [00:02<00:02, 16.31it/s][3/6] extract embeddings:  39%|███▉      | 23/59 [00:02<00:02, 16.43it/s][3/6] extract embeddings:  42%|████▏     | 25/59 [00:02<00:02, 16.55it/s][3/6] extract embeddings:  46%|████▌     | 27/59 [00:02<00:01, 16.28it/s][3/6] extract embeddings:  49%|████▉     | 29/59 [00:02<00:01, 16.30it/s][3/6] extract embeddings:  53%|█████▎    | 31/59 [00:02<00:01, 16.73it/s][3/6] extract embeddings:  56%|█████▌    | 33/59 [00:03<00:01, 17.26it/s][3/6] extract embeddings:  59%|█████▉    | 35/59 [00:03<00:01, 16.70it/s][3/6] extract embeddings:  63%|██████▎   | 37/59 [00:03<00:01, 17.03it/s][3/6] extract embeddings:  66%|██████▌   | 39/59 [00:03<00:01, 16.63it/s][3/6] extract embeddings:  69%|██████▉   | 41/59 [00:03<00:01, 16.48it/s][3/6] extract embeddings:  73%|███████▎  | 43/59 [00:03<00:00, 16.10it/s][3/6] extract embeddings:  76%|███████▋  | 45/59 [00:03<00:00, 15.85it/s][3/6] extract embeddings:  80%|███████▉  | 47/59 [00:03<00:00, 14.88it/s][3/6] extract embeddings:  83%|████████▎ | 49/59 [00:04<00:00, 14.87it/s][3/6] extract embeddings:  86%|████████▋ | 51/59 [00:04<00:00, 14.91it/s][3/6] extract embeddings:  90%|████████▉ | 53/59 [00:04<00:00, 14.43it/s][3/6] extract embeddings:  93%|█████████▎| 55/59 [00:04<00:00, 14.89it/s][3/6] extract embeddings:  97%|█████████▋| 57/59 [00:04<00:00, 14.25it/s][3/6] extract embeddings: 100%|██████████| 59/59 [00:04<00:00, 15.00it/s][3/6] extract embeddings: 100%|██████████| 59/59 [00:04<00:00, 12.31it/s]
[NeMo I 2025-04-17 00:49:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:49:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:49:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:49:46 collections:880] Dataset successfully loaded with 5033 items and total duration provided from manifest is  1.99 hours.
[NeMo I 2025-04-17 00:49:46 collections:886] # 5033 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/79 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/79 [00:01<01:36,  1.23s/it][4/6] extract embeddings:   5%|▌         | 4/79 [00:01<00:20,  3.66it/s][4/6] extract embeddings:   8%|▊         | 6/79 [00:01<00:12,  5.65it/s][4/6] extract embeddings:  10%|█         | 8/79 [00:01<00:09,  7.53it/s][4/6] extract embeddings:  13%|█▎        | 10/79 [00:01<00:07,  8.94it/s][4/6] extract embeddings:  15%|█▌        | 12/79 [00:01<00:06, 10.18it/s][4/6] extract embeddings:  18%|█▊        | 14/79 [00:02<00:05, 11.36it/s][4/6] extract embeddings:  20%|██        | 16/79 [00:02<00:05, 12.37it/s][4/6] extract embeddings:  23%|██▎       | 18/79 [00:02<00:04, 13.37it/s][4/6] extract embeddings:  25%|██▌       | 20/79 [00:02<00:04, 13.75it/s][4/6] extract embeddings:  28%|██▊       | 22/79 [00:02<00:03, 14.25it/s][4/6] extract embeddings:  30%|███       | 24/79 [00:02<00:03, 14.69it/s][4/6] extract embeddings:  33%|███▎      | 26/79 [00:02<00:03, 14.61it/s][4/6] extract embeddings:  35%|███▌      | 28/79 [00:02<00:03, 15.27it/s][4/6] extract embeddings:  38%|███▊      | 30/79 [00:03<00:03, 16.09it/s][4/6] extract embeddings:  41%|████      | 32/79 [00:03<00:02, 16.22it/s][4/6] extract embeddings:  43%|████▎     | 34/79 [00:03<00:02, 16.38it/s][4/6] extract embeddings:  46%|████▌     | 36/79 [00:03<00:02, 15.86it/s][4/6] extract embeddings:  48%|████▊     | 38/79 [00:03<00:02, 15.97it/s][4/6] extract embeddings:  51%|█████     | 40/79 [00:03<00:02, 15.31it/s][4/6] extract embeddings:  53%|█████▎    | 42/79 [00:03<00:02, 15.37it/s][4/6] extract embeddings:  56%|█████▌    | 44/79 [00:03<00:02, 15.04it/s][4/6] extract embeddings:  58%|█████▊    | 46/79 [00:04<00:02, 15.51it/s][4/6] extract embeddings:  61%|██████    | 48/79 [00:04<00:01, 15.62it/s][4/6] extract embeddings:  63%|██████▎   | 50/79 [00:04<00:01, 15.96it/s][4/6] extract embeddings:  66%|██████▌   | 52/79 [00:04<00:01, 15.83it/s][4/6] extract embeddings:  68%|██████▊   | 54/79 [00:04<00:01, 16.38it/s][4/6] extract embeddings:  71%|███████   | 56/79 [00:04<00:01, 16.19it/s][4/6] extract embeddings:  73%|███████▎  | 58/79 [00:04<00:01, 16.78it/s][4/6] extract embeddings:  76%|███████▌  | 60/79 [00:04<00:01, 15.89it/s][4/6] extract embeddings:  78%|███████▊  | 62/79 [00:05<00:01, 16.09it/s][4/6] extract embeddings:  81%|████████  | 64/79 [00:05<00:00, 16.14it/s][4/6] extract embeddings:  84%|████████▎ | 66/79 [00:05<00:00, 16.15it/s][4/6] extract embeddings:  86%|████████▌ | 68/79 [00:05<00:00, 16.53it/s][4/6] extract embeddings:  89%|████████▊ | 70/79 [00:05<00:00, 16.51it/s][4/6] extract embeddings:  91%|█████████ | 72/79 [00:05<00:00, 16.62it/s][4/6] extract embeddings:  94%|█████████▎| 74/79 [00:05<00:00, 16.17it/s][4/6] extract embeddings:  96%|█████████▌| 76/79 [00:05<00:00, 16.14it/s][4/6] extract embeddings:  99%|█████████▊| 78/79 [00:06<00:00, 16.73it/s][4/6] extract embeddings: 100%|██████████| 79/79 [00:06<00:00, 12.84it/s]
[NeMo I 2025-04-17 00:49:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:49:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:49:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:49:52 collections:880] Dataset successfully loaded with 7603 items and total duration provided from manifest is  2.05 hours.
[NeMo I 2025-04-17 00:49:52 collections:886] # 7603 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/119 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/119 [00:01<02:19,  1.18s/it][5/6] extract embeddings:   3%|▎         | 4/119 [00:01<00:29,  3.90it/s][5/6] extract embeddings:   6%|▌         | 7/119 [00:01<00:15,  7.20it/s][5/6] extract embeddings:   8%|▊         | 10/119 [00:01<00:10, 10.46it/s][5/6] extract embeddings:  11%|█         | 13/119 [00:01<00:08, 13.22it/s][5/6] extract embeddings:  13%|█▎        | 16/119 [00:01<00:06, 15.58it/s][5/6] extract embeddings:  16%|█▌        | 19/119 [00:01<00:05, 17.55it/s][5/6] extract embeddings:  18%|█▊        | 22/119 [00:02<00:05, 19.13it/s][5/6] extract embeddings:  21%|██        | 25/119 [00:02<00:04, 20.72it/s][5/6] extract embeddings:  24%|██▎       | 28/119 [00:02<00:04, 21.79it/s][5/6] extract embeddings:  26%|██▌       | 31/119 [00:02<00:03, 22.78it/s][5/6] extract embeddings:  29%|██▊       | 34/119 [00:02<00:03, 22.35it/s][5/6] extract embeddings:  31%|███       | 37/119 [00:02<00:03, 23.06it/s][5/6] extract embeddings:  34%|███▎      | 40/119 [00:02<00:03, 23.62it/s][5/6] extract embeddings:  36%|███▌      | 43/119 [00:02<00:03, 23.88it/s][5/6] extract embeddings:  39%|███▊      | 46/119 [00:03<00:02, 24.63it/s][5/6] extract embeddings:  41%|████      | 49/119 [00:03<00:03, 22.49it/s][5/6] extract embeddings:  44%|████▎     | 52/119 [00:03<00:03, 21.74it/s][5/6] extract embeddings:  46%|████▌     | 55/119 [00:03<00:02, 22.60it/s][5/6] extract embeddings:  49%|████▊     | 58/119 [00:03<00:02, 22.48it/s][5/6] extract embeddings:  51%|█████▏    | 61/119 [00:03<00:02, 21.37it/s][5/6] extract embeddings:  54%|█████▍    | 64/119 [00:03<00:02, 20.56it/s][5/6] extract embeddings:  56%|█████▋    | 67/119 [00:04<00:02, 19.21it/s][5/6] extract embeddings:  58%|█████▊    | 69/119 [00:04<00:02, 18.58it/s][5/6] extract embeddings:  60%|█████▉    | 71/119 [00:04<00:02, 18.05it/s][5/6] extract embeddings:  61%|██████▏   | 73/119 [00:04<00:02, 17.34it/s][5/6] extract embeddings:  63%|██████▎   | 75/119 [00:04<00:02, 17.86it/s][5/6] extract embeddings:  65%|██████▍   | 77/119 [00:04<00:02, 17.86it/s][5/6] extract embeddings:  66%|██████▋   | 79/119 [00:04<00:02, 17.36it/s][5/6] extract embeddings:  68%|██████▊   | 81/119 [00:04<00:02, 17.72it/s][5/6] extract embeddings:  70%|██████▉   | 83/119 [00:05<00:02, 17.75it/s][5/6] extract embeddings:  72%|███████▏  | 86/119 [00:05<00:01, 18.88it/s][5/6] extract embeddings:  74%|███████▍  | 88/119 [00:05<00:01, 18.11it/s][5/6] extract embeddings:  76%|███████▌  | 90/119 [00:05<00:01, 18.42it/s][5/6] extract embeddings:  77%|███████▋  | 92/119 [00:05<00:01, 17.70it/s][5/6] extract embeddings:  79%|███████▉  | 94/119 [00:05<00:01, 17.20it/s][5/6] extract embeddings:  81%|████████  | 96/119 [00:05<00:01, 17.38it/s][5/6] extract embeddings:  82%|████████▏ | 98/119 [00:05<00:01, 16.71it/s][5/6] extract embeddings:  84%|████████▍ | 100/119 [00:05<00:01, 17.18it/s][5/6] extract embeddings:  86%|████████▌ | 102/119 [00:06<00:00, 17.38it/s][5/6] extract embeddings:  87%|████████▋ | 104/119 [00:06<00:00, 17.52it/s][5/6] extract embeddings:  90%|████████▉ | 107/119 [00:06<00:00, 20.04it/s][5/6] extract embeddings:  92%|█████████▏| 110/119 [00:06<00:00, 21.40it/s][5/6] extract embeddings:  95%|█████████▍| 113/119 [00:06<00:00, 23.14it/s][5/6] extract embeddings:  97%|█████████▋| 116/119 [00:06<00:00, 21.54it/s][5/6] extract embeddings: 100%|██████████| 119/119 [00:06<00:00, 19.36it/s][5/6] extract embeddings: 100%|██████████| 119/119 [00:06<00:00, 17.18it/s]
[NeMo I 2025-04-17 00:49:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:49:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:49:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:49:59 collections:880] Dataset successfully loaded with 15395 items and total duration provided from manifest is  2.11 hours.
[NeMo I 2025-04-17 00:49:59 collections:886] # 15395 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/241 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/241 [00:01<04:36,  1.15s/it][6/6] extract embeddings:   2%|▏         | 4/241 [00:01<00:58,  4.04it/s][6/6] extract embeddings:   2%|▏         | 6/241 [00:01<00:39,  5.98it/s][6/6] extract embeddings:   4%|▎         | 9/241 [00:01<00:25,  9.05it/s][6/6] extract embeddings:   5%|▍         | 12/241 [00:01<00:19, 11.98it/s][6/6] extract embeddings:   6%|▌         | 15/241 [00:01<00:15, 14.24it/s][6/6] extract embeddings:   7%|▋         | 18/241 [00:01<00:13, 16.03it/s][6/6] extract embeddings:   9%|▊         | 21/241 [00:02<00:12, 16.99it/s][6/6] extract embeddings:  10%|▉         | 24/241 [00:02<00:12, 17.97it/s][6/6] extract embeddings:  11%|█         | 27/241 [00:02<00:11, 18.65it/s][6/6] extract embeddings:  12%|█▏        | 30/241 [00:02<00:11, 18.25it/s][6/6] extract embeddings:  13%|█▎        | 32/241 [00:02<00:11, 18.46it/s][6/6] extract embeddings:  14%|█▍        | 34/241 [00:02<00:11, 18.68it/s][6/6] extract embeddings:  15%|█▌        | 37/241 [00:02<00:09, 20.67it/s][6/6] extract embeddings:  17%|█▋        | 41/241 [00:03<00:08, 24.18it/s][6/6] extract embeddings:  19%|█▊        | 45/241 [00:03<00:07, 26.51it/s][6/6] extract embeddings:  20%|██        | 49/241 [00:03<00:06, 28.21it/s][6/6] extract embeddings:  22%|██▏       | 53/241 [00:03<00:06, 29.74it/s][6/6] extract embeddings:  23%|██▎       | 56/241 [00:03<00:06, 29.45it/s][6/6] extract embeddings:  25%|██▍       | 60/241 [00:03<00:06, 29.96it/s][6/6] extract embeddings:  27%|██▋       | 64/241 [00:03<00:06, 29.30it/s][6/6] extract embeddings:  28%|██▊       | 68/241 [00:03<00:05, 30.77it/s][6/6] extract embeddings:  30%|██▉       | 72/241 [00:04<00:05, 31.05it/s][6/6] extract embeddings:  32%|███▏      | 76/241 [00:04<00:05, 31.18it/s][6/6] extract embeddings:  33%|███▎      | 80/241 [00:04<00:05, 31.93it/s][6/6] extract embeddings:  35%|███▍      | 84/241 [00:04<00:04, 31.90it/s][6/6] extract embeddings:  37%|███▋      | 88/241 [00:04<00:04, 31.97it/s][6/6] extract embeddings:  38%|███▊      | 92/241 [00:04<00:04, 31.02it/s][6/6] extract embeddings:  40%|███▉      | 96/241 [00:04<00:04, 30.95it/s][6/6] extract embeddings:  41%|████▏     | 100/241 [00:04<00:04, 31.68it/s][6/6] extract embeddings:  43%|████▎     | 104/241 [00:05<00:04, 32.07it/s][6/6] extract embeddings:  45%|████▍     | 108/241 [00:05<00:04, 32.50it/s][6/6] extract embeddings:  46%|████▋     | 112/241 [00:05<00:04, 30.95it/s][6/6] extract embeddings:  48%|████▊     | 116/241 [00:05<00:04, 30.85it/s][6/6] extract embeddings:  50%|████▉     | 120/241 [00:05<00:03, 31.13it/s][6/6] extract embeddings:  51%|█████▏    | 124/241 [00:05<00:03, 32.13it/s][6/6] extract embeddings:  53%|█████▎    | 128/241 [00:05<00:03, 31.80it/s][6/6] extract embeddings:  55%|█████▍    | 132/241 [00:05<00:03, 31.63it/s][6/6] extract embeddings:  56%|█████▋    | 136/241 [00:06<00:03, 31.35it/s][6/6] extract embeddings:  58%|█████▊    | 140/241 [00:06<00:03, 31.90it/s][6/6] extract embeddings:  60%|█████▉    | 144/241 [00:06<00:03, 31.89it/s][6/6] extract embeddings:  61%|██████▏   | 148/241 [00:06<00:02, 31.80it/s][6/6] extract embeddings:  63%|██████▎   | 152/241 [00:06<00:02, 31.53it/s][6/6] extract embeddings:  65%|██████▍   | 156/241 [00:06<00:02, 31.81it/s][6/6] extract embeddings:  66%|██████▋   | 160/241 [00:06<00:02, 31.35it/s][6/6] extract embeddings:  68%|██████▊   | 164/241 [00:06<00:02, 31.60it/s][6/6] extract embeddings:  70%|██████▉   | 168/241 [00:07<00:02, 30.57it/s][6/6] extract embeddings:  71%|███████▏  | 172/241 [00:07<00:02, 30.74it/s][6/6] extract embeddings:  73%|███████▎  | 176/241 [00:07<00:02, 30.14it/s][6/6] extract embeddings:  75%|███████▍  | 180/241 [00:07<00:02, 27.82it/s][6/6] extract embeddings:  76%|███████▌  | 183/241 [00:07<00:02, 25.34it/s][6/6] extract embeddings:  77%|███████▋  | 186/241 [00:07<00:02, 23.76it/s][6/6] extract embeddings:  78%|███████▊  | 189/241 [00:07<00:02, 22.69it/s][6/6] extract embeddings:  80%|███████▉  | 192/241 [00:08<00:02, 21.71it/s][6/6] extract embeddings:  81%|████████  | 195/241 [00:08<00:01, 23.27it/s][6/6] extract embeddings:  83%|████████▎ | 199/241 [00:08<00:01, 25.98it/s][6/6] extract embeddings:  84%|████████▍ | 202/241 [00:08<00:01, 26.29it/s][6/6] extract embeddings:  85%|████████▌ | 205/241 [00:08<00:01, 23.91it/s][6/6] extract embeddings:  86%|████████▋ | 208/241 [00:08<00:01, 25.02it/s][6/6] extract embeddings:  88%|████████▊ | 211/241 [00:08<00:01, 24.81it/s][6/6] extract embeddings:  89%|████████▉ | 214/241 [00:08<00:01, 24.39it/s][6/6] extract embeddings:  90%|█████████ | 217/241 [00:09<00:01, 22.18it/s][6/6] extract embeddings:  91%|█████████▏| 220/241 [00:09<00:00, 21.98it/s][6/6] extract embeddings:  93%|█████████▎| 223/241 [00:09<00:00, 20.75it/s][6/6] extract embeddings:  94%|█████████▍| 226/241 [00:09<00:00, 22.69it/s][6/6] extract embeddings:  95%|█████████▌| 230/241 [00:09<00:00, 25.58it/s][6/6] extract embeddings:  97%|█████████▋| 233/241 [00:09<00:00, 26.53it/s][6/6] extract embeddings:  98%|█████████▊| 236/241 [00:09<00:00, 26.44it/s][6/6] extract embeddings:  99%|█████████▉| 239/241 [00:09<00:00, 27.32it/s][6/6] extract embeddings: 100%|██████████| 241/241 [00:10<00:00, 24.00it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.10it/s]clustering:  50%|█████     | 2/4 [00:01<00:02,  1.07s/it]clustering:  75%|███████▌  | 3/4 [00:02<00:00,  1.45it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s]
[NeMo I 2025-04-17 00:50:12 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:50:13 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              32.948315   444.120  ...   16.340004  3.679187
    Harker-ES                       25.306594  2178.782  ...   85.508756  3.924613
    Harker-MN                       39.402420   366.767  ...   33.871134  9.235055
    Longfellow-Block-1              16.882809   492.417  ...   13.902998  2.823420
    TOTAL                           26.574716  3482.086  ...  149.622891  4.296933
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:50:13 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.1068 | MISS: 0.1160 | CER: 0.0430 | DER: 0.2657 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.40, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.4, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.92s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:04<00:04,  2.02s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.29s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.05it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.21s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:50:28 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:50:28 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:50:28 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:50:28 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:50:28 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:50:28 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:50:28 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:50:28 features:305] PADDING: 16
[NeMo I 2025-04-17 00:50:28 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:50:28 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:50:28 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:50:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:50:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:50:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:50:28 collections:880] Dataset successfully loaded with 2493 items and total duration provided from manifest is  1.82 hours.
[NeMo I 2025-04-17 00:50:28 collections:886] # 2493 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/39 [00:02<01:20,  2.13s/it][1/6] extract embeddings:  10%|█         | 4/39 [00:02<00:15,  2.27it/s][1/6] extract embeddings:  15%|█▌        | 6/39 [00:02<00:09,  3.56it/s][1/6] extract embeddings:  21%|██        | 8/39 [00:02<00:06,  5.09it/s][1/6] extract embeddings:  26%|██▌       | 10/39 [00:02<00:04,  6.54it/s][1/6] extract embeddings:  31%|███       | 12/39 [00:02<00:03,  7.76it/s][1/6] extract embeddings:  36%|███▌      | 14/39 [00:02<00:02,  9.14it/s][1/6] extract embeddings:  41%|████      | 16/39 [00:03<00:02, 10.03it/s][1/6] extract embeddings:  46%|████▌     | 18/39 [00:03<00:01, 10.92it/s][1/6] extract embeddings:  51%|█████▏    | 20/39 [00:03<00:01, 12.15it/s][1/6] extract embeddings:  56%|█████▋    | 22/39 [00:03<00:01, 12.57it/s][1/6] extract embeddings:  62%|██████▏   | 24/39 [00:03<00:01, 13.09it/s][1/6] extract embeddings:  67%|██████▋   | 26/39 [00:03<00:01, 12.96it/s][1/6] extract embeddings:  72%|███████▏  | 28/39 [00:03<00:00, 13.34it/s][1/6] extract embeddings:  77%|███████▋  | 30/39 [00:04<00:00, 13.37it/s][1/6] extract embeddings:  82%|████████▏ | 32/39 [00:04<00:00, 13.64it/s][1/6] extract embeddings:  87%|████████▋ | 34/39 [00:04<00:00, 13.90it/s][1/6] extract embeddings:  92%|█████████▏| 36/39 [00:04<00:00, 13.82it/s][1/6] extract embeddings:  97%|█████████▋| 38/39 [00:04<00:00, 13.98it/s][1/6] extract embeddings: 100%|██████████| 39/39 [00:04<00:00,  8.13it/s]
[NeMo I 2025-04-17 00:50:33 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:50:33 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:50:33 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:50:33 collections:880] Dataset successfully loaded with 2977 items and total duration provided from manifest is  1.86 hours.
[NeMo I 2025-04-17 00:50:33 collections:886] # 2977 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/47 [00:01<01:08,  1.49s/it][2/6] extract embeddings:   6%|▋         | 3/47 [00:01<00:19,  2.28it/s][2/6] extract embeddings:  11%|█         | 5/47 [00:01<00:10,  3.98it/s][2/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:06,  5.72it/s][2/6] extract embeddings:  19%|█▉        | 9/47 [00:02<00:05,  7.58it/s][2/6] extract embeddings:  23%|██▎       | 11/47 [00:02<00:03,  9.28it/s][2/6] extract embeddings:  28%|██▊       | 13/47 [00:02<00:03, 10.62it/s][2/6] extract embeddings:  32%|███▏      | 15/47 [00:02<00:02, 11.47it/s][2/6] extract embeddings:  36%|███▌      | 17/47 [00:02<00:02, 12.44it/s][2/6] extract embeddings:  40%|████      | 19/47 [00:02<00:02, 13.39it/s][2/6] extract embeddings:  45%|████▍     | 21/47 [00:02<00:01, 13.99it/s][2/6] extract embeddings:  49%|████▉     | 23/47 [00:02<00:01, 14.79it/s][2/6] extract embeddings:  53%|█████▎    | 25/47 [00:03<00:01, 15.25it/s][2/6] extract embeddings:  57%|█████▋    | 27/47 [00:03<00:01, 15.49it/s][2/6] extract embeddings:  62%|██████▏   | 29/47 [00:03<00:01, 15.69it/s][2/6] extract embeddings:  66%|██████▌   | 31/47 [00:03<00:01, 15.71it/s][2/6] extract embeddings:  70%|███████   | 33/47 [00:03<00:00, 15.65it/s][2/6] extract embeddings:  74%|███████▍  | 35/47 [00:03<00:00, 15.90it/s][2/6] extract embeddings:  79%|███████▊  | 37/47 [00:03<00:00, 15.70it/s][2/6] extract embeddings:  83%|████████▎ | 39/47 [00:03<00:00, 15.19it/s][2/6] extract embeddings:  87%|████████▋ | 41/47 [00:04<00:00, 14.85it/s][2/6] extract embeddings:  91%|█████████▏| 43/47 [00:04<00:00, 14.58it/s][2/6] extract embeddings:  96%|█████████▌| 45/47 [00:04<00:00, 15.14it/s][2/6] extract embeddings: 100%|██████████| 47/47 [00:04<00:00, 10.44it/s]
[NeMo I 2025-04-17 00:50:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:50:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:50:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:50:38 collections:880] Dataset successfully loaded with 3718 items and total duration provided from manifest is  1.91 hours.
[NeMo I 2025-04-17 00:50:38 collections:886] # 3718 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/59 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/59 [00:01<01:12,  1.24s/it][3/6] extract embeddings:   7%|▋         | 4/59 [00:01<00:15,  3.57it/s][3/6] extract embeddings:  10%|█         | 6/59 [00:01<00:09,  5.46it/s][3/6] extract embeddings:  14%|█▎        | 8/59 [00:01<00:06,  7.50it/s][3/6] extract embeddings:  17%|█▋        | 10/59 [00:01<00:05,  9.58it/s][3/6] extract embeddings:  20%|██        | 12/59 [00:01<00:04, 11.39it/s][3/6] extract embeddings:  24%|██▎       | 14/59 [00:01<00:03, 12.87it/s][3/6] extract embeddings:  27%|██▋       | 16/59 [00:02<00:03, 13.95it/s][3/6] extract embeddings:  31%|███       | 18/59 [00:02<00:02, 14.58it/s][3/6] extract embeddings:  34%|███▍      | 20/59 [00:02<00:02, 15.13it/s][3/6] extract embeddings:  37%|███▋      | 22/59 [00:02<00:02, 15.96it/s][3/6] extract embeddings:  41%|████      | 24/59 [00:02<00:02, 16.40it/s][3/6] extract embeddings:  44%|████▍     | 26/59 [00:02<00:01, 17.06it/s][3/6] extract embeddings:  47%|████▋     | 28/59 [00:02<00:01, 16.55it/s][3/6] extract embeddings:  53%|█████▎    | 31/59 [00:02<00:01, 17.64it/s][3/6] extract embeddings:  56%|█████▌    | 33/59 [00:03<00:01, 17.26it/s][3/6] extract embeddings:  59%|█████▉    | 35/59 [00:03<00:01, 17.47it/s][3/6] extract embeddings:  63%|██████▎   | 37/59 [00:03<00:01, 17.40it/s][3/6] extract embeddings:  66%|██████▌   | 39/59 [00:03<00:01, 17.84it/s][3/6] extract embeddings:  69%|██████▉   | 41/59 [00:03<00:01, 17.80it/s][3/6] extract embeddings:  73%|███████▎  | 43/59 [00:03<00:00, 18.12it/s][3/6] extract embeddings:  76%|███████▋  | 45/59 [00:03<00:00, 18.14it/s][3/6] extract embeddings:  80%|███████▉  | 47/59 [00:03<00:00, 17.22it/s][3/6] extract embeddings:  83%|████████▎ | 49/59 [00:03<00:00, 17.22it/s][3/6] extract embeddings:  86%|████████▋ | 51/59 [00:04<00:00, 17.52it/s][3/6] extract embeddings:  90%|████████▉ | 53/59 [00:04<00:00, 17.41it/s][3/6] extract embeddings:  93%|█████████▎| 55/59 [00:04<00:00, 16.93it/s][3/6] extract embeddings:  97%|█████████▋| 57/59 [00:04<00:00, 16.85it/s][3/6] extract embeddings: 100%|██████████| 59/59 [00:04<00:00, 12.94it/s]
[NeMo I 2025-04-17 00:50:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:50:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:50:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:50:43 collections:880] Dataset successfully loaded with 4977 items and total duration provided from manifest is  1.97 hours.
[NeMo I 2025-04-17 00:50:43 collections:886] # 4977 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/78 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/78 [00:01<01:34,  1.23s/it][4/6] extract embeddings:   5%|▌         | 4/78 [00:01<00:20,  3.70it/s][4/6] extract embeddings:   9%|▉         | 7/78 [00:01<00:10,  6.57it/s][4/6] extract embeddings:  12%|█▏        | 9/78 [00:01<00:08,  8.39it/s][4/6] extract embeddings:  14%|█▍        | 11/78 [00:01<00:06,  9.96it/s][4/6] extract embeddings:  17%|█▋        | 13/78 [00:01<00:05, 11.34it/s][4/6] extract embeddings:  19%|█▉        | 15/78 [00:01<00:04, 12.83it/s][4/6] extract embeddings:  22%|██▏       | 17/78 [00:02<00:04, 14.34it/s][4/6] extract embeddings:  24%|██▍       | 19/78 [00:02<00:04, 14.47it/s][4/6] extract embeddings:  27%|██▋       | 21/78 [00:02<00:03, 14.55it/s][4/6] extract embeddings:  29%|██▉       | 23/78 [00:02<00:03, 15.25it/s][4/6] extract embeddings:  32%|███▏      | 25/78 [00:02<00:03, 15.69it/s][4/6] extract embeddings:  35%|███▍      | 27/78 [00:02<00:03, 16.66it/s][4/6] extract embeddings:  38%|███▊      | 30/78 [00:02<00:02, 17.87it/s][4/6] extract embeddings:  41%|████      | 32/78 [00:02<00:02, 17.88it/s][4/6] extract embeddings:  45%|████▍     | 35/78 [00:03<00:02, 18.91it/s][4/6] extract embeddings:  47%|████▋     | 37/78 [00:03<00:02, 18.99it/s][4/6] extract embeddings:  50%|█████     | 39/78 [00:03<00:02, 19.12it/s][4/6] extract embeddings:  54%|█████▍    | 42/78 [00:03<00:01, 19.46it/s][4/6] extract embeddings:  56%|█████▋    | 44/78 [00:03<00:01, 18.54it/s][4/6] extract embeddings:  59%|█████▉    | 46/78 [00:03<00:01, 17.99it/s][4/6] extract embeddings:  62%|██████▏   | 48/78 [00:03<00:01, 17.86it/s][4/6] extract embeddings:  64%|██████▍   | 50/78 [00:03<00:01, 17.77it/s][4/6] extract embeddings:  67%|██████▋   | 52/78 [00:04<00:01, 17.27it/s][4/6] extract embeddings:  69%|██████▉   | 54/78 [00:04<00:01, 16.75it/s][4/6] extract embeddings:  72%|███████▏  | 56/78 [00:04<00:01, 16.56it/s][4/6] extract embeddings:  76%|███████▌  | 59/78 [00:04<00:01, 17.40it/s][4/6] extract embeddings:  78%|███████▊  | 61/78 [00:04<00:00, 17.75it/s][4/6] extract embeddings:  82%|████████▏ | 64/78 [00:04<00:00, 19.19it/s][4/6] extract embeddings:  85%|████████▍ | 66/78 [00:04<00:00, 19.03it/s][4/6] extract embeddings:  88%|████████▊ | 69/78 [00:04<00:00, 19.29it/s][4/6] extract embeddings:  91%|█████████ | 71/78 [00:05<00:00, 19.36it/s][4/6] extract embeddings:  94%|█████████▎| 73/78 [00:05<00:00, 19.24it/s][4/6] extract embeddings:  96%|█████████▌| 75/78 [00:05<00:00, 19.02it/s][4/6] extract embeddings: 100%|██████████| 78/78 [00:05<00:00, 19.39it/s][4/6] extract embeddings: 100%|██████████| 78/78 [00:05<00:00, 14.28it/s]
[NeMo I 2025-04-17 00:50:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:50:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:50:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:50:49 collections:880] Dataset successfully loaded with 7529 items and total duration provided from manifest is  2.03 hours.
[NeMo I 2025-04-17 00:50:49 collections:886] # 7529 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/118 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/118 [00:01<02:29,  1.27s/it][5/6] extract embeddings:   3%|▎         | 4/118 [00:01<00:31,  3.59it/s][5/6] extract embeddings:   6%|▌         | 7/118 [00:01<00:16,  6.74it/s][5/6] extract embeddings:   8%|▊         | 10/118 [00:01<00:11,  9.76it/s][5/6] extract embeddings:  11%|█         | 13/118 [00:01<00:08, 12.29it/s][5/6] extract embeddings:  14%|█▎        | 16/118 [00:01<00:07, 13.47it/s][5/6] extract embeddings:  15%|█▌        | 18/118 [00:02<00:07, 14.19it/s][5/6] extract embeddings:  17%|█▋        | 20/118 [00:02<00:06, 14.43it/s][5/6] extract embeddings:  19%|█▊        | 22/118 [00:02<00:06, 14.72it/s][5/6] extract embeddings:  20%|██        | 24/118 [00:02<00:06, 15.50it/s][5/6] extract embeddings:  22%|██▏       | 26/118 [00:02<00:05, 15.97it/s][5/6] extract embeddings:  24%|██▎       | 28/118 [00:02<00:05, 15.97it/s][5/6] extract embeddings:  25%|██▌       | 30/118 [00:02<00:05, 15.99it/s][5/6] extract embeddings:  27%|██▋       | 32/118 [00:02<00:05, 16.74it/s][5/6] extract embeddings:  29%|██▉       | 34/118 [00:03<00:05, 16.38it/s][5/6] extract embeddings:  31%|███       | 36/118 [00:03<00:04, 16.95it/s][5/6] extract embeddings:  32%|███▏      | 38/118 [00:03<00:04, 17.21it/s][5/6] extract embeddings:  34%|███▍      | 40/118 [00:03<00:04, 17.43it/s][5/6] extract embeddings:  36%|███▌      | 42/118 [00:03<00:04, 17.74it/s][5/6] extract embeddings:  37%|███▋      | 44/118 [00:03<00:04, 17.59it/s][5/6] extract embeddings:  39%|███▉      | 46/118 [00:03<00:04, 16.77it/s][5/6] extract embeddings:  41%|████      | 48/118 [00:03<00:04, 16.95it/s][5/6] extract embeddings:  42%|████▏     | 50/118 [00:03<00:03, 17.51it/s][5/6] extract embeddings:  44%|████▍     | 52/118 [00:04<00:03, 16.67it/s][5/6] extract embeddings:  47%|████▋     | 55/118 [00:04<00:03, 18.81it/s][5/6] extract embeddings:  49%|████▉     | 58/118 [00:04<00:02, 20.53it/s][5/6] extract embeddings:  52%|█████▏    | 61/118 [00:04<00:02, 21.74it/s][5/6] extract embeddings:  54%|█████▍    | 64/118 [00:04<00:02, 22.16it/s][5/6] extract embeddings:  57%|█████▋    | 67/118 [00:04<00:02, 22.84it/s][5/6] extract embeddings:  59%|█████▉    | 70/118 [00:04<00:02, 23.40it/s][5/6] extract embeddings:  62%|██████▏   | 73/118 [00:04<00:02, 22.46it/s][5/6] extract embeddings:  64%|██████▍   | 76/118 [00:05<00:01, 23.23it/s][5/6] extract embeddings:  67%|██████▋   | 79/118 [00:05<00:01, 23.55it/s][5/6] extract embeddings:  69%|██████▉   | 82/118 [00:05<00:01, 22.51it/s][5/6] extract embeddings:  72%|███████▏  | 85/118 [00:05<00:01, 21.28it/s][5/6] extract embeddings:  75%|███████▍  | 88/118 [00:05<00:01, 20.18it/s][5/6] extract embeddings:  77%|███████▋  | 91/118 [00:05<00:01, 18.84it/s][5/6] extract embeddings:  79%|███████▉  | 93/118 [00:06<00:01, 18.31it/s][5/6] extract embeddings:  81%|████████  | 95/118 [00:06<00:01, 17.88it/s][5/6] extract embeddings:  82%|████████▏ | 97/118 [00:06<00:01, 18.04it/s][5/6] extract embeddings:  84%|████████▍ | 99/118 [00:06<00:01, 17.99it/s][5/6] extract embeddings:  86%|████████▋ | 102/118 [00:06<00:00, 20.41it/s][5/6] extract embeddings:  89%|████████▉ | 105/118 [00:06<00:00, 20.73it/s][5/6] extract embeddings:  92%|█████████▏| 108/118 [00:06<00:00, 22.40it/s][5/6] extract embeddings:  94%|█████████▍| 111/118 [00:06<00:00, 23.41it/s][5/6] extract embeddings:  97%|█████████▋| 114/118 [00:06<00:00, 24.29it/s][5/6] extract embeddings:  99%|█████████▉| 117/118 [00:07<00:00, 23.88it/s][5/6] extract embeddings: 100%|██████████| 118/118 [00:07<00:00, 16.54it/s]
[NeMo I 2025-04-17 00:50:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:50:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:50:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:50:56 collections:880] Dataset successfully loaded with 15248 items and total duration provided from manifest is  2.09 hours.
[NeMo I 2025-04-17 00:50:56 collections:886] # 15248 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/239 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/239 [00:01<04:41,  1.18s/it][6/6] extract embeddings:   2%|▏         | 5/239 [00:01<00:47,  4.95it/s][6/6] extract embeddings:   3%|▎         | 8/239 [00:01<00:28,  8.18it/s][6/6] extract embeddings:   5%|▌         | 12/239 [00:01<00:18, 12.60it/s][6/6] extract embeddings:   7%|▋         | 16/239 [00:01<00:13, 16.82it/s][6/6] extract embeddings:   8%|▊         | 20/239 [00:01<00:10, 20.36it/s][6/6] extract embeddings:  10%|█         | 24/239 [00:01<00:09, 23.62it/s][6/6] extract embeddings:  12%|█▏        | 28/239 [00:02<00:08, 25.39it/s][6/6] extract embeddings:  13%|█▎        | 32/239 [00:02<00:07, 27.52it/s][6/6] extract embeddings:  15%|█▌        | 36/239 [00:02<00:08, 24.96it/s][6/6] extract embeddings:  16%|█▋        | 39/239 [00:02<00:09, 22.10it/s][6/6] extract embeddings:  18%|█▊        | 42/239 [00:02<00:08, 22.24it/s][6/6] extract embeddings:  19%|█▉        | 45/239 [00:02<00:08, 22.80it/s][6/6] extract embeddings:  21%|██        | 49/239 [00:02<00:07, 25.68it/s][6/6] extract embeddings:  22%|██▏       | 52/239 [00:03<00:07, 26.02it/s][6/6] extract embeddings:  23%|██▎       | 55/239 [00:03<00:06, 26.78it/s][6/6] extract embeddings:  25%|██▍       | 59/239 [00:03<00:06, 28.42it/s][6/6] extract embeddings:  26%|██▋       | 63/239 [00:03<00:06, 28.76it/s][6/6] extract embeddings:  28%|██▊       | 66/239 [00:03<00:06, 28.18it/s][6/6] extract embeddings:  29%|██▉       | 70/239 [00:03<00:05, 29.69it/s][6/6] extract embeddings:  31%|███       | 74/239 [00:03<00:05, 30.61it/s][6/6] extract embeddings:  33%|███▎      | 78/239 [00:03<00:05, 31.81it/s][6/6] extract embeddings:  34%|███▍      | 82/239 [00:03<00:04, 32.08it/s][6/6] extract embeddings:  36%|███▌      | 86/239 [00:04<00:04, 32.78it/s][6/6] extract embeddings:  38%|███▊      | 90/239 [00:04<00:04, 33.62it/s][6/6] extract embeddings:  39%|███▉      | 94/239 [00:04<00:04, 32.15it/s][6/6] extract embeddings:  41%|████      | 98/239 [00:04<00:04, 31.79it/s][6/6] extract embeddings:  43%|████▎     | 102/239 [00:04<00:04, 31.47it/s][6/6] extract embeddings:  44%|████▍     | 106/239 [00:04<00:04, 31.11it/s][6/6] extract embeddings:  46%|████▌     | 110/239 [00:04<00:04, 30.58it/s][6/6] extract embeddings:  48%|████▊     | 114/239 [00:04<00:04, 30.53it/s][6/6] extract embeddings:  49%|████▉     | 118/239 [00:05<00:03, 31.12it/s][6/6] extract embeddings:  51%|█████     | 122/239 [00:05<00:04, 26.75it/s][6/6] extract embeddings:  52%|█████▏    | 125/239 [00:05<00:04, 25.03it/s][6/6] extract embeddings:  54%|█████▎    | 128/239 [00:05<00:04, 24.63it/s][6/6] extract embeddings:  55%|█████▍    | 131/239 [00:05<00:04, 23.33it/s][6/6] extract embeddings:  56%|█████▌    | 134/239 [00:05<00:04, 22.56it/s][6/6] extract embeddings:  57%|█████▋    | 137/239 [00:06<00:04, 22.80it/s][6/6] extract embeddings:  59%|█████▊    | 140/239 [00:06<00:04, 21.79it/s][6/6] extract embeddings:  60%|█████▉    | 143/239 [00:06<00:04, 21.21it/s][6/6] extract embeddings:  61%|██████    | 146/239 [00:06<00:04, 21.21it/s][6/6] extract embeddings:  62%|██████▏   | 149/239 [00:06<00:04, 20.41it/s][6/6] extract embeddings:  64%|██████▎   | 152/239 [00:06<00:04, 21.05it/s][6/6] extract embeddings:  65%|██████▍   | 155/239 [00:06<00:03, 21.53it/s][6/6] extract embeddings:  66%|██████▌   | 158/239 [00:07<00:03, 20.44it/s][6/6] extract embeddings:  67%|██████▋   | 161/239 [00:07<00:03, 20.04it/s][6/6] extract embeddings:  69%|██████▊   | 164/239 [00:07<00:03, 21.54it/s][6/6] extract embeddings:  70%|███████   | 168/239 [00:07<00:02, 24.70it/s][6/6] extract embeddings:  72%|███████▏  | 172/239 [00:07<00:02, 26.75it/s][6/6] extract embeddings:  73%|███████▎  | 175/239 [00:07<00:02, 26.75it/s][6/6] extract embeddings:  74%|███████▍  | 178/239 [00:07<00:02, 27.25it/s][6/6] extract embeddings:  76%|███████▌  | 182/239 [00:07<00:02, 28.33it/s][6/6] extract embeddings:  77%|███████▋  | 185/239 [00:08<00:01, 28.54it/s][6/6] extract embeddings:  79%|███████▊  | 188/239 [00:08<00:01, 28.78it/s][6/6] extract embeddings:  80%|███████▉  | 191/239 [00:08<00:01, 28.85it/s][6/6] extract embeddings:  81%|████████  | 194/239 [00:08<00:01, 28.96it/s][6/6] extract embeddings:  82%|████████▏ | 197/239 [00:08<00:01, 28.81it/s][6/6] extract embeddings:  84%|████████▎ | 200/239 [00:08<00:01, 29.10it/s][6/6] extract embeddings:  85%|████████▍ | 203/239 [00:08<00:01, 29.18it/s][6/6] extract embeddings:  87%|████████▋ | 207/239 [00:08<00:01, 29.48it/s][6/6] extract embeddings:  88%|████████▊ | 210/239 [00:08<00:01, 27.89it/s][6/6] extract embeddings:  89%|████████▉ | 213/239 [00:08<00:00, 28.19it/s][6/6] extract embeddings:  90%|█████████ | 216/239 [00:09<00:00, 28.42it/s][6/6] extract embeddings:  92%|█████████▏| 219/239 [00:09<00:00, 28.02it/s][6/6] extract embeddings:  93%|█████████▎| 222/239 [00:09<00:00, 24.92it/s][6/6] extract embeddings:  94%|█████████▍| 225/239 [00:09<00:00, 23.66it/s][6/6] extract embeddings:  95%|█████████▌| 228/239 [00:09<00:00, 21.84it/s][6/6] extract embeddings:  97%|█████████▋| 231/239 [00:09<00:00, 21.14it/s][6/6] extract embeddings:  98%|█████████▊| 234/239 [00:09<00:00, 21.29it/s][6/6] extract embeddings:  99%|█████████▉| 237/239 [00:10<00:00, 21.40it/s][6/6] extract embeddings: 100%|██████████| 239/239 [00:10<00:00, 23.46it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:02,  1.16it/s]clustering:  50%|█████     | 2/4 [00:02<00:02,  1.19s/it]clustering:  75%|███████▌  | 3/4 [00:02<00:00,  1.32it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s]
[NeMo I 2025-04-17 00:51:10 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:51:11 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              34.169831   444.120  ...   18.165012  4.090113
    Harker-ES                       25.624654  2178.782  ...   83.785101  3.845502
    Harker-MN                       38.507553   366.767  ...   30.267064  8.252396
    Longfellow-Block-1              17.687804   492.417  ...   13.439013  2.729193
    TOTAL                           26.949109  3482.086  ...  145.656189  4.183015
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:51:11 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.1048 | MISS: 0.1229 | CER: 0.0418 | DER: 0.2695 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.45, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.45, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.93s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  2.00s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.28s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.20s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:51:24 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:51:24 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:51:24 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:51:24 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:51:24 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:51:24 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:51:24 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:51:24 features:305] PADDING: 16
[NeMo I 2025-04-17 00:51:25 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:51:25 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:51:25 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:51:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:51:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:51:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:51:25 collections:880] Dataset successfully loaded with 2475 items and total duration provided from manifest is  1.79 hours.
[NeMo I 2025-04-17 00:51:25 collections:886] # 2475 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/39 [00:02<01:24,  2.23s/it][1/6] extract embeddings:  10%|█         | 4/39 [00:02<00:15,  2.21it/s][1/6] extract embeddings:  15%|█▌        | 6/39 [00:02<00:09,  3.47it/s][1/6] extract embeddings:  21%|██        | 8/39 [00:02<00:06,  4.94it/s][1/6] extract embeddings:  26%|██▌       | 10/39 [00:02<00:04,  6.39it/s][1/6] extract embeddings:  31%|███       | 12/39 [00:02<00:03,  7.65it/s][1/6] extract embeddings:  36%|███▌      | 14/39 [00:03<00:02,  8.71it/s][1/6] extract embeddings:  41%|████      | 16/39 [00:03<00:02,  9.52it/s][1/6] extract embeddings:  46%|████▌     | 18/39 [00:03<00:02, 10.36it/s][1/6] extract embeddings:  51%|█████▏    | 20/39 [00:03<00:01, 11.65it/s][1/6] extract embeddings:  56%|█████▋    | 22/39 [00:03<00:01, 12.13it/s][1/6] extract embeddings:  62%|██████▏   | 24/39 [00:03<00:01, 12.84it/s][1/6] extract embeddings:  67%|██████▋   | 26/39 [00:03<00:00, 13.06it/s][1/6] extract embeddings:  72%|███████▏  | 28/39 [00:04<00:00, 13.14it/s][1/6] extract embeddings:  77%|███████▋  | 30/39 [00:04<00:00, 13.18it/s][1/6] extract embeddings:  82%|████████▏ | 32/39 [00:04<00:00, 13.08it/s][1/6] extract embeddings:  87%|████████▋ | 34/39 [00:04<00:00, 12.90it/s][1/6] extract embeddings:  92%|█████████▏| 36/39 [00:04<00:00, 12.80it/s][1/6] extract embeddings:  97%|█████████▋| 38/39 [00:04<00:00, 13.24it/s][1/6] extract embeddings: 100%|██████████| 39/39 [00:04<00:00,  7.86it/s]
[NeMo I 2025-04-17 00:51:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:51:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:51:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:51:30 collections:880] Dataset successfully loaded with 2947 items and total duration provided from manifest is  1.83 hours.
[NeMo I 2025-04-17 00:51:30 collections:886] # 2947 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/47 [00:01<01:20,  1.75s/it][2/6] extract embeddings:   6%|▋         | 3/47 [00:01<00:22,  1.98it/s][2/6] extract embeddings:  11%|█         | 5/47 [00:02<00:12,  3.50it/s][2/6] extract embeddings:  15%|█▍        | 7/47 [00:02<00:07,  5.08it/s][2/6] extract embeddings:  19%|█▉        | 9/47 [00:02<00:05,  6.84it/s][2/6] extract embeddings:  23%|██▎       | 11/47 [00:02<00:04,  8.30it/s][2/6] extract embeddings:  28%|██▊       | 13/47 [00:02<00:03,  9.48it/s][2/6] extract embeddings:  32%|███▏      | 15/47 [00:02<00:02, 10.77it/s][2/6] extract embeddings:  36%|███▌      | 17/47 [00:02<00:02, 11.65it/s][2/6] extract embeddings:  40%|████      | 19/47 [00:03<00:02, 12.49it/s][2/6] extract embeddings:  45%|████▍     | 21/47 [00:03<00:01, 13.46it/s][2/6] extract embeddings:  49%|████▉     | 23/47 [00:03<00:01, 14.28it/s][2/6] extract embeddings:  53%|█████▎    | 25/47 [00:03<00:01, 15.06it/s][2/6] extract embeddings:  57%|█████▋    | 27/47 [00:03<00:01, 14.98it/s][2/6] extract embeddings:  62%|██████▏   | 29/47 [00:03<00:01, 14.57it/s][2/6] extract embeddings:  66%|██████▌   | 31/47 [00:03<00:01, 14.30it/s][2/6] extract embeddings:  70%|███████   | 33/47 [00:03<00:01, 13.98it/s][2/6] extract embeddings:  74%|███████▍  | 35/47 [00:04<00:00, 13.56it/s][2/6] extract embeddings:  79%|███████▊  | 37/47 [00:04<00:00, 13.27it/s][2/6] extract embeddings:  83%|████████▎ | 39/47 [00:04<00:00, 13.41it/s][2/6] extract embeddings:  87%|████████▋ | 41/47 [00:04<00:00, 13.31it/s][2/6] extract embeddings:  91%|█████████▏| 43/47 [00:04<00:00, 13.47it/s][2/6] extract embeddings:  96%|█████████▌| 45/47 [00:04<00:00, 13.40it/s][2/6] extract embeddings: 100%|██████████| 47/47 [00:04<00:00, 14.57it/s][2/6] extract embeddings: 100%|██████████| 47/47 [00:05<00:00,  9.37it/s]
[NeMo I 2025-04-17 00:51:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:51:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:51:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:51:35 collections:880] Dataset successfully loaded with 3682 items and total duration provided from manifest is  1.88 hours.
[NeMo I 2025-04-17 00:51:35 collections:886] # 3682 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/58 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/58 [00:01<01:16,  1.34s/it][3/6] extract embeddings:   5%|▌         | 3/58 [00:01<00:21,  2.51it/s][3/6] extract embeddings:   9%|▊         | 5/58 [00:01<00:12,  4.37it/s][3/6] extract embeddings:  12%|█▏        | 7/58 [00:01<00:08,  6.09it/s][3/6] extract embeddings:  16%|█▌        | 9/58 [00:01<00:06,  7.71it/s][3/6] extract embeddings:  19%|█▉        | 11/58 [00:02<00:05,  9.03it/s][3/6] extract embeddings:  22%|██▏       | 13/58 [00:02<00:04, 10.54it/s][3/6] extract embeddings:  26%|██▌       | 15/58 [00:02<00:03, 11.30it/s][3/6] extract embeddings:  29%|██▉       | 17/58 [00:02<00:03, 11.90it/s][3/6] extract embeddings:  33%|███▎      | 19/58 [00:02<00:03, 12.40it/s][3/6] extract embeddings:  36%|███▌      | 21/58 [00:02<00:02, 12.97it/s][3/6] extract embeddings:  40%|███▉      | 23/58 [00:02<00:02, 13.51it/s][3/6] extract embeddings:  43%|████▎     | 25/58 [00:03<00:02, 14.63it/s][3/6] extract embeddings:  47%|████▋     | 27/58 [00:03<00:01, 15.75it/s][3/6] extract embeddings:  52%|█████▏    | 30/58 [00:03<00:01, 16.71it/s][3/6] extract embeddings:  55%|█████▌    | 32/58 [00:03<00:01, 16.43it/s][3/6] extract embeddings:  59%|█████▊    | 34/58 [00:03<00:01, 16.44it/s][3/6] extract embeddings:  62%|██████▏   | 36/58 [00:03<00:01, 15.18it/s][3/6] extract embeddings:  66%|██████▌   | 38/58 [00:03<00:01, 14.40it/s][3/6] extract embeddings:  69%|██████▉   | 40/58 [00:03<00:01, 14.53it/s][3/6] extract embeddings:  72%|███████▏  | 42/58 [00:04<00:01, 14.18it/s][3/6] extract embeddings:  76%|███████▌  | 44/58 [00:04<00:01, 13.98it/s][3/6] extract embeddings:  79%|███████▉  | 46/58 [00:04<00:00, 13.72it/s][3/6] extract embeddings:  83%|████████▎ | 48/58 [00:04<00:00, 13.54it/s][3/6] extract embeddings:  86%|████████▌ | 50/58 [00:04<00:00, 13.99it/s][3/6] extract embeddings:  90%|████████▉ | 52/58 [00:04<00:00, 13.62it/s][3/6] extract embeddings:  93%|█████████▎| 54/58 [00:05<00:00, 13.78it/s][3/6] extract embeddings:  97%|█████████▋| 56/58 [00:05<00:00, 14.08it/s][3/6] extract embeddings: 100%|██████████| 58/58 [00:05<00:00, 15.01it/s][3/6] extract embeddings: 100%|██████████| 58/58 [00:05<00:00, 10.97it/s]
[NeMo I 2025-04-17 00:51:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:51:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:51:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:51:41 collections:880] Dataset successfully loaded with 4928 items and total duration provided from manifest is  1.94 hours.
[NeMo I 2025-04-17 00:51:41 collections:886] # 4928 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/77 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/77 [00:01<01:36,  1.26s/it][4/6] extract embeddings:   4%|▍         | 3/77 [00:01<00:27,  2.72it/s][4/6] extract embeddings:   6%|▋         | 5/77 [00:01<00:15,  4.77it/s][4/6] extract embeddings:   9%|▉         | 7/77 [00:01<00:10,  6.70it/s][4/6] extract embeddings:  12%|█▏        | 9/77 [00:01<00:08,  8.45it/s][4/6] extract embeddings:  14%|█▍        | 11/77 [00:01<00:06,  9.82it/s][4/6] extract embeddings:  17%|█▋        | 13/77 [00:02<00:05, 11.26it/s][4/6] extract embeddings:  19%|█▉        | 15/77 [00:02<00:05, 12.18it/s][4/6] extract embeddings:  22%|██▏       | 17/77 [00:02<00:04, 12.67it/s][4/6] extract embeddings:  25%|██▍       | 19/77 [00:02<00:04, 13.19it/s][4/6] extract embeddings:  27%|██▋       | 21/77 [00:02<00:04, 13.79it/s][4/6] extract embeddings:  30%|██▉       | 23/77 [00:02<00:03, 14.13it/s][4/6] extract embeddings:  32%|███▏      | 25/77 [00:02<00:03, 14.23it/s][4/6] extract embeddings:  35%|███▌      | 27/77 [00:02<00:03, 14.88it/s][4/6] extract embeddings:  38%|███▊      | 29/77 [00:03<00:03, 14.96it/s][4/6] extract embeddings:  40%|████      | 31/77 [00:03<00:03, 14.68it/s][4/6] extract embeddings:  43%|████▎     | 33/77 [00:03<00:02, 15.03it/s][4/6] extract embeddings:  45%|████▌     | 35/77 [00:03<00:02, 15.10it/s][4/6] extract embeddings:  48%|████▊     | 37/77 [00:03<00:02, 15.19it/s][4/6] extract embeddings:  51%|█████     | 39/77 [00:03<00:02, 14.95it/s][4/6] extract embeddings:  53%|█████▎    | 41/77 [00:03<00:02, 14.90it/s][4/6] extract embeddings:  56%|█████▌    | 43/77 [00:04<00:02, 14.42it/s][4/6] extract embeddings:  58%|█████▊    | 45/77 [00:04<00:02, 14.47it/s][4/6] extract embeddings:  61%|██████    | 47/77 [00:04<00:02, 14.70it/s][4/6] extract embeddings:  64%|██████▎   | 49/77 [00:04<00:01, 14.45it/s][4/6] extract embeddings:  66%|██████▌   | 51/77 [00:04<00:01, 14.45it/s][4/6] extract embeddings:  69%|██████▉   | 53/77 [00:04<00:01, 14.88it/s][4/6] extract embeddings:  71%|███████▏  | 55/77 [00:04<00:01, 15.08it/s][4/6] extract embeddings:  74%|███████▍  | 57/77 [00:04<00:01, 14.83it/s][4/6] extract embeddings:  77%|███████▋  | 59/77 [00:05<00:01, 14.83it/s][4/6] extract embeddings:  79%|███████▉  | 61/77 [00:05<00:01, 14.37it/s][4/6] extract embeddings:  82%|████████▏ | 63/77 [00:05<00:00, 14.53it/s][4/6] extract embeddings:  84%|████████▍ | 65/77 [00:05<00:00, 14.04it/s][4/6] extract embeddings:  87%|████████▋ | 67/77 [00:05<00:00, 14.48it/s][4/6] extract embeddings:  90%|████████▉ | 69/77 [00:05<00:00, 14.77it/s][4/6] extract embeddings:  92%|█████████▏| 71/77 [00:05<00:00, 15.61it/s][4/6] extract embeddings:  96%|█████████▌| 74/77 [00:06<00:00, 17.01it/s][4/6] extract embeddings:  99%|█████████▊| 76/77 [00:06<00:00, 17.71it/s][4/6] extract embeddings: 100%|██████████| 77/77 [00:06<00:00, 12.26it/s]
[NeMo I 2025-04-17 00:51:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:51:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:51:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:51:47 collections:880] Dataset successfully loaded with 7455 items and total duration provided from manifest is  2.00 hours.
[NeMo I 2025-04-17 00:51:47 collections:886] # 7455 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/117 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/117 [00:01<02:28,  1.28s/it][5/6] extract embeddings:   3%|▎         | 3/117 [00:01<00:42,  2.69it/s][5/6] extract embeddings:   4%|▍         | 5/117 [00:01<00:23,  4.70it/s][5/6] extract embeddings:   6%|▌         | 7/117 [00:01<00:16,  6.85it/s][5/6] extract embeddings:   8%|▊         | 9/117 [00:01<00:12,  8.91it/s][5/6] extract embeddings:   9%|▉         | 11/117 [00:01<00:09, 10.77it/s][5/6] extract embeddings:  11%|█         | 13/117 [00:01<00:08, 12.49it/s][5/6] extract embeddings:  13%|█▎        | 15/117 [00:02<00:07, 13.90it/s][5/6] extract embeddings:  15%|█▍        | 17/117 [00:02<00:06, 15.01it/s][5/6] extract embeddings:  16%|█▌        | 19/117 [00:02<00:06, 16.26it/s][5/6] extract embeddings:  18%|█▊        | 21/117 [00:02<00:05, 16.91it/s][5/6] extract embeddings:  20%|█▉        | 23/117 [00:02<00:05, 17.50it/s][5/6] extract embeddings:  21%|██▏       | 25/117 [00:02<00:05, 17.76it/s][5/6] extract embeddings:  23%|██▎       | 27/117 [00:02<00:05, 17.32it/s][5/6] extract embeddings:  25%|██▍       | 29/117 [00:02<00:05, 17.55it/s][5/6] extract embeddings:  26%|██▋       | 31/117 [00:02<00:04, 17.65it/s][5/6] extract embeddings:  28%|██▊       | 33/117 [00:03<00:04, 17.99it/s][5/6] extract embeddings:  30%|██▉       | 35/117 [00:03<00:04, 17.91it/s][5/6] extract embeddings:  32%|███▏      | 37/117 [00:03<00:04, 18.15it/s][5/6] extract embeddings:  33%|███▎      | 39/117 [00:03<00:04, 18.34it/s][5/6] extract embeddings:  35%|███▌      | 41/117 [00:03<00:04, 18.47it/s][5/6] extract embeddings:  37%|███▋      | 43/117 [00:03<00:03, 18.71it/s][5/6] extract embeddings:  38%|███▊      | 45/117 [00:03<00:03, 18.47it/s][5/6] extract embeddings:  40%|████      | 47/117 [00:03<00:03, 18.79it/s][5/6] extract embeddings:  42%|████▏     | 49/117 [00:03<00:03, 18.18it/s][5/6] extract embeddings:  44%|████▎     | 51/117 [00:04<00:03, 18.53it/s][5/6] extract embeddings:  45%|████▌     | 53/117 [00:04<00:03, 18.71it/s][5/6] extract embeddings:  47%|████▋     | 55/117 [00:04<00:03, 18.10it/s][5/6] extract embeddings:  50%|████▉     | 58/117 [00:04<00:03, 18.60it/s][5/6] extract embeddings:  51%|█████▏    | 60/117 [00:04<00:03, 18.22it/s][5/6] extract embeddings:  53%|█████▎    | 62/117 [00:04<00:03, 17.85it/s][5/6] extract embeddings:  55%|█████▍    | 64/117 [00:04<00:02, 18.18it/s][5/6] extract embeddings:  56%|█████▋    | 66/117 [00:04<00:02, 17.50it/s][5/6] extract embeddings:  58%|█████▊    | 68/117 [00:04<00:02, 17.80it/s][5/6] extract embeddings:  60%|█████▉    | 70/117 [00:05<00:02, 17.58it/s][5/6] extract embeddings:  62%|██████▏   | 72/117 [00:05<00:02, 17.08it/s][5/6] extract embeddings:  63%|██████▎   | 74/117 [00:05<00:02, 17.22it/s][5/6] extract embeddings:  65%|██████▍   | 76/117 [00:05<00:02, 17.69it/s][5/6] extract embeddings:  67%|██████▋   | 78/117 [00:05<00:02, 17.85it/s][5/6] extract embeddings:  68%|██████▊   | 80/117 [00:05<00:02, 17.60it/s][5/6] extract embeddings:  70%|███████   | 82/117 [00:05<00:02, 17.19it/s][5/6] extract embeddings:  72%|███████▏  | 84/117 [00:05<00:01, 17.66it/s][5/6] extract embeddings:  74%|███████▎  | 86/117 [00:05<00:01, 18.01it/s][5/6] extract embeddings:  75%|███████▌  | 88/117 [00:06<00:01, 17.77it/s][5/6] extract embeddings:  77%|███████▋  | 90/117 [00:06<00:01, 17.23it/s][5/6] extract embeddings:  79%|███████▉  | 93/117 [00:06<00:01, 17.72it/s][5/6] extract embeddings:  81%|████████  | 95/117 [00:06<00:01, 17.51it/s][5/6] extract embeddings:  83%|████████▎ | 97/117 [00:06<00:01, 17.50it/s][5/6] extract embeddings:  85%|████████▍ | 99/117 [00:06<00:01, 17.64it/s][5/6] extract embeddings:  86%|████████▋ | 101/117 [00:06<00:00, 16.86it/s][5/6] extract embeddings:  89%|████████▉ | 104/117 [00:07<00:00, 17.81it/s][5/6] extract embeddings:  91%|█████████ | 106/117 [00:07<00:00, 18.09it/s][5/6] extract embeddings:  92%|█████████▏| 108/117 [00:07<00:00, 18.39it/s][5/6] extract embeddings:  94%|█████████▍| 110/117 [00:07<00:00, 18.42it/s][5/6] extract embeddings:  96%|█████████▌| 112/117 [00:07<00:00, 17.88it/s][5/6] extract embeddings:  97%|█████████▋| 114/117 [00:07<00:00, 18.04it/s][5/6] extract embeddings:  99%|█████████▉| 116/117 [00:07<00:00, 17.98it/s][5/6] extract embeddings: 100%|██████████| 117/117 [00:07<00:00, 15.10it/s]
[NeMo I 2025-04-17 00:51:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:51:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:51:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:51:56 collections:880] Dataset successfully loaded with 15096 items and total duration provided from manifest is  2.07 hours.
[NeMo I 2025-04-17 00:51:56 collections:886] # 15096 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/236 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/236 [00:01<05:02,  1.29s/it][6/6] extract embeddings:   2%|▏         | 4/236 [00:01<01:05,  3.53it/s][6/6] extract embeddings:   3%|▎         | 6/236 [00:01<00:42,  5.42it/s][6/6] extract embeddings:   3%|▎         | 8/236 [00:01<00:30,  7.41it/s][6/6] extract embeddings:   5%|▍         | 11/236 [00:01<00:21, 10.45it/s][6/6] extract embeddings:   6%|▌         | 14/236 [00:01<00:17, 12.93it/s][6/6] extract embeddings:   7%|▋         | 17/236 [00:02<00:14, 15.37it/s][6/6] extract embeddings:   8%|▊         | 20/236 [00:02<00:12, 17.22it/s][6/6] extract embeddings:  10%|▉         | 23/236 [00:02<00:11, 17.88it/s][6/6] extract embeddings:  11%|█         | 26/236 [00:02<00:11, 17.81it/s][6/6] extract embeddings:  12%|█▏        | 29/236 [00:02<00:10, 19.01it/s][6/6] extract embeddings:  14%|█▎        | 32/236 [00:02<00:10, 19.28it/s][6/6] extract embeddings:  15%|█▍        | 35/236 [00:02<00:10, 19.30it/s][6/6] extract embeddings:  16%|█▌        | 37/236 [00:03<00:10, 18.86it/s][6/6] extract embeddings:  17%|█▋        | 39/236 [00:03<00:10, 18.95it/s][6/6] extract embeddings:  17%|█▋        | 41/236 [00:03<00:10, 19.21it/s][6/6] extract embeddings:  19%|█▊        | 44/236 [00:03<00:09, 19.89it/s][6/6] extract embeddings:  19%|█▉        | 46/236 [00:03<00:09, 19.01it/s][6/6] extract embeddings:  21%|██        | 49/236 [00:03<00:09, 19.18it/s][6/6] extract embeddings:  22%|██▏       | 52/236 [00:03<00:09, 19.68it/s][6/6] extract embeddings:  23%|██▎       | 55/236 [00:03<00:09, 19.97it/s][6/6] extract embeddings:  25%|██▍       | 58/236 [00:04<00:08, 20.81it/s][6/6] extract embeddings:  26%|██▌       | 61/236 [00:04<00:08, 20.12it/s][6/6] extract embeddings:  27%|██▋       | 64/236 [00:04<00:08, 19.48it/s][6/6] extract embeddings:  28%|██▊       | 67/236 [00:04<00:08, 18.96it/s][6/6] extract embeddings:  29%|██▉       | 69/236 [00:04<00:08, 18.70it/s][6/6] extract embeddings:  31%|███       | 72/236 [00:04<00:08, 19.41it/s][6/6] extract embeddings:  32%|███▏      | 75/236 [00:05<00:08, 19.58it/s][6/6] extract embeddings:  33%|███▎      | 77/236 [00:05<00:08, 19.28it/s][6/6] extract embeddings:  34%|███▍      | 80/236 [00:05<00:08, 19.44it/s][6/6] extract embeddings:  35%|███▍      | 82/236 [00:05<00:07, 19.35it/s][6/6] extract embeddings:  36%|███▌      | 84/236 [00:05<00:07, 19.18it/s][6/6] extract embeddings:  36%|███▋      | 86/236 [00:05<00:07, 19.38it/s][6/6] extract embeddings:  37%|███▋      | 88/236 [00:05<00:07, 19.37it/s][6/6] extract embeddings:  38%|███▊      | 90/236 [00:05<00:07, 19.21it/s][6/6] extract embeddings:  39%|███▉      | 92/236 [00:05<00:07, 19.26it/s][6/6] extract embeddings:  40%|███▉      | 94/236 [00:06<00:07, 19.18it/s][6/6] extract embeddings:  41%|████      | 97/236 [00:06<00:07, 19.46it/s][6/6] extract embeddings:  42%|████▏     | 100/236 [00:06<00:06, 20.82it/s][6/6] extract embeddings:  44%|████▎     | 103/236 [00:06<00:06, 20.82it/s][6/6] extract embeddings:  45%|████▍     | 106/236 [00:06<00:06, 20.28it/s][6/6] extract embeddings:  46%|████▌     | 109/236 [00:06<00:06, 20.46it/s][6/6] extract embeddings:  47%|████▋     | 112/236 [00:06<00:06, 20.22it/s][6/6] extract embeddings:  49%|████▊     | 115/236 [00:07<00:06, 20.01it/s][6/6] extract embeddings:  50%|█████     | 118/236 [00:07<00:05, 20.91it/s][6/6] extract embeddings:  51%|█████▏    | 121/236 [00:07<00:05, 20.46it/s][6/6] extract embeddings:  53%|█████▎    | 124/236 [00:07<00:05, 20.73it/s][6/6] extract embeddings:  54%|█████▍    | 127/236 [00:07<00:05, 19.81it/s][6/6] extract embeddings:  55%|█████▍    | 129/236 [00:07<00:05, 19.74it/s][6/6] extract embeddings:  56%|█████▌    | 131/236 [00:07<00:05, 19.28it/s][6/6] extract embeddings:  57%|█████▋    | 134/236 [00:07<00:05, 20.02it/s][6/6] extract embeddings:  58%|█████▊    | 137/236 [00:08<00:04, 20.28it/s][6/6] extract embeddings:  59%|█████▉    | 140/236 [00:08<00:05, 19.16it/s][6/6] extract embeddings:  60%|██████    | 142/236 [00:08<00:04, 18.86it/s][6/6] extract embeddings:  61%|██████    | 144/236 [00:08<00:04, 18.49it/s][6/6] extract embeddings:  62%|██████▏   | 146/236 [00:08<00:04, 18.25it/s][6/6] extract embeddings:  63%|██████▎   | 149/236 [00:08<00:04, 18.63it/s][6/6] extract embeddings:  64%|██████▍   | 151/236 [00:08<00:04, 17.67it/s][6/6] extract embeddings:  65%|██████▍   | 153/236 [00:09<00:04, 18.23it/s][6/6] extract embeddings:  66%|██████▌   | 156/236 [00:09<00:04, 19.28it/s][6/6] extract embeddings:  67%|██████▋   | 159/236 [00:09<00:03, 20.37it/s][6/6] extract embeddings:  69%|██████▉   | 163/236 [00:09<00:03, 23.93it/s][6/6] extract embeddings:  71%|███████   | 167/236 [00:09<00:02, 26.45it/s][6/6] extract embeddings:  72%|███████▏  | 171/236 [00:09<00:02, 27.84it/s][6/6] extract embeddings:  74%|███████▎  | 174/236 [00:09<00:02, 24.91it/s][6/6] extract embeddings:  75%|███████▌  | 177/236 [00:09<00:02, 24.07it/s][6/6] extract embeddings:  76%|███████▋  | 180/236 [00:10<00:02, 22.93it/s][6/6] extract embeddings:  78%|███████▊  | 183/236 [00:10<00:02, 22.93it/s][6/6] extract embeddings:  79%|███████▉  | 186/236 [00:10<00:02, 23.53it/s][6/6] extract embeddings:  81%|████████  | 190/236 [00:10<00:01, 26.14it/s][6/6] extract embeddings:  82%|████████▏ | 193/236 [00:10<00:01, 25.31it/s][6/6] extract embeddings:  83%|████████▎ | 196/236 [00:10<00:01, 23.87it/s][6/6] extract embeddings:  84%|████████▍ | 199/236 [00:10<00:01, 25.12it/s][6/6] extract embeddings:  86%|████████▌ | 202/236 [00:10<00:01, 25.42it/s][6/6] extract embeddings:  87%|████████▋ | 206/236 [00:11<00:01, 27.99it/s][6/6] extract embeddings:  89%|████████▉ | 210/236 [00:11<00:00, 28.41it/s][6/6] extract embeddings:  90%|█████████ | 213/236 [00:11<00:00, 25.27it/s][6/6] extract embeddings:  92%|█████████▏| 216/236 [00:11<00:00, 24.01it/s][6/6] extract embeddings:  93%|█████████▎| 219/236 [00:11<00:00, 23.86it/s][6/6] extract embeddings:  94%|█████████▍| 222/236 [00:11<00:00, 21.76it/s][6/6] extract embeddings:  95%|█████████▌| 225/236 [00:11<00:00, 20.79it/s][6/6] extract embeddings:  97%|█████████▋| 228/236 [00:12<00:00, 20.90it/s][6/6] extract embeddings:  98%|█████████▊| 231/236 [00:12<00:00, 20.85it/s][6/6] extract embeddings: 100%|█████████▉| 235/236 [00:12<00:00, 24.25it/s][6/6] extract embeddings: 100%|██████████| 236/236 [00:12<00:00, 18.94it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.84it/s]clustering:  50%|█████     | 2/4 [00:01<00:02,  1.02s/it]clustering:  75%|███████▌  | 3/4 [00:02<00:00,  1.50it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s]
[NeMo I 2025-04-17 00:52:11 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:52:12 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              32.746787   444.120  ...   12.524998  2.820183
    Harker-ES                       26.402956  2178.782  ...   88.137685  4.045273
    Harker-MN                       38.890374   366.767  ...   30.211057  8.237125
    Longfellow-Block-1              18.602490   492.417  ...   14.297030  2.903439
    TOTAL                           27.424273  3482.086  ...  145.170770  4.169075
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:52:12 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.1024 | MISS: 0.1302 | CER: 0.0417 | DER: 0.2742 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.50, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.5, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.96s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.98s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.27s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.20s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:52:26 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:52:26 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:52:26 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:52:26 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:52:26 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:52:26 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:52:26 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:52:26 features:305] PADDING: 16
[NeMo I 2025-04-17 00:52:26 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:52:26 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:52:26 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:52:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:52:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:52:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:52:26 collections:880] Dataset successfully loaded with 2445 items and total duration provided from manifest is  1.75 hours.
[NeMo I 2025-04-17 00:52:26 collections:886] # 2445 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/39 [00:02<01:27,  2.30s/it][1/6] extract embeddings:  10%|█         | 4/39 [00:02<00:16,  2.15it/s][1/6] extract embeddings:  15%|█▌        | 6/39 [00:02<00:09,  3.41it/s][1/6] extract embeddings:  21%|██        | 8/39 [00:02<00:06,  4.76it/s][1/6] extract embeddings:  26%|██▌       | 10/39 [00:02<00:04,  6.25it/s][1/6] extract embeddings:  31%|███       | 12/39 [00:03<00:03,  7.46it/s][1/6] extract embeddings:  36%|███▌      | 14/39 [00:03<00:02,  8.51it/s][1/6] extract embeddings:  41%|████      | 16/39 [00:03<00:02,  9.94it/s][1/6] extract embeddings:  46%|████▌     | 18/39 [00:03<00:01, 11.02it/s][1/6] extract embeddings:  51%|█████▏    | 20/39 [00:03<00:01, 11.43it/s][1/6] extract embeddings:  56%|█████▋    | 22/39 [00:03<00:01, 12.47it/s][1/6] extract embeddings:  62%|██████▏   | 24/39 [00:03<00:01, 12.22it/s][1/6] extract embeddings:  67%|██████▋   | 26/39 [00:04<00:01, 12.53it/s][1/6] extract embeddings:  72%|███████▏  | 28/39 [00:04<00:00, 12.54it/s][1/6] extract embeddings:  77%|███████▋  | 30/39 [00:04<00:00, 12.43it/s][1/6] extract embeddings:  82%|████████▏ | 32/39 [00:04<00:00, 12.09it/s][1/6] extract embeddings:  87%|████████▋ | 34/39 [00:04<00:00, 11.96it/s][1/6] extract embeddings:  92%|█████████▏| 36/39 [00:04<00:00, 12.19it/s][1/6] extract embeddings:  97%|█████████▋| 38/39 [00:05<00:00, 12.47it/s][1/6] extract embeddings: 100%|██████████| 39/39 [00:05<00:00,  7.68it/s]
[NeMo I 2025-04-17 00:52:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:52:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:52:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:52:32 collections:880] Dataset successfully loaded with 2901 items and total duration provided from manifest is  1.79 hours.
[NeMo I 2025-04-17 00:52:32 collections:886] # 2901 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/46 [00:01<01:05,  1.46s/it][2/6] extract embeddings:   7%|▋         | 3/46 [00:01<00:18,  2.33it/s][2/6] extract embeddings:  11%|█         | 5/46 [00:01<00:10,  4.08it/s][2/6] extract embeddings:  15%|█▌        | 7/46 [00:01<00:06,  5.88it/s][2/6] extract embeddings:  20%|█▉        | 9/46 [00:02<00:04,  7.53it/s][2/6] extract embeddings:  24%|██▍       | 11/46 [00:02<00:03,  9.25it/s][2/6] extract embeddings:  28%|██▊       | 13/46 [00:02<00:03, 10.29it/s][2/6] extract embeddings:  33%|███▎      | 15/46 [00:02<00:02, 11.23it/s][2/6] extract embeddings:  37%|███▋      | 17/46 [00:02<00:02, 11.94it/s][2/6] extract embeddings:  41%|████▏     | 19/46 [00:02<00:02, 12.83it/s][2/6] extract embeddings:  46%|████▌     | 21/46 [00:02<00:01, 13.10it/s][2/6] extract embeddings:  50%|█████     | 23/46 [00:02<00:01, 13.82it/s][2/6] extract embeddings:  54%|█████▍    | 25/46 [00:03<00:01, 14.53it/s][2/6] extract embeddings:  59%|█████▊    | 27/46 [00:03<00:01, 14.33it/s][2/6] extract embeddings:  63%|██████▎   | 29/46 [00:03<00:01, 14.57it/s][2/6] extract embeddings:  67%|██████▋   | 31/46 [00:03<00:01, 14.80it/s][2/6] extract embeddings:  72%|███████▏  | 33/46 [00:03<00:00, 14.65it/s][2/6] extract embeddings:  76%|███████▌  | 35/46 [00:03<00:00, 14.81it/s][2/6] extract embeddings:  80%|████████  | 37/46 [00:03<00:00, 14.51it/s][2/6] extract embeddings:  85%|████████▍ | 39/46 [00:04<00:00, 14.59it/s][2/6] extract embeddings:  89%|████████▉ | 41/46 [00:04<00:00, 14.83it/s][2/6] extract embeddings:  93%|█████████▎| 43/46 [00:04<00:00, 14.71it/s][2/6] extract embeddings:  98%|█████████▊| 45/46 [00:04<00:00, 14.75it/s][2/6] extract embeddings: 100%|██████████| 46/46 [00:04<00:00, 10.18it/s]
[NeMo I 2025-04-17 00:52:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:52:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:52:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:52:36 collections:880] Dataset successfully loaded with 3624 items and total duration provided from manifest is  1.84 hours.
[NeMo I 2025-04-17 00:52:36 collections:886] # 3624 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/57 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/57 [00:01<01:11,  1.28s/it][3/6] extract embeddings:   5%|▌         | 3/57 [00:01<00:20,  2.65it/s][3/6] extract embeddings:   9%|▉         | 5/57 [00:01<00:11,  4.56it/s][3/6] extract embeddings:  12%|█▏        | 7/57 [00:01<00:07,  6.58it/s][3/6] extract embeddings:  16%|█▌        | 9/57 [00:01<00:05,  8.49it/s][3/6] extract embeddings:  19%|█▉        | 11/57 [00:01<00:04, 10.49it/s][3/6] extract embeddings:  23%|██▎       | 13/57 [00:02<00:03, 12.03it/s][3/6] extract embeddings:  26%|██▋       | 15/57 [00:02<00:03, 12.53it/s][3/6] extract embeddings:  30%|██▉       | 17/57 [00:02<00:02, 13.37it/s][3/6] extract embeddings:  33%|███▎      | 19/57 [00:02<00:02, 13.71it/s][3/6] extract embeddings:  37%|███▋      | 21/57 [00:02<00:02, 13.66it/s][3/6] extract embeddings:  40%|████      | 23/57 [00:02<00:02, 13.80it/s][3/6] extract embeddings:  44%|████▍     | 25/57 [00:02<00:02, 13.92it/s][3/6] extract embeddings:  47%|████▋     | 27/57 [00:02<00:02, 13.82it/s][3/6] extract embeddings:  51%|█████     | 29/57 [00:03<00:01, 14.12it/s][3/6] extract embeddings:  54%|█████▍    | 31/57 [00:03<00:01, 14.48it/s][3/6] extract embeddings:  58%|█████▊    | 33/57 [00:03<00:01, 14.86it/s][3/6] extract embeddings:  61%|██████▏   | 35/57 [00:03<00:01, 14.38it/s][3/6] extract embeddings:  65%|██████▍   | 37/57 [00:03<00:01, 14.17it/s][3/6] extract embeddings:  68%|██████▊   | 39/57 [00:03<00:01, 14.40it/s][3/6] extract embeddings:  72%|███████▏  | 41/57 [00:03<00:01, 14.42it/s][3/6] extract embeddings:  75%|███████▌  | 43/57 [00:04<00:00, 14.68it/s][3/6] extract embeddings:  79%|███████▉  | 45/57 [00:04<00:00, 14.26it/s][3/6] extract embeddings:  82%|████████▏ | 47/57 [00:04<00:00, 14.15it/s][3/6] extract embeddings:  86%|████████▌ | 49/57 [00:04<00:00, 13.95it/s][3/6] extract embeddings:  89%|████████▉ | 51/57 [00:04<00:00, 14.80it/s][3/6] extract embeddings:  93%|█████████▎| 53/57 [00:04<00:00, 14.65it/s][3/6] extract embeddings:  96%|█████████▋| 55/57 [00:04<00:00, 14.16it/s][3/6] extract embeddings: 100%|██████████| 57/57 [00:05<00:00, 15.29it/s][3/6] extract embeddings: 100%|██████████| 57/57 [00:05<00:00, 11.24it/s]
[NeMo I 2025-04-17 00:52:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:52:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:52:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:52:42 collections:880] Dataset successfully loaded with 4840 items and total duration provided from manifest is  1.90 hours.
[NeMo I 2025-04-17 00:52:42 collections:886] # 4840 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/76 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/76 [00:01<01:31,  1.22s/it][4/6] extract embeddings:   4%|▍         | 3/76 [00:01<00:25,  2.82it/s][4/6] extract embeddings:   7%|▋         | 5/76 [00:01<00:14,  4.90it/s][4/6] extract embeddings:   9%|▉         | 7/76 [00:01<00:09,  7.08it/s][4/6] extract embeddings:  12%|█▏        | 9/76 [00:01<00:07,  8.88it/s][4/6] extract embeddings:  14%|█▍        | 11/76 [00:01<00:06, 10.50it/s][4/6] extract embeddings:  18%|█▊        | 14/76 [00:01<00:04, 13.09it/s][4/6] extract embeddings:  21%|██        | 16/76 [00:02<00:04, 14.06it/s][4/6] extract embeddings:  24%|██▎       | 18/76 [00:02<00:03, 15.26it/s][4/6] extract embeddings:  26%|██▋       | 20/76 [00:02<00:03, 16.13it/s][4/6] extract embeddings:  30%|███       | 23/76 [00:02<00:03, 17.33it/s][4/6] extract embeddings:  33%|███▎      | 25/76 [00:02<00:02, 17.65it/s][4/6] extract embeddings:  37%|███▋      | 28/76 [00:02<00:02, 18.66it/s][4/6] extract embeddings:  41%|████      | 31/76 [00:02<00:02, 19.37it/s][4/6] extract embeddings:  45%|████▍     | 34/76 [00:02<00:02, 19.66it/s][4/6] extract embeddings:  47%|████▋     | 36/76 [00:03<00:02, 19.63it/s][4/6] extract embeddings:  51%|█████▏    | 39/76 [00:03<00:01, 20.34it/s][4/6] extract embeddings:  55%|█████▌    | 42/76 [00:03<00:01, 20.66it/s][4/6] extract embeddings:  59%|█████▉    | 45/76 [00:03<00:01, 20.90it/s][4/6] extract embeddings:  63%|██████▎   | 48/76 [00:03<00:01, 19.69it/s][4/6] extract embeddings:  67%|██████▋   | 51/76 [00:03<00:01, 19.80it/s][4/6] extract embeddings:  71%|███████   | 54/76 [00:03<00:01, 20.09it/s][4/6] extract embeddings:  75%|███████▌  | 57/76 [00:04<00:00, 19.27it/s][4/6] extract embeddings:  78%|███████▊  | 59/76 [00:04<00:00, 18.62it/s][4/6] extract embeddings:  80%|████████  | 61/76 [00:04<00:00, 17.80it/s][4/6] extract embeddings:  83%|████████▎ | 63/76 [00:04<00:00, 17.58it/s][4/6] extract embeddings:  86%|████████▌ | 65/76 [00:04<00:00, 17.39it/s][4/6] extract embeddings:  88%|████████▊ | 67/76 [00:04<00:00, 17.22it/s][4/6] extract embeddings:  92%|█████████▏| 70/76 [00:04<00:00, 18.71it/s][4/6] extract embeddings:  96%|█████████▌| 73/76 [00:05<00:00, 19.18it/s][4/6] extract embeddings:  99%|█████████▊| 75/76 [00:05<00:00, 19.21it/s][4/6] extract embeddings: 100%|██████████| 76/76 [00:05<00:00, 14.63it/s]
[NeMo I 2025-04-17 00:52:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:52:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:52:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:52:47 collections:880] Dataset successfully loaded with 7327 items and total duration provided from manifest is  1.96 hours.
[NeMo I 2025-04-17 00:52:47 collections:886] # 7327 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/115 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/115 [00:01<02:13,  1.17s/it][5/6] extract embeddings:   3%|▎         | 4/115 [00:01<00:28,  3.86it/s][5/6] extract embeddings:   5%|▌         | 6/115 [00:01<00:18,  5.81it/s][5/6] extract embeddings:   7%|▋         | 8/115 [00:01<00:14,  7.61it/s][5/6] extract embeddings:   9%|▊         | 10/115 [00:01<00:11,  9.43it/s][5/6] extract embeddings:  10%|█         | 12/115 [00:01<00:09, 11.25it/s][5/6] extract embeddings:  12%|█▏        | 14/115 [00:01<00:08, 12.47it/s][5/6] extract embeddings:  14%|█▍        | 16/115 [00:02<00:07, 14.12it/s][5/6] extract embeddings:  17%|█▋        | 19/115 [00:02<00:05, 17.16it/s][5/6] extract embeddings:  19%|█▉        | 22/115 [00:02<00:04, 19.50it/s][5/6] extract embeddings:  22%|██▏       | 25/115 [00:02<00:04, 18.14it/s][5/6] extract embeddings:  24%|██▍       | 28/115 [00:02<00:04, 19.91it/s][5/6] extract embeddings:  27%|██▋       | 31/115 [00:02<00:03, 21.49it/s][5/6] extract embeddings:  30%|██▉       | 34/115 [00:02<00:03, 22.60it/s][5/6] extract embeddings:  32%|███▏      | 37/115 [00:02<00:03, 23.40it/s][5/6] extract embeddings:  35%|███▍      | 40/115 [00:03<00:03, 24.10it/s][5/6] extract embeddings:  37%|███▋      | 43/115 [00:03<00:03, 23.76it/s][5/6] extract embeddings:  40%|████      | 46/115 [00:03<00:02, 23.89it/s][5/6] extract embeddings:  43%|████▎     | 49/115 [00:03<00:02, 24.28it/s][5/6] extract embeddings:  45%|████▌     | 52/115 [00:03<00:02, 25.01it/s][5/6] extract embeddings:  48%|████▊     | 55/115 [00:03<00:02, 24.93it/s][5/6] extract embeddings:  50%|█████     | 58/115 [00:03<00:02, 24.58it/s][5/6] extract embeddings:  53%|█████▎    | 61/115 [00:03<00:02, 24.71it/s][5/6] extract embeddings:  56%|█████▌    | 64/115 [00:04<00:02, 24.26it/s][5/6] extract embeddings:  58%|█████▊    | 67/115 [00:04<00:01, 24.77it/s][5/6] extract embeddings:  61%|██████    | 70/115 [00:04<00:01, 24.84it/s][5/6] extract embeddings:  63%|██████▎   | 73/115 [00:04<00:01, 24.61it/s][5/6] extract embeddings:  66%|██████▌   | 76/115 [00:04<00:01, 24.52it/s][5/6] extract embeddings:  69%|██████▊   | 79/115 [00:04<00:01, 23.39it/s][5/6] extract embeddings:  71%|███████▏  | 82/115 [00:04<00:01, 23.55it/s][5/6] extract embeddings:  74%|███████▍  | 85/115 [00:04<00:01, 22.59it/s][5/6] extract embeddings:  77%|███████▋  | 88/115 [00:05<00:01, 22.15it/s][5/6] extract embeddings:  79%|███████▉  | 91/115 [00:05<00:01, 23.38it/s][5/6] extract embeddings:  82%|████████▏ | 94/115 [00:05<00:00, 23.73it/s][5/6] extract embeddings:  84%|████████▍ | 97/115 [00:05<00:00, 23.31it/s][5/6] extract embeddings:  87%|████████▋ | 100/115 [00:05<00:00, 22.41it/s][5/6] extract embeddings:  90%|████████▉ | 103/115 [00:05<00:00, 21.82it/s][5/6] extract embeddings:  92%|█████████▏| 106/115 [00:05<00:00, 22.22it/s][5/6] extract embeddings:  95%|█████████▍| 109/115 [00:06<00:00, 20.28it/s][5/6] extract embeddings:  97%|█████████▋| 112/115 [00:06<00:00, 19.65it/s][5/6] extract embeddings:  99%|█████████▉| 114/115 [00:06<00:00, 19.15it/s][5/6] extract embeddings: 100%|██████████| 115/115 [00:06<00:00, 18.12it/s]
[NeMo I 2025-04-17 00:52:54 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:52:54 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:52:54 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:52:54 collections:880] Dataset successfully loaded with 14857 items and total duration provided from manifest is  2.03 hours.
[NeMo I 2025-04-17 00:52:54 collections:886] # 14857 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/233 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/233 [00:01<04:36,  1.19s/it][6/6] extract embeddings:   2%|▏         | 4/233 [00:01<00:58,  3.94it/s][6/6] extract embeddings:   3%|▎         | 7/233 [00:01<00:31,  7.27it/s][6/6] extract embeddings:   4%|▍         | 10/233 [00:01<00:21, 10.24it/s][6/6] extract embeddings:   6%|▌         | 13/233 [00:01<00:16, 12.96it/s][6/6] extract embeddings:   7%|▋         | 16/233 [00:01<00:14, 15.18it/s][6/6] extract embeddings:   8%|▊         | 19/233 [00:01<00:12, 16.88it/s][6/6] extract embeddings:   9%|▉         | 22/233 [00:02<00:11, 18.21it/s][6/6] extract embeddings:  11%|█         | 25/233 [00:02<00:11, 18.39it/s][6/6] extract embeddings:  12%|█▏        | 28/233 [00:02<00:10, 19.36it/s][6/6] extract embeddings:  13%|█▎        | 31/233 [00:02<00:10, 19.48it/s][6/6] extract embeddings:  15%|█▍        | 34/233 [00:02<00:09, 21.04it/s][6/6] extract embeddings:  16%|█▌        | 37/233 [00:02<00:09, 21.02it/s][6/6] extract embeddings:  17%|█▋        | 40/233 [00:02<00:09, 20.96it/s][6/6] extract embeddings:  18%|█▊        | 43/233 [00:03<00:08, 21.65it/s][6/6] extract embeddings:  20%|█▉        | 46/233 [00:03<00:08, 21.26it/s][6/6] extract embeddings:  21%|██        | 49/233 [00:03<00:08, 20.53it/s][6/6] extract embeddings:  22%|██▏       | 52/233 [00:03<00:08, 20.36it/s][6/6] extract embeddings:  24%|██▎       | 55/233 [00:03<00:08, 20.04it/s][6/6] extract embeddings:  25%|██▍       | 58/233 [00:03<00:08, 19.91it/s][6/6] extract embeddings:  26%|██▌       | 61/233 [00:03<00:08, 20.26it/s][6/6] extract embeddings:  27%|██▋       | 64/233 [00:04<00:08, 19.94it/s][6/6] extract embeddings:  29%|██▉       | 67/233 [00:04<00:07, 21.03it/s][6/6] extract embeddings:  30%|███       | 70/233 [00:04<00:07, 20.52it/s][6/6] extract embeddings:  32%|███▏      | 74/233 [00:04<00:06, 23.26it/s][6/6] extract embeddings:  33%|███▎      | 77/233 [00:04<00:06, 24.64it/s][6/6] extract embeddings:  35%|███▍      | 81/233 [00:04<00:05, 27.02it/s][6/6] extract embeddings:  36%|███▋      | 85/233 [00:04<00:05, 28.73it/s][6/6] extract embeddings:  38%|███▊      | 88/233 [00:04<00:05, 28.90it/s][6/6] extract embeddings:  39%|███▉      | 92/233 [00:05<00:04, 29.51it/s][6/6] extract embeddings:  41%|████      | 96/233 [00:05<00:04, 30.12it/s][6/6] extract embeddings:  43%|████▎     | 100/233 [00:05<00:04, 30.58it/s][6/6] extract embeddings:  45%|████▍     | 104/233 [00:05<00:04, 30.63it/s][6/6] extract embeddings:  46%|████▋     | 108/233 [00:05<00:04, 30.83it/s][6/6] extract embeddings:  48%|████▊     | 112/233 [00:05<00:03, 31.15it/s][6/6] extract embeddings:  50%|████▉     | 116/233 [00:05<00:03, 30.36it/s][6/6] extract embeddings:  52%|█████▏    | 120/233 [00:06<00:03, 31.06it/s][6/6] extract embeddings:  53%|█████▎    | 124/233 [00:06<00:03, 31.60it/s][6/6] extract embeddings:  55%|█████▍    | 128/233 [00:06<00:03, 31.93it/s][6/6] extract embeddings:  57%|█████▋    | 132/233 [00:06<00:03, 32.32it/s][6/6] extract embeddings:  58%|█████▊    | 136/233 [00:06<00:02, 32.78it/s][6/6] extract embeddings:  60%|██████    | 140/233 [00:06<00:02, 32.28it/s][6/6] extract embeddings:  62%|██████▏   | 144/233 [00:06<00:02, 32.60it/s][6/6] extract embeddings:  64%|██████▎   | 148/233 [00:06<00:02, 32.52it/s][6/6] extract embeddings:  65%|██████▌   | 152/233 [00:06<00:02, 32.91it/s][6/6] extract embeddings:  67%|██████▋   | 156/233 [00:07<00:02, 31.98it/s][6/6] extract embeddings:  69%|██████▊   | 160/233 [00:07<00:02, 31.40it/s][6/6] extract embeddings:  70%|███████   | 164/233 [00:07<00:02, 31.84it/s][6/6] extract embeddings:  72%|███████▏  | 168/233 [00:07<00:01, 32.56it/s][6/6] extract embeddings:  74%|███████▍  | 172/233 [00:07<00:01, 33.12it/s][6/6] extract embeddings:  76%|███████▌  | 176/233 [00:07<00:01, 32.96it/s][6/6] extract embeddings:  77%|███████▋  | 180/233 [00:07<00:01, 32.52it/s][6/6] extract embeddings:  79%|███████▉  | 184/233 [00:07<00:01, 31.99it/s][6/6] extract embeddings:  81%|████████  | 188/233 [00:08<00:01, 31.39it/s][6/6] extract embeddings:  82%|████████▏ | 192/233 [00:08<00:01, 30.91it/s][6/6] extract embeddings:  84%|████████▍ | 196/233 [00:08<00:01, 31.35it/s][6/6] extract embeddings:  86%|████████▌ | 200/233 [00:08<00:01, 31.88it/s][6/6] extract embeddings:  88%|████████▊ | 204/233 [00:08<00:00, 32.16it/s][6/6] extract embeddings:  89%|████████▉ | 208/233 [00:08<00:00, 32.16it/s][6/6] extract embeddings:  91%|█████████ | 212/233 [00:08<00:00, 31.53it/s][6/6] extract embeddings:  93%|█████████▎| 216/233 [00:09<00:00, 31.81it/s][6/6] extract embeddings:  94%|█████████▍| 220/233 [00:09<00:00, 32.05it/s][6/6] extract embeddings:  96%|█████████▌| 224/233 [00:09<00:00, 32.33it/s][6/6] extract embeddings:  98%|█████████▊| 228/233 [00:09<00:00, 32.60it/s][6/6] extract embeddings: 100%|█████████▉| 232/233 [00:09<00:00, 31.90it/s][6/6] extract embeddings: 100%|██████████| 233/233 [00:09<00:00, 24.36it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.81it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.01it/s]clustering:  75%|███████▌  | 3/4 [00:02<00:00,  1.55it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.03it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.71it/s]
[NeMo I 2025-04-17 00:53:06 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:53:07 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              34.706840   444.120  ...   18.929975  4.262356
    Harker-ES                       27.053158  2178.782  ...   79.859000  3.665305
    Harker-MN                       39.318398   366.767  ...   30.377927  8.282623
    Longfellow-Block-1              19.184932   492.417  ...   13.263047  2.693458
    TOTAL                           28.208555  3482.086  ...  142.429949  4.090363
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:53:07 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0997 | MISS: 0.1415 | CER: 0.0409 | DER: 0.2821 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.55, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.55, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.92s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.98s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.27s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.19s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:53:20 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:53:20 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:53:20 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:53:20 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:53:20 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:53:21 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:53:21 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:53:21 features:305] PADDING: 16
[NeMo I 2025-04-17 00:53:21 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:53:21 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:53:21 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:53:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:53:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:53:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:53:21 collections:880] Dataset successfully loaded with 2417 items and total duration provided from manifest is  1.70 hours.
[NeMo I 2025-04-17 00:53:21 collections:886] # 2417 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/38 [00:01<01:13,  2.00s/it][1/6] extract embeddings:  11%|█         | 4/38 [00:02<00:13,  2.43it/s][1/6] extract embeddings:  16%|█▌        | 6/38 [00:02<00:08,  3.80it/s][1/6] extract embeddings:  21%|██        | 8/38 [00:02<00:05,  5.37it/s][1/6] extract embeddings:  26%|██▋       | 10/38 [00:02<00:04,  6.89it/s][1/6] extract embeddings:  32%|███▏      | 12/38 [00:02<00:03,  8.37it/s][1/6] extract embeddings:  37%|███▋      | 14/38 [00:02<00:02,  9.56it/s][1/6] extract embeddings:  42%|████▏     | 16/38 [00:02<00:02, 10.76it/s][1/6] extract embeddings:  47%|████▋     | 18/38 [00:03<00:01, 11.63it/s][1/6] extract embeddings:  53%|█████▎    | 20/38 [00:03<00:01, 12.70it/s][1/6] extract embeddings:  58%|█████▊    | 22/38 [00:03<00:01, 13.01it/s][1/6] extract embeddings:  63%|██████▎   | 24/38 [00:03<00:01, 13.57it/s][1/6] extract embeddings:  68%|██████▊   | 26/38 [00:03<00:00, 14.13it/s][1/6] extract embeddings:  74%|███████▎  | 28/38 [00:03<00:00, 13.83it/s][1/6] extract embeddings:  79%|███████▉  | 30/38 [00:03<00:00, 14.16it/s][1/6] extract embeddings:  84%|████████▍ | 32/38 [00:04<00:00, 14.11it/s][1/6] extract embeddings:  89%|████████▉ | 34/38 [00:04<00:00, 14.43it/s][1/6] extract embeddings:  95%|█████████▍| 36/38 [00:04<00:00, 14.12it/s][1/6] extract embeddings: 100%|██████████| 38/38 [00:04<00:00, 14.55it/s][1/6] extract embeddings: 100%|██████████| 38/38 [00:04<00:00,  8.48it/s]
[NeMo I 2025-04-17 00:53:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:53:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:53:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:53:26 collections:880] Dataset successfully loaded with 2863 items and total duration provided from manifest is  1.75 hours.
[NeMo I 2025-04-17 00:53:26 collections:886] # 2863 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/45 [00:01<01:03,  1.45s/it][2/6] extract embeddings:   7%|▋         | 3/45 [00:01<00:17,  2.36it/s][2/6] extract embeddings:  11%|█         | 5/45 [00:01<00:09,  4.12it/s][2/6] extract embeddings:  16%|█▌        | 7/45 [00:01<00:06,  5.94it/s][2/6] extract embeddings:  20%|██        | 9/45 [00:01<00:04,  7.74it/s][2/6] extract embeddings:  24%|██▍       | 11/45 [00:02<00:03,  9.43it/s][2/6] extract embeddings:  29%|██▉       | 13/45 [00:02<00:03, 10.57it/s][2/6] extract embeddings:  33%|███▎      | 15/45 [00:02<00:02, 11.83it/s][2/6] extract embeddings:  38%|███▊      | 17/45 [00:02<00:02, 12.62it/s][2/6] extract embeddings:  42%|████▏     | 19/45 [00:02<00:01, 13.52it/s][2/6] extract embeddings:  47%|████▋     | 21/45 [00:02<00:01, 14.02it/s][2/6] extract embeddings:  51%|█████     | 23/45 [00:02<00:01, 14.31it/s][2/6] extract embeddings:  56%|█████▌    | 25/45 [00:03<00:01, 14.18it/s][2/6] extract embeddings:  60%|██████    | 27/45 [00:03<00:01, 13.95it/s][2/6] extract embeddings:  64%|██████▍   | 29/45 [00:03<00:01, 13.84it/s][2/6] extract embeddings:  69%|██████▉   | 31/45 [00:03<00:00, 14.09it/s][2/6] extract embeddings:  73%|███████▎  | 33/45 [00:03<00:00, 14.48it/s][2/6] extract embeddings:  78%|███████▊  | 35/45 [00:03<00:00, 14.84it/s][2/6] extract embeddings:  82%|████████▏ | 37/45 [00:03<00:00, 14.54it/s][2/6] extract embeddings:  87%|████████▋ | 39/45 [00:04<00:00, 14.14it/s][2/6] extract embeddings:  91%|█████████ | 41/45 [00:04<00:00, 14.65it/s][2/6] extract embeddings:  96%|█████████▌| 43/45 [00:04<00:00, 13.92it/s][2/6] extract embeddings: 100%|██████████| 45/45 [00:04<00:00, 15.32it/s][2/6] extract embeddings: 100%|██████████| 45/45 [00:04<00:00, 10.13it/s]
[NeMo I 2025-04-17 00:53:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:53:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:53:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:53:31 collections:880] Dataset successfully loaded with 3566 items and total duration provided from manifest is  1.80 hours.
[NeMo I 2025-04-17 00:53:31 collections:886] # 3566 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/56 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/56 [00:01<01:15,  1.37s/it][3/6] extract embeddings:   5%|▌         | 3/56 [00:01<00:20,  2.54it/s][3/6] extract embeddings:   9%|▉         | 5/56 [00:01<00:11,  4.52it/s][3/6] extract embeddings:  12%|█▎        | 7/56 [00:01<00:07,  6.47it/s][3/6] extract embeddings:  16%|█▌        | 9/56 [00:01<00:05,  8.29it/s][3/6] extract embeddings:  20%|█▉        | 11/56 [00:01<00:04, 10.07it/s][3/6] extract embeddings:  23%|██▎       | 13/56 [00:02<00:03, 11.64it/s][3/6] extract embeddings:  27%|██▋       | 15/56 [00:02<00:03, 12.89it/s][3/6] extract embeddings:  30%|███       | 17/56 [00:02<00:02, 13.86it/s][3/6] extract embeddings:  34%|███▍      | 19/56 [00:02<00:02, 14.78it/s][3/6] extract embeddings:  38%|███▊      | 21/56 [00:02<00:02, 14.94it/s][3/6] extract embeddings:  41%|████      | 23/56 [00:02<00:02, 14.78it/s][3/6] extract embeddings:  45%|████▍     | 25/56 [00:02<00:02, 14.77it/s][3/6] extract embeddings:  48%|████▊     | 27/56 [00:02<00:01, 14.63it/s][3/6] extract embeddings:  52%|█████▏    | 29/56 [00:03<00:01, 14.35it/s][3/6] extract embeddings:  55%|█████▌    | 31/56 [00:03<00:01, 14.93it/s][3/6] extract embeddings:  59%|█████▉    | 33/56 [00:03<00:01, 15.22it/s][3/6] extract embeddings:  62%|██████▎   | 35/56 [00:03<00:01, 15.20it/s][3/6] extract embeddings:  66%|██████▌   | 37/56 [00:03<00:01, 15.18it/s][3/6] extract embeddings:  70%|██████▉   | 39/56 [00:03<00:01, 14.86it/s][3/6] extract embeddings:  73%|███████▎  | 41/56 [00:03<00:01, 14.98it/s][3/6] extract embeddings:  77%|███████▋  | 43/56 [00:04<00:00, 14.64it/s][3/6] extract embeddings:  80%|████████  | 45/56 [00:04<00:00, 14.77it/s][3/6] extract embeddings:  84%|████████▍ | 47/56 [00:04<00:00, 14.22it/s][3/6] extract embeddings:  88%|████████▊ | 49/56 [00:04<00:00, 14.05it/s][3/6] extract embeddings:  91%|█████████ | 51/56 [00:04<00:00, 14.36it/s][3/6] extract embeddings:  95%|█████████▍| 53/56 [00:04<00:00, 14.59it/s][3/6] extract embeddings:  98%|█████████▊| 55/56 [00:04<00:00, 14.69it/s][3/6] extract embeddings: 100%|██████████| 56/56 [00:04<00:00, 11.33it/s]
[NeMo I 2025-04-17 00:53:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:53:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:53:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:53:36 collections:880] Dataset successfully loaded with 4764 items and total duration provided from manifest is  1.86 hours.
[NeMo I 2025-04-17 00:53:36 collections:886] # 4764 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/75 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/75 [00:01<01:45,  1.43s/it][4/6] extract embeddings:   4%|▍         | 3/75 [00:01<00:29,  2.42it/s][4/6] extract embeddings:   7%|▋         | 5/75 [00:01<00:16,  4.29it/s][4/6] extract embeddings:   9%|▉         | 7/75 [00:01<00:10,  6.26it/s][4/6] extract embeddings:  12%|█▏        | 9/75 [00:01<00:08,  8.23it/s][4/6] extract embeddings:  15%|█▍        | 11/75 [00:02<00:06, 10.29it/s][4/6] extract embeddings:  17%|█▋        | 13/75 [00:02<00:05, 11.61it/s][4/6] extract embeddings:  20%|██        | 15/75 [00:02<00:04, 12.59it/s][4/6] extract embeddings:  23%|██▎       | 17/75 [00:02<00:04, 13.32it/s][4/6] extract embeddings:  25%|██▌       | 19/75 [00:02<00:04, 13.95it/s][4/6] extract embeddings:  28%|██▊       | 21/75 [00:02<00:03, 14.68it/s][4/6] extract embeddings:  32%|███▏      | 24/75 [00:02<00:03, 16.94it/s][4/6] extract embeddings:  35%|███▍      | 26/75 [00:02<00:02, 17.11it/s][4/6] extract embeddings:  39%|███▊      | 29/75 [00:03<00:02, 18.51it/s][4/6] extract embeddings:  43%|████▎     | 32/75 [00:03<00:02, 19.42it/s][4/6] extract embeddings:  45%|████▌     | 34/75 [00:03<00:02, 18.91it/s][4/6] extract embeddings:  49%|████▉     | 37/75 [00:03<00:01, 19.93it/s][4/6] extract embeddings:  52%|█████▏    | 39/75 [00:03<00:01, 19.89it/s][4/6] extract embeddings:  56%|█████▌    | 42/75 [00:03<00:01, 20.77it/s][4/6] extract embeddings:  60%|██████    | 45/75 [00:03<00:01, 20.50it/s][4/6] extract embeddings:  64%|██████▍   | 48/75 [00:03<00:01, 19.46it/s][4/6] extract embeddings:  68%|██████▊   | 51/75 [00:04<00:01, 20.02it/s][4/6] extract embeddings:  72%|███████▏  | 54/75 [00:04<00:01, 20.10it/s][4/6] extract embeddings:  76%|███████▌  | 57/75 [00:04<00:00, 18.61it/s][4/6] extract embeddings:  79%|███████▊  | 59/75 [00:04<00:00, 17.63it/s][4/6] extract embeddings:  81%|████████▏ | 61/75 [00:04<00:00, 17.31it/s][4/6] extract embeddings:  84%|████████▍ | 63/75 [00:04<00:00, 16.70it/s][4/6] extract embeddings:  87%|████████▋ | 65/75 [00:04<00:00, 17.26it/s][4/6] extract embeddings:  91%|█████████ | 68/75 [00:05<00:00, 18.70it/s][4/6] extract embeddings:  93%|█████████▎| 70/75 [00:05<00:00, 18.63it/s][4/6] extract embeddings:  96%|█████████▌| 72/75 [00:05<00:00, 18.76it/s][4/6] extract embeddings: 100%|██████████| 75/75 [00:05<00:00, 20.46it/s][4/6] extract embeddings: 100%|██████████| 75/75 [00:05<00:00, 13.75it/s]
[NeMo I 2025-04-17 00:53:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:53:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:53:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:53:41 collections:880] Dataset successfully loaded with 7206 items and total duration provided from manifest is  1.93 hours.
[NeMo I 2025-04-17 00:53:41 collections:886] # 7206 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/113 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/113 [00:01<02:26,  1.31s/it][5/6] extract embeddings:   4%|▎         | 4/113 [00:01<00:32,  3.40it/s][5/6] extract embeddings:   5%|▌         | 6/113 [00:01<00:20,  5.24it/s][5/6] extract embeddings:   7%|▋         | 8/113 [00:01<00:14,  7.22it/s][5/6] extract embeddings:   9%|▉         | 10/113 [00:01<00:11,  9.15it/s][5/6] extract embeddings:  11%|█         | 12/113 [00:01<00:09, 11.03it/s][5/6] extract embeddings:  12%|█▏        | 14/113 [00:02<00:08, 12.19it/s][5/6] extract embeddings:  15%|█▌        | 17/113 [00:02<00:06, 15.01it/s][5/6] extract embeddings:  18%|█▊        | 20/113 [00:02<00:05, 17.81it/s][5/6] extract embeddings:  20%|██        | 23/113 [00:02<00:04, 19.90it/s][5/6] extract embeddings:  23%|██▎       | 26/113 [00:02<00:04, 21.37it/s][5/6] extract embeddings:  26%|██▌       | 29/113 [00:02<00:03, 22.15it/s][5/6] extract embeddings:  28%|██▊       | 32/113 [00:02<00:03, 21.69it/s][5/6] extract embeddings:  31%|███       | 35/113 [00:02<00:03, 23.12it/s][5/6] extract embeddings:  34%|███▎      | 38/113 [00:03<00:03, 23.52it/s][5/6] extract embeddings:  36%|███▋      | 41/113 [00:03<00:03, 23.81it/s][5/6] extract embeddings:  39%|███▉      | 44/113 [00:03<00:02, 24.69it/s][5/6] extract embeddings:  42%|████▏     | 47/113 [00:03<00:02, 24.30it/s][5/6] extract embeddings:  44%|████▍     | 50/113 [00:03<00:02, 25.07it/s][5/6] extract embeddings:  47%|████▋     | 53/113 [00:03<00:02, 25.05it/s][5/6] extract embeddings:  50%|████▉     | 56/113 [00:03<00:02, 24.54it/s][5/6] extract embeddings:  52%|█████▏    | 59/113 [00:03<00:02, 24.76it/s][5/6] extract embeddings:  55%|█████▍    | 62/113 [00:03<00:01, 25.66it/s][5/6] extract embeddings:  58%|█████▊    | 65/113 [00:04<00:01, 24.28it/s][5/6] extract embeddings:  60%|██████    | 68/113 [00:04<00:01, 23.79it/s][5/6] extract embeddings:  63%|██████▎   | 71/113 [00:04<00:01, 23.59it/s][5/6] extract embeddings:  65%|██████▌   | 74/113 [00:04<00:01, 24.70it/s][5/6] extract embeddings:  68%|██████▊   | 77/113 [00:04<00:01, 22.68it/s][5/6] extract embeddings:  71%|███████   | 80/113 [00:04<00:01, 21.04it/s][5/6] extract embeddings:  73%|███████▎  | 83/113 [00:04<00:01, 19.76it/s][5/6] extract embeddings:  76%|███████▌  | 86/113 [00:05<00:01, 20.70it/s][5/6] extract embeddings:  79%|███████▉  | 89/113 [00:05<00:01, 20.22it/s][5/6] extract embeddings:  81%|████████▏ | 92/113 [00:05<00:01, 18.91it/s][5/6] extract embeddings:  83%|████████▎ | 94/113 [00:05<00:01, 18.51it/s][5/6] extract embeddings:  86%|████████▌ | 97/113 [00:05<00:00, 18.76it/s][5/6] extract embeddings:  88%|████████▊ | 99/113 [00:05<00:00, 18.85it/s][5/6] extract embeddings:  90%|█████████ | 102/113 [00:05<00:00, 21.21it/s][5/6] extract embeddings:  93%|█████████▎| 105/113 [00:06<00:00, 21.39it/s][5/6] extract embeddings:  96%|█████████▌| 108/113 [00:06<00:00, 22.55it/s][5/6] extract embeddings:  98%|█████████▊| 111/113 [00:06<00:00, 23.35it/s][5/6] extract embeddings: 100%|██████████| 113/113 [00:06<00:00, 17.58it/s]
[NeMo I 2025-04-17 00:53:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:53:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:53:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:53:48 collections:880] Dataset successfully loaded with 14635 items and total duration provided from manifest is  2.00 hours.
[NeMo I 2025-04-17 00:53:48 collections:886] # 14635 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/229 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/229 [00:01<04:41,  1.24s/it][6/6] extract embeddings:   2%|▏         | 5/229 [00:01<00:46,  4.77it/s][6/6] extract embeddings:   4%|▍         | 9/229 [00:01<00:24,  8.85it/s][6/6] extract embeddings:   6%|▌         | 13/229 [00:01<00:16, 12.89it/s][6/6] extract embeddings:   7%|▋         | 16/229 [00:01<00:14, 15.10it/s][6/6] extract embeddings:   8%|▊         | 19/229 [00:01<00:11, 17.56it/s][6/6] extract embeddings:  10%|▉         | 22/229 [00:01<00:10, 19.58it/s][6/6] extract embeddings:  11%|█         | 25/229 [00:02<00:09, 21.07it/s][6/6] extract embeddings:  12%|█▏        | 28/229 [00:02<00:08, 22.63it/s][6/6] extract embeddings:  14%|█▎        | 31/229 [00:02<00:08, 22.29it/s][6/6] extract embeddings:  15%|█▍        | 34/229 [00:02<00:08, 23.84it/s][6/6] extract embeddings:  16%|█▌        | 37/229 [00:02<00:07, 24.89it/s][6/6] extract embeddings:  18%|█▊        | 41/229 [00:02<00:06, 27.85it/s][6/6] extract embeddings:  20%|█▉        | 45/229 [00:02<00:06, 28.69it/s][6/6] extract embeddings:  21%|██        | 48/229 [00:02<00:06, 28.33it/s][6/6] extract embeddings:  22%|██▏       | 51/229 [00:03<00:06, 26.48it/s][6/6] extract embeddings:  24%|██▎       | 54/229 [00:03<00:07, 24.88it/s][6/6] extract embeddings:  25%|██▍       | 57/229 [00:03<00:06, 26.04it/s][6/6] extract embeddings:  27%|██▋       | 61/229 [00:03<00:05, 28.18it/s][6/6] extract embeddings:  28%|██▊       | 65/229 [00:03<00:05, 29.18it/s][6/6] extract embeddings:  30%|███       | 69/229 [00:03<00:05, 29.95it/s][6/6] extract embeddings:  32%|███▏      | 73/229 [00:03<00:05, 29.95it/s][6/6] extract embeddings:  34%|███▎      | 77/229 [00:03<00:05, 29.59it/s][6/6] extract embeddings:  35%|███▍      | 80/229 [00:04<00:05, 28.06it/s][6/6] extract embeddings:  36%|███▌      | 83/229 [00:04<00:05, 28.09it/s][6/6] extract embeddings:  38%|███▊      | 86/229 [00:04<00:05, 28.28it/s][6/6] extract embeddings:  39%|███▉      | 90/229 [00:04<00:04, 28.42it/s][6/6] extract embeddings:  41%|████      | 93/229 [00:04<00:04, 27.88it/s][6/6] extract embeddings:  42%|████▏     | 96/229 [00:04<00:05, 26.15it/s][6/6] extract embeddings:  43%|████▎     | 99/229 [00:04<00:05, 25.02it/s][6/6] extract embeddings:  45%|████▍     | 102/229 [00:04<00:05, 22.65it/s][6/6] extract embeddings:  46%|████▌     | 105/229 [00:05<00:05, 22.42it/s][6/6] extract embeddings:  47%|████▋     | 108/229 [00:05<00:05, 22.21it/s][6/6] extract embeddings:  48%|████▊     | 111/229 [00:05<00:05, 23.10it/s][6/6] extract embeddings:  50%|████▉     | 114/229 [00:05<00:05, 22.21it/s][6/6] extract embeddings:  51%|█████     | 117/229 [00:05<00:04, 23.65it/s][6/6] extract embeddings:  52%|█████▏    | 120/229 [00:05<00:04, 23.17it/s][6/6] extract embeddings:  54%|█████▎    | 123/229 [00:05<00:04, 22.96it/s][6/6] extract embeddings:  55%|█████▌    | 126/229 [00:05<00:04, 22.61it/s][6/6] extract embeddings:  56%|█████▋    | 129/229 [00:06<00:04, 22.90it/s][6/6] extract embeddings:  58%|█████▊    | 132/229 [00:06<00:04, 21.85it/s][6/6] extract embeddings:  59%|█████▉    | 135/229 [00:06<00:04, 22.64it/s][6/6] extract embeddings:  60%|██████    | 138/229 [00:06<00:03, 23.03it/s][6/6] extract embeddings:  62%|██████▏   | 141/229 [00:06<00:03, 23.14it/s][6/6] extract embeddings:  63%|██████▎   | 145/229 [00:06<00:03, 24.65it/s][6/6] extract embeddings:  65%|██████▍   | 148/229 [00:06<00:03, 25.00it/s][6/6] extract embeddings:  66%|██████▌   | 151/229 [00:07<00:03, 23.17it/s][6/6] extract embeddings:  67%|██████▋   | 154/229 [00:07<00:03, 22.87it/s][6/6] extract embeddings:  69%|██████▊   | 157/229 [00:07<00:03, 22.42it/s][6/6] extract embeddings:  70%|██████▉   | 160/229 [00:07<00:02, 23.87it/s][6/6] extract embeddings:  71%|███████   | 163/229 [00:07<00:02, 24.07it/s][6/6] extract embeddings:  72%|███████▏  | 166/229 [00:07<00:02, 24.51it/s][6/6] extract embeddings:  74%|███████▍  | 169/229 [00:07<00:02, 25.89it/s][6/6] extract embeddings:  75%|███████▌  | 172/229 [00:07<00:02, 25.74it/s][6/6] extract embeddings:  77%|███████▋  | 176/229 [00:08<00:01, 27.52it/s][6/6] extract embeddings:  78%|███████▊  | 179/229 [00:08<00:01, 26.24it/s][6/6] extract embeddings:  79%|███████▉  | 182/229 [00:08<00:01, 25.35it/s][6/6] extract embeddings:  81%|████████  | 185/229 [00:08<00:01, 24.73it/s][6/6] extract embeddings:  82%|████████▏ | 188/229 [00:08<00:01, 24.79it/s][6/6] extract embeddings:  83%|████████▎ | 191/229 [00:08<00:01, 24.71it/s][6/6] extract embeddings:  85%|████████▍ | 194/229 [00:08<00:01, 24.31it/s][6/6] extract embeddings:  86%|████████▋ | 198/229 [00:08<00:01, 26.48it/s][6/6] extract embeddings:  88%|████████▊ | 201/229 [00:09<00:01, 26.50it/s][6/6] extract embeddings:  89%|████████▉ | 204/229 [00:09<00:00, 25.96it/s][6/6] extract embeddings:  90%|█████████ | 207/229 [00:09<00:00, 25.57it/s][6/6] extract embeddings:  92%|█████████▏| 211/229 [00:09<00:00, 27.30it/s][6/6] extract embeddings:  93%|█████████▎| 214/229 [00:09<00:00, 27.67it/s][6/6] extract embeddings:  95%|█████████▌| 218/229 [00:09<00:00, 29.00it/s][6/6] extract embeddings:  97%|█████████▋| 222/229 [00:09<00:00, 29.68it/s][6/6] extract embeddings:  99%|█████████▊| 226/229 [00:09<00:00, 29.69it/s][6/6] extract embeddings: 100%|██████████| 229/229 [00:09<00:00, 29.17it/s][6/6] extract embeddings: 100%|██████████| 229/229 [00:10<00:00, 22.83it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.75it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.02it/s]clustering:  75%|███████▌  | 3/4 [00:02<00:00,  1.56it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.33it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.33it/s]
[NeMo I 2025-04-17 00:54:02 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:54:03 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              34.807031   444.120  ...   15.594953  3.511428
    Harker-ES                       27.316055  2178.782  ...   73.087249  3.354500
    Harker-MN                       40.554093   366.767  ...   30.052116  8.193790
    Longfellow-Block-1              20.246857   492.417  ...   14.247062  2.893292
    TOTAL                           28.666158  3482.086  ...  132.981380  3.819015
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:54:03 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0969 | MISS: 0.1515 | CER: 0.0382 | DER: 0.2867 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.88s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.99s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.28s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.06it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.20s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:54:16 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:54:16 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:54:16 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:54:16 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:54:16 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:54:16 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:54:16 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:54:16 features:305] PADDING: 16
[NeMo I 2025-04-17 00:54:17 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:54:17 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:54:17 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:54:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:54:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:54:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:54:17 collections:880] Dataset successfully loaded with 2392 items and total duration provided from manifest is  1.65 hours.
[NeMo I 2025-04-17 00:54:17 collections:886] # 2392 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/38 [00:02<01:15,  2.04s/it][1/6] extract embeddings:  11%|█         | 4/38 [00:02<00:14,  2.39it/s][1/6] extract embeddings:  16%|█▌        | 6/38 [00:02<00:08,  3.75it/s][1/6] extract embeddings:  21%|██        | 8/38 [00:02<00:05,  5.18it/s][1/6] extract embeddings:  26%|██▋       | 10/38 [00:02<00:04,  6.59it/s][1/6] extract embeddings:  32%|███▏      | 12/38 [00:02<00:03,  7.94it/s][1/6] extract embeddings:  37%|███▋      | 14/38 [00:02<00:02,  9.13it/s][1/6] extract embeddings:  42%|████▏     | 16/38 [00:03<00:02, 10.45it/s][1/6] extract embeddings:  47%|████▋     | 18/38 [00:03<00:01, 11.09it/s][1/6] extract embeddings:  53%|█████▎    | 20/38 [00:03<00:01, 11.90it/s][1/6] extract embeddings:  58%|█████▊    | 22/38 [00:03<00:01, 12.24it/s][1/6] extract embeddings:  63%|██████▎   | 24/38 [00:03<00:01, 12.29it/s][1/6] extract embeddings:  68%|██████▊   | 26/38 [00:03<00:00, 13.01it/s][1/6] extract embeddings:  74%|███████▎  | 28/38 [00:03<00:00, 13.01it/s][1/6] extract embeddings:  79%|███████▉  | 30/38 [00:04<00:00, 12.59it/s][1/6] extract embeddings:  84%|████████▍ | 32/38 [00:04<00:00, 12.38it/s][1/6] extract embeddings:  89%|████████▉ | 34/38 [00:04<00:00, 12.79it/s][1/6] extract embeddings:  95%|█████████▍| 36/38 [00:04<00:00, 12.92it/s][1/6] extract embeddings: 100%|██████████| 38/38 [00:04<00:00,  8.12it/s]
[NeMo I 2025-04-17 00:54:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:54:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:54:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:54:21 collections:880] Dataset successfully loaded with 2824 items and total duration provided from manifest is  1.70 hours.
[NeMo I 2025-04-17 00:54:21 collections:886] # 2824 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/45 [00:01<01:04,  1.46s/it][2/6] extract embeddings:   7%|▋         | 3/45 [00:01<00:17,  2.37it/s][2/6] extract embeddings:  11%|█         | 5/45 [00:01<00:09,  4.15it/s][2/6] extract embeddings:  16%|█▌        | 7/45 [00:01<00:06,  5.93it/s][2/6] extract embeddings:  20%|██        | 9/45 [00:02<00:04,  7.56it/s][2/6] extract embeddings:  24%|██▍       | 11/45 [00:02<00:03,  9.16it/s][2/6] extract embeddings:  29%|██▉       | 13/45 [00:02<00:03, 10.62it/s][2/6] extract embeddings:  33%|███▎      | 15/45 [00:02<00:02, 11.56it/s][2/6] extract embeddings:  38%|███▊      | 17/45 [00:02<00:02, 12.76it/s][2/6] extract embeddings:  42%|████▏     | 19/45 [00:02<00:01, 13.93it/s][2/6] extract embeddings:  47%|████▋     | 21/45 [00:02<00:01, 14.10it/s][2/6] extract embeddings:  51%|█████     | 23/45 [00:02<00:01, 14.07it/s][2/6] extract embeddings:  56%|█████▌    | 25/45 [00:03<00:01, 14.73it/s][2/6] extract embeddings:  60%|██████    | 27/45 [00:03<00:01, 14.93it/s][2/6] extract embeddings:  64%|██████▍   | 29/45 [00:03<00:01, 14.61it/s][2/6] extract embeddings:  69%|██████▉   | 31/45 [00:03<00:00, 15.23it/s][2/6] extract embeddings:  73%|███████▎  | 33/45 [00:03<00:00, 14.57it/s][2/6] extract embeddings:  78%|███████▊  | 35/45 [00:03<00:00, 14.71it/s][2/6] extract embeddings:  82%|████████▏ | 37/45 [00:03<00:00, 14.33it/s][2/6] extract embeddings:  87%|████████▋ | 39/45 [00:04<00:00, 14.39it/s][2/6] extract embeddings:  91%|█████████ | 41/45 [00:04<00:00, 14.75it/s][2/6] extract embeddings:  96%|█████████▌| 43/45 [00:04<00:00, 14.77it/s][2/6] extract embeddings: 100%|██████████| 45/45 [00:04<00:00, 10.26it/s]
[NeMo I 2025-04-17 00:54:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:54:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:54:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:54:26 collections:880] Dataset successfully loaded with 3509 items and total duration provided from manifest is  1.75 hours.
[NeMo I 2025-04-17 00:54:26 collections:886] # 3509 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/55 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/55 [00:01<01:03,  1.17s/it][3/6] extract embeddings:   5%|▌         | 3/55 [00:01<00:17,  2.90it/s][3/6] extract embeddings:   9%|▉         | 5/55 [00:01<00:10,  4.97it/s][3/6] extract embeddings:  13%|█▎        | 7/55 [00:01<00:06,  7.22it/s][3/6] extract embeddings:  16%|█▋        | 9/55 [00:01<00:05,  9.11it/s][3/6] extract embeddings:  20%|██        | 11/55 [00:01<00:03, 11.03it/s][3/6] extract embeddings:  24%|██▎       | 13/55 [00:01<00:03, 12.18it/s][3/6] extract embeddings:  27%|██▋       | 15/55 [00:02<00:03, 13.07it/s][3/6] extract embeddings:  31%|███       | 17/55 [00:02<00:02, 14.27it/s][3/6] extract embeddings:  35%|███▍      | 19/55 [00:02<00:02, 15.01it/s][3/6] extract embeddings:  38%|███▊      | 21/55 [00:02<00:02, 15.21it/s][3/6] extract embeddings:  42%|████▏     | 23/55 [00:02<00:02, 15.59it/s][3/6] extract embeddings:  45%|████▌     | 25/55 [00:02<00:01, 16.21it/s][3/6] extract embeddings:  49%|████▉     | 27/55 [00:02<00:01, 15.72it/s][3/6] extract embeddings:  53%|█████▎    | 29/55 [00:02<00:01, 16.03it/s][3/6] extract embeddings:  56%|█████▋    | 31/55 [00:02<00:01, 16.52it/s][3/6] extract embeddings:  60%|██████    | 33/55 [00:03<00:01, 17.22it/s][3/6] extract embeddings:  64%|██████▎   | 35/55 [00:03<00:01, 16.90it/s][3/6] extract embeddings:  67%|██████▋   | 37/55 [00:03<00:01, 16.15it/s][3/6] extract embeddings:  71%|███████   | 39/55 [00:03<00:01, 15.73it/s][3/6] extract embeddings:  75%|███████▍  | 41/55 [00:03<00:00, 15.42it/s][3/6] extract embeddings:  78%|███████▊  | 43/55 [00:03<00:00, 15.33it/s][3/6] extract embeddings:  82%|████████▏ | 45/55 [00:03<00:00, 15.27it/s][3/6] extract embeddings:  85%|████████▌ | 47/55 [00:04<00:00, 15.01it/s][3/6] extract embeddings:  89%|████████▉ | 49/55 [00:04<00:00, 14.88it/s][3/6] extract embeddings:  93%|█████████▎| 51/55 [00:04<00:00, 15.05it/s][3/6] extract embeddings:  96%|█████████▋| 53/55 [00:04<00:00, 14.72it/s][3/6] extract embeddings: 100%|██████████| 55/55 [00:04<00:00, 15.49it/s][3/6] extract embeddings: 100%|██████████| 55/55 [00:04<00:00, 12.06it/s]
[NeMo I 2025-04-17 00:54:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:54:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:54:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:54:31 collections:880] Dataset successfully loaded with 4686 items and total duration provided from manifest is  1.82 hours.
[NeMo I 2025-04-17 00:54:31 collections:886] # 4686 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/74 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/74 [00:01<01:35,  1.31s/it][4/6] extract embeddings:   5%|▌         | 4/74 [00:01<00:19,  3.53it/s][4/6] extract embeddings:   8%|▊         | 6/74 [00:01<00:12,  5.47it/s][4/6] extract embeddings:  12%|█▏        | 9/74 [00:01<00:07,  8.43it/s][4/6] extract embeddings:  15%|█▍        | 11/74 [00:01<00:06, 10.04it/s][4/6] extract embeddings:  18%|█▊        | 13/74 [00:01<00:05, 11.62it/s][4/6] extract embeddings:  20%|██        | 15/74 [00:02<00:04, 12.52it/s][4/6] extract embeddings:  23%|██▎       | 17/74 [00:02<00:04, 13.77it/s][4/6] extract embeddings:  26%|██▌       | 19/74 [00:02<00:03, 14.54it/s][4/6] extract embeddings:  28%|██▊       | 21/74 [00:02<00:03, 14.46it/s][4/6] extract embeddings:  31%|███       | 23/74 [00:02<00:03, 14.80it/s][4/6] extract embeddings:  34%|███▍      | 25/74 [00:02<00:03, 14.72it/s][4/6] extract embeddings:  38%|███▊      | 28/74 [00:02<00:02, 16.85it/s][4/6] extract embeddings:  42%|████▏     | 31/74 [00:02<00:02, 18.29it/s][4/6] extract embeddings:  46%|████▌     | 34/74 [00:03<00:02, 19.37it/s][4/6] extract embeddings:  49%|████▊     | 36/74 [00:03<00:02, 18.84it/s][4/6] extract embeddings:  53%|█████▎    | 39/74 [00:03<00:01, 19.09it/s][4/6] extract embeddings:  57%|█████▋    | 42/74 [00:03<00:01, 19.39it/s][4/6] extract embeddings:  59%|█████▉    | 44/74 [00:03<00:01, 19.43it/s][4/6] extract embeddings:  64%|██████▎   | 47/74 [00:03<00:01, 20.01it/s][4/6] extract embeddings:  68%|██████▊   | 50/74 [00:03<00:01, 20.62it/s][4/6] extract embeddings:  72%|███████▏  | 53/74 [00:04<00:01, 20.22it/s][4/6] extract embeddings:  76%|███████▌  | 56/74 [00:04<00:00, 18.31it/s][4/6] extract embeddings:  78%|███████▊  | 58/74 [00:04<00:00, 17.27it/s][4/6] extract embeddings:  81%|████████  | 60/74 [00:04<00:00, 16.56it/s][4/6] extract embeddings:  84%|████████▍ | 62/74 [00:04<00:00, 15.63it/s][4/6] extract embeddings:  86%|████████▋ | 64/74 [00:04<00:00, 15.71it/s][4/6] extract embeddings:  89%|████████▉ | 66/74 [00:04<00:00, 15.72it/s][4/6] extract embeddings:  92%|█████████▏| 68/74 [00:05<00:00, 15.54it/s][4/6] extract embeddings:  95%|█████████▍| 70/74 [00:05<00:00, 15.75it/s][4/6] extract embeddings:  97%|█████████▋| 72/74 [00:05<00:00, 16.31it/s][4/6] extract embeddings: 100%|██████████| 74/74 [00:05<00:00, 13.68it/s]
[NeMo I 2025-04-17 00:54:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:54:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:54:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:54:37 collections:880] Dataset successfully loaded with 7062 items and total duration provided from manifest is  1.88 hours.
[NeMo I 2025-04-17 00:54:37 collections:886] # 7062 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/111 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/111 [00:01<02:30,  1.36s/it][5/6] extract embeddings:   4%|▎         | 4/111 [00:01<00:30,  3.46it/s][5/6] extract embeddings:   6%|▋         | 7/111 [00:01<00:16,  6.49it/s][5/6] extract embeddings:   9%|▉         | 10/111 [00:01<00:10,  9.36it/s][5/6] extract embeddings:  12%|█▏        | 13/111 [00:01<00:08, 12.05it/s][5/6] extract embeddings:  14%|█▍        | 16/111 [00:01<00:06, 14.98it/s][5/6] extract embeddings:  17%|█▋        | 19/111 [00:02<00:05, 17.44it/s][5/6] extract embeddings:  20%|█▉        | 22/111 [00:02<00:04, 19.33it/s][5/6] extract embeddings:  23%|██▎       | 25/111 [00:02<00:04, 20.81it/s][5/6] extract embeddings:  25%|██▌       | 28/111 [00:02<00:03, 21.98it/s][5/6] extract embeddings:  28%|██▊       | 31/111 [00:02<00:03, 23.08it/s][5/6] extract embeddings:  31%|███       | 34/111 [00:02<00:03, 23.75it/s][5/6] extract embeddings:  33%|███▎      | 37/111 [00:02<00:03, 24.14it/s][5/6] extract embeddings:  36%|███▌      | 40/111 [00:02<00:02, 23.88it/s][5/6] extract embeddings:  39%|███▊      | 43/111 [00:03<00:02, 23.32it/s][5/6] extract embeddings:  41%|████▏     | 46/111 [00:03<00:02, 23.27it/s][5/6] extract embeddings:  44%|████▍     | 49/111 [00:03<00:02, 23.61it/s][5/6] extract embeddings:  47%|████▋     | 52/111 [00:03<00:02, 23.07it/s][5/6] extract embeddings:  50%|████▉     | 55/111 [00:03<00:02, 22.72it/s][5/6] extract embeddings:  52%|█████▏    | 58/111 [00:03<00:02, 22.08it/s][5/6] extract embeddings:  55%|█████▍    | 61/111 [00:03<00:02, 21.84it/s][5/6] extract embeddings:  58%|█████▊    | 64/111 [00:03<00:02, 22.54it/s][5/6] extract embeddings:  60%|██████    | 67/111 [00:04<00:01, 22.78it/s][5/6] extract embeddings:  63%|██████▎   | 70/111 [00:04<00:01, 23.40it/s][5/6] extract embeddings:  66%|██████▌   | 73/111 [00:04<00:01, 22.43it/s][5/6] extract embeddings:  68%|██████▊   | 76/111 [00:04<00:01, 22.20it/s][5/6] extract embeddings:  71%|███████   | 79/111 [00:04<00:01, 23.23it/s][5/6] extract embeddings:  74%|███████▍  | 82/111 [00:04<00:01, 23.77it/s][5/6] extract embeddings:  77%|███████▋  | 85/111 [00:04<00:01, 23.68it/s][5/6] extract embeddings:  79%|███████▉  | 88/111 [00:05<00:00, 24.10it/s][5/6] extract embeddings:  82%|████████▏ | 91/111 [00:05<00:00, 24.25it/s][5/6] extract embeddings:  85%|████████▍ | 94/111 [00:05<00:00, 24.78it/s][5/6] extract embeddings:  87%|████████▋ | 97/111 [00:05<00:00, 23.89it/s][5/6] extract embeddings:  90%|█████████ | 100/111 [00:05<00:00, 22.59it/s][5/6] extract embeddings:  93%|█████████▎| 103/111 [00:05<00:00, 21.73it/s][5/6] extract embeddings:  95%|█████████▌| 106/111 [00:05<00:00, 21.96it/s][5/6] extract embeddings:  98%|█████████▊| 109/111 [00:05<00:00, 22.79it/s][5/6] extract embeddings: 100%|██████████| 111/111 [00:06<00:00, 18.35it/s]
[NeMo I 2025-04-17 00:54:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:54:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:54:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:54:43 collections:880] Dataset successfully loaded with 14352 items and total duration provided from manifest is  1.96 hours.
[NeMo I 2025-04-17 00:54:43 collections:886] # 14352 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/225 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/225 [00:01<04:46,  1.28s/it][6/6] extract embeddings:   2%|▏         | 4/225 [00:01<00:59,  3.69it/s][6/6] extract embeddings:   3%|▎         | 7/225 [00:01<00:31,  6.94it/s][6/6] extract embeddings:   5%|▍         | 11/225 [00:01<00:18, 11.30it/s][6/6] extract embeddings:   6%|▌         | 14/225 [00:01<00:14, 14.08it/s][6/6] extract embeddings:   8%|▊         | 17/225 [00:01<00:12, 16.67it/s][6/6] extract embeddings:   9%|▉         | 21/225 [00:01<00:09, 20.77it/s][6/6] extract embeddings:  11%|█         | 24/225 [00:02<00:08, 22.55it/s][6/6] extract embeddings:  12%|█▏        | 27/225 [00:02<00:08, 24.28it/s][6/6] extract embeddings:  13%|█▎        | 30/225 [00:02<00:08, 23.57it/s][6/6] extract embeddings:  15%|█▍        | 33/225 [00:02<00:07, 25.03it/s][6/6] extract embeddings:  16%|█▌        | 36/225 [00:02<00:07, 25.35it/s][6/6] extract embeddings:  18%|█▊        | 40/225 [00:02<00:06, 26.56it/s][6/6] extract embeddings:  19%|█▉        | 43/225 [00:02<00:07, 25.54it/s][6/6] extract embeddings:  20%|██        | 46/225 [00:02<00:06, 26.27it/s][6/6] extract embeddings:  22%|██▏       | 49/225 [00:03<00:06, 26.12it/s][6/6] extract embeddings:  23%|██▎       | 52/225 [00:03<00:06, 26.65it/s][6/6] extract embeddings:  24%|██▍       | 55/225 [00:03<00:06, 26.45it/s][6/6] extract embeddings:  26%|██▌       | 58/225 [00:03<00:06, 26.56it/s][6/6] extract embeddings:  27%|██▋       | 61/225 [00:03<00:06, 26.35it/s][6/6] extract embeddings:  29%|██▉       | 65/225 [00:03<00:05, 27.64it/s][6/6] extract embeddings:  30%|███       | 68/225 [00:03<00:05, 28.13it/s][6/6] extract embeddings:  32%|███▏      | 72/225 [00:03<00:05, 29.26it/s][6/6] extract embeddings:  34%|███▍      | 76/225 [00:03<00:04, 29.90it/s][6/6] extract embeddings:  35%|███▌      | 79/225 [00:04<00:04, 29.73it/s][6/6] extract embeddings:  36%|███▋      | 82/225 [00:04<00:05, 26.54it/s][6/6] extract embeddings:  38%|███▊      | 85/225 [00:04<00:05, 23.84it/s][6/6] extract embeddings:  39%|███▉      | 88/225 [00:04<00:05, 24.31it/s][6/6] extract embeddings:  40%|████      | 91/225 [00:04<00:05, 23.61it/s][6/6] extract embeddings:  42%|████▏     | 94/225 [00:04<00:05, 23.35it/s][6/6] extract embeddings:  43%|████▎     | 97/225 [00:04<00:05, 24.68it/s][6/6] extract embeddings:  44%|████▍     | 100/225 [00:04<00:05, 23.63it/s][6/6] extract embeddings:  46%|████▌     | 104/225 [00:05<00:04, 26.30it/s][6/6] extract embeddings:  48%|████▊     | 108/225 [00:05<00:04, 28.34it/s][6/6] extract embeddings:  50%|████▉     | 112/225 [00:05<00:03, 28.61it/s][6/6] extract embeddings:  51%|█████     | 115/225 [00:05<00:03, 27.80it/s][6/6] extract embeddings:  52%|█████▏    | 118/225 [00:05<00:03, 28.06it/s][6/6] extract embeddings:  54%|█████▍    | 121/225 [00:05<00:03, 28.48it/s][6/6] extract embeddings:  55%|█████▌    | 124/225 [00:05<00:03, 28.42it/s][6/6] extract embeddings:  57%|█████▋    | 128/225 [00:05<00:03, 29.65it/s][6/6] extract embeddings:  58%|█████▊    | 131/225 [00:06<00:03, 29.25it/s][6/6] extract embeddings:  60%|██████    | 135/225 [00:06<00:03, 28.58it/s][6/6] extract embeddings:  61%|██████▏   | 138/225 [00:06<00:03, 26.99it/s][6/6] extract embeddings:  63%|██████▎   | 141/225 [00:06<00:03, 26.87it/s][6/6] extract embeddings:  64%|██████▍   | 144/225 [00:06<00:02, 27.58it/s][6/6] extract embeddings:  65%|██████▌   | 147/225 [00:06<00:02, 27.82it/s][6/6] extract embeddings:  67%|██████▋   | 151/225 [00:06<00:02, 28.14it/s][6/6] extract embeddings:  69%|██████▉   | 155/225 [00:06<00:02, 28.77it/s][6/6] extract embeddings:  70%|███████   | 158/225 [00:07<00:02, 27.94it/s][6/6] extract embeddings:  72%|███████▏  | 161/225 [00:07<00:02, 27.90it/s][6/6] extract embeddings:  73%|███████▎  | 165/225 [00:07<00:02, 28.63it/s][6/6] extract embeddings:  75%|███████▍  | 168/225 [00:07<00:02, 28.30it/s][6/6] extract embeddings:  76%|███████▋  | 172/225 [00:07<00:01, 30.29it/s][6/6] extract embeddings:  78%|███████▊  | 176/225 [00:07<00:01, 30.90it/s][6/6] extract embeddings:  80%|████████  | 180/225 [00:07<00:01, 30.34it/s][6/6] extract embeddings:  82%|████████▏ | 184/225 [00:07<00:01, 28.09it/s][6/6] extract embeddings:  83%|████████▎ | 187/225 [00:08<00:01, 27.19it/s][6/6] extract embeddings:  84%|████████▍ | 190/225 [00:08<00:01, 26.78it/s][6/6] extract embeddings:  86%|████████▌ | 193/225 [00:08<00:01, 27.38it/s][6/6] extract embeddings:  87%|████████▋ | 196/225 [00:08<00:01, 25.45it/s][6/6] extract embeddings:  88%|████████▊ | 199/225 [00:08<00:00, 26.50it/s][6/6] extract embeddings:  90%|████████▉ | 202/225 [00:08<00:00, 26.66it/s][6/6] extract embeddings:  91%|█████████ | 205/225 [00:08<00:00, 26.79it/s][6/6] extract embeddings:  93%|█████████▎| 209/225 [00:08<00:00, 26.94it/s][6/6] extract embeddings:  94%|█████████▍| 212/225 [00:08<00:00, 26.41it/s][6/6] extract embeddings:  96%|█████████▌| 216/225 [00:09<00:00, 27.60it/s][6/6] extract embeddings:  97%|█████████▋| 219/225 [00:09<00:00, 28.05it/s][6/6] extract embeddings:  99%|█████████▉| 223/225 [00:09<00:00, 28.42it/s][6/6] extract embeddings: 100%|██████████| 225/225 [00:09<00:00, 23.87it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.11it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.09it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.66it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.17it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.84it/s]
[NeMo I 2025-04-17 00:54:55 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:54:56 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              35.667185   444.120  ...   15.124989  3.405609
    Harker-ES                       28.727270  2178.782  ...   85.319350  3.915920
    Harker-MN                       41.028810   366.767  ...   29.488147  8.040022
    Longfellow-Block-1              21.298793   492.417  ...   13.423015  2.725945
    TOTAL                           29.857640  3482.086  ...  143.355501  4.116943
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:54:56 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0929 | MISS: 0.1645 | CER: 0.0412 | DER: 0.2986 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.88s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:04<00:04,  2.03s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.29s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.05it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.22s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:55:09 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:55:09 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:55:09 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:55:09 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:55:09 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:55:09 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:55:09 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:55:09 features:305] PADDING: 16
[NeMo I 2025-04-17 00:55:10 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:55:10 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:55:10 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:55:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:55:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:55:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:55:10 collections:880] Dataset successfully loaded with 2340 items and total duration provided from manifest is  1.58 hours.
[NeMo I 2025-04-17 00:55:10 collections:886] # 2340 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/37 [00:02<01:13,  2.04s/it][1/6] extract embeddings:  11%|█         | 4/37 [00:02<00:13,  2.41it/s][1/6] extract embeddings:  16%|█▌        | 6/37 [00:02<00:08,  3.72it/s][1/6] extract embeddings:  22%|██▏       | 8/37 [00:02<00:05,  5.22it/s][1/6] extract embeddings:  27%|██▋       | 10/37 [00:02<00:04,  6.67it/s][1/6] extract embeddings:  32%|███▏      | 12/37 [00:02<00:03,  8.04it/s][1/6] extract embeddings:  38%|███▊      | 14/37 [00:02<00:02,  9.39it/s][1/6] extract embeddings:  43%|████▎     | 16/37 [00:03<00:02, 10.48it/s][1/6] extract embeddings:  49%|████▊     | 18/37 [00:03<00:01, 11.52it/s][1/6] extract embeddings:  54%|█████▍    | 20/37 [00:03<00:01, 12.66it/s][1/6] extract embeddings:  59%|█████▉    | 22/37 [00:03<00:01, 12.71it/s][1/6] extract embeddings:  65%|██████▍   | 24/37 [00:03<00:00, 13.13it/s][1/6] extract embeddings:  70%|███████   | 26/37 [00:03<00:00, 12.91it/s][1/6] extract embeddings:  76%|███████▌  | 28/37 [00:03<00:00, 12.49it/s][1/6] extract embeddings:  81%|████████  | 30/37 [00:04<00:00, 12.20it/s][1/6] extract embeddings:  86%|████████▋ | 32/37 [00:04<00:00, 12.41it/s][1/6] extract embeddings:  92%|█████████▏| 34/37 [00:04<00:00, 12.71it/s][1/6] extract embeddings:  97%|█████████▋| 36/37 [00:04<00:00, 13.09it/s][1/6] extract embeddings: 100%|██████████| 37/37 [00:04<00:00,  8.07it/s]
[NeMo I 2025-04-17 00:55:14 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:55:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:55:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:55:15 collections:880] Dataset successfully loaded with 2754 items and total duration provided from manifest is  1.63 hours.
[NeMo I 2025-04-17 00:55:15 collections:886] # 2754 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/44 [00:01<01:01,  1.44s/it][2/6] extract embeddings:   7%|▋         | 3/44 [00:01<00:17,  2.41it/s][2/6] extract embeddings:  11%|█▏        | 5/44 [00:01<00:09,  4.21it/s][2/6] extract embeddings:  16%|█▌        | 7/44 [00:01<00:06,  6.06it/s][2/6] extract embeddings:  20%|██        | 9/44 [00:01<00:04,  7.90it/s][2/6] extract embeddings:  25%|██▌       | 11/44 [00:02<00:03,  9.41it/s][2/6] extract embeddings:  30%|██▉       | 13/44 [00:02<00:02, 11.03it/s][2/6] extract embeddings:  34%|███▍      | 15/44 [00:02<00:02, 11.93it/s][2/6] extract embeddings:  39%|███▊      | 17/44 [00:02<00:02, 12.89it/s][2/6] extract embeddings:  43%|████▎     | 19/44 [00:02<00:01, 13.78it/s][2/6] extract embeddings:  48%|████▊     | 21/44 [00:02<00:01, 14.14it/s][2/6] extract embeddings:  52%|█████▏    | 23/44 [00:02<00:01, 14.60it/s][2/6] extract embeddings:  57%|█████▋    | 25/44 [00:02<00:01, 14.63it/s][2/6] extract embeddings:  61%|██████▏   | 27/44 [00:03<00:01, 14.65it/s][2/6] extract embeddings:  66%|██████▌   | 29/44 [00:03<00:00, 15.07it/s][2/6] extract embeddings:  70%|███████   | 31/44 [00:03<00:00, 15.23it/s][2/6] extract embeddings:  75%|███████▌  | 33/44 [00:03<00:00, 15.14it/s][2/6] extract embeddings:  80%|███████▉  | 35/44 [00:03<00:00, 15.05it/s][2/6] extract embeddings:  84%|████████▍ | 37/44 [00:03<00:00, 14.96it/s][2/6] extract embeddings:  89%|████████▊ | 39/44 [00:03<00:00, 15.02it/s][2/6] extract embeddings:  93%|█████████▎| 41/44 [00:04<00:00, 15.14it/s][2/6] extract embeddings:  98%|█████████▊| 43/44 [00:04<00:00, 15.61it/s][2/6] extract embeddings: 100%|██████████| 44/44 [00:04<00:00, 10.02it/s]
[NeMo I 2025-04-17 00:55:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:55:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:55:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:55:19 collections:880] Dataset successfully loaded with 3421 items and total duration provided from manifest is  1.69 hours.
[NeMo I 2025-04-17 00:55:19 collections:886] # 3421 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/54 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/54 [00:01<01:05,  1.23s/it][3/6] extract embeddings:   6%|▌         | 3/54 [00:01<00:18,  2.78it/s][3/6] extract embeddings:   9%|▉         | 5/54 [00:01<00:10,  4.88it/s][3/6] extract embeddings:  13%|█▎        | 7/54 [00:01<00:06,  6.97it/s][3/6] extract embeddings:  17%|█▋        | 9/54 [00:01<00:04,  9.02it/s][3/6] extract embeddings:  20%|██        | 11/54 [00:01<00:04, 10.71it/s][3/6] extract embeddings:  24%|██▍       | 13/54 [00:01<00:03, 12.32it/s][3/6] extract embeddings:  28%|██▊       | 15/54 [00:02<00:02, 13.13it/s][3/6] extract embeddings:  31%|███▏      | 17/54 [00:02<00:02, 14.14it/s][3/6] extract embeddings:  35%|███▌      | 19/54 [00:02<00:02, 15.10it/s][3/6] extract embeddings:  39%|███▉      | 21/54 [00:02<00:02, 15.28it/s][3/6] extract embeddings:  43%|████▎     | 23/54 [00:02<00:01, 15.92it/s][3/6] extract embeddings:  46%|████▋     | 25/54 [00:02<00:01, 15.96it/s][3/6] extract embeddings:  50%|█████     | 27/54 [00:02<00:01, 16.51it/s][3/6] extract embeddings:  54%|█████▎    | 29/54 [00:02<00:01, 16.79it/s][3/6] extract embeddings:  57%|█████▋    | 31/54 [00:03<00:01, 16.58it/s][3/6] extract embeddings:  61%|██████    | 33/54 [00:03<00:01, 17.06it/s][3/6] extract embeddings:  65%|██████▍   | 35/54 [00:03<00:01, 17.00it/s][3/6] extract embeddings:  69%|██████▊   | 37/54 [00:03<00:01, 16.26it/s][3/6] extract embeddings:  72%|███████▏  | 39/54 [00:03<00:00, 16.26it/s][3/6] extract embeddings:  76%|███████▌  | 41/54 [00:03<00:00, 16.17it/s][3/6] extract embeddings:  80%|███████▉  | 43/54 [00:03<00:00, 15.35it/s][3/6] extract embeddings:  83%|████████▎ | 45/54 [00:03<00:00, 15.29it/s][3/6] extract embeddings:  87%|████████▋ | 47/54 [00:04<00:00, 16.09it/s][3/6] extract embeddings:  91%|█████████ | 49/54 [00:04<00:00, 16.21it/s][3/6] extract embeddings:  94%|█████████▍| 51/54 [00:04<00:00, 15.97it/s][3/6] extract embeddings:  98%|█████████▊| 53/54 [00:04<00:00, 16.06it/s][3/6] extract embeddings: 100%|██████████| 54/54 [00:04<00:00, 12.19it/s]
[NeMo I 2025-04-17 00:55:24 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:55:24 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:55:24 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:55:24 collections:880] Dataset successfully loaded with 4568 items and total duration provided from manifest is  1.76 hours.
[NeMo I 2025-04-17 00:55:24 collections:886] # 4568 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/72 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/72 [00:01<01:25,  1.20s/it][4/6] extract embeddings:   4%|▍         | 3/72 [00:01<00:24,  2.86it/s][4/6] extract embeddings:   7%|▋         | 5/72 [00:01<00:13,  4.96it/s][4/6] extract embeddings:  10%|▉         | 7/72 [00:01<00:09,  7.07it/s][4/6] extract embeddings:  12%|█▎        | 9/72 [00:01<00:07,  8.97it/s][4/6] extract embeddings:  15%|█▌        | 11/72 [00:01<00:05, 10.62it/s][4/6] extract embeddings:  18%|█▊        | 13/72 [00:01<00:05, 11.60it/s][4/6] extract embeddings:  21%|██        | 15/72 [00:02<00:04, 13.07it/s][4/6] extract embeddings:  24%|██▎       | 17/72 [00:02<00:03, 14.48it/s][4/6] extract embeddings:  26%|██▋       | 19/72 [00:02<00:03, 14.71it/s][4/6] extract embeddings:  29%|██▉       | 21/72 [00:02<00:03, 15.20it/s][4/6] extract embeddings:  32%|███▏      | 23/72 [00:02<00:03, 15.07it/s][4/6] extract embeddings:  35%|███▍      | 25/72 [00:02<00:03, 15.12it/s][4/6] extract embeddings:  38%|███▊      | 27/72 [00:02<00:02, 15.33it/s][4/6] extract embeddings:  40%|████      | 29/72 [00:02<00:02, 15.53it/s][4/6] extract embeddings:  43%|████▎     | 31/72 [00:03<00:02, 15.42it/s][4/6] extract embeddings:  46%|████▌     | 33/72 [00:03<00:02, 15.71it/s][4/6] extract embeddings:  49%|████▊     | 35/72 [00:03<00:02, 15.90it/s][4/6] extract embeddings:  51%|█████▏    | 37/72 [00:03<00:02, 16.32it/s][4/6] extract embeddings:  54%|█████▍    | 39/72 [00:03<00:01, 16.75it/s][4/6] extract embeddings:  57%|█████▋    | 41/72 [00:03<00:01, 16.65it/s][4/6] extract embeddings:  60%|█████▉    | 43/72 [00:03<00:01, 16.59it/s][4/6] extract embeddings:  62%|██████▎   | 45/72 [00:03<00:01, 17.08it/s][4/6] extract embeddings:  67%|██████▋   | 48/72 [00:04<00:01, 18.55it/s][4/6] extract embeddings:  71%|███████   | 51/72 [00:04<00:01, 19.33it/s][4/6] extract embeddings:  74%|███████▎  | 53/72 [00:04<00:00, 19.04it/s][4/6] extract embeddings:  78%|███████▊  | 56/72 [00:04<00:00, 19.49it/s][4/6] extract embeddings:  82%|████████▏ | 59/72 [00:04<00:00, 19.70it/s][4/6] extract embeddings:  86%|████████▌ | 62/72 [00:04<00:00, 19.61it/s][4/6] extract embeddings:  89%|████████▉ | 64/72 [00:04<00:00, 18.68it/s][4/6] extract embeddings:  92%|█████████▏| 66/72 [00:04<00:00, 18.13it/s][4/6] extract embeddings:  94%|█████████▍| 68/72 [00:05<00:00, 17.43it/s][4/6] extract embeddings:  97%|█████████▋| 70/72 [00:05<00:00, 16.70it/s][4/6] extract embeddings: 100%|██████████| 72/72 [00:05<00:00, 13.53it/s]
[NeMo I 2025-04-17 00:55:29 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:55:29 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:55:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:55:29 collections:880] Dataset successfully loaded with 6886 items and total duration provided from manifest is  1.83 hours.
[NeMo I 2025-04-17 00:55:29 collections:886] # 6886 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/108 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/108 [00:01<02:06,  1.18s/it][5/6] extract embeddings:   4%|▎         | 4/108 [00:01<00:27,  3.72it/s][5/6] extract embeddings:   6%|▌         | 6/108 [00:01<00:17,  5.72it/s][5/6] extract embeddings:   8%|▊         | 9/108 [00:01<00:11,  8.95it/s][5/6] extract embeddings:  11%|█         | 12/108 [00:01<00:08, 11.86it/s][5/6] extract embeddings:  14%|█▍        | 15/108 [00:01<00:06, 14.87it/s][5/6] extract embeddings:  17%|█▋        | 18/108 [00:01<00:05, 17.21it/s][5/6] extract embeddings:  19%|█▉        | 21/108 [00:02<00:04, 18.00it/s][5/6] extract embeddings:  22%|██▏       | 24/108 [00:02<00:04, 19.56it/s][5/6] extract embeddings:  25%|██▌       | 27/108 [00:02<00:03, 21.22it/s][5/6] extract embeddings:  28%|██▊       | 30/108 [00:02<00:03, 22.52it/s][5/6] extract embeddings:  31%|███       | 33/108 [00:02<00:03, 23.04it/s][5/6] extract embeddings:  33%|███▎      | 36/108 [00:02<00:03, 23.16it/s][5/6] extract embeddings:  36%|███▌      | 39/108 [00:02<00:02, 24.00it/s][5/6] extract embeddings:  39%|███▉      | 42/108 [00:02<00:02, 24.24it/s][5/6] extract embeddings:  42%|████▏     | 45/108 [00:03<00:02, 24.43it/s][5/6] extract embeddings:  44%|████▍     | 48/108 [00:03<00:02, 23.62it/s][5/6] extract embeddings:  47%|████▋     | 51/108 [00:03<00:02, 23.90it/s][5/6] extract embeddings:  50%|█████     | 54/108 [00:03<00:02, 24.71it/s][5/6] extract embeddings:  53%|█████▎    | 57/108 [00:03<00:02, 25.03it/s][5/6] extract embeddings:  56%|█████▌    | 60/108 [00:03<00:01, 24.71it/s][5/6] extract embeddings:  58%|█████▊    | 63/108 [00:03<00:01, 24.44it/s][5/6] extract embeddings:  61%|██████    | 66/108 [00:03<00:01, 24.86it/s][5/6] extract embeddings:  64%|██████▍   | 69/108 [00:04<00:01, 25.31it/s][5/6] extract embeddings:  67%|██████▋   | 72/108 [00:04<00:01, 24.76it/s][5/6] extract embeddings:  69%|██████▉   | 75/108 [00:04<00:01, 24.74it/s][5/6] extract embeddings:  72%|███████▏  | 78/108 [00:04<00:01, 25.32it/s][5/6] extract embeddings:  75%|███████▌  | 81/108 [00:04<00:01, 25.45it/s][5/6] extract embeddings:  78%|███████▊  | 84/108 [00:04<00:00, 24.74it/s][5/6] extract embeddings:  81%|████████  | 87/108 [00:04<00:00, 25.12it/s][5/6] extract embeddings:  83%|████████▎ | 90/108 [00:04<00:00, 25.18it/s][5/6] extract embeddings:  86%|████████▌ | 93/108 [00:04<00:00, 25.67it/s][5/6] extract embeddings:  89%|████████▉ | 96/108 [00:05<00:00, 23.59it/s][5/6] extract embeddings:  92%|█████████▏| 99/108 [00:05<00:00, 21.36it/s][5/6] extract embeddings:  94%|█████████▍| 102/108 [00:05<00:00, 20.61it/s][5/6] extract embeddings:  97%|█████████▋| 105/108 [00:05<00:00, 21.02it/s][5/6] extract embeddings: 100%|██████████| 108/108 [00:05<00:00, 21.53it/s][5/6] extract embeddings: 100%|██████████| 108/108 [00:05<00:00, 18.74it/s]
[NeMo I 2025-04-17 00:55:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:55:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:55:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:55:36 collections:880] Dataset successfully loaded with 14011 items and total duration provided from manifest is  1.91 hours.
[NeMo I 2025-04-17 00:55:36 collections:886] # 14011 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/219 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/219 [00:01<04:59,  1.38s/it][6/6] extract embeddings:   2%|▏         | 5/219 [00:01<00:50,  4.27it/s][6/6] extract embeddings:   4%|▎         | 8/219 [00:01<00:29,  7.15it/s][6/6] extract embeddings:   5%|▌         | 11/219 [00:01<00:20, 10.25it/s][6/6] extract embeddings:   6%|▋         | 14/219 [00:01<00:15, 13.30it/s][6/6] extract embeddings:   8%|▊         | 17/219 [00:01<00:12, 16.05it/s][6/6] extract embeddings:   9%|▉         | 20/219 [00:02<00:10, 18.69it/s][6/6] extract embeddings:  11%|█         | 23/219 [00:02<00:09, 21.18it/s][6/6] extract embeddings:  12%|█▏        | 26/219 [00:02<00:08, 22.86it/s][6/6] extract embeddings:  13%|█▎        | 29/219 [00:02<00:08, 23.63it/s][6/6] extract embeddings:  15%|█▍        | 32/219 [00:02<00:07, 24.76it/s][6/6] extract embeddings:  16%|█▌        | 35/219 [00:02<00:07, 25.58it/s][6/6] extract embeddings:  17%|█▋        | 38/219 [00:02<00:06, 26.53it/s][6/6] extract embeddings:  19%|█▉        | 42/219 [00:02<00:06, 28.37it/s][6/6] extract embeddings:  21%|██        | 45/219 [00:02<00:06, 27.90it/s][6/6] extract embeddings:  22%|██▏       | 49/219 [00:03<00:05, 28.59it/s][6/6] extract embeddings:  24%|██▍       | 53/219 [00:03<00:05, 28.65it/s][6/6] extract embeddings:  26%|██▌       | 56/219 [00:03<00:05, 28.27it/s][6/6] extract embeddings:  27%|██▋       | 59/219 [00:03<00:05, 28.23it/s][6/6] extract embeddings:  28%|██▊       | 62/219 [00:03<00:05, 26.91it/s][6/6] extract embeddings:  30%|██▉       | 65/219 [00:03<00:05, 26.92it/s][6/6] extract embeddings:  31%|███       | 68/219 [00:03<00:05, 26.42it/s][6/6] extract embeddings:  33%|███▎      | 72/219 [00:03<00:05, 27.19it/s][6/6] extract embeddings:  34%|███▍      | 75/219 [00:04<00:05, 27.68it/s][6/6] extract embeddings:  36%|███▌      | 78/219 [00:04<00:05, 26.94it/s][6/6] extract embeddings:  37%|███▋      | 81/219 [00:04<00:05, 27.59it/s][6/6] extract embeddings:  38%|███▊      | 84/219 [00:04<00:04, 27.89it/s][6/6] extract embeddings:  40%|███▉      | 87/219 [00:04<00:04, 26.82it/s][6/6] extract embeddings:  41%|████      | 90/219 [00:04<00:04, 26.45it/s][6/6] extract embeddings:  42%|████▏     | 93/219 [00:04<00:04, 26.54it/s][6/6] extract embeddings:  44%|████▍     | 96/219 [00:04<00:04, 25.80it/s][6/6] extract embeddings:  45%|████▌     | 99/219 [00:04<00:04, 25.05it/s][6/6] extract embeddings:  47%|████▋     | 102/219 [00:05<00:04, 25.03it/s][6/6] extract embeddings:  48%|████▊     | 105/219 [00:05<00:04, 24.39it/s][6/6] extract embeddings:  49%|████▉     | 108/219 [00:05<00:04, 24.88it/s][6/6] extract embeddings:  51%|█████     | 111/219 [00:05<00:04, 24.99it/s][6/6] extract embeddings:  52%|█████▏    | 114/219 [00:05<00:04, 26.04it/s][6/6] extract embeddings:  54%|█████▍    | 118/219 [00:05<00:03, 27.17it/s][6/6] extract embeddings:  55%|█████▌    | 121/219 [00:05<00:03, 26.79it/s][6/6] extract embeddings:  57%|█████▋    | 124/219 [00:05<00:03, 26.03it/s][6/6] extract embeddings:  58%|█████▊    | 127/219 [00:06<00:03, 26.21it/s][6/6] extract embeddings:  59%|█████▉    | 130/219 [00:06<00:03, 25.86it/s][6/6] extract embeddings:  61%|██████    | 133/219 [00:06<00:03, 26.94it/s][6/6] extract embeddings:  62%|██████▏   | 136/219 [00:06<00:02, 27.70it/s][6/6] extract embeddings:  63%|██████▎   | 139/219 [00:06<00:02, 26.99it/s][6/6] extract embeddings:  65%|██████▍   | 142/219 [00:06<00:02, 26.02it/s][6/6] extract embeddings:  66%|██████▌   | 145/219 [00:06<00:02, 25.71it/s][6/6] extract embeddings:  68%|██████▊   | 148/219 [00:06<00:02, 25.86it/s][6/6] extract embeddings:  69%|██████▉   | 152/219 [00:06<00:02, 28.03it/s][6/6] extract embeddings:  71%|███████   | 155/219 [00:07<00:02, 28.13it/s][6/6] extract embeddings:  72%|███████▏  | 158/219 [00:07<00:02, 27.86it/s][6/6] extract embeddings:  74%|███████▎  | 161/219 [00:07<00:02, 27.15it/s][6/6] extract embeddings:  75%|███████▍  | 164/219 [00:07<00:02, 27.39it/s][6/6] extract embeddings:  76%|███████▋  | 167/219 [00:07<00:01, 27.36it/s][6/6] extract embeddings:  78%|███████▊  | 171/219 [00:07<00:01, 28.92it/s][6/6] extract embeddings:  80%|███████▉  | 175/219 [00:07<00:01, 29.56it/s][6/6] extract embeddings:  82%|████████▏ | 179/219 [00:07<00:01, 30.89it/s][6/6] extract embeddings:  84%|████████▎ | 183/219 [00:08<00:01, 30.63it/s][6/6] extract embeddings:  85%|████████▌ | 187/219 [00:08<00:01, 29.58it/s][6/6] extract embeddings:  87%|████████▋ | 190/219 [00:08<00:00, 29.43it/s][6/6] extract embeddings:  88%|████████▊ | 193/219 [00:08<00:00, 29.55it/s][6/6] extract embeddings:  89%|████████▉ | 196/219 [00:08<00:00, 28.73it/s][6/6] extract embeddings:  91%|█████████▏| 200/219 [00:08<00:00, 30.47it/s][6/6] extract embeddings:  93%|█████████▎| 204/219 [00:08<00:00, 31.48it/s][6/6] extract embeddings:  95%|█████████▍| 208/219 [00:08<00:00, 31.47it/s][6/6] extract embeddings:  97%|█████████▋| 212/219 [00:08<00:00, 31.53it/s][6/6] extract embeddings:  99%|█████████▊| 216/219 [00:09<00:00, 30.55it/s][6/6] extract embeddings: 100%|██████████| 219/219 [00:09<00:00, 23.70it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.97it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.13it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.72it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.25it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s]
[NeMo I 2025-04-17 00:55:47 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:55:48 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              36.856067   444.120  ...   15.635020  3.520449
    Harker-ES                       28.891035  2178.782  ...   67.909941  3.116876
    Harker-MN                       41.300369   366.767  ...   28.512112  7.773903
    Longfellow-Block-1              22.560544   492.417  ...   11.201019  2.274702
    TOTAL                           30.318778  3482.086  ...  123.258092  3.539777
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:55:48 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0887 | MISS: 0.1791 | CER: 0.0354 | DER: 0.3032 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.90s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.97s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.26s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.19s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:56:02 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:56:02 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:56:02 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:56:02 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:56:02 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:56:02 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:56:02 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:56:02 features:305] PADDING: 16
[NeMo I 2025-04-17 00:56:03 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:56:03 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:56:03 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:56:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:56:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:56:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:56:03 collections:880] Dataset successfully loaded with 2289 items and total duration provided from manifest is  1.51 hours.
[NeMo I 2025-04-17 00:56:03 collections:886] # 2289 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/36 [00:02<01:14,  2.13s/it][1/6] extract embeddings:  11%|█         | 4/36 [00:02<00:14,  2.28it/s][1/6] extract embeddings:  17%|█▋        | 6/36 [00:02<00:08,  3.57it/s][1/6] extract embeddings:  22%|██▏       | 8/36 [00:02<00:05,  4.91it/s][1/6] extract embeddings:  28%|██▊       | 10/36 [00:02<00:04,  6.25it/s][1/6] extract embeddings:  33%|███▎      | 12/36 [00:02<00:03,  7.44it/s][1/6] extract embeddings:  39%|███▉      | 14/36 [00:03<00:02,  8.65it/s][1/6] extract embeddings:  44%|████▍     | 16/36 [00:03<00:02,  9.67it/s][1/6] extract embeddings:  50%|█████     | 18/36 [00:03<00:01, 10.42it/s][1/6] extract embeddings:  56%|█████▌    | 20/36 [00:03<00:01, 10.89it/s][1/6] extract embeddings:  61%|██████    | 22/36 [00:03<00:01, 11.15it/s][1/6] extract embeddings:  67%|██████▋   | 24/36 [00:03<00:01, 11.61it/s][1/6] extract embeddings:  72%|███████▏  | 26/36 [00:04<00:00, 11.78it/s][1/6] extract embeddings:  78%|███████▊  | 28/36 [00:04<00:00, 11.94it/s][1/6] extract embeddings:  83%|████████▎ | 30/36 [00:04<00:00, 11.97it/s][1/6] extract embeddings:  89%|████████▉ | 32/36 [00:04<00:00, 12.36it/s][1/6] extract embeddings:  94%|█████████▍| 34/36 [00:04<00:00, 12.85it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00, 13.91it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00,  7.52it/s]
[NeMo I 2025-04-17 00:56:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:56:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:56:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:56:08 collections:880] Dataset successfully loaded with 2688 items and total duration provided from manifest is  1.56 hours.
[NeMo I 2025-04-17 00:56:08 collections:886] # 2688 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/42 [00:01<01:01,  1.49s/it][2/6] extract embeddings:   7%|▋         | 3/42 [00:01<00:17,  2.28it/s][2/6] extract embeddings:  12%|█▏        | 5/42 [00:01<00:09,  3.96it/s][2/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:06,  5.57it/s][2/6] extract embeddings:  21%|██▏       | 9/42 [00:02<00:04,  7.12it/s][2/6] extract embeddings:  26%|██▌       | 11/42 [00:02<00:03,  8.37it/s][2/6] extract embeddings:  31%|███       | 13/42 [00:02<00:02,  9.69it/s][2/6] extract embeddings:  36%|███▌      | 15/42 [00:02<00:02, 10.63it/s][2/6] extract embeddings:  40%|████      | 17/42 [00:02<00:02, 11.40it/s][2/6] extract embeddings:  45%|████▌     | 19/42 [00:02<00:01, 11.81it/s][2/6] extract embeddings:  50%|█████     | 21/42 [00:02<00:01, 12.38it/s][2/6] extract embeddings:  55%|█████▍    | 23/42 [00:03<00:01, 12.74it/s][2/6] extract embeddings:  60%|█████▉    | 25/42 [00:03<00:01, 12.75it/s][2/6] extract embeddings:  64%|██████▍   | 27/42 [00:03<00:01, 12.93it/s][2/6] extract embeddings:  69%|██████▉   | 29/42 [00:03<00:00, 13.12it/s][2/6] extract embeddings:  74%|███████▍  | 31/42 [00:03<00:00, 13.23it/s][2/6] extract embeddings:  79%|███████▊  | 33/42 [00:03<00:00, 13.32it/s][2/6] extract embeddings:  83%|████████▎ | 35/42 [00:04<00:00, 13.38it/s][2/6] extract embeddings:  88%|████████▊ | 37/42 [00:04<00:00, 13.75it/s][2/6] extract embeddings:  93%|█████████▎| 39/42 [00:04<00:00, 14.19it/s][2/6] extract embeddings:  98%|█████████▊| 41/42 [00:04<00:00, 12.76it/s][2/6] extract embeddings: 100%|██████████| 42/42 [00:04<00:00,  9.13it/s]
[NeMo I 2025-04-17 00:56:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:56:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:56:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:56:13 collections:880] Dataset successfully loaded with 3326 items and total duration provided from manifest is  1.62 hours.
[NeMo I 2025-04-17 00:56:13 collections:886] # 3326 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/52 [00:01<01:08,  1.35s/it][3/6] extract embeddings:   6%|▌         | 3/52 [00:01<00:18,  2.58it/s][3/6] extract embeddings:  10%|▉         | 5/52 [00:01<00:10,  4.60it/s][3/6] extract embeddings:  13%|█▎        | 7/52 [00:01<00:06,  6.69it/s][3/6] extract embeddings:  17%|█▋        | 9/52 [00:01<00:04,  8.80it/s][3/6] extract embeddings:  21%|██        | 11/52 [00:01<00:03, 10.61it/s][3/6] extract embeddings:  25%|██▌       | 13/52 [00:02<00:03, 11.83it/s][3/6] extract embeddings:  29%|██▉       | 15/52 [00:02<00:02, 13.37it/s][3/6] extract embeddings:  33%|███▎      | 17/52 [00:02<00:02, 14.37it/s][3/6] extract embeddings:  37%|███▋      | 19/52 [00:02<00:02, 14.30it/s][3/6] extract embeddings:  40%|████      | 21/52 [00:02<00:02, 14.86it/s][3/6] extract embeddings:  44%|████▍     | 23/52 [00:02<00:01, 15.46it/s][3/6] extract embeddings:  48%|████▊     | 25/52 [00:02<00:01, 16.36it/s][3/6] extract embeddings:  52%|█████▏    | 27/52 [00:02<00:01, 16.43it/s][3/6] extract embeddings:  56%|█████▌    | 29/52 [00:02<00:01, 16.37it/s][3/6] extract embeddings:  60%|█████▉    | 31/52 [00:03<00:01, 16.59it/s][3/6] extract embeddings:  63%|██████▎   | 33/52 [00:03<00:01, 16.96it/s][3/6] extract embeddings:  69%|██████▉   | 36/52 [00:03<00:00, 17.58it/s][3/6] extract embeddings:  73%|███████▎  | 38/52 [00:03<00:00, 18.12it/s][3/6] extract embeddings:  77%|███████▋  | 40/52 [00:03<00:00, 18.14it/s][3/6] extract embeddings:  81%|████████  | 42/52 [00:03<00:00, 17.88it/s][3/6] extract embeddings:  85%|████████▍ | 44/52 [00:03<00:00, 18.05it/s][3/6] extract embeddings:  88%|████████▊ | 46/52 [00:03<00:00, 18.00it/s][3/6] extract embeddings:  92%|█████████▏| 48/52 [00:04<00:00, 18.37it/s][3/6] extract embeddings:  96%|█████████▌| 50/52 [00:04<00:00, 18.77it/s][3/6] extract embeddings: 100%|██████████| 52/52 [00:04<00:00, 17.87it/s][3/6] extract embeddings: 100%|██████████| 52/52 [00:04<00:00, 12.13it/s]
[NeMo I 2025-04-17 00:56:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:56:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:56:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:56:17 collections:880] Dataset successfully loaded with 4431 items and total duration provided from manifest is  1.69 hours.
[NeMo I 2025-04-17 00:56:17 collections:886] # 4431 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/70 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/70 [00:01<01:34,  1.36s/it][4/6] extract embeddings:   6%|▌         | 4/70 [00:01<00:19,  3.40it/s][4/6] extract embeddings:   9%|▊         | 6/70 [00:01<00:12,  5.29it/s][4/6] extract embeddings:  13%|█▎        | 9/70 [00:01<00:07,  8.33it/s][4/6] extract embeddings:  16%|█▌        | 11/70 [00:01<00:05, 10.07it/s][4/6] extract embeddings:  20%|██        | 14/70 [00:01<00:04, 12.78it/s][4/6] extract embeddings:  24%|██▍       | 17/70 [00:02<00:03, 15.27it/s][4/6] extract embeddings:  29%|██▊       | 20/70 [00:02<00:03, 15.81it/s][4/6] extract embeddings:  33%|███▎      | 23/70 [00:02<00:02, 17.01it/s][4/6] extract embeddings:  36%|███▌      | 25/70 [00:02<00:02, 17.44it/s][4/6] extract embeddings:  40%|████      | 28/70 [00:02<00:02, 18.85it/s][4/6] extract embeddings:  44%|████▍     | 31/70 [00:02<00:02, 19.03it/s][4/6] extract embeddings:  49%|████▊     | 34/70 [00:02<00:01, 20.02it/s][4/6] extract embeddings:  53%|█████▎    | 37/70 [00:03<00:01, 19.58it/s][4/6] extract embeddings:  57%|█████▋    | 40/70 [00:03<00:01, 20.41it/s][4/6] extract embeddings:  61%|██████▏   | 43/70 [00:03<00:01, 20.55it/s][4/6] extract embeddings:  66%|██████▌   | 46/70 [00:03<00:01, 20.52it/s][4/6] extract embeddings:  70%|███████   | 49/70 [00:03<00:01, 19.70it/s][4/6] extract embeddings:  74%|███████▍  | 52/70 [00:03<00:00, 20.24it/s][4/6] extract embeddings:  79%|███████▊  | 55/70 [00:04<00:00, 20.28it/s][4/6] extract embeddings:  83%|████████▎ | 58/70 [00:04<00:00, 20.13it/s][4/6] extract embeddings:  87%|████████▋ | 61/70 [00:04<00:00, 20.51it/s][4/6] extract embeddings:  91%|█████████▏| 64/70 [00:04<00:00, 20.10it/s][4/6] extract embeddings:  96%|█████████▌| 67/70 [00:04<00:00, 18.93it/s][4/6] extract embeddings:  99%|█████████▊| 69/70 [00:04<00:00, 17.95it/s][4/6] extract embeddings: 100%|██████████| 70/70 [00:04<00:00, 14.49it/s]
[NeMo I 2025-04-17 00:56:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:56:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:56:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:56:22 collections:880] Dataset successfully loaded with 6674 items and total duration provided from manifest is  1.76 hours.
[NeMo I 2025-04-17 00:56:22 collections:886] # 6674 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/105 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/105 [00:01<02:03,  1.19s/it][5/6] extract embeddings:   4%|▍         | 4/105 [00:01<00:25,  3.92it/s][5/6] extract embeddings:   7%|▋         | 7/105 [00:01<00:13,  7.13it/s][5/6] extract embeddings:  10%|▉         | 10/105 [00:01<00:09, 10.34it/s][5/6] extract embeddings:  12%|█▏        | 13/105 [00:01<00:06, 13.51it/s][5/6] extract embeddings:  15%|█▌        | 16/105 [00:01<00:05, 16.02it/s][5/6] extract embeddings:  18%|█▊        | 19/105 [00:01<00:04, 18.63it/s][5/6] extract embeddings:  21%|██        | 22/105 [00:02<00:04, 20.52it/s][5/6] extract embeddings:  24%|██▍       | 25/105 [00:02<00:03, 21.50it/s][5/6] extract embeddings:  27%|██▋       | 28/105 [00:02<00:03, 22.93it/s][5/6] extract embeddings:  30%|██▉       | 31/105 [00:02<00:03, 21.98it/s][5/6] extract embeddings:  32%|███▏      | 34/105 [00:02<00:03, 21.81it/s][5/6] extract embeddings:  35%|███▌      | 37/105 [00:02<00:02, 23.02it/s][5/6] extract embeddings:  38%|███▊      | 40/105 [00:02<00:02, 24.45it/s][5/6] extract embeddings:  41%|████      | 43/105 [00:02<00:02, 23.49it/s][5/6] extract embeddings:  44%|████▍     | 46/105 [00:03<00:02, 24.25it/s][5/6] extract embeddings:  47%|████▋     | 49/105 [00:03<00:02, 24.62it/s][5/6] extract embeddings:  50%|████▉     | 52/105 [00:03<00:02, 25.43it/s][5/6] extract embeddings:  52%|█████▏    | 55/105 [00:03<00:02, 24.06it/s][5/6] extract embeddings:  55%|█████▌    | 58/105 [00:03<00:01, 24.92it/s][5/6] extract embeddings:  58%|█████▊    | 61/105 [00:03<00:01, 23.32it/s][5/6] extract embeddings:  61%|██████    | 64/105 [00:03<00:01, 24.13it/s][5/6] extract embeddings:  64%|██████▍   | 67/105 [00:03<00:01, 24.54it/s][5/6] extract embeddings:  67%|██████▋   | 70/105 [00:03<00:01, 23.62it/s][5/6] extract embeddings:  70%|██████▉   | 73/105 [00:04<00:01, 24.48it/s][5/6] extract embeddings:  72%|███████▏  | 76/105 [00:04<00:01, 24.09it/s][5/6] extract embeddings:  75%|███████▌  | 79/105 [00:04<00:01, 24.85it/s][5/6] extract embeddings:  78%|███████▊  | 82/105 [00:04<00:00, 25.02it/s][5/6] extract embeddings:  81%|████████  | 85/105 [00:04<00:00, 24.82it/s][5/6] extract embeddings:  84%|████████▍ | 88/105 [00:04<00:00, 23.56it/s][5/6] extract embeddings:  87%|████████▋ | 91/105 [00:04<00:00, 20.93it/s][5/6] extract embeddings:  90%|████████▉ | 94/105 [00:05<00:00, 20.31it/s][5/6] extract embeddings:  92%|█████████▏| 97/105 [00:05<00:00, 19.84it/s][5/6] extract embeddings:  95%|█████████▌| 100/105 [00:05<00:00, 19.16it/s][5/6] extract embeddings:  97%|█████████▋| 102/105 [00:05<00:00, 18.69it/s][5/6] extract embeddings:  99%|█████████▉| 104/105 [00:05<00:00, 17.95it/s][5/6] extract embeddings: 100%|██████████| 105/105 [00:05<00:00, 18.41it/s]
[NeMo I 2025-04-17 00:56:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:56:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:56:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:56:29 collections:880] Dataset successfully loaded with 13593 items and total duration provided from manifest is  1.85 hours.
[NeMo I 2025-04-17 00:56:29 collections:886] # 13593 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/213 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/213 [00:01<04:13,  1.20s/it][6/6] extract embeddings:   2%|▏         | 5/213 [00:01<00:42,  4.89it/s][6/6] extract embeddings:   4%|▍         | 9/213 [00:01<00:22,  8.90it/s][6/6] extract embeddings:   6%|▌         | 13/213 [00:01<00:15, 12.81it/s][6/6] extract embeddings:   8%|▊         | 16/213 [00:01<00:12, 15.65it/s][6/6] extract embeddings:   9%|▉         | 19/213 [00:01<00:11, 17.47it/s][6/6] extract embeddings:  10%|█         | 22/213 [00:01<00:09, 19.23it/s][6/6] extract embeddings:  12%|█▏        | 25/213 [00:02<00:09, 20.41it/s][6/6] extract embeddings:  13%|█▎        | 28/213 [00:02<00:08, 22.02it/s][6/6] extract embeddings:  15%|█▍        | 31/213 [00:02<00:08, 22.02it/s][6/6] extract embeddings:  16%|█▌        | 34/213 [00:02<00:07, 23.68it/s][6/6] extract embeddings:  17%|█▋        | 37/213 [00:02<00:07, 24.60it/s][6/6] extract embeddings:  19%|█▉        | 40/213 [00:02<00:06, 25.72it/s][6/6] extract embeddings:  20%|██        | 43/213 [00:02<00:06, 25.04it/s][6/6] extract embeddings:  22%|██▏       | 46/213 [00:02<00:06, 25.74it/s][6/6] extract embeddings:  23%|██▎       | 50/213 [00:03<00:06, 27.10it/s][6/6] extract embeddings:  25%|██▍       | 53/213 [00:03<00:05, 26.94it/s][6/6] extract embeddings:  26%|██▋       | 56/213 [00:03<00:05, 26.83it/s][6/6] extract embeddings:  28%|██▊       | 59/213 [00:03<00:05, 26.02it/s][6/6] extract embeddings:  29%|██▉       | 62/213 [00:03<00:05, 26.32it/s][6/6] extract embeddings:  31%|███       | 65/213 [00:03<00:05, 27.21it/s][6/6] extract embeddings:  32%|███▏      | 68/213 [00:03<00:05, 27.69it/s][6/6] extract embeddings:  33%|███▎      | 71/213 [00:03<00:05, 25.00it/s][6/6] extract embeddings:  35%|███▍      | 74/213 [00:03<00:06, 22.50it/s][6/6] extract embeddings:  36%|███▌      | 77/213 [00:04<00:05, 23.63it/s][6/6] extract embeddings:  38%|███▊      | 80/213 [00:04<00:05, 23.48it/s][6/6] extract embeddings:  39%|███▉      | 83/213 [00:04<00:05, 24.25it/s][6/6] extract embeddings:  40%|████      | 86/213 [00:04<00:05, 24.22it/s][6/6] extract embeddings:  42%|████▏     | 90/213 [00:04<00:04, 25.30it/s][6/6] extract embeddings:  44%|████▎     | 93/213 [00:04<00:05, 23.32it/s][6/6] extract embeddings:  46%|████▌     | 97/213 [00:04<00:04, 24.85it/s][6/6] extract embeddings:  47%|████▋     | 100/213 [00:05<00:04, 24.44it/s][6/6] extract embeddings:  48%|████▊     | 103/213 [00:05<00:04, 25.11it/s][6/6] extract embeddings:  50%|████▉     | 106/213 [00:05<00:04, 26.21it/s][6/6] extract embeddings:  51%|█████     | 109/213 [00:05<00:04, 24.96it/s][6/6] extract embeddings:  53%|█████▎    | 112/213 [00:05<00:04, 24.55it/s][6/6] extract embeddings:  54%|█████▍    | 115/213 [00:05<00:04, 24.37it/s][6/6] extract embeddings:  55%|█████▌    | 118/213 [00:05<00:03, 24.85it/s][6/6] extract embeddings:  57%|█████▋    | 121/213 [00:05<00:03, 24.92it/s][6/6] extract embeddings:  58%|█████▊    | 124/213 [00:06<00:03, 24.75it/s][6/6] extract embeddings:  60%|█████▉    | 127/213 [00:06<00:03, 24.97it/s][6/6] extract embeddings:  61%|██████    | 130/213 [00:06<00:03, 25.19it/s][6/6] extract embeddings:  62%|██████▏   | 133/213 [00:06<00:03, 25.52it/s][6/6] extract embeddings:  64%|██████▍   | 136/213 [00:06<00:02, 26.15it/s][6/6] extract embeddings:  65%|██████▌   | 139/213 [00:06<00:02, 26.86it/s][6/6] extract embeddings:  67%|██████▋   | 142/213 [00:06<00:02, 25.54it/s][6/6] extract embeddings:  68%|██████▊   | 145/213 [00:06<00:02, 25.00it/s][6/6] extract embeddings:  69%|██████▉   | 148/213 [00:06<00:02, 25.83it/s][6/6] extract embeddings:  71%|███████   | 151/213 [00:07<00:02, 24.47it/s][6/6] extract embeddings:  72%|███████▏  | 154/213 [00:07<00:02, 23.81it/s][6/6] extract embeddings:  74%|███████▎  | 157/213 [00:07<00:02, 24.69it/s][6/6] extract embeddings:  75%|███████▌  | 160/213 [00:07<00:02, 25.20it/s][6/6] extract embeddings:  77%|███████▋  | 163/213 [00:07<00:01, 25.92it/s][6/6] extract embeddings:  78%|███████▊  | 166/213 [00:07<00:01, 25.39it/s][6/6] extract embeddings:  79%|███████▉  | 169/213 [00:07<00:01, 24.92it/s][6/6] extract embeddings:  81%|████████  | 172/213 [00:07<00:01, 25.43it/s][6/6] extract embeddings:  82%|████████▏ | 175/213 [00:07<00:01, 26.34it/s][6/6] extract embeddings:  84%|████████▎ | 178/213 [00:08<00:01, 25.54it/s][6/6] extract embeddings:  85%|████████▌ | 182/213 [00:08<00:01, 27.91it/s][6/6] extract embeddings:  87%|████████▋ | 185/213 [00:08<00:01, 27.87it/s][6/6] extract embeddings:  88%|████████▊ | 188/213 [00:08<00:00, 28.39it/s][6/6] extract embeddings:  90%|█████████ | 192/213 [00:08<00:00, 29.79it/s][6/6] extract embeddings:  92%|█████████▏| 196/213 [00:08<00:00, 30.53it/s][6/6] extract embeddings:  94%|█████████▍| 200/213 [00:08<00:00, 31.03it/s][6/6] extract embeddings:  96%|█████████▌| 204/213 [00:08<00:00, 28.57it/s][6/6] extract embeddings:  97%|█████████▋| 207/213 [00:09<00:00, 28.01it/s][6/6] extract embeddings:  99%|█████████▊| 210/213 [00:09<00:00, 27.92it/s][6/6] extract embeddings: 100%|██████████| 213/213 [00:09<00:00, 22.85it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.95it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.22it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.77it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.31it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.96it/s]
[NeMo I 2025-04-17 00:56:40 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:56:41 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              38.700156   444.120  ...   16.735026  3.768132
    Harker-ES                       30.398599  2178.782  ...   67.091019  3.079290
    Harker-MN                       42.093496   366.767  ...   28.461980  7.760235
    Longfellow-Block-1              24.144552   492.417  ...   11.890006  2.414621
    TOTAL                           31.804822  3482.086  ...  124.178031  3.566197
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:56:41 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0837 | MISS: 0.1987 | CER: 0.0357 | DER: 0.3180 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:02<00:08,  2.84s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:04<00:04,  2.40s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:05<00:01,  1.49s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:05<00:00,  1.07s/it]Processing Audio: 100%|██████████| 4/4 [00:05<00:00,  1.44s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:56:58 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:56:58 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:56:58 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:56:58 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:56:58 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:56:59 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:56:59 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:56:59 features:305] PADDING: 16
[NeMo I 2025-04-17 00:57:00 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:57:00 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:57:00 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:57:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:57:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:57:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:57:00 collections:880] Dataset successfully loaded with 2242 items and total duration provided from manifest is  1.43 hours.
[NeMo I 2025-04-17 00:57:00 collections:886] # 2242 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/36 [00:03<02:10,  3.72s/it][1/6] extract embeddings:  11%|█         | 4/36 [00:03<00:23,  1.36it/s][1/6] extract embeddings:  17%|█▋        | 6/36 [00:03<00:13,  2.25it/s][1/6] extract embeddings:  22%|██▏       | 8/36 [00:04<00:08,  3.37it/s][1/6] extract embeddings:  28%|██▊       | 10/36 [00:04<00:05,  4.64it/s][1/6] extract embeddings:  33%|███▎      | 12/36 [00:04<00:04,  5.89it/s][1/6] extract embeddings:  39%|███▉      | 14/36 [00:04<00:03,  7.27it/s][1/6] extract embeddings:  44%|████▍     | 16/36 [00:04<00:02,  8.57it/s][1/6] extract embeddings:  50%|█████     | 18/36 [00:04<00:01,  9.80it/s][1/6] extract embeddings:  56%|█████▌    | 20/36 [00:04<00:01, 10.91it/s][1/6] extract embeddings:  61%|██████    | 22/36 [00:05<00:01, 11.40it/s][1/6] extract embeddings:  67%|██████▋   | 24/36 [00:05<00:00, 12.17it/s][1/6] extract embeddings:  72%|███████▏  | 26/36 [00:05<00:00, 12.71it/s][1/6] extract embeddings:  78%|███████▊  | 28/36 [00:05<00:00, 13.03it/s][1/6] extract embeddings:  83%|████████▎ | 30/36 [00:05<00:00, 13.13it/s][1/6] extract embeddings:  89%|████████▉ | 32/36 [00:05<00:00, 13.40it/s][1/6] extract embeddings:  94%|█████████▍| 34/36 [00:05<00:00, 13.57it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:06<00:00,  5.92it/s]
[NeMo I 2025-04-17 00:57:06 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:57:06 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:57:06 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:57:06 collections:880] Dataset successfully loaded with 2630 items and total duration provided from manifest is  1.49 hours.
[NeMo I 2025-04-17 00:57:06 collections:886] # 2630 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:59,  1.45s/it][2/6] extract embeddings:   7%|▋         | 3/42 [00:01<00:16,  2.35it/s][2/6] extract embeddings:  12%|█▏        | 5/42 [00:01<00:08,  4.12it/s][2/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:05,  5.94it/s][2/6] extract embeddings:  21%|██▏       | 9/42 [00:01<00:04,  7.89it/s][2/6] extract embeddings:  26%|██▌       | 11/42 [00:02<00:03,  9.43it/s][2/6] extract embeddings:  31%|███       | 13/42 [00:02<00:02, 10.47it/s][2/6] extract embeddings:  36%|███▌      | 15/42 [00:02<00:02, 11.84it/s][2/6] extract embeddings:  40%|████      | 17/42 [00:02<00:01, 12.58it/s][2/6] extract embeddings:  45%|████▌     | 19/42 [00:02<00:01, 13.50it/s][2/6] extract embeddings:  50%|█████     | 21/42 [00:02<00:01, 14.60it/s][2/6] extract embeddings:  55%|█████▍    | 23/42 [00:02<00:01, 14.37it/s][2/6] extract embeddings:  60%|█████▉    | 25/42 [00:03<00:01, 14.22it/s][2/6] extract embeddings:  64%|██████▍   | 27/42 [00:03<00:01, 14.15it/s][2/6] extract embeddings:  69%|██████▉   | 29/42 [00:03<00:00, 14.38it/s][2/6] extract embeddings:  74%|███████▍  | 31/42 [00:03<00:00, 14.31it/s][2/6] extract embeddings:  79%|███████▊  | 33/42 [00:03<00:00, 13.92it/s][2/6] extract embeddings:  83%|████████▎ | 35/42 [00:03<00:00, 13.90it/s][2/6] extract embeddings:  88%|████████▊ | 37/42 [00:03<00:00, 14.36it/s][2/6] extract embeddings:  93%|█████████▎| 39/42 [00:04<00:00, 14.86it/s][2/6] extract embeddings:  98%|█████████▊| 41/42 [00:04<00:00, 14.93it/s][2/6] extract embeddings: 100%|██████████| 42/42 [00:04<00:00,  9.98it/s]
[NeMo I 2025-04-17 00:57:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:57:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:57:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:57:10 collections:880] Dataset successfully loaded with 3231 items and total duration provided from manifest is  1.55 hours.
[NeMo I 2025-04-17 00:57:10 collections:886] # 3231 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/51 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/51 [00:01<01:12,  1.46s/it][3/6] extract embeddings:   6%|▌         | 3/51 [00:01<00:20,  2.38it/s][3/6] extract embeddings:  10%|▉         | 5/51 [00:01<00:10,  4.26it/s][3/6] extract embeddings:  14%|█▎        | 7/51 [00:01<00:07,  6.09it/s][3/6] extract embeddings:  18%|█▊        | 9/51 [00:01<00:05,  7.88it/s][3/6] extract embeddings:  22%|██▏       | 11/51 [00:02<00:04,  9.90it/s][3/6] extract embeddings:  25%|██▌       | 13/51 [00:02<00:03, 11.71it/s][3/6] extract embeddings:  29%|██▉       | 15/51 [00:02<00:02, 13.03it/s][3/6] extract embeddings:  33%|███▎      | 17/51 [00:02<00:02, 14.31it/s][3/6] extract embeddings:  37%|███▋      | 19/51 [00:02<00:02, 15.12it/s][3/6] extract embeddings:  41%|████      | 21/51 [00:02<00:01, 15.17it/s][3/6] extract embeddings:  45%|████▌     | 23/51 [00:02<00:01, 15.99it/s][3/6] extract embeddings:  49%|████▉     | 25/51 [00:02<00:01, 16.05it/s][3/6] extract embeddings:  53%|█████▎    | 27/51 [00:02<00:01, 16.71it/s][3/6] extract embeddings:  57%|█████▋    | 29/51 [00:03<00:01, 16.35it/s][3/6] extract embeddings:  61%|██████    | 31/51 [00:03<00:01, 16.36it/s][3/6] extract embeddings:  65%|██████▍   | 33/51 [00:03<00:01, 16.38it/s][3/6] extract embeddings:  69%|██████▊   | 35/51 [00:03<00:00, 16.99it/s][3/6] extract embeddings:  73%|███████▎  | 37/51 [00:03<00:00, 16.60it/s][3/6] extract embeddings:  76%|███████▋  | 39/51 [00:03<00:00, 16.63it/s][3/6] extract embeddings:  80%|████████  | 41/51 [00:03<00:00, 16.82it/s][3/6] extract embeddings:  84%|████████▍ | 43/51 [00:03<00:00, 17.29it/s][3/6] extract embeddings:  88%|████████▊ | 45/51 [00:04<00:00, 17.35it/s][3/6] extract embeddings:  92%|█████████▏| 47/51 [00:04<00:00, 16.61it/s][3/6] extract embeddings:  96%|█████████▌| 49/51 [00:04<00:00, 16.78it/s][3/6] extract embeddings: 100%|██████████| 51/51 [00:04<00:00, 11.54it/s]
[NeMo I 2025-04-17 00:57:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:57:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:57:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:57:15 collections:880] Dataset successfully loaded with 4295 items and total duration provided from manifest is  1.62 hours.
[NeMo I 2025-04-17 00:57:15 collections:886] # 4295 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/68 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/68 [00:01<01:21,  1.22s/it][4/6] extract embeddings:   6%|▌         | 4/68 [00:01<00:17,  3.68it/s][4/6] extract embeddings:   9%|▉         | 6/68 [00:01<00:10,  5.64it/s][4/6] extract embeddings:  12%|█▏        | 8/68 [00:01<00:07,  7.56it/s][4/6] extract embeddings:  15%|█▍        | 10/68 [00:01<00:06,  9.33it/s][4/6] extract embeddings:  18%|█▊        | 12/68 [00:01<00:04, 11.23it/s][4/6] extract embeddings:  22%|██▏       | 15/68 [00:01<00:03, 13.76it/s][4/6] extract embeddings:  25%|██▌       | 17/68 [00:02<00:03, 14.73it/s][4/6] extract embeddings:  29%|██▉       | 20/68 [00:02<00:02, 16.21it/s][4/6] extract embeddings:  34%|███▍      | 23/68 [00:02<00:02, 17.64it/s][4/6] extract embeddings:  37%|███▋      | 25/68 [00:02<00:02, 18.07it/s][4/6] extract embeddings:  40%|███▉      | 27/68 [00:02<00:02, 18.13it/s][4/6] extract embeddings:  43%|████▎     | 29/68 [00:02<00:02, 18.27it/s][4/6] extract embeddings:  46%|████▌     | 31/68 [00:02<00:02, 18.21it/s][4/6] extract embeddings:  49%|████▊     | 33/68 [00:02<00:01, 18.13it/s][4/6] extract embeddings:  53%|█████▎    | 36/68 [00:03<00:01, 18.53it/s][4/6] extract embeddings:  56%|█████▌    | 38/68 [00:03<00:01, 18.18it/s][4/6] extract embeddings:  59%|█████▉    | 40/68 [00:03<00:01, 18.10it/s][4/6] extract embeddings:  63%|██████▎   | 43/68 [00:03<00:01, 19.48it/s][4/6] extract embeddings:  68%|██████▊   | 46/68 [00:03<00:01, 20.54it/s][4/6] extract embeddings:  72%|███████▏  | 49/68 [00:03<00:00, 19.42it/s][4/6] extract embeddings:  75%|███████▌  | 51/68 [00:03<00:00, 19.06it/s][4/6] extract embeddings:  78%|███████▊  | 53/68 [00:03<00:00, 18.12it/s][4/6] extract embeddings:  81%|████████  | 55/68 [00:04<00:00, 17.88it/s][4/6] extract embeddings:  84%|████████▍ | 57/68 [00:04<00:00, 17.47it/s][4/6] extract embeddings:  87%|████████▋ | 59/68 [00:04<00:00, 17.12it/s][4/6] extract embeddings:  90%|████████▉ | 61/68 [00:04<00:00, 17.16it/s][4/6] extract embeddings:  93%|█████████▎| 63/68 [00:04<00:00, 17.05it/s][4/6] extract embeddings:  96%|█████████▌| 65/68 [00:04<00:00, 17.10it/s][4/6] extract embeddings:  99%|█████████▊| 67/68 [00:04<00:00, 17.14it/s][4/6] extract embeddings: 100%|██████████| 68/68 [00:04<00:00, 13.94it/s]
[NeMo I 2025-04-17 00:57:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:57:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:57:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:57:20 collections:880] Dataset successfully loaded with 6451 items and total duration provided from manifest is  1.69 hours.
[NeMo I 2025-04-17 00:57:20 collections:886] # 6451 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/101 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/101 [00:01<01:59,  1.19s/it][5/6] extract embeddings:   4%|▍         | 4/101 [00:01<00:25,  3.79it/s][5/6] extract embeddings:   7%|▋         | 7/101 [00:01<00:13,  6.78it/s][5/6] extract embeddings:  10%|▉         | 10/101 [00:01<00:09,  9.91it/s][5/6] extract embeddings:  13%|█▎        | 13/101 [00:01<00:06, 13.08it/s][5/6] extract embeddings:  16%|█▌        | 16/101 [00:01<00:05, 16.06it/s][5/6] extract embeddings:  19%|█▉        | 19/101 [00:01<00:04, 17.96it/s][5/6] extract embeddings:  22%|██▏       | 22/101 [00:02<00:03, 20.43it/s][5/6] extract embeddings:  25%|██▍       | 25/101 [00:02<00:03, 22.09it/s][5/6] extract embeddings:  28%|██▊       | 28/101 [00:02<00:03, 22.96it/s][5/6] extract embeddings:  31%|███       | 31/101 [00:02<00:02, 24.01it/s][5/6] extract embeddings:  34%|███▎      | 34/101 [00:02<00:02, 24.55it/s][5/6] extract embeddings:  37%|███▋      | 37/101 [00:02<00:02, 24.68it/s][5/6] extract embeddings:  40%|███▉      | 40/101 [00:02<00:02, 24.68it/s][5/6] extract embeddings:  43%|████▎     | 43/101 [00:02<00:02, 24.55it/s][5/6] extract embeddings:  46%|████▌     | 46/101 [00:02<00:02, 25.09it/s][5/6] extract embeddings:  49%|████▊     | 49/101 [00:03<00:02, 25.56it/s][5/6] extract embeddings:  51%|█████▏    | 52/101 [00:03<00:02, 24.10it/s][5/6] extract embeddings:  54%|█████▍    | 55/101 [00:03<00:01, 24.85it/s][5/6] extract embeddings:  57%|█████▋    | 58/101 [00:03<00:01, 24.62it/s][5/6] extract embeddings:  60%|██████    | 61/101 [00:03<00:01, 25.55it/s][5/6] extract embeddings:  63%|██████▎   | 64/101 [00:03<00:01, 24.48it/s][5/6] extract embeddings:  66%|██████▋   | 67/101 [00:03<00:01, 24.84it/s][5/6] extract embeddings:  69%|██████▉   | 70/101 [00:03<00:01, 25.35it/s][5/6] extract embeddings:  72%|███████▏  | 73/101 [00:04<00:01, 24.94it/s][5/6] extract embeddings:  75%|███████▌  | 76/101 [00:04<00:01, 22.30it/s][5/6] extract embeddings:  78%|███████▊  | 79/101 [00:04<00:01, 20.59it/s][5/6] extract embeddings:  81%|████████  | 82/101 [00:04<00:00, 19.60it/s][5/6] extract embeddings:  84%|████████▍ | 85/101 [00:04<00:00, 19.41it/s][5/6] extract embeddings:  86%|████████▌ | 87/101 [00:04<00:00, 19.04it/s][5/6] extract embeddings:  88%|████████▊ | 89/101 [00:04<00:00, 18.80it/s][5/6] extract embeddings:  90%|█████████ | 91/101 [00:05<00:00, 18.49it/s][5/6] extract embeddings:  92%|█████████▏| 93/101 [00:05<00:00, 18.63it/s][5/6] extract embeddings:  94%|█████████▍| 95/101 [00:05<00:00, 18.96it/s][5/6] extract embeddings:  96%|█████████▌| 97/101 [00:05<00:00, 18.79it/s][5/6] extract embeddings:  98%|█████████▊| 99/101 [00:05<00:00, 18.60it/s][5/6] extract embeddings: 100%|██████████| 101/101 [00:05<00:00, 18.32it/s][5/6] extract embeddings: 100%|██████████| 101/101 [00:05<00:00, 17.90it/s]
[NeMo I 2025-04-17 00:57:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:57:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:57:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:57:26 collections:880] Dataset successfully loaded with 13154 items and total duration provided from manifest is  1.79 hours.
[NeMo I 2025-04-17 00:57:26 collections:886] # 13154 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/206 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/206 [00:01<04:21,  1.28s/it][6/6] extract embeddings:   2%|▏         | 5/206 [00:01<00:43,  4.59it/s][6/6] extract embeddings:   4%|▍         | 8/206 [00:01<00:27,  7.25it/s][6/6] extract embeddings:   6%|▌         | 12/206 [00:01<00:16, 11.47it/s][6/6] extract embeddings:   7%|▋         | 15/206 [00:01<00:13, 14.28it/s][6/6] extract embeddings:   9%|▉         | 19/206 [00:01<00:10, 17.91it/s][6/6] extract embeddings:  11%|█         | 22/206 [00:02<00:09, 20.23it/s][6/6] extract embeddings:  13%|█▎        | 26/206 [00:02<00:07, 23.56it/s][6/6] extract embeddings:  15%|█▍        | 30/206 [00:02<00:06, 25.45it/s][6/6] extract embeddings:  16%|█▌        | 33/206 [00:02<00:07, 24.70it/s][6/6] extract embeddings:  17%|█▋        | 36/206 [00:02<00:06, 25.27it/s][6/6] extract embeddings:  19%|█▉        | 39/206 [00:02<00:06, 25.16it/s][6/6] extract embeddings:  20%|██        | 42/206 [00:02<00:06, 25.36it/s][6/6] extract embeddings:  22%|██▏       | 45/206 [00:02<00:06, 24.07it/s][6/6] extract embeddings:  23%|██▎       | 48/206 [00:03<00:06, 24.63it/s][6/6] extract embeddings:  25%|██▍       | 51/206 [00:03<00:06, 24.44it/s][6/6] extract embeddings:  26%|██▌       | 54/206 [00:03<00:05, 25.39it/s][6/6] extract embeddings:  28%|██▊       | 57/206 [00:03<00:05, 25.11it/s][6/6] extract embeddings:  29%|██▉       | 60/206 [00:03<00:05, 25.45it/s][6/6] extract embeddings:  31%|███       | 63/206 [00:03<00:05, 25.84it/s][6/6] extract embeddings:  32%|███▏      | 66/206 [00:03<00:05, 26.38it/s][6/6] extract embeddings:  33%|███▎      | 69/206 [00:03<00:05, 25.82it/s][6/6] extract embeddings:  35%|███▍      | 72/206 [00:03<00:05, 26.15it/s][6/6] extract embeddings:  36%|███▋      | 75/206 [00:04<00:04, 26.43it/s][6/6] extract embeddings:  38%|███▊      | 78/206 [00:04<00:05, 25.46it/s][6/6] extract embeddings:  39%|███▉      | 81/206 [00:04<00:04, 25.08it/s][6/6] extract embeddings:  41%|████      | 84/206 [00:04<00:04, 24.88it/s][6/6] extract embeddings:  42%|████▏     | 87/206 [00:04<00:04, 24.33it/s][6/6] extract embeddings:  44%|████▎     | 90/206 [00:04<00:04, 24.78it/s][6/6] extract embeddings:  45%|████▌     | 93/206 [00:04<00:04, 24.36it/s][6/6] extract embeddings:  47%|████▋     | 96/206 [00:04<00:04, 25.35it/s][6/6] extract embeddings:  48%|████▊     | 99/206 [00:05<00:04, 26.32it/s][6/6] extract embeddings:  50%|████▉     | 102/206 [00:05<00:03, 26.02it/s][6/6] extract embeddings:  51%|█████▏    | 106/206 [00:05<00:03, 27.36it/s][6/6] extract embeddings:  53%|█████▎    | 109/206 [00:05<00:03, 26.42it/s][6/6] extract embeddings:  54%|█████▍    | 112/206 [00:05<00:03, 26.27it/s][6/6] extract embeddings:  56%|█████▌    | 115/206 [00:05<00:03, 26.35it/s][6/6] extract embeddings:  57%|█████▋    | 118/206 [00:05<00:03, 26.39it/s][6/6] extract embeddings:  59%|█████▊    | 121/206 [00:05<00:03, 25.68it/s][6/6] extract embeddings:  60%|██████    | 124/206 [00:05<00:03, 26.18it/s][6/6] extract embeddings:  62%|██████▏   | 127/206 [00:06<00:02, 26.39it/s][6/6] extract embeddings:  63%|██████▎   | 130/206 [00:06<00:02, 25.68it/s][6/6] extract embeddings:  65%|██████▍   | 133/206 [00:06<00:02, 25.36it/s][6/6] extract embeddings:  66%|██████▌   | 136/206 [00:06<00:02, 24.97it/s][6/6] extract embeddings:  67%|██████▋   | 139/206 [00:06<00:02, 25.46it/s][6/6] extract embeddings:  69%|██████▉   | 142/206 [00:06<00:02, 25.36it/s][6/6] extract embeddings:  70%|███████   | 145/206 [00:06<00:02, 24.00it/s][6/6] extract embeddings:  72%|███████▏  | 148/206 [00:06<00:02, 24.90it/s][6/6] extract embeddings:  73%|███████▎  | 151/206 [00:07<00:02, 24.93it/s][6/6] extract embeddings:  75%|███████▍  | 154/206 [00:07<00:02, 25.04it/s][6/6] extract embeddings:  76%|███████▌  | 157/206 [00:07<00:02, 24.49it/s][6/6] extract embeddings:  78%|███████▊  | 160/206 [00:07<00:01, 24.40it/s][6/6] extract embeddings:  79%|███████▉  | 163/206 [00:07<00:01, 24.74it/s][6/6] extract embeddings:  81%|████████  | 166/206 [00:07<00:01, 25.31it/s][6/6] extract embeddings:  82%|████████▏ | 169/206 [00:07<00:01, 24.48it/s][6/6] extract embeddings:  83%|████████▎ | 172/206 [00:07<00:01, 24.41it/s][6/6] extract embeddings:  85%|████████▍ | 175/206 [00:08<00:01, 23.79it/s][6/6] extract embeddings:  86%|████████▋ | 178/206 [00:08<00:01, 25.11it/s][6/6] extract embeddings:  88%|████████▊ | 181/206 [00:08<00:00, 25.71it/s][6/6] extract embeddings:  89%|████████▉ | 184/206 [00:08<00:00, 26.18it/s][6/6] extract embeddings:  91%|█████████ | 187/206 [00:08<00:00, 25.80it/s][6/6] extract embeddings:  92%|█████████▏| 190/206 [00:08<00:00, 24.57it/s][6/6] extract embeddings:  94%|█████████▎| 193/206 [00:08<00:00, 25.61it/s][6/6] extract embeddings:  95%|█████████▌| 196/206 [00:08<00:00, 26.25it/s][6/6] extract embeddings:  97%|█████████▋| 199/206 [00:08<00:00, 25.67it/s][6/6] extract embeddings:  98%|█████████▊| 202/206 [00:09<00:00, 25.21it/s][6/6] extract embeddings: 100%|█████████▉| 205/206 [00:09<00:00, 25.87it/s][6/6] extract embeddings: 100%|██████████| 206/206 [00:09<00:00, 22.26it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.85it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.24it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.80it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.34it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s]
[NeMo I 2025-04-17 00:57:38 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:57:39 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              39.891302   444.120  ...   17.285007  3.891968
    Harker-ES                       31.947695  2178.782  ...   66.301926  3.043073
    Harker-MN                       43.377697   366.767  ...   26.601988  7.253103
    Longfellow-Block-1              26.638330   492.417  ...   13.046978  2.649579
    TOTAL                           33.413954  3482.086  ...  123.235899  3.539140
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:57:39 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0791 | MISS: 0.2196 | CER: 0.0354 | DER: 0.3341 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:02<00:07,  2.54s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:04<00:04,  2.24s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.41s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:05<00:00,  1.02s/it]Processing Audio: 100%|██████████| 4/4 [00:05<00:00,  1.35s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:58:06 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:58:06 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:58:06 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:58:06 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:58:06 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:58:07 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:58:07 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:58:07 features:305] PADDING: 16
[NeMo I 2025-04-17 00:58:07 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:58:07 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:58:07 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:58:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:58:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:58:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:58:07 collections:880] Dataset successfully loaded with 2184 items and total duration provided from manifest is  1.35 hours.
[NeMo I 2025-04-17 00:58:07 collections:886] # 2184 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:17,  2.26s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:14,  2.18it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:08,  3.47it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:05,  5.00it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.55it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  8.02it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:03<00:02,  9.60it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:03<00:01, 11.07it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 12.45it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 12.60it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:00, 13.25it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 14.29it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 14.52it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:03<00:00, 14.95it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:04<00:00, 15.17it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:04<00:00, 14.14it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 14.72it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  7.99it/s]
[NeMo I 2025-04-17 00:58:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:58:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:58:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:58:12 collections:880] Dataset successfully loaded with 2541 items and total duration provided from manifest is  1.40 hours.
[NeMo I 2025-04-17 00:58:12 collections:886] # 2541 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:56,  1.44s/it][2/6] extract embeddings:   8%|▊         | 3/40 [00:01<00:15,  2.38it/s][2/6] extract embeddings:  12%|█▎        | 5/40 [00:01<00:08,  4.13it/s][2/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:05,  6.07it/s][2/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  8.09it/s][2/6] extract embeddings:  28%|██▊       | 11/40 [00:02<00:02,  9.94it/s][2/6] extract embeddings:  32%|███▎      | 13/40 [00:02<00:02, 11.35it/s][2/6] extract embeddings:  38%|███▊      | 15/40 [00:02<00:01, 12.54it/s][2/6] extract embeddings:  42%|████▎     | 17/40 [00:02<00:01, 13.82it/s][2/6] extract embeddings:  48%|████▊     | 19/40 [00:02<00:01, 14.94it/s][2/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 15.32it/s][2/6] extract embeddings:  57%|█████▊    | 23/40 [00:02<00:01, 15.98it/s][2/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:00, 15.76it/s][2/6] extract embeddings:  68%|██████▊   | 27/40 [00:02<00:00, 16.83it/s][2/6] extract embeddings:  72%|███████▎  | 29/40 [00:03<00:00, 16.95it/s][2/6] extract embeddings:  78%|███████▊  | 31/40 [00:03<00:00, 16.70it/s][2/6] extract embeddings:  82%|████████▎ | 33/40 [00:03<00:00, 16.75it/s][2/6] extract embeddings:  88%|████████▊ | 35/40 [00:03<00:00, 16.77it/s][2/6] extract embeddings:  92%|█████████▎| 37/40 [00:03<00:00, 16.54it/s][2/6] extract embeddings:  98%|█████████▊| 39/40 [00:03<00:00, 15.97it/s][2/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 10.50it/s]
[NeMo I 2025-04-17 00:58:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:58:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:58:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:58:16 collections:880] Dataset successfully loaded with 3119 items and total duration provided from manifest is  1.46 hours.
[NeMo I 2025-04-17 00:58:16 collections:886] # 3119 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/49 [00:01<00:58,  1.22s/it][3/6] extract embeddings:   6%|▌         | 3/49 [00:01<00:16,  2.82it/s][3/6] extract embeddings:  10%|█         | 5/49 [00:01<00:08,  4.92it/s][3/6] extract embeddings:  14%|█▍        | 7/49 [00:01<00:05,  7.05it/s][3/6] extract embeddings:  18%|█▊        | 9/49 [00:01<00:04,  9.25it/s][3/6] extract embeddings:  22%|██▏       | 11/49 [00:01<00:03, 10.96it/s][3/6] extract embeddings:  27%|██▋       | 13/49 [00:01<00:02, 12.47it/s][3/6] extract embeddings:  31%|███       | 15/49 [00:02<00:02, 13.02it/s][3/6] extract embeddings:  35%|███▍      | 17/49 [00:02<00:02, 14.38it/s][3/6] extract embeddings:  39%|███▉      | 19/49 [00:02<00:01, 15.45it/s][3/6] extract embeddings:  43%|████▎     | 21/49 [00:02<00:01, 16.27it/s][3/6] extract embeddings:  47%|████▋     | 23/49 [00:02<00:01, 16.73it/s][3/6] extract embeddings:  51%|█████     | 25/49 [00:02<00:01, 17.24it/s][3/6] extract embeddings:  55%|█████▌    | 27/49 [00:02<00:01, 17.06it/s][3/6] extract embeddings:  59%|█████▉    | 29/49 [00:02<00:01, 16.78it/s][3/6] extract embeddings:  63%|██████▎   | 31/49 [00:02<00:01, 17.09it/s][3/6] extract embeddings:  67%|██████▋   | 33/49 [00:03<00:00, 17.66it/s][3/6] extract embeddings:  73%|███████▎  | 36/49 [00:03<00:00, 17.62it/s][3/6] extract embeddings:  78%|███████▊  | 38/49 [00:03<00:00, 17.64it/s][3/6] extract embeddings:  82%|████████▏ | 40/49 [00:03<00:00, 17.36it/s][3/6] extract embeddings:  86%|████████▌ | 42/49 [00:03<00:00, 16.46it/s][3/6] extract embeddings:  90%|████████▉ | 44/49 [00:03<00:00, 16.74it/s][3/6] extract embeddings:  94%|█████████▍| 46/49 [00:03<00:00, 16.78it/s][3/6] extract embeddings:  98%|█████████▊| 48/49 [00:03<00:00, 16.20it/s][3/6] extract embeddings: 100%|██████████| 49/49 [00:04<00:00, 12.15it/s]
[NeMo I 2025-04-17 00:58:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:58:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:58:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:58:20 collections:880] Dataset successfully loaded with 4121 items and total duration provided from manifest is  1.53 hours.
[NeMo I 2025-04-17 00:58:20 collections:886] # 4121 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/65 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/65 [00:01<01:19,  1.24s/it][4/6] extract embeddings:   5%|▍         | 3/65 [00:01<00:22,  2.76it/s][4/6] extract embeddings:   8%|▊         | 5/65 [00:01<00:12,  4.83it/s][4/6] extract embeddings:  11%|█         | 7/65 [00:01<00:08,  7.05it/s][4/6] extract embeddings:  14%|█▍        | 9/65 [00:01<00:06,  9.24it/s][4/6] extract embeddings:  17%|█▋        | 11/65 [00:01<00:04, 11.23it/s][4/6] extract embeddings:  20%|██        | 13/65 [00:01<00:04, 12.95it/s][4/6] extract embeddings:  23%|██▎       | 15/65 [00:02<00:03, 14.45it/s][4/6] extract embeddings:  26%|██▌       | 17/65 [00:02<00:03, 15.57it/s][4/6] extract embeddings:  31%|███       | 20/65 [00:02<00:02, 17.16it/s][4/6] extract embeddings:  35%|███▌      | 23/65 [00:02<00:02, 17.83it/s][4/6] extract embeddings:  38%|███▊      | 25/65 [00:02<00:02, 18.34it/s][4/6] extract embeddings:  42%|████▏     | 27/65 [00:02<00:02, 17.86it/s][4/6] extract embeddings:  45%|████▍     | 29/65 [00:02<00:01, 18.22it/s][4/6] extract embeddings:  48%|████▊     | 31/65 [00:02<00:01, 18.31it/s][4/6] extract embeddings:  51%|█████     | 33/65 [00:02<00:01, 18.31it/s][4/6] extract embeddings:  55%|█████▌    | 36/65 [00:03<00:01, 19.06it/s][4/6] extract embeddings:  60%|██████    | 39/65 [00:03<00:01, 19.55it/s][4/6] extract embeddings:  63%|██████▎   | 41/65 [00:03<00:01, 19.04it/s][4/6] extract embeddings:  66%|██████▌   | 43/65 [00:03<00:01, 19.17it/s][4/6] extract embeddings:  69%|██████▉   | 45/65 [00:03<00:01, 18.76it/s][4/6] extract embeddings:  72%|███████▏  | 47/65 [00:03<00:00, 18.66it/s][4/6] extract embeddings:  75%|███████▌  | 49/65 [00:03<00:00, 18.78it/s][4/6] extract embeddings:  78%|███████▊  | 51/65 [00:03<00:00, 18.58it/s][4/6] extract embeddings:  82%|████████▏ | 53/65 [00:04<00:00, 18.89it/s][4/6] extract embeddings:  85%|████████▍ | 55/65 [00:04<00:00, 18.58it/s][4/6] extract embeddings:  88%|████████▊ | 57/65 [00:04<00:00, 18.20it/s][4/6] extract embeddings:  91%|█████████ | 59/65 [00:04<00:00, 18.36it/s][4/6] extract embeddings:  94%|█████████▍| 61/65 [00:04<00:00, 17.99it/s][4/6] extract embeddings:  97%|█████████▋| 63/65 [00:04<00:00, 17.68it/s][4/6] extract embeddings: 100%|██████████| 65/65 [00:04<00:00, 13.87it/s]
[NeMo I 2025-04-17 00:58:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:58:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:58:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:58:25 collections:880] Dataset successfully loaded with 6194 items and total duration provided from manifest is  1.61 hours.
[NeMo I 2025-04-17 00:58:25 collections:886] # 6194 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/97 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/97 [00:01<01:56,  1.21s/it][5/6] extract embeddings:   4%|▍         | 4/97 [00:01<00:24,  3.79it/s][5/6] extract embeddings:   6%|▌         | 6/97 [00:01<00:15,  5.83it/s][5/6] extract embeddings:   9%|▉         | 9/97 [00:01<00:09,  9.12it/s][5/6] extract embeddings:  12%|█▏        | 12/97 [00:01<00:06, 12.15it/s][5/6] extract embeddings:  15%|█▌        | 15/97 [00:01<00:05, 14.32it/s][5/6] extract embeddings:  19%|█▊        | 18/97 [00:01<00:04, 16.48it/s][5/6] extract embeddings:  22%|██▏       | 21/97 [00:02<00:03, 19.01it/s][5/6] extract embeddings:  25%|██▍       | 24/97 [00:02<00:03, 20.49it/s][5/6] extract embeddings:  28%|██▊       | 27/97 [00:02<00:03, 20.79it/s][5/6] extract embeddings:  31%|███       | 30/97 [00:02<00:03, 22.03it/s][5/6] extract embeddings:  34%|███▍      | 33/97 [00:02<00:02, 22.24it/s][5/6] extract embeddings:  37%|███▋      | 36/97 [00:02<00:02, 21.67it/s][5/6] extract embeddings:  40%|████      | 39/97 [00:02<00:02, 21.75it/s][5/6] extract embeddings:  43%|████▎     | 42/97 [00:03<00:02, 22.20it/s][5/6] extract embeddings:  46%|████▋     | 45/97 [00:03<00:02, 22.16it/s][5/6] extract embeddings:  49%|████▉     | 48/97 [00:03<00:02, 21.91it/s][5/6] extract embeddings:  53%|█████▎    | 51/97 [00:03<00:02, 22.17it/s][5/6] extract embeddings:  56%|█████▌    | 54/97 [00:03<00:01, 22.14it/s][5/6] extract embeddings:  59%|█████▉    | 57/97 [00:03<00:01, 21.94it/s][5/6] extract embeddings:  62%|██████▏   | 60/97 [00:03<00:01, 22.24it/s][5/6] extract embeddings:  65%|██████▍   | 63/97 [00:03<00:01, 21.50it/s][5/6] extract embeddings:  68%|██████▊   | 66/97 [00:04<00:01, 20.01it/s][5/6] extract embeddings:  71%|███████   | 69/97 [00:04<00:01, 21.42it/s][5/6] extract embeddings:  74%|███████▍  | 72/97 [00:04<00:01, 21.24it/s][5/6] extract embeddings:  77%|███████▋  | 75/97 [00:04<00:01, 21.57it/s][5/6] extract embeddings:  80%|████████  | 78/97 [00:04<00:00, 22.52it/s][5/6] extract embeddings:  84%|████████▎ | 81/97 [00:04<00:00, 22.21it/s][5/6] extract embeddings:  87%|████████▋ | 84/97 [00:04<00:00, 22.25it/s][5/6] extract embeddings:  90%|████████▉ | 87/97 [00:05<00:00, 21.95it/s][5/6] extract embeddings:  93%|█████████▎| 90/97 [00:05<00:00, 22.58it/s][5/6] extract embeddings:  96%|█████████▌| 93/97 [00:05<00:00, 23.07it/s][5/6] extract embeddings:  99%|█████████▉| 96/97 [00:05<00:00, 23.37it/s][5/6] extract embeddings: 100%|██████████| 97/97 [00:05<00:00, 17.58it/s]
[NeMo I 2025-04-17 00:58:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:58:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:58:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:58:31 collections:880] Dataset successfully loaded with 12647 items and total duration provided from manifest is  1.71 hours.
[NeMo I 2025-04-17 00:58:31 collections:886] # 12647 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/198 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/198 [00:01<03:54,  1.19s/it][6/6] extract embeddings:   2%|▏         | 4/198 [00:01<00:49,  3.96it/s][6/6] extract embeddings:   4%|▎         | 7/198 [00:01<00:25,  7.38it/s][6/6] extract embeddings:   6%|▌         | 11/198 [00:01<00:15, 12.32it/s][6/6] extract embeddings:   8%|▊         | 15/198 [00:01<00:10, 16.72it/s][6/6] extract embeddings:   9%|▉         | 18/198 [00:01<00:09, 19.26it/s][6/6] extract embeddings:  11%|█         | 21/198 [00:01<00:08, 21.33it/s][6/6] extract embeddings:  13%|█▎        | 25/198 [00:01<00:06, 24.84it/s][6/6] extract embeddings:  15%|█▍        | 29/198 [00:02<00:06, 26.15it/s][6/6] extract embeddings:  17%|█▋        | 33/198 [00:02<00:06, 27.34it/s][6/6] extract embeddings:  19%|█▊        | 37/198 [00:02<00:05, 29.33it/s][6/6] extract embeddings:  21%|██        | 41/198 [00:02<00:05, 26.23it/s][6/6] extract embeddings:  22%|██▏       | 44/198 [00:02<00:06, 24.48it/s][6/6] extract embeddings:  24%|██▎       | 47/198 [00:02<00:06, 23.14it/s][6/6] extract embeddings:  25%|██▌       | 50/198 [00:02<00:06, 22.27it/s][6/6] extract embeddings:  27%|██▋       | 53/198 [00:03<00:06, 21.63it/s][6/6] extract embeddings:  28%|██▊       | 56/198 [00:03<00:06, 21.79it/s][6/6] extract embeddings:  30%|██▉       | 59/198 [00:03<00:06, 21.01it/s][6/6] extract embeddings:  31%|███▏      | 62/198 [00:03<00:06, 21.29it/s][6/6] extract embeddings:  33%|███▎      | 65/198 [00:03<00:06, 21.47it/s][6/6] extract embeddings:  34%|███▍      | 68/198 [00:03<00:06, 21.13it/s][6/6] extract embeddings:  36%|███▌      | 71/198 [00:03<00:06, 20.57it/s][6/6] extract embeddings:  37%|███▋      | 74/198 [00:04<00:05, 20.77it/s][6/6] extract embeddings:  39%|███▉      | 77/198 [00:04<00:05, 20.95it/s][6/6] extract embeddings:  40%|████      | 80/198 [00:04<00:05, 21.07it/s][6/6] extract embeddings:  42%|████▏     | 83/198 [00:04<00:05, 19.66it/s][6/6] extract embeddings:  43%|████▎     | 85/198 [00:04<00:05, 19.69it/s][6/6] extract embeddings:  44%|████▍     | 88/198 [00:04<00:05, 20.37it/s][6/6] extract embeddings:  46%|████▌     | 91/198 [00:04<00:05, 20.04it/s][6/6] extract embeddings:  47%|████▋     | 94/198 [00:05<00:04, 20.88it/s][6/6] extract embeddings:  49%|████▉     | 97/198 [00:05<00:04, 21.23it/s][6/6] extract embeddings:  51%|█████     | 100/198 [00:05<00:04, 21.68it/s][6/6] extract embeddings:  52%|█████▏    | 103/198 [00:05<00:04, 20.36it/s][6/6] extract embeddings:  54%|█████▎    | 106/198 [00:05<00:04, 20.15it/s][6/6] extract embeddings:  55%|█████▌    | 109/198 [00:05<00:04, 20.30it/s][6/6] extract embeddings:  57%|█████▋    | 112/198 [00:05<00:04, 20.18it/s][6/6] extract embeddings:  58%|█████▊    | 115/198 [00:06<00:04, 20.04it/s][6/6] extract embeddings:  60%|█████▉    | 118/198 [00:06<00:03, 20.10it/s][6/6] extract embeddings:  61%|██████    | 121/198 [00:06<00:03, 19.69it/s][6/6] extract embeddings:  63%|██████▎   | 124/198 [00:06<00:03, 20.30it/s][6/6] extract embeddings:  64%|██████▍   | 127/198 [00:06<00:03, 19.85it/s][6/6] extract embeddings:  66%|██████▌   | 130/198 [00:06<00:03, 20.64it/s][6/6] extract embeddings:  68%|██████▊   | 134/198 [00:07<00:02, 23.62it/s][6/6] extract embeddings:  70%|██████▉   | 138/198 [00:07<00:02, 25.83it/s][6/6] extract embeddings:  72%|███████▏  | 142/198 [00:07<00:02, 27.66it/s][6/6] extract embeddings:  73%|███████▎  | 145/198 [00:07<00:01, 28.03it/s][6/6] extract embeddings:  75%|███████▌  | 149/198 [00:07<00:01, 29.30it/s][6/6] extract embeddings:  77%|███████▋  | 153/198 [00:07<00:01, 30.05it/s][6/6] extract embeddings:  79%|███████▉  | 157/198 [00:07<00:01, 31.23it/s][6/6] extract embeddings:  81%|████████▏ | 161/198 [00:07<00:01, 31.51it/s][6/6] extract embeddings:  83%|████████▎ | 165/198 [00:07<00:01, 32.65it/s][6/6] extract embeddings:  85%|████████▌ | 169/198 [00:08<00:00, 32.88it/s][6/6] extract embeddings:  87%|████████▋ | 173/198 [00:08<00:00, 31.46it/s][6/6] extract embeddings:  89%|████████▉ | 177/198 [00:08<00:00, 31.02it/s][6/6] extract embeddings:  91%|█████████▏| 181/198 [00:08<00:00, 32.00it/s][6/6] extract embeddings:  93%|█████████▎| 185/198 [00:08<00:00, 32.11it/s][6/6] extract embeddings:  95%|█████████▌| 189/198 [00:08<00:00, 32.47it/s][6/6] extract embeddings:  97%|█████████▋| 193/198 [00:08<00:00, 31.59it/s][6/6] extract embeddings:  99%|█████████▉| 197/198 [00:08<00:00, 32.16it/s][6/6] extract embeddings: 100%|██████████| 198/198 [00:09<00:00, 21.95it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.85it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.34it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.94it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.52it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.12it/s]
[NeMo I 2025-04-17 00:58:42 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:58:43 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              40.477783   444.120  ...   13.160075  2.963180
    Harker-ES                       33.611246  2178.782  ...   55.145977  2.531046
    Harker-MN                       45.365345   366.767  ...   27.789021  7.576751
    Longfellow-Block-1              28.437459   492.417  ...    9.277010  1.883974
    TOTAL                           34.993441  3482.086  ...  105.372083  3.026119
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:58:43 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0746 | MISS: 0.2450 | CER: 0.0303 | DER: 0.3499 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.97s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.98s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.27s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.20s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:58:57 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:58:57 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:58:57 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:58:57 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:58:57 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:58:57 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:58:57 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:58:57 features:305] PADDING: 16
[NeMo I 2025-04-17 00:58:57 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:58:57 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:58:58 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:58:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:58:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:58:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:58:58 collections:880] Dataset successfully loaded with 2113 items and total duration provided from manifest is  1.22 hours.
[NeMo I 2025-04-17 00:58:58 collections:886] # 2113 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:02<01:07,  2.04s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.39it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.79it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.47it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.02it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  8.72it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.63it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 11.64it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:03<00:01, 12.69it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:01, 13.63it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 14.18it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 15.16it/s][1/6] extract embeddings:  76%|███████▋  | 26/34 [00:03<00:00, 14.98it/s][1/6] extract embeddings:  82%|████████▏ | 28/34 [00:03<00:00, 14.85it/s][1/6] extract embeddings:  88%|████████▊ | 30/34 [00:03<00:00, 15.21it/s][1/6] extract embeddings:  94%|█████████▍| 32/34 [00:03<00:00, 15.77it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:04<00:00,  6.02it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:04<00:00,  7.19it/s]
[NeMo I 2025-04-17 00:59:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:59:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:59:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:59:02 collections:880] Dataset successfully loaded with 2444 items and total duration provided from manifest is  1.28 hours.
[NeMo I 2025-04-17 00:59:02 collections:886] # 2444 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/39 [00:01<01:03,  1.67s/it][2/6] extract embeddings:   8%|▊         | 3/39 [00:01<00:17,  2.09it/s][2/6] extract embeddings:  13%|█▎        | 5/39 [00:01<00:09,  3.69it/s][2/6] extract embeddings:  18%|█▊        | 7/39 [00:02<00:05,  5.55it/s][2/6] extract embeddings:  23%|██▎       | 9/39 [00:02<00:03,  7.50it/s][2/6] extract embeddings:  28%|██▊       | 11/39 [00:02<00:02,  9.40it/s][2/6] extract embeddings:  33%|███▎      | 13/39 [00:02<00:02, 10.85it/s][2/6] extract embeddings:  38%|███▊      | 15/39 [00:02<00:01, 12.62it/s][2/6] extract embeddings:  44%|████▎     | 17/39 [00:02<00:01, 13.92it/s][2/6] extract embeddings:  49%|████▊     | 19/39 [00:02<00:01, 15.07it/s][2/6] extract embeddings:  54%|█████▍    | 21/39 [00:02<00:01, 15.86it/s][2/6] extract embeddings:  59%|█████▉    | 23/39 [00:02<00:00, 16.30it/s][2/6] extract embeddings:  64%|██████▍   | 25/39 [00:03<00:00, 16.85it/s][2/6] extract embeddings:  69%|██████▉   | 27/39 [00:03<00:00, 17.00it/s][2/6] extract embeddings:  74%|███████▍  | 29/39 [00:03<00:00, 16.87it/s][2/6] extract embeddings:  79%|███████▉  | 31/39 [00:03<00:00, 17.16it/s][2/6] extract embeddings:  85%|████████▍ | 33/39 [00:03<00:00, 16.23it/s][2/6] extract embeddings:  90%|████████▉ | 35/39 [00:03<00:00, 16.74it/s][2/6] extract embeddings:  95%|█████████▍| 37/39 [00:03<00:00, 17.06it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:03<00:00, 10.04it/s]
[NeMo I 2025-04-17 00:59:06 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:59:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:59:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:59:07 collections:880] Dataset successfully loaded with 2955 items and total duration provided from manifest is  1.33 hours.
[NeMo I 2025-04-17 00:59:07 collections:886] # 2955 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/47 [00:01<01:03,  1.38s/it][3/6] extract embeddings:   6%|▋         | 3/47 [00:01<00:17,  2.51it/s][3/6] extract embeddings:  11%|█         | 5/47 [00:01<00:09,  4.36it/s][3/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:06,  6.37it/s][3/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:03,  9.41it/s][3/6] extract embeddings:  26%|██▌       | 12/47 [00:02<00:03, 11.09it/s][3/6] extract embeddings:  30%|██▉       | 14/47 [00:02<00:02, 12.61it/s][3/6] extract embeddings:  36%|███▌      | 17/47 [00:02<00:02, 14.60it/s][3/6] extract embeddings:  40%|████      | 19/47 [00:02<00:01, 15.61it/s][3/6] extract embeddings:  45%|████▍     | 21/47 [00:02<00:01, 16.45it/s][3/6] extract embeddings:  51%|█████     | 24/47 [00:02<00:01, 17.31it/s][3/6] extract embeddings:  55%|█████▌    | 26/47 [00:02<00:01, 17.08it/s][3/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:01, 17.45it/s][3/6] extract embeddings:  64%|██████▍   | 30/47 [00:02<00:00, 17.84it/s][3/6] extract embeddings:  68%|██████▊   | 32/47 [00:03<00:00, 18.11it/s][3/6] extract embeddings:  72%|███████▏  | 34/47 [00:03<00:00, 18.03it/s][3/6] extract embeddings:  77%|███████▋  | 36/47 [00:03<00:00, 17.98it/s][3/6] extract embeddings:  81%|████████  | 38/47 [00:03<00:00, 17.23it/s][3/6] extract embeddings:  85%|████████▌ | 40/47 [00:03<00:00, 17.87it/s][3/6] extract embeddings:  89%|████████▉ | 42/47 [00:03<00:00, 17.78it/s][3/6] extract embeddings:  94%|█████████▎| 44/47 [00:03<00:00, 17.72it/s][3/6] extract embeddings:  98%|█████████▊| 46/47 [00:03<00:00, 18.34it/s][3/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 12.02it/s]
[NeMo I 2025-04-17 00:59:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:59:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:59:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:59:11 collections:880] Dataset successfully loaded with 3893 items and total duration provided from manifest is  1.41 hours.
[NeMo I 2025-04-17 00:59:11 collections:886] # 3893 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/61 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/61 [00:01<01:24,  1.40s/it][4/6] extract embeddings:   5%|▍         | 3/61 [00:01<00:23,  2.49it/s][4/6] extract embeddings:   8%|▊         | 5/61 [00:01<00:12,  4.43it/s][4/6] extract embeddings:  13%|█▎        | 8/61 [00:01<00:07,  7.54it/s][4/6] extract embeddings:  16%|█▋        | 10/61 [00:01<00:05,  9.37it/s][4/6] extract embeddings:  20%|█▉        | 12/61 [00:01<00:04, 11.11it/s][4/6] extract embeddings:  23%|██▎       | 14/61 [00:02<00:03, 12.54it/s][4/6] extract embeddings:  26%|██▌       | 16/61 [00:02<00:03, 14.01it/s][4/6] extract embeddings:  30%|██▉       | 18/61 [00:02<00:02, 15.28it/s][4/6] extract embeddings:  33%|███▎      | 20/61 [00:02<00:02, 15.76it/s][4/6] extract embeddings:  36%|███▌      | 22/61 [00:02<00:02, 15.83it/s][4/6] extract embeddings:  39%|███▉      | 24/61 [00:02<00:02, 15.46it/s][4/6] extract embeddings:  44%|████▍     | 27/61 [00:02<00:01, 17.01it/s][4/6] extract embeddings:  48%|████▊     | 29/61 [00:02<00:01, 17.46it/s][4/6] extract embeddings:  51%|█████     | 31/61 [00:03<00:01, 17.40it/s][4/6] extract embeddings:  54%|█████▍    | 33/61 [00:03<00:01, 16.72it/s][4/6] extract embeddings:  57%|█████▋    | 35/61 [00:03<00:01, 16.03it/s][4/6] extract embeddings:  61%|██████    | 37/61 [00:03<00:01, 16.78it/s][4/6] extract embeddings:  64%|██████▍   | 39/61 [00:03<00:01, 17.34it/s][4/6] extract embeddings:  67%|██████▋   | 41/61 [00:03<00:01, 17.59it/s][4/6] extract embeddings:  72%|███████▏  | 44/61 [00:03<00:00, 18.62it/s][4/6] extract embeddings:  75%|███████▌  | 46/61 [00:03<00:00, 18.07it/s][4/6] extract embeddings:  80%|████████  | 49/61 [00:04<00:00, 18.80it/s][4/6] extract embeddings:  85%|████████▌ | 52/61 [00:04<00:00, 19.45it/s][4/6] extract embeddings:  90%|█████████ | 55/61 [00:04<00:00, 19.86it/s][4/6] extract embeddings:  93%|█████████▎| 57/61 [00:04<00:00, 19.19it/s][4/6] extract embeddings:  97%|█████████▋| 59/61 [00:04<00:00, 18.83it/s][4/6] extract embeddings: 100%|██████████| 61/61 [00:04<00:00, 18.92it/s][4/6] extract embeddings: 100%|██████████| 61/61 [00:04<00:00, 12.93it/s]
[NeMo I 2025-04-17 00:59:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 00:59:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:59:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:59:16 collections:880] Dataset successfully loaded with 5824 items and total duration provided from manifest is  1.50 hours.
[NeMo I 2025-04-17 00:59:16 collections:886] # 5824 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/91 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/91 [00:01<01:51,  1.23s/it][5/6] extract embeddings:   4%|▍         | 4/91 [00:01<00:23,  3.72it/s][5/6] extract embeddings:   8%|▊         | 7/91 [00:01<00:12,  6.81it/s][5/6] extract embeddings:  11%|█         | 10/91 [00:01<00:08,  9.67it/s][5/6] extract embeddings:  14%|█▍        | 13/91 [00:01<00:06, 12.26it/s][5/6] extract embeddings:  18%|█▊        | 16/91 [00:01<00:05, 14.51it/s][5/6] extract embeddings:  21%|██        | 19/91 [00:02<00:04, 16.06it/s][5/6] extract embeddings:  24%|██▍       | 22/91 [00:02<00:04, 17.23it/s][5/6] extract embeddings:  27%|██▋       | 25/91 [00:02<00:03, 18.28it/s][5/6] extract embeddings:  31%|███       | 28/91 [00:02<00:03, 18.89it/s][5/6] extract embeddings:  34%|███▍      | 31/91 [00:02<00:03, 19.65it/s][5/6] extract embeddings:  37%|███▋      | 34/91 [00:02<00:02, 19.80it/s][5/6] extract embeddings:  41%|████      | 37/91 [00:02<00:02, 20.79it/s][5/6] extract embeddings:  44%|████▍     | 40/91 [00:03<00:02, 20.67it/s][5/6] extract embeddings:  47%|████▋     | 43/91 [00:03<00:02, 20.85it/s][5/6] extract embeddings:  51%|█████     | 46/91 [00:03<00:02, 20.29it/s][5/6] extract embeddings:  54%|█████▍    | 49/91 [00:03<00:02, 21.00it/s][5/6] extract embeddings:  57%|█████▋    | 52/91 [00:03<00:01, 21.11it/s][5/6] extract embeddings:  60%|██████    | 55/91 [00:03<00:01, 21.63it/s][5/6] extract embeddings:  64%|██████▎   | 58/91 [00:03<00:01, 21.55it/s][5/6] extract embeddings:  67%|██████▋   | 61/91 [00:04<00:01, 21.92it/s][5/6] extract embeddings:  70%|███████   | 64/91 [00:04<00:01, 22.04it/s][5/6] extract embeddings:  74%|███████▎  | 67/91 [00:04<00:01, 21.17it/s][5/6] extract embeddings:  77%|███████▋  | 70/91 [00:04<00:00, 21.03it/s][5/6] extract embeddings:  80%|████████  | 73/91 [00:04<00:00, 21.24it/s][5/6] extract embeddings:  84%|████████▎ | 76/91 [00:04<00:00, 20.75it/s][5/6] extract embeddings:  87%|████████▋ | 79/91 [00:04<00:00, 20.77it/s][5/6] extract embeddings:  90%|█████████ | 82/91 [00:05<00:00, 20.12it/s][5/6] extract embeddings:  93%|█████████▎| 85/91 [00:05<00:00, 21.03it/s][5/6] extract embeddings:  97%|█████████▋| 88/91 [00:05<00:00, 20.79it/s][5/6] extract embeddings: 100%|██████████| 91/91 [00:05<00:00, 20.47it/s][5/6] extract embeddings: 100%|██████████| 91/91 [00:05<00:00, 16.52it/s]
[NeMo I 2025-04-17 00:59:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 00:59:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:59:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:59:21 collections:880] Dataset successfully loaded with 11894 items and total duration provided from manifest is  1.60 hours.
[NeMo I 2025-04-17 00:59:21 collections:886] # 11894 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/186 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/186 [00:01<03:38,  1.18s/it][6/6] extract embeddings:   2%|▏         | 4/186 [00:01<00:45,  3.96it/s][6/6] extract embeddings:   4%|▍         | 7/186 [00:01<00:24,  7.20it/s][6/6] extract embeddings:   5%|▌         | 10/186 [00:01<00:17, 10.21it/s][6/6] extract embeddings:   7%|▋         | 13/186 [00:01<00:13, 13.22it/s][6/6] extract embeddings:   9%|▊         | 16/186 [00:01<00:10, 16.09it/s][6/6] extract embeddings:  10%|█         | 19/186 [00:01<00:09, 18.27it/s][6/6] extract embeddings:  12%|█▏        | 22/186 [00:02<00:08, 20.15it/s][6/6] extract embeddings:  13%|█▎        | 25/186 [00:02<00:07, 20.34it/s][6/6] extract embeddings:  15%|█▌        | 28/186 [00:02<00:07, 21.86it/s][6/6] extract embeddings:  17%|█▋        | 31/186 [00:02<00:06, 22.32it/s][6/6] extract embeddings:  18%|█▊        | 34/186 [00:02<00:06, 22.86it/s][6/6] extract embeddings:  20%|█▉        | 37/186 [00:02<00:06, 23.93it/s][6/6] extract embeddings:  22%|██▏       | 40/186 [00:02<00:05, 25.23it/s][6/6] extract embeddings:  23%|██▎       | 43/186 [00:02<00:05, 24.79it/s][6/6] extract embeddings:  25%|██▍       | 46/186 [00:02<00:05, 24.55it/s][6/6] extract embeddings:  26%|██▋       | 49/186 [00:03<00:06, 22.81it/s][6/6] extract embeddings:  28%|██▊       | 52/186 [00:03<00:05, 23.44it/s][6/6] extract embeddings:  30%|██▉       | 55/186 [00:03<00:05, 23.87it/s][6/6] extract embeddings:  31%|███       | 58/186 [00:03<00:05, 25.18it/s][6/6] extract embeddings:  33%|███▎      | 61/186 [00:03<00:04, 25.13it/s][6/6] extract embeddings:  34%|███▍      | 64/186 [00:03<00:04, 25.34it/s][6/6] extract embeddings:  36%|███▌      | 67/186 [00:03<00:04, 26.00it/s][6/6] extract embeddings:  38%|███▊      | 70/186 [00:03<00:04, 27.02it/s][6/6] extract embeddings:  39%|███▉      | 73/186 [00:04<00:04, 27.28it/s][6/6] extract embeddings:  41%|████      | 76/186 [00:04<00:04, 26.89it/s][6/6] extract embeddings:  42%|████▏     | 79/186 [00:04<00:03, 27.15it/s][6/6] extract embeddings:  45%|████▍     | 83/186 [00:04<00:03, 29.12it/s][6/6] extract embeddings:  46%|████▌     | 86/186 [00:04<00:03, 28.53it/s][6/6] extract embeddings:  48%|████▊     | 89/186 [00:04<00:03, 25.95it/s][6/6] extract embeddings:  49%|████▉     | 92/186 [00:04<00:03, 25.69it/s][6/6] extract embeddings:  51%|█████     | 95/186 [00:04<00:03, 26.27it/s][6/6] extract embeddings:  53%|█████▎    | 98/186 [00:04<00:03, 25.77it/s][6/6] extract embeddings:  54%|█████▍    | 101/186 [00:05<00:03, 25.04it/s][6/6] extract embeddings:  56%|█████▌    | 104/186 [00:05<00:03, 25.63it/s][6/6] extract embeddings:  58%|█████▊    | 107/186 [00:05<00:02, 26.45it/s][6/6] extract embeddings:  59%|█████▉    | 110/186 [00:05<00:02, 26.98it/s][6/6] extract embeddings:  61%|██████    | 113/186 [00:05<00:02, 25.85it/s][6/6] extract embeddings:  62%|██████▏   | 116/186 [00:05<00:02, 26.85it/s][6/6] extract embeddings:  64%|██████▍   | 119/186 [00:05<00:02, 27.33it/s][6/6] extract embeddings:  66%|██████▌   | 122/186 [00:05<00:02, 27.76it/s][6/6] extract embeddings:  67%|██████▋   | 125/186 [00:05<00:02, 27.61it/s][6/6] extract embeddings:  69%|██████▉   | 128/186 [00:06<00:02, 26.77it/s][6/6] extract embeddings:  70%|███████   | 131/186 [00:06<00:02, 25.23it/s][6/6] extract embeddings:  72%|███████▏  | 134/186 [00:06<00:01, 26.13it/s][6/6] extract embeddings:  74%|███████▍  | 138/186 [00:06<00:01, 27.62it/s][6/6] extract embeddings:  76%|███████▋  | 142/186 [00:06<00:01, 29.17it/s][6/6] extract embeddings:  78%|███████▊  | 146/186 [00:06<00:01, 30.53it/s][6/6] extract embeddings:  81%|████████  | 150/186 [00:06<00:01, 31.52it/s][6/6] extract embeddings:  83%|████████▎ | 154/186 [00:06<00:01, 31.65it/s][6/6] extract embeddings:  85%|████████▍ | 158/186 [00:07<00:00, 30.74it/s][6/6] extract embeddings:  87%|████████▋ | 162/186 [00:07<00:00, 27.13it/s][6/6] extract embeddings:  89%|████████▊ | 165/186 [00:07<00:00, 27.23it/s][6/6] extract embeddings:  90%|█████████ | 168/186 [00:07<00:00, 25.14it/s][6/6] extract embeddings:  92%|█████████▏| 171/186 [00:07<00:00, 23.87it/s][6/6] extract embeddings:  94%|█████████▎| 174/186 [00:07<00:00, 22.45it/s][6/6] extract embeddings:  95%|█████████▌| 177/186 [00:07<00:00, 21.98it/s][6/6] extract embeddings:  97%|█████████▋| 180/186 [00:08<00:00, 21.42it/s][6/6] extract embeddings:  98%|█████████▊| 183/186 [00:08<00:00, 21.90it/s][6/6] extract embeddings: 100%|██████████| 186/186 [00:08<00:00, 20.70it/s][6/6] extract embeddings: 100%|██████████| 186/186 [00:08<00:00, 22.02it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.94it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.45it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.08it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.73it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.29it/s]
[NeMo I 2025-04-17 00:59:32 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 00:59:33 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              43.764013   444.120  ...   15.395029  3.466412
    Harker-ES                       36.926417  2178.782  ...   61.717797  2.832674
    Harker-MN                       46.771694   366.767  ...   30.551038  8.329822
    Longfellow-Block-1              31.490945   492.417  ...    7.783982  1.580770
    TOTAL                           38.066859  3482.086  ...  115.447846  3.315479
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 00:59:33 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0669 | MISS: 0.2806 | CER: 0.0332 | DER: 0.3807 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.10
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.1 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.89s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:04,  2.01s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.29s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.05it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.21s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 00:59:46 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 00:59:46 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 00:59:46 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 00:59:46 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 00:59:46 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 00:59:46 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 00:59:46 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 00:59:46 features:305] PADDING: 16
[NeMo I 2025-04-17 00:59:47 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 00:59:47 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 00:59:47 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 00:59:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 00:59:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:59:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:59:47 collections:880] Dataset successfully loaded with 2050 items and total duration provided from manifest is  1.09 hours.
[NeMo I 2025-04-17 00:59:47 collections:886] # 2050 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:07,  2.11s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:12,  2.32it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:07,  3.66it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.10it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  6.57it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  7.99it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01,  9.61it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:03<00:01, 10.79it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:03<00:01, 12.10it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:03<00:01, 12.72it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 13.53it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 13.69it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 14.14it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 14.24it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 14.19it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:04<00:00, 14.30it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:04<00:00,  7.88it/s]
[NeMo I 2025-04-17 00:59:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 00:59:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:59:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:59:51 collections:880] Dataset successfully loaded with 2339 items and total duration provided from manifest is  1.15 hours.
[NeMo I 2025-04-17 00:59:51 collections:886] # 2339 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:52,  1.45s/it][2/6] extract embeddings:   8%|▊         | 3/37 [00:01<00:14,  2.41it/s][2/6] extract embeddings:  14%|█▎        | 5/37 [00:01<00:07,  4.28it/s][2/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  6.16it/s][2/6] extract embeddings:  24%|██▍       | 9/37 [00:01<00:03,  7.85it/s][2/6] extract embeddings:  30%|██▉       | 11/37 [00:02<00:02,  9.22it/s][2/6] extract embeddings:  35%|███▌      | 13/37 [00:02<00:02, 10.20it/s][2/6] extract embeddings:  41%|████      | 15/37 [00:02<00:01, 11.62it/s][2/6] extract embeddings:  49%|████▊     | 18/37 [00:02<00:01, 13.53it/s][2/6] extract embeddings:  54%|█████▍    | 20/37 [00:02<00:01, 14.53it/s][2/6] extract embeddings:  59%|█████▉    | 22/37 [00:02<00:00, 15.44it/s][2/6] extract embeddings:  68%|██████▊   | 25/37 [00:02<00:00, 16.92it/s][2/6] extract embeddings:  73%|███████▎  | 27/37 [00:03<00:00, 16.46it/s][2/6] extract embeddings:  78%|███████▊  | 29/37 [00:03<00:00, 17.08it/s][2/6] extract embeddings:  84%|████████▍ | 31/37 [00:03<00:00, 17.20it/s][2/6] extract embeddings:  89%|████████▉ | 33/37 [00:03<00:00, 16.71it/s][2/6] extract embeddings:  95%|█████████▍| 35/37 [00:03<00:00, 16.09it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 10.17it/s]
[NeMo I 2025-04-17 00:59:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 00:59:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:59:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:59:55 collections:880] Dataset successfully loaded with 2798 items and total duration provided from manifest is  1.21 hours.
[NeMo I 2025-04-17 00:59:55 collections:886] # 2798 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:52,  1.23s/it][3/6] extract embeddings:   9%|▉         | 4/44 [00:01<00:10,  3.64it/s][3/6] extract embeddings:  14%|█▎        | 6/44 [00:01<00:06,  5.60it/s][3/6] extract embeddings:  20%|██        | 9/44 [00:01<00:04,  8.55it/s][3/6] extract embeddings:  25%|██▌       | 11/44 [00:01<00:03, 10.13it/s][3/6] extract embeddings:  32%|███▏      | 14/44 [00:01<00:02, 12.58it/s][3/6] extract embeddings:  39%|███▊      | 17/44 [00:02<00:01, 14.59it/s][3/6] extract embeddings:  45%|████▌     | 20/44 [00:02<00:01, 16.30it/s][3/6] extract embeddings:  52%|█████▏    | 23/44 [00:02<00:01, 17.52it/s][3/6] extract embeddings:  57%|█████▋    | 25/44 [00:02<00:01, 17.70it/s][3/6] extract embeddings:  61%|██████▏   | 27/44 [00:02<00:00, 17.89it/s][3/6] extract embeddings:  66%|██████▌   | 29/44 [00:02<00:00, 18.16it/s][3/6] extract embeddings:  70%|███████   | 31/44 [00:02<00:00, 18.59it/s][3/6] extract embeddings:  75%|███████▌  | 33/44 [00:02<00:00, 17.98it/s][3/6] extract embeddings:  82%|████████▏ | 36/44 [00:03<00:00, 18.75it/s][3/6] extract embeddings:  86%|████████▋ | 38/44 [00:03<00:00, 19.01it/s][3/6] extract embeddings:  91%|█████████ | 40/44 [00:03<00:00, 18.82it/s][3/6] extract embeddings:  98%|█████████▊| 43/44 [00:03<00:00, 19.52it/s][3/6] extract embeddings: 100%|██████████| 44/44 [00:03<00:00, 12.71it/s]
[NeMo I 2025-04-17 00:59:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 00:59:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 00:59:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 00:59:59 collections:880] Dataset successfully loaded with 3626 items and total duration provided from manifest is  1.28 hours.
[NeMo I 2025-04-17 00:59:59 collections:886] # 3626 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/57 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/57 [00:01<01:08,  1.22s/it][4/6] extract embeddings:   7%|▋         | 4/57 [00:01<00:14,  3.68it/s][4/6] extract embeddings:  12%|█▏        | 7/57 [00:01<00:07,  6.63it/s][4/6] extract embeddings:  18%|█▊        | 10/57 [00:01<00:04,  9.55it/s][4/6] extract embeddings:  23%|██▎       | 13/57 [00:01<00:03, 12.16it/s][4/6] extract embeddings:  26%|██▋       | 15/57 [00:01<00:03, 13.11it/s][4/6] extract embeddings:  30%|██▉       | 17/57 [00:02<00:02, 14.33it/s][4/6] extract embeddings:  33%|███▎      | 19/57 [00:02<00:02, 15.30it/s][4/6] extract embeddings:  37%|███▋      | 21/57 [00:02<00:02, 15.51it/s][4/6] extract embeddings:  42%|████▏     | 24/57 [00:02<00:01, 17.68it/s][4/6] extract embeddings:  46%|████▌     | 26/57 [00:02<00:01, 18.09it/s][4/6] extract embeddings:  51%|█████     | 29/57 [00:02<00:01, 19.19it/s][4/6] extract embeddings:  56%|█████▌    | 32/57 [00:02<00:01, 18.79it/s][4/6] extract embeddings:  60%|█████▉    | 34/57 [00:02<00:01, 18.17it/s][4/6] extract embeddings:  65%|██████▍   | 37/57 [00:03<00:01, 18.78it/s][4/6] extract embeddings:  68%|██████▊   | 39/57 [00:03<00:00, 18.21it/s][4/6] extract embeddings:  72%|███████▏  | 41/57 [00:03<00:00, 18.11it/s][4/6] extract embeddings:  75%|███████▌  | 43/57 [00:03<00:00, 18.30it/s][4/6] extract embeddings:  81%|████████  | 46/57 [00:03<00:00, 19.02it/s][4/6] extract embeddings:  86%|████████▌ | 49/57 [00:03<00:00, 19.43it/s][4/6] extract embeddings:  91%|█████████ | 52/57 [00:03<00:00, 19.50it/s][4/6] extract embeddings:  95%|█████████▍| 54/57 [00:03<00:00, 19.36it/s][4/6] extract embeddings:  98%|█████████▊| 56/57 [00:04<00:00, 18.59it/s][4/6] extract embeddings: 100%|██████████| 57/57 [00:04<00:00, 13.81it/s]
[NeMo I 2025-04-17 01:00:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:00:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:00:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:00:03 collections:880] Dataset successfully loaded with 5416 items and total duration provided from manifest is  1.37 hours.
[NeMo I 2025-04-17 01:00:03 collections:886] # 5416 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/85 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/85 [00:01<01:54,  1.36s/it][5/6] extract embeddings:   5%|▍         | 4/85 [00:01<00:23,  3.42it/s][5/6] extract embeddings:   7%|▋         | 6/85 [00:01<00:14,  5.32it/s][5/6] extract embeddings:  11%|█         | 9/85 [00:01<00:08,  8.50it/s][5/6] extract embeddings:  14%|█▍        | 12/85 [00:01<00:06, 11.40it/s][5/6] extract embeddings:  18%|█▊        | 15/85 [00:01<00:05, 13.82it/s][5/6] extract embeddings:  21%|██        | 18/85 [00:02<00:04, 16.11it/s][5/6] extract embeddings:  25%|██▍       | 21/85 [00:02<00:03, 17.56it/s][5/6] extract embeddings:  28%|██▊       | 24/85 [00:02<00:03, 18.44it/s][5/6] extract embeddings:  32%|███▏      | 27/85 [00:02<00:02, 19.63it/s][5/6] extract embeddings:  35%|███▌      | 30/85 [00:02<00:02, 19.46it/s][5/6] extract embeddings:  39%|███▉      | 33/85 [00:02<00:02, 20.04it/s][5/6] extract embeddings:  42%|████▏     | 36/85 [00:02<00:02, 20.16it/s][5/6] extract embeddings:  46%|████▌     | 39/85 [00:03<00:02, 21.54it/s][5/6] extract embeddings:  49%|████▉     | 42/85 [00:03<00:01, 22.20it/s][5/6] extract embeddings:  53%|█████▎    | 45/85 [00:03<00:01, 22.09it/s][5/6] extract embeddings:  56%|█████▋    | 48/85 [00:03<00:01, 21.40it/s][5/6] extract embeddings:  60%|██████    | 51/85 [00:03<00:01, 21.66it/s][5/6] extract embeddings:  64%|██████▎   | 54/85 [00:03<00:01, 21.74it/s][5/6] extract embeddings:  67%|██████▋   | 57/85 [00:03<00:01, 23.09it/s][5/6] extract embeddings:  71%|███████   | 60/85 [00:04<00:01, 22.26it/s][5/6] extract embeddings:  74%|███████▍  | 63/85 [00:04<00:00, 23.12it/s][5/6] extract embeddings:  78%|███████▊  | 66/85 [00:04<00:00, 23.66it/s][5/6] extract embeddings:  81%|████████  | 69/85 [00:04<00:00, 23.70it/s][5/6] extract embeddings:  85%|████████▍ | 72/85 [00:04<00:00, 23.37it/s][5/6] extract embeddings:  88%|████████▊ | 75/85 [00:04<00:00, 23.98it/s][5/6] extract embeddings:  92%|█████████▏| 78/85 [00:04<00:00, 24.82it/s][5/6] extract embeddings:  95%|█████████▌| 81/85 [00:04<00:00, 25.48it/s][5/6] extract embeddings:  99%|█████████▉| 84/85 [00:04<00:00, 25.43it/s][5/6] extract embeddings: 100%|██████████| 85/85 [00:05<00:00, 16.81it/s]
[NeMo I 2025-04-17 01:00:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:00:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:00:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:00:08 collections:880] Dataset successfully loaded with 11025 items and total duration provided from manifest is  1.48 hours.
[NeMo I 2025-04-17 01:00:08 collections:886] # 11025 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/173 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/173 [00:01<03:45,  1.31s/it][6/6] extract embeddings:   2%|▏         | 4/173 [00:01<00:46,  3.64it/s][6/6] extract embeddings:   3%|▎         | 6/173 [00:01<00:29,  5.63it/s][6/6] extract embeddings:   5%|▌         | 9/173 [00:01<00:19,  8.62it/s][6/6] extract embeddings:   7%|▋         | 12/173 [00:01<00:13, 11.57it/s][6/6] extract embeddings:   9%|▊         | 15/173 [00:01<00:11, 14.36it/s][6/6] extract embeddings:  10%|█         | 18/173 [00:02<00:09, 16.78it/s][6/6] extract embeddings:  12%|█▏        | 21/173 [00:02<00:08, 18.74it/s][6/6] extract embeddings:  14%|█▍        | 24/173 [00:02<00:07, 20.97it/s][6/6] extract embeddings:  16%|█▌        | 27/173 [00:02<00:07, 20.67it/s][6/6] extract embeddings:  17%|█▋        | 30/173 [00:02<00:06, 22.71it/s][6/6] extract embeddings:  19%|█▉        | 33/173 [00:02<00:05, 24.18it/s][6/6] extract embeddings:  21%|██        | 36/173 [00:02<00:05, 24.65it/s][6/6] extract embeddings:  23%|██▎       | 39/173 [00:02<00:05, 24.19it/s][6/6] extract embeddings:  24%|██▍       | 42/173 [00:02<00:05, 24.68it/s][6/6] extract embeddings:  26%|██▌       | 45/173 [00:03<00:05, 24.73it/s][6/6] extract embeddings:  28%|██▊       | 48/173 [00:03<00:05, 23.69it/s][6/6] extract embeddings:  29%|██▉       | 51/173 [00:03<00:05, 22.32it/s][6/6] extract embeddings:  31%|███       | 54/173 [00:03<00:05, 22.53it/s][6/6] extract embeddings:  33%|███▎      | 57/173 [00:03<00:05, 22.89it/s][6/6] extract embeddings:  35%|███▍      | 60/173 [00:03<00:04, 24.03it/s][6/6] extract embeddings:  36%|███▋      | 63/173 [00:03<00:04, 24.36it/s][6/6] extract embeddings:  38%|███▊      | 66/173 [00:04<00:04, 24.51it/s][6/6] extract embeddings:  40%|███▉      | 69/173 [00:04<00:04, 24.36it/s][6/6] extract embeddings:  42%|████▏     | 72/173 [00:04<00:04, 24.43it/s][6/6] extract embeddings:  43%|████▎     | 75/173 [00:04<00:03, 24.78it/s][6/6] extract embeddings:  45%|████▌     | 78/173 [00:04<00:03, 24.27it/s][6/6] extract embeddings:  47%|████▋     | 81/173 [00:04<00:03, 23.87it/s][6/6] extract embeddings:  49%|████▊     | 84/173 [00:04<00:03, 23.92it/s][6/6] extract embeddings:  50%|█████     | 87/173 [00:04<00:03, 25.01it/s][6/6] extract embeddings:  52%|█████▏    | 90/173 [00:04<00:03, 25.53it/s][6/6] extract embeddings:  54%|█████▍    | 93/173 [00:05<00:03, 24.71it/s][6/6] extract embeddings:  55%|█████▌    | 96/173 [00:05<00:03, 24.93it/s][6/6] extract embeddings:  57%|█████▋    | 99/173 [00:05<00:02, 24.96it/s][6/6] extract embeddings:  59%|█████▉    | 102/173 [00:05<00:03, 23.24it/s][6/6] extract embeddings:  61%|██████    | 105/173 [00:05<00:02, 24.08it/s][6/6] extract embeddings:  62%|██████▏   | 108/173 [00:05<00:02, 24.58it/s][6/6] extract embeddings:  64%|██████▍   | 111/173 [00:05<00:02, 24.23it/s][6/6] extract embeddings:  66%|██████▌   | 114/173 [00:05<00:02, 23.93it/s][6/6] extract embeddings:  68%|██████▊   | 117/173 [00:06<00:02, 24.53it/s][6/6] extract embeddings:  69%|██████▉   | 120/173 [00:06<00:02, 24.92it/s][6/6] extract embeddings:  71%|███████   | 123/173 [00:06<00:01, 25.19it/s][6/6] extract embeddings:  73%|███████▎  | 126/173 [00:06<00:01, 25.00it/s][6/6] extract embeddings:  75%|███████▍  | 129/173 [00:06<00:01, 23.93it/s][6/6] extract embeddings:  77%|███████▋  | 133/173 [00:06<00:01, 24.97it/s][6/6] extract embeddings:  79%|███████▊  | 136/173 [00:06<00:01, 24.61it/s][6/6] extract embeddings:  80%|████████  | 139/173 [00:06<00:01, 25.11it/s][6/6] extract embeddings:  82%|████████▏ | 142/173 [00:07<00:01, 25.08it/s][6/6] extract embeddings:  84%|████████▍ | 145/173 [00:07<00:01, 24.57it/s][6/6] extract embeddings:  86%|████████▌ | 148/173 [00:07<00:01, 24.36it/s][6/6] extract embeddings:  87%|████████▋ | 151/173 [00:07<00:00, 25.09it/s][6/6] extract embeddings:  89%|████████▉ | 154/173 [00:07<00:00, 25.62it/s][6/6] extract embeddings:  91%|█████████ | 157/173 [00:07<00:00, 25.18it/s][6/6] extract embeddings:  92%|█████████▏| 160/173 [00:07<00:00, 25.38it/s][6/6] extract embeddings:  94%|█████████▍| 163/173 [00:07<00:00, 25.79it/s][6/6] extract embeddings:  96%|█████████▌| 166/173 [00:08<00:00, 25.57it/s][6/6] extract embeddings:  98%|█████████▊| 169/173 [00:08<00:00, 24.82it/s][6/6] extract embeddings:  99%|█████████▉| 172/173 [00:08<00:00, 23.69it/s][6/6] extract embeddings: 100%|██████████| 173/173 [00:08<00:00, 20.67it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.24it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.70it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.36it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.48it/s]
[NeMo I 2025-04-17 01:00:19 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:00:20 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              46.282445   444.120  ...   17.560012  3.953889
    Harker-ES                       40.766494  2178.782  ...   49.678225  2.280092
    Harker-MN                       49.577335   366.767  ...   29.839091  8.135708
    Longfellow-Block-1              35.352732   492.417  ...    8.902980  1.808016
    TOTAL                           41.632481  3482.086  ...  105.980308  3.043587
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:00:20 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0602 | MISS: 0.3257 | CER: 0.0304 | DER: 0.4163 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.30, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.3, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.84s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:00:32 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:00:32 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:00:32 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:00:32 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:00:32 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:00:33 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:00:33 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:00:33 features:305] PADDING: 16
[NeMo I 2025-04-17 01:00:33 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:00:33 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:00:33 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:00:33 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:00:33 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:00:33 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:00:33 collections:880] Dataset successfully loaded with 2410 items and total duration provided from manifest is  1.67 hours.
[NeMo I 2025-04-17 01:00:33 collections:886] # 2410 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/38 [00:02<01:17,  2.08s/it][1/6] extract embeddings:  11%|█         | 4/38 [00:02<00:14,  2.35it/s][1/6] extract embeddings:  16%|█▌        | 6/38 [00:02<00:08,  3.65it/s][1/6] extract embeddings:  21%|██        | 8/38 [00:02<00:05,  5.11it/s][1/6] extract embeddings:  26%|██▋       | 10/38 [00:02<00:04,  6.49it/s][1/6] extract embeddings:  32%|███▏      | 12/38 [00:02<00:03,  7.88it/s][1/6] extract embeddings:  37%|███▋      | 14/38 [00:02<00:02,  9.25it/s][1/6] extract embeddings:  42%|████▏     | 16/38 [00:03<00:02, 10.09it/s][1/6] extract embeddings:  47%|████▋     | 18/38 [00:03<00:01, 11.21it/s][1/6] extract embeddings:  53%|█████▎    | 20/38 [00:03<00:01, 11.65it/s][1/6] extract embeddings:  58%|█████▊    | 22/38 [00:03<00:01, 12.32it/s][1/6] extract embeddings:  63%|██████▎   | 24/38 [00:03<00:01, 12.76it/s][1/6] extract embeddings:  68%|██████▊   | 26/38 [00:03<00:00, 13.41it/s][1/6] extract embeddings:  74%|███████▎  | 28/38 [00:03<00:00, 13.28it/s][1/6] extract embeddings:  79%|███████▉  | 30/38 [00:04<00:00, 13.39it/s][1/6] extract embeddings:  84%|████████▍ | 32/38 [00:04<00:00, 13.30it/s][1/6] extract embeddings:  89%|████████▉ | 34/38 [00:04<00:00, 13.38it/s][1/6] extract embeddings:  95%|█████████▍| 36/38 [00:04<00:00, 13.05it/s][1/6] extract embeddings: 100%|██████████| 38/38 [00:04<00:00, 14.38it/s][1/6] extract embeddings: 100%|██████████| 38/38 [00:04<00:00,  8.09it/s]
[NeMo I 2025-04-17 01:00:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:00:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:00:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:00:38 collections:880] Dataset successfully loaded with 2867 items and total duration provided from manifest is  1.72 hours.
[NeMo I 2025-04-17 01:00:38 collections:886] # 2867 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/45 [00:01<01:04,  1.46s/it][2/6] extract embeddings:   7%|▋         | 3/45 [00:01<00:17,  2.37it/s][2/6] extract embeddings:  11%|█         | 5/45 [00:01<00:09,  4.19it/s][2/6] extract embeddings:  16%|█▌        | 7/45 [00:01<00:06,  6.04it/s][2/6] extract embeddings:  20%|██        | 9/45 [00:01<00:04,  7.81it/s][2/6] extract embeddings:  24%|██▍       | 11/45 [00:02<00:03,  9.16it/s][2/6] extract embeddings:  29%|██▉       | 13/45 [00:02<00:03, 10.53it/s][2/6] extract embeddings:  33%|███▎      | 15/45 [00:02<00:02, 11.22it/s][2/6] extract embeddings:  38%|███▊      | 17/45 [00:02<00:02, 11.83it/s][2/6] extract embeddings:  42%|████▏     | 19/45 [00:02<00:02, 12.68it/s][2/6] extract embeddings:  47%|████▋     | 21/45 [00:02<00:01, 13.35it/s][2/6] extract embeddings:  51%|█████     | 23/45 [00:02<00:01, 13.74it/s][2/6] extract embeddings:  56%|█████▌    | 25/45 [00:03<00:01, 14.44it/s][2/6] extract embeddings:  60%|██████    | 27/45 [00:03<00:01, 14.27it/s][2/6] extract embeddings:  64%|██████▍   | 29/45 [00:03<00:01, 14.58it/s][2/6] extract embeddings:  69%|██████▉   | 31/45 [00:03<00:00, 15.20it/s][2/6] extract embeddings:  73%|███████▎  | 33/45 [00:03<00:00, 14.77it/s][2/6] extract embeddings:  78%|███████▊  | 35/45 [00:03<00:00, 14.36it/s][2/6] extract embeddings:  82%|████████▏ | 37/45 [00:03<00:00, 14.47it/s][2/6] extract embeddings:  87%|████████▋ | 39/45 [00:04<00:00, 14.65it/s][2/6] extract embeddings:  91%|█████████ | 41/45 [00:04<00:00, 14.95it/s][2/6] extract embeddings:  96%|█████████▌| 43/45 [00:04<00:00, 14.64it/s][2/6] extract embeddings: 100%|██████████| 45/45 [00:04<00:00, 15.32it/s][2/6] extract embeddings: 100%|██████████| 45/45 [00:04<00:00, 10.11it/s]
[NeMo I 2025-04-17 01:00:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:00:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:00:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:00:43 collections:880] Dataset successfully loaded with 3552 items and total duration provided from manifest is  1.77 hours.
[NeMo I 2025-04-17 01:00:43 collections:886] # 3552 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/56 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/56 [00:01<01:06,  1.21s/it][3/6] extract embeddings:   7%|▋         | 4/56 [00:01<00:14,  3.68it/s][3/6] extract embeddings:  11%|█         | 6/56 [00:01<00:08,  5.70it/s][3/6] extract embeddings:  14%|█▍        | 8/56 [00:01<00:06,  7.62it/s][3/6] extract embeddings:  18%|█▊        | 10/56 [00:01<00:04,  9.34it/s][3/6] extract embeddings:  21%|██▏       | 12/56 [00:01<00:03, 11.25it/s][3/6] extract embeddings:  25%|██▌       | 14/56 [00:01<00:03, 12.44it/s][3/6] extract embeddings:  29%|██▊       | 16/56 [00:02<00:02, 13.56it/s][3/6] extract embeddings:  32%|███▏      | 18/56 [00:02<00:02, 14.59it/s][3/6] extract embeddings:  36%|███▌      | 20/56 [00:02<00:02, 15.26it/s][3/6] extract embeddings:  39%|███▉      | 22/56 [00:02<00:02, 15.72it/s][3/6] extract embeddings:  43%|████▎     | 24/56 [00:02<00:01, 16.08it/s][3/6] extract embeddings:  46%|████▋     | 26/56 [00:02<00:01, 16.10it/s][3/6] extract embeddings:  50%|█████     | 28/56 [00:02<00:01, 16.59it/s][3/6] extract embeddings:  54%|█████▎    | 30/56 [00:02<00:01, 16.02it/s][3/6] extract embeddings:  57%|█████▋    | 32/56 [00:03<00:01, 16.48it/s][3/6] extract embeddings:  61%|██████    | 34/56 [00:03<00:01, 16.70it/s][3/6] extract embeddings:  64%|██████▍   | 36/56 [00:03<00:01, 16.69it/s][3/6] extract embeddings:  68%|██████▊   | 38/56 [00:03<00:01, 16.52it/s][3/6] extract embeddings:  71%|███████▏  | 40/56 [00:03<00:00, 16.54it/s][3/6] extract embeddings:  75%|███████▌  | 42/56 [00:03<00:00, 16.44it/s][3/6] extract embeddings:  79%|███████▊  | 44/56 [00:03<00:00, 16.28it/s][3/6] extract embeddings:  82%|████████▏ | 46/56 [00:03<00:00, 16.00it/s][3/6] extract embeddings:  86%|████████▌ | 48/56 [00:03<00:00, 16.50it/s][3/6] extract embeddings:  89%|████████▉ | 50/56 [00:04<00:00, 16.79it/s][3/6] extract embeddings:  93%|█████████▎| 52/56 [00:04<00:00, 16.61it/s][3/6] extract embeddings:  96%|█████████▋| 54/56 [00:04<00:00, 16.72it/s][3/6] extract embeddings: 100%|██████████| 56/56 [00:04<00:00, 12.59it/s]
[NeMo I 2025-04-17 01:00:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:00:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:00:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:00:47 collections:880] Dataset successfully loaded with 4737 items and total duration provided from manifest is  1.83 hours.
[NeMo I 2025-04-17 01:00:47 collections:886] # 4737 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/75 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/75 [00:01<01:28,  1.19s/it][4/6] extract embeddings:   4%|▍         | 3/75 [00:01<00:24,  2.88it/s][4/6] extract embeddings:   7%|▋         | 5/75 [00:01<00:13,  5.03it/s][4/6] extract embeddings:   9%|▉         | 7/75 [00:01<00:09,  7.13it/s][4/6] extract embeddings:  12%|█▏        | 9/75 [00:01<00:07,  9.37it/s][4/6] extract embeddings:  15%|█▍        | 11/75 [00:01<00:05, 11.47it/s][4/6] extract embeddings:  17%|█▋        | 13/75 [00:01<00:04, 13.23it/s][4/6] extract embeddings:  20%|██        | 15/75 [00:01<00:04, 14.53it/s][4/6] extract embeddings:  23%|██▎       | 17/75 [00:02<00:03, 15.52it/s][4/6] extract embeddings:  25%|██▌       | 19/75 [00:02<00:03, 16.17it/s][4/6] extract embeddings:  28%|██▊       | 21/75 [00:02<00:03, 17.00it/s][4/6] extract embeddings:  31%|███       | 23/75 [00:02<00:02, 17.63it/s][4/6] extract embeddings:  33%|███▎      | 25/75 [00:02<00:02, 17.48it/s][4/6] extract embeddings:  36%|███▌      | 27/75 [00:02<00:02, 17.75it/s][4/6] extract embeddings:  39%|███▊      | 29/75 [00:02<00:02, 17.58it/s][4/6] extract embeddings:  41%|████▏     | 31/75 [00:02<00:02, 17.66it/s][4/6] extract embeddings:  44%|████▍     | 33/75 [00:02<00:02, 17.97it/s][4/6] extract embeddings:  48%|████▊     | 36/75 [00:03<00:02, 19.20it/s][4/6] extract embeddings:  51%|█████     | 38/75 [00:03<00:01, 18.85it/s][4/6] extract embeddings:  55%|█████▍    | 41/75 [00:03<00:01, 19.53it/s][4/6] extract embeddings:  57%|█████▋    | 43/75 [00:03<00:01, 19.21it/s][4/6] extract embeddings:  61%|██████▏   | 46/75 [00:03<00:01, 19.74it/s][4/6] extract embeddings:  65%|██████▌   | 49/75 [00:03<00:01, 21.09it/s][4/6] extract embeddings:  69%|██████▉   | 52/75 [00:03<00:01, 21.60it/s][4/6] extract embeddings:  73%|███████▎  | 55/75 [00:03<00:00, 21.65it/s][4/6] extract embeddings:  77%|███████▋  | 58/75 [00:04<00:00, 19.92it/s][4/6] extract embeddings:  81%|████████▏ | 61/75 [00:04<00:00, 18.96it/s][4/6] extract embeddings:  84%|████████▍ | 63/75 [00:04<00:00, 18.68it/s][4/6] extract embeddings:  87%|████████▋ | 65/75 [00:04<00:00, 18.07it/s][4/6] extract embeddings:  89%|████████▉ | 67/75 [00:04<00:00, 17.44it/s][4/6] extract embeddings:  92%|█████████▏| 69/75 [00:04<00:00, 17.11it/s][4/6] extract embeddings:  95%|█████████▍| 71/75 [00:04<00:00, 17.23it/s][4/6] extract embeddings:  97%|█████████▋| 73/75 [00:05<00:00, 17.36it/s][4/6] extract embeddings: 100%|██████████| 75/75 [00:05<00:00, 17.80it/s][4/6] extract embeddings: 100%|██████████| 75/75 [00:05<00:00, 14.48it/s]
[NeMo I 2025-04-17 01:00:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:00:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:00:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:00:53 collections:880] Dataset successfully loaded with 7143 items and total duration provided from manifest is  1.90 hours.
[NeMo I 2025-04-17 01:00:53 collections:886] # 7143 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/112 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/112 [00:01<02:14,  1.21s/it][5/6] extract embeddings:   4%|▎         | 4/112 [00:01<00:28,  3.83it/s][5/6] extract embeddings:   6%|▋         | 7/112 [00:01<00:15,  6.97it/s][5/6] extract embeddings:   9%|▉         | 10/112 [00:01<00:09, 10.27it/s][5/6] extract embeddings:  12%|█▏        | 13/112 [00:01<00:07, 13.29it/s][5/6] extract embeddings:  14%|█▍        | 16/112 [00:01<00:06, 15.83it/s][5/6] extract embeddings:  17%|█▋        | 19/112 [00:01<00:05, 16.98it/s][5/6] extract embeddings:  20%|█▉        | 22/112 [00:02<00:05, 17.90it/s][5/6] extract embeddings:  22%|██▏       | 25/112 [00:02<00:04, 19.22it/s][5/6] extract embeddings:  25%|██▌       | 28/112 [00:02<00:04, 19.84it/s][5/6] extract embeddings:  28%|██▊       | 31/112 [00:02<00:03, 20.80it/s][5/6] extract embeddings:  30%|███       | 34/112 [00:02<00:03, 20.85it/s][5/6] extract embeddings:  33%|███▎      | 37/112 [00:02<00:03, 21.72it/s][5/6] extract embeddings:  36%|███▌      | 40/112 [00:02<00:03, 22.62it/s][5/6] extract embeddings:  38%|███▊      | 43/112 [00:03<00:03, 22.44it/s][5/6] extract embeddings:  41%|████      | 46/112 [00:03<00:02, 22.70it/s][5/6] extract embeddings:  44%|████▍     | 49/112 [00:03<00:02, 22.35it/s][5/6] extract embeddings:  46%|████▋     | 52/112 [00:03<00:02, 21.77it/s][5/6] extract embeddings:  49%|████▉     | 55/112 [00:03<00:02, 20.89it/s][5/6] extract embeddings:  52%|█████▏    | 58/112 [00:03<00:02, 20.65it/s][5/6] extract embeddings:  54%|█████▍    | 61/112 [00:03<00:02, 21.04it/s][5/6] extract embeddings:  57%|█████▋    | 64/112 [00:04<00:02, 21.18it/s][5/6] extract embeddings:  60%|█████▉    | 67/112 [00:04<00:02, 20.83it/s][5/6] extract embeddings:  62%|██████▎   | 70/112 [00:04<00:01, 21.62it/s][5/6] extract embeddings:  65%|██████▌   | 73/112 [00:04<00:01, 21.38it/s][5/6] extract embeddings:  68%|██████▊   | 76/112 [00:04<00:01, 21.04it/s][5/6] extract embeddings:  71%|███████   | 79/112 [00:04<00:01, 21.21it/s][5/6] extract embeddings:  73%|███████▎  | 82/112 [00:04<00:01, 21.29it/s][5/6] extract embeddings:  76%|███████▌  | 85/112 [00:04<00:01, 22.20it/s][5/6] extract embeddings:  79%|███████▊  | 88/112 [00:05<00:01, 20.99it/s][5/6] extract embeddings:  81%|████████▏ | 91/112 [00:05<00:00, 21.35it/s][5/6] extract embeddings:  84%|████████▍ | 94/112 [00:05<00:00, 21.58it/s][5/6] extract embeddings:  87%|████████▋ | 97/112 [00:05<00:00, 21.33it/s][5/6] extract embeddings:  89%|████████▉ | 100/112 [00:05<00:00, 21.67it/s][5/6] extract embeddings:  92%|█████████▏| 103/112 [00:05<00:00, 21.64it/s][5/6] extract embeddings:  95%|█████████▍| 106/112 [00:05<00:00, 21.59it/s][5/6] extract embeddings:  97%|█████████▋| 109/112 [00:06<00:00, 21.36it/s][5/6] extract embeddings: 100%|██████████| 112/112 [00:06<00:00, 22.36it/s][5/6] extract embeddings: 100%|██████████| 112/112 [00:06<00:00, 17.84it/s]
[NeMo I 2025-04-17 01:00:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:00:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:00:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:00:59 collections:880] Dataset successfully loaded with 14508 items and total duration provided from manifest is  1.98 hours.
[NeMo I 2025-04-17 01:00:59 collections:886] # 14508 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/227 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/227 [00:01<04:43,  1.25s/it][6/6] extract embeddings:   2%|▏         | 4/227 [00:01<00:59,  3.75it/s][6/6] extract embeddings:   3%|▎         | 7/227 [00:01<00:31,  6.92it/s][6/6] extract embeddings:   4%|▍         | 10/227 [00:01<00:21, 10.08it/s][6/6] extract embeddings:   6%|▌         | 13/227 [00:01<00:16, 13.28it/s][6/6] extract embeddings:   7%|▋         | 16/227 [00:01<00:13, 15.40it/s][6/6] extract embeddings:   8%|▊         | 19/227 [00:01<00:11, 17.68it/s][6/6] extract embeddings:  10%|▉         | 22/227 [00:02<00:10, 19.39it/s][6/6] extract embeddings:  11%|█▏        | 26/227 [00:02<00:08, 22.38it/s][6/6] extract embeddings:  13%|█▎        | 29/227 [00:02<00:08, 23.16it/s][6/6] extract embeddings:  14%|█▍        | 32/227 [00:02<00:08, 24.35it/s][6/6] extract embeddings:  15%|█▌        | 35/227 [00:02<00:07, 24.35it/s][6/6] extract embeddings:  17%|█▋        | 38/227 [00:02<00:07, 24.49it/s][6/6] extract embeddings:  18%|█▊        | 41/227 [00:02<00:07, 24.40it/s][6/6] extract embeddings:  19%|█▉        | 44/227 [00:02<00:07, 24.21it/s][6/6] extract embeddings:  21%|██        | 47/227 [00:03<00:07, 25.28it/s][6/6] extract embeddings:  22%|██▏       | 50/227 [00:03<00:06, 26.01it/s][6/6] extract embeddings:  23%|██▎       | 53/227 [00:03<00:07, 24.37it/s][6/6] extract embeddings:  25%|██▍       | 56/227 [00:03<00:06, 24.60it/s][6/6] extract embeddings:  26%|██▌       | 59/227 [00:03<00:06, 24.42it/s][6/6] extract embeddings:  27%|██▋       | 62/227 [00:03<00:06, 24.38it/s][6/6] extract embeddings:  29%|██▊       | 65/227 [00:03<00:06, 23.92it/s][6/6] extract embeddings:  30%|██▉       | 68/227 [00:03<00:06, 24.96it/s][6/6] extract embeddings:  31%|███▏      | 71/227 [00:04<00:06, 25.48it/s][6/6] extract embeddings:  33%|███▎      | 74/227 [00:04<00:05, 25.59it/s][6/6] extract embeddings:  34%|███▍      | 77/227 [00:04<00:05, 25.92it/s][6/6] extract embeddings:  35%|███▌      | 80/227 [00:04<00:05, 25.84it/s][6/6] extract embeddings:  37%|███▋      | 83/227 [00:04<00:05, 26.13it/s][6/6] extract embeddings:  38%|███▊      | 86/227 [00:04<00:05, 26.12it/s][6/6] extract embeddings:  39%|███▉      | 89/227 [00:04<00:05, 26.75it/s][6/6] extract embeddings:  41%|████      | 92/227 [00:04<00:05, 26.24it/s][6/6] extract embeddings:  42%|████▏     | 95/227 [00:04<00:05, 25.09it/s][6/6] extract embeddings:  43%|████▎     | 98/227 [00:05<00:05, 24.86it/s][6/6] extract embeddings:  44%|████▍     | 101/227 [00:05<00:05, 24.92it/s][6/6] extract embeddings:  46%|████▌     | 104/227 [00:05<00:05, 24.24it/s][6/6] extract embeddings:  48%|████▊     | 108/227 [00:05<00:04, 25.16it/s][6/6] extract embeddings:  49%|████▉     | 111/227 [00:05<00:04, 24.29it/s][6/6] extract embeddings:  50%|█████     | 114/227 [00:05<00:04, 23.32it/s][6/6] extract embeddings:  52%|█████▏    | 117/227 [00:05<00:04, 24.23it/s][6/6] extract embeddings:  53%|█████▎    | 120/227 [00:05<00:04, 23.77it/s][6/6] extract embeddings:  54%|█████▍    | 123/227 [00:06<00:04, 24.12it/s][6/6] extract embeddings:  56%|█████▌    | 126/227 [00:06<00:04, 24.31it/s][6/6] extract embeddings:  57%|█████▋    | 129/227 [00:06<00:04, 24.40it/s][6/6] extract embeddings:  58%|█████▊    | 132/227 [00:06<00:04, 23.16it/s][6/6] extract embeddings:  59%|█████▉    | 135/227 [00:06<00:03, 23.46it/s][6/6] extract embeddings:  61%|██████    | 138/227 [00:06<00:03, 23.04it/s][6/6] extract embeddings:  62%|██████▏   | 141/227 [00:06<00:03, 24.02it/s][6/6] extract embeddings:  63%|██████▎   | 144/227 [00:07<00:03, 23.85it/s][6/6] extract embeddings:  65%|██████▌   | 148/227 [00:07<00:03, 25.43it/s][6/6] extract embeddings:  67%|██████▋   | 151/227 [00:07<00:02, 26.24it/s][6/6] extract embeddings:  68%|██████▊   | 154/227 [00:07<00:02, 26.72it/s][6/6] extract embeddings:  69%|██████▉   | 157/227 [00:07<00:02, 27.45it/s][6/6] extract embeddings:  70%|███████   | 160/227 [00:07<00:02, 25.95it/s][6/6] extract embeddings:  72%|███████▏  | 163/227 [00:07<00:02, 25.60it/s][6/6] extract embeddings:  73%|███████▎  | 166/227 [00:07<00:02, 25.86it/s][6/6] extract embeddings:  74%|███████▍  | 169/227 [00:07<00:02, 26.01it/s][6/6] extract embeddings:  76%|███████▌  | 172/227 [00:08<00:02, 26.04it/s][6/6] extract embeddings:  77%|███████▋  | 175/227 [00:08<00:02, 25.91it/s][6/6] extract embeddings:  78%|███████▊  | 178/227 [00:08<00:01, 26.42it/s][6/6] extract embeddings:  80%|████████  | 182/227 [00:08<00:01, 27.44it/s][6/6] extract embeddings:  81%|████████▏ | 185/227 [00:08<00:01, 27.07it/s][6/6] extract embeddings:  83%|████████▎ | 188/227 [00:08<00:01, 26.40it/s][6/6] extract embeddings:  84%|████████▍ | 191/227 [00:08<00:01, 24.87it/s][6/6] extract embeddings:  85%|████████▌ | 194/227 [00:08<00:01, 23.12it/s][6/6] extract embeddings:  87%|████████▋ | 197/227 [00:09<00:01, 24.40it/s][6/6] extract embeddings:  88%|████████▊ | 200/227 [00:09<00:01, 25.68it/s][6/6] extract embeddings:  90%|████████▉ | 204/227 [00:09<00:00, 27.42it/s][6/6] extract embeddings:  91%|█████████ | 207/227 [00:09<00:00, 27.39it/s][6/6] extract embeddings:  93%|█████████▎| 210/227 [00:09<00:00, 27.52it/s][6/6] extract embeddings:  94%|█████████▍| 213/227 [00:09<00:00, 27.41it/s][6/6] extract embeddings:  95%|█████████▌| 216/227 [00:09<00:00, 27.12it/s][6/6] extract embeddings:  96%|█████████▋| 219/227 [00:09<00:00, 26.15it/s][6/6] extract embeddings:  98%|█████████▊| 222/227 [00:09<00:00, 25.61it/s][6/6] extract embeddings:  99%|█████████▉| 225/227 [00:10<00:00, 26.45it/s][6/6] extract embeddings: 100%|██████████| 227/227 [00:10<00:00, 22.34it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.98it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.06it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.63it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.15it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s]
[NeMo I 2025-04-17 01:01:12 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:01:13 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              36.496899   444.120  ...   17.620033  3.967404
    Harker-ES                       27.909752  2178.782  ...   80.575317  3.698182
    Harker-MN                       41.114667   366.767  ...   31.944935  8.709872
    Longfellow-Block-1              20.272205   492.417  ...   12.325006  2.502961
    TOTAL                           29.315804  3482.086  ...  142.465291  4.091378
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:01:13 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0948 | MISS: 0.1574 | CER: 0.0409 | DER: 0.2932 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.35, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.35, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.90s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.96s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.26s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:01:26 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:01:26 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:01:26 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:01:26 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:01:26 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:01:26 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:01:26 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:01:26 features:305] PADDING: 16
[NeMo I 2025-04-17 01:01:27 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:01:27 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:01:27 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:01:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:01:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:01:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:01:27 collections:880] Dataset successfully loaded with 2390 items and total duration provided from manifest is  1.64 hours.
[NeMo I 2025-04-17 01:01:27 collections:886] # 2390 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/38 [00:02<01:14,  2.02s/it][1/6] extract embeddings:  11%|█         | 4/38 [00:02<00:14,  2.42it/s][1/6] extract embeddings:  16%|█▌        | 6/38 [00:02<00:08,  3.81it/s][1/6] extract embeddings:  21%|██        | 8/38 [00:02<00:05,  5.29it/s][1/6] extract embeddings:  26%|██▋       | 10/38 [00:02<00:04,  6.61it/s][1/6] extract embeddings:  32%|███▏      | 12/38 [00:02<00:03,  7.90it/s][1/6] extract embeddings:  37%|███▋      | 14/38 [00:02<00:02,  9.14it/s][1/6] extract embeddings:  42%|████▏     | 16/38 [00:03<00:02, 10.52it/s][1/6] extract embeddings:  47%|████▋     | 18/38 [00:03<00:01, 11.37it/s][1/6] extract embeddings:  53%|█████▎    | 20/38 [00:03<00:01, 11.78it/s][1/6] extract embeddings:  58%|█████▊    | 22/38 [00:03<00:01, 12.08it/s][1/6] extract embeddings:  63%|██████▎   | 24/38 [00:03<00:01, 12.38it/s][1/6] extract embeddings:  68%|██████▊   | 26/38 [00:03<00:00, 13.37it/s][1/6] extract embeddings:  74%|███████▎  | 28/38 [00:03<00:00, 13.35it/s][1/6] extract embeddings:  79%|███████▉  | 30/38 [00:04<00:00, 13.02it/s][1/6] extract embeddings:  84%|████████▍ | 32/38 [00:04<00:00, 12.73it/s][1/6] extract embeddings:  89%|████████▉ | 34/38 [00:04<00:00, 13.06it/s][1/6] extract embeddings:  95%|█████████▍| 36/38 [00:04<00:00, 13.04it/s][1/6] extract embeddings: 100%|██████████| 38/38 [00:04<00:00,  8.19it/s]
[NeMo I 2025-04-17 01:01:32 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:01:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:01:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:01:32 collections:880] Dataset successfully loaded with 2840 items and total duration provided from manifest is  1.69 hours.
[NeMo I 2025-04-17 01:01:32 collections:886] # 2840 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/45 [00:01<01:14,  1.69s/it][2/6] extract embeddings:   7%|▋         | 3/45 [00:01<00:20,  2.06it/s][2/6] extract embeddings:  11%|█         | 5/45 [00:01<00:10,  3.68it/s][2/6] extract embeddings:  16%|█▌        | 7/45 [00:02<00:07,  5.24it/s][2/6] extract embeddings:  20%|██        | 9/45 [00:02<00:05,  6.87it/s][2/6] extract embeddings:  24%|██▍       | 11/45 [00:02<00:04,  8.49it/s][2/6] extract embeddings:  29%|██▉       | 13/45 [00:02<00:03,  9.97it/s][2/6] extract embeddings:  33%|███▎      | 15/45 [00:02<00:02, 10.99it/s][2/6] extract embeddings:  38%|███▊      | 17/45 [00:02<00:02, 12.28it/s][2/6] extract embeddings:  42%|████▏     | 19/45 [00:02<00:02, 12.65it/s][2/6] extract embeddings:  47%|████▋     | 21/45 [00:03<00:01, 13.48it/s][2/6] extract embeddings:  51%|█████     | 23/45 [00:03<00:01, 14.18it/s][2/6] extract embeddings:  56%|█████▌    | 25/45 [00:03<00:01, 14.24it/s][2/6] extract embeddings:  60%|██████    | 27/45 [00:03<00:01, 14.95it/s][2/6] extract embeddings:  64%|██████▍   | 29/45 [00:03<00:01, 14.49it/s][2/6] extract embeddings:  69%|██████▉   | 31/45 [00:03<00:00, 14.68it/s][2/6] extract embeddings:  73%|███████▎  | 33/45 [00:03<00:00, 14.49it/s][2/6] extract embeddings:  78%|███████▊  | 35/45 [00:04<00:00, 14.25it/s][2/6] extract embeddings:  82%|████████▏ | 37/45 [00:04<00:00, 14.50it/s][2/6] extract embeddings:  87%|████████▋ | 39/45 [00:04<00:00, 14.21it/s][2/6] extract embeddings:  91%|█████████ | 41/45 [00:04<00:00, 14.24it/s][2/6] extract embeddings:  96%|█████████▌| 43/45 [00:04<00:00, 14.08it/s][2/6] extract embeddings: 100%|██████████| 45/45 [00:04<00:00,  9.58it/s]
[NeMo I 2025-04-17 01:01:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:01:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:01:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:01:37 collections:880] Dataset successfully loaded with 3517 items and total duration provided from manifest is  1.75 hours.
[NeMo I 2025-04-17 01:01:37 collections:886] # 3517 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/55 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/55 [00:01<01:03,  1.18s/it][3/6] extract embeddings:   5%|▌         | 3/55 [00:01<00:18,  2.87it/s][3/6] extract embeddings:   9%|▉         | 5/55 [00:01<00:10,  4.90it/s][3/6] extract embeddings:  13%|█▎        | 7/55 [00:01<00:06,  6.87it/s][3/6] extract embeddings:  16%|█▋        | 9/55 [00:01<00:05,  8.76it/s][3/6] extract embeddings:  20%|██        | 11/55 [00:01<00:04, 10.36it/s][3/6] extract embeddings:  24%|██▎       | 13/55 [00:01<00:03, 11.67it/s][3/6] extract embeddings:  27%|██▋       | 15/55 [00:02<00:03, 12.62it/s][3/6] extract embeddings:  31%|███       | 17/55 [00:02<00:02, 13.34it/s][3/6] extract embeddings:  35%|███▍      | 19/55 [00:02<00:02, 13.83it/s][3/6] extract embeddings:  38%|███▊      | 21/55 [00:02<00:02, 14.58it/s][3/6] extract embeddings:  42%|████▏     | 23/55 [00:02<00:02, 14.75it/s][3/6] extract embeddings:  45%|████▌     | 25/55 [00:02<00:02, 14.87it/s][3/6] extract embeddings:  49%|████▉     | 27/55 [00:02<00:01, 15.28it/s][3/6] extract embeddings:  53%|█████▎    | 29/55 [00:02<00:01, 15.62it/s][3/6] extract embeddings:  56%|█████▋    | 31/55 [00:03<00:01, 15.77it/s][3/6] extract embeddings:  60%|██████    | 33/55 [00:03<00:01, 15.73it/s][3/6] extract embeddings:  64%|██████▎   | 35/55 [00:03<00:01, 15.55it/s][3/6] extract embeddings:  67%|██████▋   | 37/55 [00:03<00:01, 15.52it/s][3/6] extract embeddings:  71%|███████   | 39/55 [00:03<00:01, 15.67it/s][3/6] extract embeddings:  75%|███████▍  | 41/55 [00:03<00:00, 16.10it/s][3/6] extract embeddings:  78%|███████▊  | 43/55 [00:03<00:00, 16.50it/s][3/6] extract embeddings:  82%|████████▏ | 45/55 [00:03<00:00, 16.64it/s][3/6] extract embeddings:  85%|████████▌ | 47/55 [00:04<00:00, 17.24it/s][3/6] extract embeddings:  89%|████████▉ | 49/55 [00:04<00:00, 16.75it/s][3/6] extract embeddings:  93%|█████████▎| 51/55 [00:04<00:00, 16.08it/s][3/6] extract embeddings:  96%|█████████▋| 53/55 [00:04<00:00, 15.95it/s][3/6] extract embeddings: 100%|██████████| 55/55 [00:04<00:00, 15.99it/s][3/6] extract embeddings: 100%|██████████| 55/55 [00:04<00:00, 11.95it/s]
[NeMo I 2025-04-17 01:01:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:01:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:01:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:01:41 collections:880] Dataset successfully loaded with 4681 items and total duration provided from manifest is  1.81 hours.
[NeMo I 2025-04-17 01:01:41 collections:886] # 4681 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/74 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/74 [00:01<01:24,  1.16s/it][4/6] extract embeddings:   5%|▌         | 4/74 [00:01<00:17,  3.96it/s][4/6] extract embeddings:   9%|▉         | 7/74 [00:01<00:09,  7.05it/s][4/6] extract embeddings:  12%|█▏        | 9/74 [00:01<00:07,  8.94it/s][4/6] extract embeddings:  15%|█▍        | 11/74 [00:01<00:05, 10.57it/s][4/6] extract embeddings:  18%|█▊        | 13/74 [00:01<00:04, 12.28it/s][4/6] extract embeddings:  20%|██        | 15/74 [00:01<00:04, 13.35it/s][4/6] extract embeddings:  23%|██▎       | 17/74 [00:01<00:04, 14.24it/s][4/6] extract embeddings:  26%|██▌       | 19/74 [00:02<00:03, 14.70it/s][4/6] extract embeddings:  28%|██▊       | 21/74 [00:02<00:03, 15.05it/s][4/6] extract embeddings:  31%|███       | 23/74 [00:02<00:03, 15.72it/s][4/6] extract embeddings:  34%|███▍      | 25/74 [00:02<00:03, 16.15it/s][4/6] extract embeddings:  36%|███▋      | 27/74 [00:02<00:02, 16.46it/s][4/6] extract embeddings:  39%|███▉      | 29/74 [00:02<00:02, 16.83it/s][4/6] extract embeddings:  42%|████▏     | 31/74 [00:02<00:02, 16.87it/s][4/6] extract embeddings:  45%|████▍     | 33/74 [00:02<00:02, 16.81it/s][4/6] extract embeddings:  47%|████▋     | 35/74 [00:03<00:02, 16.86it/s][4/6] extract embeddings:  50%|█████     | 37/74 [00:03<00:02, 17.05it/s][4/6] extract embeddings:  53%|█████▎    | 39/74 [00:03<00:02, 17.16it/s][4/6] extract embeddings:  55%|█████▌    | 41/74 [00:03<00:02, 16.47it/s][4/6] extract embeddings:  58%|█████▊    | 43/74 [00:03<00:01, 16.51it/s][4/6] extract embeddings:  61%|██████    | 45/74 [00:03<00:01, 16.56it/s][4/6] extract embeddings:  64%|██████▎   | 47/74 [00:03<00:01, 16.93it/s][4/6] extract embeddings:  66%|██████▌   | 49/74 [00:03<00:01, 17.20it/s][4/6] extract embeddings:  69%|██████▉   | 51/74 [00:03<00:01, 17.34it/s][4/6] extract embeddings:  72%|███████▏  | 53/74 [00:04<00:01, 17.36it/s][4/6] extract embeddings:  74%|███████▍  | 55/74 [00:04<00:01, 17.94it/s][4/6] extract embeddings:  78%|███████▊  | 58/74 [00:04<00:00, 19.47it/s][4/6] extract embeddings:  82%|████████▏ | 61/74 [00:04<00:00, 19.62it/s][4/6] extract embeddings:  86%|████████▋ | 64/74 [00:04<00:00, 19.87it/s][4/6] extract embeddings:  89%|████████▉ | 66/74 [00:04<00:00, 19.78it/s][4/6] extract embeddings:  92%|█████████▏| 68/74 [00:04<00:00, 19.26it/s][4/6] extract embeddings:  96%|█████████▌| 71/74 [00:05<00:00, 20.01it/s][4/6] extract embeddings:  99%|█████████▊| 73/74 [00:05<00:00, 19.47it/s][4/6] extract embeddings: 100%|██████████| 74/74 [00:05<00:00, 14.28it/s]
[NeMo I 2025-04-17 01:01:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:01:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:01:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:01:47 collections:880] Dataset successfully loaded with 7063 items and total duration provided from manifest is  1.88 hours.
[NeMo I 2025-04-17 01:01:47 collections:886] # 7063 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/111 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/111 [00:01<02:09,  1.18s/it][5/6] extract embeddings:   4%|▎         | 4/111 [00:01<00:27,  3.84it/s][5/6] extract embeddings:   6%|▋         | 7/111 [00:01<00:15,  6.89it/s][5/6] extract embeddings:   8%|▊         | 9/111 [00:01<00:11,  8.82it/s][5/6] extract embeddings:  11%|█         | 12/111 [00:01<00:08, 11.85it/s][5/6] extract embeddings:  13%|█▎        | 14/111 [00:01<00:07, 13.35it/s][5/6] extract embeddings:  15%|█▌        | 17/111 [00:01<00:05, 15.77it/s][5/6] extract embeddings:  18%|█▊        | 20/111 [00:02<00:05, 17.85it/s][5/6] extract embeddings:  21%|██        | 23/111 [00:02<00:04, 18.12it/s][5/6] extract embeddings:  23%|██▎       | 26/111 [00:02<00:04, 19.49it/s][5/6] extract embeddings:  26%|██▌       | 29/111 [00:02<00:04, 19.35it/s][5/6] extract embeddings:  29%|██▉       | 32/111 [00:02<00:03, 20.12it/s][5/6] extract embeddings:  32%|███▏      | 35/111 [00:02<00:03, 20.65it/s][5/6] extract embeddings:  34%|███▍      | 38/111 [00:02<00:03, 20.65it/s][5/6] extract embeddings:  37%|███▋      | 41/111 [00:03<00:03, 20.40it/s][5/6] extract embeddings:  40%|███▉      | 44/111 [00:03<00:03, 20.85it/s][5/6] extract embeddings:  42%|████▏     | 47/111 [00:03<00:03, 20.40it/s][5/6] extract embeddings:  45%|████▌     | 50/111 [00:03<00:02, 21.16it/s][5/6] extract embeddings:  48%|████▊     | 53/111 [00:03<00:02, 22.46it/s][5/6] extract embeddings:  50%|█████     | 56/111 [00:03<00:02, 23.72it/s][5/6] extract embeddings:  53%|█████▎    | 59/111 [00:03<00:02, 23.04it/s][5/6] extract embeddings:  56%|█████▌    | 62/111 [00:04<00:02, 21.22it/s][5/6] extract embeddings:  59%|█████▊    | 65/111 [00:04<00:02, 20.86it/s][5/6] extract embeddings:  61%|██████▏   | 68/111 [00:04<00:02, 21.06it/s][5/6] extract embeddings:  64%|██████▍   | 71/111 [00:04<00:01, 21.12it/s][5/6] extract embeddings:  67%|██████▋   | 74/111 [00:04<00:01, 22.61it/s][5/6] extract embeddings:  69%|██████▉   | 77/111 [00:04<00:01, 22.05it/s][5/6] extract embeddings:  72%|███████▏  | 80/111 [00:04<00:01, 22.21it/s][5/6] extract embeddings:  75%|███████▍  | 83/111 [00:04<00:01, 22.05it/s][5/6] extract embeddings:  77%|███████▋  | 86/111 [00:05<00:01, 22.12it/s][5/6] extract embeddings:  80%|████████  | 89/111 [00:05<00:01, 21.06it/s][5/6] extract embeddings:  83%|████████▎ | 92/111 [00:05<00:00, 20.69it/s][5/6] extract embeddings:  86%|████████▌ | 95/111 [00:05<00:00, 20.52it/s][5/6] extract embeddings:  88%|████████▊ | 98/111 [00:05<00:00, 20.71it/s][5/6] extract embeddings:  91%|█████████ | 101/111 [00:05<00:00, 20.74it/s][5/6] extract embeddings:  94%|█████████▎| 104/111 [00:06<00:00, 20.74it/s][5/6] extract embeddings:  96%|█████████▋| 107/111 [00:06<00:00, 19.88it/s][5/6] extract embeddings:  99%|█████████▉| 110/111 [00:06<00:00, 20.19it/s][5/6] extract embeddings: 100%|██████████| 111/111 [00:06<00:00, 17.45it/s]
[NeMo I 2025-04-17 01:01:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:01:54 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:01:54 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:01:54 collections:880] Dataset successfully loaded with 14350 items and total duration provided from manifest is  1.96 hours.
[NeMo I 2025-04-17 01:01:54 collections:886] # 14350 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/225 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/225 [00:01<04:38,  1.24s/it][6/6] extract embeddings:   2%|▏         | 4/225 [00:01<00:58,  3.80it/s][6/6] extract embeddings:   4%|▎         | 8/225 [00:01<00:27,  8.02it/s][6/6] extract embeddings:   5%|▍         | 11/225 [00:01<00:19, 11.15it/s][6/6] extract embeddings:   7%|▋         | 15/225 [00:01<00:13, 15.60it/s][6/6] extract embeddings:   8%|▊         | 19/225 [00:01<00:10, 18.99it/s][6/6] extract embeddings:  10%|▉         | 22/225 [00:01<00:09, 20.32it/s][6/6] extract embeddings:  11%|█         | 25/225 [00:02<00:09, 21.24it/s][6/6] extract embeddings:  12%|█▏        | 28/225 [00:02<00:08, 23.03it/s][6/6] extract embeddings:  14%|█▍        | 31/225 [00:02<00:08, 23.68it/s][6/6] extract embeddings:  16%|█▌        | 35/225 [00:02<00:07, 26.11it/s][6/6] extract embeddings:  17%|█▋        | 39/225 [00:02<00:06, 27.38it/s][6/6] extract embeddings:  19%|█▊        | 42/225 [00:02<00:06, 27.20it/s][6/6] extract embeddings:  20%|██        | 45/225 [00:02<00:07, 25.53it/s][6/6] extract embeddings:  21%|██▏       | 48/225 [00:02<00:07, 24.23it/s][6/6] extract embeddings:  23%|██▎       | 51/225 [00:03<00:07, 23.98it/s][6/6] extract embeddings:  24%|██▍       | 54/225 [00:03<00:07, 24.07it/s][6/6] extract embeddings:  25%|██▌       | 57/225 [00:03<00:06, 25.39it/s][6/6] extract embeddings:  27%|██▋       | 61/225 [00:03<00:06, 26.90it/s][6/6] extract embeddings:  28%|██▊       | 64/225 [00:03<00:05, 27.10it/s][6/6] extract embeddings:  30%|██▉       | 67/225 [00:03<00:06, 26.21it/s][6/6] extract embeddings:  31%|███       | 70/225 [00:03<00:06, 25.60it/s][6/6] extract embeddings:  32%|███▏      | 73/225 [00:03<00:06, 25.05it/s][6/6] extract embeddings:  34%|███▍      | 76/225 [00:04<00:06, 23.97it/s][6/6] extract embeddings:  35%|███▌      | 79/225 [00:04<00:06, 24.09it/s][6/6] extract embeddings:  36%|███▋      | 82/225 [00:04<00:06, 23.48it/s][6/6] extract embeddings:  38%|███▊      | 85/225 [00:04<00:06, 22.55it/s][6/6] extract embeddings:  39%|███▉      | 88/225 [00:04<00:05, 22.87it/s][6/6] extract embeddings:  40%|████      | 91/225 [00:04<00:05, 22.87it/s][6/6] extract embeddings:  42%|████▏     | 94/225 [00:04<00:05, 23.57it/s][6/6] extract embeddings:  43%|████▎     | 97/225 [00:04<00:05, 23.83it/s][6/6] extract embeddings:  44%|████▍     | 100/225 [00:05<00:05, 23.42it/s][6/6] extract embeddings:  46%|████▌     | 103/225 [00:05<00:05, 24.10it/s][6/6] extract embeddings:  47%|████▋     | 106/225 [00:05<00:04, 24.60it/s][6/6] extract embeddings:  48%|████▊     | 109/225 [00:05<00:04, 24.48it/s][6/6] extract embeddings:  50%|████▉     | 112/225 [00:05<00:04, 23.02it/s][6/6] extract embeddings:  51%|█████     | 115/225 [00:05<00:04, 23.81it/s][6/6] extract embeddings:  52%|█████▏    | 118/225 [00:05<00:04, 22.59it/s][6/6] extract embeddings:  54%|█████▍    | 121/225 [00:05<00:04, 23.46it/s][6/6] extract embeddings:  55%|█████▌    | 124/225 [00:06<00:04, 22.88it/s][6/6] extract embeddings:  56%|█████▋    | 127/225 [00:06<00:04, 23.31it/s][6/6] extract embeddings:  58%|█████▊    | 130/225 [00:06<00:04, 22.46it/s][6/6] extract embeddings:  59%|█████▉    | 133/225 [00:06<00:03, 23.17it/s][6/6] extract embeddings:  60%|██████    | 136/225 [00:06<00:03, 23.33it/s][6/6] extract embeddings:  62%|██████▏   | 139/225 [00:06<00:03, 23.36it/s][6/6] extract embeddings:  63%|██████▎   | 142/225 [00:06<00:03, 23.97it/s][6/6] extract embeddings:  64%|██████▍   | 145/225 [00:07<00:03, 23.97it/s][6/6] extract embeddings:  66%|██████▌   | 148/225 [00:07<00:03, 23.58it/s][6/6] extract embeddings:  67%|██████▋   | 151/225 [00:07<00:03, 24.08it/s][6/6] extract embeddings:  68%|██████▊   | 154/225 [00:07<00:02, 23.86it/s][6/6] extract embeddings:  70%|██████▉   | 157/225 [00:07<00:02, 23.46it/s][6/6] extract embeddings:  71%|███████   | 160/225 [00:07<00:02, 24.17it/s][6/6] extract embeddings:  72%|███████▏  | 163/225 [00:07<00:02, 24.68it/s][6/6] extract embeddings:  74%|███████▍  | 166/225 [00:07<00:02, 24.42it/s][6/6] extract embeddings:  75%|███████▌  | 169/225 [00:08<00:02, 23.99it/s][6/6] extract embeddings:  76%|███████▋  | 172/225 [00:08<00:02, 24.35it/s][6/6] extract embeddings:  78%|███████▊  | 175/225 [00:08<00:02, 23.94it/s][6/6] extract embeddings:  79%|███████▉  | 178/225 [00:08<00:01, 24.01it/s][6/6] extract embeddings:  80%|████████  | 181/225 [00:08<00:01, 24.44it/s][6/6] extract embeddings:  82%|████████▏ | 184/225 [00:08<00:01, 25.70it/s][6/6] extract embeddings:  83%|████████▎ | 187/225 [00:08<00:01, 26.77it/s][6/6] extract embeddings:  84%|████████▍ | 190/225 [00:08<00:01, 25.90it/s][6/6] extract embeddings:  86%|████████▌ | 193/225 [00:08<00:01, 23.65it/s][6/6] extract embeddings:  87%|████████▋ | 196/225 [00:09<00:01, 24.26it/s][6/6] extract embeddings:  88%|████████▊ | 199/225 [00:09<00:01, 25.20it/s][6/6] extract embeddings:  90%|█████████ | 203/225 [00:09<00:00, 27.44it/s][6/6] extract embeddings:  92%|█████████▏| 206/225 [00:09<00:00, 27.28it/s][6/6] extract embeddings:  93%|█████████▎| 209/225 [00:09<00:00, 26.14it/s][6/6] extract embeddings:  94%|█████████▍| 212/225 [00:09<00:00, 27.01it/s][6/6] extract embeddings:  96%|█████████▌| 215/225 [00:09<00:00, 25.47it/s][6/6] extract embeddings:  97%|█████████▋| 218/225 [00:09<00:00, 25.49it/s][6/6] extract embeddings:  98%|█████████▊| 221/225 [00:10<00:00, 26.24it/s][6/6] extract embeddings: 100%|█████████▉| 224/225 [00:10<00:00, 24.71it/s][6/6] extract embeddings: 100%|██████████| 225/225 [00:10<00:00, 21.83it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.16it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.11it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.70it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.20it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s]
[NeMo I 2025-04-17 01:02:07 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:02:08 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              36.793001   444.120  ...   16.005032  3.603763
    Harker-ES                       28.141069  2178.782  ...   77.352432  3.550260
    Harker-MN                       41.846448   366.767  ...   32.844956  8.955265
    Longfellow-Block-1              20.980346   492.417  ...   11.447013  2.324658
    TOTAL                           29.675527  3482.086  ...  137.649433  3.953074
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:02:08 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0933 | MISS: 0.1639 | CER: 0.0395 | DER: 0.2968 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.40, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.4, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.95s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.99s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.28s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.20s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:02:21 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:02:21 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:02:21 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:02:21 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:02:21 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:02:21 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:02:21 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:02:21 features:305] PADDING: 16
[NeMo I 2025-04-17 01:02:21 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:02:21 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:02:21 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:02:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:02:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:02:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:02:21 collections:880] Dataset successfully loaded with 2367 items and total duration provided from manifest is  1.61 hours.
[NeMo I 2025-04-17 01:02:21 collections:886] # 2367 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/37 [00:02<01:14,  2.08s/it][1/6] extract embeddings:  11%|█         | 4/37 [00:02<00:14,  2.35it/s][1/6] extract embeddings:  16%|█▌        | 6/37 [00:02<00:08,  3.67it/s][1/6] extract embeddings:  22%|██▏       | 8/37 [00:02<00:05,  5.15it/s][1/6] extract embeddings:  27%|██▋       | 10/37 [00:02<00:04,  6.62it/s][1/6] extract embeddings:  32%|███▏      | 12/37 [00:02<00:03,  7.78it/s][1/6] extract embeddings:  38%|███▊      | 14/37 [00:02<00:02,  8.95it/s][1/6] extract embeddings:  43%|████▎     | 16/37 [00:03<00:02, 10.10it/s][1/6] extract embeddings:  49%|████▊     | 18/37 [00:03<00:01, 10.92it/s][1/6] extract embeddings:  54%|█████▍    | 20/37 [00:03<00:01, 12.04it/s][1/6] extract embeddings:  59%|█████▉    | 22/37 [00:03<00:01, 12.19it/s][1/6] extract embeddings:  65%|██████▍   | 24/37 [00:03<00:01, 12.78it/s][1/6] extract embeddings:  70%|███████   | 26/37 [00:03<00:00, 13.46it/s][1/6] extract embeddings:  76%|███████▌  | 28/37 [00:03<00:00, 13.76it/s][1/6] extract embeddings:  81%|████████  | 30/37 [00:04<00:00, 13.71it/s][1/6] extract embeddings:  86%|████████▋ | 32/37 [00:04<00:00, 13.57it/s][1/6] extract embeddings:  92%|█████████▏| 34/37 [00:04<00:00, 14.27it/s][1/6] extract embeddings:  97%|█████████▋| 36/37 [00:04<00:00, 13.45it/s][1/6] extract embeddings: 100%|██████████| 37/37 [00:04<00:00,  8.01it/s]
[NeMo I 2025-04-17 01:02:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:02:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:02:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:02:26 collections:880] Dataset successfully loaded with 2810 items and total duration provided from manifest is  1.66 hours.
[NeMo I 2025-04-17 01:02:26 collections:886] # 2810 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/44 [00:01<01:16,  1.79s/it][2/6] extract embeddings:   7%|▋         | 3/44 [00:01<00:20,  1.98it/s][2/6] extract embeddings:  11%|█▏        | 5/44 [00:02<00:11,  3.51it/s][2/6] extract embeddings:  16%|█▌        | 7/44 [00:02<00:07,  5.17it/s][2/6] extract embeddings:  20%|██        | 9/44 [00:02<00:05,  6.89it/s][2/6] extract embeddings:  25%|██▌       | 11/44 [00:02<00:03,  8.64it/s][2/6] extract embeddings:  30%|██▉       | 13/44 [00:02<00:03,  9.96it/s][2/6] extract embeddings:  34%|███▍      | 15/44 [00:02<00:02, 11.26it/s][2/6] extract embeddings:  39%|███▊      | 17/44 [00:02<00:02, 12.08it/s][2/6] extract embeddings:  43%|████▎     | 19/44 [00:03<00:02, 12.23it/s][2/6] extract embeddings:  48%|████▊     | 21/44 [00:03<00:01, 13.17it/s][2/6] extract embeddings:  52%|█████▏    | 23/44 [00:03<00:01, 13.86it/s][2/6] extract embeddings:  57%|█████▋    | 25/44 [00:03<00:01, 14.55it/s][2/6] extract embeddings:  61%|██████▏   | 27/44 [00:03<00:01, 14.58it/s][2/6] extract embeddings:  66%|██████▌   | 29/44 [00:03<00:01, 14.80it/s][2/6] extract embeddings:  70%|███████   | 31/44 [00:03<00:00, 15.37it/s][2/6] extract embeddings:  75%|███████▌  | 33/44 [00:03<00:00, 15.15it/s][2/6] extract embeddings:  80%|███████▉  | 35/44 [00:04<00:00, 14.83it/s][2/6] extract embeddings:  84%|████████▍ | 37/44 [00:04<00:00, 14.94it/s][2/6] extract embeddings:  89%|████████▊ | 39/44 [00:04<00:00, 14.86it/s][2/6] extract embeddings:  93%|█████████▎| 41/44 [00:04<00:00, 14.68it/s][2/6] extract embeddings:  98%|█████████▊| 43/44 [00:04<00:00, 14.92it/s][2/6] extract embeddings: 100%|██████████| 44/44 [00:04<00:00,  9.38it/s]
[NeMo I 2025-04-17 01:02:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:02:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:02:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:02:31 collections:880] Dataset successfully loaded with 3474 items and total duration provided from manifest is  1.72 hours.
[NeMo I 2025-04-17 01:02:31 collections:886] # 3474 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/55 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/55 [00:01<01:03,  1.18s/it][3/6] extract embeddings:   5%|▌         | 3/55 [00:01<00:17,  2.89it/s][3/6] extract embeddings:   9%|▉         | 5/55 [00:01<00:09,  5.11it/s][3/6] extract embeddings:  15%|█▍        | 8/55 [00:01<00:05,  8.26it/s][3/6] extract embeddings:  18%|█▊        | 10/55 [00:01<00:04, 10.06it/s][3/6] extract embeddings:  22%|██▏       | 12/55 [00:01<00:03, 11.71it/s][3/6] extract embeddings:  25%|██▌       | 14/55 [00:01<00:03, 12.72it/s][3/6] extract embeddings:  29%|██▉       | 16/55 [00:02<00:02, 13.28it/s][3/6] extract embeddings:  33%|███▎      | 18/55 [00:02<00:02, 13.80it/s][3/6] extract embeddings:  36%|███▋      | 20/55 [00:02<00:02, 14.05it/s][3/6] extract embeddings:  40%|████      | 22/55 [00:02<00:02, 14.51it/s][3/6] extract embeddings:  44%|████▎     | 24/55 [00:02<00:02, 14.90it/s][3/6] extract embeddings:  47%|████▋     | 26/55 [00:02<00:01, 14.94it/s][3/6] extract embeddings:  51%|█████     | 28/55 [00:02<00:01, 15.10it/s][3/6] extract embeddings:  55%|█████▍    | 30/55 [00:02<00:01, 15.18it/s][3/6] extract embeddings:  58%|█████▊    | 32/55 [00:03<00:01, 15.25it/s][3/6] extract embeddings:  62%|██████▏   | 34/55 [00:03<00:01, 15.22it/s][3/6] extract embeddings:  65%|██████▌   | 36/55 [00:03<00:01, 15.17it/s][3/6] extract embeddings:  69%|██████▉   | 38/55 [00:03<00:01, 15.62it/s][3/6] extract embeddings:  73%|███████▎  | 40/55 [00:03<00:00, 15.62it/s][3/6] extract embeddings:  76%|███████▋  | 42/55 [00:03<00:00, 16.72it/s][3/6] extract embeddings:  80%|████████  | 44/55 [00:03<00:00, 17.40it/s][3/6] extract embeddings:  84%|████████▎ | 46/55 [00:03<00:00, 16.98it/s][3/6] extract embeddings:  87%|████████▋ | 48/55 [00:04<00:00, 17.25it/s][3/6] extract embeddings:  93%|█████████▎| 51/55 [00:04<00:00, 17.93it/s][3/6] extract embeddings:  96%|█████████▋| 53/55 [00:04<00:00, 17.62it/s][3/6] extract embeddings: 100%|██████████| 55/55 [00:04<00:00, 12.41it/s]
[NeMo I 2025-04-17 01:02:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:02:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:02:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:02:36 collections:880] Dataset successfully loaded with 4620 items and total duration provided from manifest is  1.78 hours.
[NeMo I 2025-04-17 01:02:36 collections:886] # 4620 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/73 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/73 [00:01<01:34,  1.32s/it][4/6] extract embeddings:   5%|▌         | 4/73 [00:01<00:20,  3.42it/s][4/6] extract embeddings:   8%|▊         | 6/73 [00:01<00:12,  5.26it/s][4/6] extract embeddings:  11%|█         | 8/73 [00:01<00:09,  7.18it/s][4/6] extract embeddings:  14%|█▎        | 10/73 [00:01<00:06,  9.01it/s][4/6] extract embeddings:  16%|█▋        | 12/73 [00:01<00:05, 10.85it/s][4/6] extract embeddings:  19%|█▉        | 14/73 [00:02<00:04, 12.23it/s][4/6] extract embeddings:  22%|██▏       | 16/73 [00:02<00:04, 13.66it/s][4/6] extract embeddings:  25%|██▍       | 18/73 [00:02<00:03, 14.94it/s][4/6] extract embeddings:  27%|██▋       | 20/73 [00:02<00:03, 15.44it/s][4/6] extract embeddings:  30%|███       | 22/73 [00:02<00:03, 15.63it/s][4/6] extract embeddings:  34%|███▍      | 25/73 [00:02<00:02, 17.38it/s][4/6] extract embeddings:  38%|███▊      | 28/73 [00:02<00:02, 18.87it/s][4/6] extract embeddings:  41%|████      | 30/73 [00:02<00:02, 18.51it/s][4/6] extract embeddings:  45%|████▌     | 33/73 [00:03<00:01, 20.01it/s][4/6] extract embeddings:  49%|████▉     | 36/73 [00:03<00:01, 20.68it/s][4/6] extract embeddings:  53%|█████▎    | 39/73 [00:03<00:01, 20.44it/s][4/6] extract embeddings:  58%|█████▊    | 42/73 [00:03<00:01, 20.96it/s][4/6] extract embeddings:  62%|██████▏   | 45/73 [00:03<00:01, 21.06it/s][4/6] extract embeddings:  66%|██████▌   | 48/73 [00:03<00:01, 21.46it/s][4/6] extract embeddings:  70%|██████▉   | 51/73 [00:03<00:01, 21.72it/s][4/6] extract embeddings:  74%|███████▍  | 54/73 [00:04<00:00, 21.84it/s][4/6] extract embeddings:  78%|███████▊  | 57/73 [00:04<00:00, 22.26it/s][4/6] extract embeddings:  82%|████████▏ | 60/73 [00:04<00:00, 21.30it/s][4/6] extract embeddings:  86%|████████▋ | 63/73 [00:04<00:00, 21.10it/s][4/6] extract embeddings:  90%|█████████ | 66/73 [00:04<00:00, 21.20it/s][4/6] extract embeddings:  95%|█████████▍| 69/73 [00:04<00:00, 21.21it/s][4/6] extract embeddings:  99%|█████████▊| 72/73 [00:04<00:00, 21.23it/s][4/6] extract embeddings: 100%|██████████| 73/73 [00:04<00:00, 14.87it/s]
[NeMo I 2025-04-17 01:02:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:02:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:02:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:02:41 collections:880] Dataset successfully loaded with 6977 items and total duration provided from manifest is  1.85 hours.
[NeMo I 2025-04-17 01:02:41 collections:886] # 6977 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/110 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/110 [00:01<02:05,  1.15s/it][5/6] extract embeddings:   4%|▎         | 4/110 [00:01<00:26,  3.94it/s][5/6] extract embeddings:   6%|▋         | 7/110 [00:01<00:14,  7.14it/s][5/6] extract embeddings:   9%|▉         | 10/110 [00:01<00:09, 10.16it/s][5/6] extract embeddings:  12%|█▏        | 13/110 [00:01<00:07, 12.90it/s][5/6] extract embeddings:  15%|█▍        | 16/110 [00:01<00:06, 15.04it/s][5/6] extract embeddings:  17%|█▋        | 19/110 [00:01<00:05, 16.26it/s][5/6] extract embeddings:  20%|██        | 22/110 [00:02<00:05, 17.18it/s][5/6] extract embeddings:  23%|██▎       | 25/110 [00:02<00:04, 19.31it/s][5/6] extract embeddings:  25%|██▌       | 28/110 [00:02<00:04, 19.34it/s][5/6] extract embeddings:  28%|██▊       | 31/110 [00:02<00:03, 20.21it/s][5/6] extract embeddings:  31%|███       | 34/110 [00:02<00:03, 20.91it/s][5/6] extract embeddings:  34%|███▎      | 37/110 [00:02<00:03, 21.01it/s][5/6] extract embeddings:  36%|███▋      | 40/110 [00:02<00:03, 20.67it/s][5/6] extract embeddings:  39%|███▉      | 43/110 [00:03<00:03, 21.30it/s][5/6] extract embeddings:  42%|████▏     | 46/110 [00:03<00:02, 21.94it/s][5/6] extract embeddings:  45%|████▍     | 49/110 [00:03<00:02, 21.64it/s][5/6] extract embeddings:  47%|████▋     | 52/110 [00:03<00:02, 22.01it/s][5/6] extract embeddings:  50%|█████     | 55/110 [00:03<00:02, 22.02it/s][5/6] extract embeddings:  53%|█████▎    | 58/110 [00:03<00:02, 21.40it/s][5/6] extract embeddings:  55%|█████▌    | 61/110 [00:03<00:02, 20.76it/s][5/6] extract embeddings:  58%|█████▊    | 64/110 [00:04<00:02, 20.74it/s][5/6] extract embeddings:  61%|██████    | 67/110 [00:04<00:02, 19.74it/s][5/6] extract embeddings:  64%|██████▎   | 70/110 [00:04<00:01, 20.47it/s][5/6] extract embeddings:  66%|██████▋   | 73/110 [00:04<00:01, 21.15it/s][5/6] extract embeddings:  69%|██████▉   | 76/110 [00:04<00:01, 22.31it/s][5/6] extract embeddings:  72%|███████▏  | 79/110 [00:04<00:01, 21.95it/s][5/6] extract embeddings:  75%|███████▍  | 82/110 [00:04<00:01, 22.07it/s][5/6] extract embeddings:  77%|███████▋  | 85/110 [00:05<00:01, 23.09it/s][5/6] extract embeddings:  80%|████████  | 88/110 [00:05<00:00, 22.56it/s][5/6] extract embeddings:  83%|████████▎ | 91/110 [00:05<00:00, 22.21it/s][5/6] extract embeddings:  85%|████████▌ | 94/110 [00:05<00:00, 21.72it/s][5/6] extract embeddings:  88%|████████▊ | 97/110 [00:05<00:00, 20.81it/s][5/6] extract embeddings:  91%|█████████ | 100/110 [00:05<00:00, 21.11it/s][5/6] extract embeddings:  94%|█████████▎| 103/110 [00:05<00:00, 20.61it/s][5/6] extract embeddings:  96%|█████████▋| 106/110 [00:06<00:00, 20.21it/s][5/6] extract embeddings:  99%|█████████▉| 109/110 [00:06<00:00, 20.12it/s][5/6] extract embeddings: 100%|██████████| 110/110 [00:06<00:00, 17.55it/s]
[NeMo I 2025-04-17 01:02:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:02:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:02:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:02:48 collections:880] Dataset successfully loaded with 14180 items and total duration provided from manifest is  1.93 hours.
[NeMo I 2025-04-17 01:02:48 collections:886] # 14180 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/222 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/222 [00:01<04:27,  1.21s/it][6/6] extract embeddings:   2%|▏         | 4/222 [00:01<00:57,  3.80it/s][6/6] extract embeddings:   3%|▎         | 7/222 [00:01<00:30,  6.99it/s][6/6] extract embeddings:   5%|▍         | 10/222 [00:01<00:20, 10.47it/s][6/6] extract embeddings:   6%|▌         | 13/222 [00:01<00:15, 13.90it/s][6/6] extract embeddings:   7%|▋         | 16/222 [00:01<00:12, 16.94it/s][6/6] extract embeddings:   9%|▊         | 19/222 [00:01<00:10, 19.42it/s][6/6] extract embeddings:  10%|▉         | 22/222 [00:01<00:09, 20.68it/s][6/6] extract embeddings:  11%|█▏        | 25/222 [00:02<00:09, 21.21it/s][6/6] extract embeddings:  13%|█▎        | 28/222 [00:02<00:08, 22.51it/s][6/6] extract embeddings:  14%|█▍        | 31/222 [00:02<00:08, 23.22it/s][6/6] extract embeddings:  15%|█▌        | 34/222 [00:02<00:08, 22.64it/s][6/6] extract embeddings:  17%|█▋        | 37/222 [00:02<00:08, 22.63it/s][6/6] extract embeddings:  18%|█▊        | 40/222 [00:02<00:08, 22.52it/s][6/6] extract embeddings:  19%|█▉        | 43/222 [00:02<00:07, 23.85it/s][6/6] extract embeddings:  21%|██        | 46/222 [00:03<00:07, 24.34it/s][6/6] extract embeddings:  23%|██▎       | 50/222 [00:03<00:06, 26.82it/s][6/6] extract embeddings:  24%|██▍       | 54/222 [00:03<00:06, 27.95it/s][6/6] extract embeddings:  26%|██▌       | 57/222 [00:03<00:06, 26.06it/s][6/6] extract embeddings:  27%|██▋       | 60/222 [00:03<00:06, 24.96it/s][6/6] extract embeddings:  28%|██▊       | 63/222 [00:03<00:06, 25.42it/s][6/6] extract embeddings:  30%|██▉       | 66/222 [00:03<00:06, 24.73it/s][6/6] extract embeddings:  31%|███       | 69/222 [00:03<00:06, 24.71it/s][6/6] extract embeddings:  32%|███▏      | 72/222 [00:03<00:05, 25.35it/s][6/6] extract embeddings:  34%|███▍      | 75/222 [00:04<00:05, 24.99it/s][6/6] extract embeddings:  35%|███▌      | 78/222 [00:04<00:05, 25.08it/s][6/6] extract embeddings:  36%|███▋      | 81/222 [00:04<00:05, 24.73it/s][6/6] extract embeddings:  38%|███▊      | 84/222 [00:04<00:05, 24.33it/s][6/6] extract embeddings:  39%|███▉      | 87/222 [00:04<00:05, 25.05it/s][6/6] extract embeddings:  41%|████      | 90/222 [00:04<00:05, 25.20it/s][6/6] extract embeddings:  42%|████▏     | 93/222 [00:04<00:05, 23.99it/s][6/6] extract embeddings:  43%|████▎     | 96/222 [00:04<00:05, 24.52it/s][6/6] extract embeddings:  45%|████▍     | 99/222 [00:05<00:05, 24.18it/s][6/6] extract embeddings:  46%|████▌     | 102/222 [00:05<00:05, 23.95it/s][6/6] extract embeddings:  47%|████▋     | 105/222 [00:05<00:05, 23.33it/s][6/6] extract embeddings:  49%|████▉     | 109/222 [00:05<00:04, 26.52it/s][6/6] extract embeddings:  50%|█████     | 112/222 [00:05<00:04, 26.94it/s][6/6] extract embeddings:  52%|█████▏    | 115/222 [00:05<00:03, 26.76it/s][6/6] extract embeddings:  53%|█████▎    | 118/222 [00:05<00:03, 26.03it/s][6/6] extract embeddings:  55%|█████▍    | 121/222 [00:05<00:03, 25.34it/s][6/6] extract embeddings:  56%|█████▌    | 124/222 [00:06<00:03, 25.05it/s][6/6] extract embeddings:  57%|█████▋    | 127/222 [00:06<00:03, 25.28it/s][6/6] extract embeddings:  59%|█████▊    | 130/222 [00:06<00:03, 24.70it/s][6/6] extract embeddings:  60%|█████▉    | 133/222 [00:06<00:03, 24.81it/s][6/6] extract embeddings:  61%|██████▏   | 136/222 [00:06<00:03, 25.35it/s][6/6] extract embeddings:  63%|██████▎   | 139/222 [00:06<00:03, 25.58it/s][6/6] extract embeddings:  64%|██████▍   | 142/222 [00:06<00:03, 25.55it/s][6/6] extract embeddings:  65%|██████▌   | 145/222 [00:06<00:02, 25.70it/s][6/6] extract embeddings:  67%|██████▋   | 149/222 [00:07<00:02, 28.61it/s][6/6] extract embeddings:  68%|██████▊   | 152/222 [00:07<00:02, 26.92it/s][6/6] extract embeddings:  70%|██████▉   | 155/222 [00:07<00:02, 25.73it/s][6/6] extract embeddings:  71%|███████   | 158/222 [00:07<00:02, 24.72it/s][6/6] extract embeddings:  73%|███████▎  | 161/222 [00:07<00:02, 25.20it/s][6/6] extract embeddings:  74%|███████▍  | 164/222 [00:07<00:02, 25.91it/s][6/6] extract embeddings:  75%|███████▌  | 167/222 [00:07<00:02, 25.32it/s][6/6] extract embeddings:  77%|███████▋  | 170/222 [00:07<00:02, 25.47it/s][6/6] extract embeddings:  78%|███████▊  | 173/222 [00:07<00:01, 26.20it/s][6/6] extract embeddings:  79%|███████▉  | 176/222 [00:08<00:01, 25.42it/s][6/6] extract embeddings:  81%|████████  | 179/222 [00:08<00:01, 25.86it/s][6/6] extract embeddings:  82%|████████▏ | 182/222 [00:08<00:01, 25.03it/s][6/6] extract embeddings:  83%|████████▎ | 185/222 [00:08<00:01, 25.17it/s][6/6] extract embeddings:  85%|████████▍ | 188/222 [00:08<00:01, 26.40it/s][6/6] extract embeddings:  86%|████████▌ | 191/222 [00:08<00:01, 26.56it/s][6/6] extract embeddings:  87%|████████▋ | 194/222 [00:08<00:01, 26.51it/s][6/6] extract embeddings:  89%|████████▊ | 197/222 [00:08<00:00, 26.50it/s][6/6] extract embeddings:  90%|█████████ | 200/222 [00:09<00:00, 23.74it/s][6/6] extract embeddings:  91%|█████████▏| 203/222 [00:09<00:00, 22.48it/s][6/6] extract embeddings:  93%|█████████▎| 206/222 [00:09<00:00, 21.78it/s][6/6] extract embeddings:  94%|█████████▍| 209/222 [00:09<00:00, 22.16it/s][6/6] extract embeddings:  95%|█████████▌| 212/222 [00:09<00:00, 22.28it/s][6/6] extract embeddings:  97%|█████████▋| 215/222 [00:09<00:00, 21.66it/s][6/6] extract embeddings:  98%|█████████▊| 218/222 [00:09<00:00, 21.01it/s][6/6] extract embeddings: 100%|█████████▉| 221/222 [00:10<00:00, 22.11it/s][6/6] extract embeddings: 100%|██████████| 222/222 [00:10<00:00, 22.00it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.18it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.14it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.74it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.27it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s]
[NeMo I 2025-04-17 01:03:00 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:03:01 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              38.312866   444.120  ...   16.405026  3.693827
    Harker-ES                       28.323524  2178.782  ...   69.142267  3.173437
    Harker-MN                       42.021738   366.767  ...   31.765947  8.661070
    Longfellow-Block-1              21.632630   492.417  ...   11.618975  2.359580
    TOTAL                           30.094247  3482.086  ...  128.932215  3.702729
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:03:01 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0916 | MISS: 0.1723 | CER: 0.0370 | DER: 0.3009 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.45, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.45, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.92s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.96s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:03:14 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:03:14 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:03:14 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:03:14 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:03:14 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:03:14 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:03:14 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:03:14 features:305] PADDING: 16
[NeMo I 2025-04-17 01:03:15 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:03:15 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:03:15 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:03:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:03:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:03:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:03:15 collections:880] Dataset successfully loaded with 2347 items and total duration provided from manifest is  1.57 hours.
[NeMo I 2025-04-17 01:03:15 collections:886] # 2347 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/37 [00:02<01:12,  2.01s/it][1/6] extract embeddings:  11%|█         | 4/37 [00:02<00:13,  2.43it/s][1/6] extract embeddings:  16%|█▌        | 6/37 [00:02<00:08,  3.81it/s][1/6] extract embeddings:  22%|██▏       | 8/37 [00:02<00:05,  5.24it/s][1/6] extract embeddings:  27%|██▋       | 10/37 [00:02<00:04,  6.69it/s][1/6] extract embeddings:  32%|███▏      | 12/37 [00:02<00:03,  8.10it/s][1/6] extract embeddings:  38%|███▊      | 14/37 [00:02<00:02,  9.19it/s][1/6] extract embeddings:  43%|████▎     | 16/37 [00:03<00:02, 10.24it/s][1/6] extract embeddings:  49%|████▊     | 18/37 [00:03<00:01, 11.22it/s][1/6] extract embeddings:  54%|█████▍    | 20/37 [00:03<00:01, 11.83it/s][1/6] extract embeddings:  59%|█████▉    | 22/37 [00:03<00:01, 11.95it/s][1/6] extract embeddings:  65%|██████▍   | 24/37 [00:03<00:01, 12.18it/s][1/6] extract embeddings:  70%|███████   | 26/37 [00:03<00:00, 12.85it/s][1/6] extract embeddings:  76%|███████▌  | 28/37 [00:03<00:00, 13.04it/s][1/6] extract embeddings:  81%|████████  | 30/37 [00:04<00:00, 12.61it/s][1/6] extract embeddings:  86%|████████▋ | 32/37 [00:04<00:00, 12.45it/s][1/6] extract embeddings:  92%|█████████▏| 34/37 [00:04<00:00, 12.40it/s][1/6] extract embeddings:  97%|█████████▋| 36/37 [00:04<00:00, 12.81it/s][1/6] extract embeddings: 100%|██████████| 37/37 [00:04<00:00,  8.02it/s]
[NeMo I 2025-04-17 01:03:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:03:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:03:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:03:19 collections:880] Dataset successfully loaded with 2782 items and total duration provided from manifest is  1.63 hours.
[NeMo I 2025-04-17 01:03:19 collections:886] # 2782 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/44 [00:01<01:06,  1.54s/it][2/6] extract embeddings:   7%|▋         | 3/44 [00:01<00:18,  2.23it/s][2/6] extract embeddings:  11%|█▏        | 5/44 [00:01<00:09,  3.94it/s][2/6] extract embeddings:  16%|█▌        | 7/44 [00:01<00:06,  5.74it/s][2/6] extract embeddings:  20%|██        | 9/44 [00:02<00:04,  7.35it/s][2/6] extract embeddings:  25%|██▌       | 11/44 [00:02<00:03,  8.98it/s][2/6] extract embeddings:  30%|██▉       | 13/44 [00:02<00:03, 10.30it/s][2/6] extract embeddings:  34%|███▍      | 15/44 [00:02<00:02, 11.34it/s][2/6] extract embeddings:  39%|███▊      | 17/44 [00:02<00:02, 12.04it/s][2/6] extract embeddings:  43%|████▎     | 19/44 [00:02<00:01, 12.55it/s][2/6] extract embeddings:  48%|████▊     | 21/44 [00:02<00:01, 13.26it/s][2/6] extract embeddings:  52%|█████▏    | 23/44 [00:03<00:01, 13.89it/s][2/6] extract embeddings:  57%|█████▋    | 25/44 [00:03<00:01, 14.34it/s][2/6] extract embeddings:  61%|██████▏   | 27/44 [00:03<00:01, 14.19it/s][2/6] extract embeddings:  66%|██████▌   | 29/44 [00:03<00:01, 14.58it/s][2/6] extract embeddings:  70%|███████   | 31/44 [00:03<00:00, 14.96it/s][2/6] extract embeddings:  75%|███████▌  | 33/44 [00:03<00:00, 14.80it/s][2/6] extract embeddings:  80%|███████▉  | 35/44 [00:03<00:00, 14.24it/s][2/6] extract embeddings:  84%|████████▍ | 37/44 [00:04<00:00, 14.23it/s][2/6] extract embeddings:  89%|████████▊ | 39/44 [00:04<00:00, 14.01it/s][2/6] extract embeddings:  93%|█████████▎| 41/44 [00:04<00:00, 14.46it/s][2/6] extract embeddings:  98%|█████████▊| 43/44 [00:04<00:00, 14.96it/s][2/6] extract embeddings: 100%|██████████| 44/44 [00:04<00:00,  9.87it/s]
[NeMo I 2025-04-17 01:03:24 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:03:24 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:03:24 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:03:24 collections:880] Dataset successfully loaded with 3435 items and total duration provided from manifest is  1.69 hours.
[NeMo I 2025-04-17 01:03:24 collections:886] # 3435 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/54 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/54 [00:01<01:03,  1.19s/it][3/6] extract embeddings:   6%|▌         | 3/54 [00:01<00:17,  2.87it/s][3/6] extract embeddings:   9%|▉         | 5/54 [00:01<00:09,  5.06it/s][3/6] extract embeddings:  13%|█▎        | 7/54 [00:01<00:06,  7.10it/s][3/6] extract embeddings:  17%|█▋        | 9/54 [00:01<00:04,  9.25it/s][3/6] extract embeddings:  20%|██        | 11/54 [00:01<00:03, 11.15it/s][3/6] extract embeddings:  24%|██▍       | 13/54 [00:01<00:03, 12.57it/s][3/6] extract embeddings:  28%|██▊       | 15/54 [00:01<00:02, 13.70it/s][3/6] extract embeddings:  31%|███▏      | 17/54 [00:02<00:02, 14.30it/s][3/6] extract embeddings:  35%|███▌      | 19/54 [00:02<00:02, 15.02it/s][3/6] extract embeddings:  39%|███▉      | 21/54 [00:02<00:02, 16.04it/s][3/6] extract embeddings:  43%|████▎     | 23/54 [00:02<00:01, 16.58it/s][3/6] extract embeddings:  46%|████▋     | 25/54 [00:02<00:01, 17.08it/s][3/6] extract embeddings:  50%|█████     | 27/54 [00:02<00:01, 17.47it/s][3/6] extract embeddings:  54%|█████▎    | 29/54 [00:02<00:01, 17.08it/s][3/6] extract embeddings:  57%|█████▋    | 31/54 [00:02<00:01, 17.59it/s][3/6] extract embeddings:  61%|██████    | 33/54 [00:03<00:01, 17.13it/s][3/6] extract embeddings:  65%|██████▍   | 35/54 [00:03<00:01, 16.79it/s][3/6] extract embeddings:  70%|███████   | 38/54 [00:03<00:00, 17.77it/s][3/6] extract embeddings:  74%|███████▍  | 40/54 [00:03<00:00, 17.54it/s][3/6] extract embeddings:  78%|███████▊  | 42/54 [00:03<00:00, 16.80it/s][3/6] extract embeddings:  81%|████████▏ | 44/54 [00:03<00:00, 16.64it/s][3/6] extract embeddings:  85%|████████▌ | 46/54 [00:03<00:00, 16.58it/s][3/6] extract embeddings:  89%|████████▉ | 48/54 [00:03<00:00, 17.11it/s][3/6] extract embeddings:  93%|█████████▎| 50/54 [00:04<00:00, 17.17it/s][3/6] extract embeddings:  96%|█████████▋| 52/54 [00:04<00:00, 17.26it/s][3/6] extract embeddings: 100%|██████████| 54/54 [00:04<00:00, 12.71it/s]
[NeMo I 2025-04-17 01:03:29 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:03:29 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:03:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:03:29 collections:880] Dataset successfully loaded with 4569 items and total duration provided from manifest is  1.75 hours.
[NeMo I 2025-04-17 01:03:29 collections:886] # 4569 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/72 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/72 [00:01<01:40,  1.42s/it][4/6] extract embeddings:   6%|▌         | 4/72 [00:01<00:20,  3.25it/s][4/6] extract embeddings:   8%|▊         | 6/72 [00:01<00:12,  5.11it/s][4/6] extract embeddings:  12%|█▎        | 9/72 [00:01<00:07,  8.01it/s][4/6] extract embeddings:  15%|█▌        | 11/72 [00:01<00:06,  9.69it/s][4/6] extract embeddings:  18%|█▊        | 13/72 [00:02<00:05, 11.31it/s][4/6] extract embeddings:  21%|██        | 15/72 [00:02<00:04, 13.04it/s][4/6] extract embeddings:  24%|██▎       | 17/72 [00:02<00:03, 14.23it/s][4/6] extract embeddings:  26%|██▋       | 19/72 [00:02<00:03, 15.26it/s][4/6] extract embeddings:  29%|██▉       | 21/72 [00:02<00:03, 16.24it/s][4/6] extract embeddings:  32%|███▏      | 23/72 [00:02<00:02, 16.96it/s][4/6] extract embeddings:  35%|███▍      | 25/72 [00:02<00:02, 17.01it/s][4/6] extract embeddings:  38%|███▊      | 27/72 [00:02<00:02, 16.99it/s][4/6] extract embeddings:  40%|████      | 29/72 [00:02<00:02, 16.88it/s][4/6] extract embeddings:  44%|████▍     | 32/72 [00:03<00:02, 18.09it/s][4/6] extract embeddings:  47%|████▋     | 34/72 [00:03<00:02, 18.06it/s][4/6] extract embeddings:  50%|█████     | 36/72 [00:03<00:01, 18.16it/s][4/6] extract embeddings:  53%|█████▎    | 38/72 [00:03<00:01, 17.60it/s][4/6] extract embeddings:  57%|█████▋    | 41/72 [00:03<00:01, 18.10it/s][4/6] extract embeddings:  61%|██████    | 44/72 [00:03<00:01, 18.41it/s][4/6] extract embeddings:  64%|██████▍   | 46/72 [00:03<00:01, 18.65it/s][4/6] extract embeddings:  67%|██████▋   | 48/72 [00:03<00:01, 18.35it/s][4/6] extract embeddings:  69%|██████▉   | 50/72 [00:04<00:01, 17.81it/s][4/6] extract embeddings:  72%|███████▏  | 52/72 [00:04<00:01, 17.59it/s][4/6] extract embeddings:  76%|███████▋  | 55/72 [00:04<00:00, 18.26it/s][4/6] extract embeddings:  81%|████████  | 58/72 [00:04<00:00, 19.26it/s][4/6] extract embeddings:  83%|████████▎ | 60/72 [00:04<00:00, 19.41it/s][4/6] extract embeddings:  86%|████████▌ | 62/72 [00:04<00:00, 18.50it/s][4/6] extract embeddings:  89%|████████▉ | 64/72 [00:04<00:00, 18.31it/s][4/6] extract embeddings:  92%|█████████▏| 66/72 [00:04<00:00, 17.78it/s][4/6] extract embeddings:  94%|█████████▍| 68/72 [00:05<00:00, 18.26it/s][4/6] extract embeddings:  97%|█████████▋| 70/72 [00:05<00:00, 17.49it/s][4/6] extract embeddings: 100%|██████████| 72/72 [00:05<00:00, 13.66it/s]
[NeMo I 2025-04-17 01:03:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:03:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:03:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:03:34 collections:880] Dataset successfully loaded with 6896 items and total duration provided from manifest is  1.83 hours.
[NeMo I 2025-04-17 01:03:34 collections:886] # 6896 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/108 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/108 [00:01<02:11,  1.23s/it][5/6] extract embeddings:   4%|▎         | 4/108 [00:01<00:27,  3.72it/s][5/6] extract embeddings:   6%|▌         | 6/108 [00:01<00:17,  5.75it/s][5/6] extract embeddings:   8%|▊         | 9/108 [00:01<00:11,  8.97it/s][5/6] extract embeddings:  10%|█         | 11/108 [00:01<00:09, 10.73it/s][5/6] extract embeddings:  13%|█▎        | 14/108 [00:01<00:06, 13.46it/s][5/6] extract embeddings:  16%|█▌        | 17/108 [00:01<00:05, 15.69it/s][5/6] extract embeddings:  19%|█▊        | 20/108 [00:02<00:04, 17.91it/s][5/6] extract embeddings:  21%|██▏       | 23/108 [00:02<00:04, 18.84it/s][5/6] extract embeddings:  24%|██▍       | 26/108 [00:02<00:04, 19.61it/s][5/6] extract embeddings:  27%|██▋       | 29/108 [00:02<00:04, 19.70it/s][5/6] extract embeddings:  30%|██▉       | 32/108 [00:02<00:03, 20.33it/s][5/6] extract embeddings:  32%|███▏      | 35/108 [00:02<00:03, 20.67it/s][5/6] extract embeddings:  35%|███▌      | 38/108 [00:02<00:03, 20.75it/s][5/6] extract embeddings:  38%|███▊      | 41/108 [00:03<00:03, 20.89it/s][5/6] extract embeddings:  41%|████      | 44/108 [00:03<00:02, 21.66it/s][5/6] extract embeddings:  44%|████▎     | 47/108 [00:03<00:02, 21.77it/s][5/6] extract embeddings:  46%|████▋     | 50/108 [00:03<00:02, 21.76it/s][5/6] extract embeddings:  49%|████▉     | 53/108 [00:03<00:02, 21.34it/s][5/6] extract embeddings:  52%|█████▏    | 56/108 [00:03<00:02, 20.32it/s][5/6] extract embeddings:  55%|█████▍    | 59/108 [00:03<00:02, 20.82it/s][5/6] extract embeddings:  57%|█████▋    | 62/108 [00:04<00:02, 21.06it/s][5/6] extract embeddings:  60%|██████    | 65/108 [00:04<00:02, 20.25it/s][5/6] extract embeddings:  63%|██████▎   | 68/108 [00:04<00:01, 20.42it/s][5/6] extract embeddings:  66%|██████▌   | 71/108 [00:04<00:01, 20.45it/s][5/6] extract embeddings:  69%|██████▊   | 74/108 [00:04<00:01, 20.15it/s][5/6] extract embeddings:  71%|███████▏  | 77/108 [00:04<00:01, 20.19it/s][5/6] extract embeddings:  74%|███████▍  | 80/108 [00:04<00:01, 19.75it/s][5/6] extract embeddings:  77%|███████▋  | 83/108 [00:05<00:01, 20.29it/s][5/6] extract embeddings:  80%|███████▉  | 86/108 [00:05<00:01, 20.57it/s][5/6] extract embeddings:  82%|████████▏ | 89/108 [00:05<00:00, 20.17it/s][5/6] extract embeddings:  85%|████████▌ | 92/108 [00:05<00:00, 19.83it/s][5/6] extract embeddings:  88%|████████▊ | 95/108 [00:05<00:00, 20.57it/s][5/6] extract embeddings:  91%|█████████ | 98/108 [00:05<00:00, 20.77it/s][5/6] extract embeddings:  94%|█████████▎| 101/108 [00:06<00:00, 20.62it/s][5/6] extract embeddings:  96%|█████████▋| 104/108 [00:06<00:00, 20.86it/s][5/6] extract embeddings:  99%|█████████▉| 107/108 [00:06<00:00, 20.63it/s][5/6] extract embeddings: 100%|██████████| 108/108 [00:06<00:00, 16.98it/s]
[NeMo I 2025-04-17 01:03:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:03:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:03:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:03:41 collections:880] Dataset successfully loaded with 14007 items and total duration provided from manifest is  1.91 hours.
[NeMo I 2025-04-17 01:03:41 collections:886] # 14007 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/219 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/219 [00:01<05:04,  1.40s/it][6/6] extract embeddings:   2%|▏         | 4/219 [00:01<01:02,  3.42it/s][6/6] extract embeddings:   3%|▎         | 7/219 [00:01<00:33,  6.24it/s][6/6] extract embeddings:   5%|▍         | 10/219 [00:01<00:22,  9.20it/s][6/6] extract embeddings:   6%|▌         | 13/219 [00:01<00:16, 12.30it/s][6/6] extract embeddings:   7%|▋         | 16/219 [00:01<00:13, 15.12it/s][6/6] extract embeddings:   9%|▊         | 19/219 [00:02<00:11, 18.01it/s][6/6] extract embeddings:  10%|█         | 22/219 [00:02<00:09, 20.63it/s][6/6] extract embeddings:  11%|█▏        | 25/219 [00:02<00:09, 21.25it/s][6/6] extract embeddings:  13%|█▎        | 28/219 [00:02<00:09, 21.10it/s][6/6] extract embeddings:  14%|█▍        | 31/219 [00:02<00:08, 22.08it/s][6/6] extract embeddings:  16%|█▌        | 34/219 [00:02<00:07, 23.68it/s][6/6] extract embeddings:  17%|█▋        | 37/219 [00:02<00:07, 24.79it/s][6/6] extract embeddings:  18%|█▊        | 40/219 [00:02<00:07, 24.24it/s][6/6] extract embeddings:  20%|█▉        | 43/219 [00:03<00:07, 25.12it/s][6/6] extract embeddings:  21%|██        | 46/219 [00:03<00:07, 24.50it/s][6/6] extract embeddings:  22%|██▏       | 49/219 [00:03<00:06, 24.46it/s][6/6] extract embeddings:  24%|██▎       | 52/219 [00:03<00:07, 23.85it/s][6/6] extract embeddings:  25%|██▌       | 55/219 [00:03<00:06, 23.87it/s][6/6] extract embeddings:  26%|██▋       | 58/219 [00:03<00:06, 24.35it/s][6/6] extract embeddings:  28%|██▊       | 61/219 [00:03<00:06, 25.55it/s][6/6] extract embeddings:  29%|██▉       | 64/219 [00:03<00:06, 25.64it/s][6/6] extract embeddings:  31%|███       | 67/219 [00:04<00:05, 25.44it/s][6/6] extract embeddings:  32%|███▏      | 70/219 [00:04<00:05, 24.91it/s][6/6] extract embeddings:  33%|███▎      | 73/219 [00:04<00:05, 25.34it/s][6/6] extract embeddings:  35%|███▍      | 76/219 [00:04<00:05, 25.00it/s][6/6] extract embeddings:  36%|███▌      | 79/219 [00:04<00:05, 24.68it/s][6/6] extract embeddings:  37%|███▋      | 82/219 [00:04<00:05, 25.48it/s][6/6] extract embeddings:  39%|███▉      | 85/219 [00:04<00:05, 25.19it/s][6/6] extract embeddings:  40%|████      | 88/219 [00:04<00:05, 24.89it/s][6/6] extract embeddings:  42%|████▏     | 91/219 [00:04<00:05, 25.04it/s][6/6] extract embeddings:  43%|████▎     | 94/219 [00:05<00:05, 24.10it/s][6/6] extract embeddings:  44%|████▍     | 97/219 [00:05<00:05, 23.94it/s][6/6] extract embeddings:  46%|████▌     | 100/219 [00:05<00:05, 23.72it/s][6/6] extract embeddings:  47%|████▋     | 103/219 [00:05<00:04, 23.56it/s][6/6] extract embeddings:  48%|████▊     | 106/219 [00:05<00:04, 23.98it/s][6/6] extract embeddings:  50%|████▉     | 109/219 [00:05<00:04, 23.96it/s][6/6] extract embeddings:  51%|█████     | 112/219 [00:05<00:04, 23.06it/s][6/6] extract embeddings:  53%|█████▎    | 115/219 [00:06<00:04, 23.51it/s][6/6] extract embeddings:  54%|█████▍    | 118/219 [00:06<00:04, 23.83it/s][6/6] extract embeddings:  55%|█████▌    | 121/219 [00:06<00:03, 25.00it/s][6/6] extract embeddings:  57%|█████▋    | 124/219 [00:06<00:04, 23.38it/s][6/6] extract embeddings:  58%|█████▊    | 127/219 [00:06<00:03, 23.63it/s][6/6] extract embeddings:  59%|█████▉    | 130/219 [00:06<00:03, 24.08it/s][6/6] extract embeddings:  61%|██████    | 133/219 [00:06<00:03, 23.58it/s][6/6] extract embeddings:  62%|██████▏   | 136/219 [00:06<00:03, 24.64it/s][6/6] extract embeddings:  63%|██████▎   | 139/219 [00:07<00:03, 23.90it/s][6/6] extract embeddings:  65%|██████▍   | 142/219 [00:07<00:03, 24.86it/s][6/6] extract embeddings:  67%|██████▋   | 146/219 [00:07<00:02, 27.13it/s][6/6] extract embeddings:  68%|██████▊   | 149/219 [00:07<00:02, 26.80it/s][6/6] extract embeddings:  69%|██████▉   | 152/219 [00:07<00:02, 25.47it/s][6/6] extract embeddings:  71%|███████   | 155/219 [00:07<00:02, 24.69it/s][6/6] extract embeddings:  72%|███████▏  | 158/219 [00:07<00:02, 24.45it/s][6/6] extract embeddings:  74%|███████▎  | 161/219 [00:07<00:02, 25.38it/s][6/6] extract embeddings:  75%|███████▍  | 164/219 [00:07<00:02, 25.78it/s][6/6] extract embeddings:  76%|███████▋  | 167/219 [00:08<00:02, 25.31it/s][6/6] extract embeddings:  78%|███████▊  | 170/219 [00:08<00:01, 24.79it/s][6/6] extract embeddings:  79%|███████▉  | 173/219 [00:08<00:01, 23.52it/s][6/6] extract embeddings:  80%|████████  | 176/219 [00:08<00:01, 24.71it/s][6/6] extract embeddings:  82%|████████▏ | 179/219 [00:08<00:01, 25.45it/s][6/6] extract embeddings:  83%|████████▎ | 182/219 [00:08<00:01, 24.45it/s][6/6] extract embeddings:  84%|████████▍ | 185/219 [00:08<00:01, 24.27it/s][6/6] extract embeddings:  86%|████████▌ | 188/219 [00:08<00:01, 25.34it/s][6/6] extract embeddings:  87%|████████▋ | 191/219 [00:09<00:01, 26.02it/s][6/6] extract embeddings:  89%|████████▊ | 194/219 [00:09<00:00, 25.71it/s][6/6] extract embeddings:  90%|████████▉ | 197/219 [00:09<00:00, 25.31it/s][6/6] extract embeddings:  91%|█████████▏| 200/219 [00:09<00:00, 24.49it/s][6/6] extract embeddings:  93%|█████████▎| 204/219 [00:09<00:00, 27.01it/s][6/6] extract embeddings:  95%|█████████▍| 207/219 [00:09<00:00, 26.56it/s][6/6] extract embeddings:  96%|█████████▌| 210/219 [00:09<00:00, 25.20it/s][6/6] extract embeddings:  97%|█████████▋| 213/219 [00:09<00:00, 24.60it/s][6/6] extract embeddings:  99%|█████████▊| 216/219 [00:10<00:00, 25.70it/s][6/6] extract embeddings: 100%|██████████| 219/219 [00:10<00:00, 25.49it/s][6/6] extract embeddings: 100%|██████████| 219/219 [00:10<00:00, 21.53it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.76it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.10it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.63it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.18it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s]
[NeMo I 2025-04-17 01:03:54 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:03:55 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              38.381545   444.120  ...   16.260014  3.661176
    Harker-ES                       29.910717  2178.782  ...   83.126609  3.815279
    Harker-MN                       42.192719   366.767  ...   32.142943  8.763859
    Longfellow-Block-1              22.298126   492.417  ...   11.140005  2.262311
    TOTAL                           31.208252  3482.086  ...  142.669571  4.097244
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:03:55 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0898 | MISS: 0.1813 | CER: 0.0410 | DER: 0.3121 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.50, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.5, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.79s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:04:08 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:04:08 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:04:08 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:04:08 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:04:08 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:04:08 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:04:08 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:04:08 features:305] PADDING: 16
[NeMo I 2025-04-17 01:04:08 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:04:08 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:04:08 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:04:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:04:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:04:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:04:08 collections:880] Dataset successfully loaded with 2321 items and total duration provided from manifest is  1.53 hours.
[NeMo I 2025-04-17 01:04:08 collections:886] # 2321 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/37 [00:02<01:14,  2.07s/it][1/6] extract embeddings:  11%|█         | 4/37 [00:02<00:14,  2.33it/s][1/6] extract embeddings:  16%|█▌        | 6/37 [00:02<00:08,  3.66it/s][1/6] extract embeddings:  22%|██▏       | 8/37 [00:02<00:05,  5.14it/s][1/6] extract embeddings:  27%|██▋       | 10/37 [00:02<00:04,  6.58it/s][1/6] extract embeddings:  32%|███▏      | 12/37 [00:02<00:03,  7.77it/s][1/6] extract embeddings:  38%|███▊      | 14/37 [00:02<00:02,  8.83it/s][1/6] extract embeddings:  43%|████▎     | 16/37 [00:03<00:02,  9.74it/s][1/6] extract embeddings:  49%|████▊     | 18/37 [00:03<00:01, 10.70it/s][1/6] extract embeddings:  54%|█████▍    | 20/37 [00:03<00:01, 11.18it/s][1/6] extract embeddings:  59%|█████▉    | 22/37 [00:03<00:01, 11.52it/s][1/6] extract embeddings:  65%|██████▍   | 24/37 [00:03<00:01, 11.98it/s][1/6] extract embeddings:  70%|███████   | 26/37 [00:03<00:00, 12.27it/s][1/6] extract embeddings:  76%|███████▌  | 28/37 [00:04<00:00, 12.39it/s][1/6] extract embeddings:  81%|████████  | 30/37 [00:04<00:00, 12.41it/s][1/6] extract embeddings:  86%|████████▋ | 32/37 [00:04<00:00, 12.80it/s][1/6] extract embeddings:  92%|█████████▏| 34/37 [00:04<00:00, 13.41it/s][1/6] extract embeddings:  97%|█████████▋| 36/37 [00:04<00:00, 13.66it/s][1/6] extract embeddings: 100%|██████████| 37/37 [00:04<00:00,  7.91it/s]
[NeMo I 2025-04-17 01:04:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:04:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:04:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:04:13 collections:880] Dataset successfully loaded with 2751 items and total duration provided from manifest is  1.59 hours.
[NeMo I 2025-04-17 01:04:13 collections:886] # 2751 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:54,  1.29s/it][2/6] extract embeddings:   7%|▋         | 3/43 [00:01<00:15,  2.66it/s][2/6] extract embeddings:  12%|█▏        | 5/43 [00:01<00:08,  4.65it/s][2/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:05,  6.80it/s][2/6] extract embeddings:  21%|██        | 9/43 [00:01<00:03,  8.64it/s][2/6] extract embeddings:  26%|██▌       | 11/43 [00:01<00:03, 10.44it/s][2/6] extract embeddings:  30%|███       | 13/43 [00:01<00:02, 12.14it/s][2/6] extract embeddings:  35%|███▍      | 15/43 [00:02<00:02, 12.74it/s][2/6] extract embeddings:  40%|███▉      | 17/43 [00:02<00:01, 13.81it/s][2/6] extract embeddings:  44%|████▍     | 19/43 [00:02<00:01, 13.95it/s][2/6] extract embeddings:  49%|████▉     | 21/43 [00:02<00:01, 13.82it/s][2/6] extract embeddings:  53%|█████▎    | 23/43 [00:02<00:01, 13.95it/s][2/6] extract embeddings:  58%|█████▊    | 25/43 [00:02<00:01, 14.19it/s][2/6] extract embeddings:  63%|██████▎   | 27/43 [00:02<00:01, 13.30it/s][2/6] extract embeddings:  67%|██████▋   | 29/43 [00:03<00:01, 13.64it/s][2/6] extract embeddings:  72%|███████▏  | 31/43 [00:03<00:00, 14.11it/s][2/6] extract embeddings:  77%|███████▋  | 33/43 [00:03<00:00, 13.84it/s][2/6] extract embeddings:  81%|████████▏ | 35/43 [00:03<00:00, 13.60it/s][2/6] extract embeddings:  86%|████████▌ | 37/43 [00:03<00:00, 13.57it/s][2/6] extract embeddings:  91%|█████████ | 39/43 [00:03<00:00, 13.40it/s][2/6] extract embeddings:  95%|█████████▌| 41/43 [00:04<00:00, 13.69it/s][2/6] extract embeddings: 100%|██████████| 43/43 [00:04<00:00, 13.67it/s][2/6] extract embeddings: 100%|██████████| 43/43 [00:04<00:00, 10.29it/s]
[NeMo I 2025-04-17 01:04:18 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:04:18 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:04:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:04:18 collections:880] Dataset successfully loaded with 3383 items and total duration provided from manifest is  1.64 hours.
[NeMo I 2025-04-17 01:04:18 collections:886] # 3383 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/53 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/53 [00:01<01:02,  1.20s/it][3/6] extract embeddings:   8%|▊         | 4/53 [00:01<00:13,  3.69it/s][3/6] extract embeddings:  13%|█▎        | 7/53 [00:01<00:07,  6.54it/s][3/6] extract embeddings:  17%|█▋        | 9/53 [00:01<00:05,  8.08it/s][3/6] extract embeddings:  21%|██        | 11/53 [00:01<00:04,  9.46it/s][3/6] extract embeddings:  25%|██▍       | 13/53 [00:01<00:03, 10.90it/s][3/6] extract embeddings:  28%|██▊       | 15/53 [00:02<00:03, 11.77it/s][3/6] extract embeddings:  32%|███▏      | 17/53 [00:02<00:02, 12.64it/s][3/6] extract embeddings:  36%|███▌      | 19/53 [00:02<00:02, 13.16it/s][3/6] extract embeddings:  40%|███▉      | 21/53 [00:02<00:02, 13.65it/s][3/6] extract embeddings:  43%|████▎     | 23/53 [00:02<00:02, 14.22it/s][3/6] extract embeddings:  47%|████▋     | 25/53 [00:02<00:01, 14.59it/s][3/6] extract embeddings:  51%|█████     | 27/53 [00:02<00:01, 14.88it/s][3/6] extract embeddings:  55%|█████▍    | 29/53 [00:02<00:01, 14.96it/s][3/6] extract embeddings:  58%|█████▊    | 31/53 [00:03<00:01, 15.76it/s][3/6] extract embeddings:  62%|██████▏   | 33/53 [00:03<00:01, 15.33it/s][3/6] extract embeddings:  66%|██████▌   | 35/53 [00:03<00:01, 16.03it/s][3/6] extract embeddings:  70%|██████▉   | 37/53 [00:03<00:00, 16.93it/s][3/6] extract embeddings:  74%|███████▎  | 39/53 [00:03<00:00, 17.22it/s][3/6] extract embeddings:  77%|███████▋  | 41/53 [00:03<00:00, 17.62it/s][3/6] extract embeddings:  81%|████████  | 43/53 [00:03<00:00, 16.60it/s][3/6] extract embeddings:  85%|████████▍ | 45/53 [00:03<00:00, 16.30it/s][3/6] extract embeddings:  89%|████████▊ | 47/53 [00:04<00:00, 16.34it/s][3/6] extract embeddings:  92%|█████████▏| 49/53 [00:04<00:00, 15.99it/s][3/6] extract embeddings:  96%|█████████▌| 51/53 [00:04<00:00, 15.84it/s][3/6] extract embeddings: 100%|██████████| 53/53 [00:04<00:00, 15.75it/s][3/6] extract embeddings: 100%|██████████| 53/53 [00:04<00:00, 11.89it/s]
[NeMo I 2025-04-17 01:04:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:04:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:04:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:04:22 collections:880] Dataset successfully loaded with 4492 items and total duration provided from manifest is  1.71 hours.
[NeMo I 2025-04-17 01:04:22 collections:886] # 4492 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/71 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/71 [00:01<01:24,  1.21s/it][4/6] extract embeddings:   6%|▌         | 4/71 [00:01<00:17,  3.81it/s][4/6] extract embeddings:  10%|▉         | 7/71 [00:01<00:09,  6.86it/s][4/6] extract embeddings:  13%|█▎        | 9/71 [00:01<00:07,  8.71it/s][4/6] extract embeddings:  17%|█▋        | 12/71 [00:01<00:05, 11.48it/s][4/6] extract embeddings:  21%|██        | 15/71 [00:01<00:04, 13.94it/s][4/6] extract embeddings:  25%|██▌       | 18/71 [00:02<00:03, 15.88it/s][4/6] extract embeddings:  30%|██▉       | 21/71 [00:02<00:02, 17.64it/s][4/6] extract embeddings:  34%|███▍      | 24/71 [00:02<00:02, 18.32it/s][4/6] extract embeddings:  38%|███▊      | 27/71 [00:02<00:02, 19.02it/s][4/6] extract embeddings:  42%|████▏     | 30/71 [00:02<00:02, 19.93it/s][4/6] extract embeddings:  46%|████▋     | 33/71 [00:02<00:01, 20.83it/s][4/6] extract embeddings:  51%|█████     | 36/71 [00:02<00:01, 21.01it/s][4/6] extract embeddings:  55%|█████▍    | 39/71 [00:02<00:01, 21.31it/s][4/6] extract embeddings:  59%|█████▉    | 42/71 [00:03<00:01, 21.16it/s][4/6] extract embeddings:  63%|██████▎   | 45/71 [00:03<00:01, 21.47it/s][4/6] extract embeddings:  68%|██████▊   | 48/71 [00:03<00:01, 20.78it/s][4/6] extract embeddings:  72%|███████▏  | 51/71 [00:03<00:00, 20.72it/s][4/6] extract embeddings:  76%|███████▌  | 54/71 [00:03<00:00, 20.24it/s][4/6] extract embeddings:  80%|████████  | 57/71 [00:03<00:00, 20.00it/s][4/6] extract embeddings:  85%|████████▍ | 60/71 [00:04<00:00, 19.42it/s][4/6] extract embeddings:  87%|████████▋ | 62/71 [00:04<00:00, 18.72it/s][4/6] extract embeddings:  90%|█████████ | 64/71 [00:04<00:00, 17.85it/s][4/6] extract embeddings:  93%|█████████▎| 66/71 [00:04<00:00, 17.03it/s][4/6] extract embeddings:  96%|█████████▌| 68/71 [00:04<00:00, 17.29it/s][4/6] extract embeddings:  99%|█████████▊| 70/71 [00:04<00:00, 17.44it/s][4/6] extract embeddings: 100%|██████████| 71/71 [00:04<00:00, 15.13it/s]
[NeMo I 2025-04-17 01:04:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:04:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:04:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:04:27 collections:880] Dataset successfully loaded with 6774 items and total duration provided from manifest is  1.79 hours.
[NeMo I 2025-04-17 01:04:27 collections:886] # 6774 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/106 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/106 [00:01<02:09,  1.23s/it][5/6] extract embeddings:   3%|▎         | 3/106 [00:01<00:36,  2.79it/s][5/6] extract embeddings:   5%|▍         | 5/106 [00:01<00:20,  4.90it/s][5/6] extract embeddings:   7%|▋         | 7/106 [00:01<00:13,  7.12it/s][5/6] extract embeddings:   9%|▉         | 10/106 [00:01<00:09, 10.23it/s][5/6] extract embeddings:  12%|█▏        | 13/106 [00:01<00:07, 13.25it/s][5/6] extract embeddings:  14%|█▍        | 15/106 [00:01<00:06, 14.39it/s][5/6] extract embeddings:  17%|█▋        | 18/106 [00:02<00:05, 16.43it/s][5/6] extract embeddings:  19%|█▉        | 20/106 [00:02<00:05, 16.84it/s][5/6] extract embeddings:  21%|██        | 22/106 [00:02<00:04, 17.01it/s][5/6] extract embeddings:  23%|██▎       | 24/106 [00:02<00:04, 17.58it/s][5/6] extract embeddings:  25%|██▌       | 27/106 [00:02<00:04, 19.03it/s][5/6] extract embeddings:  27%|██▋       | 29/106 [00:02<00:04, 18.67it/s][5/6] extract embeddings:  30%|███       | 32/106 [00:02<00:03, 18.75it/s][5/6] extract embeddings:  32%|███▏      | 34/106 [00:02<00:03, 18.78it/s][5/6] extract embeddings:  34%|███▍      | 36/106 [00:03<00:03, 18.53it/s][5/6] extract embeddings:  36%|███▌      | 38/106 [00:03<00:03, 18.07it/s][5/6] extract embeddings:  38%|███▊      | 40/106 [00:03<00:03, 18.54it/s][5/6] extract embeddings:  40%|███▉      | 42/106 [00:03<00:03, 18.54it/s][5/6] extract embeddings:  42%|████▏     | 44/106 [00:03<00:03, 18.63it/s][5/6] extract embeddings:  44%|████▍     | 47/106 [00:03<00:03, 19.53it/s][5/6] extract embeddings:  47%|████▋     | 50/106 [00:03<00:02, 19.76it/s][5/6] extract embeddings:  50%|█████     | 53/106 [00:03<00:02, 20.18it/s][5/6] extract embeddings:  53%|█████▎    | 56/106 [00:04<00:02, 21.04it/s][5/6] extract embeddings:  56%|█████▌    | 59/106 [00:04<00:02, 21.39it/s][5/6] extract embeddings:  58%|█████▊    | 62/106 [00:04<00:02, 21.16it/s][5/6] extract embeddings:  61%|██████▏   | 65/106 [00:04<00:02, 20.40it/s][5/6] extract embeddings:  64%|██████▍   | 68/106 [00:04<00:01, 20.06it/s][5/6] extract embeddings:  67%|██████▋   | 71/106 [00:04<00:01, 20.43it/s][5/6] extract embeddings:  70%|██████▉   | 74/106 [00:04<00:01, 20.04it/s][5/6] extract embeddings:  73%|███████▎  | 77/106 [00:05<00:01, 19.48it/s][5/6] extract embeddings:  75%|███████▌  | 80/106 [00:05<00:01, 19.68it/s][5/6] extract embeddings:  78%|███████▊  | 83/106 [00:05<00:01, 19.89it/s][5/6] extract embeddings:  81%|████████  | 86/106 [00:05<00:00, 20.66it/s][5/6] extract embeddings:  84%|████████▍ | 89/106 [00:05<00:00, 20.55it/s][5/6] extract embeddings:  87%|████████▋ | 92/106 [00:05<00:00, 20.46it/s][5/6] extract embeddings:  90%|████████▉ | 95/106 [00:05<00:00, 19.60it/s][5/6] extract embeddings:  92%|█████████▏| 98/106 [00:06<00:00, 20.22it/s][5/6] extract embeddings:  95%|█████████▌| 101/106 [00:06<00:00, 20.46it/s][5/6] extract embeddings:  98%|█████████▊| 104/106 [00:06<00:00, 21.09it/s][5/6] extract embeddings: 100%|██████████| 106/106 [00:06<00:00, 16.25it/s]
[NeMo I 2025-04-17 01:04:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:04:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:04:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:04:34 collections:880] Dataset successfully loaded with 13782 items and total duration provided from manifest is  1.87 hours.
[NeMo I 2025-04-17 01:04:34 collections:886] # 13782 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/216 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/216 [00:01<06:02,  1.69s/it][6/6] extract embeddings:   2%|▏         | 4/216 [00:01<01:15,  2.82it/s][6/6] extract embeddings:   3%|▎         | 7/216 [00:01<00:38,  5.38it/s][6/6] extract embeddings:   5%|▍         | 10/216 [00:02<00:25,  8.20it/s][6/6] extract embeddings:   6%|▌         | 13/216 [00:02<00:18, 11.12it/s][6/6] extract embeddings:   7%|▋         | 16/216 [00:02<00:14, 14.27it/s][6/6] extract embeddings:   9%|▉         | 20/216 [00:02<00:10, 18.40it/s][6/6] extract embeddings:  11%|█         | 23/216 [00:02<00:09, 19.53it/s][6/6] extract embeddings:  12%|█▏        | 26/216 [00:02<00:09, 20.06it/s][6/6] extract embeddings:  13%|█▎        | 29/216 [00:02<00:09, 20.62it/s][6/6] extract embeddings:  15%|█▍        | 32/216 [00:02<00:08, 22.04it/s][6/6] extract embeddings:  16%|█▌        | 35/216 [00:03<00:08, 22.36it/s][6/6] extract embeddings:  18%|█▊        | 38/216 [00:03<00:07, 23.01it/s][6/6] extract embeddings:  19%|█▉        | 41/216 [00:03<00:07, 22.98it/s][6/6] extract embeddings:  20%|██        | 44/216 [00:03<00:07, 23.14it/s][6/6] extract embeddings:  22%|██▏       | 47/216 [00:03<00:07, 22.80it/s][6/6] extract embeddings:  23%|██▎       | 50/216 [00:03<00:07, 23.20it/s][6/6] extract embeddings:  25%|██▍       | 53/216 [00:03<00:06, 23.45it/s][6/6] extract embeddings:  26%|██▋       | 57/216 [00:03<00:06, 25.84it/s][6/6] extract embeddings:  28%|██▊       | 60/216 [00:04<00:05, 26.16it/s][6/6] extract embeddings:  29%|██▉       | 63/216 [00:04<00:05, 26.01it/s][6/6] extract embeddings:  31%|███       | 66/216 [00:04<00:06, 24.03it/s][6/6] extract embeddings:  32%|███▏      | 69/216 [00:04<00:06, 23.55it/s][6/6] extract embeddings:  33%|███▎      | 72/216 [00:04<00:05, 24.18it/s][6/6] extract embeddings:  35%|███▍      | 75/216 [00:04<00:05, 23.54it/s][6/6] extract embeddings:  36%|███▌      | 78/216 [00:04<00:05, 24.25it/s][6/6] extract embeddings:  38%|███▊      | 81/216 [00:04<00:05, 25.20it/s][6/6] extract embeddings:  39%|███▉      | 84/216 [00:05<00:05, 25.22it/s][6/6] extract embeddings:  40%|████      | 87/216 [00:05<00:05, 24.83it/s][6/6] extract embeddings:  42%|████▏     | 90/216 [00:05<00:05, 23.99it/s][6/6] extract embeddings:  43%|████▎     | 93/216 [00:05<00:05, 23.01it/s][6/6] extract embeddings:  44%|████▍     | 96/216 [00:05<00:05, 23.23it/s][6/6] extract embeddings:  46%|████▌     | 99/216 [00:05<00:05, 22.71it/s][6/6] extract embeddings:  47%|████▋     | 102/216 [00:05<00:04, 23.03it/s][6/6] extract embeddings:  49%|████▊     | 105/216 [00:05<00:04, 23.17it/s][6/6] extract embeddings:  50%|█████     | 108/216 [00:06<00:04, 23.04it/s][6/6] extract embeddings:  51%|█████▏    | 111/216 [00:06<00:04, 24.40it/s][6/6] extract embeddings:  53%|█████▎    | 114/216 [00:06<00:04, 24.61it/s][6/6] extract embeddings:  54%|█████▍    | 117/216 [00:06<00:04, 24.60it/s][6/6] extract embeddings:  56%|█████▌    | 120/216 [00:06<00:03, 24.48it/s][6/6] extract embeddings:  57%|█████▋    | 123/216 [00:06<00:03, 23.42it/s][6/6] extract embeddings:  58%|█████▊    | 126/216 [00:06<00:03, 24.21it/s][6/6] extract embeddings:  60%|█████▉    | 129/216 [00:06<00:03, 25.13it/s][6/6] extract embeddings:  61%|██████    | 132/216 [00:07<00:03, 23.29it/s][6/6] extract embeddings:  62%|██████▎   | 135/216 [00:07<00:03, 23.71it/s][6/6] extract embeddings:  64%|██████▍   | 138/216 [00:07<00:03, 23.86it/s][6/6] extract embeddings:  65%|██████▌   | 141/216 [00:07<00:03, 24.53it/s][6/6] extract embeddings:  67%|██████▋   | 144/216 [00:07<00:03, 23.54it/s][6/6] extract embeddings:  68%|██████▊   | 147/216 [00:07<00:02, 23.16it/s][6/6] extract embeddings:  69%|██████▉   | 150/216 [00:07<00:02, 22.16it/s][6/6] extract embeddings:  71%|███████   | 153/216 [00:07<00:02, 22.20it/s][6/6] extract embeddings:  72%|███████▏  | 156/216 [00:08<00:02, 22.49it/s][6/6] extract embeddings:  74%|███████▎  | 159/216 [00:08<00:02, 22.01it/s][6/6] extract embeddings:  75%|███████▌  | 162/216 [00:08<00:02, 23.14it/s][6/6] extract embeddings:  76%|███████▋  | 165/216 [00:08<00:02, 22.03it/s][6/6] extract embeddings:  78%|███████▊  | 168/216 [00:08<00:02, 22.92it/s][6/6] extract embeddings:  79%|███████▉  | 171/216 [00:08<00:01, 23.82it/s][6/6] extract embeddings:  81%|████████  | 175/216 [00:08<00:01, 25.20it/s][6/6] extract embeddings:  82%|████████▏ | 178/216 [00:09<00:01, 24.74it/s][6/6] extract embeddings:  84%|████████▍ | 181/216 [00:09<00:01, 25.54it/s][6/6] extract embeddings:  85%|████████▌ | 184/216 [00:09<00:01, 25.11it/s][6/6] extract embeddings:  87%|████████▋ | 187/216 [00:09<00:01, 24.94it/s][6/6] extract embeddings:  88%|████████▊ | 190/216 [00:09<00:01, 23.94it/s][6/6] extract embeddings:  89%|████████▉ | 193/216 [00:09<00:00, 23.79it/s][6/6] extract embeddings:  91%|█████████ | 196/216 [00:09<00:00, 23.34it/s][6/6] extract embeddings:  92%|█████████▏| 199/216 [00:09<00:00, 23.81it/s][6/6] extract embeddings:  94%|█████████▎| 202/216 [00:10<00:00, 23.89it/s][6/6] extract embeddings:  95%|█████████▍| 205/216 [00:10<00:00, 24.27it/s][6/6] extract embeddings:  96%|█████████▋| 208/216 [00:10<00:00, 23.55it/s][6/6] extract embeddings:  98%|█████████▊| 211/216 [00:10<00:00, 24.09it/s][6/6] extract embeddings:  99%|█████████▉| 214/216 [00:10<00:00, 23.28it/s][6/6] extract embeddings: 100%|██████████| 216/216 [00:10<00:00, 20.30it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.95it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.18it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.74it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.31it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.94it/s]
[NeMo I 2025-04-17 01:04:47 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:04:48 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              38.116989   444.120  ...   14.685009  3.306541
    Harker-ES                       30.209527  2178.782  ...   69.585355  3.193773
    Harker-MN                       42.570331   366.767  ...   32.404904  8.835283
    Longfellow-Block-1              23.538339   492.417  ...   10.597955  2.152232
    TOTAL                           31.576636  3482.086  ...  127.273223  3.655086
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:04:48 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0873 | MISS: 0.1919 | CER: 0.0366 | DER: 0.3158 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.55, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.55, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.83s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:05:01 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:05:01 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:05:01 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:05:01 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:05:01 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:05:02 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:05:02 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:05:02 features:305] PADDING: 16
[NeMo I 2025-04-17 01:05:02 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:05:02 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:05:02 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:05:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:05:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:05:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:05:02 collections:880] Dataset successfully loaded with 2299 items and total duration provided from manifest is  1.49 hours.
[NeMo I 2025-04-17 01:05:02 collections:886] # 2299 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/36 [00:02<01:12,  2.07s/it][1/6] extract embeddings:  11%|█         | 4/36 [00:02<00:13,  2.35it/s][1/6] extract embeddings:  17%|█▋        | 6/36 [00:02<00:08,  3.70it/s][1/6] extract embeddings:  22%|██▏       | 8/36 [00:02<00:05,  5.22it/s][1/6] extract embeddings:  28%|██▊       | 10/36 [00:02<00:03,  6.70it/s][1/6] extract embeddings:  33%|███▎      | 12/36 [00:02<00:03,  7.96it/s][1/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:02,  9.55it/s][1/6] extract embeddings:  44%|████▍     | 16/36 [00:03<00:01, 10.64it/s][1/6] extract embeddings:  50%|█████     | 18/36 [00:03<00:01, 11.82it/s][1/6] extract embeddings:  56%|█████▌    | 20/36 [00:03<00:01, 12.26it/s][1/6] extract embeddings:  61%|██████    | 22/36 [00:03<00:01, 12.42it/s][1/6] extract embeddings:  67%|██████▋   | 24/36 [00:03<00:00, 12.96it/s][1/6] extract embeddings:  72%|███████▏  | 26/36 [00:03<00:00, 13.46it/s][1/6] extract embeddings:  78%|███████▊  | 28/36 [00:03<00:00, 13.61it/s][1/6] extract embeddings:  83%|████████▎ | 30/36 [00:04<00:00, 13.61it/s][1/6] extract embeddings:  89%|████████▉ | 32/36 [00:04<00:00, 13.47it/s][1/6] extract embeddings:  94%|█████████▍| 34/36 [00:04<00:00, 13.88it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00, 14.22it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00,  8.05it/s]
[NeMo I 2025-04-17 01:05:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:05:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:05:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:05:07 collections:880] Dataset successfully loaded with 2711 items and total duration provided from manifest is  1.55 hours.
[NeMo I 2025-04-17 01:05:07 collections:886] # 2711 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:59,  1.43s/it][2/6] extract embeddings:   7%|▋         | 3/43 [00:01<00:16,  2.39it/s][2/6] extract embeddings:  12%|█▏        | 5/43 [00:01<00:09,  4.17it/s][2/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:06,  5.97it/s][2/6] extract embeddings:  21%|██        | 9/43 [00:01<00:04,  8.00it/s][2/6] extract embeddings:  26%|██▌       | 11/43 [00:02<00:03,  9.78it/s][2/6] extract embeddings:  30%|███       | 13/43 [00:02<00:02, 10.83it/s][2/6] extract embeddings:  35%|███▍      | 15/43 [00:02<00:02, 11.80it/s][2/6] extract embeddings:  40%|███▉      | 17/43 [00:02<00:02, 12.82it/s][2/6] extract embeddings:  44%|████▍     | 19/43 [00:02<00:01, 13.11it/s][2/6] extract embeddings:  49%|████▉     | 21/43 [00:02<00:01, 13.79it/s][2/6] extract embeddings:  53%|█████▎    | 23/43 [00:02<00:01, 13.85it/s][2/6] extract embeddings:  58%|█████▊    | 25/43 [00:03<00:01, 14.18it/s][2/6] extract embeddings:  63%|██████▎   | 27/43 [00:03<00:01, 14.14it/s][2/6] extract embeddings:  67%|██████▋   | 29/43 [00:03<00:00, 14.84it/s][2/6] extract embeddings:  72%|███████▏  | 31/43 [00:03<00:00, 14.67it/s][2/6] extract embeddings:  77%|███████▋  | 33/43 [00:03<00:00, 14.72it/s][2/6] extract embeddings:  81%|████████▏ | 35/43 [00:03<00:00, 14.16it/s][2/6] extract embeddings:  86%|████████▌ | 37/43 [00:03<00:00, 14.59it/s][2/6] extract embeddings:  91%|█████████ | 39/43 [00:03<00:00, 15.16it/s][2/6] extract embeddings:  95%|█████████▌| 41/43 [00:04<00:00, 14.97it/s][2/6] extract embeddings: 100%|██████████| 43/43 [00:04<00:00, 16.12it/s][2/6] extract embeddings: 100%|██████████| 43/43 [00:04<00:00, 10.15it/s]
[NeMo I 2025-04-17 01:05:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:05:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:05:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:05:11 collections:880] Dataset successfully loaded with 3325 items and total duration provided from manifest is  1.60 hours.
[NeMo I 2025-04-17 01:05:11 collections:886] # 3325 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/52 [00:01<01:02,  1.22s/it][3/6] extract embeddings:   6%|▌         | 3/52 [00:01<00:17,  2.75it/s][3/6] extract embeddings:  10%|▉         | 5/52 [00:01<00:09,  4.74it/s][3/6] extract embeddings:  13%|█▎        | 7/52 [00:01<00:06,  6.75it/s][3/6] extract embeddings:  17%|█▋        | 9/52 [00:01<00:05,  8.46it/s][3/6] extract embeddings:  21%|██        | 11/52 [00:01<00:04, 10.00it/s][3/6] extract embeddings:  25%|██▌       | 13/52 [00:01<00:03, 11.58it/s][3/6] extract embeddings:  29%|██▉       | 15/52 [00:02<00:02, 12.66it/s][3/6] extract embeddings:  33%|███▎      | 17/52 [00:02<00:02, 13.47it/s][3/6] extract embeddings:  37%|███▋      | 19/52 [00:02<00:02, 13.56it/s][3/6] extract embeddings:  40%|████      | 21/52 [00:02<00:02, 13.59it/s][3/6] extract embeddings:  44%|████▍     | 23/52 [00:02<00:02, 14.47it/s][3/6] extract embeddings:  48%|████▊     | 25/52 [00:02<00:01, 14.99it/s][3/6] extract embeddings:  52%|█████▏    | 27/52 [00:02<00:01, 15.17it/s][3/6] extract embeddings:  56%|█████▌    | 29/52 [00:03<00:01, 15.51it/s][3/6] extract embeddings:  60%|█████▉    | 31/52 [00:03<00:01, 15.32it/s][3/6] extract embeddings:  63%|██████▎   | 33/52 [00:03<00:01, 15.56it/s][3/6] extract embeddings:  67%|██████▋   | 35/52 [00:03<00:01, 15.45it/s][3/6] extract embeddings:  71%|███████   | 37/52 [00:03<00:01, 14.78it/s][3/6] extract embeddings:  75%|███████▌  | 39/52 [00:03<00:00, 15.24it/s][3/6] extract embeddings:  79%|███████▉  | 41/52 [00:03<00:00, 15.37it/s][3/6] extract embeddings:  83%|████████▎ | 43/52 [00:03<00:00, 14.99it/s][3/6] extract embeddings:  87%|████████▋ | 45/52 [00:04<00:00, 15.16it/s][3/6] extract embeddings:  90%|█████████ | 47/52 [00:04<00:00, 15.44it/s][3/6] extract embeddings:  94%|█████████▍| 49/52 [00:04<00:00, 15.64it/s][3/6] extract embeddings:  98%|█████████▊| 51/52 [00:04<00:00, 15.78it/s][3/6] extract embeddings: 100%|██████████| 52/52 [00:04<00:00, 11.43it/s]
[NeMo I 2025-04-17 01:05:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:05:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:05:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:05:16 collections:880] Dataset successfully loaded with 4413 items and total duration provided from manifest is  1.67 hours.
[NeMo I 2025-04-17 01:05:16 collections:886] # 4413 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/69 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/69 [00:01<01:20,  1.19s/it][4/6] extract embeddings:   6%|▌         | 4/69 [00:01<00:17,  3.78it/s][4/6] extract embeddings:   9%|▊         | 6/69 [00:01<00:10,  5.83it/s][4/6] extract embeddings:  13%|█▎        | 9/69 [00:01<00:06,  8.87it/s][4/6] extract embeddings:  16%|█▌        | 11/69 [00:01<00:05, 10.54it/s][4/6] extract embeddings:  19%|█▉        | 13/69 [00:01<00:04, 11.96it/s][4/6] extract embeddings:  22%|██▏       | 15/69 [00:01<00:04, 13.05it/s][4/6] extract embeddings:  25%|██▍       | 17/69 [00:02<00:03, 14.40it/s][4/6] extract embeddings:  28%|██▊       | 19/69 [00:02<00:03, 15.30it/s][4/6] extract embeddings:  30%|███       | 21/69 [00:02<00:03, 15.76it/s][4/6] extract embeddings:  33%|███▎      | 23/69 [00:02<00:02, 15.95it/s][4/6] extract embeddings:  36%|███▌      | 25/69 [00:02<00:02, 16.32it/s][4/6] extract embeddings:  39%|███▉      | 27/69 [00:02<00:02, 16.75it/s][4/6] extract embeddings:  42%|████▏     | 29/69 [00:02<00:02, 17.22it/s][4/6] extract embeddings:  45%|████▍     | 31/69 [00:02<00:02, 16.84it/s][4/6] extract embeddings:  48%|████▊     | 33/69 [00:02<00:02, 17.34it/s][4/6] extract embeddings:  51%|█████     | 35/69 [00:03<00:01, 17.53it/s][4/6] extract embeddings:  54%|█████▎    | 37/69 [00:03<00:01, 17.26it/s][4/6] extract embeddings:  57%|█████▋    | 39/69 [00:03<00:01, 17.25it/s][4/6] extract embeddings:  59%|█████▉    | 41/69 [00:03<00:01, 16.76it/s][4/6] extract embeddings:  62%|██████▏   | 43/69 [00:03<00:01, 17.14it/s][4/6] extract embeddings:  65%|██████▌   | 45/69 [00:03<00:01, 17.43it/s][4/6] extract embeddings:  68%|██████▊   | 47/69 [00:03<00:01, 17.52it/s][4/6] extract embeddings:  71%|███████   | 49/69 [00:03<00:01, 17.91it/s][4/6] extract embeddings:  74%|███████▍  | 51/69 [00:04<00:01, 17.46it/s][4/6] extract embeddings:  77%|███████▋  | 53/69 [00:04<00:00, 17.57it/s][4/6] extract embeddings:  80%|███████▉  | 55/69 [00:04<00:00, 17.85it/s][4/6] extract embeddings:  83%|████████▎ | 57/69 [00:04<00:00, 17.85it/s][4/6] extract embeddings:  87%|████████▋ | 60/69 [00:04<00:00, 18.61it/s][4/6] extract embeddings:  90%|████████▉ | 62/69 [00:04<00:00, 17.98it/s][4/6] extract embeddings:  93%|█████████▎| 64/69 [00:04<00:00, 17.88it/s][4/6] extract embeddings:  96%|█████████▌| 66/69 [00:04<00:00, 18.10it/s][4/6] extract embeddings:  99%|█████████▊| 68/69 [00:04<00:00, 17.68it/s][4/6] extract embeddings: 100%|██████████| 69/69 [00:05<00:00, 13.67it/s]
[NeMo I 2025-04-17 01:05:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:05:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:05:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:05:21 collections:880] Dataset successfully loaded with 6657 items and total duration provided from manifest is  1.75 hours.
[NeMo I 2025-04-17 01:05:21 collections:886] # 6657 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/105 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/105 [00:01<02:03,  1.19s/it][5/6] extract embeddings:   4%|▍         | 4/105 [00:01<00:25,  3.90it/s][5/6] extract embeddings:   7%|▋         | 7/105 [00:01<00:14,  6.97it/s][5/6] extract embeddings:  10%|▉         | 10/105 [00:01<00:09, 10.18it/s][5/6] extract embeddings:  12%|█▏        | 13/105 [00:01<00:07, 12.87it/s][5/6] extract embeddings:  15%|█▌        | 16/105 [00:01<00:06, 14.81it/s][5/6] extract embeddings:  18%|█▊        | 19/105 [00:01<00:05, 16.36it/s][5/6] extract embeddings:  21%|██        | 22/105 [00:02<00:04, 18.22it/s][5/6] extract embeddings:  24%|██▍       | 25/105 [00:02<00:04, 18.95it/s][5/6] extract embeddings:  27%|██▋       | 28/105 [00:02<00:03, 20.09it/s][5/6] extract embeddings:  30%|██▉       | 31/105 [00:02<00:03, 20.17it/s][5/6] extract embeddings:  32%|███▏      | 34/105 [00:02<00:03, 20.35it/s][5/6] extract embeddings:  35%|███▌      | 37/105 [00:02<00:03, 20.83it/s][5/6] extract embeddings:  38%|███▊      | 40/105 [00:02<00:02, 21.72it/s][5/6] extract embeddings:  41%|████      | 43/105 [00:03<00:02, 22.29it/s][5/6] extract embeddings:  44%|████▍     | 46/105 [00:03<00:02, 23.14it/s][5/6] extract embeddings:  47%|████▋     | 49/105 [00:03<00:02, 23.24it/s][5/6] extract embeddings:  50%|████▉     | 52/105 [00:03<00:02, 22.81it/s][5/6] extract embeddings:  52%|█████▏    | 55/105 [00:03<00:02, 22.20it/s][5/6] extract embeddings:  55%|█████▌    | 58/105 [00:03<00:02, 21.85it/s][5/6] extract embeddings:  58%|█████▊    | 61/105 [00:03<00:01, 22.91it/s][5/6] extract embeddings:  61%|██████    | 64/105 [00:03<00:01, 22.24it/s][5/6] extract embeddings:  64%|██████▍   | 67/105 [00:04<00:01, 22.86it/s][5/6] extract embeddings:  67%|██████▋   | 70/105 [00:04<00:01, 22.21it/s][5/6] extract embeddings:  70%|██████▉   | 73/105 [00:04<00:01, 20.87it/s][5/6] extract embeddings:  72%|███████▏  | 76/105 [00:04<00:01, 20.71it/s][5/6] extract embeddings:  75%|███████▌  | 79/105 [00:04<00:01, 20.39it/s][5/6] extract embeddings:  78%|███████▊  | 82/105 [00:04<00:01, 20.18it/s][5/6] extract embeddings:  81%|████████  | 85/105 [00:05<00:00, 20.54it/s][5/6] extract embeddings:  84%|████████▍ | 88/105 [00:05<00:00, 20.63it/s][5/6] extract embeddings:  87%|████████▋ | 91/105 [00:05<00:00, 21.04it/s][5/6] extract embeddings:  90%|████████▉ | 94/105 [00:05<00:00, 20.46it/s][5/6] extract embeddings:  92%|█████████▏| 97/105 [00:05<00:00, 20.40it/s][5/6] extract embeddings:  95%|█████████▌| 100/105 [00:05<00:00, 21.05it/s][5/6] extract embeddings:  98%|█████████▊| 103/105 [00:05<00:00, 20.80it/s][5/6] extract embeddings: 100%|██████████| 105/105 [00:05<00:00, 17.51it/s]
[NeMo I 2025-04-17 01:05:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:05:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:05:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:05:28 collections:880] Dataset successfully loaded with 13561 items and total duration provided from manifest is  1.84 hours.
[NeMo I 2025-04-17 01:05:28 collections:886] # 13561 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/212 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/212 [00:01<04:28,  1.27s/it][6/6] extract embeddings:   2%|▏         | 4/212 [00:01<00:57,  3.62it/s][6/6] extract embeddings:   3%|▎         | 6/212 [00:01<00:36,  5.59it/s][6/6] extract embeddings:   4%|▍         | 9/212 [00:01<00:22,  8.95it/s][6/6] extract embeddings:   6%|▌         | 12/212 [00:01<00:16, 12.21it/s][6/6] extract embeddings:   7%|▋         | 15/212 [00:01<00:12, 15.36it/s][6/6] extract embeddings:   8%|▊         | 18/212 [00:01<00:11, 17.60it/s][6/6] extract embeddings:  10%|█         | 22/212 [00:02<00:08, 21.26it/s][6/6] extract embeddings:  12%|█▏        | 26/212 [00:02<00:07, 23.26it/s][6/6] extract embeddings:  14%|█▎        | 29/212 [00:02<00:07, 23.72it/s][6/6] extract embeddings:  15%|█▌        | 32/212 [00:02<00:07, 24.25it/s][6/6] extract embeddings:  17%|█▋        | 35/212 [00:02<00:07, 23.95it/s][6/6] extract embeddings:  18%|█▊        | 38/212 [00:02<00:07, 23.25it/s][6/6] extract embeddings:  19%|█▉        | 41/212 [00:02<00:07, 24.21it/s][6/6] extract embeddings:  21%|██        | 44/212 [00:03<00:07, 23.08it/s][6/6] extract embeddings:  22%|██▏       | 47/212 [00:03<00:06, 23.62it/s][6/6] extract embeddings:  24%|██▎       | 50/212 [00:03<00:06, 24.02it/s][6/6] extract embeddings:  25%|██▌       | 53/212 [00:03<00:06, 24.78it/s][6/6] extract embeddings:  26%|██▋       | 56/212 [00:03<00:06, 24.04it/s][6/6] extract embeddings:  28%|██▊       | 59/212 [00:03<00:06, 24.65it/s][6/6] extract embeddings:  29%|██▉       | 62/212 [00:03<00:06, 24.51it/s][6/6] extract embeddings:  31%|███       | 65/212 [00:03<00:06, 23.68it/s][6/6] extract embeddings:  32%|███▏      | 68/212 [00:04<00:06, 23.16it/s][6/6] extract embeddings:  33%|███▎      | 71/212 [00:04<00:05, 23.63it/s][6/6] extract embeddings:  35%|███▍      | 74/212 [00:04<00:05, 23.24it/s][6/6] extract embeddings:  36%|███▋      | 77/212 [00:04<00:05, 23.74it/s][6/6] extract embeddings:  38%|███▊      | 80/212 [00:04<00:05, 24.06it/s][6/6] extract embeddings:  39%|███▉      | 83/212 [00:04<00:05, 25.54it/s][6/6] extract embeddings:  41%|████      | 86/212 [00:04<00:05, 24.82it/s][6/6] extract embeddings:  42%|████▏     | 89/212 [00:04<00:04, 25.79it/s][6/6] extract embeddings:  43%|████▎     | 92/212 [00:04<00:04, 26.35it/s][6/6] extract embeddings:  45%|████▍     | 95/212 [00:05<00:04, 26.16it/s][6/6] extract embeddings:  46%|████▌     | 98/212 [00:05<00:04, 25.72it/s][6/6] extract embeddings:  48%|████▊     | 101/212 [00:05<00:04, 24.18it/s][6/6] extract embeddings:  49%|████▉     | 104/212 [00:05<00:04, 25.38it/s][6/6] extract embeddings:  50%|█████     | 107/212 [00:05<00:04, 25.44it/s][6/6] extract embeddings:  52%|█████▏    | 110/212 [00:05<00:04, 25.44it/s][6/6] extract embeddings:  53%|█████▎    | 113/212 [00:05<00:03, 25.97it/s][6/6] extract embeddings:  55%|█████▍    | 116/212 [00:05<00:03, 26.63it/s][6/6] extract embeddings:  56%|█████▌    | 119/212 [00:06<00:03, 25.09it/s][6/6] extract embeddings:  58%|█████▊    | 122/212 [00:06<00:03, 24.13it/s][6/6] extract embeddings:  59%|█████▉    | 125/212 [00:06<00:03, 23.43it/s][6/6] extract embeddings:  60%|██████    | 128/212 [00:06<00:03, 23.35it/s][6/6] extract embeddings:  62%|██████▏   | 131/212 [00:06<00:03, 24.05it/s][6/6] extract embeddings:  64%|██████▎   | 135/212 [00:06<00:02, 26.43it/s][6/6] extract embeddings:  65%|██████▌   | 138/212 [00:06<00:02, 27.11it/s][6/6] extract embeddings:  67%|██████▋   | 141/212 [00:06<00:02, 26.72it/s][6/6] extract embeddings:  68%|██████▊   | 145/212 [00:07<00:02, 28.18it/s][6/6] extract embeddings:  70%|██████▉   | 148/212 [00:07<00:02, 27.96it/s][6/6] extract embeddings:  71%|███████   | 151/212 [00:07<00:02, 27.21it/s][6/6] extract embeddings:  73%|███████▎  | 154/212 [00:07<00:02, 26.27it/s][6/6] extract embeddings:  74%|███████▍  | 157/212 [00:07<00:02, 24.52it/s][6/6] extract embeddings:  75%|███████▌  | 160/212 [00:07<00:02, 24.05it/s][6/6] extract embeddings:  77%|███████▋  | 163/212 [00:07<00:02, 24.13it/s][6/6] extract embeddings:  78%|███████▊  | 166/212 [00:07<00:01, 24.51it/s][6/6] extract embeddings:  80%|███████▉  | 169/212 [00:08<00:01, 23.93it/s][6/6] extract embeddings:  81%|████████  | 172/212 [00:08<00:01, 22.75it/s][6/6] extract embeddings:  83%|████████▎ | 175/212 [00:08<00:01, 22.81it/s][6/6] extract embeddings:  84%|████████▍ | 178/212 [00:08<00:01, 22.26it/s][6/6] extract embeddings:  85%|████████▌ | 181/212 [00:08<00:01, 21.69it/s][6/6] extract embeddings:  87%|████████▋ | 184/212 [00:08<00:01, 21.29it/s][6/6] extract embeddings:  88%|████████▊ | 187/212 [00:08<00:01, 20.55it/s][6/6] extract embeddings:  90%|████████▉ | 190/212 [00:09<00:01, 20.04it/s][6/6] extract embeddings:  91%|█████████ | 193/212 [00:09<00:00, 20.10it/s][6/6] extract embeddings:  92%|█████████▏| 196/212 [00:09<00:00, 20.76it/s][6/6] extract embeddings:  94%|█████████▍| 199/212 [00:09<00:00, 22.76it/s][6/6] extract embeddings:  95%|█████████▌| 202/212 [00:09<00:00, 22.97it/s][6/6] extract embeddings:  97%|█████████▋| 205/212 [00:09<00:00, 23.32it/s][6/6] extract embeddings:  98%|█████████▊| 208/212 [00:09<00:00, 23.16it/s][6/6] extract embeddings: 100%|█████████▉| 211/212 [00:09<00:00, 22.87it/s][6/6] extract embeddings: 100%|██████████| 212/212 [00:10<00:00, 21.18it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.16it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.26it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.84it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.41it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s]
[NeMo I 2025-04-17 01:05:40 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:05:41 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              39.383534   444.120  ...   16.109968  3.627391
    Harker-ES                       31.153831  2178.782  ...   72.390992  3.322544
    Harker-MN                       43.496254   366.767  ...   33.542921  9.145567
    Longfellow-Block-1              24.489773   492.417  ...   10.374977  2.106949
    TOTAL                           32.561112  3482.086  ...  132.418858  3.802860
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:05:41 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0854 | MISS: 0.2022 | CER: 0.0380 | DER: 0.3256 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.91s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:05:55 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:05:55 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:05:55 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:05:55 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:05:55 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:05:55 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:05:55 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:05:55 features:305] PADDING: 16
[NeMo I 2025-04-17 01:05:55 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:05:55 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:05:55 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:05:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:05:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:05:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:05:55 collections:880] Dataset successfully loaded with 2274 items and total duration provided from manifest is  1.45 hours.
[NeMo I 2025-04-17 01:05:55 collections:886] # 2274 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/36 [00:02<01:11,  2.04s/it][1/6] extract embeddings:  11%|█         | 4/36 [00:02<00:13,  2.38it/s][1/6] extract embeddings:  17%|█▋        | 6/36 [00:02<00:08,  3.71it/s][1/6] extract embeddings:  22%|██▏       | 8/36 [00:02<00:05,  5.18it/s][1/6] extract embeddings:  28%|██▊       | 10/36 [00:02<00:03,  6.56it/s][1/6] extract embeddings:  33%|███▎      | 12/36 [00:02<00:03,  7.94it/s][1/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:02,  9.41it/s][1/6] extract embeddings:  44%|████▍     | 16/36 [00:03<00:01, 10.25it/s][1/6] extract embeddings:  50%|█████     | 18/36 [00:03<00:01, 11.35it/s][1/6] extract embeddings:  56%|█████▌    | 20/36 [00:03<00:01, 12.11it/s][1/6] extract embeddings:  61%|██████    | 22/36 [00:03<00:01, 12.32it/s][1/6] extract embeddings:  67%|██████▋   | 24/36 [00:03<00:00, 12.76it/s][1/6] extract embeddings:  72%|███████▏  | 26/36 [00:03<00:00, 12.99it/s][1/6] extract embeddings:  78%|███████▊  | 28/36 [00:03<00:00, 12.96it/s][1/6] extract embeddings:  83%|████████▎ | 30/36 [00:04<00:00, 12.81it/s][1/6] extract embeddings:  89%|████████▉ | 32/36 [00:04<00:00, 13.19it/s][1/6] extract embeddings:  94%|█████████▍| 34/36 [00:04<00:00, 13.29it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00, 14.63it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00,  8.00it/s]
[NeMo I 2025-04-17 01:06:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:06:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:06:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:06:00 collections:880] Dataset successfully loaded with 2677 items and total duration provided from manifest is  1.51 hours.
[NeMo I 2025-04-17 01:06:00 collections:886] # 2677 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/42 [00:01<01:07,  1.63s/it][2/6] extract embeddings:   7%|▋         | 3/42 [00:01<00:18,  2.14it/s][2/6] extract embeddings:  12%|█▏        | 5/42 [00:01<00:09,  3.83it/s][2/6] extract embeddings:  17%|█▋        | 7/42 [00:02<00:06,  5.61it/s][2/6] extract embeddings:  21%|██▏       | 9/42 [00:02<00:04,  7.25it/s][2/6] extract embeddings:  26%|██▌       | 11/42 [00:02<00:03,  8.75it/s][2/6] extract embeddings:  31%|███       | 13/42 [00:02<00:02,  9.89it/s][2/6] extract embeddings:  36%|███▌      | 15/42 [00:02<00:02, 10.91it/s][2/6] extract embeddings:  40%|████      | 17/42 [00:02<00:02, 11.49it/s][2/6] extract embeddings:  45%|████▌     | 19/42 [00:02<00:01, 12.40it/s][2/6] extract embeddings:  50%|█████     | 21/42 [00:03<00:01, 13.17it/s][2/6] extract embeddings:  55%|█████▍    | 23/42 [00:03<00:01, 13.49it/s][2/6] extract embeddings:  60%|█████▉    | 25/42 [00:03<00:01, 13.60it/s][2/6] extract embeddings:  64%|██████▍   | 27/42 [00:03<00:01, 13.80it/s][2/6] extract embeddings:  69%|██████▉   | 29/42 [00:03<00:00, 14.07it/s][2/6] extract embeddings:  74%|███████▍  | 31/42 [00:03<00:00, 13.89it/s][2/6] extract embeddings:  79%|███████▊  | 33/42 [00:03<00:00, 13.66it/s][2/6] extract embeddings:  83%|████████▎ | 35/42 [00:04<00:00, 13.51it/s][2/6] extract embeddings:  88%|████████▊ | 37/42 [00:04<00:00, 13.39it/s][2/6] extract embeddings:  93%|█████████▎| 39/42 [00:04<00:00, 13.61it/s][2/6] extract embeddings:  98%|█████████▊| 41/42 [00:04<00:00, 13.51it/s][2/6] extract embeddings: 100%|██████████| 42/42 [00:04<00:00,  9.23it/s]
[NeMo I 2025-04-17 01:06:05 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:06:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:06:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:06:05 collections:880] Dataset successfully loaded with 3273 items and total duration provided from manifest is  1.56 hours.
[NeMo I 2025-04-17 01:06:05 collections:886] # 3273 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/52 [00:01<01:02,  1.23s/it][3/6] extract embeddings:   6%|▌         | 3/52 [00:01<00:17,  2.78it/s][3/6] extract embeddings:  10%|▉         | 5/52 [00:01<00:09,  4.81it/s][3/6] extract embeddings:  13%|█▎        | 7/52 [00:01<00:06,  6.69it/s][3/6] extract embeddings:  17%|█▋        | 9/52 [00:01<00:05,  8.53it/s][3/6] extract embeddings:  21%|██        | 11/52 [00:01<00:04, 10.22it/s][3/6] extract embeddings:  25%|██▌       | 13/52 [00:01<00:03, 11.48it/s][3/6] extract embeddings:  29%|██▉       | 15/52 [00:02<00:03, 12.31it/s][3/6] extract embeddings:  33%|███▎      | 17/52 [00:02<00:02, 13.14it/s][3/6] extract embeddings:  37%|███▋      | 19/52 [00:02<00:02, 13.78it/s][3/6] extract embeddings:  40%|████      | 21/52 [00:02<00:02, 14.35it/s][3/6] extract embeddings:  44%|████▍     | 23/52 [00:02<00:02, 14.31it/s][3/6] extract embeddings:  48%|████▊     | 25/52 [00:02<00:01, 14.83it/s][3/6] extract embeddings:  52%|█████▏    | 27/52 [00:02<00:01, 14.79it/s][3/6] extract embeddings:  56%|█████▌    | 29/52 [00:03<00:01, 15.17it/s][3/6] extract embeddings:  60%|█████▉    | 31/52 [00:03<00:01, 14.99it/s][3/6] extract embeddings:  63%|██████▎   | 33/52 [00:03<00:01, 15.15it/s][3/6] extract embeddings:  67%|██████▋   | 35/52 [00:03<00:01, 15.50it/s][3/6] extract embeddings:  71%|███████   | 37/52 [00:03<00:00, 15.25it/s][3/6] extract embeddings:  75%|███████▌  | 39/52 [00:03<00:00, 15.08it/s][3/6] extract embeddings:  79%|███████▉  | 41/52 [00:03<00:00, 14.76it/s][3/6] extract embeddings:  83%|████████▎ | 43/52 [00:03<00:00, 15.25it/s][3/6] extract embeddings:  87%|████████▋ | 45/52 [00:04<00:00, 15.12it/s][3/6] extract embeddings:  90%|█████████ | 47/52 [00:04<00:00, 15.33it/s][3/6] extract embeddings:  94%|█████████▍| 49/52 [00:04<00:00, 15.58it/s][3/6] extract embeddings:  98%|█████████▊| 51/52 [00:04<00:00, 15.59it/s][3/6] extract embeddings: 100%|██████████| 52/52 [00:04<00:00, 11.48it/s]
[NeMo I 2025-04-17 01:06:09 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:06:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:06:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:06:10 collections:880] Dataset successfully loaded with 4341 items and total duration provided from manifest is  1.63 hours.
[NeMo I 2025-04-17 01:06:10 collections:886] # 4341 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/68 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/68 [00:01<01:22,  1.22s/it][4/6] extract embeddings:   4%|▍         | 3/68 [00:01<00:23,  2.80it/s][4/6] extract embeddings:   7%|▋         | 5/68 [00:01<00:12,  4.88it/s][4/6] extract embeddings:  10%|█         | 7/68 [00:01<00:08,  7.03it/s][4/6] extract embeddings:  13%|█▎        | 9/68 [00:01<00:06,  9.03it/s][4/6] extract embeddings:  16%|█▌        | 11/68 [00:01<00:05, 10.94it/s][4/6] extract embeddings:  19%|█▉        | 13/68 [00:01<00:04, 12.35it/s][4/6] extract embeddings:  22%|██▏       | 15/68 [00:02<00:03, 13.83it/s][4/6] extract embeddings:  25%|██▌       | 17/68 [00:02<00:03, 14.75it/s][4/6] extract embeddings:  28%|██▊       | 19/68 [00:02<00:03, 15.30it/s][4/6] extract embeddings:  31%|███       | 21/68 [00:02<00:02, 15.71it/s][4/6] extract embeddings:  34%|███▍      | 23/68 [00:02<00:02, 15.64it/s][4/6] extract embeddings:  37%|███▋      | 25/68 [00:02<00:02, 16.36it/s][4/6] extract embeddings:  40%|███▉      | 27/68 [00:02<00:02, 16.38it/s][4/6] extract embeddings:  43%|████▎     | 29/68 [00:02<00:02, 16.46it/s][4/6] extract embeddings:  46%|████▌     | 31/68 [00:02<00:02, 16.54it/s][4/6] extract embeddings:  49%|████▊     | 33/68 [00:03<00:02, 16.47it/s][4/6] extract embeddings:  51%|█████▏    | 35/68 [00:03<00:01, 16.74it/s][4/6] extract embeddings:  54%|█████▍    | 37/68 [00:03<00:01, 16.97it/s][4/6] extract embeddings:  57%|█████▋    | 39/68 [00:03<00:01, 16.73it/s][4/6] extract embeddings:  60%|██████    | 41/68 [00:03<00:01, 16.66it/s][4/6] extract embeddings:  63%|██████▎   | 43/68 [00:03<00:01, 17.04it/s][4/6] extract embeddings:  66%|██████▌   | 45/68 [00:03<00:01, 16.53it/s][4/6] extract embeddings:  69%|██████▉   | 47/68 [00:03<00:01, 16.64it/s][4/6] extract embeddings:  72%|███████▏  | 49/68 [00:04<00:01, 16.32it/s][4/6] extract embeddings:  75%|███████▌  | 51/68 [00:04<00:01, 16.09it/s][4/6] extract embeddings:  78%|███████▊  | 53/68 [00:04<00:00, 16.12it/s][4/6] extract embeddings:  81%|████████  | 55/68 [00:04<00:00, 16.23it/s][4/6] extract embeddings:  84%|████████▍ | 57/68 [00:04<00:00, 16.52it/s][4/6] extract embeddings:  87%|████████▋ | 59/68 [00:04<00:00, 16.40it/s][4/6] extract embeddings:  90%|████████▉ | 61/68 [00:04<00:00, 16.65it/s][4/6] extract embeddings:  93%|█████████▎| 63/68 [00:04<00:00, 16.71it/s][4/6] extract embeddings:  96%|█████████▌| 65/68 [00:05<00:00, 16.92it/s][4/6] extract embeddings:  99%|█████████▊| 67/68 [00:05<00:00, 16.75it/s][4/6] extract embeddings: 100%|██████████| 68/68 [00:05<00:00, 12.98it/s]
[NeMo I 2025-04-17 01:06:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:06:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:06:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:06:15 collections:880] Dataset successfully loaded with 6535 items and total duration provided from manifest is  1.71 hours.
[NeMo I 2025-04-17 01:06:15 collections:886] # 6535 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/103 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/103 [00:01<02:08,  1.26s/it][5/6] extract embeddings:   3%|▎         | 3/103 [00:01<00:36,  2.74it/s][5/6] extract embeddings:   5%|▍         | 5/103 [00:01<00:20,  4.77it/s][5/6] extract embeddings:   8%|▊         | 8/103 [00:01<00:11,  7.93it/s][5/6] extract embeddings:  10%|▉         | 10/103 [00:01<00:09,  9.91it/s][5/6] extract embeddings:  12%|█▏        | 12/103 [00:01<00:07, 11.68it/s][5/6] extract embeddings:  14%|█▎        | 14/103 [00:01<00:06, 13.00it/s][5/6] extract embeddings:  16%|█▌        | 16/103 [00:02<00:06, 14.08it/s][5/6] extract embeddings:  17%|█▋        | 18/103 [00:02<00:05, 15.06it/s][5/6] extract embeddings:  19%|█▉        | 20/103 [00:02<00:05, 16.12it/s][5/6] extract embeddings:  21%|██▏       | 22/103 [00:02<00:04, 16.72it/s][5/6] extract embeddings:  23%|██▎       | 24/103 [00:02<00:04, 17.11it/s][5/6] extract embeddings:  25%|██▌       | 26/103 [00:02<00:04, 17.15it/s][5/6] extract embeddings:  27%|██▋       | 28/103 [00:02<00:04, 17.10it/s][5/6] extract embeddings:  30%|███       | 31/103 [00:02<00:04, 17.75it/s][5/6] extract embeddings:  32%|███▏      | 33/103 [00:03<00:03, 17.61it/s][5/6] extract embeddings:  34%|███▍      | 35/103 [00:03<00:03, 18.00it/s][5/6] extract embeddings:  36%|███▌      | 37/103 [00:03<00:03, 18.01it/s][5/6] extract embeddings:  38%|███▊      | 39/103 [00:03<00:03, 17.99it/s][5/6] extract embeddings:  40%|███▉      | 41/103 [00:03<00:03, 17.23it/s][5/6] extract embeddings:  42%|████▏     | 43/103 [00:03<00:03, 17.06it/s][5/6] extract embeddings:  44%|████▎     | 45/103 [00:03<00:03, 17.65it/s][5/6] extract embeddings:  46%|████▌     | 47/103 [00:03<00:03, 17.88it/s][5/6] extract embeddings:  48%|████▊     | 49/103 [00:03<00:02, 18.28it/s][5/6] extract embeddings:  50%|████▉     | 51/103 [00:04<00:02, 17.96it/s][5/6] extract embeddings:  52%|█████▏    | 54/103 [00:04<00:02, 18.98it/s][5/6] extract embeddings:  54%|█████▍    | 56/103 [00:04<00:02, 18.30it/s][5/6] extract embeddings:  56%|█████▋    | 58/103 [00:04<00:02, 18.68it/s][5/6] extract embeddings:  58%|█████▊    | 60/103 [00:04<00:02, 18.90it/s][5/6] extract embeddings:  60%|██████    | 62/103 [00:04<00:02, 18.92it/s][5/6] extract embeddings:  62%|██████▏   | 64/103 [00:04<00:02, 17.69it/s][5/6] extract embeddings:  64%|██████▍   | 66/103 [00:04<00:02, 17.32it/s][5/6] extract embeddings:  66%|██████▌   | 68/103 [00:04<00:01, 17.87it/s][5/6] extract embeddings:  68%|██████▊   | 70/103 [00:05<00:01, 17.90it/s][5/6] extract embeddings:  70%|██████▉   | 72/103 [00:05<00:01, 18.16it/s][5/6] extract embeddings:  72%|███████▏  | 74/103 [00:05<00:01, 18.57it/s][5/6] extract embeddings:  74%|███████▍  | 76/103 [00:05<00:01, 18.89it/s][5/6] extract embeddings:  76%|███████▌  | 78/103 [00:05<00:01, 18.88it/s][5/6] extract embeddings:  78%|███████▊  | 80/103 [00:05<00:01, 18.77it/s][5/6] extract embeddings:  80%|███████▉  | 82/103 [00:05<00:01, 18.03it/s][5/6] extract embeddings:  82%|████████▏ | 84/103 [00:05<00:01, 18.23it/s][5/6] extract embeddings:  83%|████████▎ | 86/103 [00:05<00:00, 18.32it/s][5/6] extract embeddings:  85%|████████▌ | 88/103 [00:06<00:00, 18.08it/s][5/6] extract embeddings:  87%|████████▋ | 90/103 [00:06<00:00, 17.74it/s][5/6] extract embeddings:  89%|████████▉ | 92/103 [00:06<00:00, 17.31it/s][5/6] extract embeddings:  91%|█████████▏| 94/103 [00:06<00:00, 17.92it/s][5/6] extract embeddings:  93%|█████████▎| 96/103 [00:06<00:00, 17.53it/s][5/6] extract embeddings:  95%|█████████▌| 98/103 [00:06<00:00, 17.26it/s][5/6] extract embeddings:  97%|█████████▋| 100/103 [00:06<00:00, 17.81it/s][5/6] extract embeddings:  99%|█████████▉| 102/103 [00:06<00:00, 17.45it/s][5/6] extract embeddings: 100%|██████████| 103/103 [00:06<00:00, 14.93it/s]
[NeMo I 2025-04-17 01:06:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:06:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:06:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:06:22 collections:880] Dataset successfully loaded with 13321 items and total duration provided from manifest is  1.81 hours.
[NeMo I 2025-04-17 01:06:22 collections:886] # 13321 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/209 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/209 [00:01<04:17,  1.24s/it][6/6] extract embeddings:   2%|▏         | 4/209 [00:01<00:55,  3.66it/s][6/6] extract embeddings:   3%|▎         | 7/209 [00:01<00:30,  6.62it/s][6/6] extract embeddings:   5%|▍         | 10/209 [00:01<00:21,  9.40it/s][6/6] extract embeddings:   6%|▌         | 12/209 [00:01<00:17, 11.08it/s][6/6] extract embeddings:   7%|▋         | 14/209 [00:01<00:15, 12.66it/s][6/6] extract embeddings:   8%|▊         | 16/209 [00:01<00:13, 14.00it/s][6/6] extract embeddings:   9%|▉         | 19/209 [00:02<00:11, 16.28it/s][6/6] extract embeddings:  11%|█         | 22/209 [00:02<00:10, 17.66it/s][6/6] extract embeddings:  12%|█▏        | 25/209 [00:02<00:10, 17.77it/s][6/6] extract embeddings:  13%|█▎        | 28/209 [00:02<00:09, 18.50it/s][6/6] extract embeddings:  15%|█▍        | 31/209 [00:02<00:09, 19.76it/s][6/6] extract embeddings:  16%|█▋        | 34/209 [00:02<00:09, 19.08it/s][6/6] extract embeddings:  18%|█▊        | 37/209 [00:03<00:08, 19.98it/s][6/6] extract embeddings:  19%|█▉        | 40/209 [00:03<00:08, 20.05it/s][6/6] extract embeddings:  21%|██        | 43/209 [00:03<00:08, 19.77it/s][6/6] extract embeddings:  22%|██▏       | 46/209 [00:03<00:08, 19.34it/s][6/6] extract embeddings:  23%|██▎       | 49/209 [00:03<00:08, 19.42it/s][6/6] extract embeddings:  25%|██▍       | 52/209 [00:03<00:07, 20.19it/s][6/6] extract embeddings:  26%|██▋       | 55/209 [00:03<00:07, 19.99it/s][6/6] extract embeddings:  28%|██▊       | 58/209 [00:04<00:07, 20.98it/s][6/6] extract embeddings:  29%|██▉       | 61/209 [00:04<00:06, 21.47it/s][6/6] extract embeddings:  31%|███       | 64/209 [00:04<00:06, 20.75it/s][6/6] extract embeddings:  32%|███▏      | 67/209 [00:04<00:06, 20.68it/s][6/6] extract embeddings:  33%|███▎      | 70/209 [00:04<00:06, 20.31it/s][6/6] extract embeddings:  35%|███▍      | 73/209 [00:04<00:06, 20.64it/s][6/6] extract embeddings:  36%|███▋      | 76/209 [00:04<00:06, 20.19it/s][6/6] extract embeddings:  38%|███▊      | 79/209 [00:05<00:06, 20.22it/s][6/6] extract embeddings:  39%|███▉      | 82/209 [00:05<00:06, 20.40it/s][6/6] extract embeddings:  41%|████      | 85/209 [00:05<00:06, 19.78it/s][6/6] extract embeddings:  42%|████▏     | 88/209 [00:05<00:06, 19.57it/s][6/6] extract embeddings:  44%|████▎     | 91/209 [00:05<00:05, 20.12it/s][6/6] extract embeddings:  45%|████▍     | 94/209 [00:05<00:05, 19.80it/s][6/6] extract embeddings:  46%|████▋     | 97/209 [00:05<00:05, 19.47it/s][6/6] extract embeddings:  47%|████▋     | 99/209 [00:06<00:05, 19.42it/s][6/6] extract embeddings:  48%|████▊     | 101/209 [00:06<00:05, 19.09it/s][6/6] extract embeddings:  50%|████▉     | 104/209 [00:06<00:05, 18.72it/s][6/6] extract embeddings:  51%|█████     | 107/209 [00:06<00:05, 19.07it/s][6/6] extract embeddings:  52%|█████▏    | 109/209 [00:06<00:05, 19.27it/s][6/6] extract embeddings:  53%|█████▎    | 111/209 [00:06<00:05, 19.43it/s][6/6] extract embeddings:  55%|█████▍    | 114/209 [00:06<00:04, 20.61it/s][6/6] extract embeddings:  56%|█████▌    | 117/209 [00:06<00:04, 21.36it/s][6/6] extract embeddings:  57%|█████▋    | 120/209 [00:07<00:04, 21.34it/s][6/6] extract embeddings:  59%|█████▉    | 123/209 [00:07<00:03, 21.81it/s][6/6] extract embeddings:  60%|██████    | 126/209 [00:07<00:03, 21.49it/s][6/6] extract embeddings:  62%|██████▏   | 129/209 [00:07<00:03, 21.23it/s][6/6] extract embeddings:  63%|██████▎   | 132/209 [00:07<00:03, 21.16it/s][6/6] extract embeddings:  65%|██████▍   | 135/209 [00:07<00:03, 21.06it/s][6/6] extract embeddings:  66%|██████▌   | 138/209 [00:08<00:03, 19.61it/s][6/6] extract embeddings:  67%|██████▋   | 141/209 [00:08<00:03, 20.68it/s][6/6] extract embeddings:  69%|██████▉   | 144/209 [00:08<00:03, 21.44it/s][6/6] extract embeddings:  70%|███████   | 147/209 [00:08<00:03, 20.34it/s][6/6] extract embeddings:  72%|███████▏  | 150/209 [00:08<00:02, 21.19it/s][6/6] extract embeddings:  73%|███████▎  | 153/209 [00:08<00:02, 21.59it/s][6/6] extract embeddings:  75%|███████▍  | 156/209 [00:08<00:02, 21.09it/s][6/6] extract embeddings:  76%|███████▌  | 159/209 [00:08<00:02, 21.11it/s][6/6] extract embeddings:  78%|███████▊  | 162/209 [00:09<00:02, 21.27it/s][6/6] extract embeddings:  79%|███████▉  | 165/209 [00:09<00:02, 21.51it/s][6/6] extract embeddings:  80%|████████  | 168/209 [00:09<00:01, 22.15it/s][6/6] extract embeddings:  82%|████████▏ | 171/209 [00:09<00:01, 22.22it/s][6/6] extract embeddings:  83%|████████▎ | 174/209 [00:09<00:01, 22.16it/s][6/6] extract embeddings:  85%|████████▍ | 177/209 [00:09<00:01, 21.75it/s][6/6] extract embeddings:  86%|████████▌ | 180/209 [00:09<00:01, 21.24it/s][6/6] extract embeddings:  88%|████████▊ | 183/209 [00:10<00:01, 21.22it/s][6/6] extract embeddings:  89%|████████▉ | 186/209 [00:10<00:01, 21.38it/s][6/6] extract embeddings:  90%|█████████ | 189/209 [00:10<00:00, 21.23it/s][6/6] extract embeddings:  92%|█████████▏| 192/209 [00:10<00:00, 20.72it/s][6/6] extract embeddings:  93%|█████████▎| 195/209 [00:10<00:00, 21.82it/s][6/6] extract embeddings:  95%|█████████▌| 199/209 [00:10<00:00, 25.00it/s][6/6] extract embeddings:  97%|█████████▋| 203/209 [00:10<00:00, 26.08it/s][6/6] extract embeddings:  99%|█████████▉| 207/209 [00:11<00:00, 28.03it/s][6/6] extract embeddings: 100%|██████████| 209/209 [00:11<00:00, 18.82it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.12it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.28it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.85it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.44it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.07it/s]
[NeMo I 2025-04-17 01:06:36 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:06:37 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              40.015135   444.120  ...   17.475006  3.934749
    Harker-ES                       32.219056  2178.782  ...   75.273190  3.454829
    Harker-MN                       43.907478   366.767  ...   32.318026  8.811596
    Longfellow-Block-1              25.083366   492.417  ...    8.337992  1.693279
    TOTAL                           33.435450  3482.086  ...  133.404214  3.831158
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:06:37 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0827 | MISS: 0.2134 | CER: 0.0383 | DER: 0.3344 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.91s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:06:50 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:06:50 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:06:50 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:06:50 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:06:50 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:06:50 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:06:50 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:06:50 features:305] PADDING: 16
[NeMo I 2025-04-17 01:06:50 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:06:50 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:06:50 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:06:50 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:06:50 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:06:50 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:06:50 collections:880] Dataset successfully loaded with 2239 items and total duration provided from manifest is  1.39 hours.
[NeMo I 2025-04-17 01:06:50 collections:886] # 2239 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:08,  2.02s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:12,  2.41it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:07,  3.78it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:05,  5.27it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.71it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  8.02it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02,  9.29it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 10.72it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 12.18it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 12.92it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:00, 13.20it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 13.89it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 14.02it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:03<00:00, 14.02it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:03<00:00, 13.64it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:04<00:00, 14.04it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 14.17it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  8.13it/s]
[NeMo I 2025-04-17 01:06:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:06:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:06:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:06:55 collections:880] Dataset successfully loaded with 2618 items and total duration provided from manifest is  1.45 hours.
[NeMo I 2025-04-17 01:06:55 collections:886] # 2618 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/41 [00:01<01:04,  1.61s/it][2/6] extract embeddings:   7%|▋         | 3/41 [00:01<00:17,  2.18it/s][2/6] extract embeddings:  12%|█▏        | 5/41 [00:01<00:09,  3.96it/s][2/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:05,  5.77it/s][2/6] extract embeddings:  22%|██▏       | 9/41 [00:02<00:04,  7.49it/s][2/6] extract embeddings:  27%|██▋       | 11/41 [00:02<00:03,  8.98it/s][2/6] extract embeddings:  32%|███▏      | 13/41 [00:02<00:02, 10.12it/s][2/6] extract embeddings:  37%|███▋      | 15/41 [00:02<00:02, 11.32it/s][2/6] extract embeddings:  41%|████▏     | 17/41 [00:02<00:01, 12.19it/s][2/6] extract embeddings:  46%|████▋     | 19/41 [00:02<00:01, 12.89it/s][2/6] extract embeddings:  51%|█████     | 21/41 [00:02<00:01, 14.04it/s][2/6] extract embeddings:  56%|█████▌    | 23/41 [00:03<00:01, 14.50it/s][2/6] extract embeddings:  61%|██████    | 25/41 [00:03<00:01, 14.90it/s][2/6] extract embeddings:  66%|██████▌   | 27/41 [00:03<00:00, 14.95it/s][2/6] extract embeddings:  73%|███████▎  | 30/41 [00:03<00:00, 16.47it/s][2/6] extract embeddings:  78%|███████▊  | 32/41 [00:03<00:00, 15.55it/s][2/6] extract embeddings:  83%|████████▎ | 34/41 [00:03<00:00, 15.43it/s][2/6] extract embeddings:  88%|████████▊ | 36/41 [00:03<00:00, 15.91it/s][2/6] extract embeddings:  93%|█████████▎| 38/41 [00:03<00:00, 15.12it/s][2/6] extract embeddings:  98%|█████████▊| 40/41 [00:04<00:00, 15.01it/s][2/6] extract embeddings: 100%|██████████| 41/41 [00:04<00:00,  9.70it/s]
[NeMo I 2025-04-17 01:06:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:06:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:06:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:06:59 collections:880] Dataset successfully loaded with 3199 items and total duration provided from manifest is  1.51 hours.
[NeMo I 2025-04-17 01:06:59 collections:886] # 3199 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/50 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/50 [00:01<00:56,  1.16s/it][3/6] extract embeddings:   6%|▌         | 3/50 [00:01<00:15,  2.95it/s][3/6] extract embeddings:  10%|█         | 5/50 [00:01<00:08,  5.16it/s][3/6] extract embeddings:  14%|█▍        | 7/50 [00:01<00:05,  7.50it/s][3/6] extract embeddings:  20%|██        | 10/50 [00:01<00:03, 10.76it/s][3/6] extract embeddings:  24%|██▍       | 12/50 [00:01<00:03, 12.56it/s][3/6] extract embeddings:  28%|██▊       | 14/50 [00:01<00:02, 13.29it/s][3/6] extract embeddings:  32%|███▏      | 16/50 [00:01<00:02, 13.89it/s][3/6] extract embeddings:  36%|███▌      | 18/50 [00:02<00:02, 14.50it/s][3/6] extract embeddings:  40%|████      | 20/50 [00:02<00:02, 14.96it/s][3/6] extract embeddings:  44%|████▍     | 22/50 [00:02<00:01, 15.30it/s][3/6] extract embeddings:  48%|████▊     | 24/50 [00:02<00:01, 15.54it/s][3/6] extract embeddings:  52%|█████▏    | 26/50 [00:02<00:01, 15.78it/s][3/6] extract embeddings:  56%|█████▌    | 28/50 [00:02<00:01, 15.96it/s][3/6] extract embeddings:  60%|██████    | 30/50 [00:02<00:01, 15.59it/s][3/6] extract embeddings:  64%|██████▍   | 32/50 [00:02<00:01, 15.95it/s][3/6] extract embeddings:  68%|██████▊   | 34/50 [00:03<00:00, 16.20it/s][3/6] extract embeddings:  72%|███████▏  | 36/50 [00:03<00:00, 15.94it/s][3/6] extract embeddings:  76%|███████▌  | 38/50 [00:03<00:00, 16.35it/s][3/6] extract embeddings:  80%|████████  | 40/50 [00:03<00:00, 16.15it/s][3/6] extract embeddings:  84%|████████▍ | 42/50 [00:03<00:00, 17.04it/s][3/6] extract embeddings:  88%|████████▊ | 44/50 [00:03<00:00, 16.64it/s][3/6] extract embeddings:  92%|█████████▏| 46/50 [00:03<00:00, 16.45it/s][3/6] extract embeddings:  96%|█████████▌| 48/50 [00:03<00:00, 16.41it/s][3/6] extract embeddings: 100%|██████████| 50/50 [00:04<00:00, 16.38it/s][3/6] extract embeddings: 100%|██████████| 50/50 [00:04<00:00, 12.21it/s]
[NeMo I 2025-04-17 01:07:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:07:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:07:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:07:03 collections:880] Dataset successfully loaded with 4238 items and total duration provided from manifest is  1.58 hours.
[NeMo I 2025-04-17 01:07:03 collections:886] # 4238 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/67 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/67 [00:01<01:24,  1.28s/it][4/6] extract embeddings:   6%|▌         | 4/67 [00:01<00:17,  3.55it/s][4/6] extract embeddings:  10%|█         | 7/67 [00:01<00:09,  6.48it/s][4/6] extract embeddings:  13%|█▎        | 9/67 [00:01<00:06,  8.40it/s][4/6] extract embeddings:  16%|█▋        | 11/67 [00:01<00:05,  9.84it/s][4/6] extract embeddings:  19%|█▉        | 13/67 [00:01<00:04, 11.45it/s][4/6] extract embeddings:  22%|██▏       | 15/67 [00:02<00:04, 12.90it/s][4/6] extract embeddings:  25%|██▌       | 17/67 [00:02<00:03, 13.44it/s][4/6] extract embeddings:  28%|██▊       | 19/67 [00:02<00:03, 14.45it/s][4/6] extract embeddings:  31%|███▏      | 21/67 [00:02<00:02, 15.44it/s][4/6] extract embeddings:  34%|███▍      | 23/67 [00:02<00:02, 16.33it/s][4/6] extract embeddings:  39%|███▉      | 26/67 [00:02<00:02, 17.75it/s][4/6] extract embeddings:  42%|████▏     | 28/67 [00:02<00:02, 18.13it/s][4/6] extract embeddings:  45%|████▍     | 30/67 [00:02<00:02, 18.40it/s][4/6] extract embeddings:  48%|████▊     | 32/67 [00:02<00:01, 18.70it/s][4/6] extract embeddings:  51%|█████     | 34/67 [00:03<00:01, 18.89it/s][4/6] extract embeddings:  54%|█████▎    | 36/67 [00:03<00:01, 19.15it/s][4/6] extract embeddings:  57%|█████▋    | 38/67 [00:03<00:01, 18.99it/s][4/6] extract embeddings:  60%|█████▉    | 40/67 [00:03<00:01, 18.37it/s][4/6] extract embeddings:  63%|██████▎   | 42/67 [00:03<00:01, 18.73it/s][4/6] extract embeddings:  66%|██████▌   | 44/67 [00:03<00:01, 18.56it/s][4/6] extract embeddings:  69%|██████▊   | 46/67 [00:03<00:01, 18.57it/s][4/6] extract embeddings:  72%|███████▏  | 48/67 [00:03<00:01, 18.95it/s][4/6] extract embeddings:  75%|███████▍  | 50/67 [00:03<00:00, 18.20it/s][4/6] extract embeddings:  78%|███████▊  | 52/67 [00:04<00:00, 18.37it/s][4/6] extract embeddings:  81%|████████  | 54/67 [00:04<00:00, 18.34it/s][4/6] extract embeddings:  84%|████████▎ | 56/67 [00:04<00:00, 18.60it/s][4/6] extract embeddings:  87%|████████▋ | 58/67 [00:04<00:00, 17.98it/s][4/6] extract embeddings:  91%|█████████ | 61/67 [00:04<00:00, 18.11it/s][4/6] extract embeddings:  94%|█████████▍| 63/67 [00:04<00:00, 18.15it/s][4/6] extract embeddings:  99%|█████████▊| 66/67 [00:04<00:00, 18.53it/s][4/6] extract embeddings: 100%|██████████| 67/67 [00:04<00:00, 13.89it/s]
[NeMo I 2025-04-17 01:07:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:07:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:07:09 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:07:09 collections:880] Dataset successfully loaded with 6381 items and total duration provided from manifest is  1.66 hours.
[NeMo I 2025-04-17 01:07:09 collections:886] # 6381 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/100 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/100 [00:01<01:58,  1.19s/it][5/6] extract embeddings:   4%|▍         | 4/100 [00:01<00:25,  3.79it/s][5/6] extract embeddings:   6%|▌         | 6/100 [00:01<00:16,  5.86it/s][5/6] extract embeddings:   9%|▉         | 9/100 [00:01<00:10,  8.88it/s][5/6] extract embeddings:  12%|█▏        | 12/100 [00:01<00:07, 11.90it/s][5/6] extract embeddings:  15%|█▌        | 15/100 [00:01<00:06, 13.94it/s][5/6] extract embeddings:  18%|█▊        | 18/100 [00:02<00:05, 15.94it/s][5/6] extract embeddings:  21%|██        | 21/100 [00:02<00:04, 17.17it/s][5/6] extract embeddings:  24%|██▍       | 24/100 [00:02<00:04, 17.70it/s][5/6] extract embeddings:  26%|██▌       | 26/100 [00:02<00:04, 18.13it/s][5/6] extract embeddings:  28%|██▊       | 28/100 [00:02<00:03, 18.54it/s][5/6] extract embeddings:  31%|███       | 31/100 [00:02<00:03, 19.30it/s][5/6] extract embeddings:  34%|███▍      | 34/100 [00:02<00:03, 19.37it/s][5/6] extract embeddings:  37%|███▋      | 37/100 [00:02<00:02, 21.02it/s][5/6] extract embeddings:  40%|████      | 40/100 [00:03<00:02, 21.12it/s][5/6] extract embeddings:  43%|████▎     | 43/100 [00:03<00:02, 20.48it/s][5/6] extract embeddings:  46%|████▌     | 46/100 [00:03<00:02, 20.42it/s][5/6] extract embeddings:  49%|████▉     | 49/100 [00:03<00:02, 20.37it/s][5/6] extract embeddings:  52%|█████▏    | 52/100 [00:03<00:02, 20.68it/s][5/6] extract embeddings:  55%|█████▌    | 55/100 [00:03<00:02, 20.80it/s][5/6] extract embeddings:  58%|█████▊    | 58/100 [00:03<00:02, 20.49it/s][5/6] extract embeddings:  61%|██████    | 61/100 [00:04<00:01, 20.33it/s][5/6] extract embeddings:  64%|██████▍   | 64/100 [00:04<00:01, 20.71it/s][5/6] extract embeddings:  67%|██████▋   | 67/100 [00:04<00:01, 20.61it/s][5/6] extract embeddings:  70%|███████   | 70/100 [00:04<00:01, 19.94it/s][5/6] extract embeddings:  73%|███████▎  | 73/100 [00:04<00:01, 19.96it/s][5/6] extract embeddings:  76%|███████▌  | 76/100 [00:04<00:01, 20.81it/s][5/6] extract embeddings:  79%|███████▉  | 79/100 [00:04<00:00, 21.32it/s][5/6] extract embeddings:  82%|████████▏ | 82/100 [00:05<00:00, 21.54it/s][5/6] extract embeddings:  85%|████████▌ | 85/100 [00:05<00:00, 22.37it/s][5/6] extract embeddings:  88%|████████▊ | 88/100 [00:05<00:00, 22.01it/s][5/6] extract embeddings:  91%|█████████ | 91/100 [00:05<00:00, 22.38it/s][5/6] extract embeddings:  94%|█████████▍| 94/100 [00:05<00:00, 22.30it/s][5/6] extract embeddings:  97%|█████████▋| 97/100 [00:05<00:00, 21.84it/s][5/6] extract embeddings: 100%|██████████| 100/100 [00:05<00:00, 21.26it/s][5/6] extract embeddings: 100%|██████████| 100/100 [00:05<00:00, 16.81it/s]
[NeMo I 2025-04-17 01:07:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:07:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:07:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:07:15 collections:880] Dataset successfully loaded with 13007 items and total duration provided from manifest is  1.76 hours.
[NeMo I 2025-04-17 01:07:15 collections:886] # 13007 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/204 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/204 [00:01<04:05,  1.21s/it][6/6] extract embeddings:   2%|▏         | 5/204 [00:01<00:41,  4.76it/s][6/6] extract embeddings:   4%|▍         | 8/204 [00:01<00:24,  7.86it/s][6/6] extract embeddings:   5%|▌         | 11/204 [00:01<00:17, 10.85it/s][6/6] extract embeddings:   7%|▋         | 14/204 [00:01<00:14, 13.49it/s][6/6] extract embeddings:   8%|▊         | 17/204 [00:01<00:11, 15.73it/s][6/6] extract embeddings:  10%|▉         | 20/204 [00:01<00:10, 17.62it/s][6/6] extract embeddings:  11%|█▏        | 23/204 [00:02<00:09, 18.33it/s][6/6] extract embeddings:  13%|█▎        | 27/204 [00:02<00:08, 21.05it/s][6/6] extract embeddings:  15%|█▍        | 30/204 [00:02<00:08, 21.35it/s][6/6] extract embeddings:  16%|█▌        | 33/204 [00:02<00:07, 22.31it/s][6/6] extract embeddings:  18%|█▊        | 36/204 [00:02<00:07, 22.62it/s][6/6] extract embeddings:  19%|█▉        | 39/204 [00:02<00:07, 23.28it/s][6/6] extract embeddings:  21%|██        | 42/204 [00:02<00:06, 23.44it/s][6/6] extract embeddings:  22%|██▏       | 45/204 [00:03<00:06, 23.54it/s][6/6] extract embeddings:  24%|██▎       | 48/204 [00:03<00:06, 23.07it/s][6/6] extract embeddings:  25%|██▌       | 51/204 [00:03<00:06, 23.85it/s][6/6] extract embeddings:  26%|██▋       | 54/204 [00:03<00:06, 24.90it/s][6/6] extract embeddings:  28%|██▊       | 57/204 [00:03<00:05, 24.91it/s][6/6] extract embeddings:  29%|██▉       | 60/204 [00:03<00:05, 25.59it/s][6/6] extract embeddings:  31%|███       | 63/204 [00:03<00:05, 25.33it/s][6/6] extract embeddings:  32%|███▏      | 66/204 [00:03<00:05, 23.83it/s][6/6] extract embeddings:  34%|███▍      | 69/204 [00:03<00:05, 23.92it/s][6/6] extract embeddings:  35%|███▌      | 72/204 [00:04<00:05, 24.53it/s][6/6] extract embeddings:  37%|███▋      | 76/204 [00:04<00:04, 27.11it/s][6/6] extract embeddings:  39%|███▊      | 79/204 [00:04<00:04, 26.64it/s][6/6] extract embeddings:  40%|████      | 82/204 [00:04<00:04, 26.52it/s][6/6] extract embeddings:  42%|████▏     | 85/204 [00:04<00:04, 25.46it/s][6/6] extract embeddings:  43%|████▎     | 88/204 [00:04<00:04, 25.31it/s][6/6] extract embeddings:  45%|████▍     | 91/204 [00:04<00:04, 24.89it/s][6/6] extract embeddings:  46%|████▌     | 94/204 [00:04<00:04, 24.76it/s][6/6] extract embeddings:  48%|████▊     | 97/204 [00:05<00:04, 23.47it/s][6/6] extract embeddings:  49%|████▉     | 100/204 [00:05<00:04, 24.10it/s][6/6] extract embeddings:  50%|█████     | 103/204 [00:05<00:04, 24.54it/s][6/6] extract embeddings:  52%|█████▏    | 106/204 [00:05<00:04, 24.17it/s][6/6] extract embeddings:  53%|█████▎    | 109/204 [00:05<00:03, 24.81it/s][6/6] extract embeddings:  55%|█████▍    | 112/204 [00:05<00:03, 23.39it/s][6/6] extract embeddings:  56%|█████▋    | 115/204 [00:05<00:03, 23.19it/s][6/6] extract embeddings:  58%|█████▊    | 118/204 [00:05<00:03, 24.42it/s][6/6] extract embeddings:  60%|█████▉    | 122/204 [00:06<00:03, 26.03it/s][6/6] extract embeddings:  61%|██████▏   | 125/204 [00:06<00:03, 24.78it/s][6/6] extract embeddings:  63%|██████▎   | 129/204 [00:06<00:02, 25.99it/s][6/6] extract embeddings:  65%|██████▍   | 132/204 [00:06<00:02, 24.34it/s][6/6] extract embeddings:  66%|██████▌   | 135/204 [00:06<00:02, 23.87it/s][6/6] extract embeddings:  68%|██████▊   | 138/204 [00:06<00:02, 25.08it/s][6/6] extract embeddings:  69%|██████▉   | 141/204 [00:06<00:02, 23.28it/s][6/6] extract embeddings:  71%|███████   | 144/204 [00:07<00:02, 23.32it/s][6/6] extract embeddings:  72%|███████▏  | 147/204 [00:07<00:02, 23.55it/s][6/6] extract embeddings:  74%|███████▎  | 150/204 [00:07<00:02, 23.32it/s][6/6] extract embeddings:  75%|███████▌  | 153/204 [00:07<00:02, 24.60it/s][6/6] extract embeddings:  76%|███████▋  | 156/204 [00:07<00:01, 25.80it/s][6/6] extract embeddings:  78%|███████▊  | 160/204 [00:07<00:01, 28.47it/s][6/6] extract embeddings:  80%|███████▉  | 163/204 [00:07<00:01, 28.79it/s][6/6] extract embeddings:  82%|████████▏ | 167/204 [00:07<00:01, 29.85it/s][6/6] extract embeddings:  84%|████████▍ | 171/204 [00:07<00:01, 30.56it/s][6/6] extract embeddings:  86%|████████▌ | 175/204 [00:08<00:00, 30.96it/s][6/6] extract embeddings:  88%|████████▊ | 179/204 [00:08<00:00, 31.76it/s][6/6] extract embeddings:  90%|████████▉ | 183/204 [00:08<00:00, 31.51it/s][6/6] extract embeddings:  92%|█████████▏| 187/204 [00:08<00:00, 30.41it/s][6/6] extract embeddings:  94%|█████████▎| 191/204 [00:08<00:00, 26.34it/s][6/6] extract embeddings:  95%|█████████▌| 194/204 [00:08<00:00, 25.49it/s][6/6] extract embeddings:  97%|█████████▋| 197/204 [00:08<00:00, 23.76it/s][6/6] extract embeddings:  98%|█████████▊| 200/204 [00:09<00:00, 23.42it/s][6/6] extract embeddings: 100%|█████████▉| 203/204 [00:09<00:00, 23.69it/s][6/6] extract embeddings: 100%|██████████| 204/204 [00:09<00:00, 21.99it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.30it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.36it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.96it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.53it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.17it/s]
[NeMo I 2025-04-17 01:07:26 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:07:27 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              41.568784   444.120  ...   17.504991  3.941500
    Harker-ES                       32.616314  2178.782  ...   59.679986  2.739144
    Harker-MN                       44.704443   366.767  ...   33.439030  9.117241
    Longfellow-Block-1              27.108286   492.417  ...   11.559009  2.347402
    TOTAL                           34.252474  3482.086  ...  122.183015  3.508903
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:07:27 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0795 | MISS: 0.2280 | CER: 0.0351 | DER: 0.3425 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.91s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:04,  2.00s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.28s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.06it/s]VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.21s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:07:40 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:07:40 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:07:40 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:07:40 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:07:40 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:07:40 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:07:40 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:07:40 features:305] PADDING: 16
[NeMo I 2025-04-17 01:07:41 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:07:41 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:07:41 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:07:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:07:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:07:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:07:41 collections:880] Dataset successfully loaded with 2209 items and total duration provided from manifest is  1.34 hours.
[NeMo I 2025-04-17 01:07:41 collections:886] # 2209 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:10,  2.07s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:13,  2.36it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:07,  3.78it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:05,  5.33it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.76it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  8.08it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02,  9.66it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 10.92it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 12.24it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 12.94it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:00, 13.54it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 14.22it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 13.89it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:03<00:00, 14.09it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:03<00:00, 13.91it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:04<00:00, 13.96it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 14.27it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  8.20it/s]
[NeMo I 2025-04-17 01:07:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:07:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:07:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:07:45 collections:880] Dataset successfully loaded with 2563 items and total duration provided from manifest is  1.39 hours.
[NeMo I 2025-04-17 01:07:45 collections:886] # 2563 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:48,  1.22s/it][2/6] extract embeddings:   7%|▋         | 3/41 [00:01<00:13,  2.77it/s][2/6] extract embeddings:  12%|█▏        | 5/41 [00:01<00:07,  4.79it/s][2/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:04,  6.96it/s][2/6] extract embeddings:  22%|██▏       | 9/41 [00:01<00:03,  8.83it/s][2/6] extract embeddings:  27%|██▋       | 11/41 [00:01<00:02, 10.82it/s][2/6] extract embeddings:  32%|███▏      | 13/41 [00:01<00:02, 11.74it/s][2/6] extract embeddings:  37%|███▋      | 15/41 [00:02<00:02, 12.92it/s][2/6] extract embeddings:  41%|████▏     | 17/41 [00:02<00:01, 13.59it/s][2/6] extract embeddings:  46%|████▋     | 19/41 [00:02<00:01, 14.27it/s][2/6] extract embeddings:  51%|█████     | 21/41 [00:02<00:01, 15.36it/s][2/6] extract embeddings:  56%|█████▌    | 23/41 [00:02<00:01, 15.25it/s][2/6] extract embeddings:  61%|██████    | 25/41 [00:02<00:01, 14.60it/s][2/6] extract embeddings:  66%|██████▌   | 27/41 [00:02<00:00, 14.50it/s][2/6] extract embeddings:  71%|███████   | 29/41 [00:02<00:00, 14.76it/s][2/6] extract embeddings:  76%|███████▌  | 31/41 [00:03<00:00, 15.48it/s][2/6] extract embeddings:  80%|████████  | 33/41 [00:03<00:00, 15.57it/s][2/6] extract embeddings:  85%|████████▌ | 35/41 [00:03<00:00, 15.70it/s][2/6] extract embeddings:  90%|█████████ | 37/41 [00:03<00:00, 16.28it/s][2/6] extract embeddings:  95%|█████████▌| 39/41 [00:03<00:00, 16.72it/s][2/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 11.08it/s]
[NeMo I 2025-04-17 01:07:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:07:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:07:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:07:49 collections:880] Dataset successfully loaded with 3123 items and total duration provided from manifest is  1.45 hours.
[NeMo I 2025-04-17 01:07:49 collections:886] # 3123 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/49 [00:01<00:56,  1.17s/it][3/6] extract embeddings:   8%|▊         | 4/49 [00:01<00:11,  3.83it/s][3/6] extract embeddings:  12%|█▏        | 6/49 [00:01<00:07,  5.82it/s][3/6] extract embeddings:  16%|█▋        | 8/49 [00:01<00:05,  7.83it/s][3/6] extract embeddings:  20%|██        | 10/49 [00:01<00:04,  9.52it/s][3/6] extract embeddings:  24%|██▍       | 12/49 [00:01<00:03, 11.42it/s][3/6] extract embeddings:  29%|██▊       | 14/49 [00:01<00:02, 12.95it/s][3/6] extract embeddings:  33%|███▎      | 16/49 [00:01<00:02, 14.20it/s][3/6] extract embeddings:  39%|███▉      | 19/49 [00:02<00:01, 15.93it/s][3/6] extract embeddings:  43%|████▎     | 21/49 [00:02<00:01, 16.36it/s][3/6] extract embeddings:  47%|████▋     | 23/49 [00:02<00:01, 16.79it/s][3/6] extract embeddings:  51%|█████     | 25/49 [00:02<00:01, 17.60it/s][3/6] extract embeddings:  57%|█████▋    | 28/49 [00:02<00:01, 18.57it/s][3/6] extract embeddings:  61%|██████    | 30/49 [00:02<00:01, 18.26it/s][3/6] extract embeddings:  65%|██████▌   | 32/49 [00:02<00:00, 18.25it/s][3/6] extract embeddings:  71%|███████▏  | 35/49 [00:02<00:00, 19.22it/s][3/6] extract embeddings:  76%|███████▌  | 37/49 [00:03<00:00, 18.66it/s][3/6] extract embeddings:  80%|███████▉  | 39/49 [00:03<00:00, 18.67it/s][3/6] extract embeddings:  84%|████████▎ | 41/49 [00:03<00:00, 18.77it/s][3/6] extract embeddings:  88%|████████▊ | 43/49 [00:03<00:00, 18.35it/s][3/6] extract embeddings:  92%|█████████▏| 45/49 [00:03<00:00, 17.79it/s][3/6] extract embeddings:  98%|█████████▊| 48/49 [00:03<00:00, 18.07it/s][3/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 12.92it/s]
[NeMo I 2025-04-17 01:07:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:07:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:07:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:07:53 collections:880] Dataset successfully loaded with 4132 items and total duration provided from manifest is  1.53 hours.
[NeMo I 2025-04-17 01:07:53 collections:886] # 4132 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/65 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/65 [00:01<01:14,  1.16s/it][4/6] extract embeddings:   6%|▌         | 4/65 [00:01<00:15,  3.84it/s][4/6] extract embeddings:  11%|█         | 7/65 [00:01<00:08,  6.99it/s][4/6] extract embeddings:  15%|█▌        | 10/65 [00:01<00:05,  9.98it/s][4/6] extract embeddings:  20%|██        | 13/65 [00:01<00:04, 12.51it/s][4/6] extract embeddings:  25%|██▍       | 16/65 [00:01<00:03, 14.99it/s][4/6] extract embeddings:  29%|██▉       | 19/65 [00:01<00:02, 16.92it/s][4/6] extract embeddings:  34%|███▍      | 22/65 [00:02<00:02, 18.49it/s][4/6] extract embeddings:  38%|███▊      | 25/65 [00:02<00:02, 18.89it/s][4/6] extract embeddings:  43%|████▎     | 28/65 [00:02<00:01, 18.67it/s][4/6] extract embeddings:  48%|████▊     | 31/65 [00:02<00:01, 17.98it/s][4/6] extract embeddings:  51%|█████     | 33/65 [00:02<00:01, 17.41it/s][4/6] extract embeddings:  54%|█████▍    | 35/65 [00:02<00:01, 17.63it/s][4/6] extract embeddings:  57%|█████▋    | 37/65 [00:02<00:01, 17.15it/s][4/6] extract embeddings:  60%|██████    | 39/65 [00:03<00:01, 17.14it/s][4/6] extract embeddings:  63%|██████▎   | 41/65 [00:03<00:01, 17.15it/s][4/6] extract embeddings:  66%|██████▌   | 43/65 [00:03<00:01, 17.26it/s][4/6] extract embeddings:  69%|██████▉   | 45/65 [00:03<00:01, 17.62it/s][4/6] extract embeddings:  74%|███████▍  | 48/65 [00:03<00:00, 19.35it/s][4/6] extract embeddings:  78%|███████▊  | 51/65 [00:03<00:00, 20.37it/s][4/6] extract embeddings:  83%|████████▎ | 54/65 [00:03<00:00, 19.18it/s][4/6] extract embeddings:  88%|████████▊ | 57/65 [00:03<00:00, 19.68it/s][4/6] extract embeddings:  91%|█████████ | 59/65 [00:04<00:00, 19.23it/s][4/6] extract embeddings:  94%|█████████▍| 61/65 [00:04<00:00, 18.76it/s][4/6] extract embeddings:  98%|█████████▊| 64/65 [00:04<00:00, 18.77it/s][4/6] extract embeddings: 100%|██████████| 65/65 [00:04<00:00, 14.65it/s]
[NeMo I 2025-04-17 01:07:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:07:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:07:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:07:58 collections:880] Dataset successfully loaded with 6210 items and total duration provided from manifest is  1.61 hours.
[NeMo I 2025-04-17 01:07:58 collections:886] # 6210 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/98 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/98 [00:01<02:13,  1.37s/it][5/6] extract embeddings:   4%|▍         | 4/98 [00:01<00:26,  3.49it/s][5/6] extract embeddings:   7%|▋         | 7/98 [00:01<00:14,  6.43it/s][5/6] extract embeddings:  10%|█         | 10/98 [00:01<00:09,  9.63it/s][5/6] extract embeddings:  13%|█▎        | 13/98 [00:01<00:06, 12.42it/s][5/6] extract embeddings:  16%|█▋        | 16/98 [00:01<00:05, 15.01it/s][5/6] extract embeddings:  19%|█▉        | 19/98 [00:02<00:04, 16.20it/s][5/6] extract embeddings:  22%|██▏       | 22/98 [00:02<00:04, 17.66it/s][5/6] extract embeddings:  26%|██▌       | 25/98 [00:02<00:04, 17.79it/s][5/6] extract embeddings:  29%|██▊       | 28/98 [00:02<00:03, 18.57it/s][5/6] extract embeddings:  32%|███▏      | 31/98 [00:02<00:03, 19.83it/s][5/6] extract embeddings:  35%|███▍      | 34/98 [00:02<00:03, 20.20it/s][5/6] extract embeddings:  38%|███▊      | 37/98 [00:02<00:02, 20.57it/s][5/6] extract embeddings:  41%|████      | 40/98 [00:03<00:02, 21.18it/s][5/6] extract embeddings:  44%|████▍     | 43/98 [00:03<00:02, 21.74it/s][5/6] extract embeddings:  47%|████▋     | 46/98 [00:03<00:02, 22.11it/s][5/6] extract embeddings:  50%|█████     | 49/98 [00:03<00:02, 21.54it/s][5/6] extract embeddings:  53%|█████▎    | 52/98 [00:03<00:02, 21.67it/s][5/6] extract embeddings:  56%|█████▌    | 55/98 [00:03<00:02, 21.23it/s][5/6] extract embeddings:  59%|█████▉    | 58/98 [00:03<00:01, 20.70it/s][5/6] extract embeddings:  62%|██████▏   | 61/98 [00:04<00:01, 21.04it/s][5/6] extract embeddings:  65%|██████▌   | 64/98 [00:04<00:01, 20.40it/s][5/6] extract embeddings:  68%|██████▊   | 67/98 [00:04<00:01, 19.87it/s][5/6] extract embeddings:  70%|███████   | 69/98 [00:04<00:01, 19.73it/s][5/6] extract embeddings:  73%|███████▎  | 72/98 [00:04<00:01, 19.78it/s][5/6] extract embeddings:  77%|███████▋  | 75/98 [00:04<00:01, 21.57it/s][5/6] extract embeddings:  80%|███████▉  | 78/98 [00:04<00:00, 22.33it/s][5/6] extract embeddings:  83%|████████▎ | 81/98 [00:05<00:00, 22.31it/s][5/6] extract embeddings:  86%|████████▌ | 84/98 [00:05<00:00, 21.60it/s][5/6] extract embeddings:  89%|████████▉ | 87/98 [00:05<00:00, 21.09it/s][5/6] extract embeddings:  92%|█████████▏| 90/98 [00:05<00:00, 21.02it/s][5/6] extract embeddings:  95%|█████████▍| 93/98 [00:05<00:00, 21.07it/s][5/6] extract embeddings:  98%|█████████▊| 96/98 [00:05<00:00, 20.54it/s][5/6] extract embeddings: 100%|██████████| 98/98 [00:05<00:00, 16.55it/s]
[NeMo I 2025-04-17 01:08:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:08:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:08:04 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:08:04 collections:880] Dataset successfully loaded with 12637 items and total duration provided from manifest is  1.71 hours.
[NeMo I 2025-04-17 01:08:04 collections:886] # 12637 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/198 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/198 [00:01<04:17,  1.31s/it][6/6] extract embeddings:   3%|▎         | 5/198 [00:01<00:42,  4.50it/s][6/6] extract embeddings:   5%|▍         | 9/198 [00:01<00:22,  8.40it/s][6/6] extract embeddings:   6%|▌         | 12/198 [00:01<00:16, 11.21it/s][6/6] extract embeddings:   8%|▊         | 15/198 [00:01<00:12, 14.30it/s][6/6] extract embeddings:   9%|▉         | 18/198 [00:01<00:10, 16.53it/s][6/6] extract embeddings:  11%|█         | 21/198 [00:02<00:09, 18.55it/s][6/6] extract embeddings:  12%|█▏        | 24/198 [00:02<00:08, 20.19it/s][6/6] extract embeddings:  14%|█▎        | 27/198 [00:02<00:07, 22.13it/s][6/6] extract embeddings:  15%|█▌        | 30/198 [00:02<00:06, 24.01it/s][6/6] extract embeddings:  17%|█▋        | 33/198 [00:02<00:06, 25.53it/s][6/6] extract embeddings:  18%|█▊        | 36/198 [00:02<00:06, 25.89it/s][6/6] extract embeddings:  20%|█▉        | 39/198 [00:02<00:06, 25.31it/s][6/6] extract embeddings:  21%|██        | 42/198 [00:02<00:05, 26.06it/s][6/6] extract embeddings:  23%|██▎       | 45/198 [00:02<00:05, 26.64it/s][6/6] extract embeddings:  24%|██▍       | 48/198 [00:03<00:05, 25.77it/s][6/6] extract embeddings:  26%|██▌       | 51/198 [00:03<00:05, 26.37it/s][6/6] extract embeddings:  28%|██▊       | 55/198 [00:03<00:05, 28.05it/s][6/6] extract embeddings:  29%|██▉       | 58/198 [00:03<00:05, 27.56it/s][6/6] extract embeddings:  31%|███       | 61/198 [00:03<00:05, 27.06it/s][6/6] extract embeddings:  32%|███▏      | 64/198 [00:03<00:05, 26.50it/s][6/6] extract embeddings:  34%|███▍      | 67/198 [00:03<00:04, 26.94it/s][6/6] extract embeddings:  35%|███▌      | 70/198 [00:03<00:04, 27.61it/s][6/6] extract embeddings:  37%|███▋      | 73/198 [00:03<00:04, 27.77it/s][6/6] extract embeddings:  38%|███▊      | 76/198 [00:04<00:04, 27.69it/s][6/6] extract embeddings:  40%|███▉      | 79/198 [00:04<00:04, 25.96it/s][6/6] extract embeddings:  41%|████▏     | 82/198 [00:04<00:04, 25.94it/s][6/6] extract embeddings:  43%|████▎     | 85/198 [00:04<00:04, 26.19it/s][6/6] extract embeddings:  44%|████▍     | 88/198 [00:04<00:04, 26.36it/s][6/6] extract embeddings:  46%|████▌     | 91/198 [00:04<00:04, 25.27it/s][6/6] extract embeddings:  47%|████▋     | 94/198 [00:04<00:04, 25.07it/s][6/6] extract embeddings:  49%|████▉     | 97/198 [00:04<00:03, 25.30it/s][6/6] extract embeddings:  51%|█████     | 101/198 [00:05<00:03, 27.91it/s][6/6] extract embeddings:  53%|█████▎    | 104/198 [00:05<00:03, 27.99it/s][6/6] extract embeddings:  54%|█████▍    | 107/198 [00:05<00:03, 27.43it/s][6/6] extract embeddings:  56%|█████▌    | 111/198 [00:05<00:03, 28.42it/s][6/6] extract embeddings:  58%|█████▊    | 114/198 [00:05<00:03, 27.64it/s][6/6] extract embeddings:  59%|█████▉    | 117/198 [00:05<00:02, 27.24it/s][6/6] extract embeddings:  61%|██████    | 120/198 [00:05<00:02, 27.77it/s][6/6] extract embeddings:  62%|██████▏   | 123/198 [00:05<00:02, 27.74it/s][6/6] extract embeddings:  64%|██████▎   | 126/198 [00:05<00:02, 26.29it/s][6/6] extract embeddings:  65%|██████▌   | 129/198 [00:06<00:02, 26.95it/s][6/6] extract embeddings:  67%|██████▋   | 132/198 [00:06<00:02, 26.58it/s][6/6] extract embeddings:  68%|██████▊   | 135/198 [00:06<00:02, 27.28it/s][6/6] extract embeddings:  70%|██████▉   | 138/198 [00:06<00:02, 25.28it/s][6/6] extract embeddings:  71%|███████   | 141/198 [00:06<00:02, 23.99it/s][6/6] extract embeddings:  73%|███████▎  | 144/198 [00:06<00:02, 25.01it/s][6/6] extract embeddings:  74%|███████▍  | 147/198 [00:06<00:01, 26.25it/s][6/6] extract embeddings:  76%|███████▌  | 150/198 [00:06<00:01, 26.03it/s][6/6] extract embeddings:  77%|███████▋  | 153/198 [00:06<00:01, 26.12it/s][6/6] extract embeddings:  79%|███████▉  | 156/198 [00:07<00:01, 26.10it/s][6/6] extract embeddings:  80%|████████  | 159/198 [00:07<00:01, 25.47it/s][6/6] extract embeddings:  82%|████████▏ | 162/198 [00:07<00:01, 25.25it/s][6/6] extract embeddings:  83%|████████▎ | 165/198 [00:07<00:01, 25.24it/s][6/6] extract embeddings:  85%|████████▍ | 168/198 [00:07<00:01, 25.31it/s][6/6] extract embeddings:  86%|████████▋ | 171/198 [00:07<00:01, 25.01it/s][6/6] extract embeddings:  88%|████████▊ | 174/198 [00:07<00:00, 25.34it/s][6/6] extract embeddings:  89%|████████▉ | 177/198 [00:07<00:00, 25.76it/s][6/6] extract embeddings:  91%|█████████ | 180/198 [00:08<00:00, 26.64it/s][6/6] extract embeddings:  92%|█████████▏| 183/198 [00:08<00:00, 27.54it/s][6/6] extract embeddings:  94%|█████████▍| 186/198 [00:08<00:00, 26.62it/s][6/6] extract embeddings:  96%|█████████▌| 190/198 [00:08<00:00, 27.96it/s][6/6] extract embeddings:  98%|█████████▊| 194/198 [00:08<00:00, 28.56it/s][6/6] extract embeddings:  99%|█████████▉| 197/198 [00:08<00:00, 28.37it/s][6/6] extract embeddings: 100%|██████████| 198/198 [00:08<00:00, 22.84it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.94it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.38it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.00it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.61it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.20it/s]
[NeMo I 2025-04-17 01:08:15 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:08:16 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              42.829707   444.120  ...   17.035011  3.835678
    Harker-ES                       33.615770  2178.782  ...   53.100444  2.437162
    Harker-MN                       45.953182   366.767  ...   33.690029  9.185676
    Longfellow-Block-1              27.900888   492.417  ...    9.794951  1.989158
    TOTAL                           35.282284  3482.086  ...  113.620435  3.262999
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:08:16 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0751 | MISS: 0.2451 | CER: 0.0326 | DER: 0.3528 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.84s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:08:28 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:08:28 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:08:28 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:08:28 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:08:28 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:08:29 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:08:29 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:08:29 features:305] PADDING: 16
[NeMo I 2025-04-17 01:08:29 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:08:29 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:08:29 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:08:29 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:08:29 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:08:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:08:29 collections:880] Dataset successfully loaded with 2168 items and total duration provided from manifest is  1.27 hours.
[NeMo I 2025-04-17 01:08:29 collections:886] # 2168 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:02<01:09,  2.11s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.33it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.65it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:05,  5.16it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  6.70it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  8.04it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:02,  9.56it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:03<00:01, 10.66it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:03<00:01, 11.52it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:01, 12.17it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 12.71it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 13.68it/s][1/6] extract embeddings:  76%|███████▋  | 26/34 [00:03<00:00, 13.75it/s][1/6] extract embeddings:  82%|████████▏ | 28/34 [00:03<00:00, 13.91it/s][1/6] extract embeddings:  88%|████████▊ | 30/34 [00:04<00:00, 13.80it/s][1/6] extract embeddings:  94%|█████████▍| 32/34 [00:04<00:00, 13.69it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:04<00:00, 13.83it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:04<00:00,  7.82it/s]
[NeMo I 2025-04-17 01:08:33 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:08:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:08:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:08:34 collections:880] Dataset successfully loaded with 2511 items and total duration provided from manifest is  1.33 hours.
[NeMo I 2025-04-17 01:08:34 collections:886] # 2511 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:56,  1.45s/it][2/6] extract embeddings:   8%|▊         | 3/40 [00:01<00:15,  2.38it/s][2/6] extract embeddings:  12%|█▎        | 5/40 [00:01<00:08,  4.17it/s][2/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:05,  6.06it/s][2/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  7.94it/s][2/6] extract embeddings:  28%|██▊       | 11/40 [00:02<00:03,  9.58it/s][2/6] extract embeddings:  32%|███▎      | 13/40 [00:02<00:02, 11.00it/s][2/6] extract embeddings:  38%|███▊      | 15/40 [00:02<00:02, 12.01it/s][2/6] extract embeddings:  42%|████▎     | 17/40 [00:02<00:01, 12.81it/s][2/6] extract embeddings:  48%|████▊     | 19/40 [00:02<00:01, 13.65it/s][2/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 14.27it/s][2/6] extract embeddings:  57%|█████▊    | 23/40 [00:02<00:01, 14.71it/s][2/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:01, 14.76it/s][2/6] extract embeddings:  68%|██████▊   | 27/40 [00:03<00:00, 15.43it/s][2/6] extract embeddings:  72%|███████▎  | 29/40 [00:03<00:00, 15.49it/s][2/6] extract embeddings:  78%|███████▊  | 31/40 [00:03<00:00, 15.11it/s][2/6] extract embeddings:  82%|████████▎ | 33/40 [00:03<00:00, 14.72it/s][2/6] extract embeddings:  88%|████████▊ | 35/40 [00:03<00:00, 14.83it/s][2/6] extract embeddings:  92%|█████████▎| 37/40 [00:03<00:00, 14.53it/s][2/6] extract embeddings:  98%|█████████▊| 39/40 [00:03<00:00, 14.80it/s][2/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 10.04it/s]
[NeMo I 2025-04-17 01:08:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:08:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:08:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:08:38 collections:880] Dataset successfully loaded with 3038 items and total duration provided from manifest is  1.38 hours.
[NeMo I 2025-04-17 01:08:38 collections:886] # 3038 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/48 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/48 [00:01<00:55,  1.18s/it][3/6] extract embeddings:   6%|▋         | 3/48 [00:01<00:15,  2.88it/s][3/6] extract embeddings:  10%|█         | 5/48 [00:01<00:08,  5.07it/s][3/6] extract embeddings:  15%|█▍        | 7/48 [00:01<00:05,  7.28it/s][3/6] extract embeddings:  19%|█▉        | 9/48 [00:01<00:04,  9.37it/s][3/6] extract embeddings:  23%|██▎       | 11/48 [00:01<00:03, 10.94it/s][3/6] extract embeddings:  27%|██▋       | 13/48 [00:01<00:02, 12.51it/s][3/6] extract embeddings:  31%|███▏      | 15/48 [00:01<00:02, 13.28it/s][3/6] extract embeddings:  35%|███▌      | 17/48 [00:02<00:02, 14.32it/s][3/6] extract embeddings:  40%|███▉      | 19/48 [00:02<00:01, 15.05it/s][3/6] extract embeddings:  44%|████▍     | 21/48 [00:02<00:01, 15.62it/s][3/6] extract embeddings:  48%|████▊     | 23/48 [00:02<00:01, 16.11it/s][3/6] extract embeddings:  52%|█████▏    | 25/48 [00:02<00:01, 16.06it/s][3/6] extract embeddings:  56%|█████▋    | 27/48 [00:02<00:01, 16.12it/s][3/6] extract embeddings:  60%|██████    | 29/48 [00:02<00:01, 16.98it/s][3/6] extract embeddings:  67%|██████▋   | 32/48 [00:02<00:00, 17.97it/s][3/6] extract embeddings:  71%|███████   | 34/48 [00:03<00:00, 18.15it/s][3/6] extract embeddings:  75%|███████▌  | 36/48 [00:03<00:00, 17.32it/s][3/6] extract embeddings:  79%|███████▉  | 38/48 [00:03<00:00, 16.81it/s][3/6] extract embeddings:  83%|████████▎ | 40/48 [00:03<00:00, 16.72it/s][3/6] extract embeddings:  88%|████████▊ | 42/48 [00:03<00:00, 16.89it/s][3/6] extract embeddings:  92%|█████████▏| 44/48 [00:03<00:00, 17.41it/s][3/6] extract embeddings:  96%|█████████▌| 46/48 [00:03<00:00, 17.69it/s][3/6] extract embeddings: 100%|██████████| 48/48 [00:03<00:00, 12.32it/s]
[NeMo I 2025-04-17 01:08:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:08:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:08:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:08:42 collections:880] Dataset successfully loaded with 4009 items and total duration provided from manifest is  1.46 hours.
[NeMo I 2025-04-17 01:08:42 collections:886] # 4009 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/63 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/63 [00:01<01:13,  1.19s/it][4/6] extract embeddings:   6%|▋         | 4/63 [00:01<00:15,  3.85it/s][4/6] extract embeddings:  10%|▉         | 6/63 [00:01<00:09,  5.79it/s][4/6] extract embeddings:  13%|█▎        | 8/63 [00:01<00:07,  7.71it/s][4/6] extract embeddings:  16%|█▌        | 10/63 [00:01<00:05,  9.53it/s][4/6] extract embeddings:  19%|█▉        | 12/63 [00:01<00:04, 11.31it/s][4/6] extract embeddings:  22%|██▏       | 14/63 [00:01<00:03, 12.92it/s][4/6] extract embeddings:  25%|██▌       | 16/63 [00:02<00:03, 14.05it/s][4/6] extract embeddings:  29%|██▊       | 18/63 [00:02<00:03, 14.96it/s][4/6] extract embeddings:  32%|███▏      | 20/63 [00:02<00:02, 15.64it/s][4/6] extract embeddings:  35%|███▍      | 22/63 [00:02<00:02, 16.31it/s][4/6] extract embeddings:  38%|███▊      | 24/63 [00:02<00:02, 16.75it/s][4/6] extract embeddings:  41%|████▏     | 26/63 [00:02<00:02, 16.73it/s][4/6] extract embeddings:  44%|████▍     | 28/63 [00:02<00:02, 17.17it/s][4/6] extract embeddings:  48%|████▊     | 30/63 [00:02<00:01, 17.25it/s][4/6] extract embeddings:  51%|█████     | 32/63 [00:02<00:01, 17.46it/s][4/6] extract embeddings:  54%|█████▍    | 34/63 [00:03<00:01, 17.72it/s][4/6] extract embeddings:  57%|█████▋    | 36/63 [00:03<00:01, 17.46it/s][4/6] extract embeddings:  60%|██████    | 38/63 [00:03<00:01, 16.80it/s][4/6] extract embeddings:  63%|██████▎   | 40/63 [00:03<00:01, 17.02it/s][4/6] extract embeddings:  67%|██████▋   | 42/63 [00:03<00:01, 17.54it/s][4/6] extract embeddings:  70%|██████▉   | 44/63 [00:03<00:01, 17.83it/s][4/6] extract embeddings:  73%|███████▎  | 46/63 [00:03<00:00, 18.43it/s][4/6] extract embeddings:  76%|███████▌  | 48/63 [00:03<00:00, 18.60it/s][4/6] extract embeddings:  81%|████████  | 51/63 [00:03<00:00, 20.40it/s][4/6] extract embeddings:  86%|████████▌ | 54/63 [00:04<00:00, 20.95it/s][4/6] extract embeddings:  90%|█████████ | 57/63 [00:04<00:00, 20.22it/s][4/6] extract embeddings:  95%|█████████▌| 60/63 [00:04<00:00, 21.02it/s][4/6] extract embeddings: 100%|██████████| 63/63 [00:04<00:00, 21.28it/s][4/6] extract embeddings: 100%|██████████| 63/63 [00:04<00:00, 13.92it/s]
[NeMo I 2025-04-17 01:08:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:08:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:08:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:08:47 collections:880] Dataset successfully loaded with 6005 items and total duration provided from manifest is  1.55 hours.
[NeMo I 2025-04-17 01:08:47 collections:886] # 6005 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/94 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/94 [00:01<01:49,  1.18s/it][5/6] extract embeddings:   4%|▍         | 4/94 [00:01<00:22,  3.96it/s][5/6] extract embeddings:   7%|▋         | 7/94 [00:01<00:12,  7.14it/s][5/6] extract embeddings:  11%|█         | 10/94 [00:01<00:08, 10.24it/s][5/6] extract embeddings:  14%|█▍        | 13/94 [00:01<00:06, 13.04it/s][5/6] extract embeddings:  17%|█▋        | 16/94 [00:01<00:04, 15.75it/s][5/6] extract embeddings:  20%|██        | 19/94 [00:01<00:04, 17.00it/s][5/6] extract embeddings:  23%|██▎       | 22/94 [00:02<00:03, 18.49it/s][5/6] extract embeddings:  27%|██▋       | 25/94 [00:02<00:03, 18.97it/s][5/6] extract embeddings:  30%|██▉       | 28/94 [00:02<00:03, 19.81it/s][5/6] extract embeddings:  33%|███▎      | 31/94 [00:02<00:03, 20.53it/s][5/6] extract embeddings:  36%|███▌      | 34/94 [00:02<00:02, 21.34it/s][5/6] extract embeddings:  39%|███▉      | 37/94 [00:02<00:02, 21.15it/s][5/6] extract embeddings:  43%|████▎     | 40/94 [00:02<00:02, 21.64it/s][5/6] extract embeddings:  46%|████▌     | 43/94 [00:03<00:02, 21.58it/s][5/6] extract embeddings:  49%|████▉     | 46/94 [00:03<00:02, 21.28it/s][5/6] extract embeddings:  52%|█████▏    | 49/94 [00:03<00:02, 21.57it/s][5/6] extract embeddings:  55%|█████▌    | 52/94 [00:03<00:01, 21.72it/s][5/6] extract embeddings:  59%|█████▊    | 55/94 [00:03<00:01, 21.63it/s][5/6] extract embeddings:  62%|██████▏   | 58/94 [00:03<00:01, 21.81it/s][5/6] extract embeddings:  65%|██████▍   | 61/94 [00:03<00:01, 21.75it/s][5/6] extract embeddings:  68%|██████▊   | 64/94 [00:04<00:01, 21.69it/s][5/6] extract embeddings:  71%|███████▏  | 67/94 [00:04<00:01, 21.84it/s][5/6] extract embeddings:  74%|███████▍  | 70/94 [00:04<00:01, 22.31it/s][5/6] extract embeddings:  78%|███████▊  | 73/94 [00:04<00:00, 22.41it/s][5/6] extract embeddings:  81%|████████  | 76/94 [00:04<00:00, 22.47it/s][5/6] extract embeddings:  84%|████████▍ | 79/94 [00:04<00:00, 21.07it/s][5/6] extract embeddings:  87%|████████▋ | 82/94 [00:04<00:00, 21.79it/s][5/6] extract embeddings:  90%|█████████ | 85/94 [00:04<00:00, 22.06it/s][5/6] extract embeddings:  94%|█████████▎| 88/94 [00:05<00:00, 23.15it/s][5/6] extract embeddings:  97%|█████████▋| 91/94 [00:05<00:00, 23.31it/s][5/6] extract embeddings: 100%|██████████| 94/94 [00:05<00:00, 21.98it/s][5/6] extract embeddings: 100%|██████████| 94/94 [00:05<00:00, 17.48it/s]
[NeMo I 2025-04-17 01:08:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:08:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:08:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:08:52 collections:880] Dataset successfully loaded with 12230 items and total duration provided from manifest is  1.65 hours.
[NeMo I 2025-04-17 01:08:52 collections:886] # 12230 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/192 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/192 [00:01<03:53,  1.22s/it][6/6] extract embeddings:   3%|▎         | 5/192 [00:01<00:39,  4.72it/s][6/6] extract embeddings:   4%|▍         | 8/192 [00:01<00:24,  7.67it/s][6/6] extract embeddings:   6%|▌         | 11/192 [00:01<00:16, 10.77it/s][6/6] extract embeddings:   7%|▋         | 14/192 [00:01<00:13, 13.68it/s][6/6] extract embeddings:   9%|▉         | 17/192 [00:01<00:11, 15.71it/s][6/6] extract embeddings:  10%|█         | 20/192 [00:01<00:09, 17.69it/s][6/6] extract embeddings:  12%|█▏        | 23/192 [00:02<00:08, 18.97it/s][6/6] extract embeddings:  14%|█▎        | 26/192 [00:02<00:07, 20.78it/s][6/6] extract embeddings:  15%|█▌        | 29/192 [00:02<00:07, 21.89it/s][6/6] extract embeddings:  17%|█▋        | 32/192 [00:02<00:07, 22.34it/s][6/6] extract embeddings:  18%|█▊        | 35/192 [00:02<00:06, 22.70it/s][6/6] extract embeddings:  20%|█▉        | 38/192 [00:02<00:06, 23.56it/s][6/6] extract embeddings:  21%|██▏       | 41/192 [00:02<00:06, 23.17it/s][6/6] extract embeddings:  23%|██▎       | 44/192 [00:02<00:06, 23.99it/s][6/6] extract embeddings:  24%|██▍       | 47/192 [00:03<00:06, 22.40it/s][6/6] extract embeddings:  26%|██▌       | 50/192 [00:03<00:06, 22.03it/s][6/6] extract embeddings:  28%|██▊       | 53/192 [00:03<00:06, 22.31it/s][6/6] extract embeddings:  29%|██▉       | 56/192 [00:03<00:05, 24.09it/s][6/6] extract embeddings:  31%|███       | 59/192 [00:03<00:05, 24.49it/s][6/6] extract embeddings:  32%|███▏      | 62/192 [00:03<00:05, 25.78it/s][6/6] extract embeddings:  34%|███▍      | 65/192 [00:03<00:04, 26.37it/s][6/6] extract embeddings:  35%|███▌      | 68/192 [00:03<00:04, 26.84it/s][6/6] extract embeddings:  37%|███▋      | 71/192 [00:04<00:04, 27.43it/s][6/6] extract embeddings:  39%|███▉      | 75/192 [00:04<00:04, 28.49it/s][6/6] extract embeddings:  41%|████      | 78/192 [00:04<00:04, 28.45it/s][6/6] extract embeddings:  42%|████▏     | 81/192 [00:04<00:03, 27.91it/s][6/6] extract embeddings:  44%|████▍     | 84/192 [00:04<00:03, 27.95it/s][6/6] extract embeddings:  45%|████▌     | 87/192 [00:04<00:03, 27.35it/s][6/6] extract embeddings:  47%|████▋     | 90/192 [00:04<00:03, 26.50it/s][6/6] extract embeddings:  48%|████▊     | 93/192 [00:04<00:03, 25.17it/s][6/6] extract embeddings:  50%|█████     | 96/192 [00:04<00:03, 24.78it/s][6/6] extract embeddings:  52%|█████▏    | 99/192 [00:05<00:03, 25.27it/s][6/6] extract embeddings:  53%|█████▎    | 102/192 [00:05<00:03, 25.36it/s][6/6] extract embeddings:  55%|█████▍    | 105/192 [00:05<00:03, 25.15it/s][6/6] extract embeddings:  56%|█████▋    | 108/192 [00:05<00:03, 24.35it/s][6/6] extract embeddings:  58%|█████▊    | 111/192 [00:05<00:03, 25.28it/s][6/6] extract embeddings:  59%|█████▉    | 114/192 [00:05<00:03, 25.72it/s][6/6] extract embeddings:  61%|██████    | 117/192 [00:05<00:02, 25.53it/s][6/6] extract embeddings:  62%|██████▎   | 120/192 [00:05<00:02, 26.14it/s][6/6] extract embeddings:  64%|██████▍   | 123/192 [00:06<00:02, 25.47it/s][6/6] extract embeddings:  66%|██████▌   | 126/192 [00:06<00:02, 24.41it/s][6/6] extract embeddings:  67%|██████▋   | 129/192 [00:06<00:02, 24.79it/s][6/6] extract embeddings:  69%|██████▉   | 132/192 [00:06<00:02, 23.60it/s][6/6] extract embeddings:  70%|███████   | 135/192 [00:06<00:02, 25.06it/s][6/6] extract embeddings:  72%|███████▏  | 138/192 [00:06<00:02, 25.40it/s][6/6] extract embeddings:  73%|███████▎  | 141/192 [00:06<00:01, 25.94it/s][6/6] extract embeddings:  75%|███████▌  | 144/192 [00:06<00:01, 24.68it/s][6/6] extract embeddings:  77%|███████▋  | 147/192 [00:07<00:01, 24.93it/s][6/6] extract embeddings:  78%|███████▊  | 150/192 [00:07<00:01, 24.79it/s][6/6] extract embeddings:  80%|███████▉  | 153/192 [00:07<00:01, 24.86it/s][6/6] extract embeddings:  81%|████████▏ | 156/192 [00:07<00:01, 24.33it/s][6/6] extract embeddings:  83%|████████▎ | 159/192 [00:07<00:01, 25.19it/s][6/6] extract embeddings:  84%|████████▍ | 162/192 [00:07<00:01, 25.37it/s][6/6] extract embeddings:  86%|████████▌ | 165/192 [00:07<00:01, 24.89it/s][6/6] extract embeddings:  88%|████████▊ | 168/192 [00:07<00:00, 25.34it/s][6/6] extract embeddings:  89%|████████▉ | 171/192 [00:07<00:00, 26.11it/s][6/6] extract embeddings:  91%|█████████ | 174/192 [00:08<00:00, 25.77it/s][6/6] extract embeddings:  92%|█████████▏| 177/192 [00:08<00:00, 26.69it/s][6/6] extract embeddings:  94%|█████████▍| 180/192 [00:08<00:00, 27.30it/s][6/6] extract embeddings:  95%|█████████▌| 183/192 [00:08<00:00, 27.81it/s][6/6] extract embeddings:  97%|█████████▋| 187/192 [00:08<00:00, 29.13it/s][6/6] extract embeddings:  99%|█████████▉| 190/192 [00:08<00:00, 27.92it/s][6/6] extract embeddings: 100%|██████████| 192/192 [00:08<00:00, 22.00it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.14it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.46it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.08it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.70it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.30it/s]
[NeMo I 2025-04-17 01:09:03 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:09:04 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              43.385868   444.120  ...   15.405015  3.468661
    Harker-ES                       35.379705  2178.782  ...   55.089872  2.528471
    Harker-MN                       47.316159   366.767  ...   32.978999  8.991812
    Longfellow-Block-1              30.311229   492.417  ...    9.873934  2.005198
    TOTAL                           36.941352  3482.086  ...  113.347820  3.255170
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:09:04 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0714 | MISS: 0.2654 | CER: 0.0326 | DER: 0.3694 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.83s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.94s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:09:17 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:09:17 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:09:17 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:09:17 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:09:17 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:09:17 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:09:17 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:09:17 features:305] PADDING: 16
[NeMo I 2025-04-17 01:09:18 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:09:18 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:09:18 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:09:18 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:09:18 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:09:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:09:18 collections:880] Dataset successfully loaded with 2138 items and total duration provided from manifest is  1.19 hours.
[NeMo I 2025-04-17 01:09:18 collections:886] # 2138 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:02<01:07,  2.04s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.38it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.83it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.41it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.01it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  8.47it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.03it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 11.62it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:03<00:01, 12.62it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:01, 13.21it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 14.06it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 14.90it/s][1/6] extract embeddings:  76%|███████▋  | 26/34 [00:03<00:00, 15.05it/s][1/6] extract embeddings:  82%|████████▏ | 28/34 [00:03<00:00, 15.19it/s][1/6] extract embeddings:  88%|████████▊ | 30/34 [00:03<00:00, 15.67it/s][1/6] extract embeddings:  94%|█████████▍| 32/34 [00:03<00:00, 15.71it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:04<00:00,  8.44it/s]
[NeMo I 2025-04-17 01:09:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:09:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:09:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:09:22 collections:880] Dataset successfully loaded with 2442 items and total duration provided from manifest is  1.24 hours.
[NeMo I 2025-04-17 01:09:22 collections:886] # 2442 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:54,  1.43s/it][2/6] extract embeddings:   8%|▊         | 3/39 [00:01<00:14,  2.42it/s][2/6] extract embeddings:  13%|█▎        | 5/39 [00:01<00:07,  4.29it/s][2/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:05,  6.26it/s][2/6] extract embeddings:  23%|██▎       | 9/39 [00:01<00:03,  8.42it/s][2/6] extract embeddings:  28%|██▊       | 11/39 [00:02<00:02,  9.86it/s][2/6] extract embeddings:  33%|███▎      | 13/39 [00:02<00:02, 11.33it/s][2/6] extract embeddings:  38%|███▊      | 15/39 [00:02<00:01, 12.76it/s][2/6] extract embeddings:  44%|████▎     | 17/39 [00:02<00:01, 13.13it/s][2/6] extract embeddings:  49%|████▊     | 19/39 [00:02<00:01, 13.99it/s][2/6] extract embeddings:  56%|█████▋    | 22/39 [00:02<00:01, 15.70it/s][2/6] extract embeddings:  62%|██████▏   | 24/39 [00:02<00:00, 16.55it/s][2/6] extract embeddings:  67%|██████▋   | 26/39 [00:02<00:00, 16.74it/s][2/6] extract embeddings:  72%|███████▏  | 28/39 [00:03<00:00, 16.71it/s][2/6] extract embeddings:  77%|███████▋  | 30/39 [00:03<00:00, 16.50it/s][2/6] extract embeddings:  82%|████████▏ | 32/39 [00:03<00:00, 15.46it/s][2/6] extract embeddings:  87%|████████▋ | 34/39 [00:03<00:00, 15.75it/s][2/6] extract embeddings:  92%|█████████▏| 36/39 [00:03<00:00, 16.14it/s][2/6] extract embeddings:  97%|█████████▋| 38/39 [00:03<00:00, 16.68it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:03<00:00, 10.52it/s]
[NeMo I 2025-04-17 01:09:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:09:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:09:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:09:26 collections:880] Dataset successfully loaded with 2936 items and total duration provided from manifest is  1.30 hours.
[NeMo I 2025-04-17 01:09:26 collections:886] # 2936 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:53,  1.19s/it][3/6] extract embeddings:   7%|▋         | 3/46 [00:01<00:15,  2.86it/s][3/6] extract embeddings:  11%|█         | 5/46 [00:01<00:08,  5.01it/s][3/6] extract embeddings:  15%|█▌        | 7/46 [00:01<00:05,  7.12it/s][3/6] extract embeddings:  20%|█▉        | 9/46 [00:01<00:04,  9.06it/s][3/6] extract embeddings:  24%|██▍       | 11/46 [00:01<00:03, 10.97it/s][3/6] extract embeddings:  28%|██▊       | 13/46 [00:01<00:02, 12.46it/s][3/6] extract embeddings:  33%|███▎      | 15/46 [00:02<00:02, 13.47it/s][3/6] extract embeddings:  37%|███▋      | 17/46 [00:02<00:02, 14.20it/s][3/6] extract embeddings:  41%|████▏     | 19/46 [00:02<00:01, 15.47it/s][3/6] extract embeddings:  46%|████▌     | 21/46 [00:02<00:01, 16.47it/s][3/6] extract embeddings:  50%|█████     | 23/46 [00:02<00:01, 16.62it/s][3/6] extract embeddings:  54%|█████▍    | 25/46 [00:02<00:01, 17.12it/s][3/6] extract embeddings:  59%|█████▊    | 27/46 [00:02<00:01, 17.63it/s][3/6] extract embeddings:  63%|██████▎   | 29/46 [00:02<00:00, 17.41it/s][3/6] extract embeddings:  67%|██████▋   | 31/46 [00:02<00:00, 18.03it/s][3/6] extract embeddings:  72%|███████▏  | 33/46 [00:02<00:00, 18.51it/s][3/6] extract embeddings:  76%|███████▌  | 35/46 [00:03<00:00, 17.54it/s][3/6] extract embeddings:  80%|████████  | 37/46 [00:03<00:00, 17.54it/s][3/6] extract embeddings:  85%|████████▍ | 39/46 [00:03<00:00, 16.72it/s][3/6] extract embeddings:  89%|████████▉ | 41/46 [00:03<00:00, 17.14it/s][3/6] extract embeddings:  93%|█████████▎| 43/46 [00:03<00:00, 16.88it/s][3/6] extract embeddings:  98%|█████████▊| 45/46 [00:03<00:00, 17.22it/s][3/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 12.11it/s]
[NeMo I 2025-04-17 01:09:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:09:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:09:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:09:30 collections:880] Dataset successfully loaded with 3848 items and total duration provided from manifest is  1.38 hours.
[NeMo I 2025-04-17 01:09:30 collections:886] # 3848 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/61 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/61 [00:01<01:13,  1.23s/it][4/6] extract embeddings:   7%|▋         | 4/61 [00:01<00:15,  3.72it/s][4/6] extract embeddings:  11%|█▏        | 7/61 [00:01<00:08,  6.71it/s][4/6] extract embeddings:  16%|█▋        | 10/61 [00:01<00:05,  9.47it/s][4/6] extract embeddings:  21%|██▏       | 13/61 [00:01<00:03, 12.10it/s][4/6] extract embeddings:  25%|██▍       | 15/61 [00:01<00:03, 13.27it/s][4/6] extract embeddings:  28%|██▊       | 17/61 [00:01<00:03, 14.47it/s][4/6] extract embeddings:  31%|███       | 19/61 [00:02<00:02, 15.42it/s][4/6] extract embeddings:  36%|███▌      | 22/61 [00:02<00:02, 16.78it/s][4/6] extract embeddings:  41%|████      | 25/61 [00:02<00:02, 17.74it/s][4/6] extract embeddings:  46%|████▌     | 28/61 [00:02<00:01, 18.22it/s][4/6] extract embeddings:  51%|█████     | 31/61 [00:02<00:01, 19.30it/s][4/6] extract embeddings:  56%|█████▌    | 34/61 [00:02<00:01, 19.25it/s][4/6] extract embeddings:  59%|█████▉    | 36/61 [00:02<00:01, 19.22it/s][4/6] extract embeddings:  64%|██████▍   | 39/61 [00:03<00:01, 19.46it/s][4/6] extract embeddings:  67%|██████▋   | 41/61 [00:03<00:01, 19.49it/s][4/6] extract embeddings:  70%|███████   | 43/61 [00:03<00:00, 19.32it/s][4/6] extract embeddings:  74%|███████▍  | 45/61 [00:03<00:00, 19.29it/s][4/6] extract embeddings:  77%|███████▋  | 47/61 [00:03<00:00, 19.28it/s][4/6] extract embeddings:  80%|████████  | 49/61 [00:03<00:00, 19.09it/s][4/6] extract embeddings:  84%|████████▎ | 51/61 [00:03<00:00, 18.86it/s][4/6] extract embeddings:  87%|████████▋ | 53/61 [00:03<00:00, 18.93it/s][4/6] extract embeddings:  90%|█████████ | 55/61 [00:03<00:00, 19.14it/s][4/6] extract embeddings:  93%|█████████▎| 57/61 [00:04<00:00, 19.09it/s][4/6] extract embeddings:  98%|█████████▊| 60/61 [00:04<00:00, 19.67it/s][4/6] extract embeddings: 100%|██████████| 61/61 [00:04<00:00, 14.29it/s]
[NeMo I 2025-04-17 01:09:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:09:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:09:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:09:34 collections:880] Dataset successfully loaded with 5742 items and total duration provided from manifest is  1.46 hours.
[NeMo I 2025-04-17 01:09:34 collections:886] # 5742 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/90 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/90 [00:01<01:43,  1.17s/it][5/6] extract embeddings:   4%|▍         | 4/90 [00:01<00:21,  3.93it/s][5/6] extract embeddings:   8%|▊         | 7/90 [00:01<00:11,  7.06it/s][5/6] extract embeddings:  11%|█         | 10/90 [00:01<00:07, 10.25it/s][5/6] extract embeddings:  14%|█▍        | 13/90 [00:01<00:05, 13.24it/s][5/6] extract embeddings:  18%|█▊        | 16/90 [00:01<00:04, 15.56it/s][5/6] extract embeddings:  21%|██        | 19/90 [00:01<00:03, 18.19it/s][5/6] extract embeddings:  24%|██▍       | 22/90 [00:02<00:03, 20.16it/s][5/6] extract embeddings:  28%|██▊       | 25/90 [00:02<00:02, 21.95it/s][5/6] extract embeddings:  31%|███       | 28/90 [00:02<00:02, 23.10it/s][5/6] extract embeddings:  34%|███▍      | 31/90 [00:02<00:02, 24.51it/s][5/6] extract embeddings:  38%|███▊      | 34/90 [00:02<00:02, 24.83it/s][5/6] extract embeddings:  41%|████      | 37/90 [00:02<00:02, 24.71it/s][5/6] extract embeddings:  44%|████▍     | 40/90 [00:02<00:01, 25.39it/s][5/6] extract embeddings:  48%|████▊     | 43/90 [00:02<00:01, 25.44it/s][5/6] extract embeddings:  51%|█████     | 46/90 [00:02<00:01, 24.60it/s][5/6] extract embeddings:  54%|█████▍    | 49/90 [00:03<00:01, 25.18it/s][5/6] extract embeddings:  58%|█████▊    | 52/90 [00:03<00:01, 25.33it/s][5/6] extract embeddings:  61%|██████    | 55/90 [00:03<00:01, 26.35it/s][5/6] extract embeddings:  64%|██████▍   | 58/90 [00:03<00:01, 25.90it/s][5/6] extract embeddings:  68%|██████▊   | 61/90 [00:03<00:01, 26.22it/s][5/6] extract embeddings:  71%|███████   | 64/90 [00:03<00:00, 26.05it/s][5/6] extract embeddings:  74%|███████▍  | 67/90 [00:03<00:00, 26.30it/s][5/6] extract embeddings:  78%|███████▊  | 70/90 [00:03<00:00, 25.88it/s][5/6] extract embeddings:  81%|████████  | 73/90 [00:03<00:00, 26.43it/s][5/6] extract embeddings:  84%|████████▍ | 76/90 [00:04<00:00, 25.20it/s][5/6] extract embeddings:  88%|████████▊ | 79/90 [00:04<00:00, 25.01it/s][5/6] extract embeddings:  91%|█████████ | 82/90 [00:04<00:00, 25.39it/s][5/6] extract embeddings:  94%|█████████▍| 85/90 [00:04<00:00, 25.85it/s][5/6] extract embeddings:  98%|█████████▊| 88/90 [00:04<00:00, 26.34it/s][5/6] extract embeddings: 100%|██████████| 90/90 [00:04<00:00, 19.31it/s]
[NeMo I 2025-04-17 01:09:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:09:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:09:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:09:39 collections:880] Dataset successfully loaded with 11692 items and total duration provided from manifest is  1.57 hours.
[NeMo I 2025-04-17 01:09:39 collections:886] # 11692 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/183 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/183 [00:01<03:25,  1.13s/it][6/6] extract embeddings:   3%|▎         | 5/183 [00:01<00:34,  5.19it/s][6/6] extract embeddings:   5%|▍         | 9/183 [00:01<00:17,  9.81it/s][6/6] extract embeddings:   7%|▋         | 13/183 [00:01<00:12, 14.10it/s][6/6] extract embeddings:   9%|▊         | 16/183 [00:01<00:09, 16.88it/s][6/6] extract embeddings:  11%|█         | 20/183 [00:01<00:07, 20.86it/s][6/6] extract embeddings:  13%|█▎        | 24/183 [00:01<00:06, 24.22it/s][6/6] extract embeddings:  15%|█▌        | 28/183 [00:01<00:06, 25.48it/s][6/6] extract embeddings:  17%|█▋        | 32/183 [00:02<00:05, 28.01it/s][6/6] extract embeddings:  20%|█▉        | 36/183 [00:02<00:04, 29.62it/s][6/6] extract embeddings:  22%|██▏       | 40/183 [00:02<00:05, 27.30it/s][6/6] extract embeddings:  23%|██▎       | 43/183 [00:02<00:05, 27.18it/s][6/6] extract embeddings:  25%|██▌       | 46/183 [00:02<00:05, 26.53it/s][6/6] extract embeddings:  27%|██▋       | 49/183 [00:02<00:05, 26.00it/s][6/6] extract embeddings:  28%|██▊       | 52/183 [00:02<00:04, 26.48it/s][6/6] extract embeddings:  30%|███       | 55/183 [00:02<00:04, 26.04it/s][6/6] extract embeddings:  32%|███▏      | 58/183 [00:03<00:04, 25.18it/s][6/6] extract embeddings:  33%|███▎      | 61/183 [00:03<00:04, 25.94it/s][6/6] extract embeddings:  36%|███▌      | 65/183 [00:03<00:04, 27.08it/s][6/6] extract embeddings:  37%|███▋      | 68/183 [00:03<00:04, 27.02it/s][6/6] extract embeddings:  39%|███▉      | 71/183 [00:03<00:04, 26.40it/s][6/6] extract embeddings:  40%|████      | 74/183 [00:03<00:04, 26.78it/s][6/6] extract embeddings:  43%|████▎     | 78/183 [00:03<00:03, 28.46it/s][6/6] extract embeddings:  44%|████▍     | 81/183 [00:03<00:03, 27.52it/s][6/6] extract embeddings:  46%|████▌     | 84/183 [00:03<00:03, 28.11it/s][6/6] extract embeddings:  48%|████▊     | 87/183 [00:04<00:03, 28.62it/s][6/6] extract embeddings:  49%|████▉     | 90/183 [00:04<00:03, 26.27it/s][6/6] extract embeddings:  51%|█████     | 93/183 [00:04<00:03, 26.77it/s][6/6] extract embeddings:  52%|█████▏    | 96/183 [00:04<00:03, 26.38it/s][6/6] extract embeddings:  54%|█████▍    | 99/183 [00:04<00:03, 27.31it/s][6/6] extract embeddings:  56%|█████▋    | 103/183 [00:04<00:02, 29.32it/s][6/6] extract embeddings:  58%|█████▊    | 106/183 [00:04<00:02, 29.38it/s][6/6] extract embeddings:  60%|██████    | 110/183 [00:04<00:02, 28.99it/s][6/6] extract embeddings:  62%|██████▏   | 113/183 [00:05<00:02, 27.79it/s][6/6] extract embeddings:  64%|██████▍   | 117/183 [00:05<00:02, 29.46it/s][6/6] extract embeddings:  66%|██████▌   | 120/183 [00:05<00:02, 29.29it/s][6/6] extract embeddings:  67%|██████▋   | 123/183 [00:05<00:02, 26.87it/s][6/6] extract embeddings:  69%|██████▉   | 126/183 [00:05<00:02, 24.59it/s][6/6] extract embeddings:  70%|███████   | 129/183 [00:05<00:02, 24.25it/s][6/6] extract embeddings:  73%|███████▎  | 133/183 [00:05<00:01, 25.61it/s][6/6] extract embeddings:  74%|███████▍  | 136/183 [00:05<00:01, 25.31it/s][6/6] extract embeddings:  76%|███████▌  | 139/183 [00:06<00:01, 25.13it/s][6/6] extract embeddings:  78%|███████▊  | 142/183 [00:06<00:01, 24.90it/s][6/6] extract embeddings:  79%|███████▉  | 145/183 [00:06<00:01, 25.60it/s][6/6] extract embeddings:  81%|████████  | 148/183 [00:06<00:01, 24.79it/s][6/6] extract embeddings:  83%|████████▎ | 151/183 [00:06<00:01, 25.45it/s][6/6] extract embeddings:  84%|████████▍ | 154/183 [00:06<00:01, 25.09it/s][6/6] extract embeddings:  86%|████████▌ | 157/183 [00:06<00:01, 25.08it/s][6/6] extract embeddings:  87%|████████▋ | 160/183 [00:06<00:00, 25.57it/s][6/6] extract embeddings:  90%|████████▉ | 164/183 [00:07<00:00, 26.09it/s][6/6] extract embeddings:  92%|█████████▏| 168/183 [00:07<00:00, 27.65it/s][6/6] extract embeddings:  93%|█████████▎| 171/183 [00:07<00:00, 27.92it/s][6/6] extract embeddings:  95%|█████████▌| 174/183 [00:07<00:00, 27.21it/s][6/6] extract embeddings:  97%|█████████▋| 177/183 [00:07<00:00, 26.00it/s][6/6] extract embeddings:  98%|█████████▊| 180/183 [00:07<00:00, 26.22it/s][6/6] extract embeddings: 100%|██████████| 183/183 [00:07<00:00, 26.12it/s][6/6] extract embeddings: 100%|██████████| 183/183 [00:07<00:00, 23.54it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.30it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.58it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.23it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.45it/s]
[NeMo I 2025-04-17 01:09:49 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:09:50 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              45.344724   444.120  ...   16.755092  3.772650
    Harker-ES                       37.893784  2178.782  ...   50.554782  2.320323
    Harker-MN                       48.497300   366.767  ...   31.398002  8.560749
    Longfellow-Block-1              32.995613   492.417  ...    9.162016  1.860621
    TOTAL                           39.268302  3482.086  ...  107.869892  3.097853
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:09:50 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0678 | MISS: 0.2939 | CER: 0.0310 | DER: 0.3927 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:02<00:06,  2.03s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:04<00:04,  2.01s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.28s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.21s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:10:03 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:10:03 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:10:03 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:10:03 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:10:03 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:10:03 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:10:03 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:10:03 features:305] PADDING: 16
[NeMo I 2025-04-17 01:10:03 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:10:03 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:10:03 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:10:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:10:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:10:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:10:03 collections:880] Dataset successfully loaded with 2084 items and total duration provided from manifest is  1.08 hours.
[NeMo I 2025-04-17 01:10:03 collections:886] # 2084 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:04,  2.00s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.45it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.94it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.60it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.15it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  8.92it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.76it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.56it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:01, 13.94it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:03<00:00, 14.56it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 15.28it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 15.60it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 15.04it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 15.48it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 16.39it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 16.72it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.69it/s]
[NeMo I 2025-04-17 01:10:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:10:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:10:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:10:07 collections:880] Dataset successfully loaded with 2368 items and total duration provided from manifest is  1.13 hours.
[NeMo I 2025-04-17 01:10:07 collections:886] # 2368 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:52,  1.45s/it][2/6] extract embeddings:  11%|█         | 4/37 [00:01<00:10,  3.17it/s][2/6] extract embeddings:  16%|█▌        | 6/37 [00:01<00:06,  4.92it/s][2/6] extract embeddings:  22%|██▏       | 8/37 [00:01<00:04,  6.78it/s][2/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:03,  8.74it/s][2/6] extract embeddings:  32%|███▏      | 12/37 [00:02<00:02, 10.26it/s][2/6] extract embeddings:  38%|███▊      | 14/37 [00:02<00:01, 11.68it/s][2/6] extract embeddings:  43%|████▎     | 16/37 [00:02<00:01, 13.28it/s][2/6] extract embeddings:  49%|████▊     | 18/37 [00:02<00:01, 14.18it/s][2/6] extract embeddings:  54%|█████▍    | 20/37 [00:02<00:01, 14.29it/s][2/6] extract embeddings:  59%|█████▉    | 22/37 [00:02<00:01, 14.83it/s][2/6] extract embeddings:  65%|██████▍   | 24/37 [00:02<00:00, 15.65it/s][2/6] extract embeddings:  70%|███████   | 26/37 [00:02<00:00, 15.96it/s][2/6] extract embeddings:  76%|███████▌  | 28/37 [00:03<00:00, 15.83it/s][2/6] extract embeddings:  81%|████████  | 30/37 [00:03<00:00, 16.14it/s][2/6] extract embeddings:  86%|████████▋ | 32/37 [00:03<00:00, 15.79it/s][2/6] extract embeddings:  92%|█████████▏| 34/37 [00:03<00:00, 16.17it/s][2/6] extract embeddings:  97%|█████████▋| 36/37 [00:03<00:00, 15.53it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 10.19it/s]
[NeMo I 2025-04-17 01:10:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:10:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:10:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:10:11 collections:880] Dataset successfully loaded with 2802 items and total duration provided from manifest is  1.18 hours.
[NeMo I 2025-04-17 01:10:11 collections:886] # 2802 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:51,  1.20s/it][3/6] extract embeddings:   7%|▋         | 3/44 [00:01<00:14,  2.86it/s][3/6] extract embeddings:  11%|█▏        | 5/44 [00:01<00:07,  4.91it/s][3/6] extract embeddings:  16%|█▌        | 7/44 [00:01<00:05,  7.00it/s][3/6] extract embeddings:  20%|██        | 9/44 [00:01<00:03,  9.08it/s][3/6] extract embeddings:  25%|██▌       | 11/44 [00:01<00:03, 10.78it/s][3/6] extract embeddings:  30%|██▉       | 13/44 [00:01<00:02, 12.24it/s][3/6] extract embeddings:  34%|███▍      | 15/44 [00:02<00:02, 13.32it/s][3/6] extract embeddings:  39%|███▊      | 17/44 [00:02<00:01, 14.56it/s][3/6] extract embeddings:  43%|████▎     | 19/44 [00:02<00:01, 15.19it/s][3/6] extract embeddings:  48%|████▊     | 21/44 [00:02<00:01, 15.73it/s][3/6] extract embeddings:  52%|█████▏    | 23/44 [00:02<00:01, 16.32it/s][3/6] extract embeddings:  57%|█████▋    | 25/44 [00:02<00:01, 16.17it/s][3/6] extract embeddings:  61%|██████▏   | 27/44 [00:02<00:01, 16.23it/s][3/6] extract embeddings:  66%|██████▌   | 29/44 [00:02<00:00, 16.58it/s][3/6] extract embeddings:  70%|███████   | 31/44 [00:02<00:00, 16.09it/s][3/6] extract embeddings:  75%|███████▌  | 33/44 [00:03<00:00, 15.92it/s][3/6] extract embeddings:  80%|███████▉  | 35/44 [00:03<00:00, 16.41it/s][3/6] extract embeddings:  84%|████████▍ | 37/44 [00:03<00:00, 16.88it/s][3/6] extract embeddings:  89%|████████▊ | 39/44 [00:03<00:00, 16.66it/s][3/6] extract embeddings:  93%|█████████▎| 41/44 [00:03<00:00, 16.60it/s][3/6] extract embeddings:  98%|█████████▊| 43/44 [00:03<00:00, 16.39it/s][3/6] extract embeddings: 100%|██████████| 44/44 [00:03<00:00, 11.63it/s]
[NeMo I 2025-04-17 01:10:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:10:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:10:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:10:15 collections:880] Dataset successfully loaded with 3638 items and total duration provided from manifest is  1.26 hours.
[NeMo I 2025-04-17 01:10:15 collections:886] # 3638 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/57 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/57 [00:01<01:22,  1.47s/it][4/6] extract embeddings:   7%|▋         | 4/57 [00:01<00:16,  3.16it/s][4/6] extract embeddings:  12%|█▏        | 7/57 [00:01<00:08,  5.81it/s][4/6] extract embeddings:  16%|█▌        | 9/57 [00:01<00:06,  7.51it/s][4/6] extract embeddings:  21%|██        | 12/57 [00:01<00:04, 10.54it/s][4/6] extract embeddings:  26%|██▋       | 15/57 [00:02<00:03, 12.62it/s][4/6] extract embeddings:  30%|██▉       | 17/57 [00:02<00:02, 13.74it/s][4/6] extract embeddings:  35%|███▌      | 20/57 [00:02<00:02, 15.30it/s][4/6] extract embeddings:  40%|████      | 23/57 [00:02<00:02, 16.50it/s][4/6] extract embeddings:  46%|████▌     | 26/57 [00:02<00:01, 17.67it/s][4/6] extract embeddings:  49%|████▉     | 28/57 [00:02<00:01, 18.06it/s][4/6] extract embeddings:  53%|█████▎    | 30/57 [00:02<00:01, 18.34it/s][4/6] extract embeddings:  56%|█████▌    | 32/57 [00:03<00:01, 18.51it/s][4/6] extract embeddings:  61%|██████▏   | 35/57 [00:03<00:01, 19.07it/s][4/6] extract embeddings:  65%|██████▍   | 37/57 [00:03<00:01, 18.64it/s][4/6] extract embeddings:  70%|███████   | 40/57 [00:03<00:00, 19.39it/s][4/6] extract embeddings:  74%|███████▎  | 42/57 [00:03<00:00, 19.39it/s][4/6] extract embeddings:  77%|███████▋  | 44/57 [00:03<00:00, 18.92it/s][4/6] extract embeddings:  82%|████████▏ | 47/57 [00:03<00:00, 18.86it/s][4/6] extract embeddings:  86%|████████▌ | 49/57 [00:03<00:00, 18.32it/s][4/6] extract embeddings:  91%|█████████ | 52/57 [00:04<00:00, 18.86it/s][4/6] extract embeddings:  95%|█████████▍| 54/57 [00:04<00:00, 18.47it/s][4/6] extract embeddings: 100%|██████████| 57/57 [00:04<00:00, 18.97it/s][4/6] extract embeddings: 100%|██████████| 57/57 [00:04<00:00, 13.04it/s]
[NeMo I 2025-04-17 01:10:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:10:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:10:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:10:20 collections:880] Dataset successfully loaded with 5394 items and total duration provided from manifest is  1.35 hours.
[NeMo I 2025-04-17 01:10:20 collections:886] # 5394 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/85 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/85 [00:01<01:53,  1.35s/it][5/6] extract embeddings:   5%|▍         | 4/85 [00:01<00:23,  3.44it/s][5/6] extract embeddings:   8%|▊         | 7/85 [00:01<00:12,  6.31it/s][5/6] extract embeddings:  12%|█▏        | 10/85 [00:01<00:08,  9.10it/s][5/6] extract embeddings:  15%|█▌        | 13/85 [00:01<00:06, 11.64it/s][5/6] extract embeddings:  19%|█▉        | 16/85 [00:02<00:04, 13.86it/s][5/6] extract embeddings:  22%|██▏       | 19/85 [00:02<00:04, 16.30it/s][5/6] extract embeddings:  26%|██▌       | 22/85 [00:02<00:03, 17.85it/s][5/6] extract embeddings:  29%|██▉       | 25/85 [00:02<00:03, 19.10it/s][5/6] extract embeddings:  33%|███▎      | 28/85 [00:02<00:02, 19.55it/s][5/6] extract embeddings:  36%|███▋      | 31/85 [00:02<00:02, 21.02it/s][5/6] extract embeddings:  40%|████      | 34/85 [00:02<00:02, 21.54it/s][5/6] extract embeddings:  44%|████▎     | 37/85 [00:02<00:02, 21.48it/s][5/6] extract embeddings:  47%|████▋     | 40/85 [00:03<00:02, 21.41it/s][5/6] extract embeddings:  51%|█████     | 43/85 [00:03<00:01, 21.85it/s][5/6] extract embeddings:  54%|█████▍    | 46/85 [00:03<00:01, 23.35it/s][5/6] extract embeddings:  58%|█████▊    | 49/85 [00:03<00:01, 23.16it/s][5/6] extract embeddings:  61%|██████    | 52/85 [00:03<00:01, 24.14it/s][5/6] extract embeddings:  65%|██████▍   | 55/85 [00:03<00:01, 23.30it/s][5/6] extract embeddings:  68%|██████▊   | 58/85 [00:03<00:01, 23.74it/s][5/6] extract embeddings:  72%|███████▏  | 61/85 [00:03<00:01, 22.69it/s][5/6] extract embeddings:  75%|███████▌  | 64/85 [00:04<00:00, 23.22it/s][5/6] extract embeddings:  79%|███████▉  | 67/85 [00:04<00:00, 22.83it/s][5/6] extract embeddings:  82%|████████▏ | 70/85 [00:04<00:00, 22.02it/s][5/6] extract embeddings:  86%|████████▌ | 73/85 [00:04<00:00, 21.27it/s][5/6] extract embeddings:  89%|████████▉ | 76/85 [00:04<00:00, 22.00it/s][5/6] extract embeddings:  93%|█████████▎| 79/85 [00:04<00:00, 22.53it/s][5/6] extract embeddings:  96%|█████████▋| 82/85 [00:04<00:00, 22.33it/s][5/6] extract embeddings: 100%|██████████| 85/85 [00:05<00:00, 22.29it/s][5/6] extract embeddings: 100%|██████████| 85/85 [00:05<00:00, 16.67it/s]
[NeMo I 2025-04-17 01:10:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:10:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:10:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:10:25 collections:880] Dataset successfully loaded with 10957 items and total duration provided from manifest is  1.46 hours.
[NeMo I 2025-04-17 01:10:25 collections:886] # 10957 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/172 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/172 [00:01<03:12,  1.13s/it][6/6] extract embeddings:   3%|▎         | 6/172 [00:01<00:26,  6.19it/s][6/6] extract embeddings:   6%|▌         | 10/172 [00:01<00:15, 10.38it/s][6/6] extract embeddings:   8%|▊         | 14/172 [00:01<00:11, 14.19it/s][6/6] extract embeddings:  10%|▉         | 17/172 [00:01<00:09, 16.73it/s][6/6] extract embeddings:  12%|█▏        | 21/172 [00:01<00:07, 19.89it/s][6/6] extract embeddings:  15%|█▍        | 25/172 [00:01<00:06, 22.04it/s][6/6] extract embeddings:  16%|█▋        | 28/172 [00:02<00:06, 21.56it/s][6/6] extract embeddings:  18%|█▊        | 31/172 [00:02<00:06, 21.26it/s][6/6] extract embeddings:  20%|█▉        | 34/172 [00:02<00:06, 20.26it/s][6/6] extract embeddings:  22%|██▏       | 37/172 [00:02<00:06, 20.70it/s][6/6] extract embeddings:  23%|██▎       | 40/172 [00:02<00:06, 21.57it/s][6/6] extract embeddings:  25%|██▌       | 43/172 [00:02<00:05, 21.66it/s][6/6] extract embeddings:  27%|██▋       | 46/172 [00:02<00:05, 21.33it/s][6/6] extract embeddings:  28%|██▊       | 49/172 [00:03<00:05, 20.56it/s][6/6] extract embeddings:  30%|███       | 52/172 [00:03<00:05, 21.46it/s][6/6] extract embeddings:  32%|███▏      | 55/172 [00:03<00:05, 21.23it/s][6/6] extract embeddings:  34%|███▎      | 58/172 [00:03<00:05, 20.86it/s][6/6] extract embeddings:  35%|███▌      | 61/172 [00:03<00:05, 20.20it/s][6/6] extract embeddings:  37%|███▋      | 64/172 [00:03<00:05, 19.60it/s][6/6] extract embeddings:  39%|███▉      | 67/172 [00:03<00:05, 20.37it/s][6/6] extract embeddings:  41%|████      | 70/172 [00:04<00:04, 20.91it/s][6/6] extract embeddings:  42%|████▏     | 73/172 [00:04<00:04, 21.41it/s][6/6] extract embeddings:  44%|████▍     | 76/172 [00:04<00:04, 21.88it/s][6/6] extract embeddings:  46%|████▌     | 79/172 [00:04<00:04, 22.03it/s][6/6] extract embeddings:  48%|████▊     | 82/172 [00:04<00:04, 21.88it/s][6/6] extract embeddings:  49%|████▉     | 85/172 [00:04<00:04, 20.81it/s][6/6] extract embeddings:  51%|█████     | 88/172 [00:04<00:03, 21.04it/s][6/6] extract embeddings:  53%|█████▎    | 91/172 [00:05<00:03, 21.84it/s][6/6] extract embeddings:  55%|█████▍    | 94/172 [00:05<00:03, 21.53it/s][6/6] extract embeddings:  56%|█████▋    | 97/172 [00:05<00:03, 20.63it/s][6/6] extract embeddings:  58%|█████▊    | 100/172 [00:05<00:03, 20.34it/s][6/6] extract embeddings:  60%|█████▉    | 103/172 [00:05<00:03, 21.00it/s][6/6] extract embeddings:  62%|██████▏   | 106/172 [00:05<00:03, 21.86it/s][6/6] extract embeddings:  63%|██████▎   | 109/172 [00:05<00:02, 21.16it/s][6/6] extract embeddings:  65%|██████▌   | 112/172 [00:06<00:02, 20.79it/s][6/6] extract embeddings:  67%|██████▋   | 115/172 [00:06<00:02, 21.09it/s][6/6] extract embeddings:  69%|██████▊   | 118/172 [00:06<00:02, 21.01it/s][6/6] extract embeddings:  70%|███████   | 121/172 [00:06<00:02, 21.62it/s][6/6] extract embeddings:  72%|███████▏  | 124/172 [00:06<00:02, 22.01it/s][6/6] extract embeddings:  74%|███████▍  | 127/172 [00:06<00:02, 21.46it/s][6/6] extract embeddings:  76%|███████▌  | 130/172 [00:06<00:01, 21.36it/s][6/6] extract embeddings:  77%|███████▋  | 133/172 [00:07<00:01, 21.47it/s][6/6] extract embeddings:  79%|███████▉  | 136/172 [00:07<00:01, 22.06it/s][6/6] extract embeddings:  81%|████████  | 139/172 [00:07<00:01, 22.22it/s][6/6] extract embeddings:  83%|████████▎ | 142/172 [00:07<00:01, 22.48it/s][6/6] extract embeddings:  84%|████████▍ | 145/172 [00:07<00:01, 22.71it/s][6/6] extract embeddings:  86%|████████▌ | 148/172 [00:07<00:01, 21.86it/s][6/6] extract embeddings:  88%|████████▊ | 151/172 [00:07<00:00, 22.51it/s][6/6] extract embeddings:  90%|████████▉ | 154/172 [00:07<00:00, 23.09it/s][6/6] extract embeddings:  91%|█████████▏| 157/172 [00:08<00:00, 24.45it/s][6/6] extract embeddings:  94%|█████████▎| 161/172 [00:08<00:00, 27.31it/s][6/6] extract embeddings:  95%|█████████▌| 164/172 [00:08<00:00, 26.78it/s][6/6] extract embeddings:  98%|█████████▊| 168/172 [00:08<00:00, 28.68it/s][6/6] extract embeddings: 100%|██████████| 172/172 [00:08<00:00, 30.42it/s][6/6] extract embeddings: 100%|██████████| 172/172 [00:08<00:00, 20.13it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.99it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.58it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.25it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.37it/s]
[NeMo I 2025-04-17 01:10:36 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:10:37 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              48.713144   444.120  ...   19.855076  4.470656
    Harker-ES                       41.081324  2178.782  ...   54.762149  2.513429
    Harker-MN                       49.808497   366.767  ...   32.845993  8.955548
    Longfellow-Block-1              36.195943   492.417  ...    8.692011  1.765173
    TOTAL                           42.283086  3482.086  ...  116.155228  3.335794
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:10:37 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0605 | MISS: 0.3289 | CER: 0.0334 | DER: 0.4228 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.15
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.15 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.97s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.99s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.27s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.20s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:10:50 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:10:50 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:10:50 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:10:50 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:10:50 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:10:50 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:10:50 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:10:50 features:305] PADDING: 16
[NeMo I 2025-04-17 01:10:50 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:10:50 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:10:50 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:10:50 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:10:50 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:10:50 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:10:50 collections:880] Dataset successfully loaded with 2052 items and total duration provided from manifest is  0.96 hours.
[NeMo I 2025-04-17 01:10:50 collections:886] # 2052 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:04,  2.02s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.44it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.60it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.10it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  7.72it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.42it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 11.89it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:01, 13.44it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 14.48it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 15.33it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 15.58it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 16.70it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 17.03it/s][1/6] extract embeddings:  94%|█████████▍| 31/33 [00:03<00:00, 17.57it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.93it/s]
[NeMo I 2025-04-17 01:10:54 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:10:54 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:10:54 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:10:54 collections:880] Dataset successfully loaded with 2292 items and total duration provided from manifest is  1.01 hours.
[NeMo I 2025-04-17 01:10:54 collections:886] # 2292 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:50,  1.45s/it][2/6] extract embeddings:  11%|█         | 4/36 [00:01<00:10,  3.17it/s][2/6] extract embeddings:  17%|█▋        | 6/36 [00:01<00:06,  4.96it/s][2/6] extract embeddings:  25%|██▌       | 9/36 [00:01<00:03,  7.79it/s][2/6] extract embeddings:  31%|███       | 11/36 [00:01<00:02,  9.21it/s][2/6] extract embeddings:  36%|███▌      | 13/36 [00:02<00:02, 11.01it/s][2/6] extract embeddings:  42%|████▏     | 15/36 [00:02<00:01, 12.64it/s][2/6] extract embeddings:  50%|█████     | 18/36 [00:02<00:01, 14.88it/s][2/6] extract embeddings:  56%|█████▌    | 20/36 [00:02<00:01, 15.94it/s][2/6] extract embeddings:  64%|██████▍   | 23/36 [00:02<00:00, 17.03it/s][2/6] extract embeddings:  72%|███████▏  | 26/36 [00:02<00:00, 17.61it/s][2/6] extract embeddings:  81%|████████  | 29/36 [00:02<00:00, 18.03it/s][2/6] extract embeddings:  86%|████████▌ | 31/36 [00:03<00:00, 17.26it/s][2/6] extract embeddings:  94%|█████████▍| 34/36 [00:03<00:00, 18.19it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 10.83it/s]
[NeMo I 2025-04-17 01:10:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:10:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:10:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:10:58 collections:880] Dataset successfully loaded with 2668 items and total duration provided from manifest is  1.06 hours.
[NeMo I 2025-04-17 01:10:58 collections:886] # 2668 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:47,  1.17s/it][3/6] extract embeddings:  10%|▉         | 4/42 [00:01<00:09,  3.87it/s][3/6] extract embeddings:  14%|█▍        | 6/42 [00:01<00:06,  5.94it/s][3/6] extract embeddings:  21%|██▏       | 9/42 [00:01<00:03,  9.22it/s][3/6] extract embeddings:  29%|██▊       | 12/42 [00:01<00:02, 11.97it/s][3/6] extract embeddings:  36%|███▌      | 15/42 [00:01<00:01, 14.20it/s][3/6] extract embeddings:  43%|████▎     | 18/42 [00:01<00:01, 16.42it/s][3/6] extract embeddings:  50%|█████     | 21/42 [00:02<00:01, 17.67it/s][3/6] extract embeddings:  57%|█████▋    | 24/42 [00:02<00:00, 18.86it/s][3/6] extract embeddings:  64%|██████▍   | 27/42 [00:02<00:00, 19.66it/s][3/6] extract embeddings:  71%|███████▏  | 30/42 [00:02<00:00, 20.07it/s][3/6] extract embeddings:  79%|███████▊  | 33/42 [00:02<00:00, 19.64it/s][3/6] extract embeddings:  86%|████████▌ | 36/42 [00:02<00:00, 19.25it/s][3/6] extract embeddings:  93%|█████████▎| 39/42 [00:02<00:00, 19.67it/s][3/6] extract embeddings: 100%|██████████| 42/42 [00:03<00:00, 20.17it/s][3/6] extract embeddings: 100%|██████████| 42/42 [00:03<00:00, 13.29it/s]
[NeMo I 2025-04-17 01:11:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:11:01 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:11:01 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:11:01 collections:880] Dataset successfully loaded with 3408 items and total duration provided from manifest is  1.14 hours.
[NeMo I 2025-04-17 01:11:01 collections:886] # 3408 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/54 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/54 [00:01<01:02,  1.19s/it][4/6] extract embeddings:   7%|▋         | 4/54 [00:01<00:13,  3.82it/s][4/6] extract embeddings:  13%|█▎        | 7/54 [00:01<00:06,  6.80it/s][4/6] extract embeddings:  19%|█▊        | 10/54 [00:01<00:04,  9.93it/s][4/6] extract embeddings:  24%|██▍       | 13/54 [00:01<00:03, 12.84it/s][4/6] extract embeddings:  30%|██▉       | 16/54 [00:01<00:02, 14.91it/s][4/6] extract embeddings:  35%|███▌      | 19/54 [00:01<00:02, 17.16it/s][4/6] extract embeddings:  41%|████      | 22/54 [00:02<00:01, 18.05it/s][4/6] extract embeddings:  46%|████▋     | 25/54 [00:02<00:01, 19.45it/s][4/6] extract embeddings:  52%|█████▏    | 28/54 [00:02<00:01, 20.40it/s][4/6] extract embeddings:  57%|█████▋    | 31/54 [00:02<00:01, 21.42it/s][4/6] extract embeddings:  63%|██████▎   | 34/54 [00:02<00:00, 21.88it/s][4/6] extract embeddings:  69%|██████▊   | 37/54 [00:02<00:00, 22.43it/s][4/6] extract embeddings:  74%|███████▍  | 40/54 [00:02<00:00, 22.52it/s][4/6] extract embeddings:  80%|███████▉  | 43/54 [00:03<00:00, 21.97it/s][4/6] extract embeddings:  85%|████████▌ | 46/54 [00:03<00:00, 20.74it/s][4/6] extract embeddings:  91%|█████████ | 49/54 [00:03<00:00, 20.33it/s][4/6] extract embeddings:  96%|█████████▋| 52/54 [00:03<00:00, 20.16it/s][4/6] extract embeddings: 100%|██████████| 54/54 [00:03<00:00, 14.96it/s]
[NeMo I 2025-04-17 01:11:05 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:11:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:11:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:11:05 collections:880] Dataset successfully loaded with 4988 items and total duration provided from manifest is  1.23 hours.
[NeMo I 2025-04-17 01:11:05 collections:886] # 4988 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/78 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/78 [00:01<01:29,  1.16s/it][5/6] extract embeddings:   5%|▌         | 4/78 [00:01<00:19,  3.89it/s][5/6] extract embeddings:   9%|▉         | 7/78 [00:01<00:10,  6.98it/s][5/6] extract embeddings:  13%|█▎        | 10/78 [00:01<00:06,  9.83it/s][5/6] extract embeddings:  17%|█▋        | 13/78 [00:01<00:05, 12.56it/s][5/6] extract embeddings:  21%|██        | 16/78 [00:01<00:04, 14.03it/s][5/6] extract embeddings:  23%|██▎       | 18/78 [00:01<00:03, 15.01it/s][5/6] extract embeddings:  26%|██▌       | 20/78 [00:02<00:03, 15.93it/s][5/6] extract embeddings:  29%|██▉       | 23/78 [00:02<00:03, 17.93it/s][5/6] extract embeddings:  33%|███▎      | 26/78 [00:02<00:02, 18.99it/s][5/6] extract embeddings:  37%|███▋      | 29/78 [00:02<00:02, 20.03it/s][5/6] extract embeddings:  41%|████      | 32/78 [00:02<00:02, 20.68it/s][5/6] extract embeddings:  45%|████▍     | 35/78 [00:02<00:02, 21.26it/s][5/6] extract embeddings:  49%|████▊     | 38/78 [00:02<00:01, 21.52it/s][5/6] extract embeddings:  53%|█████▎    | 41/78 [00:03<00:01, 21.22it/s][5/6] extract embeddings:  56%|█████▋    | 44/78 [00:03<00:01, 22.07it/s][5/6] extract embeddings:  60%|██████    | 47/78 [00:03<00:01, 21.74it/s][5/6] extract embeddings:  64%|██████▍   | 50/78 [00:03<00:01, 21.76it/s][5/6] extract embeddings:  68%|██████▊   | 53/78 [00:03<00:01, 21.92it/s][5/6] extract embeddings:  72%|███████▏  | 56/78 [00:03<00:01, 21.60it/s][5/6] extract embeddings:  76%|███████▌  | 59/78 [00:03<00:00, 21.35it/s][5/6] extract embeddings:  79%|███████▉  | 62/78 [00:04<00:00, 21.13it/s][5/6] extract embeddings:  83%|████████▎ | 65/78 [00:04<00:00, 21.99it/s][5/6] extract embeddings:  87%|████████▋ | 68/78 [00:04<00:00, 21.86it/s][5/6] extract embeddings:  91%|█████████ | 71/78 [00:04<00:00, 21.59it/s][5/6] extract embeddings:  95%|█████████▍| 74/78 [00:04<00:00, 22.26it/s][5/6] extract embeddings:  99%|█████████▊| 77/78 [00:04<00:00, 22.83it/s][5/6] extract embeddings: 100%|██████████| 78/78 [00:04<00:00, 16.48it/s]
[NeMo I 2025-04-17 01:11:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:11:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:11:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:11:10 collections:880] Dataset successfully loaded with 10091 items and total duration provided from manifest is  1.34 hours.
[NeMo I 2025-04-17 01:11:10 collections:886] # 10091 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/158 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/158 [00:01<03:11,  1.22s/it][6/6] extract embeddings:   3%|▎         | 4/158 [00:01<00:39,  3.87it/s][6/6] extract embeddings:   4%|▍         | 7/158 [00:01<00:21,  7.11it/s][6/6] extract embeddings:   6%|▋         | 10/158 [00:01<00:14, 10.47it/s][6/6] extract embeddings:   8%|▊         | 13/158 [00:01<00:10, 13.72it/s][6/6] extract embeddings:  10%|█         | 16/158 [00:01<00:08, 16.75it/s][6/6] extract embeddings:  12%|█▏        | 19/158 [00:01<00:07, 19.50it/s][6/6] extract embeddings:  14%|█▍        | 22/158 [00:01<00:06, 21.58it/s][6/6] extract embeddings:  16%|█▌        | 25/158 [00:02<00:05, 23.00it/s][6/6] extract embeddings:  18%|█▊        | 28/158 [00:02<00:05, 24.55it/s][6/6] extract embeddings:  20%|█▉        | 31/158 [00:02<00:05, 24.93it/s][6/6] extract embeddings:  22%|██▏       | 34/158 [00:02<00:05, 24.79it/s][6/6] extract embeddings:  23%|██▎       | 37/158 [00:02<00:04, 24.52it/s][6/6] extract embeddings:  25%|██▌       | 40/158 [00:02<00:04, 24.30it/s][6/6] extract embeddings:  27%|██▋       | 43/158 [00:02<00:04, 24.15it/s][6/6] extract embeddings:  29%|██▉       | 46/158 [00:02<00:04, 23.62it/s][6/6] extract embeddings:  31%|███       | 49/158 [00:03<00:04, 23.02it/s][6/6] extract embeddings:  33%|███▎      | 52/158 [00:03<00:04, 24.01it/s][6/6] extract embeddings:  35%|███▍      | 55/158 [00:03<00:04, 23.89it/s][6/6] extract embeddings:  37%|███▋      | 58/158 [00:03<00:04, 24.20it/s][6/6] extract embeddings:  39%|███▊      | 61/158 [00:03<00:03, 24.33it/s][6/6] extract embeddings:  41%|████      | 64/158 [00:03<00:03, 24.52it/s][6/6] extract embeddings:  42%|████▏     | 67/158 [00:03<00:03, 24.73it/s][6/6] extract embeddings:  44%|████▍     | 70/158 [00:03<00:03, 24.33it/s][6/6] extract embeddings:  46%|████▌     | 73/158 [00:04<00:03, 25.01it/s][6/6] extract embeddings:  48%|████▊     | 76/158 [00:04<00:03, 25.01it/s][6/6] extract embeddings:  50%|█████     | 79/158 [00:04<00:03, 25.78it/s][6/6] extract embeddings:  52%|█████▏    | 82/158 [00:04<00:03, 24.78it/s][6/6] extract embeddings:  54%|█████▍    | 85/158 [00:04<00:02, 24.76it/s][6/6] extract embeddings:  56%|█████▌    | 88/158 [00:04<00:02, 25.17it/s][6/6] extract embeddings:  58%|█████▊    | 91/158 [00:04<00:02, 26.45it/s][6/6] extract embeddings:  59%|█████▉    | 94/158 [00:04<00:02, 26.86it/s][6/6] extract embeddings:  61%|██████▏   | 97/158 [00:04<00:02, 26.25it/s][6/6] extract embeddings:  63%|██████▎   | 100/158 [00:05<00:02, 25.60it/s][6/6] extract embeddings:  65%|██████▌   | 103/158 [00:05<00:02, 24.46it/s][6/6] extract embeddings:  67%|██████▋   | 106/158 [00:05<00:02, 24.34it/s][6/6] extract embeddings:  69%|██████▉   | 109/158 [00:05<00:02, 23.72it/s][6/6] extract embeddings:  71%|███████   | 112/158 [00:05<00:01, 24.60it/s][6/6] extract embeddings:  73%|███████▎  | 115/158 [00:05<00:01, 24.09it/s][6/6] extract embeddings:  75%|███████▍  | 118/158 [00:05<00:01, 24.58it/s][6/6] extract embeddings:  77%|███████▋  | 121/158 [00:05<00:01, 23.86it/s][6/6] extract embeddings:  78%|███████▊  | 124/158 [00:06<00:01, 24.61it/s][6/6] extract embeddings:  80%|████████  | 127/158 [00:06<00:01, 24.97it/s][6/6] extract embeddings:  82%|████████▏ | 130/158 [00:06<00:01, 24.95it/s][6/6] extract embeddings:  84%|████████▍ | 133/158 [00:06<00:01, 24.97it/s][6/6] extract embeddings:  86%|████████▌ | 136/158 [00:06<00:00, 25.31it/s][6/6] extract embeddings:  88%|████████▊ | 139/158 [00:06<00:00, 26.47it/s][6/6] extract embeddings:  90%|████████▉ | 142/158 [00:06<00:00, 25.86it/s][6/6] extract embeddings:  92%|█████████▏| 145/158 [00:06<00:00, 26.30it/s][6/6] extract embeddings:  94%|█████████▎| 148/158 [00:07<00:00, 26.71it/s][6/6] extract embeddings:  96%|█████████▌| 151/158 [00:07<00:00, 26.62it/s][6/6] extract embeddings:  97%|█████████▋| 154/158 [00:07<00:00, 26.78it/s][6/6] extract embeddings:  99%|█████████▉| 157/158 [00:07<00:00, 26.77it/s][6/6] extract embeddings: 100%|██████████| 158/158 [00:07<00:00, 21.35it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.01it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.81it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.57it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.66it/s]
[NeMo I 2025-04-17 01:11:19 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:11:20 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              50.523411   444.120  ...  17.105024  3.851442
    Harker-ES                       44.559404  2178.782  ...  38.294058  1.757590
    Harker-MN                       52.282309   366.767  ...  32.369049  8.825507
    Longfellow-Block-1              39.923091   492.417  ...   9.238015  1.876055
    TOTAL                           45.477888  3482.086  ...  97.006145  2.785863
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:11:20 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0532 | MISS: 0.3737 | CER: 0.0279 | DER: 0.4548 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.30, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.3, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.94s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.99s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.26s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.19s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:11:33 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:11:33 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:11:33 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:11:33 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:11:33 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:11:34 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:11:34 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:11:34 features:305] PADDING: 16
[NeMo I 2025-04-17 01:11:34 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:11:34 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:11:34 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:11:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:11:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:11:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:11:34 collections:880] Dataset successfully loaded with 2301 items and total duration provided from manifest is  1.50 hours.
[NeMo I 2025-04-17 01:11:34 collections:886] # 2301 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/36 [00:02<01:13,  2.10s/it][1/6] extract embeddings:  11%|█         | 4/36 [00:02<00:13,  2.31it/s][1/6] extract embeddings:  17%|█▋        | 6/36 [00:02<00:08,  3.58it/s][1/6] extract embeddings:  22%|██▏       | 8/36 [00:02<00:05,  5.07it/s][1/6] extract embeddings:  28%|██▊       | 10/36 [00:02<00:03,  6.57it/s][1/6] extract embeddings:  33%|███▎      | 12/36 [00:02<00:03,  7.94it/s][1/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:02,  9.26it/s][1/6] extract embeddings:  44%|████▍     | 16/36 [00:03<00:01, 10.24it/s][1/6] extract embeddings:  50%|█████     | 18/36 [00:03<00:01, 11.31it/s][1/6] extract embeddings:  56%|█████▌    | 20/36 [00:03<00:01, 12.55it/s][1/6] extract embeddings:  61%|██████    | 22/36 [00:03<00:01, 12.55it/s][1/6] extract embeddings:  67%|██████▋   | 24/36 [00:03<00:00, 13.23it/s][1/6] extract embeddings:  72%|███████▏  | 26/36 [00:03<00:00, 13.64it/s][1/6] extract embeddings:  78%|███████▊  | 28/36 [00:03<00:00, 13.49it/s][1/6] extract embeddings:  83%|████████▎ | 30/36 [00:04<00:00, 13.60it/s][1/6] extract embeddings:  89%|████████▉ | 32/36 [00:04<00:00, 13.38it/s][1/6] extract embeddings:  94%|█████████▍| 34/36 [00:04<00:00, 13.86it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00, 13.82it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00,  7.92it/s]
[NeMo I 2025-04-17 01:11:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:11:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:11:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:11:39 collections:880] Dataset successfully loaded with 2706 items and total duration provided from manifest is  1.55 hours.
[NeMo I 2025-04-17 01:11:39 collections:886] # 2706 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/43 [00:01<01:04,  1.53s/it][2/6] extract embeddings:   7%|▋         | 3/43 [00:01<00:17,  2.25it/s][2/6] extract embeddings:  12%|█▏        | 5/43 [00:01<00:09,  3.98it/s][2/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:06,  5.71it/s][2/6] extract embeddings:  21%|██        | 9/43 [00:02<00:04,  7.53it/s][2/6] extract embeddings:  26%|██▌       | 11/43 [00:02<00:03,  9.02it/s][2/6] extract embeddings:  30%|███       | 13/43 [00:02<00:02, 10.33it/s][2/6] extract embeddings:  35%|███▍      | 15/43 [00:02<00:02, 11.27it/s][2/6] extract embeddings:  40%|███▉      | 17/43 [00:02<00:02, 12.16it/s][2/6] extract embeddings:  44%|████▍     | 19/43 [00:02<00:01, 13.31it/s][2/6] extract embeddings:  49%|████▉     | 21/43 [00:02<00:01, 14.07it/s][2/6] extract embeddings:  53%|█████▎    | 23/43 [00:02<00:01, 14.58it/s][2/6] extract embeddings:  58%|█████▊    | 25/43 [00:03<00:01, 14.42it/s][2/6] extract embeddings:  63%|██████▎   | 27/43 [00:03<00:01, 15.03it/s][2/6] extract embeddings:  67%|██████▋   | 29/43 [00:03<00:00, 15.26it/s][2/6] extract embeddings:  72%|███████▏  | 31/43 [00:03<00:00, 15.37it/s][2/6] extract embeddings:  77%|███████▋  | 33/43 [00:03<00:00, 15.53it/s][2/6] extract embeddings:  81%|████████▏ | 35/43 [00:03<00:00, 15.09it/s][2/6] extract embeddings:  86%|████████▌ | 37/43 [00:03<00:00, 14.96it/s][2/6] extract embeddings:  91%|█████████ | 39/43 [00:04<00:00, 14.94it/s][2/6] extract embeddings:  95%|█████████▌| 41/43 [00:04<00:00, 14.86it/s][2/6] extract embeddings: 100%|██████████| 43/43 [00:04<00:00, 10.01it/s]
[NeMo I 2025-04-17 01:11:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:11:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:11:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:11:43 collections:880] Dataset successfully loaded with 3333 items and total duration provided from manifest is  1.61 hours.
[NeMo I 2025-04-17 01:11:43 collections:886] # 3333 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/53 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/53 [00:01<01:01,  1.19s/it][3/6] extract embeddings:   8%|▊         | 4/53 [00:01<00:12,  3.78it/s][3/6] extract embeddings:  11%|█▏        | 6/53 [00:01<00:08,  5.69it/s][3/6] extract embeddings:  15%|█▌        | 8/53 [00:01<00:05,  7.60it/s][3/6] extract embeddings:  19%|█▉        | 10/53 [00:01<00:04,  9.41it/s][3/6] extract embeddings:  23%|██▎       | 12/53 [00:01<00:03, 10.95it/s][3/6] extract embeddings:  26%|██▋       | 14/53 [00:01<00:03, 12.12it/s][3/6] extract embeddings:  30%|███       | 16/53 [00:02<00:02, 13.09it/s][3/6] extract embeddings:  34%|███▍      | 18/53 [00:02<00:02, 14.36it/s][3/6] extract embeddings:  38%|███▊      | 20/53 [00:02<00:02, 15.22it/s][3/6] extract embeddings:  42%|████▏     | 22/53 [00:02<00:01, 15.82it/s][3/6] extract embeddings:  45%|████▌     | 24/53 [00:02<00:01, 16.55it/s][3/6] extract embeddings:  51%|█████     | 27/53 [00:02<00:01, 17.99it/s][3/6] extract embeddings:  55%|█████▍    | 29/53 [00:02<00:01, 18.37it/s][3/6] extract embeddings:  58%|█████▊    | 31/53 [00:02<00:01, 18.62it/s][3/6] extract embeddings:  62%|██████▏   | 33/53 [00:02<00:01, 18.74it/s][3/6] extract embeddings:  66%|██████▌   | 35/53 [00:03<00:00, 18.84it/s][3/6] extract embeddings:  70%|██████▉   | 37/53 [00:03<00:00, 19.16it/s][3/6] extract embeddings:  74%|███████▎  | 39/53 [00:03<00:00, 18.95it/s][3/6] extract embeddings:  77%|███████▋  | 41/53 [00:03<00:00, 17.15it/s][3/6] extract embeddings:  81%|████████  | 43/53 [00:03<00:00, 16.77it/s][3/6] extract embeddings:  85%|████████▍ | 45/53 [00:03<00:00, 15.95it/s][3/6] extract embeddings:  91%|█████████ | 48/53 [00:03<00:00, 16.94it/s][3/6] extract embeddings:  94%|█████████▍| 50/53 [00:03<00:00, 17.39it/s][3/6] extract embeddings:  98%|█████████▊| 52/53 [00:04<00:00, 17.89it/s][3/6] extract embeddings: 100%|██████████| 53/53 [00:04<00:00, 12.82it/s]
[NeMo I 2025-04-17 01:11:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:11:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:11:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:11:48 collections:880] Dataset successfully loaded with 4438 items and total duration provided from manifest is  1.68 hours.
[NeMo I 2025-04-17 01:11:48 collections:886] # 4438 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/70 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/70 [00:01<01:30,  1.31s/it][4/6] extract embeddings:   6%|▌         | 4/70 [00:01<00:18,  3.53it/s][4/6] extract embeddings:  10%|█         | 7/70 [00:01<00:09,  6.35it/s][4/6] extract embeddings:  14%|█▍        | 10/70 [00:01<00:06,  9.26it/s][4/6] extract embeddings:  19%|█▊        | 13/70 [00:01<00:04, 11.76it/s][4/6] extract embeddings:  23%|██▎       | 16/70 [00:01<00:03, 14.28it/s][4/6] extract embeddings:  27%|██▋       | 19/70 [00:02<00:03, 16.09it/s][4/6] extract embeddings:  31%|███▏      | 22/70 [00:02<00:02, 17.55it/s][4/6] extract embeddings:  36%|███▌      | 25/70 [00:02<00:02, 18.27it/s][4/6] extract embeddings:  40%|████      | 28/70 [00:02<00:02, 18.69it/s][4/6] extract embeddings:  44%|████▍     | 31/70 [00:02<00:02, 18.56it/s][4/6] extract embeddings:  49%|████▊     | 34/70 [00:02<00:01, 19.99it/s][4/6] extract embeddings:  53%|█████▎    | 37/70 [00:02<00:01, 20.43it/s][4/6] extract embeddings:  57%|█████▋    | 40/70 [00:03<00:01, 20.76it/s][4/6] extract embeddings:  61%|██████▏   | 43/70 [00:03<00:01, 20.72it/s][4/6] extract embeddings:  66%|██████▌   | 46/70 [00:03<00:01, 20.79it/s][4/6] extract embeddings:  70%|███████   | 49/70 [00:03<00:01, 20.57it/s][4/6] extract embeddings:  74%|███████▍  | 52/70 [00:03<00:00, 20.17it/s][4/6] extract embeddings:  79%|███████▊  | 55/70 [00:03<00:00, 19.12it/s][4/6] extract embeddings:  81%|████████▏ | 57/70 [00:04<00:00, 18.61it/s][4/6] extract embeddings:  84%|████████▍ | 59/70 [00:04<00:00, 17.91it/s][4/6] extract embeddings:  87%|████████▋ | 61/70 [00:04<00:00, 18.15it/s][4/6] extract embeddings:  91%|█████████▏| 64/70 [00:04<00:00, 18.94it/s][4/6] extract embeddings:  96%|█████████▌| 67/70 [00:04<00:00, 19.23it/s][4/6] extract embeddings:  99%|█████████▊| 69/70 [00:04<00:00, 18.77it/s][4/6] extract embeddings: 100%|██████████| 70/70 [00:04<00:00, 14.81it/s]
[NeMo I 2025-04-17 01:11:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:11:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:11:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:11:53 collections:880] Dataset successfully loaded with 6681 items and total duration provided from manifest is  1.76 hours.
[NeMo I 2025-04-17 01:11:53 collections:886] # 6681 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/105 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/105 [00:01<02:03,  1.19s/it][5/6] extract embeddings:   4%|▍         | 4/105 [00:01<00:26,  3.86it/s][5/6] extract embeddings:   7%|▋         | 7/105 [00:01<00:14,  6.95it/s][5/6] extract embeddings:  10%|▉         | 10/105 [00:01<00:09,  9.98it/s][5/6] extract embeddings:  12%|█▏        | 13/105 [00:01<00:07, 12.65it/s][5/6] extract embeddings:  15%|█▌        | 16/105 [00:01<00:05, 14.94it/s][5/6] extract embeddings:  18%|█▊        | 19/105 [00:01<00:04, 17.45it/s][5/6] extract embeddings:  21%|██        | 22/105 [00:02<00:04, 18.33it/s][5/6] extract embeddings:  24%|██▍       | 25/105 [00:02<00:04, 18.69it/s][5/6] extract embeddings:  27%|██▋       | 28/105 [00:02<00:04, 18.68it/s][5/6] extract embeddings:  30%|██▉       | 31/105 [00:02<00:03, 19.43it/s][5/6] extract embeddings:  32%|███▏      | 34/105 [00:02<00:03, 21.00it/s][5/6] extract embeddings:  35%|███▌      | 37/105 [00:02<00:03, 21.22it/s][5/6] extract embeddings:  38%|███▊      | 40/105 [00:02<00:02, 22.24it/s][5/6] extract embeddings:  41%|████      | 43/105 [00:03<00:02, 23.00it/s][5/6] extract embeddings:  44%|████▍     | 46/105 [00:03<00:02, 22.54it/s][5/6] extract embeddings:  47%|████▋     | 49/105 [00:03<00:02, 22.56it/s][5/6] extract embeddings:  50%|████▉     | 52/105 [00:03<00:02, 22.33it/s][5/6] extract embeddings:  52%|█████▏    | 55/105 [00:03<00:02, 21.74it/s][5/6] extract embeddings:  55%|█████▌    | 58/105 [00:03<00:02, 22.00it/s][5/6] extract embeddings:  58%|█████▊    | 61/105 [00:03<00:02, 21.93it/s][5/6] extract embeddings:  61%|██████    | 64/105 [00:04<00:01, 21.70it/s][5/6] extract embeddings:  64%|██████▍   | 67/105 [00:04<00:01, 21.07it/s][5/6] extract embeddings:  67%|██████▋   | 70/105 [00:04<00:01, 21.31it/s][5/6] extract embeddings:  70%|██████▉   | 73/105 [00:04<00:01, 21.96it/s][5/6] extract embeddings:  72%|███████▏  | 76/105 [00:04<00:01, 21.24it/s][5/6] extract embeddings:  75%|███████▌  | 79/105 [00:04<00:01, 20.76it/s][5/6] extract embeddings:  78%|███████▊  | 82/105 [00:04<00:01, 20.94it/s][5/6] extract embeddings:  81%|████████  | 85/105 [00:05<00:00, 21.68it/s][5/6] extract embeddings:  84%|████████▍ | 88/105 [00:05<00:00, 22.43it/s][5/6] extract embeddings:  87%|████████▋ | 91/105 [00:05<00:00, 22.00it/s][5/6] extract embeddings:  90%|████████▉ | 94/105 [00:05<00:00, 20.90it/s][5/6] extract embeddings:  92%|█████████▏| 97/105 [00:05<00:00, 22.08it/s][5/6] extract embeddings:  95%|█████████▌| 100/105 [00:05<00:00, 21.83it/s][5/6] extract embeddings:  98%|█████████▊| 103/105 [00:05<00:00, 21.90it/s][5/6] extract embeddings: 100%|██████████| 105/105 [00:05<00:00, 17.66it/s]
[NeMo I 2025-04-17 01:11:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:11:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:11:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:11:59 collections:880] Dataset successfully loaded with 13615 items and total duration provided from manifest is  1.85 hours.
[NeMo I 2025-04-17 01:11:59 collections:886] # 13615 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/213 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/213 [00:01<04:05,  1.16s/it][6/6] extract embeddings:   2%|▏         | 5/213 [00:01<00:41,  5.07it/s][6/6] extract embeddings:   4%|▍         | 9/213 [00:01<00:21,  9.47it/s][6/6] extract embeddings:   6%|▌         | 12/213 [00:01<00:16, 12.55it/s][6/6] extract embeddings:   7%|▋         | 15/213 [00:01<00:13, 14.47it/s][6/6] extract embeddings:   8%|▊         | 18/213 [00:01<00:11, 16.46it/s][6/6] extract embeddings:  10%|▉         | 21/213 [00:01<00:10, 18.54it/s][6/6] extract embeddings:  12%|█▏        | 25/213 [00:02<00:08, 22.00it/s][6/6] extract embeddings:  14%|█▎        | 29/213 [00:02<00:07, 24.84it/s][6/6] extract embeddings:  15%|█▌        | 33/213 [00:02<00:06, 27.00it/s][6/6] extract embeddings:  17%|█▋        | 37/213 [00:02<00:06, 28.68it/s][6/6] extract embeddings:  19%|█▉        | 41/213 [00:02<00:06, 28.02it/s][6/6] extract embeddings:  21%|██        | 45/213 [00:02<00:05, 29.43it/s][6/6] extract embeddings:  23%|██▎       | 49/213 [00:02<00:05, 30.01it/s][6/6] extract embeddings:  25%|██▍       | 53/213 [00:02<00:05, 29.46it/s][6/6] extract embeddings:  27%|██▋       | 57/213 [00:03<00:05, 28.97it/s][6/6] extract embeddings:  28%|██▊       | 60/213 [00:03<00:05, 28.63it/s][6/6] extract embeddings:  30%|███       | 64/213 [00:03<00:05, 29.00it/s][6/6] extract embeddings:  32%|███▏      | 68/213 [00:03<00:04, 30.69it/s][6/6] extract embeddings:  34%|███▍      | 72/213 [00:03<00:04, 28.86it/s][6/6] extract embeddings:  35%|███▌      | 75/213 [00:03<00:05, 27.45it/s][6/6] extract embeddings:  37%|███▋      | 78/213 [00:03<00:05, 26.77it/s][6/6] extract embeddings:  38%|███▊      | 81/213 [00:03<00:04, 26.96it/s][6/6] extract embeddings:  39%|███▉      | 84/213 [00:04<00:04, 26.17it/s][6/6] extract embeddings:  41%|████      | 87/213 [00:04<00:04, 25.57it/s][6/6] extract embeddings:  42%|████▏     | 90/213 [00:04<00:05, 23.90it/s][6/6] extract embeddings:  44%|████▎     | 93/213 [00:04<00:04, 24.08it/s][6/6] extract embeddings:  45%|████▌     | 96/213 [00:04<00:04, 23.88it/s][6/6] extract embeddings:  46%|████▋     | 99/213 [00:04<00:04, 25.35it/s][6/6] extract embeddings:  48%|████▊     | 102/213 [00:04<00:04, 24.78it/s][6/6] extract embeddings:  50%|████▉     | 106/213 [00:04<00:04, 26.57it/s][6/6] extract embeddings:  52%|█████▏    | 110/213 [00:05<00:03, 28.82it/s][6/6] extract embeddings:  53%|█████▎    | 113/213 [00:05<00:03, 28.79it/s][6/6] extract embeddings:  55%|█████▍    | 117/213 [00:05<00:03, 29.24it/s][6/6] extract embeddings:  56%|█████▋    | 120/213 [00:05<00:03, 26.75it/s][6/6] extract embeddings:  58%|█████▊    | 123/213 [00:05<00:03, 27.00it/s][6/6] extract embeddings:  59%|█████▉    | 126/213 [00:05<00:03, 27.17it/s][6/6] extract embeddings:  61%|██████    | 130/213 [00:05<00:02, 29.18it/s][6/6] extract embeddings:  62%|██████▏   | 133/213 [00:05<00:03, 26.49it/s][6/6] extract embeddings:  64%|██████▍   | 136/213 [00:06<00:03, 25.56it/s][6/6] extract embeddings:  65%|██████▌   | 139/213 [00:06<00:03, 24.22it/s][6/6] extract embeddings:  67%|██████▋   | 142/213 [00:06<00:03, 23.62it/s][6/6] extract embeddings:  68%|██████▊   | 145/213 [00:06<00:02, 23.01it/s][6/6] extract embeddings:  69%|██████▉   | 148/213 [00:06<00:02, 21.99it/s][6/6] extract embeddings:  71%|███████   | 151/213 [00:06<00:02, 22.29it/s][6/6] extract embeddings:  72%|███████▏  | 154/213 [00:06<00:02, 22.14it/s][6/6] extract embeddings:  74%|███████▎  | 157/213 [00:06<00:02, 22.92it/s][6/6] extract embeddings:  75%|███████▌  | 160/213 [00:07<00:02, 23.89it/s][6/6] extract embeddings:  77%|███████▋  | 163/213 [00:07<00:02, 24.13it/s][6/6] extract embeddings:  78%|███████▊  | 166/213 [00:07<00:01, 25.54it/s][6/6] extract embeddings:  79%|███████▉  | 169/213 [00:07<00:01, 25.39it/s][6/6] extract embeddings:  81%|████████  | 172/213 [00:07<00:01, 26.05it/s][6/6] extract embeddings:  82%|████████▏ | 175/213 [00:07<00:01, 25.38it/s][6/6] extract embeddings:  84%|████████▎ | 178/213 [00:07<00:01, 24.53it/s][6/6] extract embeddings:  85%|████████▍ | 181/213 [00:07<00:01, 24.98it/s][6/6] extract embeddings:  86%|████████▋ | 184/213 [00:08<00:01, 23.57it/s][6/6] extract embeddings:  88%|████████▊ | 187/213 [00:08<00:01, 24.19it/s][6/6] extract embeddings:  89%|████████▉ | 190/213 [00:08<00:00, 25.49it/s][6/6] extract embeddings:  91%|█████████ | 193/213 [00:08<00:00, 24.56it/s][6/6] extract embeddings:  92%|█████████▏| 196/213 [00:08<00:00, 24.07it/s][6/6] extract embeddings:  93%|█████████▎| 199/213 [00:08<00:00, 24.70it/s][6/6] extract embeddings:  95%|█████████▍| 202/213 [00:08<00:00, 23.64it/s][6/6] extract embeddings:  96%|█████████▌| 205/213 [00:08<00:00, 24.04it/s][6/6] extract embeddings:  98%|█████████▊| 208/213 [00:09<00:00, 24.06it/s][6/6] extract embeddings:  99%|█████████▉| 211/213 [00:09<00:00, 24.20it/s][6/6] extract embeddings: 100%|██████████| 213/213 [00:09<00:00, 22.92it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.99it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.18it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.74it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.28it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s]
[NeMo I 2025-04-17 01:12:11 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:12:12 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              40.107381   444.120  ...   18.574996  4.182427
    Harker-ES                       30.759921  2178.782  ...   73.238056  3.361422
    Harker-MN                       43.592581   366.767  ...   31.033024  8.461237
    Longfellow-Block-1              23.833623   492.417  ...   11.043969  2.242808
    TOTAL                           32.324318  3482.086  ...  133.890045  3.845110
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:12:12 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0849 | MISS: 0.1999 | CER: 0.0385 | DER: 0.3232 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.35, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.35, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.89s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:04,  2.01s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.28s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.06it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.21s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:12:25 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:12:25 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:12:25 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:12:25 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:12:25 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:12:25 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:12:25 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:12:25 features:305] PADDING: 16
[NeMo I 2025-04-17 01:12:25 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:12:25 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:12:25 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:12:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:12:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:12:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:12:25 collections:880] Dataset successfully loaded with 2283 items and total duration provided from manifest is  1.47 hours.
[NeMo I 2025-04-17 01:12:25 collections:886] # 2283 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/36 [00:02<01:13,  2.11s/it][1/6] extract embeddings:  11%|█         | 4/36 [00:02<00:13,  2.33it/s][1/6] extract embeddings:  17%|█▋        | 6/36 [00:02<00:08,  3.61it/s][1/6] extract embeddings:  22%|██▏       | 8/36 [00:02<00:05,  5.12it/s][1/6] extract embeddings:  28%|██▊       | 10/36 [00:02<00:03,  6.56it/s][1/6] extract embeddings:  33%|███▎      | 12/36 [00:02<00:03,  7.85it/s][1/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:02,  9.08it/s][1/6] extract embeddings:  44%|████▍     | 16/36 [00:03<00:01, 10.33it/s][1/6] extract embeddings:  50%|█████     | 18/36 [00:03<00:01, 11.00it/s][1/6] extract embeddings:  56%|█████▌    | 20/36 [00:03<00:01, 11.82it/s][1/6] extract embeddings:  61%|██████    | 22/36 [00:03<00:01, 12.50it/s][1/6] extract embeddings:  67%|██████▋   | 24/36 [00:03<00:00, 12.99it/s][1/6] extract embeddings:  72%|███████▏  | 26/36 [00:03<00:00, 13.47it/s][1/6] extract embeddings:  78%|███████▊  | 28/36 [00:03<00:00, 13.47it/s][1/6] extract embeddings:  83%|████████▎ | 30/36 [00:04<00:00, 13.11it/s][1/6] extract embeddings:  89%|████████▉ | 32/36 [00:04<00:00, 13.13it/s][1/6] extract embeddings:  94%|█████████▍| 34/36 [00:04<00:00, 13.42it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00, 14.25it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00,  7.89it/s]
[NeMo I 2025-04-17 01:12:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:12:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:12:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:12:30 collections:880] Dataset successfully loaded with 2690 items and total duration provided from manifest is  1.53 hours.
[NeMo I 2025-04-17 01:12:30 collections:886] # 2690 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/43 [00:01<01:06,  1.59s/it][2/6] extract embeddings:   7%|▋         | 3/43 [00:01<00:18,  2.19it/s][2/6] extract embeddings:  12%|█▏        | 5/43 [00:01<00:09,  3.83it/s][2/6] extract embeddings:  16%|█▋        | 7/43 [00:02<00:06,  5.52it/s][2/6] extract embeddings:  21%|██        | 9/43 [00:02<00:04,  7.31it/s][2/6] extract embeddings:  26%|██▌       | 11/43 [00:02<00:03,  8.81it/s][2/6] extract embeddings:  30%|███       | 13/43 [00:02<00:02, 10.38it/s][2/6] extract embeddings:  35%|███▍      | 15/43 [00:02<00:02, 11.29it/s][2/6] extract embeddings:  40%|███▉      | 17/43 [00:02<00:02, 12.44it/s][2/6] extract embeddings:  44%|████▍     | 19/43 [00:02<00:01, 13.45it/s][2/6] extract embeddings:  49%|████▉     | 21/43 [00:02<00:01, 14.28it/s][2/6] extract embeddings:  53%|█████▎    | 23/43 [00:03<00:01, 15.17it/s][2/6] extract embeddings:  58%|█████▊    | 25/43 [00:03<00:01, 15.20it/s][2/6] extract embeddings:  63%|██████▎   | 27/43 [00:03<00:01, 15.32it/s][2/6] extract embeddings:  67%|██████▋   | 29/43 [00:03<00:00, 15.90it/s][2/6] extract embeddings:  72%|███████▏  | 31/43 [00:03<00:00, 15.97it/s][2/6] extract embeddings:  77%|███████▋  | 33/43 [00:03<00:00, 15.81it/s][2/6] extract embeddings:  81%|████████▏ | 35/43 [00:03<00:00, 15.96it/s][2/6] extract embeddings:  86%|████████▌ | 37/43 [00:03<00:00, 15.34it/s][2/6] extract embeddings:  91%|█████████ | 39/43 [00:04<00:00, 14.74it/s][2/6] extract embeddings:  95%|█████████▌| 41/43 [00:04<00:00, 15.04it/s][2/6] extract embeddings: 100%|██████████| 43/43 [00:04<00:00, 16.03it/s][2/6] extract embeddings: 100%|██████████| 43/43 [00:04<00:00,  9.93it/s]
[NeMo I 2025-04-17 01:12:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:12:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:12:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:12:35 collections:880] Dataset successfully loaded with 3302 items and total duration provided from manifest is  1.59 hours.
[NeMo I 2025-04-17 01:12:35 collections:886] # 3302 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/52 [00:01<01:17,  1.51s/it][3/6] extract embeddings:   6%|▌         | 3/52 [00:01<00:21,  2.32it/s][3/6] extract embeddings:  10%|▉         | 5/52 [00:01<00:11,  4.18it/s][3/6] extract embeddings:  13%|█▎        | 7/52 [00:01<00:07,  5.99it/s][3/6] extract embeddings:  17%|█▋        | 9/52 [00:01<00:05,  8.07it/s][3/6] extract embeddings:  21%|██        | 11/52 [00:02<00:04,  9.87it/s][3/6] extract embeddings:  25%|██▌       | 13/52 [00:02<00:03, 11.21it/s][3/6] extract embeddings:  29%|██▉       | 15/52 [00:02<00:02, 12.57it/s][3/6] extract embeddings:  33%|███▎      | 17/52 [00:02<00:02, 13.46it/s][3/6] extract embeddings:  37%|███▋      | 19/52 [00:02<00:02, 14.07it/s][3/6] extract embeddings:  40%|████      | 21/52 [00:02<00:02, 14.56it/s][3/6] extract embeddings:  44%|████▍     | 23/52 [00:02<00:01, 15.10it/s][3/6] extract embeddings:  48%|████▊     | 25/52 [00:02<00:01, 15.67it/s][3/6] extract embeddings:  52%|█████▏    | 27/52 [00:03<00:01, 15.43it/s][3/6] extract embeddings:  56%|█████▌    | 29/52 [00:03<00:01, 15.94it/s][3/6] extract embeddings:  60%|█████▉    | 31/52 [00:03<00:01, 16.18it/s][3/6] extract embeddings:  63%|██████▎   | 33/52 [00:03<00:01, 16.30it/s][3/6] extract embeddings:  67%|██████▋   | 35/52 [00:03<00:01, 16.20it/s][3/6] extract embeddings:  73%|███████▎  | 38/52 [00:03<00:00, 16.89it/s][3/6] extract embeddings:  77%|███████▋  | 40/52 [00:03<00:00, 16.99it/s][3/6] extract embeddings:  81%|████████  | 42/52 [00:03<00:00, 16.94it/s][3/6] extract embeddings:  85%|████████▍ | 44/52 [00:04<00:00, 16.62it/s][3/6] extract embeddings:  88%|████████▊ | 46/52 [00:04<00:00, 16.81it/s][3/6] extract embeddings:  92%|█████████▏| 48/52 [00:04<00:00, 16.97it/s][3/6] extract embeddings:  96%|█████████▌| 50/52 [00:04<00:00, 16.75it/s][3/6] extract embeddings: 100%|██████████| 52/52 [00:04<00:00, 11.38it/s]
[NeMo I 2025-04-17 01:12:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:12:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:12:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:12:39 collections:880] Dataset successfully loaded with 4382 items and total duration provided from manifest is  1.66 hours.
[NeMo I 2025-04-17 01:12:39 collections:886] # 4382 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/69 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/69 [00:01<01:28,  1.30s/it][4/6] extract embeddings:   6%|▌         | 4/69 [00:01<00:18,  3.52it/s][4/6] extract embeddings:  10%|█         | 7/69 [00:01<00:09,  6.28it/s][4/6] extract embeddings:  13%|█▎        | 9/69 [00:01<00:07,  8.11it/s][4/6] extract embeddings:  16%|█▌        | 11/69 [00:01<00:05, 10.03it/s][4/6] extract embeddings:  20%|██        | 14/69 [00:01<00:04, 12.41it/s][4/6] extract embeddings:  23%|██▎       | 16/69 [00:02<00:03, 13.81it/s][4/6] extract embeddings:  26%|██▌       | 18/69 [00:02<00:03, 14.74it/s][4/6] extract embeddings:  29%|██▉       | 20/69 [00:02<00:03, 15.76it/s][4/6] extract embeddings:  32%|███▏      | 22/69 [00:02<00:03, 15.50it/s][4/6] extract embeddings:  35%|███▍      | 24/69 [00:02<00:02, 15.83it/s][4/6] extract embeddings:  38%|███▊      | 26/69 [00:02<00:02, 16.38it/s][4/6] extract embeddings:  41%|████      | 28/69 [00:02<00:02, 16.81it/s][4/6] extract embeddings:  43%|████▎     | 30/69 [00:02<00:02, 16.91it/s][4/6] extract embeddings:  46%|████▋     | 32/69 [00:02<00:02, 17.68it/s][4/6] extract embeddings:  49%|████▉     | 34/69 [00:03<00:01, 17.87it/s][4/6] extract embeddings:  52%|█████▏    | 36/69 [00:03<00:01, 18.00it/s][4/6] extract embeddings:  55%|█████▌    | 38/69 [00:03<00:01, 18.03it/s][4/6] extract embeddings:  58%|█████▊    | 40/69 [00:03<00:01, 17.62it/s][4/6] extract embeddings:  61%|██████    | 42/69 [00:03<00:01, 17.57it/s][4/6] extract embeddings:  64%|██████▍   | 44/69 [00:03<00:01, 17.48it/s][4/6] extract embeddings:  67%|██████▋   | 46/69 [00:03<00:01, 17.23it/s][4/6] extract embeddings:  70%|██████▉   | 48/69 [00:03<00:01, 17.21it/s][4/6] extract embeddings:  72%|███████▏  | 50/69 [00:04<00:01, 17.29it/s][4/6] extract embeddings:  75%|███████▌  | 52/69 [00:04<00:00, 17.34it/s][4/6] extract embeddings:  78%|███████▊  | 54/69 [00:04<00:00, 17.31it/s][4/6] extract embeddings:  81%|████████  | 56/69 [00:04<00:00, 16.66it/s][4/6] extract embeddings:  84%|████████▍ | 58/69 [00:04<00:00, 16.66it/s][4/6] extract embeddings:  87%|████████▋ | 60/69 [00:04<00:00, 16.83it/s][4/6] extract embeddings:  90%|████████▉ | 62/69 [00:04<00:00, 16.13it/s][4/6] extract embeddings:  93%|█████████▎| 64/69 [00:04<00:00, 16.46it/s][4/6] extract embeddings:  96%|█████████▌| 66/69 [00:04<00:00, 16.75it/s][4/6] extract embeddings:  99%|█████████▊| 68/69 [00:05<00:00, 17.02it/s][4/6] extract embeddings: 100%|██████████| 69/69 [00:05<00:00, 13.42it/s]
[NeMo I 2025-04-17 01:12:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:12:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:12:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:12:45 collections:880] Dataset successfully loaded with 6607 items and total duration provided from manifest is  1.74 hours.
[NeMo I 2025-04-17 01:12:45 collections:886] # 6607 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/104 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/104 [00:01<02:02,  1.19s/it][5/6] extract embeddings:   4%|▍         | 4/104 [00:01<00:26,  3.80it/s][5/6] extract embeddings:   6%|▌         | 6/104 [00:01<00:17,  5.74it/s][5/6] extract embeddings:   8%|▊         | 8/104 [00:01<00:12,  7.79it/s][5/6] extract embeddings:  10%|▉         | 10/104 [00:01<00:09,  9.82it/s][5/6] extract embeddings:  12%|█▏        | 12/104 [00:01<00:07, 11.76it/s][5/6] extract embeddings:  13%|█▎        | 14/104 [00:01<00:06, 13.45it/s][5/6] extract embeddings:  15%|█▌        | 16/104 [00:01<00:06, 14.47it/s][5/6] extract embeddings:  17%|█▋        | 18/104 [00:02<00:05, 15.61it/s][5/6] extract embeddings:  19%|█▉        | 20/104 [00:02<00:05, 16.14it/s][5/6] extract embeddings:  21%|██        | 22/104 [00:02<00:04, 17.15it/s][5/6] extract embeddings:  23%|██▎       | 24/104 [00:02<00:04, 17.36it/s][5/6] extract embeddings:  25%|██▌       | 26/104 [00:02<00:04, 17.18it/s][5/6] extract embeddings:  27%|██▋       | 28/104 [00:02<00:04, 16.91it/s][5/6] extract embeddings:  29%|██▉       | 30/104 [00:02<00:04, 17.19it/s][5/6] extract embeddings:  32%|███▏      | 33/104 [00:02<00:03, 18.17it/s][5/6] extract embeddings:  34%|███▎      | 35/104 [00:03<00:03, 18.10it/s][5/6] extract embeddings:  36%|███▌      | 37/104 [00:03<00:03, 17.80it/s][5/6] extract embeddings:  38%|███▊      | 39/104 [00:03<00:03, 17.31it/s][5/6] extract embeddings:  39%|███▉      | 41/104 [00:03<00:03, 17.39it/s][5/6] extract embeddings:  42%|████▏     | 44/104 [00:03<00:03, 19.28it/s][5/6] extract embeddings:  45%|████▌     | 47/104 [00:03<00:02, 20.90it/s][5/6] extract embeddings:  48%|████▊     | 50/104 [00:03<00:02, 22.79it/s][5/6] extract embeddings:  51%|█████     | 53/104 [00:03<00:02, 22.33it/s][5/6] extract embeddings:  54%|█████▍    | 56/104 [00:04<00:02, 21.88it/s][5/6] extract embeddings:  57%|█████▋    | 59/104 [00:04<00:02, 22.33it/s][5/6] extract embeddings:  60%|█████▉    | 62/104 [00:04<00:01, 22.05it/s][5/6] extract embeddings:  62%|██████▎   | 65/104 [00:04<00:01, 20.90it/s][5/6] extract embeddings:  65%|██████▌   | 68/104 [00:04<00:01, 20.87it/s][5/6] extract embeddings:  68%|██████▊   | 71/104 [00:04<00:01, 21.59it/s][5/6] extract embeddings:  71%|███████   | 74/104 [00:04<00:01, 20.90it/s][5/6] extract embeddings:  74%|███████▍  | 77/104 [00:05<00:01, 21.33it/s][5/6] extract embeddings:  77%|███████▋  | 80/104 [00:05<00:01, 22.52it/s][5/6] extract embeddings:  80%|███████▉  | 83/104 [00:05<00:00, 23.21it/s][5/6] extract embeddings:  83%|████████▎ | 86/104 [00:05<00:00, 21.92it/s][5/6] extract embeddings:  86%|████████▌ | 89/104 [00:05<00:00, 20.85it/s][5/6] extract embeddings:  88%|████████▊ | 92/104 [00:05<00:00, 21.18it/s][5/6] extract embeddings:  91%|█████████▏| 95/104 [00:05<00:00, 21.21it/s][5/6] extract embeddings:  94%|█████████▍| 98/104 [00:06<00:00, 20.75it/s][5/6] extract embeddings:  97%|█████████▋| 101/104 [00:06<00:00, 20.70it/s][5/6] extract embeddings: 100%|██████████| 104/104 [00:06<00:00, 22.45it/s][5/6] extract embeddings: 100%|██████████| 104/104 [00:06<00:00, 16.54it/s]
[NeMo I 2025-04-17 01:12:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:12:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:12:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:12:51 collections:880] Dataset successfully loaded with 13464 items and total duration provided from manifest is  1.83 hours.
[NeMo I 2025-04-17 01:12:51 collections:886] # 13464 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/211 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/211 [00:01<04:06,  1.18s/it][6/6] extract embeddings:   2%|▏         | 4/211 [00:01<00:51,  3.99it/s][6/6] extract embeddings:   3%|▎         | 7/211 [00:01<00:28,  7.24it/s][6/6] extract embeddings:   5%|▍         | 10/211 [00:01<00:19, 10.27it/s][6/6] extract embeddings:   6%|▌         | 13/211 [00:01<00:15, 12.74it/s][6/6] extract embeddings:   8%|▊         | 16/211 [00:01<00:12, 15.55it/s][6/6] extract embeddings:   9%|▉         | 19/211 [00:01<00:10, 17.84it/s][6/6] extract embeddings:  10%|█         | 22/211 [00:02<00:10, 18.79it/s][6/6] extract embeddings:  12%|█▏        | 25/211 [00:02<00:09, 19.23it/s][6/6] extract embeddings:  13%|█▎        | 28/211 [00:02<00:09, 20.30it/s][6/6] extract embeddings:  15%|█▍        | 31/211 [00:02<00:08, 21.14it/s][6/6] extract embeddings:  16%|█▌        | 34/211 [00:02<00:07, 22.18it/s][6/6] extract embeddings:  18%|█▊        | 37/211 [00:02<00:07, 23.18it/s][6/6] extract embeddings:  19%|█▉        | 40/211 [00:02<00:07, 22.62it/s][6/6] extract embeddings:  20%|██        | 43/211 [00:02<00:07, 23.80it/s][6/6] extract embeddings:  22%|██▏       | 46/211 [00:03<00:06, 24.01it/s][6/6] extract embeddings:  23%|██▎       | 49/211 [00:03<00:07, 22.56it/s][6/6] extract embeddings:  25%|██▍       | 52/211 [00:03<00:07, 22.45it/s][6/6] extract embeddings:  26%|██▌       | 55/211 [00:03<00:06, 22.95it/s][6/6] extract embeddings:  27%|██▋       | 58/211 [00:03<00:06, 23.12it/s][6/6] extract embeddings:  29%|██▉       | 61/211 [00:03<00:06, 22.08it/s][6/6] extract embeddings:  30%|███       | 64/211 [00:03<00:06, 23.11it/s][6/6] extract embeddings:  32%|███▏      | 67/211 [00:03<00:06, 23.95it/s][6/6] extract embeddings:  33%|███▎      | 70/211 [00:04<00:05, 25.18it/s][6/6] extract embeddings:  35%|███▌      | 74/211 [00:04<00:05, 26.63it/s][6/6] extract embeddings:  36%|███▋      | 77/211 [00:04<00:05, 26.41it/s][6/6] extract embeddings:  38%|███▊      | 80/211 [00:04<00:05, 25.74it/s][6/6] extract embeddings:  40%|███▉      | 84/211 [00:04<00:04, 27.50it/s][6/6] extract embeddings:  41%|████      | 87/211 [00:04<00:04, 25.46it/s][6/6] extract embeddings:  43%|████▎     | 91/211 [00:04<00:04, 26.41it/s][6/6] extract embeddings:  45%|████▌     | 95/211 [00:05<00:04, 26.72it/s][6/6] extract embeddings:  47%|████▋     | 99/211 [00:05<00:04, 27.94it/s][6/6] extract embeddings:  48%|████▊     | 102/211 [00:05<00:03, 27.98it/s][6/6] extract embeddings:  50%|████▉     | 105/211 [00:05<00:03, 27.67it/s][6/6] extract embeddings:  51%|█████     | 108/211 [00:05<00:03, 25.84it/s][6/6] extract embeddings:  53%|█████▎    | 111/211 [00:05<00:03, 25.77it/s][6/6] extract embeddings:  54%|█████▍    | 114/211 [00:05<00:04, 24.22it/s][6/6] extract embeddings:  55%|█████▌    | 117/211 [00:05<00:03, 24.24it/s][6/6] extract embeddings:  57%|█████▋    | 120/211 [00:06<00:03, 23.95it/s][6/6] extract embeddings:  58%|█████▊    | 123/211 [00:06<00:03, 23.95it/s][6/6] extract embeddings:  60%|█████▉    | 126/211 [00:06<00:03, 23.22it/s][6/6] extract embeddings:  61%|██████    | 129/211 [00:06<00:03, 23.64it/s][6/6] extract embeddings:  63%|██████▎   | 132/211 [00:06<00:03, 23.68it/s][6/6] extract embeddings:  64%|██████▍   | 135/211 [00:06<00:03, 24.56it/s][6/6] extract embeddings:  65%|██████▌   | 138/211 [00:06<00:03, 24.13it/s][6/6] extract embeddings:  67%|██████▋   | 141/211 [00:06<00:02, 24.42it/s][6/6] extract embeddings:  68%|██████▊   | 144/211 [00:07<00:02, 25.30it/s][6/6] extract embeddings:  70%|██████▉   | 147/211 [00:07<00:02, 26.40it/s][6/6] extract embeddings:  71%|███████   | 150/211 [00:07<00:02, 26.04it/s][6/6] extract embeddings:  73%|███████▎  | 153/211 [00:07<00:02, 25.28it/s][6/6] extract embeddings:  74%|███████▍  | 156/211 [00:07<00:02, 25.18it/s][6/6] extract embeddings:  75%|███████▌  | 159/211 [00:07<00:02, 25.66it/s][6/6] extract embeddings:  77%|███████▋  | 162/211 [00:07<00:01, 25.41it/s][6/6] extract embeddings:  78%|███████▊  | 165/211 [00:07<00:01, 23.98it/s][6/6] extract embeddings:  80%|███████▉  | 168/211 [00:07<00:01, 23.65it/s][6/6] extract embeddings:  81%|████████  | 171/211 [00:08<00:01, 23.15it/s][6/6] extract embeddings:  82%|████████▏ | 174/211 [00:08<00:01, 23.32it/s][6/6] extract embeddings:  84%|████████▍ | 177/211 [00:08<00:01, 23.64it/s][6/6] extract embeddings:  85%|████████▌ | 180/211 [00:08<00:01, 23.57it/s][6/6] extract embeddings:  87%|████████▋ | 183/211 [00:08<00:01, 24.53it/s][6/6] extract embeddings:  88%|████████▊ | 186/211 [00:08<00:01, 24.09it/s][6/6] extract embeddings:  90%|████████▉ | 189/211 [00:08<00:00, 25.02it/s][6/6] extract embeddings:  91%|█████████ | 192/211 [00:08<00:00, 24.69it/s][6/6] extract embeddings:  92%|█████████▏| 195/211 [00:09<00:00, 24.97it/s][6/6] extract embeddings:  94%|█████████▍| 198/211 [00:09<00:00, 25.74it/s][6/6] extract embeddings:  95%|█████████▌| 201/211 [00:09<00:00, 25.92it/s][6/6] extract embeddings:  97%|█████████▋| 204/211 [00:09<00:00, 26.45it/s][6/6] extract embeddings:  98%|█████████▊| 207/211 [00:09<00:00, 25.44it/s][6/6] extract embeddings: 100%|█████████▉| 210/211 [00:09<00:00, 25.40it/s][6/6] extract embeddings: 100%|██████████| 211/211 [00:09<00:00, 21.71it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.97it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.19it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.75it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.30it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.94it/s]
[NeMo I 2025-04-17 01:13:04 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:13:05 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              40.713096   444.120  ...   17.645001  3.973025
    Harker-ES                       31.183602  2178.782  ...   71.280002  3.271553
    Harker-MN                       44.237103   366.767  ...   31.583039  8.611200
    Longfellow-Block-1              24.472536   492.417  ...    9.708978  1.971698
    TOTAL                           32.824914  3482.086  ...  130.217020  3.739627
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:13:05 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0837 | MISS: 0.2071 | CER: 0.0374 | DER: 0.3282 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.40, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.4, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.83s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.94s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:13:17 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:13:17 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:13:17 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:13:17 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:13:17 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:13:17 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:13:17 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:13:17 features:305] PADDING: 16
[NeMo I 2025-04-17 01:13:18 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:13:18 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:13:18 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:13:18 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:13:18 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:13:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:13:18 collections:880] Dataset successfully loaded with 2266 items and total duration provided from manifest is  1.44 hours.
[NeMo I 2025-04-17 01:13:18 collections:886] # 2266 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/36 [00:02<01:12,  2.08s/it][1/6] extract embeddings:  11%|█         | 4/36 [00:02<00:13,  2.34it/s][1/6] extract embeddings:  17%|█▋        | 6/36 [00:02<00:08,  3.71it/s][1/6] extract embeddings:  22%|██▏       | 8/36 [00:02<00:05,  5.22it/s][1/6] extract embeddings:  28%|██▊       | 10/36 [00:02<00:03,  6.70it/s][1/6] extract embeddings:  33%|███▎      | 12/36 [00:02<00:03,  7.97it/s][1/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:02,  9.13it/s][1/6] extract embeddings:  44%|████▍     | 16/36 [00:03<00:01, 10.39it/s][1/6] extract embeddings:  50%|█████     | 18/36 [00:03<00:01, 11.61it/s][1/6] extract embeddings:  56%|█████▌    | 20/36 [00:03<00:01, 12.18it/s][1/6] extract embeddings:  61%|██████    | 22/36 [00:03<00:01, 12.43it/s][1/6] extract embeddings:  67%|██████▋   | 24/36 [00:03<00:00, 12.89it/s][1/6] extract embeddings:  72%|███████▏  | 26/36 [00:03<00:00, 12.80it/s][1/6] extract embeddings:  78%|███████▊  | 28/36 [00:03<00:00, 12.95it/s][1/6] extract embeddings:  83%|████████▎ | 30/36 [00:04<00:00, 13.08it/s][1/6] extract embeddings:  89%|████████▉ | 32/36 [00:04<00:00, 13.14it/s][1/6] extract embeddings:  94%|█████████▍| 34/36 [00:04<00:00, 13.51it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00,  8.02it/s]
[NeMo I 2025-04-17 01:13:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:13:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:13:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:13:23 collections:880] Dataset successfully loaded with 2664 items and total duration provided from manifest is  1.50 hours.
[NeMo I 2025-04-17 01:13:23 collections:886] # 2664 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:59,  1.46s/it][2/6] extract embeddings:   7%|▋         | 3/42 [00:01<00:16,  2.39it/s][2/6] extract embeddings:  12%|█▏        | 5/42 [00:01<00:08,  4.17it/s][2/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:05,  6.10it/s][2/6] extract embeddings:  21%|██▏       | 9/42 [00:01<00:04,  7.96it/s][2/6] extract embeddings:  26%|██▌       | 11/42 [00:02<00:03,  9.30it/s][2/6] extract embeddings:  31%|███       | 13/42 [00:02<00:02, 10.38it/s][2/6] extract embeddings:  36%|███▌      | 15/42 [00:02<00:02, 11.47it/s][2/6] extract embeddings:  40%|████      | 17/42 [00:02<00:02, 12.33it/s][2/6] extract embeddings:  45%|████▌     | 19/42 [00:02<00:01, 12.90it/s][2/6] extract embeddings:  50%|█████     | 21/42 [00:02<00:01, 13.80it/s][2/6] extract embeddings:  55%|█████▍    | 23/42 [00:02<00:01, 14.37it/s][2/6] extract embeddings:  60%|█████▉    | 25/42 [00:03<00:01, 14.57it/s][2/6] extract embeddings:  64%|██████▍   | 27/42 [00:03<00:01, 14.87it/s][2/6] extract embeddings:  69%|██████▉   | 29/42 [00:03<00:00, 14.82it/s][2/6] extract embeddings:  74%|███████▍  | 31/42 [00:03<00:00, 14.66it/s][2/6] extract embeddings:  79%|███████▊  | 33/42 [00:03<00:00, 14.47it/s][2/6] extract embeddings:  83%|████████▎ | 35/42 [00:03<00:00, 15.08it/s][2/6] extract embeddings:  88%|████████▊ | 37/42 [00:03<00:00, 15.03it/s][2/6] extract embeddings:  93%|█████████▎| 39/42 [00:03<00:00, 15.23it/s][2/6] extract embeddings:  98%|█████████▊| 41/42 [00:04<00:00, 15.40it/s][2/6] extract embeddings: 100%|██████████| 42/42 [00:04<00:00, 10.05it/s]
[NeMo I 2025-04-17 01:13:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:13:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:13:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:13:27 collections:880] Dataset successfully loaded with 3264 items and total duration provided from manifest is  1.56 hours.
[NeMo I 2025-04-17 01:13:27 collections:886] # 3264 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/51 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/51 [00:01<01:00,  1.21s/it][3/6] extract embeddings:   6%|▌         | 3/51 [00:01<00:17,  2.82it/s][3/6] extract embeddings:  10%|▉         | 5/51 [00:01<00:09,  4.94it/s][3/6] extract embeddings:  14%|█▎        | 7/51 [00:01<00:06,  7.02it/s][3/6] extract embeddings:  18%|█▊        | 9/51 [00:01<00:04,  9.07it/s][3/6] extract embeddings:  22%|██▏       | 11/51 [00:01<00:03, 11.03it/s][3/6] extract embeddings:  25%|██▌       | 13/51 [00:01<00:03, 12.55it/s][3/6] extract embeddings:  29%|██▉       | 15/51 [00:02<00:02, 13.40it/s][3/6] extract embeddings:  33%|███▎      | 17/51 [00:02<00:02, 14.54it/s][3/6] extract embeddings:  37%|███▋      | 19/51 [00:02<00:02, 15.14it/s][3/6] extract embeddings:  41%|████      | 21/51 [00:02<00:01, 15.40it/s][3/6] extract embeddings:  45%|████▌     | 23/51 [00:02<00:01, 15.63it/s][3/6] extract embeddings:  49%|████▉     | 25/51 [00:02<00:01, 15.71it/s][3/6] extract embeddings:  53%|█████▎    | 27/51 [00:02<00:01, 15.83it/s][3/6] extract embeddings:  57%|█████▋    | 29/51 [00:02<00:01, 15.93it/s][3/6] extract embeddings:  61%|██████    | 31/51 [00:03<00:01, 15.75it/s][3/6] extract embeddings:  65%|██████▍   | 33/51 [00:03<00:01, 15.34it/s][3/6] extract embeddings:  69%|██████▊   | 35/51 [00:03<00:01, 15.84it/s][3/6] extract embeddings:  73%|███████▎  | 37/51 [00:03<00:00, 15.18it/s][3/6] extract embeddings:  76%|███████▋  | 39/51 [00:03<00:00, 16.34it/s][3/6] extract embeddings:  80%|████████  | 41/51 [00:03<00:00, 16.60it/s][3/6] extract embeddings:  84%|████████▍ | 43/51 [00:03<00:00, 17.14it/s][3/6] extract embeddings:  88%|████████▊ | 45/51 [00:03<00:00, 17.06it/s][3/6] extract embeddings:  92%|█████████▏| 47/51 [00:03<00:00, 16.70it/s][3/6] extract embeddings:  96%|█████████▌| 49/51 [00:04<00:00, 16.42it/s][3/6] extract embeddings: 100%|██████████| 51/51 [00:04<00:00, 15.94it/s][3/6] extract embeddings: 100%|██████████| 51/51 [00:04<00:00, 11.90it/s]
[NeMo I 2025-04-17 01:13:32 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:13:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:13:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:13:32 collections:880] Dataset successfully loaded with 4330 items and total duration provided from manifest is  1.63 hours.
[NeMo I 2025-04-17 01:13:32 collections:886] # 4330 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/68 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/68 [00:01<01:22,  1.24s/it][4/6] extract embeddings:   6%|▌         | 4/68 [00:01<00:17,  3.68it/s][4/6] extract embeddings:  10%|█         | 7/68 [00:01<00:09,  6.69it/s][4/6] extract embeddings:  13%|█▎        | 9/68 [00:01<00:06,  8.58it/s][4/6] extract embeddings:  18%|█▊        | 12/68 [00:01<00:04, 11.65it/s][4/6] extract embeddings:  21%|██        | 14/68 [00:01<00:04, 13.10it/s][4/6] extract embeddings:  25%|██▌       | 17/68 [00:01<00:03, 15.24it/s][4/6] extract embeddings:  29%|██▉       | 20/68 [00:02<00:02, 16.90it/s][4/6] extract embeddings:  34%|███▍      | 23/68 [00:02<00:02, 17.88it/s][4/6] extract embeddings:  38%|███▊      | 26/68 [00:02<00:02, 18.24it/s][4/6] extract embeddings:  43%|████▎     | 29/68 [00:02<00:02, 19.29it/s][4/6] extract embeddings:  47%|████▋     | 32/68 [00:02<00:01, 19.12it/s][4/6] extract embeddings:  51%|█████▏    | 35/68 [00:02<00:01, 19.21it/s][4/6] extract embeddings:  54%|█████▍    | 37/68 [00:03<00:01, 18.98it/s][4/6] extract embeddings:  57%|█████▋    | 39/68 [00:03<00:01, 18.53it/s][4/6] extract embeddings:  60%|██████    | 41/68 [00:03<00:01, 18.18it/s][4/6] extract embeddings:  63%|██████▎   | 43/68 [00:03<00:01, 17.99it/s][4/6] extract embeddings:  68%|██████▊   | 46/68 [00:03<00:01, 18.93it/s][4/6] extract embeddings:  72%|███████▏  | 49/68 [00:03<00:00, 19.84it/s][4/6] extract embeddings:  75%|███████▌  | 51/68 [00:03<00:00, 19.87it/s][4/6] extract embeddings:  79%|███████▉  | 54/68 [00:03<00:00, 19.64it/s][4/6] extract embeddings:  84%|████████▍ | 57/68 [00:04<00:00, 20.23it/s][4/6] extract embeddings:  88%|████████▊ | 60/68 [00:04<00:00, 19.77it/s][4/6] extract embeddings:  91%|█████████ | 62/68 [00:04<00:00, 19.21it/s][4/6] extract embeddings:  94%|█████████▍| 64/68 [00:04<00:00, 18.63it/s][4/6] extract embeddings:  97%|█████████▋| 66/68 [00:04<00:00, 18.12it/s][4/6] extract embeddings: 100%|██████████| 68/68 [00:04<00:00, 14.59it/s]
[NeMo I 2025-04-17 01:13:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:13:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:13:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:13:37 collections:880] Dataset successfully loaded with 6524 items and total duration provided from manifest is  1.71 hours.
[NeMo I 2025-04-17 01:13:37 collections:886] # 6524 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/102 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/102 [00:01<02:20,  1.39s/it][5/6] extract embeddings:   4%|▍         | 4/102 [00:01<00:28,  3.44it/s][5/6] extract embeddings:   7%|▋         | 7/102 [00:01<00:14,  6.47it/s][5/6] extract embeddings:  10%|▉         | 10/102 [00:01<00:09,  9.70it/s][5/6] extract embeddings:  13%|█▎        | 13/102 [00:01<00:07, 12.52it/s][5/6] extract embeddings:  16%|█▌        | 16/102 [00:01<00:05, 15.35it/s][5/6] extract embeddings:  19%|█▊        | 19/102 [00:02<00:04, 16.65it/s][5/6] extract embeddings:  22%|██▏       | 22/102 [00:02<00:04, 18.52it/s][5/6] extract embeddings:  25%|██▍       | 25/102 [00:02<00:03, 20.55it/s][5/6] extract embeddings:  27%|██▋       | 28/102 [00:02<00:03, 22.55it/s][5/6] extract embeddings:  30%|███       | 31/102 [00:02<00:03, 22.91it/s][5/6] extract embeddings:  33%|███▎      | 34/102 [00:02<00:02, 23.40it/s][5/6] extract embeddings:  36%|███▋      | 37/102 [00:02<00:02, 23.76it/s][5/6] extract embeddings:  39%|███▉      | 40/102 [00:02<00:02, 24.00it/s][5/6] extract embeddings:  42%|████▏     | 43/102 [00:03<00:02, 23.83it/s][5/6] extract embeddings:  45%|████▌     | 46/102 [00:03<00:02, 23.76it/s][5/6] extract embeddings:  48%|████▊     | 49/102 [00:03<00:02, 25.04it/s][5/6] extract embeddings:  51%|█████     | 52/102 [00:03<00:01, 25.28it/s][5/6] extract embeddings:  54%|█████▍    | 55/102 [00:03<00:01, 25.53it/s][5/6] extract embeddings:  57%|█████▋    | 58/102 [00:03<00:01, 26.00it/s][5/6] extract embeddings:  60%|█████▉    | 61/102 [00:03<00:01, 26.19it/s][5/6] extract embeddings:  63%|██████▎   | 64/102 [00:03<00:01, 26.12it/s][5/6] extract embeddings:  66%|██████▌   | 67/102 [00:03<00:01, 24.83it/s][5/6] extract embeddings:  69%|██████▊   | 70/102 [00:04<00:01, 24.95it/s][5/6] extract embeddings:  72%|███████▏  | 73/102 [00:04<00:01, 25.16it/s][5/6] extract embeddings:  75%|███████▍  | 76/102 [00:04<00:01, 25.36it/s][5/6] extract embeddings:  77%|███████▋  | 79/102 [00:04<00:00, 25.26it/s][5/6] extract embeddings:  80%|████████  | 82/102 [00:04<00:00, 24.44it/s][5/6] extract embeddings:  83%|████████▎ | 85/102 [00:04<00:00, 24.53it/s][5/6] extract embeddings:  86%|████████▋ | 88/102 [00:04<00:00, 24.39it/s][5/6] extract embeddings:  89%|████████▉ | 91/102 [00:04<00:00, 24.52it/s][5/6] extract embeddings:  92%|█████████▏| 94/102 [00:05<00:00, 24.65it/s][5/6] extract embeddings:  95%|█████████▌| 97/102 [00:05<00:00, 24.82it/s][5/6] extract embeddings:  98%|█████████▊| 100/102 [00:05<00:00, 23.00it/s][5/6] extract embeddings: 100%|██████████| 102/102 [00:05<00:00, 18.55it/s]
[NeMo I 2025-04-17 01:13:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:13:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:13:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:13:42 collections:880] Dataset successfully loaded with 13292 items and total duration provided from manifest is  1.80 hours.
[NeMo I 2025-04-17 01:13:42 collections:886] # 13292 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/208 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/208 [00:01<04:10,  1.21s/it][6/6] extract embeddings:   2%|▏         | 5/208 [00:01<00:41,  4.91it/s][6/6] extract embeddings:   4%|▍         | 9/208 [00:01<00:21,  9.36it/s][6/6] extract embeddings:   6%|▋         | 13/208 [00:01<00:14, 13.73it/s][6/6] extract embeddings:   8%|▊         | 17/208 [00:01<00:10, 18.15it/s][6/6] extract embeddings:  10%|█         | 21/208 [00:01<00:08, 21.02it/s][6/6] extract embeddings:  12%|█▏        | 25/208 [00:01<00:07, 23.84it/s][6/6] extract embeddings:  14%|█▍        | 29/208 [00:02<00:06, 26.39it/s][6/6] extract embeddings:  16%|█▌        | 33/208 [00:02<00:06, 28.06it/s][6/6] extract embeddings:  18%|█▊        | 37/208 [00:02<00:05, 29.05it/s][6/6] extract embeddings:  20%|█▉        | 41/208 [00:02<00:05, 30.82it/s][6/6] extract embeddings:  22%|██▏       | 45/208 [00:02<00:05, 31.65it/s][6/6] extract embeddings:  24%|██▎       | 49/208 [00:02<00:04, 32.67it/s][6/6] extract embeddings:  25%|██▌       | 53/208 [00:02<00:04, 32.29it/s][6/6] extract embeddings:  27%|██▋       | 57/208 [00:02<00:05, 29.79it/s][6/6] extract embeddings:  29%|██▉       | 61/208 [00:03<00:04, 30.54it/s][6/6] extract embeddings:  31%|███▏      | 65/208 [00:03<00:04, 30.53it/s][6/6] extract embeddings:  33%|███▎      | 69/208 [00:03<00:04, 31.32it/s][6/6] extract embeddings:  35%|███▌      | 73/208 [00:03<00:04, 30.34it/s][6/6] extract embeddings:  37%|███▋      | 77/208 [00:03<00:04, 31.20it/s][6/6] extract embeddings:  39%|███▉      | 81/208 [00:03<00:04, 31.30it/s][6/6] extract embeddings:  41%|████      | 85/208 [00:03<00:04, 27.42it/s][6/6] extract embeddings:  42%|████▏     | 88/208 [00:03<00:04, 26.33it/s][6/6] extract embeddings:  44%|████▍     | 91/208 [00:04<00:04, 26.45it/s][6/6] extract embeddings:  45%|████▌     | 94/208 [00:04<00:04, 26.04it/s][6/6] extract embeddings:  47%|████▋     | 98/208 [00:04<00:04, 27.35it/s][6/6] extract embeddings:  49%|████▊     | 101/208 [00:04<00:03, 26.93it/s][6/6] extract embeddings:  50%|█████     | 104/208 [00:04<00:03, 26.62it/s][6/6] extract embeddings:  51%|█████▏    | 107/208 [00:04<00:03, 26.12it/s][6/6] extract embeddings:  53%|█████▎    | 111/208 [00:04<00:03, 26.51it/s][6/6] extract embeddings:  55%|█████▍    | 114/208 [00:04<00:03, 25.08it/s][6/6] extract embeddings:  56%|█████▋    | 117/208 [00:05<00:03, 25.06it/s][6/6] extract embeddings:  58%|█████▊    | 120/208 [00:05<00:03, 23.52it/s][6/6] extract embeddings:  59%|█████▉    | 123/208 [00:05<00:03, 24.33it/s][6/6] extract embeddings:  61%|██████    | 126/208 [00:05<00:03, 24.98it/s][6/6] extract embeddings:  62%|██████▏   | 129/208 [00:05<00:03, 25.62it/s][6/6] extract embeddings:  63%|██████▎   | 132/208 [00:05<00:03, 24.91it/s][6/6] extract embeddings:  65%|██████▍   | 135/208 [00:05<00:02, 24.86it/s][6/6] extract embeddings:  66%|██████▋   | 138/208 [00:05<00:02, 24.71it/s][6/6] extract embeddings:  68%|██████▊   | 141/208 [00:06<00:02, 23.80it/s][6/6] extract embeddings:  69%|██████▉   | 144/208 [00:06<00:02, 24.76it/s][6/6] extract embeddings:  71%|███████   | 147/208 [00:06<00:02, 24.64it/s][6/6] extract embeddings:  72%|███████▏  | 150/208 [00:06<00:02, 24.80it/s][6/6] extract embeddings:  74%|███████▎  | 153/208 [00:06<00:02, 25.19it/s][6/6] extract embeddings:  75%|███████▌  | 156/208 [00:06<00:02, 24.58it/s][6/6] extract embeddings:  76%|███████▋  | 159/208 [00:06<00:02, 24.25it/s][6/6] extract embeddings:  78%|███████▊  | 162/208 [00:06<00:01, 24.43it/s][6/6] extract embeddings:  79%|███████▉  | 165/208 [00:07<00:01, 24.21it/s][6/6] extract embeddings:  81%|████████  | 168/208 [00:07<00:01, 25.70it/s][6/6] extract embeddings:  82%|████████▏ | 171/208 [00:07<00:01, 26.74it/s][6/6] extract embeddings:  84%|████████▍ | 175/208 [00:07<00:01, 27.11it/s][6/6] extract embeddings:  86%|████████▌ | 178/208 [00:07<00:01, 26.29it/s][6/6] extract embeddings:  87%|████████▋ | 181/208 [00:07<00:01, 25.59it/s][6/6] extract embeddings:  88%|████████▊ | 184/208 [00:07<00:00, 24.93it/s][6/6] extract embeddings:  90%|████████▉ | 187/208 [00:07<00:00, 25.14it/s][6/6] extract embeddings:  91%|█████████▏| 190/208 [00:08<00:00, 25.69it/s][6/6] extract embeddings:  93%|█████████▎| 193/208 [00:08<00:00, 25.45it/s][6/6] extract embeddings:  94%|█████████▍| 196/208 [00:08<00:00, 24.88it/s][6/6] extract embeddings:  96%|█████████▌| 199/208 [00:08<00:00, 25.22it/s][6/6] extract embeddings:  97%|█████████▋| 202/208 [00:08<00:00, 24.31it/s][6/6] extract embeddings:  99%|█████████▊| 205/208 [00:08<00:00, 24.27it/s][6/6] extract embeddings: 100%|██████████| 208/208 [00:08<00:00, 24.12it/s][6/6] extract embeddings: 100%|██████████| 208/208 [00:08<00:00, 23.64it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.11it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.26it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.83it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.36it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s]
[NeMo I 2025-04-17 01:13:54 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:13:55 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              41.455011   444.120  ...   15.079984  3.395475
    Harker-ES                       31.731193  2178.782  ...   71.109874  3.263744
    Harker-MN                       44.714223   366.767  ...   31.261030  8.523403
    Longfellow-Block-1              25.560646   492.417  ...   10.786968  2.190616
    TOTAL                           33.466304  3482.086  ...  128.237856  3.682788
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:13:55 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0822 | MISS: 0.2156 | CER: 0.0368 | DER: 0.3347 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.45, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.45, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.93s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  2.00s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.28s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.20s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:14:07 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:14:07 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:14:07 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:14:07 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:14:07 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:14:08 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:14:08 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:14:08 features:305] PADDING: 16
[NeMo I 2025-04-17 01:14:08 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:14:09 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:14:09 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:14:09 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:14:09 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:14:09 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:14:09 collections:880] Dataset successfully loaded with 2247 items and total duration provided from manifest is  1.41 hours.
[NeMo I 2025-04-17 01:14:09 collections:886] # 2247 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/36 [00:02<01:13,  2.10s/it][1/6] extract embeddings:  11%|█         | 4/36 [00:02<00:13,  2.32it/s][1/6] extract embeddings:  17%|█▋        | 6/36 [00:02<00:08,  3.65it/s][1/6] extract embeddings:  22%|██▏       | 8/36 [00:02<00:05,  5.20it/s][1/6] extract embeddings:  28%|██▊       | 10/36 [00:02<00:03,  6.71it/s][1/6] extract embeddings:  33%|███▎      | 12/36 [00:02<00:02,  8.06it/s][1/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:02,  9.64it/s][1/6] extract embeddings:  44%|████▍     | 16/36 [00:03<00:01, 10.80it/s][1/6] extract embeddings:  50%|█████     | 18/36 [00:03<00:01, 12.04it/s][1/6] extract embeddings:  56%|█████▌    | 20/36 [00:03<00:01, 13.06it/s][1/6] extract embeddings:  61%|██████    | 22/36 [00:03<00:01, 13.22it/s][1/6] extract embeddings:  67%|██████▋   | 24/36 [00:03<00:00, 13.72it/s][1/6] extract embeddings:  72%|███████▏  | 26/36 [00:03<00:00, 14.01it/s][1/6] extract embeddings:  78%|███████▊  | 28/36 [00:03<00:00, 13.83it/s][1/6] extract embeddings:  83%|████████▎ | 30/36 [00:03<00:00, 13.75it/s][1/6] extract embeddings:  89%|████████▉ | 32/36 [00:04<00:00, 13.84it/s][1/6] extract embeddings:  94%|█████████▍| 34/36 [00:04<00:00, 13.73it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00, 14.51it/s][1/6] extract embeddings: 100%|██████████| 36/36 [00:04<00:00,  8.11it/s]
[NeMo I 2025-04-17 01:14:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:14:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:14:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:14:13 collections:880] Dataset successfully loaded with 2643 items and total duration provided from manifest is  1.47 hours.
[NeMo I 2025-04-17 01:14:13 collections:886] # 2643 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/42 [00:01<01:01,  1.50s/it][2/6] extract embeddings:   7%|▋         | 3/42 [00:01<00:17,  2.28it/s][2/6] extract embeddings:  12%|█▏        | 5/42 [00:01<00:09,  3.99it/s][2/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:06,  5.77it/s][2/6] extract embeddings:  21%|██▏       | 9/42 [00:02<00:04,  7.71it/s][2/6] extract embeddings:  26%|██▌       | 11/42 [00:02<00:03,  9.52it/s][2/6] extract embeddings:  31%|███       | 13/42 [00:02<00:02, 10.83it/s][2/6] extract embeddings:  36%|███▌      | 15/42 [00:02<00:02, 12.02it/s][2/6] extract embeddings:  40%|████      | 17/42 [00:02<00:01, 12.74it/s][2/6] extract embeddings:  45%|████▌     | 19/42 [00:02<00:01, 13.33it/s][2/6] extract embeddings:  50%|█████     | 21/42 [00:02<00:01, 14.43it/s][2/6] extract embeddings:  55%|█████▍    | 23/42 [00:02<00:01, 14.91it/s][2/6] extract embeddings:  60%|█████▉    | 25/42 [00:03<00:01, 14.51it/s][2/6] extract embeddings:  64%|██████▍   | 27/42 [00:03<00:01, 14.39it/s][2/6] extract embeddings:  69%|██████▉   | 29/42 [00:03<00:00, 14.74it/s][2/6] extract embeddings:  74%|███████▍  | 31/42 [00:03<00:00, 14.18it/s][2/6] extract embeddings:  79%|███████▊  | 33/42 [00:03<00:00, 14.50it/s][2/6] extract embeddings:  83%|████████▎ | 35/42 [00:03<00:00, 14.44it/s][2/6] extract embeddings:  88%|████████▊ | 37/42 [00:03<00:00, 14.54it/s][2/6] extract embeddings:  93%|█████████▎| 39/42 [00:04<00:00, 14.86it/s][2/6] extract embeddings:  98%|█████████▊| 41/42 [00:04<00:00, 15.11it/s][2/6] extract embeddings: 100%|██████████| 42/42 [00:04<00:00,  9.98it/s]
[NeMo I 2025-04-17 01:14:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:14:18 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:14:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:14:18 collections:880] Dataset successfully loaded with 3221 items and total duration provided from manifest is  1.52 hours.
[NeMo I 2025-04-17 01:14:18 collections:886] # 3221 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/51 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/51 [00:01<01:00,  1.22s/it][3/6] extract embeddings:   6%|▌         | 3/51 [00:01<00:17,  2.81it/s][3/6] extract embeddings:  10%|▉         | 5/51 [00:01<00:09,  4.86it/s][3/6] extract embeddings:  14%|█▎        | 7/51 [00:01<00:06,  6.90it/s][3/6] extract embeddings:  18%|█▊        | 9/51 [00:01<00:04,  8.98it/s][3/6] extract embeddings:  22%|██▏       | 11/51 [00:01<00:03, 10.58it/s][3/6] extract embeddings:  25%|██▌       | 13/51 [00:01<00:03, 11.82it/s][3/6] extract embeddings:  29%|██▉       | 15/51 [00:02<00:02, 12.91it/s][3/6] extract embeddings:  33%|███▎      | 17/51 [00:02<00:02, 13.92it/s][3/6] extract embeddings:  37%|███▋      | 19/51 [00:02<00:02, 14.81it/s][3/6] extract embeddings:  41%|████      | 21/51 [00:02<00:01, 15.22it/s][3/6] extract embeddings:  45%|████▌     | 23/51 [00:02<00:01, 15.75it/s][3/6] extract embeddings:  49%|████▉     | 25/51 [00:02<00:01, 16.43it/s][3/6] extract embeddings:  53%|█████▎    | 27/51 [00:02<00:01, 16.24it/s][3/6] extract embeddings:  57%|█████▋    | 29/51 [00:02<00:01, 16.70it/s][3/6] extract embeddings:  61%|██████    | 31/51 [00:03<00:01, 16.36it/s][3/6] extract embeddings:  65%|██████▍   | 33/51 [00:03<00:01, 16.45it/s][3/6] extract embeddings:  69%|██████▊   | 35/51 [00:03<00:00, 16.44it/s][3/6] extract embeddings:  73%|███████▎  | 37/51 [00:03<00:00, 16.40it/s][3/6] extract embeddings:  76%|███████▋  | 39/51 [00:03<00:00, 16.02it/s][3/6] extract embeddings:  80%|████████  | 41/51 [00:03<00:00, 15.90it/s][3/6] extract embeddings:  84%|████████▍ | 43/51 [00:03<00:00, 15.87it/s][3/6] extract embeddings:  88%|████████▊ | 45/51 [00:03<00:00, 16.39it/s][3/6] extract embeddings:  92%|█████████▏| 47/51 [00:04<00:00, 16.13it/s][3/6] extract embeddings:  96%|█████████▌| 49/51 [00:04<00:00, 15.97it/s][3/6] extract embeddings: 100%|██████████| 51/51 [00:04<00:00, 11.99it/s]
[NeMo I 2025-04-17 01:14:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:14:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:14:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:14:22 collections:880] Dataset successfully loaded with 4272 items and total duration provided from manifest is  1.60 hours.
[NeMo I 2025-04-17 01:14:22 collections:886] # 4272 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/67 [00:00<?, ?it/s][4/6] extract embeddings:   1%|▏         | 1/67 [00:01<01:21,  1.23s/it][4/6] extract embeddings:   6%|▌         | 4/67 [00:01<00:17,  3.65it/s][4/6] extract embeddings:   9%|▉         | 6/67 [00:01<00:10,  5.58it/s][4/6] extract embeddings:  13%|█▎        | 9/67 [00:01<00:06,  8.67it/s][4/6] extract embeddings:  16%|█▋        | 11/67 [00:01<00:05, 10.38it/s][4/6] extract embeddings:  19%|█▉        | 13/67 [00:01<00:04, 11.67it/s][4/6] extract embeddings:  22%|██▏       | 15/67 [00:01<00:03, 13.17it/s][4/6] extract embeddings:  25%|██▌       | 17/67 [00:02<00:03, 14.07it/s][4/6] extract embeddings:  28%|██▊       | 19/67 [00:02<00:03, 14.84it/s][4/6] extract embeddings:  31%|███▏      | 21/67 [00:02<00:02, 15.87it/s][4/6] extract embeddings:  34%|███▍      | 23/67 [00:02<00:02, 16.57it/s][4/6] extract embeddings:  37%|███▋      | 25/67 [00:02<00:02, 17.07it/s][4/6] extract embeddings:  42%|████▏     | 28/67 [00:02<00:02, 18.48it/s][4/6] extract embeddings:  45%|████▍     | 30/67 [00:02<00:02, 17.65it/s][4/6] extract embeddings:  48%|████▊     | 32/67 [00:02<00:02, 16.76it/s][4/6] extract embeddings:  51%|█████     | 34/67 [00:03<00:02, 16.43it/s][4/6] extract embeddings:  54%|█████▎    | 36/67 [00:03<00:01, 16.56it/s][4/6] extract embeddings:  57%|█████▋    | 38/67 [00:03<00:01, 16.35it/s][4/6] extract embeddings:  60%|█████▉    | 40/67 [00:03<00:01, 16.25it/s][4/6] extract embeddings:  63%|██████▎   | 42/67 [00:03<00:01, 16.59it/s][4/6] extract embeddings:  66%|██████▌   | 44/67 [00:03<00:01, 16.78it/s][4/6] extract embeddings:  69%|██████▊   | 46/67 [00:03<00:01, 16.91it/s][4/6] extract embeddings:  72%|███████▏  | 48/67 [00:03<00:01, 17.01it/s][4/6] extract embeddings:  75%|███████▍  | 50/67 [00:04<00:00, 17.08it/s][4/6] extract embeddings:  78%|███████▊  | 52/67 [00:04<00:00, 17.13it/s][4/6] extract embeddings:  81%|████████  | 54/67 [00:04<00:00, 16.65it/s][4/6] extract embeddings:  84%|████████▎ | 56/67 [00:04<00:00, 16.77it/s][4/6] extract embeddings:  87%|████████▋ | 58/67 [00:04<00:00, 16.96it/s][4/6] extract embeddings:  90%|████████▉ | 60/67 [00:04<00:00, 17.53it/s][4/6] extract embeddings:  94%|█████████▍| 63/67 [00:04<00:00, 19.33it/s][4/6] extract embeddings:  97%|█████████▋| 65/67 [00:04<00:00, 19.48it/s][4/6] extract embeddings: 100%|██████████| 67/67 [00:04<00:00, 13.55it/s]
[NeMo I 2025-04-17 01:14:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:14:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:14:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:14:27 collections:880] Dataset successfully loaded with 6431 items and total duration provided from manifest is  1.68 hours.
[NeMo I 2025-04-17 01:14:27 collections:886] # 6431 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/101 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/101 [00:01<01:59,  1.19s/it][5/6] extract embeddings:   4%|▍         | 4/101 [00:01<00:25,  3.80it/s][5/6] extract embeddings:   6%|▌         | 6/101 [00:01<00:16,  5.82it/s][5/6] extract embeddings:   8%|▊         | 8/101 [00:01<00:11,  7.94it/s][5/6] extract embeddings:  10%|▉         | 10/101 [00:01<00:09, 10.00it/s][5/6] extract embeddings:  12%|█▏        | 12/101 [00:01<00:07, 11.98it/s][5/6] extract embeddings:  15%|█▍        | 15/101 [00:01<00:05, 14.77it/s][5/6] extract embeddings:  18%|█▊        | 18/101 [00:01<00:04, 17.99it/s][5/6] extract embeddings:  21%|██        | 21/101 [00:02<00:03, 20.12it/s][5/6] extract embeddings:  24%|██▍       | 24/101 [00:02<00:03, 21.99it/s][5/6] extract embeddings:  27%|██▋       | 27/101 [00:02<00:03, 23.04it/s][5/6] extract embeddings:  30%|██▉       | 30/101 [00:02<00:03, 22.90it/s][5/6] extract embeddings:  33%|███▎      | 33/101 [00:02<00:02, 23.21it/s][5/6] extract embeddings:  36%|███▌      | 36/101 [00:02<00:02, 23.86it/s][5/6] extract embeddings:  39%|███▊      | 39/101 [00:02<00:02, 25.17it/s][5/6] extract embeddings:  42%|████▏     | 42/101 [00:02<00:02, 25.48it/s][5/6] extract embeddings:  45%|████▍     | 45/101 [00:03<00:02, 25.24it/s][5/6] extract embeddings:  48%|████▊     | 48/101 [00:03<00:02, 25.48it/s][5/6] extract embeddings:  50%|█████     | 51/101 [00:03<00:01, 25.28it/s][5/6] extract embeddings:  53%|█████▎    | 54/101 [00:03<00:01, 25.79it/s][5/6] extract embeddings:  56%|█████▋    | 57/101 [00:03<00:01, 26.56it/s][5/6] extract embeddings:  59%|█████▉    | 60/101 [00:03<00:01, 26.07it/s][5/6] extract embeddings:  62%|██████▏   | 63/101 [00:03<00:01, 24.95it/s][5/6] extract embeddings:  65%|██████▌   | 66/101 [00:03<00:01, 25.11it/s][5/6] extract embeddings:  68%|██████▊   | 69/101 [00:04<00:01, 24.70it/s][5/6] extract embeddings:  71%|███████▏  | 72/101 [00:04<00:01, 24.39it/s][5/6] extract embeddings:  74%|███████▍  | 75/101 [00:04<00:01, 24.02it/s][5/6] extract embeddings:  77%|███████▋  | 78/101 [00:04<00:00, 25.03it/s][5/6] extract embeddings:  80%|████████  | 81/101 [00:04<00:00, 25.02it/s][5/6] extract embeddings:  83%|████████▎ | 84/101 [00:04<00:00, 24.63it/s][5/6] extract embeddings:  86%|████████▌ | 87/101 [00:04<00:00, 25.39it/s][5/6] extract embeddings:  89%|████████▉ | 90/101 [00:04<00:00, 25.52it/s][5/6] extract embeddings:  92%|█████████▏| 93/101 [00:04<00:00, 24.86it/s][5/6] extract embeddings:  95%|█████████▌| 96/101 [00:05<00:00, 24.90it/s][5/6] extract embeddings:  98%|█████████▊| 99/101 [00:05<00:00, 25.57it/s][5/6] extract embeddings: 100%|██████████| 101/101 [00:05<00:00, 19.11it/s]
[NeMo I 2025-04-17 01:14:33 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:14:33 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:14:33 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:14:33 collections:880] Dataset successfully loaded with 13094 items and total duration provided from manifest is  1.77 hours.
[NeMo I 2025-04-17 01:14:33 collections:886] # 13094 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/205 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/205 [00:01<04:22,  1.29s/it][6/6] extract embeddings:   2%|▏         | 4/205 [00:01<00:54,  3.67it/s][6/6] extract embeddings:   3%|▎         | 7/205 [00:01<00:28,  6.86it/s][6/6] extract embeddings:   5%|▍         | 10/205 [00:01<00:19, 10.14it/s][6/6] extract embeddings:   6%|▋         | 13/205 [00:01<00:14, 13.49it/s][6/6] extract embeddings:   8%|▊         | 16/205 [00:01<00:11, 16.63it/s][6/6] extract embeddings:   9%|▉         | 19/205 [00:01<00:09, 19.40it/s][6/6] extract embeddings:  11%|█         | 22/205 [00:02<00:08, 20.68it/s][6/6] extract embeddings:  12%|█▏        | 25/205 [00:02<00:08, 22.30it/s][6/6] extract embeddings:  14%|█▎        | 28/205 [00:02<00:07, 23.75it/s][6/6] extract embeddings:  15%|█▌        | 31/205 [00:02<00:07, 24.12it/s][6/6] extract embeddings:  17%|█▋        | 34/205 [00:02<00:07, 24.34it/s][6/6] extract embeddings:  18%|█▊        | 37/205 [00:02<00:07, 23.64it/s][6/6] extract embeddings:  20%|█▉        | 40/205 [00:02<00:06, 24.04it/s][6/6] extract embeddings:  21%|██        | 43/205 [00:02<00:06, 24.08it/s][6/6] extract embeddings:  22%|██▏       | 46/205 [00:03<00:06, 23.88it/s][6/6] extract embeddings:  24%|██▍       | 50/205 [00:03<00:06, 25.64it/s][6/6] extract embeddings:  26%|██▌       | 53/205 [00:03<00:06, 25.22it/s][6/6] extract embeddings:  27%|██▋       | 56/205 [00:03<00:05, 25.19it/s][6/6] extract embeddings:  29%|██▉       | 59/205 [00:03<00:05, 25.90it/s][6/6] extract embeddings:  30%|███       | 62/205 [00:03<00:05, 26.77it/s][6/6] extract embeddings:  32%|███▏      | 66/205 [00:03<00:04, 28.01it/s][6/6] extract embeddings:  34%|███▍      | 70/205 [00:03<00:04, 29.00it/s][6/6] extract embeddings:  36%|███▌      | 74/205 [00:03<00:04, 29.95it/s][6/6] extract embeddings:  38%|███▊      | 77/205 [00:04<00:04, 27.56it/s][6/6] extract embeddings:  39%|███▉      | 80/205 [00:04<00:04, 27.50it/s][6/6] extract embeddings:  41%|████      | 84/205 [00:04<00:04, 28.50it/s][6/6] extract embeddings:  43%|████▎     | 88/205 [00:04<00:04, 29.22it/s][6/6] extract embeddings:  45%|████▍     | 92/205 [00:04<00:03, 30.93it/s][6/6] extract embeddings:  47%|████▋     | 96/205 [00:04<00:03, 30.94it/s][6/6] extract embeddings:  49%|████▉     | 100/205 [00:04<00:03, 28.56it/s][6/6] extract embeddings:  50%|█████     | 103/205 [00:05<00:03, 27.35it/s][6/6] extract embeddings:  52%|█████▏    | 106/205 [00:05<00:03, 26.31it/s][6/6] extract embeddings:  53%|█████▎    | 109/205 [00:05<00:03, 27.17it/s][6/6] extract embeddings:  55%|█████▍    | 112/205 [00:05<00:03, 26.98it/s][6/6] extract embeddings:  56%|█████▌    | 115/205 [00:05<00:03, 26.63it/s][6/6] extract embeddings:  58%|█████▊    | 118/205 [00:05<00:03, 25.14it/s][6/6] extract embeddings:  59%|█████▉    | 121/205 [00:05<00:03, 23.28it/s][6/6] extract embeddings:  60%|██████    | 124/205 [00:05<00:03, 23.85it/s][6/6] extract embeddings:  62%|██████▏   | 127/205 [00:06<00:03, 24.32it/s][6/6] extract embeddings:  63%|██████▎   | 130/205 [00:06<00:03, 23.79it/s][6/6] extract embeddings:  65%|██████▍   | 133/205 [00:06<00:03, 21.42it/s][6/6] extract embeddings:  66%|██████▋   | 136/205 [00:06<00:03, 21.35it/s][6/6] extract embeddings:  68%|██████▊   | 139/205 [00:06<00:03, 21.70it/s][6/6] extract embeddings:  70%|██████▉   | 143/205 [00:06<00:02, 24.17it/s][6/6] extract embeddings:  71%|███████   | 146/205 [00:06<00:02, 23.35it/s][6/6] extract embeddings:  73%|███████▎  | 149/205 [00:06<00:02, 24.13it/s][6/6] extract embeddings:  74%|███████▍  | 152/205 [00:07<00:02, 25.48it/s][6/6] extract embeddings:  76%|███████▌  | 155/205 [00:07<00:01, 26.09it/s][6/6] extract embeddings:  77%|███████▋  | 158/205 [00:07<00:01, 24.93it/s][6/6] extract embeddings:  79%|███████▉  | 162/205 [00:07<00:01, 26.64it/s][6/6] extract embeddings:  80%|████████  | 165/205 [00:07<00:01, 26.62it/s][6/6] extract embeddings:  82%|████████▏ | 168/205 [00:07<00:01, 25.75it/s][6/6] extract embeddings:  83%|████████▎ | 171/205 [00:07<00:01, 26.57it/s][6/6] extract embeddings:  85%|████████▍ | 174/205 [00:07<00:01, 27.19it/s][6/6] extract embeddings:  86%|████████▋ | 177/205 [00:08<00:01, 26.90it/s][6/6] extract embeddings:  88%|████████▊ | 180/205 [00:08<00:00, 25.60it/s][6/6] extract embeddings:  89%|████████▉ | 183/205 [00:08<00:00, 25.75it/s][6/6] extract embeddings:  91%|█████████ | 186/205 [00:08<00:00, 24.06it/s][6/6] extract embeddings:  92%|█████████▏| 189/205 [00:08<00:00, 24.45it/s][6/6] extract embeddings:  94%|█████████▎| 192/205 [00:08<00:00, 24.33it/s][6/6] extract embeddings:  96%|█████████▌| 196/205 [00:08<00:00, 27.15it/s][6/6] extract embeddings:  98%|█████████▊| 200/205 [00:08<00:00, 28.71it/s][6/6] extract embeddings:  99%|█████████▉| 203/205 [00:09<00:00, 27.41it/s][6/6] extract embeddings: 100%|██████████| 205/205 [00:09<00:00, 22.52it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.18it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.29it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.88it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.46it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.09it/s]
[NeMo I 2025-04-17 01:14:44 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:14:45 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              41.253505   444.120  ...   14.075009  3.169191
    Harker-ES                       33.592464  2178.782  ...   91.314608  4.191085
    Harker-MN                       44.300355   366.767  ...   29.783028  8.120422
    Longfellow-Block-1              26.388174   492.417  ...    9.659986  1.961749
    TOTAL                           34.678654  3482.086  ...  144.832631  4.159364
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:14:45 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0797 | MISS: 0.2255 | CER: 0.0416 | DER: 0.3468 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.50, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.5, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.98s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.98s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.27s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.20s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:14:58 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:14:58 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:14:58 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:14:58 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:14:58 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:14:59 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:14:59 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:14:59 features:305] PADDING: 16
[NeMo I 2025-04-17 01:14:59 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:14:59 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:14:59 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:14:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:14:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:14:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:14:59 collections:880] Dataset successfully loaded with 2234 items and total duration provided from manifest is  1.37 hours.
[NeMo I 2025-04-17 01:14:59 collections:886] # 2234 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:08,  2.03s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:12,  2.42it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:07,  3.82it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:04,  5.45it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.93it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  8.41it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02, 10.03it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 11.58it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 12.43it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 13.65it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:00, 14.17it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 14.92it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 14.69it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:03<00:00, 14.24it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:03<00:00, 13.93it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:03<00:00, 14.15it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 13.80it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  8.29it/s]
[NeMo I 2025-04-17 01:15:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:15:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:15:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:15:03 collections:880] Dataset successfully loaded with 2625 items and total duration provided from manifest is  1.43 hours.
[NeMo I 2025-04-17 01:15:03 collections:886] # 2625 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:59,  1.44s/it][2/6] extract embeddings:   7%|▋         | 3/42 [00:01<00:16,  2.39it/s][2/6] extract embeddings:  12%|█▏        | 5/42 [00:01<00:08,  4.15it/s][2/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:05,  5.91it/s][2/6] extract embeddings:  21%|██▏       | 9/42 [00:01<00:04,  7.66it/s][2/6] extract embeddings:  26%|██▌       | 11/42 [00:02<00:03,  9.34it/s][2/6] extract embeddings:  31%|███       | 13/42 [00:02<00:02, 10.43it/s][2/6] extract embeddings:  36%|███▌      | 15/42 [00:02<00:02, 11.52it/s][2/6] extract embeddings:  40%|████      | 17/42 [00:02<00:02, 12.34it/s][2/6] extract embeddings:  45%|████▌     | 19/42 [00:02<00:01, 12.76it/s][2/6] extract embeddings:  50%|█████     | 21/42 [00:02<00:01, 13.60it/s][2/6] extract embeddings:  55%|█████▍    | 23/42 [00:02<00:01, 14.52it/s][2/6] extract embeddings:  60%|█████▉    | 25/42 [00:03<00:01, 14.69it/s][2/6] extract embeddings:  64%|██████▍   | 27/42 [00:03<00:01, 14.86it/s][2/6] extract embeddings:  69%|██████▉   | 29/42 [00:03<00:00, 15.22it/s][2/6] extract embeddings:  74%|███████▍  | 31/42 [00:03<00:00, 14.94it/s][2/6] extract embeddings:  79%|███████▊  | 33/42 [00:03<00:00, 15.13it/s][2/6] extract embeddings:  83%|████████▎ | 35/42 [00:03<00:00, 14.48it/s][2/6] extract embeddings:  88%|████████▊ | 37/42 [00:03<00:00, 14.71it/s][2/6] extract embeddings:  93%|█████████▎| 39/42 [00:03<00:00, 14.54it/s][2/6] extract embeddings:  98%|█████████▊| 41/42 [00:04<00:00, 14.59it/s][2/6] extract embeddings: 100%|██████████| 42/42 [00:04<00:00,  9.94it/s]
[NeMo I 2025-04-17 01:15:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:15:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:15:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:15:08 collections:880] Dataset successfully loaded with 3192 items and total duration provided from manifest is  1.49 hours.
[NeMo I 2025-04-17 01:15:08 collections:886] # 3192 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/50 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/50 [00:01<00:59,  1.21s/it][3/6] extract embeddings:   6%|▌         | 3/50 [00:01<00:16,  2.84it/s][3/6] extract embeddings:  10%|█         | 5/50 [00:01<00:08,  5.01it/s][3/6] extract embeddings:  14%|█▍        | 7/50 [00:01<00:05,  7.22it/s][3/6] extract embeddings:  20%|██        | 10/50 [00:01<00:03, 10.48it/s][3/6] extract embeddings:  26%|██▌       | 13/50 [00:01<00:02, 12.67it/s][3/6] extract embeddings:  32%|███▏      | 16/50 [00:01<00:02, 14.48it/s][3/6] extract embeddings:  36%|███▌      | 18/50 [00:02<00:02, 15.49it/s][3/6] extract embeddings:  40%|████      | 20/50 [00:02<00:01, 15.94it/s][3/6] extract embeddings:  44%|████▍     | 22/50 [00:02<00:01, 16.84it/s][3/6] extract embeddings:  48%|████▊     | 24/50 [00:02<00:01, 17.00it/s][3/6] extract embeddings:  52%|█████▏    | 26/50 [00:02<00:01, 17.05it/s][3/6] extract embeddings:  56%|█████▌    | 28/50 [00:02<00:01, 16.94it/s][3/6] extract embeddings:  60%|██████    | 30/50 [00:02<00:01, 16.69it/s][3/6] extract embeddings:  64%|██████▍   | 32/50 [00:02<00:01, 16.46it/s][3/6] extract embeddings:  68%|██████▊   | 34/50 [00:03<00:00, 16.42it/s][3/6] extract embeddings:  72%|███████▏  | 36/50 [00:03<00:00, 16.54it/s][3/6] extract embeddings:  76%|███████▌  | 38/50 [00:03<00:00, 16.70it/s][3/6] extract embeddings:  80%|████████  | 40/50 [00:03<00:00, 16.59it/s][3/6] extract embeddings:  84%|████████▍ | 42/50 [00:03<00:00, 16.39it/s][3/6] extract embeddings:  88%|████████▊ | 44/50 [00:03<00:00, 16.50it/s][3/6] extract embeddings:  92%|█████████▏| 46/50 [00:03<00:00, 16.46it/s][3/6] extract embeddings:  96%|█████████▌| 48/50 [00:03<00:00, 17.03it/s][3/6] extract embeddings: 100%|██████████| 50/50 [00:03<00:00, 17.41it/s][3/6] extract embeddings: 100%|██████████| 50/50 [00:04<00:00, 12.45it/s]
[NeMo I 2025-04-17 01:15:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:15:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:15:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:15:12 collections:880] Dataset successfully loaded with 4213 items and total duration provided from manifest is  1.56 hours.
[NeMo I 2025-04-17 01:15:12 collections:886] # 4213 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/66 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/66 [00:01<01:19,  1.22s/it][4/6] extract embeddings:   6%|▌         | 4/66 [00:01<00:16,  3.71it/s][4/6] extract embeddings:   9%|▉         | 6/66 [00:01<00:10,  5.60it/s][4/6] extract embeddings:  12%|█▏        | 8/66 [00:01<00:07,  7.61it/s][4/6] extract embeddings:  15%|█▌        | 10/66 [00:01<00:05,  9.54it/s][4/6] extract embeddings:  18%|█▊        | 12/66 [00:01<00:04, 11.43it/s][4/6] extract embeddings:  21%|██        | 14/66 [00:01<00:03, 13.24it/s][4/6] extract embeddings:  24%|██▍       | 16/66 [00:02<00:03, 14.46it/s][4/6] extract embeddings:  27%|██▋       | 18/66 [00:02<00:03, 15.53it/s][4/6] extract embeddings:  30%|███       | 20/66 [00:02<00:02, 16.60it/s][4/6] extract embeddings:  33%|███▎      | 22/66 [00:02<00:02, 17.06it/s][4/6] extract embeddings:  36%|███▋      | 24/66 [00:02<00:02, 17.43it/s][4/6] extract embeddings:  39%|███▉      | 26/66 [00:02<00:02, 17.41it/s][4/6] extract embeddings:  44%|████▍     | 29/66 [00:02<00:02, 17.93it/s][4/6] extract embeddings:  47%|████▋     | 31/66 [00:02<00:01, 17.66it/s][4/6] extract embeddings:  52%|█████▏    | 34/66 [00:02<00:01, 18.76it/s][4/6] extract embeddings:  56%|█████▌    | 37/66 [00:03<00:01, 19.60it/s][4/6] extract embeddings:  59%|█████▉    | 39/66 [00:03<00:01, 18.95it/s][4/6] extract embeddings:  62%|██████▏   | 41/66 [00:03<00:01, 19.04it/s][4/6] extract embeddings:  65%|██████▌   | 43/66 [00:03<00:01, 19.28it/s][4/6] extract embeddings:  68%|██████▊   | 45/66 [00:03<00:01, 18.34it/s][4/6] extract embeddings:  71%|███████   | 47/66 [00:03<00:01, 17.83it/s][4/6] extract embeddings:  74%|███████▍  | 49/66 [00:03<00:00, 17.55it/s][4/6] extract embeddings:  77%|███████▋  | 51/66 [00:03<00:00, 17.72it/s][4/6] extract embeddings:  80%|████████  | 53/66 [00:04<00:00, 17.86it/s][4/6] extract embeddings:  83%|████████▎ | 55/66 [00:04<00:00, 18.29it/s][4/6] extract embeddings:  86%|████████▋ | 57/66 [00:04<00:00, 17.73it/s][4/6] extract embeddings:  89%|████████▉ | 59/66 [00:04<00:00, 17.68it/s][4/6] extract embeddings:  92%|█████████▏| 61/66 [00:04<00:00, 18.30it/s][4/6] extract embeddings:  95%|█████████▌| 63/66 [00:04<00:00, 18.61it/s][4/6] extract embeddings: 100%|██████████| 66/66 [00:04<00:00, 19.22it/s][4/6] extract embeddings: 100%|██████████| 66/66 [00:04<00:00, 13.89it/s]
[NeMo I 2025-04-17 01:15:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:15:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:15:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:15:17 collections:880] Dataset successfully loaded with 6331 items and total duration provided from manifest is  1.64 hours.
[NeMo I 2025-04-17 01:15:17 collections:886] # 6331 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/99 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/99 [00:01<01:58,  1.21s/it][5/6] extract embeddings:   4%|▍         | 4/99 [00:01<00:25,  3.75it/s][5/6] extract embeddings:   7%|▋         | 7/99 [00:01<00:13,  6.72it/s][5/6] extract embeddings:  10%|█         | 10/99 [00:01<00:08,  9.94it/s][5/6] extract embeddings:  13%|█▎        | 13/99 [00:01<00:06, 12.77it/s][5/6] extract embeddings:  16%|█▌        | 16/99 [00:01<00:05, 15.40it/s][5/6] extract embeddings:  19%|█▉        | 19/99 [00:01<00:04, 17.52it/s][5/6] extract embeddings:  22%|██▏       | 22/99 [00:02<00:04, 18.34it/s][5/6] extract embeddings:  25%|██▌       | 25/99 [00:02<00:03, 18.76it/s][5/6] extract embeddings:  28%|██▊       | 28/99 [00:02<00:03, 18.93it/s][5/6] extract embeddings:  31%|███▏      | 31/99 [00:02<00:03, 19.00it/s][5/6] extract embeddings:  34%|███▍      | 34/99 [00:02<00:03, 18.64it/s][5/6] extract embeddings:  36%|███▋      | 36/99 [00:02<00:03, 18.93it/s][5/6] extract embeddings:  38%|███▊      | 38/99 [00:02<00:03, 18.83it/s][5/6] extract embeddings:  41%|████▏     | 41/99 [00:03<00:02, 19.39it/s][5/6] extract embeddings:  43%|████▎     | 43/99 [00:03<00:02, 19.43it/s][5/6] extract embeddings:  45%|████▌     | 45/99 [00:03<00:02, 19.36it/s][5/6] extract embeddings:  48%|████▊     | 48/99 [00:03<00:02, 19.67it/s][5/6] extract embeddings:  51%|█████     | 50/99 [00:03<00:02, 19.40it/s][5/6] extract embeddings:  54%|█████▎    | 53/99 [00:03<00:02, 20.43it/s][5/6] extract embeddings:  57%|█████▋    | 56/99 [00:03<00:01, 22.21it/s][5/6] extract embeddings:  60%|█████▉    | 59/99 [00:03<00:01, 23.28it/s][5/6] extract embeddings:  63%|██████▎   | 62/99 [00:04<00:01, 23.69it/s][5/6] extract embeddings:  66%|██████▌   | 65/99 [00:04<00:01, 24.62it/s][5/6] extract embeddings:  69%|██████▊   | 68/99 [00:04<00:01, 25.39it/s][5/6] extract embeddings:  72%|███████▏  | 71/99 [00:04<00:01, 24.76it/s][5/6] extract embeddings:  75%|███████▍  | 74/99 [00:04<00:00, 25.53it/s][5/6] extract embeddings:  78%|███████▊  | 77/99 [00:04<00:00, 26.17it/s][5/6] extract embeddings:  81%|████████  | 80/99 [00:04<00:00, 26.27it/s][5/6] extract embeddings:  84%|████████▍ | 83/99 [00:04<00:00, 26.51it/s][5/6] extract embeddings:  87%|████████▋ | 86/99 [00:04<00:00, 26.57it/s][5/6] extract embeddings:  90%|████████▉ | 89/99 [00:05<00:00, 26.53it/s][5/6] extract embeddings:  93%|█████████▎| 92/99 [00:05<00:00, 26.82it/s][5/6] extract embeddings:  96%|█████████▌| 95/99 [00:05<00:00, 26.93it/s][5/6] extract embeddings:  99%|█████████▉| 98/99 [00:05<00:00, 26.89it/s][5/6] extract embeddings: 100%|██████████| 99/99 [00:05<00:00, 18.08it/s]
[NeMo I 2025-04-17 01:15:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:15:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:15:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:15:23 collections:880] Dataset successfully loaded with 12882 items and total duration provided from manifest is  1.74 hours.
[NeMo I 2025-04-17 01:15:23 collections:886] # 12882 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/202 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/202 [00:01<03:53,  1.16s/it][6/6] extract embeddings:   2%|▏         | 4/202 [00:01<00:49,  4.00it/s][6/6] extract embeddings:   4%|▍         | 8/202 [00:01<00:22,  8.53it/s][6/6] extract embeddings:   6%|▌         | 12/202 [00:01<00:14, 13.24it/s][6/6] extract embeddings:   8%|▊         | 16/202 [00:01<00:10, 17.38it/s][6/6] extract embeddings:  10%|▉         | 20/202 [00:01<00:08, 21.13it/s][6/6] extract embeddings:  12%|█▏        | 24/202 [00:01<00:07, 24.14it/s][6/6] extract embeddings:  14%|█▍        | 28/202 [00:01<00:06, 26.05it/s][6/6] extract embeddings:  16%|█▌        | 32/202 [00:02<00:06, 27.93it/s][6/6] extract embeddings:  18%|█▊        | 36/202 [00:02<00:05, 29.43it/s][6/6] extract embeddings:  20%|█▉        | 40/202 [00:02<00:05, 30.61it/s][6/6] extract embeddings:  22%|██▏       | 44/202 [00:02<00:05, 31.07it/s][6/6] extract embeddings:  24%|██▍       | 48/202 [00:02<00:05, 30.70it/s][6/6] extract embeddings:  26%|██▌       | 52/202 [00:02<00:04, 30.74it/s][6/6] extract embeddings:  28%|██▊       | 56/202 [00:02<00:04, 31.78it/s][6/6] extract embeddings:  30%|██▉       | 60/202 [00:02<00:04, 32.18it/s][6/6] extract embeddings:  32%|███▏      | 64/202 [00:03<00:04, 32.74it/s][6/6] extract embeddings:  34%|███▎      | 68/202 [00:03<00:04, 33.37it/s][6/6] extract embeddings:  36%|███▌      | 72/202 [00:03<00:03, 33.06it/s][6/6] extract embeddings:  38%|███▊      | 76/202 [00:03<00:03, 33.06it/s][6/6] extract embeddings:  40%|███▉      | 80/202 [00:03<00:03, 32.91it/s][6/6] extract embeddings:  42%|████▏     | 84/202 [00:03<00:03, 32.40it/s][6/6] extract embeddings:  44%|████▎     | 88/202 [00:03<00:03, 33.16it/s][6/6] extract embeddings:  46%|████▌     | 92/202 [00:03<00:03, 33.70it/s][6/6] extract embeddings:  48%|████▊     | 96/202 [00:04<00:03, 32.32it/s][6/6] extract embeddings:  50%|████▉     | 100/202 [00:04<00:03, 32.90it/s][6/6] extract embeddings:  51%|█████▏    | 104/202 [00:04<00:02, 33.03it/s][6/6] extract embeddings:  53%|█████▎    | 108/202 [00:04<00:02, 33.12it/s][6/6] extract embeddings:  55%|█████▌    | 112/202 [00:04<00:02, 31.91it/s][6/6] extract embeddings:  57%|█████▋    | 116/202 [00:04<00:03, 28.22it/s][6/6] extract embeddings:  59%|█████▉    | 119/202 [00:04<00:03, 26.77it/s][6/6] extract embeddings:  60%|██████    | 122/202 [00:05<00:03, 25.04it/s][6/6] extract embeddings:  62%|██████▏   | 125/202 [00:05<00:03, 24.68it/s][6/6] extract embeddings:  63%|██████▎   | 128/202 [00:05<00:03, 24.02it/s][6/6] extract embeddings:  65%|██████▍   | 131/202 [00:05<00:03, 23.01it/s][6/6] extract embeddings:  66%|██████▋   | 134/202 [00:05<00:02, 22.83it/s][6/6] extract embeddings:  68%|██████▊   | 137/202 [00:05<00:02, 21.93it/s][6/6] extract embeddings:  69%|██████▉   | 140/202 [00:05<00:02, 20.72it/s][6/6] extract embeddings:  71%|███████   | 143/202 [00:05<00:02, 21.62it/s][6/6] extract embeddings:  72%|███████▏  | 146/202 [00:06<00:02, 23.27it/s][6/6] extract embeddings:  74%|███████▍  | 149/202 [00:06<00:02, 23.43it/s][6/6] extract embeddings:  75%|███████▌  | 152/202 [00:06<00:02, 24.24it/s][6/6] extract embeddings:  77%|███████▋  | 155/202 [00:06<00:01, 24.57it/s][6/6] extract embeddings:  78%|███████▊  | 158/202 [00:06<00:01, 24.54it/s][6/6] extract embeddings:  80%|███████▉  | 161/202 [00:06<00:01, 24.59it/s][6/6] extract embeddings:  81%|████████  | 164/202 [00:06<00:01, 25.39it/s][6/6] extract embeddings:  83%|████████▎ | 167/202 [00:06<00:01, 24.90it/s][6/6] extract embeddings:  84%|████████▍ | 170/202 [00:07<00:01, 25.38it/s][6/6] extract embeddings:  86%|████████▌ | 173/202 [00:07<00:01, 25.41it/s][6/6] extract embeddings:  87%|████████▋ | 176/202 [00:07<00:00, 26.22it/s][6/6] extract embeddings:  89%|████████▊ | 179/202 [00:07<00:00, 25.39it/s][6/6] extract embeddings:  91%|█████████ | 183/202 [00:07<00:00, 26.76it/s][6/6] extract embeddings:  93%|█████████▎| 187/202 [00:07<00:00, 27.81it/s][6/6] extract embeddings:  94%|█████████▍| 190/202 [00:07<00:00, 27.45it/s][6/6] extract embeddings:  96%|█████████▌| 193/202 [00:07<00:00, 26.41it/s][6/6] extract embeddings:  97%|█████████▋| 196/202 [00:08<00:00, 25.90it/s][6/6] extract embeddings:  99%|█████████▊| 199/202 [00:08<00:00, 25.77it/s][6/6] extract embeddings: 100%|██████████| 202/202 [00:08<00:00, 26.05it/s][6/6] extract embeddings: 100%|██████████| 202/202 [00:08<00:00, 24.35it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.76it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.24it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.82it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.40it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.00it/s]
[NeMo I 2025-04-17 01:15:34 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:15:35 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              42.010058   444.120  ...   15.734989  3.542959
    Harker-ES                       33.311356  2178.782  ...   62.565471  2.871580
    Harker-MN                       45.527268   366.767  ...   32.289952  8.803941
    Longfellow-Block-1              27.406419   492.417  ...    8.853968  1.798063
    TOTAL                           34.872480  3482.086  ...  119.444379  3.430254
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:15:35 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0781 | MISS: 0.2363 | CER: 0.0343 | DER: 0.3487 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.55, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.55, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.84s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.94s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:15:47 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:15:47 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:15:47 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:15:47 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:15:47 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:15:47 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:15:47 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:15:47 features:305] PADDING: 16
[NeMo I 2025-04-17 01:15:48 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:15:48 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:15:48 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:15:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:15:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:15:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:15:48 collections:880] Dataset successfully loaded with 2214 items and total duration provided from manifest is  1.33 hours.
[NeMo I 2025-04-17 01:15:48 collections:886] # 2214 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:12,  2.14s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:13,  2.28it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:08,  3.62it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:05,  5.10it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.61it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  7.87it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02,  9.38it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:03<00:01, 10.53it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 11.55it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 12.42it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:01, 12.53it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 13.18it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 13.49it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:03<00:00, 13.69it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:04<00:00, 13.61it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:04<00:00, 14.47it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 14.80it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  7.97it/s]
[NeMo I 2025-04-17 01:15:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:15:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:15:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:15:52 collections:880] Dataset successfully loaded with 2580 items and total duration provided from manifest is  1.39 hours.
[NeMo I 2025-04-17 01:15:52 collections:886] # 2580 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:58,  1.46s/it][2/6] extract embeddings:   7%|▋         | 3/41 [00:01<00:16,  2.36it/s][2/6] extract embeddings:  12%|█▏        | 5/41 [00:01<00:08,  4.15it/s][2/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:05,  6.03it/s][2/6] extract embeddings:  22%|██▏       | 9/41 [00:01<00:04,  7.87it/s][2/6] extract embeddings:  27%|██▋       | 11/41 [00:02<00:03,  9.53it/s][2/6] extract embeddings:  32%|███▏      | 13/41 [00:02<00:02, 10.84it/s][2/6] extract embeddings:  37%|███▋      | 15/41 [00:02<00:02, 11.98it/s][2/6] extract embeddings:  41%|████▏     | 17/41 [00:02<00:01, 13.02it/s][2/6] extract embeddings:  46%|████▋     | 19/41 [00:02<00:01, 14.08it/s][2/6] extract embeddings:  51%|█████     | 21/41 [00:02<00:01, 15.13it/s][2/6] extract embeddings:  56%|█████▌    | 23/41 [00:02<00:01, 15.53it/s][2/6] extract embeddings:  61%|██████    | 25/41 [00:02<00:01, 15.73it/s][2/6] extract embeddings:  66%|██████▌   | 27/41 [00:03<00:00, 15.04it/s][2/6] extract embeddings:  71%|███████   | 29/41 [00:03<00:00, 15.01it/s][2/6] extract embeddings:  76%|███████▌  | 31/41 [00:03<00:00, 15.04it/s][2/6] extract embeddings:  80%|████████  | 33/41 [00:03<00:00, 15.64it/s][2/6] extract embeddings:  85%|████████▌ | 35/41 [00:03<00:00, 15.43it/s][2/6] extract embeddings:  90%|█████████ | 37/41 [00:03<00:00, 15.59it/s][2/6] extract embeddings:  95%|█████████▌| 39/41 [00:03<00:00, 15.64it/s][2/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 16.57it/s][2/6] extract embeddings: 100%|██████████| 41/41 [00:04<00:00, 10.20it/s]
[NeMo I 2025-04-17 01:15:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:15:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:15:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:15:57 collections:880] Dataset successfully loaded with 3134 items and total duration provided from manifest is  1.45 hours.
[NeMo I 2025-04-17 01:15:57 collections:886] # 3134 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/49 [00:01<01:06,  1.38s/it][3/6] extract embeddings:   6%|▌         | 3/49 [00:01<00:18,  2.50it/s][3/6] extract embeddings:  10%|█         | 5/49 [00:01<00:09,  4.42it/s][3/6] extract embeddings:  14%|█▍        | 7/49 [00:01<00:06,  6.42it/s][3/6] extract embeddings:  18%|█▊        | 9/49 [00:01<00:04,  8.41it/s][3/6] extract embeddings:  22%|██▏       | 11/49 [00:01<00:03, 10.16it/s][3/6] extract embeddings:  27%|██▋       | 13/49 [00:02<00:02, 12.07it/s][3/6] extract embeddings:  31%|███       | 15/49 [00:02<00:02, 13.28it/s][3/6] extract embeddings:  35%|███▍      | 17/49 [00:02<00:02, 14.03it/s][3/6] extract embeddings:  39%|███▉      | 19/49 [00:02<00:01, 15.18it/s][3/6] extract embeddings:  43%|████▎     | 21/49 [00:02<00:01, 14.88it/s][3/6] extract embeddings:  47%|████▋     | 23/49 [00:02<00:01, 15.40it/s][3/6] extract embeddings:  51%|█████     | 25/49 [00:02<00:01, 16.07it/s][3/6] extract embeddings:  55%|█████▌    | 27/49 [00:02<00:01, 16.64it/s][3/6] extract embeddings:  59%|█████▉    | 29/49 [00:03<00:01, 16.01it/s][3/6] extract embeddings:  63%|██████▎   | 31/49 [00:03<00:01, 16.29it/s][3/6] extract embeddings:  67%|██████▋   | 33/49 [00:03<00:00, 16.61it/s][3/6] extract embeddings:  71%|███████▏  | 35/49 [00:03<00:00, 16.21it/s][3/6] extract embeddings:  76%|███████▌  | 37/49 [00:03<00:00, 15.62it/s][3/6] extract embeddings:  80%|███████▉  | 39/49 [00:03<00:00, 15.33it/s][3/6] extract embeddings:  84%|████████▎ | 41/49 [00:03<00:00, 15.15it/s][3/6] extract embeddings:  88%|████████▊ | 43/49 [00:03<00:00, 15.59it/s][3/6] extract embeddings:  92%|█████████▏| 45/49 [00:04<00:00, 16.03it/s][3/6] extract embeddings:  96%|█████████▌| 47/49 [00:04<00:00, 15.97it/s][3/6] extract embeddings: 100%|██████████| 49/49 [00:04<00:00, 15.92it/s][3/6] extract embeddings: 100%|██████████| 49/49 [00:04<00:00, 11.29it/s]
[NeMo I 2025-04-17 01:16:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:16:01 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:16:01 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:16:01 collections:880] Dataset successfully loaded with 4136 items and total duration provided from manifest is  1.52 hours.
[NeMo I 2025-04-17 01:16:01 collections:886] # 4136 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/65 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/65 [00:01<01:27,  1.36s/it][4/6] extract embeddings:   6%|▌         | 4/65 [00:01<00:18,  3.34it/s][4/6] extract embeddings:   9%|▉         | 6/65 [00:01<00:11,  5.17it/s][4/6] extract embeddings:  12%|█▏        | 8/65 [00:01<00:08,  7.07it/s][4/6] extract embeddings:  15%|█▌        | 10/65 [00:01<00:06,  9.15it/s][4/6] extract embeddings:  18%|█▊        | 12/65 [00:01<00:04, 11.17it/s][4/6] extract embeddings:  23%|██▎       | 15/65 [00:02<00:03, 14.48it/s][4/6] extract embeddings:  28%|██▊       | 18/65 [00:02<00:02, 16.15it/s][4/6] extract embeddings:  32%|███▏      | 21/65 [00:02<00:02, 16.29it/s][4/6] extract embeddings:  35%|███▌      | 23/65 [00:02<00:02, 17.02it/s][4/6] extract embeddings:  38%|███▊      | 25/65 [00:02<00:02, 17.48it/s][4/6] extract embeddings:  43%|████▎     | 28/65 [00:02<00:02, 18.36it/s][4/6] extract embeddings:  46%|████▌     | 30/65 [00:02<00:01, 18.64it/s][4/6] extract embeddings:  49%|████▉     | 32/65 [00:02<00:01, 18.80it/s][4/6] extract embeddings:  52%|█████▏    | 34/65 [00:03<00:01, 19.00it/s][4/6] extract embeddings:  55%|█████▌    | 36/65 [00:03<00:01, 19.18it/s][4/6] extract embeddings:  58%|█████▊    | 38/65 [00:03<00:01, 19.24it/s][4/6] extract embeddings:  63%|██████▎   | 41/65 [00:03<00:01, 19.97it/s][4/6] extract embeddings:  68%|██████▊   | 44/65 [00:03<00:01, 20.16it/s][4/6] extract embeddings:  72%|███████▏  | 47/65 [00:03<00:00, 19.65it/s][4/6] extract embeddings:  75%|███████▌  | 49/65 [00:03<00:00, 19.61it/s][4/6] extract embeddings:  80%|████████  | 52/65 [00:03<00:00, 20.48it/s][4/6] extract embeddings:  85%|████████▍ | 55/65 [00:04<00:00, 20.19it/s][4/6] extract embeddings:  89%|████████▉ | 58/65 [00:04<00:00, 20.73it/s][4/6] extract embeddings:  94%|█████████▍| 61/65 [00:04<00:00, 20.09it/s][4/6] extract embeddings:  98%|█████████▊| 64/65 [00:04<00:00, 19.26it/s][4/6] extract embeddings: 100%|██████████| 65/65 [00:04<00:00, 14.01it/s]
[NeMo I 2025-04-17 01:16:06 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:16:06 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:16:06 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:16:06 collections:880] Dataset successfully loaded with 6214 items and total duration provided from manifest is  1.61 hours.
[NeMo I 2025-04-17 01:16:06 collections:886] # 6214 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/98 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/98 [00:01<01:50,  1.14s/it][5/6] extract embeddings:   4%|▍         | 4/98 [00:01<00:23,  3.96it/s][5/6] extract embeddings:   7%|▋         | 7/98 [00:01<00:12,  7.01it/s][5/6] extract embeddings:  10%|█         | 10/98 [00:01<00:08,  9.78it/s][5/6] extract embeddings:  12%|█▏        | 12/98 [00:01<00:07, 11.50it/s][5/6] extract embeddings:  15%|█▌        | 15/98 [00:01<00:06, 13.67it/s][5/6] extract embeddings:  17%|█▋        | 17/98 [00:01<00:05, 14.84it/s][5/6] extract embeddings:  20%|██        | 20/98 [00:02<00:04, 16.52it/s][5/6] extract embeddings:  22%|██▏       | 22/98 [00:02<00:04, 17.09it/s][5/6] extract embeddings:  24%|██▍       | 24/98 [00:02<00:04, 17.52it/s][5/6] extract embeddings:  28%|██▊       | 27/98 [00:02<00:03, 18.57it/s][5/6] extract embeddings:  31%|███       | 30/98 [00:02<00:03, 18.83it/s][5/6] extract embeddings:  33%|███▎      | 32/98 [00:02<00:03, 19.03it/s][5/6] extract embeddings:  35%|███▍      | 34/98 [00:02<00:03, 19.20it/s][5/6] extract embeddings:  37%|███▋      | 36/98 [00:02<00:03, 19.19it/s][5/6] extract embeddings:  40%|███▉      | 39/98 [00:03<00:02, 19.85it/s][5/6] extract embeddings:  42%|████▏     | 41/98 [00:03<00:02, 19.30it/s][5/6] extract embeddings:  44%|████▍     | 43/98 [00:03<00:02, 19.30it/s][5/6] extract embeddings:  46%|████▌     | 45/98 [00:03<00:02, 18.82it/s][5/6] extract embeddings:  49%|████▉     | 48/98 [00:03<00:02, 19.13it/s][5/6] extract embeddings:  52%|█████▏    | 51/98 [00:03<00:02, 19.76it/s][5/6] extract embeddings:  55%|█████▌    | 54/98 [00:03<00:02, 20.39it/s][5/6] extract embeddings:  58%|█████▊    | 57/98 [00:03<00:01, 20.59it/s][5/6] extract embeddings:  61%|██████    | 60/98 [00:04<00:01, 20.84it/s][5/6] extract embeddings:  64%|██████▍   | 63/98 [00:04<00:01, 19.68it/s][5/6] extract embeddings:  67%|██████▋   | 66/98 [00:04<00:01, 19.41it/s][5/6] extract embeddings:  69%|██████▉   | 68/98 [00:04<00:01, 19.46it/s][5/6] extract embeddings:  72%|███████▏  | 71/98 [00:04<00:01, 19.83it/s][5/6] extract embeddings:  76%|███████▌  | 74/98 [00:04<00:01, 21.01it/s][5/6] extract embeddings:  79%|███████▊  | 77/98 [00:04<00:00, 22.32it/s][5/6] extract embeddings:  82%|████████▏ | 80/98 [00:05<00:00, 22.45it/s][5/6] extract embeddings:  85%|████████▍ | 83/98 [00:05<00:00, 23.24it/s][5/6] extract embeddings:  88%|████████▊ | 86/98 [00:05<00:00, 21.97it/s][5/6] extract embeddings:  91%|█████████ | 89/98 [00:05<00:00, 21.37it/s][5/6] extract embeddings:  94%|█████████▍| 92/98 [00:05<00:00, 22.35it/s][5/6] extract embeddings:  97%|█████████▋| 95/98 [00:05<00:00, 22.51it/s][5/6] extract embeddings: 100%|██████████| 98/98 [00:05<00:00, 22.37it/s][5/6] extract embeddings: 100%|██████████| 98/98 [00:05<00:00, 16.70it/s]
[NeMo I 2025-04-17 01:16:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:16:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:16:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:16:12 collections:880] Dataset successfully loaded with 12654 items and total duration provided from manifest is  1.71 hours.
[NeMo I 2025-04-17 01:16:12 collections:886] # 12654 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/198 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/198 [00:01<04:11,  1.28s/it][6/6] extract embeddings:   3%|▎         | 5/198 [00:01<00:41,  4.66it/s][6/6] extract embeddings:   4%|▍         | 8/198 [00:01<00:25,  7.50it/s][6/6] extract embeddings:   6%|▌         | 12/198 [00:01<00:15, 11.72it/s][6/6] extract embeddings:   8%|▊         | 15/198 [00:01<00:12, 14.58it/s][6/6] extract embeddings:  10%|▉         | 19/198 [00:01<00:09, 18.88it/s][6/6] extract embeddings:  12%|█▏        | 23/198 [00:02<00:07, 22.18it/s][6/6] extract embeddings:  14%|█▎        | 27/198 [00:02<00:06, 25.01it/s][6/6] extract embeddings:  16%|█▌        | 31/198 [00:02<00:06, 27.23it/s][6/6] extract embeddings:  18%|█▊        | 35/198 [00:02<00:05, 28.39it/s][6/6] extract embeddings:  20%|█▉        | 39/198 [00:02<00:05, 29.71it/s][6/6] extract embeddings:  22%|██▏       | 43/198 [00:02<00:05, 30.68it/s][6/6] extract embeddings:  24%|██▎       | 47/198 [00:02<00:04, 31.57it/s][6/6] extract embeddings:  26%|██▌       | 51/198 [00:02<00:04, 31.78it/s][6/6] extract embeddings:  28%|██▊       | 55/198 [00:02<00:04, 31.92it/s][6/6] extract embeddings:  30%|██▉       | 59/198 [00:03<00:04, 32.03it/s][6/6] extract embeddings:  32%|███▏      | 63/198 [00:03<00:04, 32.38it/s][6/6] extract embeddings:  34%|███▍      | 67/198 [00:03<00:04, 32.71it/s][6/6] extract embeddings:  36%|███▌      | 71/198 [00:03<00:03, 32.23it/s][6/6] extract embeddings:  38%|███▊      | 75/198 [00:03<00:04, 30.15it/s][6/6] extract embeddings:  40%|███▉      | 79/198 [00:03<00:04, 29.44it/s][6/6] extract embeddings:  41%|████▏     | 82/198 [00:03<00:04, 28.31it/s][6/6] extract embeddings:  43%|████▎     | 85/198 [00:04<00:04, 27.55it/s][6/6] extract embeddings:  44%|████▍     | 88/198 [00:04<00:04, 27.23it/s][6/6] extract embeddings:  46%|████▌     | 91/198 [00:04<00:04, 26.16it/s][6/6] extract embeddings:  47%|████▋     | 94/198 [00:04<00:04, 25.82it/s][6/6] extract embeddings:  49%|████▉     | 97/198 [00:04<00:03, 26.36it/s][6/6] extract embeddings:  51%|█████     | 100/198 [00:04<00:03, 25.41it/s][6/6] extract embeddings:  52%|█████▏    | 103/198 [00:04<00:03, 24.66it/s][6/6] extract embeddings:  54%|█████▎    | 106/198 [00:04<00:03, 25.68it/s][6/6] extract embeddings:  55%|█████▌    | 109/198 [00:04<00:03, 26.27it/s][6/6] extract embeddings:  57%|█████▋    | 112/198 [00:05<00:03, 25.96it/s][6/6] extract embeddings:  58%|█████▊    | 115/198 [00:05<00:03, 25.85it/s][6/6] extract embeddings:  60%|█████▉    | 118/198 [00:05<00:03, 25.25it/s][6/6] extract embeddings:  61%|██████    | 121/198 [00:05<00:03, 24.27it/s][6/6] extract embeddings:  63%|██████▎   | 124/198 [00:05<00:03, 24.26it/s][6/6] extract embeddings:  64%|██████▍   | 127/198 [00:05<00:02, 24.95it/s][6/6] extract embeddings:  66%|██████▌   | 130/198 [00:05<00:02, 24.42it/s][6/6] extract embeddings:  67%|██████▋   | 133/198 [00:05<00:02, 25.70it/s][6/6] extract embeddings:  69%|██████▊   | 136/198 [00:06<00:02, 26.68it/s][6/6] extract embeddings:  71%|███████   | 140/198 [00:06<00:02, 28.23it/s][6/6] extract embeddings:  73%|███████▎  | 144/198 [00:06<00:01, 28.16it/s][6/6] extract embeddings:  75%|███████▍  | 148/198 [00:06<00:01, 28.20it/s][6/6] extract embeddings:  76%|███████▋  | 151/198 [00:06<00:01, 26.67it/s][6/6] extract embeddings:  78%|███████▊  | 154/198 [00:06<00:01, 26.65it/s][6/6] extract embeddings:  80%|███████▉  | 158/198 [00:06<00:01, 27.68it/s][6/6] extract embeddings:  82%|████████▏ | 162/198 [00:06<00:01, 28.07it/s][6/6] extract embeddings:  84%|████████▍ | 166/198 [00:07<00:01, 29.51it/s][6/6] extract embeddings:  86%|████████▌ | 170/198 [00:07<00:00, 30.49it/s][6/6] extract embeddings:  88%|████████▊ | 174/198 [00:07<00:00, 29.50it/s][6/6] extract embeddings:  89%|████████▉ | 177/198 [00:07<00:00, 28.49it/s][6/6] extract embeddings:  91%|█████████ | 180/198 [00:07<00:00, 27.92it/s][6/6] extract embeddings:  92%|█████████▏| 183/198 [00:07<00:00, 26.85it/s][6/6] extract embeddings:  94%|█████████▍| 186/198 [00:07<00:00, 25.84it/s][6/6] extract embeddings:  95%|█████████▌| 189/198 [00:07<00:00, 25.60it/s][6/6] extract embeddings:  97%|█████████▋| 192/198 [00:08<00:00, 25.66it/s][6/6] extract embeddings:  98%|█████████▊| 195/198 [00:08<00:00, 25.99it/s][6/6] extract embeddings: 100%|██████████| 198/198 [00:08<00:00, 25.21it/s][6/6] extract embeddings: 100%|██████████| 198/198 [00:08<00:00, 23.83it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.04it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.32it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.92it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.52it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.12it/s]
[NeMo I 2025-04-17 01:16:23 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:16:24 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              42.237479   444.120  ...   14.454986  3.254748
    Harker-ES                       34.388344  2178.782  ...   64.510495  2.960851
    Harker-MN                       46.588977   366.767  ...   31.381991  8.556383
    Longfellow-Block-1              28.367587   492.417  ...    8.668959  1.760491
    TOTAL                           35.823123  3482.086  ...  119.016431  3.417964
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:16:24 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0766 | MISS: 0.2475 | CER: 0.0342 | DER: 0.3582 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:03<00:09,  3.22s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:05<00:05,  2.50s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:05<00:01,  1.55s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:06<00:00,  1.10s/it]Processing Audio: 100%|██████████| 4/4 [00:06<00:00,  1.51s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:16:49 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:16:49 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:16:49 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:16:49 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:16:49 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:16:49 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:16:49 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:16:49 features:305] PADDING: 16
[NeMo I 2025-04-17 01:16:50 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:16:50 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:16:50 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:16:50 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:16:50 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:16:50 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:16:50 collections:880] Dataset successfully loaded with 2193 items and total duration provided from manifest is  1.29 hours.
[NeMo I 2025-04-17 01:16:50 collections:886] # 2193 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:23,  2.45s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:15,  2.02it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:08,  3.24it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:05,  4.65it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:04,  6.11it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:03<00:03,  7.53it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:03<00:02,  9.05it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:03<00:01, 10.22it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 11.57it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 12.20it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:01, 12.93it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 13.47it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:04<00:00, 13.93it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:04<00:00, 13.69it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:04<00:00, 13.64it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:04<00:00, 14.26it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 14.57it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  7.51it/s]
[NeMo I 2025-04-17 01:16:54 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:16:54 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:16:54 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:16:54 collections:880] Dataset successfully loaded with 2549 items and total duration provided from manifest is  1.35 hours.
[NeMo I 2025-04-17 01:16:54 collections:886] # 2549 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:56,  1.45s/it][2/6] extract embeddings:   8%|▊         | 3/40 [00:01<00:15,  2.38it/s][2/6] extract embeddings:  12%|█▎        | 5/40 [00:01<00:08,  4.20it/s][2/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:05,  6.02it/s][2/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  7.83it/s][2/6] extract embeddings:  28%|██▊       | 11/40 [00:02<00:02,  9.69it/s][2/6] extract embeddings:  32%|███▎      | 13/40 [00:02<00:02, 11.09it/s][2/6] extract embeddings:  38%|███▊      | 15/40 [00:02<00:02, 11.88it/s][2/6] extract embeddings:  42%|████▎     | 17/40 [00:02<00:01, 13.35it/s][2/6] extract embeddings:  48%|████▊     | 19/40 [00:02<00:01, 13.89it/s][2/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 14.17it/s][2/6] extract embeddings:  57%|█████▊    | 23/40 [00:02<00:01, 13.91it/s][2/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:01, 14.79it/s][2/6] extract embeddings:  68%|██████▊   | 27/40 [00:03<00:00, 15.95it/s][2/6] extract embeddings:  72%|███████▎  | 29/40 [00:03<00:00, 16.09it/s][2/6] extract embeddings:  78%|███████▊  | 31/40 [00:03<00:00, 16.67it/s][2/6] extract embeddings:  82%|████████▎ | 33/40 [00:03<00:00, 16.38it/s][2/6] extract embeddings:  88%|████████▊ | 35/40 [00:03<00:00, 16.70it/s][2/6] extract embeddings:  92%|█████████▎| 37/40 [00:03<00:00, 15.98it/s][2/6] extract embeddings:  98%|█████████▊| 39/40 [00:03<00:00, 15.35it/s][2/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 10.16it/s]
[NeMo I 2025-04-17 01:16:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:16:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:16:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:16:59 collections:880] Dataset successfully loaded with 3092 items and total duration provided from manifest is  1.41 hours.
[NeMo I 2025-04-17 01:16:59 collections:886] # 3092 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/49 [00:01<01:05,  1.36s/it][3/6] extract embeddings:   8%|▊         | 4/49 [00:01<00:13,  3.37it/s][3/6] extract embeddings:  12%|█▏        | 6/49 [00:01<00:08,  5.17it/s][3/6] extract embeddings:  16%|█▋        | 8/49 [00:01<00:05,  7.19it/s][3/6] extract embeddings:  20%|██        | 10/49 [00:01<00:04,  9.30it/s][3/6] extract embeddings:  27%|██▋       | 13/49 [00:01<00:02, 12.28it/s][3/6] extract embeddings:  31%|███       | 15/49 [00:02<00:02, 13.72it/s][3/6] extract embeddings:  35%|███▍      | 17/49 [00:02<00:02, 14.72it/s][3/6] extract embeddings:  41%|████      | 20/49 [00:02<00:01, 16.55it/s][3/6] extract embeddings:  45%|████▍     | 22/49 [00:02<00:01, 17.15it/s][3/6] extract embeddings:  49%|████▉     | 24/49 [00:02<00:01, 17.65it/s][3/6] extract embeddings:  53%|█████▎    | 26/49 [00:02<00:01, 18.00it/s][3/6] extract embeddings:  57%|█████▋    | 28/49 [00:02<00:01, 18.54it/s][3/6] extract embeddings:  61%|██████    | 30/49 [00:02<00:01, 18.84it/s][3/6] extract embeddings:  67%|██████▋   | 33/49 [00:02<00:00, 19.46it/s][3/6] extract embeddings:  73%|███████▎  | 36/49 [00:03<00:00, 19.50it/s][3/6] extract embeddings:  78%|███████▊  | 38/49 [00:03<00:00, 19.17it/s][3/6] extract embeddings:  82%|████████▏ | 40/49 [00:03<00:00, 18.80it/s][3/6] extract embeddings:  86%|████████▌ | 42/49 [00:03<00:00, 18.35it/s][3/6] extract embeddings:  90%|████████▉ | 44/49 [00:03<00:00, 17.68it/s][3/6] extract embeddings:  96%|█████████▌| 47/49 [00:03<00:00, 18.51it/s][3/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 12.67it/s]
[NeMo I 2025-04-17 01:17:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:17:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:17:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:17:03 collections:880] Dataset successfully loaded with 4067 items and total duration provided from manifest is  1.49 hours.
[NeMo I 2025-04-17 01:17:03 collections:886] # 4067 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/64 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/64 [00:01<01:25,  1.35s/it][4/6] extract embeddings:   5%|▍         | 3/64 [00:01<00:23,  2.56it/s][4/6] extract embeddings:   8%|▊         | 5/64 [00:01<00:12,  4.55it/s][4/6] extract embeddings:  11%|█         | 7/64 [00:01<00:08,  6.64it/s][4/6] extract embeddings:  14%|█▍        | 9/64 [00:01<00:06,  8.50it/s][4/6] extract embeddings:  19%|█▉        | 12/64 [00:01<00:04, 11.91it/s][4/6] extract embeddings:  23%|██▎       | 15/64 [00:02<00:03, 14.75it/s][4/6] extract embeddings:  28%|██▊       | 18/64 [00:02<00:02, 16.66it/s][4/6] extract embeddings:  33%|███▎      | 21/64 [00:02<00:02, 18.14it/s][4/6] extract embeddings:  38%|███▊      | 24/64 [00:02<00:02, 19.04it/s][4/6] extract embeddings:  42%|████▏     | 27/64 [00:02<00:01, 19.52it/s][4/6] extract embeddings:  47%|████▋     | 30/64 [00:02<00:01, 20.41it/s][4/6] extract embeddings:  52%|█████▏    | 33/64 [00:02<00:01, 20.78it/s][4/6] extract embeddings:  56%|█████▋    | 36/64 [00:03<00:01, 21.38it/s][4/6] extract embeddings:  61%|██████    | 39/64 [00:03<00:01, 21.46it/s][4/6] extract embeddings:  66%|██████▌   | 42/64 [00:03<00:00, 22.07it/s][4/6] extract embeddings:  70%|███████   | 45/64 [00:03<00:00, 22.17it/s][4/6] extract embeddings:  75%|███████▌  | 48/64 [00:03<00:00, 21.75it/s][4/6] extract embeddings:  80%|███████▉  | 51/64 [00:03<00:00, 21.67it/s][4/6] extract embeddings:  84%|████████▍ | 54/64 [00:03<00:00, 21.21it/s][4/6] extract embeddings:  89%|████████▉ | 57/64 [00:04<00:00, 20.24it/s][4/6] extract embeddings:  94%|█████████▍| 60/64 [00:04<00:00, 20.86it/s][4/6] extract embeddings:  98%|█████████▊| 63/64 [00:04<00:00, 20.89it/s][4/6] extract embeddings: 100%|██████████| 64/64 [00:04<00:00, 14.62it/s]
[NeMo I 2025-04-17 01:17:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:17:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:17:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:17:07 collections:880] Dataset successfully loaded with 6103 items and total duration provided from manifest is  1.57 hours.
[NeMo I 2025-04-17 01:17:07 collections:886] # 6103 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/96 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/96 [00:01<01:51,  1.18s/it][5/6] extract embeddings:   4%|▍         | 4/96 [00:01<00:23,  3.86it/s][5/6] extract embeddings:   7%|▋         | 7/96 [00:01<00:12,  6.97it/s][5/6] extract embeddings:  10%|█         | 10/96 [00:01<00:08,  9.98it/s][5/6] extract embeddings:  14%|█▎        | 13/96 [00:01<00:06, 12.53it/s][5/6] extract embeddings:  17%|█▋        | 16/96 [00:01<00:05, 15.02it/s][5/6] extract embeddings:  20%|█▉        | 19/96 [00:01<00:04, 16.88it/s][5/6] extract embeddings:  23%|██▎       | 22/96 [00:02<00:04, 18.28it/s][5/6] extract embeddings:  26%|██▌       | 25/96 [00:02<00:03, 19.36it/s][5/6] extract embeddings:  29%|██▉       | 28/96 [00:02<00:03, 19.85it/s][5/6] extract embeddings:  32%|███▏      | 31/96 [00:02<00:03, 20.81it/s][5/6] extract embeddings:  35%|███▌      | 34/96 [00:02<00:02, 21.67it/s][5/6] extract embeddings:  39%|███▊      | 37/96 [00:02<00:02, 23.45it/s][5/6] extract embeddings:  42%|████▏     | 40/96 [00:02<00:02, 23.19it/s][5/6] extract embeddings:  45%|████▍     | 43/96 [00:02<00:02, 24.06it/s][5/6] extract embeddings:  48%|████▊     | 46/96 [00:03<00:02, 24.10it/s][5/6] extract embeddings:  51%|█████     | 49/96 [00:03<00:02, 23.18it/s][5/6] extract embeddings:  54%|█████▍    | 52/96 [00:03<00:01, 22.88it/s][5/6] extract embeddings:  57%|█████▋    | 55/96 [00:03<00:01, 22.03it/s][5/6] extract embeddings:  60%|██████    | 58/96 [00:03<00:01, 20.93it/s][5/6] extract embeddings:  64%|██████▎   | 61/96 [00:03<00:01, 22.12it/s][5/6] extract embeddings:  67%|██████▋   | 64/96 [00:03<00:01, 22.79it/s][5/6] extract embeddings:  70%|██████▉   | 67/96 [00:04<00:01, 22.84it/s][5/6] extract embeddings:  73%|███████▎  | 70/96 [00:04<00:01, 22.37it/s][5/6] extract embeddings:  76%|███████▌  | 73/96 [00:04<00:01, 21.50it/s][5/6] extract embeddings:  79%|███████▉  | 76/96 [00:04<00:00, 21.64it/s][5/6] extract embeddings:  82%|████████▏ | 79/96 [00:04<00:00, 22.13it/s][5/6] extract embeddings:  85%|████████▌ | 82/96 [00:04<00:00, 21.48it/s][5/6] extract embeddings:  89%|████████▊ | 85/96 [00:04<00:00, 21.72it/s][5/6] extract embeddings:  92%|█████████▏| 88/96 [00:05<00:00, 21.90it/s][5/6] extract embeddings:  95%|█████████▍| 91/96 [00:05<00:00, 22.06it/s][5/6] extract embeddings:  98%|█████████▊| 94/96 [00:05<00:00, 21.57it/s][5/6] extract embeddings: 100%|██████████| 96/96 [00:05<00:00, 17.69it/s]
[NeMo I 2025-04-17 01:17:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:17:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:17:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:17:13 collections:880] Dataset successfully loaded with 12423 items and total duration provided from manifest is  1.68 hours.
[NeMo I 2025-04-17 01:17:13 collections:886] # 12423 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/195 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/195 [00:01<03:56,  1.22s/it][6/6] extract embeddings:   2%|▏         | 4/195 [00:01<00:50,  3.76it/s][6/6] extract embeddings:   4%|▎         | 7/195 [00:01<00:27,  6.95it/s][6/6] extract embeddings:   6%|▌         | 11/195 [00:01<00:16, 11.32it/s][6/6] extract embeddings:   7%|▋         | 14/195 [00:01<00:12, 14.09it/s][6/6] extract embeddings:   9%|▊         | 17/195 [00:01<00:11, 16.17it/s][6/6] extract embeddings:  10%|█         | 20/195 [00:01<00:09, 18.32it/s][6/6] extract embeddings:  12%|█▏        | 23/195 [00:02<00:08, 20.68it/s][6/6] extract embeddings:  13%|█▎        | 26/195 [00:02<00:07, 21.64it/s][6/6] extract embeddings:  15%|█▍        | 29/195 [00:02<00:07, 22.19it/s][6/6] extract embeddings:  16%|█▋        | 32/195 [00:02<00:07, 22.97it/s][6/6] extract embeddings:  18%|█▊        | 35/195 [00:02<00:06, 24.25it/s][6/6] extract embeddings:  19%|█▉        | 38/195 [00:02<00:06, 24.71it/s][6/6] extract embeddings:  21%|██        | 41/195 [00:02<00:06, 24.55it/s][6/6] extract embeddings:  23%|██▎       | 44/195 [00:02<00:06, 24.30it/s][6/6] extract embeddings:  24%|██▍       | 47/195 [00:03<00:06, 23.80it/s][6/6] extract embeddings:  26%|██▌       | 50/195 [00:03<00:05, 24.53it/s][6/6] extract embeddings:  27%|██▋       | 53/195 [00:03<00:05, 24.43it/s][6/6] extract embeddings:  29%|██▊       | 56/195 [00:03<00:05, 25.35it/s][6/6] extract embeddings:  30%|███       | 59/195 [00:03<00:05, 25.25it/s][6/6] extract embeddings:  32%|███▏      | 62/195 [00:03<00:05, 24.91it/s][6/6] extract embeddings:  33%|███▎      | 65/195 [00:03<00:05, 24.90it/s][6/6] extract embeddings:  35%|███▍      | 68/195 [00:03<00:05, 24.97it/s][6/6] extract embeddings:  36%|███▋      | 71/195 [00:04<00:05, 24.73it/s][6/6] extract embeddings:  38%|███▊      | 75/195 [00:04<00:04, 26.44it/s][6/6] extract embeddings:  40%|████      | 78/195 [00:04<00:04, 26.73it/s][6/6] extract embeddings:  42%|████▏     | 81/195 [00:04<00:04, 26.09it/s][6/6] extract embeddings:  43%|████▎     | 84/195 [00:04<00:04, 25.25it/s][6/6] extract embeddings:  45%|████▍     | 87/195 [00:04<00:04, 25.08it/s][6/6] extract embeddings:  46%|████▌     | 90/195 [00:04<00:04, 25.41it/s][6/6] extract embeddings:  48%|████▊     | 93/195 [00:04<00:04, 24.55it/s][6/6] extract embeddings:  49%|████▉     | 96/195 [00:04<00:04, 24.32it/s][6/6] extract embeddings:  51%|█████     | 99/195 [00:05<00:03, 24.99it/s][6/6] extract embeddings:  52%|█████▏    | 102/195 [00:05<00:03, 25.40it/s][6/6] extract embeddings:  54%|█████▍    | 105/195 [00:05<00:03, 24.98it/s][6/6] extract embeddings:  55%|█████▌    | 108/195 [00:05<00:03, 24.30it/s][6/6] extract embeddings:  57%|█████▋    | 111/195 [00:05<00:03, 24.26it/s][6/6] extract embeddings:  58%|█████▊    | 114/195 [00:05<00:03, 24.12it/s][6/6] extract embeddings:  60%|██████    | 117/195 [00:05<00:03, 24.21it/s][6/6] extract embeddings:  62%|██████▏   | 120/195 [00:05<00:03, 24.51it/s][6/6] extract embeddings:  63%|██████▎   | 123/195 [00:06<00:03, 23.65it/s][6/6] extract embeddings:  65%|██████▍   | 126/195 [00:06<00:02, 24.96it/s][6/6] extract embeddings:  66%|██████▌   | 129/195 [00:06<00:02, 24.74it/s][6/6] extract embeddings:  68%|██████▊   | 132/195 [00:06<00:02, 24.24it/s][6/6] extract embeddings:  69%|██████▉   | 135/195 [00:06<00:02, 24.18it/s][6/6] extract embeddings:  71%|███████   | 138/195 [00:06<00:02, 23.84it/s][6/6] extract embeddings:  72%|███████▏  | 141/195 [00:06<00:02, 23.83it/s][6/6] extract embeddings:  74%|███████▍  | 144/195 [00:06<00:02, 23.49it/s][6/6] extract embeddings:  75%|███████▌  | 147/195 [00:07<00:02, 23.97it/s][6/6] extract embeddings:  77%|███████▋  | 150/195 [00:07<00:01, 24.30it/s][6/6] extract embeddings:  78%|███████▊  | 153/195 [00:07<00:01, 24.42it/s][6/6] extract embeddings:  80%|████████  | 156/195 [00:07<00:01, 24.36it/s][6/6] extract embeddings:  82%|████████▏ | 159/195 [00:07<00:01, 23.24it/s][6/6] extract embeddings:  83%|████████▎ | 162/195 [00:07<00:01, 23.47it/s][6/6] extract embeddings:  85%|████████▍ | 165/195 [00:07<00:01, 24.12it/s][6/6] extract embeddings:  86%|████████▌ | 168/195 [00:07<00:01, 24.49it/s][6/6] extract embeddings:  88%|████████▊ | 171/195 [00:08<00:00, 25.27it/s][6/6] extract embeddings:  89%|████████▉ | 174/195 [00:08<00:00, 24.70it/s][6/6] extract embeddings:  91%|█████████ | 177/195 [00:08<00:00, 24.34it/s][6/6] extract embeddings:  92%|█████████▏| 180/195 [00:08<00:00, 23.35it/s][6/6] extract embeddings:  94%|█████████▍| 183/195 [00:08<00:00, 24.53it/s][6/6] extract embeddings:  96%|█████████▌| 187/195 [00:08<00:00, 25.62it/s][6/6] extract embeddings:  97%|█████████▋| 190/195 [00:08<00:00, 24.97it/s][6/6] extract embeddings:  99%|█████████▉| 193/195 [00:08<00:00, 23.63it/s][6/6] extract embeddings: 100%|██████████| 195/195 [00:09<00:00, 21.47it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.14it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.42it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.02it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.62it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s]
[NeMo I 2025-04-17 01:17:24 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:17:25 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              43.090865   444.120  ...   16.625003  3.743358
    Harker-ES                       35.310137  2178.782  ...   64.613839  2.965594
    Harker-MN                       46.823202   366.767  ...   30.309012  8.263833
    Longfellow-Block-1              29.818787   492.417  ...    9.634990  1.956673
    TOTAL                           36.738636  3482.086  ...  121.182844  3.480180
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:17:25 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0746 | MISS: 0.2580 | CER: 0.0348 | DER: 0.3674 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.90s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.98s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.27s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.19s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:17:40 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:17:40 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:17:40 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:17:40 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:17:40 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:17:40 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:17:40 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:17:40 features:305] PADDING: 16
[NeMo I 2025-04-17 01:17:41 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:17:41 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:17:41 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:17:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:17:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:17:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:17:41 collections:880] Dataset successfully loaded with 2150 items and total duration provided from manifest is  1.24 hours.
[NeMo I 2025-04-17 01:17:41 collections:886] # 2150 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:02<01:11,  2.16s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:13,  2.27it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.66it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.28it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  6.97it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  8.48it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:02,  9.92it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:03<00:01, 11.52it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:03<00:01, 12.68it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:01, 13.19it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 14.34it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 14.74it/s][1/6] extract embeddings:  76%|███████▋  | 26/34 [00:03<00:00, 14.86it/s][1/6] extract embeddings:  82%|████████▏ | 28/34 [00:03<00:00, 15.07it/s][1/6] extract embeddings:  88%|████████▊ | 30/34 [00:03<00:00, 15.01it/s][1/6] extract embeddings:  94%|█████████▍| 32/34 [00:04<00:00, 14.98it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:04<00:00, 15.92it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:04<00:00,  8.17it/s]
[NeMo I 2025-04-17 01:17:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:17:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:17:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:17:45 collections:880] Dataset successfully loaded with 2499 items and total duration provided from manifest is  1.30 hours.
[NeMo I 2025-04-17 01:17:45 collections:886] # 2499 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:56,  1.44s/it][2/6] extract embeddings:   8%|▊         | 3/40 [00:01<00:15,  2.36it/s][2/6] extract embeddings:  12%|█▎        | 5/40 [00:01<00:08,  4.14it/s][2/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:05,  6.06it/s][2/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  8.02it/s][2/6] extract embeddings:  28%|██▊       | 11/40 [00:02<00:03,  9.63it/s][2/6] extract embeddings:  32%|███▎      | 13/40 [00:02<00:02, 10.96it/s][2/6] extract embeddings:  38%|███▊      | 15/40 [00:02<00:02, 12.09it/s][2/6] extract embeddings:  42%|████▎     | 17/40 [00:02<00:01, 13.09it/s][2/6] extract embeddings:  48%|████▊     | 19/40 [00:02<00:01, 13.64it/s][2/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 14.26it/s][2/6] extract embeddings:  57%|█████▊    | 23/40 [00:02<00:01, 14.47it/s][2/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:01, 14.83it/s][2/6] extract embeddings:  68%|██████▊   | 27/40 [00:03<00:00, 15.18it/s][2/6] extract embeddings:  72%|███████▎  | 29/40 [00:03<00:00, 15.22it/s][2/6] extract embeddings:  78%|███████▊  | 31/40 [00:03<00:00, 15.07it/s][2/6] extract embeddings:  82%|████████▎ | 33/40 [00:03<00:00, 15.07it/s][2/6] extract embeddings:  88%|████████▊ | 35/40 [00:03<00:00, 14.97it/s][2/6] extract embeddings:  92%|█████████▎| 37/40 [00:03<00:00, 15.28it/s][2/6] extract embeddings:  98%|█████████▊| 39/40 [00:03<00:00, 15.30it/s][2/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 10.07it/s]
[NeMo I 2025-04-17 01:17:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:17:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:17:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:17:49 collections:880] Dataset successfully loaded with 3015 items and total duration provided from manifest is  1.36 hours.
[NeMo I 2025-04-17 01:17:49 collections:886] # 3015 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/48 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/48 [00:01<00:58,  1.24s/it][3/6] extract embeddings:   6%|▋         | 3/48 [00:01<00:16,  2.77it/s][3/6] extract embeddings:  10%|█         | 5/48 [00:01<00:08,  4.85it/s][3/6] extract embeddings:  15%|█▍        | 7/48 [00:01<00:05,  7.04it/s][3/6] extract embeddings:  19%|█▉        | 9/48 [00:01<00:04,  9.24it/s][3/6] extract embeddings:  23%|██▎       | 11/48 [00:01<00:03, 11.28it/s][3/6] extract embeddings:  27%|██▋       | 13/48 [00:01<00:02, 12.66it/s][3/6] extract embeddings:  31%|███▏      | 15/48 [00:02<00:02, 14.01it/s][3/6] extract embeddings:  35%|███▌      | 17/48 [00:02<00:02, 15.30it/s][3/6] extract embeddings:  40%|███▉      | 19/48 [00:02<00:01, 16.19it/s][3/6] extract embeddings:  44%|████▍     | 21/48 [00:02<00:01, 15.84it/s][3/6] extract embeddings:  48%|████▊     | 23/48 [00:02<00:01, 16.74it/s][3/6] extract embeddings:  52%|█████▏    | 25/48 [00:02<00:01, 17.15it/s][3/6] extract embeddings:  56%|█████▋    | 27/48 [00:02<00:01, 17.09it/s][3/6] extract embeddings:  62%|██████▎   | 30/48 [00:02<00:01, 17.75it/s][3/6] extract embeddings:  67%|██████▋   | 32/48 [00:02<00:00, 16.62it/s][3/6] extract embeddings:  71%|███████   | 34/48 [00:03<00:00, 16.63it/s][3/6] extract embeddings:  75%|███████▌  | 36/48 [00:03<00:00, 16.68it/s][3/6] extract embeddings:  79%|███████▉  | 38/48 [00:03<00:00, 17.40it/s][3/6] extract embeddings:  83%|████████▎ | 40/48 [00:03<00:00, 16.97it/s][3/6] extract embeddings:  88%|████████▊ | 42/48 [00:03<00:00, 17.14it/s][3/6] extract embeddings:  92%|█████████▏| 44/48 [00:03<00:00, 16.85it/s][3/6] extract embeddings:  96%|█████████▌| 46/48 [00:03<00:00, 17.25it/s][3/6] extract embeddings: 100%|██████████| 48/48 [00:03<00:00, 12.28it/s]
[NeMo I 2025-04-17 01:17:54 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:17:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:17:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:17:55 collections:880] Dataset successfully loaded with 3966 items and total duration provided from manifest is  1.44 hours.
[NeMo I 2025-04-17 01:17:55 collections:886] # 3966 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/62 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/62 [00:01<01:27,  1.44s/it][4/6] extract embeddings:   5%|▍         | 3/62 [00:01<00:24,  2.40it/s][4/6] extract embeddings:   8%|▊         | 5/62 [00:01<00:13,  4.22it/s][4/6] extract embeddings:  11%|█▏        | 7/62 [00:01<00:09,  6.01it/s][4/6] extract embeddings:  15%|█▍        | 9/62 [00:01<00:06,  7.92it/s][4/6] extract embeddings:  18%|█▊        | 11/62 [00:02<00:05,  9.72it/s][4/6] extract embeddings:  21%|██        | 13/62 [00:02<00:04, 11.02it/s][4/6] extract embeddings:  24%|██▍       | 15/62 [00:02<00:03, 12.13it/s][4/6] extract embeddings:  27%|██▋       | 17/62 [00:02<00:03, 13.00it/s][4/6] extract embeddings:  31%|███       | 19/62 [00:02<00:03, 13.52it/s][4/6] extract embeddings:  34%|███▍      | 21/62 [00:02<00:02, 14.02it/s][4/6] extract embeddings:  37%|███▋      | 23/62 [00:02<00:02, 14.46it/s][4/6] extract embeddings:  42%|████▏     | 26/62 [00:03<00:02, 16.18it/s][4/6] extract embeddings:  47%|████▋     | 29/62 [00:03<00:01, 17.48it/s][4/6] extract embeddings:  50%|█████     | 31/62 [00:03<00:01, 18.01it/s][4/6] extract embeddings:  53%|█████▎    | 33/62 [00:03<00:01, 18.24it/s][4/6] extract embeddings:  58%|█████▊    | 36/62 [00:03<00:01, 19.13it/s][4/6] extract embeddings:  63%|██████▎   | 39/62 [00:03<00:01, 20.01it/s][4/6] extract embeddings:  68%|██████▊   | 42/62 [00:03<00:01, 19.48it/s][4/6] extract embeddings:  73%|███████▎  | 45/62 [00:03<00:00, 20.50it/s][4/6] extract embeddings:  77%|███████▋  | 48/62 [00:04<00:00, 20.75it/s][4/6] extract embeddings:  82%|████████▏ | 51/62 [00:04<00:00, 21.38it/s][4/6] extract embeddings:  87%|████████▋ | 54/62 [00:04<00:00, 20.67it/s][4/6] extract embeddings:  92%|█████████▏| 57/62 [00:04<00:00, 20.84it/s][4/6] extract embeddings:  97%|█████████▋| 60/62 [00:04<00:00, 20.30it/s][4/6] extract embeddings: 100%|██████████| 62/62 [00:04<00:00, 12.92it/s]
[NeMo I 2025-04-17 01:17:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:18:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:18:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:18:00 collections:880] Dataset successfully loaded with 5956 items and total duration provided from manifest is  1.53 hours.
[NeMo I 2025-04-17 01:18:00 collections:886] # 5956 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/94 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/94 [00:01<02:03,  1.33s/it][5/6] extract embeddings:   4%|▍         | 4/94 [00:01<00:26,  3.43it/s][5/6] extract embeddings:   6%|▋         | 6/94 [00:01<00:16,  5.32it/s][5/6] extract embeddings:   9%|▊         | 8/94 [00:01<00:11,  7.28it/s][5/6] extract embeddings:  12%|█▏        | 11/94 [00:01<00:08, 10.25it/s][5/6] extract embeddings:  14%|█▍        | 13/94 [00:01<00:06, 11.96it/s][5/6] extract embeddings:  17%|█▋        | 16/94 [00:02<00:05, 14.96it/s][5/6] extract embeddings:  20%|██        | 19/94 [00:02<00:04, 17.96it/s][5/6] extract embeddings:  23%|██▎       | 22/94 [00:02<00:03, 20.04it/s][5/6] extract embeddings:  27%|██▋       | 25/94 [00:02<00:03, 21.41it/s][5/6] extract embeddings:  30%|██▉       | 28/94 [00:02<00:03, 21.95it/s][5/6] extract embeddings:  33%|███▎      | 31/94 [00:02<00:02, 23.38it/s][5/6] extract embeddings:  36%|███▌      | 34/94 [00:02<00:02, 24.26it/s][5/6] extract embeddings:  39%|███▉      | 37/94 [00:02<00:02, 25.35it/s][5/6] extract embeddings:  43%|████▎     | 40/94 [00:02<00:02, 25.67it/s][5/6] extract embeddings:  46%|████▌     | 43/94 [00:03<00:02, 25.48it/s][5/6] extract embeddings:  49%|████▉     | 46/94 [00:03<00:01, 25.71it/s][5/6] extract embeddings:  52%|█████▏    | 49/94 [00:03<00:01, 26.33it/s][5/6] extract embeddings:  55%|█████▌    | 52/94 [00:03<00:01, 26.78it/s][5/6] extract embeddings:  59%|█████▊    | 55/94 [00:03<00:01, 26.12it/s][5/6] extract embeddings:  62%|██████▏   | 58/94 [00:03<00:01, 26.28it/s][5/6] extract embeddings:  65%|██████▍   | 61/94 [00:03<00:01, 26.38it/s][5/6] extract embeddings:  68%|██████▊   | 64/94 [00:03<00:01, 26.37it/s][5/6] extract embeddings:  71%|███████▏  | 67/94 [00:04<00:01, 26.49it/s][5/6] extract embeddings:  74%|███████▍  | 70/94 [00:04<00:00, 25.55it/s][5/6] extract embeddings:  78%|███████▊  | 73/94 [00:04<00:00, 25.31it/s][5/6] extract embeddings:  81%|████████  | 76/94 [00:04<00:00, 24.37it/s][5/6] extract embeddings:  84%|████████▍ | 79/94 [00:04<00:00, 24.55it/s][5/6] extract embeddings:  87%|████████▋ | 82/94 [00:04<00:00, 25.19it/s][5/6] extract embeddings:  90%|█████████ | 85/94 [00:04<00:00, 25.38it/s][5/6] extract embeddings:  94%|█████████▎| 88/94 [00:04<00:00, 24.09it/s][5/6] extract embeddings:  97%|█████████▋| 91/94 [00:04<00:00, 24.52it/s][5/6] extract embeddings: 100%|██████████| 94/94 [00:05<00:00, 25.48it/s][5/6] extract embeddings: 100%|██████████| 94/94 [00:05<00:00, 18.32it/s]
[NeMo I 2025-04-17 01:18:05 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:18:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:18:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:18:05 collections:880] Dataset successfully loaded with 12130 items and total duration provided from manifest is  1.63 hours.
[NeMo I 2025-04-17 01:18:05 collections:886] # 12130 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/190 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/190 [00:01<03:58,  1.26s/it][6/6] extract embeddings:   2%|▏         | 4/190 [00:01<00:50,  3.72it/s][6/6] extract embeddings:   4%|▎         | 7/190 [00:01<00:27,  6.63it/s][6/6] extract embeddings:   5%|▌         | 10/190 [00:01<00:18,  9.74it/s][6/6] extract embeddings:   7%|▋         | 14/190 [00:01<00:12, 14.61it/s][6/6] extract embeddings:   9%|▉         | 18/190 [00:01<00:09, 18.84it/s][6/6] extract embeddings:  11%|█         | 21/190 [00:01<00:08, 21.07it/s][6/6] extract embeddings:  13%|█▎        | 24/190 [00:02<00:07, 22.37it/s][6/6] extract embeddings:  14%|█▍        | 27/190 [00:02<00:07, 22.98it/s][6/6] extract embeddings:  16%|█▌        | 30/190 [00:02<00:06, 24.01it/s][6/6] extract embeddings:  17%|█▋        | 33/190 [00:02<00:06, 24.07it/s][6/6] extract embeddings:  19%|█▉        | 36/190 [00:02<00:06, 24.36it/s][6/6] extract embeddings:  21%|██        | 39/190 [00:02<00:06, 23.38it/s][6/6] extract embeddings:  22%|██▏       | 42/190 [00:02<00:05, 24.79it/s][6/6] extract embeddings:  24%|██▎       | 45/190 [00:02<00:05, 24.85it/s][6/6] extract embeddings:  25%|██▌       | 48/190 [00:03<00:05, 24.26it/s][6/6] extract embeddings:  27%|██▋       | 51/190 [00:03<00:05, 24.10it/s][6/6] extract embeddings:  28%|██▊       | 54/190 [00:03<00:05, 23.47it/s][6/6] extract embeddings:  30%|███       | 57/190 [00:03<00:05, 23.83it/s][6/6] extract embeddings:  32%|███▏      | 60/190 [00:03<00:05, 23.44it/s][6/6] extract embeddings:  33%|███▎      | 63/190 [00:03<00:05, 23.54it/s][6/6] extract embeddings:  35%|███▍      | 66/190 [00:03<00:05, 24.25it/s][6/6] extract embeddings:  36%|███▋      | 69/190 [00:03<00:04, 24.96it/s][6/6] extract embeddings:  38%|███▊      | 72/190 [00:04<00:04, 26.01it/s][6/6] extract embeddings:  39%|███▉      | 75/190 [00:04<00:04, 25.97it/s][6/6] extract embeddings:  41%|████      | 78/190 [00:04<00:04, 25.15it/s][6/6] extract embeddings:  43%|████▎     | 81/190 [00:04<00:04, 26.34it/s][6/6] extract embeddings:  44%|████▍     | 84/190 [00:04<00:03, 26.56it/s][6/6] extract embeddings:  46%|████▌     | 87/190 [00:04<00:04, 25.54it/s][6/6] extract embeddings:  47%|████▋     | 90/190 [00:04<00:04, 24.87it/s][6/6] extract embeddings:  49%|████▉     | 93/190 [00:04<00:03, 25.08it/s][6/6] extract embeddings:  51%|█████     | 96/190 [00:04<00:03, 24.86it/s][6/6] extract embeddings:  52%|█████▏    | 99/190 [00:05<00:03, 25.00it/s][6/6] extract embeddings:  54%|█████▎    | 102/190 [00:05<00:03, 25.96it/s][6/6] extract embeddings:  56%|█████▌    | 106/190 [00:05<00:03, 27.39it/s][6/6] extract embeddings:  57%|█████▋    | 109/190 [00:05<00:03, 26.33it/s][6/6] extract embeddings:  59%|█████▉    | 112/190 [00:05<00:02, 26.28it/s][6/6] extract embeddings:  61%|██████    | 115/190 [00:05<00:02, 25.89it/s][6/6] extract embeddings:  62%|██████▏   | 118/190 [00:05<00:02, 25.37it/s][6/6] extract embeddings:  64%|██████▎   | 121/190 [00:05<00:02, 24.50it/s][6/6] extract embeddings:  65%|██████▌   | 124/190 [00:06<00:02, 24.42it/s][6/6] extract embeddings:  67%|██████▋   | 127/190 [00:06<00:02, 24.66it/s][6/6] extract embeddings:  68%|██████▊   | 130/190 [00:06<00:02, 23.58it/s][6/6] extract embeddings:  70%|███████   | 133/190 [00:06<00:02, 23.96it/s][6/6] extract embeddings:  72%|███████▏  | 136/190 [00:06<00:02, 24.26it/s][6/6] extract embeddings:  73%|███████▎  | 139/190 [00:06<00:02, 24.33it/s][6/6] extract embeddings:  75%|███████▍  | 142/190 [00:06<00:01, 24.09it/s][6/6] extract embeddings:  76%|███████▋  | 145/190 [00:06<00:01, 24.71it/s][6/6] extract embeddings:  78%|███████▊  | 149/190 [00:07<00:01, 26.33it/s][6/6] extract embeddings:  80%|████████  | 152/190 [00:07<00:01, 25.82it/s][6/6] extract embeddings:  82%|████████▏ | 155/190 [00:07<00:01, 26.24it/s][6/6] extract embeddings:  83%|████████▎ | 158/190 [00:07<00:01, 25.49it/s][6/6] extract embeddings:  85%|████████▍ | 161/190 [00:07<00:01, 25.79it/s][6/6] extract embeddings:  86%|████████▋ | 164/190 [00:07<00:01, 25.62it/s][6/6] extract embeddings:  88%|████████▊ | 167/190 [00:07<00:00, 24.98it/s][6/6] extract embeddings:  89%|████████▉ | 170/190 [00:07<00:00, 24.94it/s][6/6] extract embeddings:  91%|█████████ | 173/190 [00:08<00:00, 24.56it/s][6/6] extract embeddings:  93%|█████████▎| 176/190 [00:08<00:00, 24.40it/s][6/6] extract embeddings:  94%|█████████▍| 179/190 [00:08<00:00, 24.30it/s][6/6] extract embeddings:  96%|█████████▌| 182/190 [00:08<00:00, 24.26it/s][6/6] extract embeddings:  97%|█████████▋| 185/190 [00:08<00:00, 23.91it/s][6/6] extract embeddings:  99%|█████████▉| 188/190 [00:08<00:00, 23.21it/s][6/6] extract embeddings: 100%|██████████| 190/190 [00:08<00:00, 21.62it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:02,  1.50it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.26it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.86it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.45it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s]
[NeMo I 2025-04-17 01:18:16 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:18:17 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              44.641121   444.120  ...   16.250064  3.658935
    Harker-ES                       36.000638  2178.782  ...   52.858419  2.426054
    Harker-MN                       47.123673   366.767  ...   31.098961  8.479215
    Longfellow-Block-1              31.170294   492.417  ...   11.169990  2.268400
    TOTAL                           37.591187  3482.086  ...  111.377434  3.198584
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:18:17 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0716 | MISS: 0.2724 | CER: 0.0320 | DER: 0.3759 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.83s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.93s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.16s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:18:30 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:18:30 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:18:30 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:18:30 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:18:30 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:18:30 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:18:30 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:18:30 features:305] PADDING: 16
[NeMo I 2025-04-17 01:18:30 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:18:30 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:18:30 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:18:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:18:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:18:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:18:30 collections:880] Dataset successfully loaded with 2127 items and total duration provided from manifest is  1.19 hours.
[NeMo I 2025-04-17 01:18:30 collections:886] # 2127 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:02<01:06,  2.01s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.43it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.82it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.38it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  6.79it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  8.31it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:02,  9.89it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 11.47it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:03<00:01, 12.55it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:01, 13.67it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 14.31it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 14.92it/s][1/6] extract embeddings:  76%|███████▋  | 26/34 [00:03<00:00, 14.65it/s][1/6] extract embeddings:  82%|████████▏ | 28/34 [00:03<00:00, 14.43it/s][1/6] extract embeddings:  88%|████████▊ | 30/34 [00:03<00:00, 14.84it/s][1/6] extract embeddings:  94%|█████████▍| 32/34 [00:03<00:00, 15.02it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:04<00:00,  8.37it/s]
[NeMo I 2025-04-17 01:18:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:18:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:18:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:18:34 collections:880] Dataset successfully loaded with 2458 items and total duration provided from manifest is  1.25 hours.
[NeMo I 2025-04-17 01:18:34 collections:886] # 2458 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:54,  1.43s/it][2/6] extract embeddings:   8%|▊         | 3/39 [00:01<00:14,  2.42it/s][2/6] extract embeddings:  13%|█▎        | 5/39 [00:01<00:07,  4.26it/s][2/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:05,  6.19it/s][2/6] extract embeddings:  23%|██▎       | 9/39 [00:01<00:03,  8.01it/s][2/6] extract embeddings:  28%|██▊       | 11/39 [00:02<00:02,  9.76it/s][2/6] extract embeddings:  33%|███▎      | 13/39 [00:02<00:02, 11.23it/s][2/6] extract embeddings:  38%|███▊      | 15/39 [00:02<00:01, 12.77it/s][2/6] extract embeddings:  44%|████▎     | 17/39 [00:02<00:01, 13.65it/s][2/6] extract embeddings:  49%|████▊     | 19/39 [00:02<00:01, 14.82it/s][2/6] extract embeddings:  54%|█████▍    | 21/39 [00:02<00:01, 15.26it/s][2/6] extract embeddings:  59%|█████▉    | 23/39 [00:02<00:01, 15.28it/s][2/6] extract embeddings:  64%|██████▍   | 25/39 [00:02<00:00, 15.91it/s][2/6] extract embeddings:  69%|██████▉   | 27/39 [00:03<00:00, 16.22it/s][2/6] extract embeddings:  74%|███████▍  | 29/39 [00:03<00:00, 15.58it/s][2/6] extract embeddings:  79%|███████▉  | 31/39 [00:03<00:00, 15.75it/s][2/6] extract embeddings:  85%|████████▍ | 33/39 [00:03<00:00, 15.13it/s][2/6] extract embeddings:  90%|████████▉ | 35/39 [00:03<00:00, 15.42it/s][2/6] extract embeddings:  95%|█████████▍| 37/39 [00:03<00:00, 15.63it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:03<00:00, 10.31it/s]
[NeMo I 2025-04-17 01:18:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:18:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:18:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:18:39 collections:880] Dataset successfully loaded with 2948 items and total duration provided from manifest is  1.31 hours.
[NeMo I 2025-04-17 01:18:39 collections:886] # 2948 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:55,  1.21s/it][3/6] extract embeddings:   6%|▋         | 3/47 [00:01<00:15,  2.82it/s][3/6] extract embeddings:  11%|█         | 5/47 [00:01<00:08,  4.93it/s][3/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:05,  6.94it/s][3/6] extract embeddings:  19%|█▉        | 9/47 [00:01<00:04,  9.02it/s][3/6] extract embeddings:  23%|██▎       | 11/47 [00:01<00:03, 10.97it/s][3/6] extract embeddings:  28%|██▊       | 13/47 [00:01<00:02, 12.42it/s][3/6] extract embeddings:  32%|███▏      | 15/47 [00:02<00:02, 13.37it/s][3/6] extract embeddings:  36%|███▌      | 17/47 [00:02<00:02, 14.37it/s][3/6] extract embeddings:  40%|████      | 19/47 [00:02<00:01, 15.49it/s][3/6] extract embeddings:  45%|████▍     | 21/47 [00:02<00:01, 16.32it/s][3/6] extract embeddings:  49%|████▉     | 23/47 [00:02<00:01, 16.00it/s][3/6] extract embeddings:  53%|█████▎    | 25/47 [00:02<00:01, 16.29it/s][3/6] extract embeddings:  57%|█████▋    | 27/47 [00:02<00:01, 16.73it/s][3/6] extract embeddings:  62%|██████▏   | 29/47 [00:02<00:01, 16.38it/s][3/6] extract embeddings:  66%|██████▌   | 31/47 [00:02<00:00, 16.97it/s][3/6] extract embeddings:  70%|███████   | 33/47 [00:03<00:00, 17.41it/s][3/6] extract embeddings:  74%|███████▍  | 35/47 [00:03<00:00, 17.17it/s][3/6] extract embeddings:  79%|███████▊  | 37/47 [00:03<00:00, 17.27it/s][3/6] extract embeddings:  83%|████████▎ | 39/47 [00:03<00:00, 16.91it/s][3/6] extract embeddings:  87%|████████▋ | 41/47 [00:03<00:00, 16.12it/s][3/6] extract embeddings:  91%|█████████▏| 43/47 [00:03<00:00, 16.77it/s][3/6] extract embeddings:  96%|█████████▌| 45/47 [00:03<00:00, 17.26it/s][3/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 12.05it/s]
[NeMo I 2025-04-17 01:18:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:18:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:18:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:18:43 collections:880] Dataset successfully loaded with 3866 items and total duration provided from manifest is  1.39 hours.
[NeMo I 2025-04-17 01:18:43 collections:886] # 3866 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/61 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/61 [00:01<01:11,  1.19s/it][4/6] extract embeddings:   7%|▋         | 4/61 [00:01<00:14,  3.89it/s][4/6] extract embeddings:  10%|▉         | 6/61 [00:01<00:09,  5.91it/s][4/6] extract embeddings:  13%|█▎        | 8/61 [00:01<00:06,  7.85it/s][4/6] extract embeddings:  16%|█▋        | 10/61 [00:01<00:05,  9.94it/s][4/6] extract embeddings:  21%|██▏       | 13/61 [00:01<00:03, 12.97it/s][4/6] extract embeddings:  26%|██▌       | 16/61 [00:01<00:02, 15.51it/s][4/6] extract embeddings:  31%|███       | 19/61 [00:02<00:02, 17.03it/s][4/6] extract embeddings:  36%|███▌      | 22/61 [00:02<00:02, 17.21it/s][4/6] extract embeddings:  39%|███▉      | 24/61 [00:02<00:02, 17.47it/s][4/6] extract embeddings:  43%|████▎     | 26/61 [00:02<00:01, 17.87it/s][4/6] extract embeddings:  46%|████▌     | 28/61 [00:02<00:01, 17.39it/s][4/6] extract embeddings:  49%|████▉     | 30/61 [00:02<00:01, 18.01it/s][4/6] extract embeddings:  52%|█████▏    | 32/61 [00:02<00:01, 17.76it/s][4/6] extract embeddings:  57%|█████▋    | 35/61 [00:02<00:01, 18.76it/s][4/6] extract embeddings:  61%|██████    | 37/61 [00:03<00:01, 18.75it/s][4/6] extract embeddings:  66%|██████▌   | 40/61 [00:03<00:01, 19.52it/s][4/6] extract embeddings:  70%|███████   | 43/61 [00:03<00:00, 20.82it/s][4/6] extract embeddings:  75%|███████▌  | 46/61 [00:03<00:00, 21.63it/s][4/6] extract embeddings:  80%|████████  | 49/61 [00:03<00:00, 21.44it/s][4/6] extract embeddings:  85%|████████▌ | 52/61 [00:03<00:00, 21.21it/s][4/6] extract embeddings:  90%|█████████ | 55/61 [00:03<00:00, 21.42it/s][4/6] extract embeddings:  95%|█████████▌| 58/61 [00:03<00:00, 22.14it/s][4/6] extract embeddings: 100%|██████████| 61/61 [00:04<00:00, 22.62it/s][4/6] extract embeddings: 100%|██████████| 61/61 [00:04<00:00, 14.73it/s]
[NeMo I 2025-04-17 01:18:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:18:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:18:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:18:47 collections:880] Dataset successfully loaded with 5785 items and total duration provided from manifest is  1.48 hours.
[NeMo I 2025-04-17 01:18:47 collections:886] # 5785 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/91 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/91 [00:01<01:47,  1.19s/it][5/6] extract embeddings:   4%|▍         | 4/91 [00:01<00:22,  3.84it/s][5/6] extract embeddings:   8%|▊         | 7/91 [00:01<00:11,  7.09it/s][5/6] extract embeddings:  11%|█         | 10/91 [00:01<00:07, 10.14it/s][5/6] extract embeddings:  14%|█▍        | 13/91 [00:01<00:05, 13.11it/s][5/6] extract embeddings:  18%|█▊        | 16/91 [00:01<00:04, 16.28it/s][5/6] extract embeddings:  21%|██        | 19/91 [00:01<00:03, 18.48it/s][5/6] extract embeddings:  24%|██▍       | 22/91 [00:02<00:03, 20.68it/s][5/6] extract embeddings:  27%|██▋       | 25/91 [00:02<00:02, 22.10it/s][5/6] extract embeddings:  31%|███       | 28/91 [00:02<00:02, 23.44it/s][5/6] extract embeddings:  34%|███▍      | 31/91 [00:02<00:02, 24.40it/s][5/6] extract embeddings:  37%|███▋      | 34/91 [00:02<00:02, 25.48it/s][5/6] extract embeddings:  41%|████      | 37/91 [00:02<00:02, 25.56it/s][5/6] extract embeddings:  44%|████▍     | 40/91 [00:02<00:01, 25.87it/s][5/6] extract embeddings:  47%|████▋     | 43/91 [00:02<00:01, 25.31it/s][5/6] extract embeddings:  51%|█████     | 46/91 [00:02<00:01, 24.82it/s][5/6] extract embeddings:  54%|█████▍    | 49/91 [00:03<00:01, 25.42it/s][5/6] extract embeddings:  57%|█████▋    | 52/91 [00:03<00:01, 26.32it/s][5/6] extract embeddings:  60%|██████    | 55/91 [00:03<00:01, 25.66it/s][5/6] extract embeddings:  64%|██████▎   | 58/91 [00:03<00:01, 26.49it/s][5/6] extract embeddings:  67%|██████▋   | 61/91 [00:03<00:01, 26.76it/s][5/6] extract embeddings:  70%|███████   | 64/91 [00:03<00:01, 26.90it/s][5/6] extract embeddings:  74%|███████▎  | 67/91 [00:03<00:00, 26.92it/s][5/6] extract embeddings:  77%|███████▋  | 70/91 [00:03<00:00, 26.45it/s][5/6] extract embeddings:  80%|████████  | 73/91 [00:03<00:00, 25.67it/s][5/6] extract embeddings:  84%|████████▎ | 76/91 [00:04<00:00, 26.26it/s][5/6] extract embeddings:  87%|████████▋ | 79/91 [00:04<00:00, 26.14it/s][5/6] extract embeddings:  90%|█████████ | 82/91 [00:04<00:00, 24.23it/s][5/6] extract embeddings:  93%|█████████▎| 85/91 [00:04<00:00, 24.73it/s][5/6] extract embeddings:  97%|█████████▋| 88/91 [00:04<00:00, 24.93it/s][5/6] extract embeddings: 100%|██████████| 91/91 [00:04<00:00, 25.77it/s][5/6] extract embeddings: 100%|██████████| 91/91 [00:04<00:00, 19.36it/s]
[NeMo I 2025-04-17 01:18:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:18:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:18:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:18:52 collections:880] Dataset successfully loaded with 11786 items and total duration provided from manifest is  1.58 hours.
[NeMo I 2025-04-17 01:18:52 collections:886] # 11786 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/185 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/185 [00:01<03:41,  1.20s/it][6/6] extract embeddings:   2%|▏         | 4/185 [00:01<00:47,  3.82it/s][6/6] extract embeddings:   4%|▍         | 7/185 [00:01<00:25,  6.92it/s][6/6] extract embeddings:   5%|▌         | 10/185 [00:01<00:17, 10.04it/s][6/6] extract embeddings:   7%|▋         | 13/185 [00:01<00:13, 12.52it/s][6/6] extract embeddings:   9%|▊         | 16/185 [00:01<00:11, 14.70it/s][6/6] extract embeddings:  10%|█         | 19/185 [00:01<00:09, 17.17it/s][6/6] extract embeddings:  12%|█▏        | 23/185 [00:02<00:07, 21.17it/s][6/6] extract embeddings:  15%|█▍        | 27/185 [00:02<00:06, 24.55it/s][6/6] extract embeddings:  17%|█▋        | 31/185 [00:02<00:05, 27.21it/s][6/6] extract embeddings:  19%|█▉        | 35/185 [00:02<00:05, 26.45it/s][6/6] extract embeddings:  21%|██        | 38/185 [00:02<00:05, 25.48it/s][6/6] extract embeddings:  22%|██▏       | 41/185 [00:02<00:05, 24.56it/s][6/6] extract embeddings:  24%|██▍       | 44/185 [00:02<00:06, 23.13it/s][6/6] extract embeddings:  26%|██▌       | 48/185 [00:03<00:05, 26.13it/s][6/6] extract embeddings:  28%|██▊       | 52/185 [00:03<00:04, 28.51it/s][6/6] extract embeddings:  30%|██▉       | 55/185 [00:03<00:04, 27.47it/s][6/6] extract embeddings:  32%|███▏      | 59/185 [00:03<00:04, 29.77it/s][6/6] extract embeddings:  34%|███▍      | 63/185 [00:03<00:04, 29.63it/s][6/6] extract embeddings:  36%|███▌      | 67/185 [00:03<00:04, 29.03it/s][6/6] extract embeddings:  38%|███▊      | 70/185 [00:03<00:03, 28.82it/s][6/6] extract embeddings:  39%|███▉      | 73/185 [00:03<00:03, 29.00it/s][6/6] extract embeddings:  41%|████      | 76/185 [00:03<00:03, 28.93it/s][6/6] extract embeddings:  43%|████▎     | 79/185 [00:04<00:03, 28.64it/s][6/6] extract embeddings:  44%|████▍     | 82/185 [00:04<00:03, 28.37it/s][6/6] extract embeddings:  46%|████▌     | 85/185 [00:04<00:03, 26.73it/s][6/6] extract embeddings:  48%|████▊     | 88/185 [00:04<00:03, 26.47it/s][6/6] extract embeddings:  49%|████▉     | 91/185 [00:04<00:03, 25.37it/s][6/6] extract embeddings:  51%|█████     | 94/185 [00:04<00:03, 23.67it/s][6/6] extract embeddings:  52%|█████▏    | 97/185 [00:04<00:03, 24.81it/s][6/6] extract embeddings:  54%|█████▍    | 100/185 [00:04<00:03, 24.86it/s][6/6] extract embeddings:  56%|█████▌    | 103/185 [00:05<00:03, 25.16it/s][6/6] extract embeddings:  57%|█████▋    | 106/185 [00:05<00:03, 24.14it/s][6/6] extract embeddings:  59%|█████▉    | 109/185 [00:05<00:03, 23.93it/s][6/6] extract embeddings:  61%|██████    | 112/185 [00:05<00:03, 23.78it/s][6/6] extract embeddings:  62%|██████▏   | 115/185 [00:05<00:03, 22.61it/s][6/6] extract embeddings:  64%|██████▍   | 118/185 [00:05<00:02, 23.80it/s][6/6] extract embeddings:  65%|██████▌   | 121/185 [00:05<00:02, 23.80it/s][6/6] extract embeddings:  67%|██████▋   | 124/185 [00:05<00:02, 23.51it/s][6/6] extract embeddings:  69%|██████▊   | 127/185 [00:06<00:02, 23.91it/s][6/6] extract embeddings:  70%|███████   | 130/185 [00:06<00:02, 23.28it/s][6/6] extract embeddings:  72%|███████▏  | 133/185 [00:06<00:02, 23.61it/s][6/6] extract embeddings:  74%|███████▎  | 136/185 [00:06<00:01, 25.22it/s][6/6] extract embeddings:  75%|███████▌  | 139/185 [00:06<00:01, 25.67it/s][6/6] extract embeddings:  77%|███████▋  | 142/185 [00:06<00:01, 25.46it/s][6/6] extract embeddings:  78%|███████▊  | 145/185 [00:06<00:01, 24.58it/s][6/6] extract embeddings:  80%|████████  | 148/185 [00:06<00:01, 24.22it/s][6/6] extract embeddings:  82%|████████▏ | 151/185 [00:07<00:01, 24.48it/s][6/6] extract embeddings:  83%|████████▎ | 154/185 [00:07<00:01, 24.73it/s][6/6] extract embeddings:  85%|████████▌ | 158/185 [00:07<00:00, 27.23it/s][6/6] extract embeddings:  87%|████████▋ | 161/185 [00:07<00:00, 26.49it/s][6/6] extract embeddings:  89%|████████▊ | 164/185 [00:07<00:00, 26.85it/s][6/6] extract embeddings:  90%|█████████ | 167/185 [00:07<00:00, 26.02it/s][6/6] extract embeddings:  92%|█████████▏| 170/185 [00:07<00:00, 25.64it/s][6/6] extract embeddings:  94%|█████████▎| 173/185 [00:07<00:00, 24.77it/s][6/6] extract embeddings:  95%|█████████▌| 176/185 [00:08<00:00, 25.09it/s][6/6] extract embeddings:  97%|█████████▋| 179/185 [00:08<00:00, 25.31it/s][6/6] extract embeddings:  98%|█████████▊| 182/185 [00:08<00:00, 24.71it/s][6/6] extract embeddings: 100%|██████████| 185/185 [00:08<00:00, 25.52it/s][6/6] extract embeddings: 100%|██████████| 185/185 [00:08<00:00, 22.06it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.03it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.48it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.12it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.76it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.32it/s]
[NeMo I 2025-04-17 01:19:03 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:19:04 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              46.360248   444.120  ...   17.235014  3.880711
    Harker-ES                       37.843002  2178.782  ...   64.088269  2.941472
    Harker-MN                       47.381606   366.767  ...   31.169942  8.498568
    Longfellow-Block-1              32.885512   492.417  ...   11.487953  2.332972
    TOTAL                           39.232966  3482.086  ...  123.981178  3.560543
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:19:04 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0681 | MISS: 0.2886 | CER: 0.0356 | DER: 0.3923 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.97s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.99s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.28s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.20s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:19:17 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:19:17 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:19:17 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:19:17 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:19:17 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:19:17 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:19:17 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:19:17 features:305] PADDING: 16
[NeMo I 2025-04-17 01:19:18 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:19:18 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:19:18 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:19:18 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:19:18 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:19:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:19:18 collections:880] Dataset successfully loaded with 2103 items and total duration provided from manifest is  1.13 hours.
[NeMo I 2025-04-17 01:19:18 collections:886] # 2103 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  1.97s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.47it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.96it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.64it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.32it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  9.03it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.79it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.59it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:01, 14.20it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:03<00:00, 14.52it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 14.88it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 14.58it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 14.99it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 14.77it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 15.31it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 16.16it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.60it/s]
[NeMo I 2025-04-17 01:19:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:19:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:19:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:19:22 collections:880] Dataset successfully loaded with 2424 items and total duration provided from manifest is  1.19 hours.
[NeMo I 2025-04-17 01:19:22 collections:886] # 2424 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:54,  1.48s/it][2/6] extract embeddings:   8%|▊         | 3/38 [00:01<00:14,  2.34it/s][2/6] extract embeddings:  13%|█▎        | 5/38 [00:01<00:07,  4.21it/s][2/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:05,  6.16it/s][2/6] extract embeddings:  24%|██▎       | 9/38 [00:01<00:03,  8.17it/s][2/6] extract embeddings:  29%|██▉       | 11/38 [00:02<00:02,  9.83it/s][2/6] extract embeddings:  34%|███▍      | 13/38 [00:02<00:02, 11.33it/s][2/6] extract embeddings:  39%|███▉      | 15/38 [00:02<00:01, 12.67it/s][2/6] extract embeddings:  45%|████▍     | 17/38 [00:02<00:01, 13.83it/s][2/6] extract embeddings:  50%|█████     | 19/38 [00:02<00:01, 14.37it/s][2/6] extract embeddings:  55%|█████▌    | 21/38 [00:02<00:01, 14.95it/s][2/6] extract embeddings:  61%|██████    | 23/38 [00:02<00:00, 15.13it/s][2/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 15.31it/s][2/6] extract embeddings:  71%|███████   | 27/38 [00:03<00:00, 16.27it/s][2/6] extract embeddings:  76%|███████▋  | 29/38 [00:03<00:00, 15.83it/s][2/6] extract embeddings:  82%|████████▏ | 31/38 [00:03<00:00, 16.22it/s][2/6] extract embeddings:  87%|████████▋ | 33/38 [00:03<00:00, 16.09it/s][2/6] extract embeddings:  92%|█████████▏| 35/38 [00:03<00:00, 15.63it/s][2/6] extract embeddings:  97%|█████████▋| 37/38 [00:03<00:00, 16.03it/s][2/6] extract embeddings: 100%|██████████| 38/38 [00:03<00:00, 10.09it/s]
[NeMo I 2025-04-17 01:19:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:19:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:19:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:19:26 collections:880] Dataset successfully loaded with 2882 items and total duration provided from manifest is  1.25 hours.
[NeMo I 2025-04-17 01:19:26 collections:886] # 2882 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:54,  1.21s/it][3/6] extract embeddings:   7%|▋         | 3/46 [00:01<00:15,  2.83it/s][3/6] extract embeddings:  11%|█         | 5/46 [00:01<00:08,  4.89it/s][3/6] extract embeddings:  15%|█▌        | 7/46 [00:01<00:05,  7.08it/s][3/6] extract embeddings:  20%|█▉        | 9/46 [00:01<00:04,  8.98it/s][3/6] extract embeddings:  24%|██▍       | 11/46 [00:01<00:03, 10.95it/s][3/6] extract embeddings:  28%|██▊       | 13/46 [00:01<00:02, 12.27it/s][3/6] extract embeddings:  33%|███▎      | 15/46 [00:02<00:02, 13.60it/s][3/6] extract embeddings:  37%|███▋      | 17/46 [00:02<00:02, 14.44it/s][3/6] extract embeddings:  41%|████▏     | 19/46 [00:02<00:01, 15.40it/s][3/6] extract embeddings:  46%|████▌     | 21/46 [00:02<00:01, 15.72it/s][3/6] extract embeddings:  50%|█████     | 23/46 [00:02<00:01, 15.69it/s][3/6] extract embeddings:  54%|█████▍    | 25/46 [00:02<00:01, 16.47it/s][3/6] extract embeddings:  59%|█████▊    | 27/46 [00:02<00:01, 16.79it/s][3/6] extract embeddings:  63%|██████▎   | 29/46 [00:02<00:00, 17.16it/s][3/6] extract embeddings:  67%|██████▋   | 31/46 [00:02<00:00, 17.17it/s][3/6] extract embeddings:  72%|███████▏  | 33/46 [00:03<00:00, 17.15it/s][3/6] extract embeddings:  76%|███████▌  | 35/46 [00:03<00:00, 17.22it/s][3/6] extract embeddings:  80%|████████  | 37/46 [00:03<00:00, 17.22it/s][3/6] extract embeddings:  85%|████████▍ | 39/46 [00:03<00:00, 17.61it/s][3/6] extract embeddings:  89%|████████▉ | 41/46 [00:03<00:00, 17.00it/s][3/6] extract embeddings:  93%|█████████▎| 43/46 [00:03<00:00, 17.17it/s][3/6] extract embeddings:  98%|█████████▊| 45/46 [00:03<00:00, 17.31it/s][3/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 12.02it/s]
[NeMo I 2025-04-17 01:19:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:19:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:19:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:19:30 collections:880] Dataset successfully loaded with 3755 items and total duration provided from manifest is  1.32 hours.
[NeMo I 2025-04-17 01:19:30 collections:886] # 3755 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/59 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/59 [00:01<01:09,  1.21s/it][4/6] extract embeddings:   7%|▋         | 4/59 [00:01<00:14,  3.76it/s][4/6] extract embeddings:  10%|█         | 6/59 [00:01<00:09,  5.65it/s][4/6] extract embeddings:  14%|█▎        | 8/59 [00:01<00:06,  7.74it/s][4/6] extract embeddings:  17%|█▋        | 10/59 [00:01<00:05,  9.75it/s][4/6] extract embeddings:  20%|██        | 12/59 [00:01<00:04, 11.72it/s][4/6] extract embeddings:  25%|██▌       | 15/59 [00:01<00:03, 14.27it/s][4/6] extract embeddings:  31%|███       | 18/59 [00:02<00:02, 15.92it/s][4/6] extract embeddings:  36%|███▌      | 21/59 [00:02<00:02, 17.52it/s][4/6] extract embeddings:  41%|████      | 24/59 [00:02<00:01, 18.70it/s][4/6] extract embeddings:  46%|████▌     | 27/59 [00:02<00:01, 19.09it/s][4/6] extract embeddings:  51%|█████     | 30/59 [00:02<00:01, 19.13it/s][4/6] extract embeddings:  54%|█████▍    | 32/59 [00:02<00:01, 18.99it/s][4/6] extract embeddings:  58%|█████▊    | 34/59 [00:02<00:01, 18.93it/s][4/6] extract embeddings:  61%|██████    | 36/59 [00:02<00:01, 18.76it/s][4/6] extract embeddings:  64%|██████▍   | 38/59 [00:03<00:01, 18.32it/s][4/6] extract embeddings:  69%|██████▉   | 41/59 [00:03<00:00, 19.19it/s][4/6] extract embeddings:  73%|███████▎  | 43/59 [00:03<00:00, 18.99it/s][4/6] extract embeddings:  76%|███████▋  | 45/59 [00:03<00:00, 18.96it/s][4/6] extract embeddings:  81%|████████▏ | 48/59 [00:03<00:00, 20.01it/s][4/6] extract embeddings:  86%|████████▋ | 51/59 [00:03<00:00, 20.74it/s][4/6] extract embeddings:  92%|█████████▏| 54/59 [00:03<00:00, 21.36it/s][4/6] extract embeddings:  97%|█████████▋| 57/59 [00:04<00:00, 20.94it/s][4/6] extract embeddings: 100%|██████████| 59/59 [00:04<00:00, 14.21it/s]
[NeMo I 2025-04-17 01:19:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:19:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:19:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:19:34 collections:880] Dataset successfully loaded with 5585 items and total duration provided from manifest is  1.41 hours.
[NeMo I 2025-04-17 01:19:34 collections:886] # 5585 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/88 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/88 [00:01<01:44,  1.20s/it][5/6] extract embeddings:   5%|▍         | 4/88 [00:01<00:21,  3.85it/s][5/6] extract embeddings:   8%|▊         | 7/88 [00:01<00:11,  7.18it/s][5/6] extract embeddings:  11%|█▏        | 10/88 [00:01<00:07, 10.27it/s][5/6] extract embeddings:  15%|█▍        | 13/88 [00:01<00:05, 13.13it/s][5/6] extract embeddings:  18%|█▊        | 16/88 [00:01<00:04, 16.00it/s][5/6] extract embeddings:  22%|██▏       | 19/88 [00:01<00:03, 17.43it/s][5/6] extract embeddings:  25%|██▌       | 22/88 [00:02<00:03, 19.23it/s][5/6] extract embeddings:  28%|██▊       | 25/88 [00:02<00:03, 20.66it/s][5/6] extract embeddings:  32%|███▏      | 28/88 [00:02<00:02, 21.56it/s][5/6] extract embeddings:  35%|███▌      | 31/88 [00:02<00:02, 20.24it/s][5/6] extract embeddings:  39%|███▊      | 34/88 [00:02<00:02, 20.11it/s][5/6] extract embeddings:  42%|████▏     | 37/88 [00:02<00:02, 19.83it/s][5/6] extract embeddings:  45%|████▌     | 40/88 [00:02<00:02, 19.34it/s][5/6] extract embeddings:  48%|████▊     | 42/88 [00:03<00:02, 19.30it/s][5/6] extract embeddings:  51%|█████     | 45/88 [00:03<00:02, 21.05it/s][5/6] extract embeddings:  55%|█████▍    | 48/88 [00:03<00:01, 22.90it/s][5/6] extract embeddings:  58%|█████▊    | 51/88 [00:03<00:01, 24.24it/s][5/6] extract embeddings:  61%|██████▏   | 54/88 [00:03<00:01, 25.35it/s][5/6] extract embeddings:  65%|██████▍   | 57/88 [00:03<00:01, 25.77it/s][5/6] extract embeddings:  68%|██████▊   | 60/88 [00:03<00:01, 25.01it/s][5/6] extract embeddings:  72%|███████▏  | 63/88 [00:03<00:01, 23.25it/s][5/6] extract embeddings:  75%|███████▌  | 66/88 [00:04<00:01, 21.92it/s][5/6] extract embeddings:  78%|███████▊  | 69/88 [00:04<00:00, 20.76it/s][5/6] extract embeddings:  82%|████████▏ | 72/88 [00:04<00:00, 19.61it/s][5/6] extract embeddings:  85%|████████▌ | 75/88 [00:04<00:00, 19.34it/s][5/6] extract embeddings:  88%|████████▊ | 77/88 [00:04<00:00, 19.46it/s][5/6] extract embeddings:  91%|█████████ | 80/88 [00:04<00:00, 19.72it/s][5/6] extract embeddings:  93%|█████████▎| 82/88 [00:04<00:00, 19.61it/s][5/6] extract embeddings:  97%|█████████▋| 85/88 [00:05<00:00, 20.02it/s][5/6] extract embeddings: 100%|██████████| 88/88 [00:05<00:00, 20.87it/s][5/6] extract embeddings: 100%|██████████| 88/88 [00:05<00:00, 16.98it/s]
[NeMo I 2025-04-17 01:19:40 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:19:40 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:19:40 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:19:40 collections:880] Dataset successfully loaded with 11369 items and total duration provided from manifest is  1.52 hours.
[NeMo I 2025-04-17 01:19:40 collections:886] # 11369 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/178 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/178 [00:01<03:24,  1.16s/it][6/6] extract embeddings:   3%|▎         | 5/178 [00:01<00:33,  5.12it/s][6/6] extract embeddings:   5%|▌         | 9/178 [00:01<00:17,  9.59it/s][6/6] extract embeddings:   7%|▋         | 13/178 [00:01<00:11, 14.13it/s][6/6] extract embeddings:  10%|▉         | 17/178 [00:01<00:08, 17.89it/s][6/6] extract embeddings:  12%|█▏        | 21/178 [00:01<00:07, 21.22it/s][6/6] extract embeddings:  14%|█▍        | 25/178 [00:01<00:06, 24.35it/s][6/6] extract embeddings:  16%|█▋        | 29/178 [00:01<00:05, 26.81it/s][6/6] extract embeddings:  19%|█▊        | 33/178 [00:02<00:05, 27.98it/s][6/6] extract embeddings:  21%|██        | 37/178 [00:02<00:04, 28.81it/s][6/6] extract embeddings:  23%|██▎       | 41/178 [00:02<00:04, 29.75it/s][6/6] extract embeddings:  25%|██▌       | 45/178 [00:02<00:04, 30.79it/s][6/6] extract embeddings:  28%|██▊       | 49/178 [00:02<00:04, 31.23it/s][6/6] extract embeddings:  30%|██▉       | 53/178 [00:02<00:03, 31.31it/s][6/6] extract embeddings:  32%|███▏      | 57/178 [00:02<00:03, 30.49it/s][6/6] extract embeddings:  34%|███▍      | 61/178 [00:03<00:03, 30.27it/s][6/6] extract embeddings:  37%|███▋      | 65/178 [00:03<00:03, 31.63it/s][6/6] extract embeddings:  39%|███▉      | 69/178 [00:03<00:03, 32.18it/s][6/6] extract embeddings:  41%|████      | 73/178 [00:03<00:03, 33.19it/s][6/6] extract embeddings:  43%|████▎     | 77/178 [00:03<00:03, 32.58it/s][6/6] extract embeddings:  46%|████▌     | 81/178 [00:03<00:03, 31.94it/s][6/6] extract embeddings:  48%|████▊     | 85/178 [00:03<00:02, 32.68it/s][6/6] extract embeddings:  50%|█████     | 89/178 [00:03<00:02, 32.72it/s][6/6] extract embeddings:  52%|█████▏    | 93/178 [00:03<00:02, 32.00it/s][6/6] extract embeddings:  54%|█████▍    | 97/178 [00:04<00:02, 31.37it/s][6/6] extract embeddings:  57%|█████▋    | 101/178 [00:04<00:02, 32.04it/s][6/6] extract embeddings:  59%|█████▉    | 105/178 [00:04<00:02, 32.42it/s][6/6] extract embeddings:  61%|██████    | 109/178 [00:04<00:02, 33.08it/s][6/6] extract embeddings:  63%|██████▎   | 113/178 [00:04<00:01, 32.76it/s][6/6] extract embeddings:  66%|██████▌   | 117/178 [00:04<00:01, 32.93it/s][6/6] extract embeddings:  68%|██████▊   | 121/178 [00:04<00:01, 33.40it/s][6/6] extract embeddings:  70%|███████   | 125/178 [00:04<00:01, 31.33it/s][6/6] extract embeddings:  72%|███████▏  | 129/178 [00:05<00:01, 30.30it/s][6/6] extract embeddings:  75%|███████▍  | 133/178 [00:05<00:01, 28.14it/s][6/6] extract embeddings:  76%|███████▋  | 136/178 [00:05<00:01, 26.61it/s][6/6] extract embeddings:  78%|███████▊  | 139/178 [00:05<00:01, 24.53it/s][6/6] extract embeddings:  80%|███████▉  | 142/178 [00:05<00:01, 24.49it/s][6/6] extract embeddings:  82%|████████▏ | 146/178 [00:05<00:01, 26.60it/s][6/6] extract embeddings:  84%|████████▍ | 150/178 [00:05<00:00, 28.58it/s][6/6] extract embeddings:  87%|████████▋ | 154/178 [00:06<00:00, 30.08it/s][6/6] extract embeddings:  89%|████████▉ | 158/178 [00:06<00:00, 29.50it/s][6/6] extract embeddings:  91%|█████████ | 162/178 [00:06<00:00, 29.57it/s][6/6] extract embeddings:  93%|█████████▎| 165/178 [00:06<00:00, 29.10it/s][6/6] extract embeddings:  94%|█████████▍| 168/178 [00:06<00:00, 27.31it/s][6/6] extract embeddings:  96%|█████████▌| 171/178 [00:06<00:00, 27.50it/s][6/6] extract embeddings:  98%|█████████▊| 174/178 [00:06<00:00, 27.74it/s][6/6] extract embeddings:  99%|█████████▉| 177/178 [00:06<00:00, 28.28it/s][6/6] extract embeddings: 100%|██████████| 178/178 [00:06<00:00, 25.66it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.13it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.56it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.20it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.68it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.34it/s]
[NeMo I 2025-04-17 01:19:49 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:19:50 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              47.483834   444.120  ...   18.725031  4.216210
    Harker-ES                       38.876353  2178.782  ...   47.600092  2.184711
    Harker-MN                       49.213804   366.767  ...   30.062920  8.196735
    Longfellow-Block-1              35.404076   492.417  ...   12.039956  2.445073
    TOTAL                           40.571998  3482.086  ...  108.427998  3.113881
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:19:50 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0648 | MISS: 0.3098 | CER: 0.0311 | DER: 0.4057 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.90s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.99s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.27s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.19s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:20:03 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:20:03 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:20:03 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:20:03 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:20:03 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:20:03 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:20:03 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:20:03 features:305] PADDING: 16
[NeMo I 2025-04-17 01:20:03 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:20:03 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:20:03 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:20:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:20:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:20:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:20:03 collections:880] Dataset successfully loaded with 2092 items and total duration provided from manifest is  1.06 hours.
[NeMo I 2025-04-17 01:20:03 collections:886] # 2092 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:04,  2.02s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.44it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.93it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.59it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.25it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  9.08it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.92it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 12.97it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:03<00:00, 14.35it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 15.30it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 15.65it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 15.02it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 14.33it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 15.04it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 15.54it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.58it/s]
[NeMo I 2025-04-17 01:20:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:20:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:20:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:20:07 collections:880] Dataset successfully loaded with 2363 items and total duration provided from manifest is  1.11 hours.
[NeMo I 2025-04-17 01:20:07 collections:886] # 2363 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:54,  1.52s/it][2/6] extract embeddings:  11%|█         | 4/37 [00:01<00:10,  3.04it/s][2/6] extract embeddings:  16%|█▌        | 6/37 [00:01<00:06,  4.77it/s][2/6] extract embeddings:  22%|██▏       | 8/37 [00:01<00:04,  6.62it/s][2/6] extract embeddings:  27%|██▋       | 10/37 [00:02<00:03,  8.65it/s][2/6] extract embeddings:  32%|███▏      | 12/37 [00:02<00:02, 10.63it/s][2/6] extract embeddings:  38%|███▊      | 14/37 [00:02<00:01, 12.34it/s][2/6] extract embeddings:  46%|████▌     | 17/37 [00:02<00:01, 14.86it/s][2/6] extract embeddings:  54%|█████▍    | 20/37 [00:02<00:01, 16.82it/s][2/6] extract embeddings:  59%|█████▉    | 22/37 [00:02<00:00, 17.30it/s][2/6] extract embeddings:  65%|██████▍   | 24/37 [00:02<00:00, 17.90it/s][2/6] extract embeddings:  73%|███████▎  | 27/37 [00:02<00:00, 18.80it/s][2/6] extract embeddings:  78%|███████▊  | 29/37 [00:02<00:00, 17.66it/s][2/6] extract embeddings:  84%|████████▍ | 31/37 [00:03<00:00, 16.74it/s][2/6] extract embeddings:  89%|████████▉ | 33/37 [00:03<00:00, 16.69it/s][2/6] extract embeddings:  97%|█████████▋| 36/37 [00:03<00:00, 17.58it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 10.67it/s]
[NeMo I 2025-04-17 01:20:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:20:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:20:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:20:11 collections:880] Dataset successfully loaded with 2800 items and total duration provided from manifest is  1.17 hours.
[NeMo I 2025-04-17 01:20:11 collections:886] # 2800 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:51,  1.20s/it][3/6] extract embeddings:   9%|▉         | 4/44 [00:01<00:10,  3.81it/s][3/6] extract embeddings:  14%|█▎        | 6/44 [00:01<00:06,  5.78it/s][3/6] extract embeddings:  20%|██        | 9/44 [00:01<00:03,  8.88it/s][3/6] extract embeddings:  25%|██▌       | 11/44 [00:01<00:03, 10.67it/s][3/6] extract embeddings:  32%|███▏      | 14/44 [00:01<00:02, 13.18it/s][3/6] extract embeddings:  36%|███▋      | 16/44 [00:01<00:01, 14.26it/s][3/6] extract embeddings:  43%|████▎     | 19/44 [00:02<00:01, 16.08it/s][3/6] extract embeddings:  50%|█████     | 22/44 [00:02<00:01, 18.19it/s][3/6] extract embeddings:  57%|█████▋    | 25/44 [00:02<00:00, 19.32it/s][3/6] extract embeddings:  64%|██████▎   | 28/44 [00:02<00:00, 19.43it/s][3/6] extract embeddings:  70%|███████   | 31/44 [00:02<00:00, 20.06it/s][3/6] extract embeddings:  77%|███████▋  | 34/44 [00:02<00:00, 18.85it/s][3/6] extract embeddings:  84%|████████▍ | 37/44 [00:02<00:00, 18.87it/s][3/6] extract embeddings:  91%|█████████ | 40/44 [00:03<00:00, 19.46it/s][3/6] extract embeddings:  98%|█████████▊| 43/44 [00:03<00:00, 19.76it/s][3/6] extract embeddings: 100%|██████████| 44/44 [00:03<00:00, 13.17it/s]
[NeMo I 2025-04-17 01:20:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:20:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:20:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:20:15 collections:880] Dataset successfully loaded with 3614 items and total duration provided from manifest is  1.24 hours.
[NeMo I 2025-04-17 01:20:15 collections:886] # 3614 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/57 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/57 [00:01<01:24,  1.51s/it][4/6] extract embeddings:   7%|▋         | 4/57 [00:01<00:17,  3.04it/s][4/6] extract embeddings:  11%|█         | 6/57 [00:01<00:10,  4.78it/s][4/6] extract embeddings:  14%|█▍        | 8/57 [00:01<00:07,  6.76it/s][4/6] extract embeddings:  19%|█▉        | 11/57 [00:02<00:04,  9.65it/s][4/6] extract embeddings:  23%|██▎       | 13/57 [00:02<00:03, 11.40it/s][4/6] extract embeddings:  26%|██▋       | 15/57 [00:02<00:03, 12.74it/s][4/6] extract embeddings:  30%|██▉       | 17/57 [00:02<00:02, 14.16it/s][4/6] extract embeddings:  33%|███▎      | 19/57 [00:02<00:02, 15.40it/s][4/6] extract embeddings:  37%|███▋      | 21/57 [00:02<00:02, 16.38it/s][4/6] extract embeddings:  40%|████      | 23/57 [00:02<00:01, 17.23it/s][4/6] extract embeddings:  46%|████▌     | 26/57 [00:02<00:01, 18.44it/s][4/6] extract embeddings:  51%|█████     | 29/57 [00:02<00:01, 19.03it/s][4/6] extract embeddings:  56%|█████▌    | 32/57 [00:03<00:01, 19.58it/s][4/6] extract embeddings:  61%|██████▏   | 35/57 [00:03<00:01, 19.27it/s][4/6] extract embeddings:  67%|██████▋   | 38/57 [00:03<00:00, 19.41it/s][4/6] extract embeddings:  70%|███████   | 40/57 [00:03<00:00, 19.38it/s][4/6] extract embeddings:  74%|███████▎  | 42/57 [00:03<00:00, 18.83it/s][4/6] extract embeddings:  79%|███████▉  | 45/57 [00:03<00:00, 19.64it/s][4/6] extract embeddings:  82%|████████▏ | 47/57 [00:03<00:00, 19.26it/s][4/6] extract embeddings:  86%|████████▌ | 49/57 [00:03<00:00, 19.40it/s][4/6] extract embeddings:  89%|████████▉ | 51/57 [00:04<00:00, 19.51it/s][4/6] extract embeddings:  93%|█████████▎| 53/57 [00:04<00:00, 19.37it/s][4/6] extract embeddings:  96%|█████████▋| 55/57 [00:04<00:00, 19.41it/s][4/6] extract embeddings: 100%|██████████| 57/57 [00:04<00:00, 12.95it/s]
[NeMo I 2025-04-17 01:20:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:20:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:20:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:20:19 collections:880] Dataset successfully loaded with 5326 items and total duration provided from manifest is  1.33 hours.
[NeMo I 2025-04-17 01:20:19 collections:886] # 5326 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/84 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/84 [00:01<02:05,  1.51s/it][5/6] extract embeddings:   5%|▍         | 4/84 [00:01<00:25,  3.11it/s][5/6] extract embeddings:   8%|▊         | 7/84 [00:01<00:13,  5.80it/s][5/6] extract embeddings:  12%|█▏        | 10/84 [00:01<00:08,  8.48it/s][5/6] extract embeddings:  15%|█▌        | 13/84 [00:02<00:06, 11.03it/s][5/6] extract embeddings:  19%|█▉        | 16/84 [00:02<00:05, 13.40it/s][5/6] extract embeddings:  23%|██▎       | 19/84 [00:02<00:04, 15.44it/s][5/6] extract embeddings:  26%|██▌       | 22/84 [00:02<00:03, 17.14it/s][5/6] extract embeddings:  30%|██▉       | 25/84 [00:02<00:03, 18.25it/s][5/6] extract embeddings:  33%|███▎      | 28/84 [00:02<00:03, 18.53it/s][5/6] extract embeddings:  37%|███▋      | 31/84 [00:02<00:02, 19.20it/s][5/6] extract embeddings:  40%|████      | 34/84 [00:03<00:02, 19.12it/s][5/6] extract embeddings:  44%|████▍     | 37/84 [00:03<00:02, 19.35it/s][5/6] extract embeddings:  48%|████▊     | 40/84 [00:03<00:02, 19.98it/s][5/6] extract embeddings:  51%|█████     | 43/84 [00:03<00:02, 19.87it/s][5/6] extract embeddings:  55%|█████▍    | 46/84 [00:03<00:01, 19.70it/s][5/6] extract embeddings:  58%|█████▊    | 49/84 [00:03<00:01, 20.20it/s][5/6] extract embeddings:  62%|██████▏   | 52/84 [00:03<00:01, 21.92it/s][5/6] extract embeddings:  65%|██████▌   | 55/84 [00:04<00:01, 22.67it/s][5/6] extract embeddings:  69%|██████▉   | 58/84 [00:04<00:01, 21.31it/s][5/6] extract embeddings:  73%|███████▎  | 61/84 [00:04<00:01, 21.83it/s][5/6] extract embeddings:  76%|███████▌  | 64/84 [00:04<00:00, 21.35it/s][5/6] extract embeddings:  80%|███████▉  | 67/84 [00:04<00:00, 21.07it/s][5/6] extract embeddings:  83%|████████▎ | 70/84 [00:04<00:00, 20.82it/s][5/6] extract embeddings:  87%|████████▋ | 73/84 [00:04<00:00, 21.18it/s][5/6] extract embeddings:  90%|█████████ | 76/84 [00:05<00:00, 21.45it/s][5/6] extract embeddings:  94%|█████████▍| 79/84 [00:05<00:00, 22.00it/s][5/6] extract embeddings:  98%|█████████▊| 82/84 [00:05<00:00, 21.05it/s][5/6] extract embeddings: 100%|██████████| 84/84 [00:05<00:00, 15.41it/s]
[NeMo I 2025-04-17 01:20:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:20:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:20:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:20:25 collections:880] Dataset successfully loaded with 10838 items and total duration provided from manifest is  1.45 hours.
[NeMo I 2025-04-17 01:20:25 collections:886] # 10838 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/170 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/170 [00:01<03:21,  1.19s/it][6/6] extract embeddings:   2%|▏         | 4/170 [00:01<00:41,  3.96it/s][6/6] extract embeddings:   4%|▍         | 7/170 [00:01<00:22,  7.22it/s][6/6] extract embeddings:   6%|▌         | 10/170 [00:01<00:15, 10.45it/s][6/6] extract embeddings:   8%|▊         | 13/170 [00:01<00:11, 13.72it/s][6/6] extract embeddings:   9%|▉         | 16/170 [00:01<00:09, 16.80it/s][6/6] extract embeddings:  11%|█         | 19/170 [00:01<00:08, 18.11it/s][6/6] extract embeddings:  14%|█▎        | 23/170 [00:02<00:06, 21.53it/s][6/6] extract embeddings:  15%|█▌        | 26/170 [00:02<00:06, 22.08it/s][6/6] extract embeddings:  17%|█▋        | 29/170 [00:02<00:05, 23.77it/s][6/6] extract embeddings:  19%|█▉        | 32/170 [00:02<00:05, 24.17it/s][6/6] extract embeddings:  21%|██        | 35/170 [00:02<00:05, 24.08it/s][6/6] extract embeddings:  22%|██▏       | 38/170 [00:02<00:05, 24.58it/s][6/6] extract embeddings:  24%|██▍       | 41/170 [00:02<00:05, 25.15it/s][6/6] extract embeddings:  26%|██▌       | 44/170 [00:02<00:05, 24.53it/s][6/6] extract embeddings:  28%|██▊       | 47/170 [00:02<00:04, 25.31it/s][6/6] extract embeddings:  29%|██▉       | 50/170 [00:03<00:04, 26.55it/s][6/6] extract embeddings:  31%|███       | 53/170 [00:03<00:04, 26.23it/s][6/6] extract embeddings:  33%|███▎      | 56/170 [00:03<00:04, 27.08it/s][6/6] extract embeddings:  35%|███▍      | 59/170 [00:03<00:04, 26.45it/s][6/6] extract embeddings:  36%|███▋      | 62/170 [00:03<00:03, 27.33it/s][6/6] extract embeddings:  39%|███▉      | 66/170 [00:03<00:03, 27.28it/s][6/6] extract embeddings:  41%|████      | 69/170 [00:03<00:03, 27.80it/s][6/6] extract embeddings:  42%|████▏     | 72/170 [00:03<00:03, 27.69it/s][6/6] extract embeddings:  44%|████▍     | 75/170 [00:03<00:03, 26.52it/s][6/6] extract embeddings:  46%|████▌     | 78/170 [00:04<00:03, 25.23it/s][6/6] extract embeddings:  48%|████▊     | 81/170 [00:04<00:03, 26.18it/s][6/6] extract embeddings:  50%|█████     | 85/170 [00:04<00:02, 28.51it/s][6/6] extract embeddings:  52%|█████▏    | 88/170 [00:04<00:02, 27.72it/s][6/6] extract embeddings:  54%|█████▍    | 92/170 [00:04<00:02, 28.81it/s][6/6] extract embeddings:  56%|█████▌    | 95/170 [00:04<00:02, 26.27it/s][6/6] extract embeddings:  58%|█████▊    | 98/170 [00:04<00:02, 26.92it/s][6/6] extract embeddings:  59%|█████▉    | 101/170 [00:04<00:02, 26.96it/s][6/6] extract embeddings:  62%|██████▏   | 105/170 [00:05<00:02, 28.41it/s][6/6] extract embeddings:  64%|██████▎   | 108/170 [00:05<00:02, 27.40it/s][6/6] extract embeddings:  65%|██████▌   | 111/170 [00:05<00:02, 26.67it/s][6/6] extract embeddings:  67%|██████▋   | 114/170 [00:05<00:02, 27.26it/s][6/6] extract embeddings:  69%|██████▉   | 117/170 [00:05<00:02, 26.41it/s][6/6] extract embeddings:  71%|███████   | 120/170 [00:05<00:01, 27.06it/s][6/6] extract embeddings:  72%|███████▏  | 123/170 [00:05<00:01, 27.75it/s][6/6] extract embeddings:  74%|███████▍  | 126/170 [00:05<00:01, 28.01it/s][6/6] extract embeddings:  76%|███████▌  | 129/170 [00:05<00:01, 27.17it/s][6/6] extract embeddings:  78%|███████▊  | 132/170 [00:06<00:01, 26.54it/s][6/6] extract embeddings:  80%|████████  | 136/170 [00:06<00:01, 26.93it/s][6/6] extract embeddings:  82%|████████▏ | 139/170 [00:06<00:01, 27.07it/s][6/6] extract embeddings:  84%|████████▎ | 142/170 [00:06<00:01, 27.47it/s][6/6] extract embeddings:  85%|████████▌ | 145/170 [00:06<00:00, 26.53it/s][6/6] extract embeddings:  87%|████████▋ | 148/170 [00:06<00:00, 25.87it/s][6/6] extract embeddings:  89%|████████▉ | 151/170 [00:06<00:00, 26.94it/s][6/6] extract embeddings:  91%|█████████ | 154/170 [00:06<00:00, 26.28it/s][6/6] extract embeddings:  92%|█████████▏| 157/170 [00:07<00:00, 26.02it/s][6/6] extract embeddings:  94%|█████████▍| 160/170 [00:07<00:00, 25.39it/s][6/6] extract embeddings:  96%|█████████▌| 163/170 [00:07<00:00, 25.21it/s][6/6] extract embeddings:  98%|█████████▊| 166/170 [00:07<00:00, 25.14it/s][6/6] extract embeddings:  99%|█████████▉| 169/170 [00:07<00:00, 25.96it/s][6/6] extract embeddings: 100%|██████████| 170/170 [00:07<00:00, 22.52it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.97it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.67it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.37it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.85it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.46it/s]
[NeMo I 2025-04-17 01:20:34 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:20:36 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              48.661365   444.120  ...   15.495075  3.488939
    Harker-ES                       41.420453  2178.782  ...   45.486535  2.087705
    Harker-MN                       51.337507   366.767  ...   30.573944  8.336067
    Longfellow-Block-1              37.920520   492.417  ...   11.247987  2.284240
    TOTAL                           42.893609  3482.086  ...  102.803541  2.952355
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:20:36 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0615 | MISS: 0.3380 | CER: 0.0295 | DER: 0.4289 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.80s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:20:48 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:20:48 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:20:48 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:20:48 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:20:48 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:20:48 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:20:48 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:20:48 features:305] PADDING: 16
[NeMo I 2025-04-17 01:20:49 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:20:49 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:20:49 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:20:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:20:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:20:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:20:49 collections:880] Dataset successfully loaded with 2058 items and total duration provided from manifest is  0.96 hours.
[NeMo I 2025-04-17 01:20:49 collections:886] # 2058 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:05,  2.05s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:12,  2.40it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:07,  3.82it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.47it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.15it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  8.69it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.35it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.06it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:01, 13.27it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:03<00:00, 14.08it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 14.87it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 15.23it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 15.64it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 15.07it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 15.66it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 15.97it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.45it/s]
[NeMo I 2025-04-17 01:20:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:20:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:20:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:20:53 collections:880] Dataset successfully loaded with 2303 items and total duration provided from manifest is  1.01 hours.
[NeMo I 2025-04-17 01:20:53 collections:886] # 2303 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:51,  1.47s/it][2/6] extract embeddings:   8%|▊         | 3/36 [00:01<00:13,  2.36it/s][2/6] extract embeddings:  14%|█▍        | 5/36 [00:01<00:07,  4.24it/s][2/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  6.26it/s][2/6] extract embeddings:  25%|██▌       | 9/36 [00:01<00:03,  8.13it/s][2/6] extract embeddings:  31%|███       | 11/36 [00:02<00:02,  9.89it/s][2/6] extract embeddings:  36%|███▌      | 13/36 [00:02<00:01, 11.57it/s][2/6] extract embeddings:  42%|████▏     | 15/36 [00:02<00:01, 12.90it/s][2/6] extract embeddings:  50%|█████     | 18/36 [00:02<00:01, 15.28it/s][2/6] extract embeddings:  56%|█████▌    | 20/36 [00:02<00:00, 16.35it/s][2/6] extract embeddings:  61%|██████    | 22/36 [00:02<00:00, 17.22it/s][2/6] extract embeddings:  67%|██████▋   | 24/36 [00:02<00:00, 17.35it/s][2/6] extract embeddings:  72%|███████▏  | 26/36 [00:02<00:00, 17.92it/s][2/6] extract embeddings:  81%|████████  | 29/36 [00:03<00:00, 18.16it/s][2/6] extract embeddings:  86%|████████▌ | 31/36 [00:03<00:00, 17.50it/s][2/6] extract embeddings:  92%|█████████▏| 33/36 [00:03<00:00, 18.03it/s][2/6] extract embeddings:  97%|█████████▋| 35/36 [00:03<00:00, 18.20it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 10.43it/s]
[NeMo I 2025-04-17 01:20:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:20:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:20:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:20:57 collections:880] Dataset successfully loaded with 2684 items and total duration provided from manifest is  1.07 hours.
[NeMo I 2025-04-17 01:20:57 collections:886] # 2684 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:47,  1.16s/it][3/6] extract embeddings:   7%|▋         | 3/42 [00:01<00:13,  2.92it/s][3/6] extract embeddings:  12%|█▏        | 5/42 [00:01<00:07,  5.02it/s][3/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:04,  7.33it/s][3/6] extract embeddings:  21%|██▏       | 9/42 [00:01<00:03,  9.36it/s][3/6] extract embeddings:  29%|██▊       | 12/42 [00:01<00:02, 12.60it/s][3/6] extract embeddings:  33%|███▎      | 14/42 [00:01<00:01, 14.05it/s][3/6] extract embeddings:  38%|███▊      | 16/42 [00:01<00:01, 15.33it/s][3/6] extract embeddings:  45%|████▌     | 19/42 [00:02<00:01, 17.56it/s][3/6] extract embeddings:  52%|█████▏    | 22/42 [00:02<00:01, 19.04it/s][3/6] extract embeddings:  60%|█████▉    | 25/42 [00:02<00:00, 19.89it/s][3/6] extract embeddings:  67%|██████▋   | 28/42 [00:02<00:00, 20.81it/s][3/6] extract embeddings:  74%|███████▍  | 31/42 [00:02<00:00, 20.41it/s][3/6] extract embeddings:  81%|████████  | 34/42 [00:02<00:00, 20.00it/s][3/6] extract embeddings:  88%|████████▊ | 37/42 [00:02<00:00, 19.31it/s][3/6] extract embeddings:  95%|█████████▌| 40/42 [00:03<00:00, 19.97it/s][3/6] extract embeddings: 100%|██████████| 42/42 [00:03<00:00, 12.97it/s]
[NeMo I 2025-04-17 01:21:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:21:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:21:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:21:03 collections:880] Dataset successfully loaded with 3423 items and total duration provided from manifest is  1.14 hours.
[NeMo I 2025-04-17 01:21:03 collections:886] # 3423 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/54 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/54 [00:01<01:03,  1.20s/it][4/6] extract embeddings:   7%|▋         | 4/54 [00:01<00:13,  3.78it/s][4/6] extract embeddings:  11%|█         | 6/54 [00:01<00:08,  5.78it/s][4/6] extract embeddings:  17%|█▋        | 9/54 [00:01<00:04,  9.12it/s][4/6] extract embeddings:  22%|██▏       | 12/54 [00:01<00:03, 12.09it/s][4/6] extract embeddings:  28%|██▊       | 15/54 [00:01<00:02, 14.16it/s][4/6] extract embeddings:  33%|███▎      | 18/54 [00:01<00:02, 16.13it/s][4/6] extract embeddings:  39%|███▉      | 21/54 [00:02<00:01, 18.01it/s][4/6] extract embeddings:  44%|████▍     | 24/54 [00:02<00:01, 19.08it/s][4/6] extract embeddings:  50%|█████     | 27/54 [00:02<00:01, 20.64it/s][4/6] extract embeddings:  56%|█████▌    | 30/54 [00:02<00:01, 21.56it/s][4/6] extract embeddings:  61%|██████    | 33/54 [00:02<00:01, 20.87it/s][4/6] extract embeddings:  67%|██████▋   | 36/54 [00:02<00:00, 20.61it/s][4/6] extract embeddings:  72%|███████▏  | 39/54 [00:02<00:00, 19.63it/s][4/6] extract embeddings:  78%|███████▊  | 42/54 [00:03<00:00, 19.01it/s][4/6] extract embeddings:  83%|████████▎ | 45/54 [00:03<00:00, 19.23it/s][4/6] extract embeddings:  87%|████████▋ | 47/54 [00:03<00:00, 19.18it/s][4/6] extract embeddings:  93%|█████████▎| 50/54 [00:03<00:00, 19.61it/s][4/6] extract embeddings:  98%|█████████▊| 53/54 [00:03<00:00, 19.84it/s][4/6] extract embeddings: 100%|██████████| 54/54 [00:03<00:00, 14.34it/s]
[NeMo I 2025-04-17 01:21:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:21:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:21:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:21:07 collections:880] Dataset successfully loaded with 5005 items and total duration provided from manifest is  1.23 hours.
[NeMo I 2025-04-17 01:21:07 collections:886] # 5005 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/79 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/79 [00:01<01:31,  1.17s/it][5/6] extract embeddings:   5%|▌         | 4/79 [00:01<00:19,  3.92it/s][5/6] extract embeddings:   8%|▊         | 6/79 [00:01<00:12,  5.95it/s][5/6] extract embeddings:  10%|█         | 8/79 [00:01<00:08,  8.09it/s][5/6] extract embeddings:  13%|█▎        | 10/79 [00:01<00:06, 10.18it/s][5/6] extract embeddings:  16%|█▋        | 13/79 [00:01<00:05, 13.08it/s][5/6] extract embeddings:  20%|██        | 16/79 [00:01<00:04, 15.31it/s][5/6] extract embeddings:  24%|██▍       | 19/79 [00:02<00:03, 17.33it/s][5/6] extract embeddings:  28%|██▊       | 22/79 [00:02<00:03, 18.86it/s][5/6] extract embeddings:  32%|███▏      | 25/79 [00:02<00:02, 19.26it/s][5/6] extract embeddings:  35%|███▌      | 28/79 [00:02<00:02, 19.57it/s][5/6] extract embeddings:  39%|███▉      | 31/79 [00:02<00:02, 19.97it/s][5/6] extract embeddings:  43%|████▎     | 34/79 [00:02<00:02, 21.08it/s][5/6] extract embeddings:  47%|████▋     | 37/79 [00:02<00:01, 21.18it/s][5/6] extract embeddings:  51%|█████     | 40/79 [00:02<00:01, 21.81it/s][5/6] extract embeddings:  54%|█████▍    | 43/79 [00:03<00:01, 21.90it/s][5/6] extract embeddings:  58%|█████▊    | 46/79 [00:03<00:01, 21.84it/s][5/6] extract embeddings:  62%|██████▏   | 49/79 [00:03<00:01, 21.26it/s][5/6] extract embeddings:  66%|██████▌   | 52/79 [00:03<00:01, 21.55it/s][5/6] extract embeddings:  70%|██████▉   | 55/79 [00:03<00:01, 21.85it/s][5/6] extract embeddings:  73%|███████▎  | 58/79 [00:03<00:00, 21.67it/s][5/6] extract embeddings:  77%|███████▋  | 61/79 [00:03<00:00, 21.45it/s][5/6] extract embeddings:  81%|████████  | 64/79 [00:04<00:00, 22.05it/s][5/6] extract embeddings:  85%|████████▍ | 67/79 [00:04<00:00, 21.85it/s][5/6] extract embeddings:  89%|████████▊ | 70/79 [00:04<00:00, 22.54it/s][5/6] extract embeddings:  92%|█████████▏| 73/79 [00:04<00:00, 22.53it/s][5/6] extract embeddings:  96%|█████████▌| 76/79 [00:04<00:00, 21.93it/s][5/6] extract embeddings: 100%|██████████| 79/79 [00:04<00:00, 22.61it/s][5/6] extract embeddings: 100%|██████████| 79/79 [00:04<00:00, 16.48it/s]
[NeMo I 2025-04-17 01:21:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:21:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:21:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:21:12 collections:880] Dataset successfully loaded with 10139 items and total duration provided from manifest is  1.35 hours.
[NeMo I 2025-04-17 01:21:12 collections:886] # 10139 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/159 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/159 [00:01<03:27,  1.31s/it][6/6] extract embeddings:   3%|▎         | 4/159 [00:01<00:42,  3.63it/s][6/6] extract embeddings:   4%|▍         | 7/159 [00:01<00:22,  6.76it/s][6/6] extract embeddings:   6%|▋         | 10/159 [00:01<00:14, 10.12it/s][6/6] extract embeddings:   8%|▊         | 13/159 [00:01<00:11, 13.12it/s][6/6] extract embeddings:  10%|█         | 16/159 [00:01<00:08, 16.02it/s][6/6] extract embeddings:  12%|█▏        | 19/159 [00:01<00:07, 18.64it/s][6/6] extract embeddings:  14%|█▍        | 22/159 [00:02<00:06, 20.88it/s][6/6] extract embeddings:  16%|█▌        | 25/159 [00:02<00:05, 22.72it/s][6/6] extract embeddings:  18%|█▊        | 28/159 [00:02<00:05, 22.88it/s][6/6] extract embeddings:  19%|█▉        | 31/159 [00:02<00:05, 23.73it/s][6/6] extract embeddings:  21%|██▏       | 34/159 [00:02<00:04, 25.05it/s][6/6] extract embeddings:  23%|██▎       | 37/159 [00:02<00:04, 25.32it/s][6/6] extract embeddings:  25%|██▌       | 40/159 [00:02<00:04, 25.84it/s][6/6] extract embeddings:  27%|██▋       | 43/159 [00:02<00:04, 26.15it/s][6/6] extract embeddings:  29%|██▉       | 46/159 [00:02<00:04, 26.65it/s][6/6] extract embeddings:  31%|███       | 49/159 [00:03<00:04, 26.50it/s][6/6] extract embeddings:  33%|███▎      | 52/159 [00:03<00:04, 24.52it/s][6/6] extract embeddings:  35%|███▍      | 55/159 [00:03<00:04, 24.91it/s][6/6] extract embeddings:  36%|███▋      | 58/159 [00:03<00:04, 25.03it/s][6/6] extract embeddings:  38%|███▊      | 61/159 [00:03<00:03, 25.97it/s][6/6] extract embeddings:  40%|████      | 64/159 [00:03<00:03, 26.38it/s][6/6] extract embeddings:  42%|████▏     | 67/159 [00:03<00:03, 26.66it/s][6/6] extract embeddings:  44%|████▍     | 70/159 [00:03<00:03, 26.07it/s][6/6] extract embeddings:  46%|████▌     | 73/159 [00:04<00:03, 24.74it/s][6/6] extract embeddings:  48%|████▊     | 76/159 [00:04<00:03, 23.94it/s][6/6] extract embeddings:  50%|████▉     | 79/159 [00:04<00:03, 25.46it/s][6/6] extract embeddings:  52%|█████▏    | 82/159 [00:04<00:03, 25.64it/s][6/6] extract embeddings:  53%|█████▎    | 85/159 [00:04<00:02, 26.36it/s][6/6] extract embeddings:  55%|█████▌    | 88/159 [00:04<00:02, 27.10it/s][6/6] extract embeddings:  57%|█████▋    | 91/159 [00:04<00:02, 26.16it/s][6/6] extract embeddings:  59%|█████▉    | 94/159 [00:04<00:02, 24.75it/s][6/6] extract embeddings:  61%|██████    | 97/159 [00:04<00:02, 24.61it/s][6/6] extract embeddings:  63%|██████▎   | 100/159 [00:05<00:02, 24.93it/s][6/6] extract embeddings:  65%|██████▍   | 103/159 [00:05<00:02, 26.02it/s][6/6] extract embeddings:  67%|██████▋   | 106/159 [00:05<00:02, 25.98it/s][6/6] extract embeddings:  69%|██████▊   | 109/159 [00:05<00:01, 25.16it/s][6/6] extract embeddings:  70%|███████   | 112/159 [00:05<00:01, 25.37it/s][6/6] extract embeddings:  72%|███████▏  | 115/159 [00:05<00:01, 24.94it/s][6/6] extract embeddings:  74%|███████▍  | 118/159 [00:05<00:01, 24.30it/s][6/6] extract embeddings:  76%|███████▌  | 121/159 [00:05<00:01, 24.53it/s][6/6] extract embeddings:  78%|███████▊  | 124/159 [00:06<00:01, 24.20it/s][6/6] extract embeddings:  80%|███████▉  | 127/159 [00:06<00:01, 24.47it/s][6/6] extract embeddings:  82%|████████▏ | 130/159 [00:06<00:01, 25.30it/s][6/6] extract embeddings:  84%|████████▎ | 133/159 [00:06<00:01, 24.49it/s][6/6] extract embeddings:  86%|████████▌ | 136/159 [00:06<00:00, 24.62it/s][6/6] extract embeddings:  87%|████████▋ | 139/159 [00:06<00:00, 25.08it/s][6/6] extract embeddings:  89%|████████▉ | 142/159 [00:06<00:00, 25.20it/s][6/6] extract embeddings:  91%|█████████ | 145/159 [00:06<00:00, 25.63it/s][6/6] extract embeddings:  93%|█████████▎| 148/159 [00:07<00:00, 26.00it/s][6/6] extract embeddings:  95%|█████████▍| 151/159 [00:07<00:00, 26.01it/s][6/6] extract embeddings:  97%|█████████▋| 154/159 [00:07<00:00, 26.17it/s][6/6] extract embeddings:  99%|█████████▊| 157/159 [00:07<00:00, 26.21it/s][6/6] extract embeddings: 100%|██████████| 159/159 [00:07<00:00, 21.33it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:02,  1.40it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.55it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.24it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.78it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.29it/s]
[NeMo I 2025-04-17 01:21:22 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:21:23 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              52.222292   444.120  ...   17.940029  4.039455
    Harker-ES                       44.487972  2178.782  ...   41.429253  1.901487
    Harker-MN                       52.419689   366.767  ...   32.114936  8.756223
    Longfellow-Block-1              41.359054   492.417  ...   11.786969  2.393697
    TOTAL                           45.867411  3482.086  ...  103.271187  2.965785
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:21:23 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0555 | MISS: 0.3736 | CER: 0.0297 | DER: 0.4587 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.20
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.2 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.86s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.94s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:21:36 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:21:36 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:21:36 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:21:36 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:21:36 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:21:36 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:21:36 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:21:36 features:305] PADDING: 16
[NeMo I 2025-04-17 01:21:36 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:21:36 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:21:36 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:21:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:21:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:21:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:21:36 collections:880] Dataset successfully loaded with 2042 items and total duration provided from manifest is  0.86 hours.
[NeMo I 2025-04-17 01:21:36 collections:886] # 2042 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:07,  2.19s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:12,  2.25it/s][1/6] extract embeddings:  19%|█▉        | 6/32 [00:02<00:07,  3.60it/s][1/6] extract embeddings:  25%|██▌       | 8/32 [00:02<00:04,  5.17it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  6.75it/s][1/6] extract embeddings:  38%|███▊      | 12/32 [00:02<00:02,  8.67it/s][1/6] extract embeddings:  44%|████▍     | 14/32 [00:02<00:01, 10.47it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:03<00:01, 11.71it/s][1/6] extract embeddings:  56%|█████▋    | 18/32 [00:03<00:01, 13.31it/s][1/6] extract embeddings:  62%|██████▎   | 20/32 [00:03<00:00, 14.02it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:03<00:00, 15.07it/s][1/6] extract embeddings:  75%|███████▌  | 24/32 [00:03<00:00, 14.97it/s][1/6] extract embeddings:  81%|████████▏ | 26/32 [00:03<00:00, 15.56it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 15.64it/s][1/6] extract embeddings:  94%|█████████▍| 30/32 [00:03<00:00, 15.72it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00, 16.09it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  8.00it/s]
[NeMo I 2025-04-17 01:21:40 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:21:40 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:21:40 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:21:40 collections:880] Dataset successfully loaded with 2238 items and total duration provided from manifest is  0.90 hours.
[NeMo I 2025-04-17 01:21:40 collections:886] # 2238 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:48,  1.44s/it][2/6] extract embeddings:   9%|▊         | 3/35 [00:01<00:13,  2.42it/s][2/6] extract embeddings:  14%|█▍        | 5/35 [00:01<00:06,  4.37it/s][2/6] extract embeddings:  20%|██        | 7/35 [00:01<00:04,  6.45it/s][2/6] extract embeddings:  26%|██▌       | 9/35 [00:01<00:03,  8.50it/s][2/6] extract embeddings:  31%|███▏      | 11/35 [00:01<00:02, 10.32it/s][2/6] extract embeddings:  37%|███▋      | 13/35 [00:02<00:01, 12.13it/s][2/6] extract embeddings:  43%|████▎     | 15/35 [00:02<00:01, 13.51it/s][2/6] extract embeddings:  49%|████▊     | 17/35 [00:02<00:01, 14.26it/s][2/6] extract embeddings:  54%|█████▍    | 19/35 [00:02<00:01, 15.55it/s][2/6] extract embeddings:  60%|██████    | 21/35 [00:02<00:00, 15.53it/s][2/6] extract embeddings:  66%|██████▌   | 23/35 [00:02<00:00, 16.56it/s][2/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 17.38it/s][2/6] extract embeddings:  77%|███████▋  | 27/35 [00:02<00:00, 16.99it/s][2/6] extract embeddings:  83%|████████▎ | 29/35 [00:03<00:00, 16.56it/s][2/6] extract embeddings:  89%|████████▊ | 31/35 [00:03<00:00, 16.55it/s][2/6] extract embeddings:  94%|█████████▍| 33/35 [00:03<00:00, 17.11it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 17.26it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 10.29it/s]
[NeMo I 2025-04-17 01:21:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:21:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:21:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:21:44 collections:880] Dataset successfully loaded with 2571 items and total duration provided from manifest is  0.95 hours.
[NeMo I 2025-04-17 01:21:44 collections:886] # 2571 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:48,  1.21s/it][3/6] extract embeddings:  10%|▉         | 4/41 [00:01<00:09,  3.72it/s][3/6] extract embeddings:  15%|█▍        | 6/41 [00:01<00:06,  5.73it/s][3/6] extract embeddings:  20%|█▉        | 8/41 [00:01<00:04,  7.67it/s][3/6] extract embeddings:  24%|██▍       | 10/41 [00:01<00:03,  9.62it/s][3/6] extract embeddings:  29%|██▉       | 12/41 [00:01<00:02, 11.35it/s][3/6] extract embeddings:  34%|███▍      | 14/41 [00:01<00:02, 12.89it/s][3/6] extract embeddings:  41%|████▏     | 17/41 [00:02<00:01, 15.04it/s][3/6] extract embeddings:  46%|████▋     | 19/41 [00:02<00:01, 16.17it/s][3/6] extract embeddings:  51%|█████     | 21/41 [00:02<00:01, 16.86it/s][3/6] extract embeddings:  56%|█████▌    | 23/41 [00:02<00:01, 17.20it/s][3/6] extract embeddings:  61%|██████    | 25/41 [00:02<00:00, 17.57it/s][3/6] extract embeddings:  66%|██████▌   | 27/41 [00:02<00:00, 18.17it/s][3/6] extract embeddings:  73%|███████▎  | 30/41 [00:02<00:00, 18.41it/s][3/6] extract embeddings:  78%|███████▊  | 32/41 [00:02<00:00, 18.35it/s][3/6] extract embeddings:  83%|████████▎ | 34/41 [00:02<00:00, 18.37it/s][3/6] extract embeddings:  88%|████████▊ | 36/41 [00:03<00:00, 18.37it/s][3/6] extract embeddings:  93%|█████████▎| 38/41 [00:03<00:00, 18.41it/s][3/6] extract embeddings:  98%|█████████▊| 40/41 [00:03<00:00, 18.85it/s][3/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 12.24it/s]
[NeMo I 2025-04-17 01:21:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:21:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:21:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:21:48 collections:880] Dataset successfully loaded with 3212 items and total duration provided from manifest is  1.02 hours.
[NeMo I 2025-04-17 01:21:48 collections:886] # 3212 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/51 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/51 [00:01<00:59,  1.19s/it][4/6] extract embeddings:   8%|▊         | 4/51 [00:01<00:12,  3.80it/s][4/6] extract embeddings:  12%|█▏        | 6/51 [00:01<00:07,  5.75it/s][4/6] extract embeddings:  16%|█▌        | 8/51 [00:01<00:05,  7.84it/s][4/6] extract embeddings:  22%|██▏       | 11/51 [00:01<00:03, 10.80it/s][4/6] extract embeddings:  25%|██▌       | 13/51 [00:01<00:03, 12.47it/s][4/6] extract embeddings:  31%|███▏      | 16/51 [00:01<00:02, 14.68it/s][4/6] extract embeddings:  35%|███▌      | 18/51 [00:02<00:02, 15.79it/s][4/6] extract embeddings:  39%|███▉      | 20/51 [00:02<00:01, 16.66it/s][4/6] extract embeddings:  45%|████▌     | 23/51 [00:02<00:01, 18.46it/s][4/6] extract embeddings:  51%|█████     | 26/51 [00:02<00:01, 18.56it/s][4/6] extract embeddings:  57%|█████▋    | 29/51 [00:02<00:01, 18.94it/s][4/6] extract embeddings:  61%|██████    | 31/51 [00:02<00:01, 18.78it/s][4/6] extract embeddings:  67%|██████▋   | 34/51 [00:02<00:00, 19.59it/s][4/6] extract embeddings:  73%|███████▎  | 37/51 [00:02<00:00, 20.23it/s][4/6] extract embeddings:  78%|███████▊  | 40/51 [00:03<00:00, 20.78it/s][4/6] extract embeddings:  84%|████████▍ | 43/51 [00:03<00:00, 20.44it/s][4/6] extract embeddings:  90%|█████████ | 46/51 [00:03<00:00, 20.12it/s][4/6] extract embeddings:  96%|█████████▌| 49/51 [00:03<00:00, 21.22it/s][4/6] extract embeddings: 100%|██████████| 51/51 [00:03<00:00, 13.92it/s]
[NeMo I 2025-04-17 01:21:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:21:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:21:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:21:51 collections:880] Dataset successfully loaded with 4618 items and total duration provided from manifest is  1.11 hours.
[NeMo I 2025-04-17 01:21:51 collections:886] # 4618 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/73 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/73 [00:01<01:24,  1.17s/it][5/6] extract embeddings:   5%|▌         | 4/73 [00:01<00:17,  3.89it/s][5/6] extract embeddings:  10%|▉         | 7/73 [00:01<00:09,  7.20it/s][5/6] extract embeddings:  14%|█▎        | 10/73 [00:01<00:05, 10.54it/s][5/6] extract embeddings:  18%|█▊        | 13/73 [00:01<00:04, 13.95it/s][5/6] extract embeddings:  22%|██▏       | 16/73 [00:01<00:03, 16.58it/s][5/6] extract embeddings:  26%|██▌       | 19/73 [00:01<00:02, 18.90it/s][5/6] extract embeddings:  30%|███       | 22/73 [00:01<00:02, 20.93it/s][5/6] extract embeddings:  34%|███▍      | 25/73 [00:02<00:02, 22.44it/s][5/6] extract embeddings:  38%|███▊      | 28/73 [00:02<00:02, 21.95it/s][5/6] extract embeddings:  42%|████▏     | 31/73 [00:02<00:01, 23.66it/s][5/6] extract embeddings:  47%|████▋     | 34/73 [00:02<00:01, 24.29it/s][5/6] extract embeddings:  51%|█████     | 37/73 [00:02<00:01, 22.94it/s][5/6] extract embeddings:  55%|█████▍    | 40/73 [00:02<00:01, 21.28it/s][5/6] extract embeddings:  59%|█████▉    | 43/73 [00:02<00:01, 20.84it/s][5/6] extract embeddings:  63%|██████▎   | 46/73 [00:03<00:01, 22.08it/s][5/6] extract embeddings:  67%|██████▋   | 49/73 [00:03<00:01, 22.78it/s][5/6] extract embeddings:  71%|███████   | 52/73 [00:03<00:00, 23.83it/s][5/6] extract embeddings:  75%|███████▌  | 55/73 [00:03<00:00, 25.09it/s][5/6] extract embeddings:  79%|███████▉  | 58/73 [00:03<00:00, 26.05it/s][5/6] extract embeddings:  84%|████████▎ | 61/73 [00:03<00:00, 26.54it/s][5/6] extract embeddings:  88%|████████▊ | 64/73 [00:03<00:00, 25.43it/s][5/6] extract embeddings:  92%|█████████▏| 67/73 [00:03<00:00, 24.51it/s][5/6] extract embeddings:  96%|█████████▌| 70/73 [00:03<00:00, 25.56it/s][5/6] extract embeddings: 100%|██████████| 73/73 [00:04<00:00, 26.14it/s][5/6] extract embeddings: 100%|██████████| 73/73 [00:04<00:00, 17.86it/s]
[NeMo I 2025-04-17 01:21:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:21:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:21:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:21:56 collections:880] Dataset successfully loaded with 9283 items and total duration provided from manifest is  1.22 hours.
[NeMo I 2025-04-17 01:21:56 collections:886] # 9283 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/146 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/146 [00:01<02:49,  1.17s/it][6/6] extract embeddings:   3%|▎         | 5/146 [00:01<00:28,  5.00it/s][6/6] extract embeddings:   6%|▌         | 9/146 [00:01<00:14,  9.36it/s][6/6] extract embeddings:   9%|▉         | 13/146 [00:01<00:09, 13.79it/s][6/6] extract embeddings:  12%|█▏        | 17/146 [00:01<00:07, 18.22it/s][6/6] extract embeddings:  14%|█▍        | 21/146 [00:01<00:05, 21.38it/s][6/6] extract embeddings:  17%|█▋        | 25/146 [00:01<00:04, 24.73it/s][6/6] extract embeddings:  20%|█▉        | 29/146 [00:02<00:04, 25.76it/s][6/6] extract embeddings:  23%|██▎       | 33/146 [00:02<00:04, 23.81it/s][6/6] extract embeddings:  25%|██▍       | 36/146 [00:02<00:04, 22.89it/s][6/6] extract embeddings:  27%|██▋       | 39/146 [00:02<00:04, 23.09it/s][6/6] extract embeddings:  29%|██▉       | 43/146 [00:02<00:03, 26.32it/s][6/6] extract embeddings:  32%|███▏      | 47/146 [00:02<00:03, 28.47it/s][6/6] extract embeddings:  35%|███▍      | 51/146 [00:02<00:03, 29.62it/s][6/6] extract embeddings:  38%|███▊      | 55/146 [00:02<00:03, 30.03it/s][6/6] extract embeddings:  40%|████      | 59/146 [00:03<00:02, 31.42it/s][6/6] extract embeddings:  43%|████▎     | 63/146 [00:03<00:02, 32.38it/s][6/6] extract embeddings:  46%|████▌     | 67/146 [00:03<00:02, 33.50it/s][6/6] extract embeddings:  49%|████▊     | 71/146 [00:03<00:02, 31.23it/s][6/6] extract embeddings:  51%|█████▏    | 75/146 [00:03<00:02, 28.30it/s][6/6] extract embeddings:  53%|█████▎    | 78/146 [00:03<00:02, 28.42it/s][6/6] extract embeddings:  55%|█████▌    | 81/146 [00:03<00:02, 28.66it/s][6/6] extract embeddings:  58%|█████▊    | 84/146 [00:03<00:02, 28.02it/s][6/6] extract embeddings:  60%|█████▉    | 87/146 [00:04<00:02, 27.66it/s][6/6] extract embeddings:  62%|██████▏   | 90/146 [00:04<00:02, 27.10it/s][6/6] extract embeddings:  64%|██████▎   | 93/146 [00:04<00:02, 26.22it/s][6/6] extract embeddings:  66%|██████▌   | 96/146 [00:04<00:01, 25.63it/s][6/6] extract embeddings:  68%|██████▊   | 99/146 [00:04<00:01, 25.15it/s][6/6] extract embeddings:  70%|██████▉   | 102/146 [00:04<00:01, 24.86it/s][6/6] extract embeddings:  72%|███████▏  | 105/146 [00:04<00:01, 25.01it/s][6/6] extract embeddings:  74%|███████▍  | 108/146 [00:04<00:01, 24.58it/s][6/6] extract embeddings:  76%|███████▌  | 111/146 [00:05<00:01, 24.66it/s][6/6] extract embeddings:  79%|███████▉  | 115/146 [00:05<00:01, 25.67it/s][6/6] extract embeddings:  82%|████████▏ | 119/146 [00:05<00:01, 26.60it/s][6/6] extract embeddings:  84%|████████▎ | 122/146 [00:05<00:00, 26.62it/s][6/6] extract embeddings:  86%|████████▌ | 125/146 [00:05<00:00, 27.12it/s][6/6] extract embeddings:  88%|████████▊ | 128/146 [00:05<00:00, 26.75it/s][6/6] extract embeddings:  90%|████████▉ | 131/146 [00:05<00:00, 26.48it/s][6/6] extract embeddings:  92%|█████████▏| 135/146 [00:05<00:00, 26.68it/s][6/6] extract embeddings:  95%|█████████▍| 138/146 [00:06<00:00, 26.00it/s][6/6] extract embeddings:  97%|█████████▋| 141/146 [00:06<00:00, 25.66it/s][6/6] extract embeddings:  99%|█████████▊| 144/146 [00:06<00:00, 25.11it/s][6/6] extract embeddings: 100%|██████████| 146/146 [00:06<00:00, 22.89it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.98it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.90it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.50it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.57it/s]
[NeMo I 2025-04-17 01:22:04 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:22:05 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              54.086595   444.120  ...   14.660033  3.300917
    Harker-ES                       49.152518  2178.782  ...   44.480371  2.041525
    Harker-MN                       55.331098   366.767  ...   30.472928  8.308525
    Longfellow-Block-1              44.396767   492.417  ...   10.600986  2.152847
    TOTAL                           49.760087  3482.086  ...  100.214317  2.877997
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:22:05 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0494 | MISS: 0.4194 | CER: 0.0288 | DER: 0.4976 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.30, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.3, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.87s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.96s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.26s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:22:18 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:22:18 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:22:18 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:22:18 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:22:18 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:22:18 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:22:18 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:22:18 features:305] PADDING: 16
[NeMo I 2025-04-17 01:22:19 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:22:19 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:22:19 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:22:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:22:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:22:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:22:19 collections:880] Dataset successfully loaded with 2229 items and total duration provided from manifest is  1.35 hours.
[NeMo I 2025-04-17 01:22:19 collections:886] # 2229 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:08,  2.02s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:12,  2.43it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:07,  3.88it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:04,  5.55it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  7.22it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  8.88it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02, 10.25it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 11.70it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:02<00:01, 12.90it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 13.59it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:00, 13.86it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 15.06it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 15.26it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:03<00:00, 15.63it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:03<00:00, 15.48it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:03<00:00, 16.13it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:03<00:00, 15.82it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  8.65it/s]
[NeMo I 2025-04-17 01:22:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:22:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:22:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:22:23 collections:880] Dataset successfully loaded with 2583 items and total duration provided from manifest is  1.40 hours.
[NeMo I 2025-04-17 01:22:23 collections:886] # 2583 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:57,  1.43s/it][2/6] extract embeddings:   7%|▋         | 3/41 [00:01<00:15,  2.40it/s][2/6] extract embeddings:  12%|█▏        | 5/41 [00:01<00:08,  4.24it/s][2/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:05,  6.16it/s][2/6] extract embeddings:  22%|██▏       | 9/41 [00:01<00:04,  7.89it/s][2/6] extract embeddings:  27%|██▋       | 11/41 [00:02<00:03,  9.37it/s][2/6] extract embeddings:  32%|███▏      | 13/41 [00:02<00:02, 10.78it/s][2/6] extract embeddings:  37%|███▋      | 15/41 [00:02<00:02, 11.83it/s][2/6] extract embeddings:  41%|████▏     | 17/41 [00:02<00:01, 13.18it/s][2/6] extract embeddings:  46%|████▋     | 19/41 [00:02<00:01, 14.04it/s][2/6] extract embeddings:  51%|█████     | 21/41 [00:02<00:01, 15.03it/s][2/6] extract embeddings:  56%|█████▌    | 23/41 [00:02<00:01, 15.49it/s][2/6] extract embeddings:  61%|██████    | 25/41 [00:02<00:01, 14.98it/s][2/6] extract embeddings:  66%|██████▌   | 27/41 [00:03<00:00, 15.12it/s][2/6] extract embeddings:  71%|███████   | 29/41 [00:03<00:00, 16.05it/s][2/6] extract embeddings:  76%|███████▌  | 31/41 [00:03<00:00, 16.01it/s][2/6] extract embeddings:  80%|████████  | 33/41 [00:03<00:00, 15.97it/s][2/6] extract embeddings:  85%|████████▌ | 35/41 [00:03<00:00, 14.62it/s][2/6] extract embeddings:  90%|█████████ | 37/41 [00:03<00:00, 15.45it/s][2/6] extract embeddings:  95%|█████████▌| 39/41 [00:03<00:00, 15.88it/s][2/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 10.37it/s]
[NeMo I 2025-04-17 01:22:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:22:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:22:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:22:27 collections:880] Dataset successfully loaded with 3165 items and total duration provided from manifest is  1.47 hours.
[NeMo I 2025-04-17 01:22:27 collections:886] # 3165 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/50 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/50 [00:01<00:59,  1.21s/it][3/6] extract embeddings:   6%|▌         | 3/50 [00:01<00:16,  2.81it/s][3/6] extract embeddings:  10%|█         | 5/50 [00:01<00:09,  4.91it/s][3/6] extract embeddings:  14%|█▍        | 7/50 [00:01<00:06,  7.03it/s][3/6] extract embeddings:  18%|█▊        | 9/50 [00:01<00:04,  9.04it/s][3/6] extract embeddings:  22%|██▏       | 11/50 [00:01<00:03, 11.10it/s][3/6] extract embeddings:  26%|██▌       | 13/50 [00:01<00:02, 12.49it/s][3/6] extract embeddings:  30%|███       | 15/50 [00:02<00:02, 13.72it/s][3/6] extract embeddings:  34%|███▍      | 17/50 [00:02<00:02, 14.64it/s][3/6] extract embeddings:  38%|███▊      | 19/50 [00:02<00:01, 15.53it/s][3/6] extract embeddings:  42%|████▏     | 21/50 [00:02<00:01, 16.18it/s][3/6] extract embeddings:  46%|████▌     | 23/50 [00:02<00:01, 16.91it/s][3/6] extract embeddings:  52%|█████▏    | 26/50 [00:02<00:01, 18.11it/s][3/6] extract embeddings:  58%|█████▊    | 29/50 [00:02<00:01, 18.54it/s][3/6] extract embeddings:  62%|██████▏   | 31/50 [00:02<00:01, 18.25it/s][3/6] extract embeddings:  66%|██████▌   | 33/50 [00:02<00:00, 18.02it/s][3/6] extract embeddings:  70%|███████   | 35/50 [00:03<00:00, 17.25it/s][3/6] extract embeddings:  74%|███████▍  | 37/50 [00:03<00:00, 16.52it/s][3/6] extract embeddings:  78%|███████▊  | 39/50 [00:03<00:00, 16.47it/s][3/6] extract embeddings:  82%|████████▏ | 41/50 [00:03<00:00, 16.71it/s][3/6] extract embeddings:  86%|████████▌ | 43/50 [00:03<00:00, 15.77it/s][3/6] extract embeddings:  90%|█████████ | 45/50 [00:03<00:00, 15.83it/s][3/6] extract embeddings:  94%|█████████▍| 47/50 [00:03<00:00, 15.92it/s][3/6] extract embeddings:  98%|█████████▊| 49/50 [00:04<00:00, 15.83it/s][3/6] extract embeddings: 100%|██████████| 50/50 [00:04<00:00, 12.27it/s]
[NeMo I 2025-04-17 01:22:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:22:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:22:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:22:31 collections:880] Dataset successfully loaded with 4172 items and total duration provided from manifest is  1.54 hours.
[NeMo I 2025-04-17 01:22:31 collections:886] # 4172 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/66 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/66 [00:01<01:25,  1.31s/it][4/6] extract embeddings:   6%|▌         | 4/66 [00:01<00:17,  3.50it/s][4/6] extract embeddings:   9%|▉         | 6/66 [00:01<00:11,  5.26it/s][4/6] extract embeddings:  12%|█▏        | 8/66 [00:01<00:08,  7.19it/s][4/6] extract embeddings:  15%|█▌        | 10/66 [00:01<00:06,  8.78it/s][4/6] extract embeddings:  18%|█▊        | 12/66 [00:01<00:05, 10.78it/s][4/6] extract embeddings:  21%|██        | 14/66 [00:02<00:04, 12.42it/s][4/6] extract embeddings:  24%|██▍       | 16/66 [00:02<00:03, 13.64it/s][4/6] extract embeddings:  27%|██▋       | 18/66 [00:02<00:03, 14.18it/s][4/6] extract embeddings:  30%|███       | 20/66 [00:02<00:03, 14.78it/s][4/6] extract embeddings:  33%|███▎      | 22/66 [00:02<00:02, 15.65it/s][4/6] extract embeddings:  36%|███▋      | 24/66 [00:02<00:02, 16.07it/s][4/6] extract embeddings:  39%|███▉      | 26/66 [00:02<00:02, 16.25it/s][4/6] extract embeddings:  42%|████▏     | 28/66 [00:02<00:02, 16.54it/s][4/6] extract embeddings:  45%|████▌     | 30/66 [00:02<00:02, 17.12it/s][4/6] extract embeddings:  48%|████▊     | 32/66 [00:03<00:01, 17.30it/s][4/6] extract embeddings:  52%|█████▏    | 34/66 [00:03<00:01, 17.02it/s][4/6] extract embeddings:  55%|█████▍    | 36/66 [00:03<00:01, 17.37it/s][4/6] extract embeddings:  58%|█████▊    | 38/66 [00:03<00:01, 17.44it/s][4/6] extract embeddings:  61%|██████    | 40/66 [00:03<00:01, 18.13it/s][4/6] extract embeddings:  64%|██████▎   | 42/66 [00:03<00:01, 18.23it/s][4/6] extract embeddings:  67%|██████▋   | 44/66 [00:03<00:01, 18.20it/s][4/6] extract embeddings:  70%|██████▉   | 46/66 [00:03<00:01, 17.81it/s][4/6] extract embeddings:  73%|███████▎  | 48/66 [00:03<00:01, 17.63it/s][4/6] extract embeddings:  76%|███████▌  | 50/66 [00:04<00:00, 17.35it/s][4/6] extract embeddings:  79%|███████▉  | 52/66 [00:04<00:00, 17.95it/s][4/6] extract embeddings:  82%|████████▏ | 54/66 [00:04<00:00, 18.07it/s][4/6] extract embeddings:  86%|████████▋ | 57/66 [00:04<00:00, 18.48it/s][4/6] extract embeddings:  89%|████████▉ | 59/66 [00:04<00:00, 18.57it/s][4/6] extract embeddings:  92%|█████████▏| 61/66 [00:04<00:00, 18.73it/s][4/6] extract embeddings:  95%|█████████▌| 63/66 [00:04<00:00, 18.29it/s][4/6] extract embeddings:  98%|█████████▊| 65/66 [00:04<00:00, 18.49it/s][4/6] extract embeddings: 100%|██████████| 66/66 [00:04<00:00, 13.26it/s]
[NeMo I 2025-04-17 01:22:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:22:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:22:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:22:37 collections:880] Dataset successfully loaded with 6264 items and total duration provided from manifest is  1.62 hours.
[NeMo I 2025-04-17 01:22:37 collections:886] # 6264 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/98 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/98 [00:01<02:45,  1.70s/it][5/6] extract embeddings:   4%|▍         | 4/98 [00:01<00:33,  2.80it/s][5/6] extract embeddings:   6%|▌         | 6/98 [00:01<00:20,  4.46it/s][5/6] extract embeddings:   9%|▉         | 9/98 [00:02<00:12,  7.26it/s][5/6] extract embeddings:  12%|█▏        | 12/98 [00:02<00:08,  9.81it/s][5/6] extract embeddings:  15%|█▌        | 15/98 [00:02<00:06, 12.37it/s][5/6] extract embeddings:  18%|█▊        | 18/98 [00:02<00:05, 14.26it/s][5/6] extract embeddings:  21%|██▏       | 21/98 [00:02<00:04, 15.57it/s][5/6] extract embeddings:  23%|██▎       | 23/98 [00:02<00:04, 15.77it/s][5/6] extract embeddings:  26%|██▌       | 25/98 [00:02<00:04, 16.52it/s][5/6] extract embeddings:  28%|██▊       | 27/98 [00:02<00:04, 17.02it/s][5/6] extract embeddings:  31%|███       | 30/98 [00:03<00:03, 19.42it/s][5/6] extract embeddings:  34%|███▎      | 33/98 [00:03<00:03, 20.14it/s][5/6] extract embeddings:  37%|███▋      | 36/98 [00:03<00:03, 19.10it/s][5/6] extract embeddings:  39%|███▉      | 38/98 [00:03<00:03, 18.46it/s][5/6] extract embeddings:  41%|████      | 40/98 [00:03<00:03, 18.34it/s][5/6] extract embeddings:  43%|████▎     | 42/98 [00:03<00:03, 18.63it/s][5/6] extract embeddings:  45%|████▍     | 44/98 [00:03<00:02, 18.80it/s][5/6] extract embeddings:  48%|████▊     | 47/98 [00:03<00:02, 19.91it/s][5/6] extract embeddings:  51%|█████     | 50/98 [00:04<00:02, 22.48it/s][5/6] extract embeddings:  54%|█████▍    | 53/98 [00:04<00:01, 23.14it/s][5/6] extract embeddings:  57%|█████▋    | 56/98 [00:04<00:01, 23.48it/s][5/6] extract embeddings:  60%|██████    | 59/98 [00:04<00:01, 24.38it/s][5/6] extract embeddings:  63%|██████▎   | 62/98 [00:04<00:01, 24.36it/s][5/6] extract embeddings:  66%|██████▋   | 65/98 [00:04<00:01, 24.46it/s][5/6] extract embeddings:  69%|██████▉   | 68/98 [00:04<00:01, 22.46it/s][5/6] extract embeddings:  72%|███████▏  | 71/98 [00:05<00:01, 21.37it/s][5/6] extract embeddings:  76%|███████▌  | 74/98 [00:05<00:01, 22.07it/s][5/6] extract embeddings:  79%|███████▊  | 77/98 [00:05<00:00, 22.97it/s][5/6] extract embeddings:  82%|████████▏ | 80/98 [00:05<00:00, 23.81it/s][5/6] extract embeddings:  85%|████████▍ | 83/98 [00:05<00:00, 23.84it/s][5/6] extract embeddings:  88%|████████▊ | 86/98 [00:05<00:00, 23.99it/s][5/6] extract embeddings:  91%|█████████ | 89/98 [00:05<00:00, 22.48it/s][5/6] extract embeddings:  94%|█████████▍| 92/98 [00:05<00:00, 21.63it/s][5/6] extract embeddings:  97%|█████████▋| 95/98 [00:06<00:00, 19.98it/s][5/6] extract embeddings: 100%|██████████| 98/98 [00:06<00:00, 20.26it/s][5/6] extract embeddings: 100%|██████████| 98/98 [00:06<00:00, 15.61it/s]
[NeMo I 2025-04-17 01:22:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:22:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:22:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:22:43 collections:880] Dataset successfully loaded with 12750 items and total duration provided from manifest is  1.72 hours.
[NeMo I 2025-04-17 01:22:43 collections:886] # 12750 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/200 [00:00<?, ?it/s][6/6] extract embeddings:   0%|          | 1/200 [00:01<03:51,  1.16s/it][6/6] extract embeddings:   2%|▎         | 5/200 [00:01<00:38,  5.05it/s][6/6] extract embeddings:   4%|▍         | 8/200 [00:01<00:23,  8.29it/s][6/6] extract embeddings:   6%|▌         | 11/200 [00:01<00:16, 11.72it/s][6/6] extract embeddings:   8%|▊         | 15/200 [00:01<00:11, 16.29it/s][6/6] extract embeddings:  10%|▉         | 19/200 [00:01<00:09, 19.97it/s][6/6] extract embeddings:  12%|█▏        | 23/200 [00:01<00:07, 23.73it/s][6/6] extract embeddings:  14%|█▎        | 27/200 [00:01<00:06, 25.97it/s][6/6] extract embeddings:  16%|█▌        | 31/200 [00:02<00:06, 26.18it/s][6/6] extract embeddings:  18%|█▊        | 35/200 [00:02<00:05, 28.49it/s][6/6] extract embeddings:  20%|█▉        | 39/200 [00:02<00:05, 29.12it/s][6/6] extract embeddings:  22%|██▏       | 43/200 [00:02<00:05, 29.38it/s][6/6] extract embeddings:  24%|██▎       | 47/200 [00:02<00:05, 29.75it/s][6/6] extract embeddings:  26%|██▌       | 51/200 [00:02<00:04, 30.66it/s][6/6] extract embeddings:  28%|██▊       | 55/200 [00:02<00:04, 29.71it/s][6/6] extract embeddings:  30%|██▉       | 59/200 [00:03<00:04, 30.09it/s][6/6] extract embeddings:  32%|███▏      | 63/200 [00:03<00:04, 31.48it/s][6/6] extract embeddings:  34%|███▎      | 67/200 [00:03<00:04, 32.07it/s][6/6] extract embeddings:  36%|███▌      | 71/200 [00:03<00:04, 30.63it/s][6/6] extract embeddings:  38%|███▊      | 75/200 [00:03<00:04, 31.18it/s][6/6] extract embeddings:  40%|███▉      | 79/200 [00:03<00:03, 31.74it/s][6/6] extract embeddings:  42%|████▏     | 83/200 [00:03<00:03, 31.78it/s][6/6] extract embeddings:  44%|████▎     | 87/200 [00:03<00:03, 32.29it/s][6/6] extract embeddings:  46%|████▌     | 91/200 [00:04<00:03, 32.60it/s][6/6] extract embeddings:  48%|████▊     | 95/200 [00:04<00:03, 32.32it/s][6/6] extract embeddings:  50%|████▉     | 99/200 [00:04<00:03, 31.26it/s][6/6] extract embeddings:  52%|█████▏    | 103/200 [00:04<00:02, 32.79it/s][6/6] extract embeddings:  54%|█████▎    | 107/200 [00:04<00:02, 33.12it/s][6/6] extract embeddings:  56%|█████▌    | 111/200 [00:04<00:02, 32.80it/s][6/6] extract embeddings:  57%|█████▊    | 115/200 [00:04<00:02, 32.98it/s][6/6] extract embeddings:  60%|█████▉    | 119/200 [00:04<00:02, 33.44it/s][6/6] extract embeddings:  62%|██████▏   | 123/200 [00:04<00:02, 33.08it/s][6/6] extract embeddings:  64%|██████▎   | 127/200 [00:05<00:02, 33.33it/s][6/6] extract embeddings:  66%|██████▌   | 131/200 [00:05<00:02, 32.98it/s][6/6] extract embeddings:  68%|██████▊   | 135/200 [00:05<00:01, 33.43it/s][6/6] extract embeddings:  70%|██████▉   | 139/200 [00:05<00:01, 33.07it/s][6/6] extract embeddings:  72%|███████▏  | 143/200 [00:05<00:01, 32.74it/s][6/6] extract embeddings:  74%|███████▎  | 147/200 [00:05<00:01, 33.47it/s][6/6] extract embeddings:  76%|███████▌  | 151/200 [00:05<00:01, 30.82it/s][6/6] extract embeddings:  78%|███████▊  | 155/200 [00:05<00:01, 30.95it/s][6/6] extract embeddings:  80%|███████▉  | 159/200 [00:06<00:01, 31.14it/s][6/6] extract embeddings:  82%|████████▏ | 163/200 [00:06<00:01, 31.47it/s][6/6] extract embeddings:  84%|████████▎ | 167/200 [00:06<00:01, 31.60it/s][6/6] extract embeddings:  86%|████████▌ | 171/200 [00:06<00:00, 31.67it/s][6/6] extract embeddings:  88%|████████▊ | 175/200 [00:06<00:00, 30.51it/s][6/6] extract embeddings:  90%|████████▉ | 179/200 [00:06<00:00, 27.88it/s][6/6] extract embeddings:  91%|█████████ | 182/200 [00:06<00:00, 25.95it/s][6/6] extract embeddings:  92%|█████████▎| 185/200 [00:07<00:00, 24.24it/s][6/6] extract embeddings:  94%|█████████▍| 188/200 [00:07<00:00, 23.33it/s][6/6] extract embeddings:  96%|█████████▌| 191/200 [00:07<00:00, 22.47it/s][6/6] extract embeddings:  97%|█████████▋| 194/200 [00:07<00:00, 22.35it/s][6/6] extract embeddings:  98%|█████████▊| 197/200 [00:07<00:00, 21.51it/s][6/6] extract embeddings: 100%|██████████| 200/200 [00:07<00:00, 25.68it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.21it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.36it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.96it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.43it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.12it/s]
[NeMo I 2025-04-17 01:22:53 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:22:54 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              41.945900   444.120  ...   16.250025  3.658927
    Harker-ES                       34.661156  2178.782  ...   77.079225  3.537721
    Harker-MN                       46.818317   366.767  ...   31.843977  8.682345
    Longfellow-Block-1              27.832888   492.417  ...   10.159971  2.063286
    TOTAL                           35.905178  3482.086  ...  135.333197  3.886555
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:22:54 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0771 | MISS: 0.2431 | CER: 0.0389 | DER: 0.3591 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.35, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.35, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.84s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:23:07 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:23:07 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:23:07 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:23:07 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:23:07 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:23:07 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:23:07 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:23:07 features:305] PADDING: 16
[NeMo I 2025-04-17 01:23:07 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:23:07 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:23:07 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:23:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:23:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:23:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:23:08 collections:880] Dataset successfully loaded with 2219 items and total duration provided from manifest is  1.33 hours.
[NeMo I 2025-04-17 01:23:08 collections:886] # 2219 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:08,  2.00s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:12,  2.43it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:07,  3.85it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:05,  5.28it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.70it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  8.02it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02,  9.17it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 10.43it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 11.35it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 11.98it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:01, 12.50it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 12.85it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 13.48it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:03<00:00, 14.11it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:03<00:00, 14.42it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:04<00:00, 14.11it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 14.15it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  8.12it/s]
[NeMo I 2025-04-17 01:23:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:23:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:23:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:23:12 collections:880] Dataset successfully loaded with 2571 items and total duration provided from manifest is  1.38 hours.
[NeMo I 2025-04-17 01:23:12 collections:886] # 2571 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:56,  1.42s/it][2/6] extract embeddings:   7%|▋         | 3/41 [00:01<00:15,  2.43it/s][2/6] extract embeddings:  12%|█▏        | 5/41 [00:01<00:08,  4.27it/s][2/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:05,  6.36it/s][2/6] extract embeddings:  22%|██▏       | 9/41 [00:01<00:03,  8.45it/s][2/6] extract embeddings:  27%|██▋       | 11/41 [00:02<00:02, 10.28it/s][2/6] extract embeddings:  32%|███▏      | 13/41 [00:02<00:02, 11.98it/s][2/6] extract embeddings:  37%|███▋      | 15/41 [00:02<00:01, 13.23it/s][2/6] extract embeddings:  41%|████▏     | 17/41 [00:02<00:01, 14.70it/s][2/6] extract embeddings:  46%|████▋     | 19/41 [00:02<00:01, 15.90it/s][2/6] extract embeddings:  51%|█████     | 21/41 [00:02<00:01, 16.51it/s][2/6] extract embeddings:  56%|█████▌    | 23/41 [00:02<00:01, 16.24it/s][2/6] extract embeddings:  61%|██████    | 25/41 [00:02<00:00, 16.50it/s][2/6] extract embeddings:  68%|██████▊   | 28/41 [00:02<00:00, 17.10it/s][2/6] extract embeddings:  73%|███████▎  | 30/41 [00:03<00:00, 17.37it/s][2/6] extract embeddings:  78%|███████▊  | 32/41 [00:03<00:00, 17.47it/s][2/6] extract embeddings:  83%|████████▎ | 34/41 [00:03<00:00, 17.41it/s][2/6] extract embeddings:  88%|████████▊ | 36/41 [00:03<00:00, 16.23it/s][2/6] extract embeddings:  93%|█████████▎| 38/41 [00:03<00:00, 15.88it/s][2/6] extract embeddings:  98%|█████████▊| 40/41 [00:03<00:00, 15.37it/s][2/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 10.87it/s]
[NeMo I 2025-04-17 01:23:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:23:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:23:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:23:16 collections:880] Dataset successfully loaded with 3140 items and total duration provided from manifest is  1.45 hours.
[NeMo I 2025-04-17 01:23:16 collections:886] # 3140 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/50 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/50 [00:01<01:01,  1.26s/it][3/6] extract embeddings:   8%|▊         | 4/50 [00:01<00:12,  3.58it/s][3/6] extract embeddings:  12%|█▏        | 6/50 [00:01<00:07,  5.54it/s][3/6] extract embeddings:  16%|█▌        | 8/50 [00:01<00:05,  7.42it/s][3/6] extract embeddings:  20%|██        | 10/50 [00:01<00:04,  9.55it/s][3/6] extract embeddings:  24%|██▍       | 12/50 [00:01<00:03, 11.56it/s][3/6] extract embeddings:  28%|██▊       | 14/50 [00:01<00:02, 13.28it/s][3/6] extract embeddings:  32%|███▏      | 16/50 [00:02<00:02, 14.57it/s][3/6] extract embeddings:  38%|███▊      | 19/50 [00:02<00:01, 16.05it/s][3/6] extract embeddings:  42%|████▏     | 21/50 [00:02<00:01, 16.84it/s][3/6] extract embeddings:  48%|████▊     | 24/50 [00:02<00:01, 18.27it/s][3/6] extract embeddings:  52%|█████▏    | 26/50 [00:02<00:01, 18.46it/s][3/6] extract embeddings:  58%|█████▊    | 29/50 [00:02<00:01, 18.45it/s][3/6] extract embeddings:  62%|██████▏   | 31/50 [00:02<00:01, 18.69it/s][3/6] extract embeddings:  66%|██████▌   | 33/50 [00:02<00:00, 18.36it/s][3/6] extract embeddings:  70%|███████   | 35/50 [00:03<00:00, 18.47it/s][3/6] extract embeddings:  74%|███████▍  | 37/50 [00:03<00:00, 18.38it/s][3/6] extract embeddings:  78%|███████▊  | 39/50 [00:03<00:00, 18.72it/s][3/6] extract embeddings:  82%|████████▏ | 41/50 [00:03<00:00, 18.18it/s][3/6] extract embeddings:  86%|████████▌ | 43/50 [00:03<00:00, 18.16it/s][3/6] extract embeddings:  90%|█████████ | 45/50 [00:03<00:00, 17.64it/s][3/6] extract embeddings:  94%|█████████▍| 47/50 [00:03<00:00, 17.22it/s][3/6] extract embeddings:  98%|█████████▊| 49/50 [00:03<00:00, 17.05it/s][3/6] extract embeddings: 100%|██████████| 50/50 [00:03<00:00, 12.78it/s]
[NeMo I 2025-04-17 01:23:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:23:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:23:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:23:20 collections:880] Dataset successfully loaded with 4128 items and total duration provided from manifest is  1.52 hours.
[NeMo I 2025-04-17 01:23:20 collections:886] # 4128 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/65 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/65 [00:01<01:15,  1.18s/it][4/6] extract embeddings:   5%|▍         | 3/65 [00:01<00:21,  2.91it/s][4/6] extract embeddings:   8%|▊         | 5/65 [00:01<00:11,  5.07it/s][4/6] extract embeddings:  11%|█         | 7/65 [00:01<00:08,  7.18it/s][4/6] extract embeddings:  14%|█▍        | 9/65 [00:01<00:06,  9.30it/s][4/6] extract embeddings:  18%|█▊        | 12/65 [00:01<00:04, 12.45it/s][4/6] extract embeddings:  23%|██▎       | 15/65 [00:01<00:03, 14.50it/s][4/6] extract embeddings:  26%|██▌       | 17/65 [00:02<00:03, 15.40it/s][4/6] extract embeddings:  29%|██▉       | 19/65 [00:02<00:02, 16.02it/s][4/6] extract embeddings:  32%|███▏      | 21/65 [00:02<00:02, 16.30it/s][4/6] extract embeddings:  35%|███▌      | 23/65 [00:02<00:02, 16.81it/s][4/6] extract embeddings:  38%|███▊      | 25/65 [00:02<00:02, 17.41it/s][4/6] extract embeddings:  42%|████▏     | 27/65 [00:02<00:02, 17.54it/s][4/6] extract embeddings:  45%|████▍     | 29/65 [00:02<00:01, 18.01it/s][4/6] extract embeddings:  48%|████▊     | 31/65 [00:02<00:01, 17.96it/s][4/6] extract embeddings:  52%|█████▏    | 34/65 [00:02<00:01, 18.46it/s][4/6] extract embeddings:  57%|█████▋    | 37/65 [00:03<00:01, 18.85it/s][4/6] extract embeddings:  60%|██████    | 39/65 [00:03<00:01, 18.97it/s][4/6] extract embeddings:  63%|██████▎   | 41/65 [00:03<00:01, 19.23it/s][4/6] extract embeddings:  66%|██████▌   | 43/65 [00:03<00:01, 18.92it/s][4/6] extract embeddings:  69%|██████▉   | 45/65 [00:03<00:01, 19.02it/s][4/6] extract embeddings:  72%|███████▏  | 47/65 [00:03<00:00, 18.45it/s][4/6] extract embeddings:  75%|███████▌  | 49/65 [00:03<00:00, 18.19it/s][4/6] extract embeddings:  78%|███████▊  | 51/65 [00:03<00:00, 18.10it/s][4/6] extract embeddings:  82%|████████▏ | 53/65 [00:03<00:00, 17.73it/s][4/6] extract embeddings:  85%|████████▍ | 55/65 [00:04<00:00, 17.96it/s][4/6] extract embeddings:  88%|████████▊ | 57/65 [00:04<00:00, 17.79it/s][4/6] extract embeddings:  91%|█████████ | 59/65 [00:04<00:00, 18.07it/s][4/6] extract embeddings:  95%|█████████▌| 62/65 [00:04<00:00, 18.53it/s][4/6] extract embeddings:  98%|█████████▊| 64/65 [00:04<00:00, 18.60it/s][4/6] extract embeddings: 100%|██████████| 65/65 [00:04<00:00, 14.00it/s]
[NeMo I 2025-04-17 01:23:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:23:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:23:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:23:25 collections:880] Dataset successfully loaded with 6193 items and total duration provided from manifest is  1.60 hours.
[NeMo I 2025-04-17 01:23:25 collections:886] # 6193 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/97 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/97 [00:01<01:57,  1.22s/it][5/6] extract embeddings:   4%|▍         | 4/97 [00:01<00:24,  3.77it/s][5/6] extract embeddings:   6%|▌         | 6/97 [00:01<00:15,  5.80it/s][5/6] extract embeddings:   8%|▊         | 8/97 [00:01<00:11,  7.95it/s][5/6] extract embeddings:  11%|█▏        | 11/97 [00:01<00:07, 11.17it/s][5/6] extract embeddings:  14%|█▍        | 14/97 [00:01<00:06, 13.28it/s][5/6] extract embeddings:  18%|█▊        | 17/97 [00:01<00:05, 15.60it/s][5/6] extract embeddings:  21%|██        | 20/97 [00:02<00:04, 17.19it/s][5/6] extract embeddings:  24%|██▎       | 23/97 [00:02<00:03, 18.54it/s][5/6] extract embeddings:  27%|██▋       | 26/97 [00:02<00:03, 19.75it/s][5/6] extract embeddings:  30%|██▉       | 29/97 [00:02<00:03, 20.51it/s][5/6] extract embeddings:  33%|███▎      | 32/97 [00:02<00:03, 20.47it/s][5/6] extract embeddings:  36%|███▌      | 35/97 [00:02<00:02, 20.70it/s][5/6] extract embeddings:  39%|███▉      | 38/97 [00:02<00:02, 21.30it/s][5/6] extract embeddings:  42%|████▏     | 41/97 [00:03<00:02, 20.56it/s][5/6] extract embeddings:  45%|████▌     | 44/97 [00:03<00:02, 21.06it/s][5/6] extract embeddings:  48%|████▊     | 47/97 [00:03<00:02, 20.99it/s][5/6] extract embeddings:  52%|█████▏    | 50/97 [00:03<00:02, 20.19it/s][5/6] extract embeddings:  55%|█████▍    | 53/97 [00:03<00:02, 20.23it/s][5/6] extract embeddings:  58%|█████▊    | 56/97 [00:03<00:02, 20.38it/s][5/6] extract embeddings:  61%|██████    | 59/97 [00:03<00:01, 21.67it/s][5/6] extract embeddings:  64%|██████▍   | 62/97 [00:04<00:01, 22.58it/s][5/6] extract embeddings:  67%|██████▋   | 65/97 [00:04<00:01, 23.25it/s][5/6] extract embeddings:  70%|███████   | 68/97 [00:04<00:01, 21.75it/s][5/6] extract embeddings:  73%|███████▎  | 71/97 [00:04<00:01, 21.35it/s][5/6] extract embeddings:  76%|███████▋  | 74/97 [00:04<00:01, 20.70it/s][5/6] extract embeddings:  79%|███████▉  | 77/97 [00:04<00:00, 20.59it/s][5/6] extract embeddings:  82%|████████▏ | 80/97 [00:04<00:00, 21.74it/s][5/6] extract embeddings:  86%|████████▌ | 83/97 [00:05<00:00, 21.64it/s][5/6] extract embeddings:  89%|████████▊ | 86/97 [00:05<00:00, 22.07it/s][5/6] extract embeddings:  92%|█████████▏| 89/97 [00:05<00:00, 22.61it/s][5/6] extract embeddings:  95%|█████████▍| 92/97 [00:05<00:00, 23.69it/s][5/6] extract embeddings:  98%|█████████▊| 95/97 [00:05<00:00, 22.49it/s][5/6] extract embeddings: 100%|██████████| 97/97 [00:05<00:00, 17.03it/s]
[NeMo I 2025-04-17 01:23:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:23:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:23:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:23:31 collections:880] Dataset successfully loaded with 12614 items and total duration provided from manifest is  1.70 hours.
[NeMo I 2025-04-17 01:23:31 collections:886] # 12614 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/198 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/198 [00:01<03:49,  1.17s/it][6/6] extract embeddings:   2%|▏         | 4/198 [00:01<00:49,  3.92it/s][6/6] extract embeddings:   4%|▎         | 7/198 [00:01<00:26,  7.27it/s][6/6] extract embeddings:   5%|▌         | 10/198 [00:01<00:17, 10.56it/s][6/6] extract embeddings:   7%|▋         | 14/198 [00:01<00:11, 15.44it/s][6/6] extract embeddings:   9%|▉         | 18/198 [00:01<00:09, 19.89it/s][6/6] extract embeddings:  11%|█         | 22/198 [00:01<00:07, 23.66it/s][6/6] extract embeddings:  13%|█▎        | 26/198 [00:01<00:06, 26.17it/s][6/6] extract embeddings:  15%|█▌        | 30/198 [00:02<00:06, 27.22it/s][6/6] extract embeddings:  17%|█▋        | 34/198 [00:02<00:06, 25.94it/s][6/6] extract embeddings:  19%|█▊        | 37/198 [00:02<00:06, 24.92it/s][6/6] extract embeddings:  20%|██        | 40/198 [00:02<00:06, 23.88it/s][6/6] extract embeddings:  22%|██▏       | 43/198 [00:02<00:06, 23.57it/s][6/6] extract embeddings:  23%|██▎       | 46/198 [00:02<00:06, 25.04it/s][6/6] extract embeddings:  25%|██▌       | 50/198 [00:02<00:05, 27.85it/s][6/6] extract embeddings:  27%|██▋       | 54/198 [00:03<00:04, 29.72it/s][6/6] extract embeddings:  29%|██▉       | 58/198 [00:03<00:04, 31.76it/s][6/6] extract embeddings:  31%|███▏      | 62/198 [00:03<00:04, 31.13it/s][6/6] extract embeddings:  33%|███▎      | 66/198 [00:03<00:04, 32.14it/s][6/6] extract embeddings:  35%|███▌      | 70/198 [00:03<00:03, 32.18it/s][6/6] extract embeddings:  37%|███▋      | 74/198 [00:03<00:03, 32.20it/s][6/6] extract embeddings:  39%|███▉      | 78/198 [00:03<00:03, 32.52it/s][6/6] extract embeddings:  41%|████▏     | 82/198 [00:03<00:03, 32.23it/s][6/6] extract embeddings:  43%|████▎     | 86/198 [00:03<00:03, 32.33it/s][6/6] extract embeddings:  45%|████▌     | 90/198 [00:04<00:03, 31.58it/s][6/6] extract embeddings:  47%|████▋     | 94/198 [00:04<00:03, 31.84it/s][6/6] extract embeddings:  49%|████▉     | 98/198 [00:04<00:03, 32.27it/s][6/6] extract embeddings:  52%|█████▏    | 102/198 [00:04<00:02, 32.20it/s][6/6] extract embeddings:  54%|█████▎    | 106/198 [00:04<00:02, 31.52it/s][6/6] extract embeddings:  56%|█████▌    | 110/198 [00:04<00:02, 31.73it/s][6/6] extract embeddings:  58%|█████▊    | 114/198 [00:04<00:02, 32.12it/s][6/6] extract embeddings:  60%|█████▉    | 118/198 [00:05<00:02, 31.97it/s][6/6] extract embeddings:  62%|██████▏   | 122/198 [00:05<00:02, 31.75it/s][6/6] extract embeddings:  64%|██████▎   | 126/198 [00:05<00:02, 32.41it/s][6/6] extract embeddings:  66%|██████▌   | 130/198 [00:05<00:02, 29.59it/s][6/6] extract embeddings:  68%|██████▊   | 134/198 [00:05<00:02, 26.50it/s][6/6] extract embeddings:  69%|██████▉   | 137/198 [00:05<00:02, 26.10it/s][6/6] extract embeddings:  71%|███████   | 140/198 [00:05<00:02, 25.46it/s][6/6] extract embeddings:  73%|███████▎  | 144/198 [00:05<00:01, 27.43it/s][6/6] extract embeddings:  75%|███████▍  | 148/198 [00:06<00:01, 29.33it/s][6/6] extract embeddings:  77%|███████▋  | 152/198 [00:06<00:01, 29.96it/s][6/6] extract embeddings:  79%|███████▉  | 156/198 [00:06<00:01, 30.56it/s][6/6] extract embeddings:  81%|████████  | 160/198 [00:06<00:01, 30.89it/s][6/6] extract embeddings:  83%|████████▎ | 164/198 [00:06<00:01, 32.05it/s][6/6] extract embeddings:  85%|████████▍ | 168/198 [00:06<00:00, 31.93it/s][6/6] extract embeddings:  87%|████████▋ | 172/198 [00:06<00:00, 32.90it/s][6/6] extract embeddings:  89%|████████▉ | 176/198 [00:06<00:00, 33.62it/s][6/6] extract embeddings:  91%|█████████ | 180/198 [00:07<00:00, 33.42it/s][6/6] extract embeddings:  93%|█████████▎| 184/198 [00:07<00:00, 34.17it/s][6/6] extract embeddings:  95%|█████████▍| 188/198 [00:07<00:00, 32.49it/s][6/6] extract embeddings:  97%|█████████▋| 192/198 [00:07<00:00, 32.97it/s][6/6] extract embeddings:  99%|█████████▉| 196/198 [00:07<00:00, 33.59it/s][6/6] extract embeddings: 100%|██████████| 198/198 [00:07<00:00, 26.00it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.71it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.29it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  1.88it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.48it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s]
[NeMo I 2025-04-17 01:23:41 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:23:42 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              43.186551   444.120  ...   17.720011  3.989915
    Harker-ES                       34.365642  2178.782  ...   57.646531  2.645815
    Harker-MN                       47.493655   366.767  ...   32.402986  8.834760
    Longfellow-Block-1              28.429743   492.417  ...    9.684975  1.966824
    TOTAL                           36.034046  3482.086  ...  117.454503  3.373107
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:23:42 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0765 | MISS: 0.2501 | CER: 0.0337 | DER: 0.3603 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.40, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.4, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.94s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.97s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.26s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.19s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:23:56 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:23:56 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:23:56 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:23:56 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:23:56 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:23:56 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:23:56 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:23:56 features:305] PADDING: 16
[NeMo I 2025-04-17 01:23:57 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:23:57 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:23:57 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:23:57 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:23:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:23:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:23:57 collections:880] Dataset successfully loaded with 2205 items and total duration provided from manifest is  1.31 hours.
[NeMo I 2025-04-17 01:23:57 collections:886] # 2205 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:09,  2.05s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:13,  2.38it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:07,  3.69it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:05,  5.10it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.66it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  8.31it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02,  9.94it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 11.40it/s][1/6] extract embeddings:  54%|█████▍    | 19/35 [00:03<00:01, 13.56it/s][1/6] extract embeddings:  60%|██████    | 21/35 [00:03<00:01, 13.17it/s][1/6] extract embeddings:  66%|██████▌   | 23/35 [00:03<00:00, 13.98it/s][1/6] extract embeddings:  71%|███████▏  | 25/35 [00:03<00:00, 14.80it/s][1/6] extract embeddings:  77%|███████▋  | 27/35 [00:03<00:00, 14.92it/s][1/6] extract embeddings:  83%|████████▎ | 29/35 [00:03<00:00, 15.15it/s][1/6] extract embeddings:  89%|████████▊ | 31/35 [00:03<00:00, 15.68it/s][1/6] extract embeddings:  94%|█████████▍| 33/35 [00:04<00:00, 15.83it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  8.45it/s]
[NeMo I 2025-04-17 01:24:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:24:01 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:24:01 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:24:01 collections:880] Dataset successfully loaded with 2551 items and total duration provided from manifest is  1.36 hours.
[NeMo I 2025-04-17 01:24:01 collections:886] # 2551 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▎         | 1/40 [00:01<01:00,  1.55s/it][2/6] extract embeddings:  12%|█▎        | 5/40 [00:01<00:09,  3.80it/s][2/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:06,  5.47it/s][2/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:04,  7.29it/s][2/6] extract embeddings:  28%|██▊       | 11/40 [00:02<00:03,  9.17it/s][2/6] extract embeddings:  32%|███▎      | 13/40 [00:02<00:02, 10.85it/s][2/6] extract embeddings:  38%|███▊      | 15/40 [00:02<00:02, 12.33it/s][2/6] extract embeddings:  42%|████▎     | 17/40 [00:02<00:01, 13.56it/s][2/6] extract embeddings:  48%|████▊     | 19/40 [00:02<00:01, 14.97it/s][2/6] extract embeddings:  55%|█████▌    | 22/40 [00:02<00:01, 16.48it/s][2/6] extract embeddings:  60%|██████    | 24/40 [00:02<00:00, 16.32it/s][2/6] extract embeddings:  65%|██████▌   | 26/40 [00:02<00:00, 16.95it/s][2/6] extract embeddings:  70%|███████   | 28/40 [00:02<00:00, 17.51it/s][2/6] extract embeddings:  75%|███████▌  | 30/40 [00:03<00:00, 17.58it/s][2/6] extract embeddings:  80%|████████  | 32/40 [00:03<00:00, 17.68it/s][2/6] extract embeddings:  85%|████████▌ | 34/40 [00:03<00:00, 17.54it/s][2/6] extract embeddings:  90%|█████████ | 36/40 [00:03<00:00, 17.36it/s][2/6] extract embeddings:  95%|█████████▌| 38/40 [00:03<00:00, 17.97it/s][2/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 18.35it/s][2/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 10.95it/s]
[NeMo I 2025-04-17 01:24:05 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:24:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:24:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:24:05 collections:880] Dataset successfully loaded with 3104 items and total duration provided from manifest is  1.42 hours.
[NeMo I 2025-04-17 01:24:05 collections:886] # 3104 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/49 [00:01<00:56,  1.18s/it][3/6] extract embeddings:   6%|▌         | 3/49 [00:01<00:15,  2.90it/s][3/6] extract embeddings:  10%|█         | 5/49 [00:01<00:08,  5.11it/s][3/6] extract embeddings:  14%|█▍        | 7/49 [00:01<00:05,  7.44it/s][3/6] extract embeddings:  20%|██        | 10/49 [00:01<00:03, 10.76it/s][3/6] extract embeddings:  24%|██▍       | 12/49 [00:01<00:03, 12.31it/s][3/6] extract embeddings:  29%|██▊       | 14/49 [00:01<00:02, 13.88it/s][3/6] extract embeddings:  35%|███▍      | 17/49 [00:02<00:02, 15.66it/s][3/6] extract embeddings:  39%|███▉      | 19/49 [00:02<00:01, 16.47it/s][3/6] extract embeddings:  43%|████▎     | 21/49 [00:02<00:01, 16.68it/s][3/6] extract embeddings:  47%|████▋     | 23/49 [00:02<00:01, 17.19it/s][3/6] extract embeddings:  53%|█████▎    | 26/49 [00:02<00:01, 18.13it/s][3/6] extract embeddings:  57%|█████▋    | 28/49 [00:02<00:01, 17.92it/s][3/6] extract embeddings:  61%|██████    | 30/49 [00:02<00:01, 18.15it/s][3/6] extract embeddings:  67%|██████▋   | 33/49 [00:02<00:00, 18.88it/s][3/6] extract embeddings:  71%|███████▏  | 35/49 [00:02<00:00, 18.38it/s][3/6] extract embeddings:  76%|███████▌  | 37/49 [00:03<00:00, 18.78it/s][3/6] extract embeddings:  80%|███████▉  | 39/49 [00:03<00:00, 18.77it/s][3/6] extract embeddings:  84%|████████▎ | 41/49 [00:03<00:00, 18.90it/s][3/6] extract embeddings:  88%|████████▊ | 43/49 [00:03<00:00, 18.83it/s][3/6] extract embeddings:  92%|█████████▏| 45/49 [00:03<00:00, 18.99it/s][3/6] extract embeddings:  98%|█████████▊| 48/49 [00:03<00:00, 19.11it/s][3/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 13.23it/s]
[NeMo I 2025-04-17 01:24:09 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:24:09 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:24:09 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:24:09 collections:880] Dataset successfully loaded with 4073 items and total duration provided from manifest is  1.49 hours.
[NeMo I 2025-04-17 01:24:09 collections:886] # 4073 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/64 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/64 [00:01<01:16,  1.21s/it][4/6] extract embeddings:   6%|▋         | 4/64 [00:01<00:15,  3.84it/s][4/6] extract embeddings:  11%|█         | 7/64 [00:01<00:08,  6.80it/s][4/6] extract embeddings:  16%|█▌        | 10/64 [00:01<00:05,  9.65it/s][4/6] extract embeddings:  19%|█▉        | 12/64 [00:01<00:04, 11.34it/s][4/6] extract embeddings:  23%|██▎       | 15/64 [00:01<00:03, 13.49it/s][4/6] extract embeddings:  27%|██▋       | 17/64 [00:01<00:03, 14.24it/s][4/6] extract embeddings:  30%|██▉       | 19/64 [00:02<00:03, 14.72it/s][4/6] extract embeddings:  33%|███▎      | 21/64 [00:02<00:02, 15.77it/s][4/6] extract embeddings:  36%|███▌      | 23/64 [00:02<00:02, 16.67it/s][4/6] extract embeddings:  39%|███▉      | 25/64 [00:02<00:02, 17.13it/s][4/6] extract embeddings:  42%|████▏     | 27/64 [00:02<00:02, 17.70it/s][4/6] extract embeddings:  45%|████▌     | 29/64 [00:02<00:01, 17.83it/s][4/6] extract embeddings:  50%|█████     | 32/64 [00:02<00:01, 19.41it/s][4/6] extract embeddings:  53%|█████▎    | 34/64 [00:02<00:01, 18.92it/s][4/6] extract embeddings:  56%|█████▋    | 36/64 [00:03<00:01, 18.61it/s][4/6] extract embeddings:  59%|█████▉    | 38/64 [00:03<00:01, 18.40it/s][4/6] extract embeddings:  62%|██████▎   | 40/64 [00:03<00:01, 18.10it/s][4/6] extract embeddings:  66%|██████▌   | 42/64 [00:03<00:01, 18.31it/s][4/6] extract embeddings:  70%|███████   | 45/64 [00:03<00:01, 18.67it/s][4/6] extract embeddings:  73%|███████▎  | 47/64 [00:03<00:00, 18.66it/s][4/6] extract embeddings:  77%|███████▋  | 49/64 [00:03<00:00, 18.54it/s][4/6] extract embeddings:  80%|███████▉  | 51/64 [00:03<00:00, 18.42it/s][4/6] extract embeddings:  83%|████████▎ | 53/64 [00:03<00:00, 18.72it/s][4/6] extract embeddings:  86%|████████▌ | 55/64 [00:04<00:00, 18.60it/s][4/6] extract embeddings:  89%|████████▉ | 57/64 [00:04<00:00, 18.98it/s][4/6] extract embeddings:  92%|█████████▏| 59/64 [00:04<00:00, 18.97it/s][4/6] extract embeddings:  95%|█████████▌| 61/64 [00:04<00:00, 18.93it/s][4/6] extract embeddings: 100%|██████████| 64/64 [00:04<00:00, 19.51it/s][4/6] extract embeddings: 100%|██████████| 64/64 [00:04<00:00, 14.15it/s]
[NeMo I 2025-04-17 01:24:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:24:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:24:14 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:24:14 collections:880] Dataset successfully loaded with 6107 items and total duration provided from manifest is  1.58 hours.
[NeMo I 2025-04-17 01:24:14 collections:886] # 6107 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/96 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/96 [00:01<01:54,  1.21s/it][5/6] extract embeddings:   4%|▍         | 4/96 [00:01<00:24,  3.83it/s][5/6] extract embeddings:   7%|▋         | 7/96 [00:01<00:13,  6.80it/s][5/6] extract embeddings:  10%|█         | 10/96 [00:01<00:08,  9.87it/s][5/6] extract embeddings:  14%|█▎        | 13/96 [00:01<00:06, 12.17it/s][5/6] extract embeddings:  17%|█▋        | 16/96 [00:01<00:05, 14.56it/s][5/6] extract embeddings:  20%|█▉        | 19/96 [00:02<00:04, 16.10it/s][5/6] extract embeddings:  23%|██▎       | 22/96 [00:02<00:04, 17.70it/s][5/6] extract embeddings:  26%|██▌       | 25/96 [00:02<00:03, 19.06it/s][5/6] extract embeddings:  29%|██▉       | 28/96 [00:02<00:03, 19.47it/s][5/6] extract embeddings:  32%|███▏      | 31/96 [00:02<00:03, 20.32it/s][5/6] extract embeddings:  35%|███▌      | 34/96 [00:02<00:03, 20.06it/s][5/6] extract embeddings:  39%|███▊      | 37/96 [00:02<00:02, 20.76it/s][5/6] extract embeddings:  42%|████▏     | 40/96 [00:03<00:02, 20.88it/s][5/6] extract embeddings:  45%|████▍     | 43/96 [00:03<00:02, 20.55it/s][5/6] extract embeddings:  48%|████▊     | 46/96 [00:03<00:02, 21.24it/s][5/6] extract embeddings:  51%|█████     | 49/96 [00:03<00:02, 21.43it/s][5/6] extract embeddings:  54%|█████▍    | 52/96 [00:03<00:01, 22.22it/s][5/6] extract embeddings:  57%|█████▋    | 55/96 [00:03<00:01, 21.69it/s][5/6] extract embeddings:  60%|██████    | 58/96 [00:03<00:01, 21.27it/s][5/6] extract embeddings:  64%|██████▎   | 61/96 [00:03<00:01, 21.34it/s][5/6] extract embeddings:  67%|██████▋   | 64/96 [00:04<00:01, 21.64it/s][5/6] extract embeddings:  70%|██████▉   | 67/96 [00:04<00:01, 21.78it/s][5/6] extract embeddings:  73%|███████▎  | 70/96 [00:04<00:01, 22.12it/s][5/6] extract embeddings:  76%|███████▌  | 73/96 [00:04<00:01, 21.77it/s][5/6] extract embeddings:  79%|███████▉  | 76/96 [00:04<00:00, 21.26it/s][5/6] extract embeddings:  82%|████████▏ | 79/96 [00:04<00:00, 22.05it/s][5/6] extract embeddings:  85%|████████▌ | 82/96 [00:04<00:00, 22.86it/s][5/6] extract embeddings:  89%|████████▊ | 85/96 [00:05<00:00, 22.44it/s][5/6] extract embeddings:  92%|█████████▏| 88/96 [00:05<00:00, 21.55it/s][5/6] extract embeddings:  95%|█████████▍| 91/96 [00:05<00:00, 21.30it/s][5/6] extract embeddings:  98%|█████████▊| 94/96 [00:05<00:00, 20.14it/s][5/6] extract embeddings: 100%|██████████| 96/96 [00:05<00:00, 17.10it/s]
[NeMo I 2025-04-17 01:24:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:24:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:24:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:24:19 collections:880] Dataset successfully loaded with 12437 items and total duration provided from manifest is  1.68 hours.
[NeMo I 2025-04-17 01:24:19 collections:886] # 12437 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/195 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/195 [00:01<04:13,  1.31s/it][6/6] extract embeddings:   3%|▎         | 5/195 [00:01<00:42,  4.49it/s][6/6] extract embeddings:   4%|▍         | 8/195 [00:01<00:25,  7.33it/s][6/6] extract embeddings:   6%|▌         | 11/195 [00:01<00:18, 10.13it/s][6/6] extract embeddings:   7%|▋         | 14/195 [00:01<00:14, 12.68it/s][6/6] extract embeddings:   9%|▊         | 17/195 [00:01<00:11, 15.06it/s][6/6] extract embeddings:  10%|█         | 20/195 [00:02<00:10, 17.20it/s][6/6] extract embeddings:  12%|█▏        | 23/195 [00:02<00:09, 18.80it/s][6/6] extract embeddings:  13%|█▎        | 26/195 [00:02<00:08, 20.67it/s][6/6] extract embeddings:  15%|█▍        | 29/195 [00:02<00:07, 22.78it/s][6/6] extract embeddings:  16%|█▋        | 32/195 [00:02<00:07, 21.93it/s][6/6] extract embeddings:  18%|█▊        | 36/195 [00:02<00:06, 23.97it/s][6/6] extract embeddings:  20%|██        | 39/195 [00:02<00:06, 24.77it/s][6/6] extract embeddings:  22%|██▏       | 42/195 [00:02<00:06, 24.77it/s][6/6] extract embeddings:  23%|██▎       | 45/195 [00:03<00:05, 25.20it/s][6/6] extract embeddings:  25%|██▍       | 48/195 [00:03<00:06, 24.38it/s][6/6] extract embeddings:  26%|██▌       | 51/195 [00:03<00:06, 23.80it/s][6/6] extract embeddings:  28%|██▊       | 54/195 [00:03<00:06, 22.87it/s][6/6] extract embeddings:  29%|██▉       | 57/195 [00:03<00:05, 24.09it/s][6/6] extract embeddings:  31%|███       | 60/195 [00:03<00:05, 24.59it/s][6/6] extract embeddings:  32%|███▏      | 63/195 [00:03<00:05, 24.99it/s][6/6] extract embeddings:  34%|███▍      | 66/195 [00:03<00:05, 25.42it/s][6/6] extract embeddings:  35%|███▌      | 69/195 [00:04<00:04, 25.50it/s][6/6] extract embeddings:  37%|███▋      | 72/195 [00:04<00:04, 26.25it/s][6/6] extract embeddings:  38%|███▊      | 75/195 [00:04<00:04, 25.34it/s][6/6] extract embeddings:  40%|████      | 78/195 [00:04<00:04, 25.48it/s][6/6] extract embeddings:  42%|████▏     | 81/195 [00:04<00:04, 25.41it/s][6/6] extract embeddings:  43%|████▎     | 84/195 [00:04<00:04, 26.25it/s][6/6] extract embeddings:  45%|████▍     | 87/195 [00:04<00:04, 26.79it/s][6/6] extract embeddings:  46%|████▌     | 90/195 [00:04<00:03, 26.62it/s][6/6] extract embeddings:  48%|████▊     | 93/195 [00:04<00:03, 26.77it/s][6/6] extract embeddings:  49%|████▉     | 96/195 [00:05<00:03, 26.34it/s][6/6] extract embeddings:  51%|█████     | 99/195 [00:05<00:03, 24.82it/s][6/6] extract embeddings:  52%|█████▏    | 102/195 [00:05<00:03, 25.34it/s][6/6] extract embeddings:  54%|█████▍    | 105/195 [00:05<00:03, 25.01it/s][6/6] extract embeddings:  55%|█████▌    | 108/195 [00:05<00:03, 24.93it/s][6/6] extract embeddings:  57%|█████▋    | 111/195 [00:05<00:03, 24.27it/s][6/6] extract embeddings:  58%|█████▊    | 114/195 [00:05<00:03, 24.24it/s][6/6] extract embeddings:  60%|██████    | 117/195 [00:05<00:03, 24.71it/s][6/6] extract embeddings:  62%|██████▏   | 120/195 [00:06<00:03, 24.54it/s][6/6] extract embeddings:  63%|██████▎   | 123/195 [00:06<00:02, 25.31it/s][6/6] extract embeddings:  65%|██████▌   | 127/195 [00:06<00:02, 27.48it/s][6/6] extract embeddings:  67%|██████▋   | 130/195 [00:06<00:02, 27.14it/s][6/6] extract embeddings:  68%|██████▊   | 133/195 [00:06<00:02, 25.46it/s][6/6] extract embeddings:  70%|██████▉   | 136/195 [00:06<00:02, 24.08it/s][6/6] extract embeddings:  72%|███████▏  | 140/195 [00:06<00:02, 25.57it/s][6/6] extract embeddings:  73%|███████▎  | 143/195 [00:06<00:02, 25.94it/s][6/6] extract embeddings:  75%|███████▍  | 146/195 [00:07<00:01, 25.87it/s][6/6] extract embeddings:  76%|███████▋  | 149/195 [00:07<00:01, 26.20it/s][6/6] extract embeddings:  78%|███████▊  | 152/195 [00:07<00:01, 26.84it/s][6/6] extract embeddings:  79%|███████▉  | 155/195 [00:07<00:01, 26.01it/s][6/6] extract embeddings:  81%|████████  | 158/195 [00:07<00:01, 26.16it/s][6/6] extract embeddings:  83%|████████▎ | 161/195 [00:07<00:01, 25.69it/s][6/6] extract embeddings:  84%|████████▍ | 164/195 [00:07<00:01, 25.92it/s][6/6] extract embeddings:  86%|████████▌ | 167/195 [00:07<00:01, 26.73it/s][6/6] extract embeddings:  87%|████████▋ | 170/195 [00:07<00:00, 27.61it/s][6/6] extract embeddings:  89%|████████▊ | 173/195 [00:08<00:00, 27.89it/s][6/6] extract embeddings:  91%|█████████ | 177/195 [00:08<00:00, 29.52it/s][6/6] extract embeddings:  92%|█████████▏| 180/195 [00:08<00:00, 29.46it/s][6/6] extract embeddings:  94%|█████████▍| 184/195 [00:08<00:00, 30.18it/s][6/6] extract embeddings:  96%|█████████▋| 188/195 [00:08<00:00, 27.96it/s][6/6] extract embeddings:  98%|█████████▊| 191/195 [00:08<00:00, 25.51it/s][6/6] extract embeddings:  99%|█████████▉| 194/195 [00:08<00:00, 24.21it/s][6/6] extract embeddings: 100%|██████████| 195/195 [00:08<00:00, 21.89it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.22it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.45it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.10it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.68it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.29it/s]
[NeMo I 2025-04-17 01:24:31 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:24:32 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              44.674893   444.120  ...   18.520016  4.170048
    Harker-ES                       35.051039  2178.782  ...   60.277703  2.766578
    Harker-MN                       47.558243   366.767  ...   29.742967  8.109499
    Longfellow-Block-1              30.124645   492.417  ...   14.500970  2.944856
    TOTAL                           36.899223  3482.086  ...  123.041656  3.533562
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:24:32 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0752 | MISS: 0.2585 | CER: 0.0353 | DER: 0.3690 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.45, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.45, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.87s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:24:44 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:24:44 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:24:44 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:24:44 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:24:44 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:24:44 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:24:44 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:24:44 features:305] PADDING: 16
[NeMo I 2025-04-17 01:24:45 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:24:45 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:24:45 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:24:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:24:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:24:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:24:45 collections:880] Dataset successfully loaded with 2193 items and total duration provided from manifest is  1.27 hours.
[NeMo I 2025-04-17 01:24:45 collections:886] # 2193 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:11,  2.11s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:13,  2.32it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:07,  3.70it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:05,  5.30it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.89it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  8.39it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02,  9.80it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 11.27it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 12.06it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 12.74it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:00, 13.40it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 14.34it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 14.22it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:03<00:00, 14.12it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:03<00:00, 14.31it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:04<00:00, 13.89it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 14.00it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  8.17it/s]
[NeMo I 2025-04-17 01:24:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:24:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:24:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:24:49 collections:880] Dataset successfully loaded with 2537 items and total duration provided from manifest is  1.33 hours.
[NeMo I 2025-04-17 01:24:49 collections:886] # 2537 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:55,  1.42s/it][2/6] extract embeddings:   8%|▊         | 3/40 [00:01<00:15,  2.44it/s][2/6] extract embeddings:  12%|█▎        | 5/40 [00:01<00:08,  4.27it/s][2/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:05,  6.29it/s][2/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  8.40it/s][2/6] extract embeddings:  28%|██▊       | 11/40 [00:01<00:02, 10.46it/s][2/6] extract embeddings:  32%|███▎      | 13/40 [00:02<00:02, 11.91it/s][2/6] extract embeddings:  38%|███▊      | 15/40 [00:02<00:01, 13.38it/s][2/6] extract embeddings:  42%|████▎     | 17/40 [00:02<00:01, 14.53it/s][2/6] extract embeddings:  48%|████▊     | 19/40 [00:02<00:01, 15.87it/s][2/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 16.19it/s][2/6] extract embeddings:  57%|█████▊    | 23/40 [00:02<00:01, 16.74it/s][2/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:00, 16.49it/s][2/6] extract embeddings:  68%|██████▊   | 27/40 [00:02<00:00, 17.05it/s][2/6] extract embeddings:  75%|███████▌  | 30/40 [00:03<00:00, 17.94it/s][2/6] extract embeddings:  80%|████████  | 32/40 [00:03<00:00, 17.40it/s][2/6] extract embeddings:  85%|████████▌ | 34/40 [00:03<00:00, 16.79it/s][2/6] extract embeddings:  90%|█████████ | 36/40 [00:03<00:00, 16.37it/s][2/6] extract embeddings:  95%|█████████▌| 38/40 [00:03<00:00, 16.12it/s][2/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 16.80it/s][2/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 10.80it/s]
[NeMo I 2025-04-17 01:24:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:24:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:24:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:24:53 collections:880] Dataset successfully loaded with 3071 items and total duration provided from manifest is  1.39 hours.
[NeMo I 2025-04-17 01:24:53 collections:886] # 3071 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/48 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/48 [00:01<01:02,  1.33s/it][3/6] extract embeddings:   8%|▊         | 4/48 [00:01<00:12,  3.44it/s][3/6] extract embeddings:  12%|█▎        | 6/48 [00:01<00:07,  5.33it/s][3/6] extract embeddings:  19%|█▉        | 9/48 [00:01<00:04,  8.16it/s][3/6] extract embeddings:  25%|██▌       | 12/48 [00:01<00:03, 10.83it/s][3/6] extract embeddings:  29%|██▉       | 14/48 [00:01<00:02, 12.29it/s][3/6] extract embeddings:  33%|███▎      | 16/48 [00:02<00:02, 13.80it/s][3/6] extract embeddings:  38%|███▊      | 18/48 [00:02<00:01, 15.07it/s][3/6] extract embeddings:  44%|████▍     | 21/48 [00:02<00:01, 16.96it/s][3/6] extract embeddings:  48%|████▊     | 23/48 [00:02<00:01, 17.35it/s][3/6] extract embeddings:  54%|█████▍    | 26/48 [00:02<00:01, 18.74it/s][3/6] extract embeddings:  60%|██████    | 29/48 [00:02<00:01, 18.99it/s][3/6] extract embeddings:  65%|██████▍   | 31/48 [00:02<00:00, 19.03it/s][3/6] extract embeddings:  71%|███████   | 34/48 [00:02<00:00, 19.44it/s][3/6] extract embeddings:  75%|███████▌  | 36/48 [00:03<00:00, 19.05it/s][3/6] extract embeddings:  79%|███████▉  | 38/48 [00:03<00:00, 19.15it/s][3/6] extract embeddings:  83%|████████▎ | 40/48 [00:03<00:00, 18.93it/s][3/6] extract embeddings:  88%|████████▊ | 42/48 [00:03<00:00, 18.21it/s][3/6] extract embeddings:  92%|█████████▏| 44/48 [00:03<00:00, 17.61it/s][3/6] extract embeddings:  96%|█████████▌| 46/48 [00:03<00:00, 17.17it/s][3/6] extract embeddings: 100%|██████████| 48/48 [00:03<00:00, 16.99it/s][3/6] extract embeddings: 100%|██████████| 48/48 [00:03<00:00, 12.53it/s]
[NeMo I 2025-04-17 01:24:57 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:24:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:24:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:24:57 collections:880] Dataset successfully loaded with 4016 items and total duration provided from manifest is  1.46 hours.
[NeMo I 2025-04-17 01:24:57 collections:886] # 4016 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/63 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/63 [00:01<01:22,  1.33s/it][4/6] extract embeddings:   6%|▋         | 4/63 [00:01<00:17,  3.46it/s][4/6] extract embeddings:  11%|█         | 7/63 [00:01<00:08,  6.34it/s][4/6] extract embeddings:  16%|█▌        | 10/63 [00:01<00:05,  9.29it/s][4/6] extract embeddings:  21%|██        | 13/63 [00:01<00:04, 12.12it/s][4/6] extract embeddings:  25%|██▌       | 16/63 [00:01<00:03, 14.72it/s][4/6] extract embeddings:  30%|███       | 19/63 [00:02<00:02, 16.54it/s][4/6] extract embeddings:  35%|███▍      | 22/63 [00:02<00:02, 17.63it/s][4/6] extract embeddings:  40%|███▉      | 25/63 [00:02<00:02, 18.72it/s][4/6] extract embeddings:  44%|████▍     | 28/63 [00:02<00:01, 18.39it/s][4/6] extract embeddings:  49%|████▉     | 31/63 [00:02<00:01, 18.93it/s][4/6] extract embeddings:  54%|█████▍    | 34/63 [00:02<00:01, 19.05it/s][4/6] extract embeddings:  59%|█████▊    | 37/63 [00:03<00:01, 18.93it/s][4/6] extract embeddings:  62%|██████▏   | 39/63 [00:03<00:01, 19.02it/s][4/6] extract embeddings:  67%|██████▋   | 42/63 [00:03<00:01, 19.55it/s][4/6] extract embeddings:  71%|███████▏  | 45/63 [00:03<00:00, 20.14it/s][4/6] extract embeddings:  76%|███████▌  | 48/63 [00:03<00:00, 19.78it/s][4/6] extract embeddings:  79%|███████▉  | 50/63 [00:03<00:00, 19.69it/s][4/6] extract embeddings:  83%|████████▎ | 52/63 [00:03<00:00, 18.63it/s][4/6] extract embeddings:  87%|████████▋ | 55/63 [00:03<00:00, 19.04it/s][4/6] extract embeddings:  90%|█████████ | 57/63 [00:04<00:00, 18.84it/s][4/6] extract embeddings:  94%|█████████▎| 59/63 [00:04<00:00, 18.51it/s][4/6] extract embeddings:  98%|█████████▊| 62/63 [00:04<00:00, 19.24it/s][4/6] extract embeddings: 100%|██████████| 63/63 [00:04<00:00, 14.32it/s]
[NeMo I 2025-04-17 01:25:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:25:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:25:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:25:02 collections:880] Dataset successfully loaded with 6019 items and total duration provided from manifest is  1.55 hours.
[NeMo I 2025-04-17 01:25:02 collections:886] # 6019 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/95 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/95 [00:01<01:52,  1.20s/it][5/6] extract embeddings:   4%|▍         | 4/95 [00:01<00:23,  3.89it/s][5/6] extract embeddings:   7%|▋         | 7/95 [00:01<00:12,  7.08it/s][5/6] extract embeddings:   9%|▉         | 9/95 [00:01<00:09,  9.05it/s][5/6] extract embeddings:  13%|█▎        | 12/95 [00:01<00:06, 12.26it/s][5/6] extract embeddings:  16%|█▌        | 15/95 [00:01<00:05, 15.23it/s][5/6] extract embeddings:  19%|█▉        | 18/95 [00:01<00:04, 17.63it/s][5/6] extract embeddings:  22%|██▏       | 21/95 [00:02<00:03, 18.74it/s][5/6] extract embeddings:  25%|██▌       | 24/95 [00:02<00:03, 20.03it/s][5/6] extract embeddings:  28%|██▊       | 27/95 [00:02<00:03, 20.19it/s][5/6] extract embeddings:  32%|███▏      | 30/95 [00:02<00:03, 21.01it/s][5/6] extract embeddings:  35%|███▍      | 33/95 [00:02<00:02, 21.55it/s][5/6] extract embeddings:  38%|███▊      | 36/95 [00:02<00:02, 22.05it/s][5/6] extract embeddings:  41%|████      | 39/95 [00:02<00:02, 22.48it/s][5/6] extract embeddings:  44%|████▍     | 42/95 [00:02<00:02, 22.10it/s][5/6] extract embeddings:  47%|████▋     | 45/95 [00:03<00:02, 22.74it/s][5/6] extract embeddings:  51%|█████     | 48/95 [00:03<00:01, 23.71it/s][5/6] extract embeddings:  54%|█████▎    | 51/95 [00:03<00:01, 23.13it/s][5/6] extract embeddings:  57%|█████▋    | 54/95 [00:03<00:01, 22.73it/s][5/6] extract embeddings:  60%|██████    | 57/95 [00:03<00:01, 22.97it/s][5/6] extract embeddings:  63%|██████▎   | 60/95 [00:03<00:01, 23.29it/s][5/6] extract embeddings:  66%|██████▋   | 63/95 [00:03<00:01, 23.56it/s][5/6] extract embeddings:  69%|██████▉   | 66/95 [00:03<00:01, 23.52it/s][5/6] extract embeddings:  73%|███████▎  | 69/95 [00:04<00:01, 23.79it/s][5/6] extract embeddings:  76%|███████▌  | 72/95 [00:04<00:00, 23.32it/s][5/6] extract embeddings:  79%|███████▉  | 75/95 [00:04<00:00, 22.37it/s][5/6] extract embeddings:  82%|████████▏ | 78/95 [00:04<00:00, 21.60it/s][5/6] extract embeddings:  85%|████████▌ | 81/95 [00:04<00:00, 22.66it/s][5/6] extract embeddings:  88%|████████▊ | 84/95 [00:04<00:00, 22.34it/s][5/6] extract embeddings:  92%|█████████▏| 87/95 [00:04<00:00, 21.67it/s][5/6] extract embeddings:  95%|█████████▍| 90/95 [00:05<00:00, 21.33it/s][5/6] extract embeddings:  98%|█████████▊| 93/95 [00:05<00:00, 22.46it/s][5/6] extract embeddings: 100%|██████████| 95/95 [00:05<00:00, 17.89it/s]
[NeMo I 2025-04-17 01:25:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:25:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:25:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:25:08 collections:880] Dataset successfully loaded with 12240 items and total duration provided from manifest is  1.65 hours.
[NeMo I 2025-04-17 01:25:08 collections:886] # 12240 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/192 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/192 [00:01<03:46,  1.19s/it][6/6] extract embeddings:   3%|▎         | 5/192 [00:01<00:38,  4.87it/s][6/6] extract embeddings:   5%|▍         | 9/192 [00:01<00:20,  9.09it/s][6/6] extract embeddings:   7%|▋         | 13/192 [00:01<00:13, 13.22it/s][6/6] extract embeddings:   8%|▊         | 16/192 [00:01<00:11, 15.97it/s][6/6] extract embeddings:  10%|▉         | 19/192 [00:01<00:09, 18.26it/s][6/6] extract embeddings:  11%|█▏        | 22/192 [00:01<00:08, 20.10it/s][6/6] extract embeddings:  13%|█▎        | 25/192 [00:02<00:07, 21.73it/s][6/6] extract embeddings:  15%|█▍        | 28/192 [00:02<00:07, 21.55it/s][6/6] extract embeddings:  16%|█▌        | 31/192 [00:02<00:06, 23.27it/s][6/6] extract embeddings:  18%|█▊        | 34/192 [00:02<00:06, 24.71it/s][6/6] extract embeddings:  19%|█▉        | 37/192 [00:02<00:06, 24.93it/s][6/6] extract embeddings:  21%|██        | 40/192 [00:02<00:06, 25.20it/s][6/6] extract embeddings:  22%|██▏       | 43/192 [00:02<00:05, 24.84it/s][6/6] extract embeddings:  24%|██▍       | 46/192 [00:02<00:05, 25.19it/s][6/6] extract embeddings:  26%|██▌       | 49/192 [00:02<00:05, 23.93it/s][6/6] extract embeddings:  27%|██▋       | 52/192 [00:03<00:05, 24.24it/s][6/6] extract embeddings:  29%|██▊       | 55/192 [00:03<00:05, 24.07it/s][6/6] extract embeddings:  30%|███       | 58/192 [00:03<00:05, 24.49it/s][6/6] extract embeddings:  32%|███▏      | 61/192 [00:03<00:05, 25.41it/s][6/6] extract embeddings:  33%|███▎      | 64/192 [00:03<00:04, 26.01it/s][6/6] extract embeddings:  35%|███▍      | 67/192 [00:03<00:04, 25.08it/s][6/6] extract embeddings:  36%|███▋      | 70/192 [00:03<00:04, 25.47it/s][6/6] extract embeddings:  38%|███▊      | 73/192 [00:03<00:04, 25.41it/s][6/6] extract embeddings:  40%|███▉      | 76/192 [00:04<00:04, 26.62it/s][6/6] extract embeddings:  41%|████      | 79/192 [00:04<00:04, 27.27it/s][6/6] extract embeddings:  43%|████▎     | 82/192 [00:04<00:04, 27.15it/s][6/6] extract embeddings:  44%|████▍     | 85/192 [00:04<00:03, 27.50it/s][6/6] extract embeddings:  46%|████▌     | 88/192 [00:04<00:03, 27.40it/s][6/6] extract embeddings:  47%|████▋     | 91/192 [00:04<00:03, 27.71it/s][6/6] extract embeddings:  49%|████▉     | 94/192 [00:04<00:03, 27.05it/s][6/6] extract embeddings:  51%|█████     | 97/192 [00:04<00:03, 26.65it/s][6/6] extract embeddings:  52%|█████▏    | 100/192 [00:04<00:03, 26.62it/s][6/6] extract embeddings:  54%|█████▎    | 103/192 [00:05<00:03, 26.43it/s][6/6] extract embeddings:  55%|█████▌    | 106/192 [00:05<00:03, 26.11it/s][6/6] extract embeddings:  57%|█████▋    | 109/192 [00:05<00:03, 25.14it/s][6/6] extract embeddings:  58%|█████▊    | 112/192 [00:05<00:03, 25.68it/s][6/6] extract embeddings:  60%|█████▉    | 115/192 [00:05<00:02, 25.68it/s][6/6] extract embeddings:  61%|██████▏   | 118/192 [00:05<00:03, 23.86it/s][6/6] extract embeddings:  63%|██████▎   | 121/192 [00:05<00:02, 25.01it/s][6/6] extract embeddings:  65%|██████▍   | 124/192 [00:05<00:02, 25.68it/s][6/6] extract embeddings:  66%|██████▌   | 127/192 [00:05<00:02, 24.72it/s][6/6] extract embeddings:  68%|██████▊   | 130/192 [00:06<00:02, 24.10it/s][6/6] extract embeddings:  69%|██████▉   | 133/192 [00:06<00:02, 24.83it/s][6/6] extract embeddings:  71%|███████   | 136/192 [00:06<00:02, 25.72it/s][6/6] extract embeddings:  72%|███████▏  | 139/192 [00:06<00:02, 25.69it/s][6/6] extract embeddings:  74%|███████▍  | 142/192 [00:06<00:01, 26.02it/s][6/6] extract embeddings:  76%|███████▌  | 145/192 [00:06<00:01, 27.00it/s][6/6] extract embeddings:  77%|███████▋  | 148/192 [00:06<00:01, 27.54it/s][6/6] extract embeddings:  79%|███████▊  | 151/192 [00:06<00:01, 26.88it/s][6/6] extract embeddings:  80%|████████  | 154/192 [00:07<00:01, 25.96it/s][6/6] extract embeddings:  82%|████████▏ | 157/192 [00:07<00:01, 26.05it/s][6/6] extract embeddings:  83%|████████▎ | 160/192 [00:07<00:01, 24.58it/s][6/6] extract embeddings:  85%|████████▍ | 163/192 [00:07<00:01, 25.20it/s][6/6] extract embeddings:  87%|████████▋ | 167/192 [00:07<00:00, 26.96it/s][6/6] extract embeddings:  89%|████████▉ | 171/192 [00:07<00:00, 29.17it/s][6/6] extract embeddings:  91%|█████████ | 175/192 [00:07<00:00, 31.18it/s][6/6] extract embeddings:  93%|█████████▎| 179/192 [00:07<00:00, 30.90it/s][6/6] extract embeddings:  95%|█████████▌| 183/192 [00:08<00:00, 29.38it/s][6/6] extract embeddings:  97%|█████████▋| 186/192 [00:08<00:00, 26.80it/s][6/6] extract embeddings:  98%|█████████▊| 189/192 [00:08<00:00, 25.24it/s][6/6] extract embeddings: 100%|██████████| 192/192 [00:08<00:00, 24.60it/s][6/6] extract embeddings: 100%|██████████| 192/192 [00:08<00:00, 22.67it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.28it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.49it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.14it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.77it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.36it/s]
[NeMo I 2025-04-17 01:25:18 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:25:19 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              44.322513   444.120  ...   16.655062  3.750126
    Harker-ES                       35.953227  2178.782  ...   59.425994  2.727487
    Harker-MN                       47.812373   366.767  ...   29.802947  8.125853
    Longfellow-Block-1              30.396952   492.417  ...   10.619988  2.156706
    TOTAL                           37.484064  3482.086  ...  116.503990  3.345810
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:25:19 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0728 | MISS: 0.2686 | CER: 0.0335 | DER: 0.3748 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.50, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.5, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.90s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.96s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:25:32 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:25:32 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:25:32 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:25:32 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:25:32 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:25:32 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:25:32 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:25:32 features:305] PADDING: 16
[NeMo I 2025-04-17 01:25:33 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:25:33 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:25:33 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:25:33 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:25:33 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:25:33 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:25:33 collections:880] Dataset successfully loaded with 2188 items and total duration provided from manifest is  1.24 hours.
[NeMo I 2025-04-17 01:25:33 collections:886] # 2188 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:08,  2.02s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:12,  2.41it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:07,  3.82it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:04,  5.42it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.93it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  8.47it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02,  9.87it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 10.96it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 12.30it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 12.84it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:00, 13.16it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 13.94it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 13.93it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:03<00:00, 13.99it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:03<00:00, 13.54it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:04<00:00, 13.76it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 14.28it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  8.28it/s]
[NeMo I 2025-04-17 01:25:37 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:25:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:25:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:25:37 collections:880] Dataset successfully loaded with 2518 items and total duration provided from manifest is  1.30 hours.
[NeMo I 2025-04-17 01:25:37 collections:886] # 2518 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][2/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:55,  1.42s/it][2/6] extract embeddings:   8%|▊         | 3/40 [00:01<00:15,  2.43it/s][2/6] extract embeddings:  12%|█▎        | 5/40 [00:01<00:08,  4.36it/s][2/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:05,  6.30it/s][2/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  8.32it/s][2/6] extract embeddings:  28%|██▊       | 11/40 [00:02<00:02,  9.92it/s][2/6] extract embeddings:  32%|███▎      | 13/40 [00:02<00:02, 11.14it/s][2/6] extract embeddings:  38%|███▊      | 15/40 [00:02<00:02, 11.97it/s][2/6] extract embeddings:  42%|████▎     | 17/40 [00:02<00:01, 13.15it/s][2/6] extract embeddings:  48%|████▊     | 19/40 [00:02<00:01, 14.50it/s][2/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 14.92it/s][2/6] extract embeddings:  57%|█████▊    | 23/40 [00:02<00:01, 15.64it/s][2/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:00, 15.38it/s][2/6] extract embeddings:  68%|██████▊   | 27/40 [00:03<00:00, 15.68it/s][2/6] extract embeddings:  72%|███████▎  | 29/40 [00:03<00:00, 16.23it/s][2/6] extract embeddings:  78%|███████▊  | 31/40 [00:03<00:00, 15.86it/s][2/6] extract embeddings:  82%|████████▎ | 33/40 [00:03<00:00, 15.95it/s][2/6] extract embeddings:  88%|████████▊ | 35/40 [00:03<00:00, 15.63it/s][2/6] extract embeddings:  92%|█████████▎| 37/40 [00:03<00:00, 15.79it/s][2/6] extract embeddings:  98%|█████████▊| 39/40 [00:03<00:00, 15.82it/s][2/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 10.45it/s]
[NeMo I 2025-04-17 01:25:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:25:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:25:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:25:41 collections:880] Dataset successfully loaded with 3042 items and total duration provided from manifest is  1.36 hours.
[NeMo I 2025-04-17 01:25:41 collections:886] # 3042 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/48 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/48 [00:01<00:55,  1.19s/it][3/6] extract embeddings:   6%|▋         | 3/48 [00:01<00:15,  2.88it/s][3/6] extract embeddings:  10%|█         | 5/48 [00:01<00:08,  5.07it/s][3/6] extract embeddings:  15%|█▍        | 7/48 [00:01<00:05,  7.41it/s][3/6] extract embeddings:  19%|█▉        | 9/48 [00:01<00:04,  9.71it/s][3/6] extract embeddings:  23%|██▎       | 11/48 [00:01<00:03, 11.70it/s][3/6] extract embeddings:  27%|██▋       | 13/48 [00:01<00:02, 12.59it/s][3/6] extract embeddings:  31%|███▏      | 15/48 [00:01<00:02, 13.68it/s][3/6] extract embeddings:  35%|███▌      | 17/48 [00:02<00:02, 14.19it/s][3/6] extract embeddings:  40%|███▉      | 19/48 [00:02<00:02, 14.36it/s][3/6] extract embeddings:  44%|████▍     | 21/48 [00:02<00:01, 14.71it/s][3/6] extract embeddings:  48%|████▊     | 23/48 [00:02<00:01, 15.01it/s][3/6] extract embeddings:  52%|█████▏    | 25/48 [00:02<00:01, 15.33it/s][3/6] extract embeddings:  56%|█████▋    | 27/48 [00:02<00:01, 16.30it/s][3/6] extract embeddings:  60%|██████    | 29/48 [00:02<00:01, 16.55it/s][3/6] extract embeddings:  65%|██████▍   | 31/48 [00:02<00:01, 16.99it/s][3/6] extract embeddings:  71%|███████   | 34/48 [00:03<00:00, 18.68it/s][3/6] extract embeddings:  75%|███████▌  | 36/48 [00:03<00:00, 17.08it/s][3/6] extract embeddings:  79%|███████▉  | 38/48 [00:03<00:00, 16.81it/s][3/6] extract embeddings:  83%|████████▎ | 40/48 [00:03<00:00, 16.49it/s][3/6] extract embeddings:  88%|████████▊ | 42/48 [00:03<00:00, 15.92it/s][3/6] extract embeddings:  94%|█████████▍| 45/48 [00:03<00:00, 16.70it/s][3/6] extract embeddings: 100%|██████████| 48/48 [00:03<00:00, 18.83it/s][3/6] extract embeddings: 100%|██████████| 48/48 [00:03<00:00, 12.21it/s]
[NeMo I 2025-04-17 01:25:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:25:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:25:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:25:45 collections:880] Dataset successfully loaded with 3973 items and total duration provided from manifest is  1.43 hours.
[NeMo I 2025-04-17 01:25:45 collections:886] # 3973 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/63 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/63 [00:01<01:13,  1.19s/it][4/6] extract embeddings:   6%|▋         | 4/63 [00:01<00:15,  3.78it/s][4/6] extract embeddings:  10%|▉         | 6/63 [00:01<00:09,  5.77it/s][4/6] extract embeddings:  14%|█▍        | 9/63 [00:01<00:06,  8.97it/s][4/6] extract embeddings:  19%|█▉        | 12/63 [00:01<00:04, 11.88it/s][4/6] extract embeddings:  24%|██▍       | 15/63 [00:01<00:03, 14.12it/s][4/6] extract embeddings:  29%|██▊       | 18/63 [00:01<00:02, 16.15it/s][4/6] extract embeddings:  33%|███▎      | 21/63 [00:02<00:02, 17.72it/s][4/6] extract embeddings:  38%|███▊      | 24/63 [00:02<00:02, 18.30it/s][4/6] extract embeddings:  43%|████▎     | 27/63 [00:02<00:01, 19.30it/s][4/6] extract embeddings:  48%|████▊     | 30/63 [00:02<00:01, 20.31it/s][4/6] extract embeddings:  52%|█████▏    | 33/63 [00:02<00:01, 20.07it/s][4/6] extract embeddings:  57%|█████▋    | 36/63 [00:02<00:01, 21.23it/s][4/6] extract embeddings:  62%|██████▏   | 39/63 [00:02<00:01, 21.40it/s][4/6] extract embeddings:  67%|██████▋   | 42/63 [00:03<00:00, 22.08it/s][4/6] extract embeddings:  71%|███████▏  | 45/63 [00:03<00:00, 22.07it/s][4/6] extract embeddings:  76%|███████▌  | 48/63 [00:03<00:00, 20.55it/s][4/6] extract embeddings:  81%|████████  | 51/63 [00:03<00:00, 20.26it/s][4/6] extract embeddings:  86%|████████▌ | 54/63 [00:03<00:00, 20.67it/s][4/6] extract embeddings:  90%|█████████ | 57/63 [00:03<00:00, 21.06it/s][4/6] extract embeddings:  95%|█████████▌| 60/63 [00:03<00:00, 21.50it/s][4/6] extract embeddings: 100%|██████████| 63/63 [00:04<00:00, 22.50it/s][4/6] extract embeddings: 100%|██████████| 63/63 [00:04<00:00, 15.35it/s]
[NeMo I 2025-04-17 01:25:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:25:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:25:50 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:25:50 collections:880] Dataset successfully loaded with 5925 items and total duration provided from manifest is  1.52 hours.
[NeMo I 2025-04-17 01:25:50 collections:886] # 5925 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/93 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/93 [00:01<01:47,  1.17s/it][5/6] extract embeddings:   4%|▍         | 4/93 [00:01<00:22,  4.00it/s][5/6] extract embeddings:   8%|▊         | 7/93 [00:01<00:11,  7.46it/s][5/6] extract embeddings:  11%|█         | 10/93 [00:01<00:07, 10.63it/s][5/6] extract embeddings:  14%|█▍        | 13/93 [00:01<00:05, 13.70it/s][5/6] extract embeddings:  17%|█▋        | 16/93 [00:01<00:04, 16.10it/s][5/6] extract embeddings:  20%|██        | 19/93 [00:01<00:03, 18.78it/s][5/6] extract embeddings:  24%|██▎       | 22/93 [00:01<00:03, 20.31it/s][5/6] extract embeddings:  27%|██▋       | 25/93 [00:02<00:03, 21.66it/s][5/6] extract embeddings:  30%|███       | 28/93 [00:02<00:02, 21.92it/s][5/6] extract embeddings:  33%|███▎      | 31/93 [00:02<00:02, 20.95it/s][5/6] extract embeddings:  37%|███▋      | 34/93 [00:02<00:02, 21.68it/s][5/6] extract embeddings:  40%|███▉      | 37/93 [00:02<00:02, 22.64it/s][5/6] extract embeddings:  43%|████▎     | 40/93 [00:02<00:02, 22.46it/s][5/6] extract embeddings:  46%|████▌     | 43/93 [00:02<00:02, 22.34it/s][5/6] extract embeddings:  49%|████▉     | 46/93 [00:03<00:02, 21.86it/s][5/6] extract embeddings:  53%|█████▎    | 49/93 [00:03<00:01, 22.01it/s][5/6] extract embeddings:  56%|█████▌    | 52/93 [00:03<00:01, 22.53it/s][5/6] extract embeddings:  59%|█████▉    | 55/93 [00:03<00:01, 23.17it/s][5/6] extract embeddings:  62%|██████▏   | 58/93 [00:03<00:01, 21.87it/s][5/6] extract embeddings:  66%|██████▌   | 61/93 [00:03<00:01, 21.36it/s][5/6] extract embeddings:  69%|██████▉   | 64/93 [00:03<00:01, 21.57it/s][5/6] extract embeddings:  72%|███████▏  | 67/93 [00:04<00:01, 20.30it/s][5/6] extract embeddings:  75%|███████▌  | 70/93 [00:04<00:01, 21.09it/s][5/6] extract embeddings:  78%|███████▊  | 73/93 [00:04<00:00, 21.43it/s][5/6] extract embeddings:  82%|████████▏ | 76/93 [00:04<00:00, 21.52it/s][5/6] extract embeddings:  85%|████████▍ | 79/93 [00:04<00:00, 21.51it/s][5/6] extract embeddings:  88%|████████▊ | 82/93 [00:04<00:00, 21.55it/s][5/6] extract embeddings:  91%|█████████▏| 85/93 [00:04<00:00, 21.56it/s][5/6] extract embeddings:  95%|█████████▍| 88/93 [00:04<00:00, 21.71it/s][5/6] extract embeddings:  98%|█████████▊| 91/93 [00:05<00:00, 22.60it/s][5/6] extract embeddings: 100%|██████████| 93/93 [00:05<00:00, 17.86it/s]
[NeMo I 2025-04-17 01:25:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:25:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:25:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:25:55 collections:880] Dataset successfully loaded with 12052 items and total duration provided from manifest is  1.62 hours.
[NeMo I 2025-04-17 01:25:55 collections:886] # 12052 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/189 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/189 [00:01<04:24,  1.41s/it][6/6] extract embeddings:   2%|▏         | 4/189 [00:01<00:54,  3.40it/s][6/6] extract embeddings:   4%|▎         | 7/189 [00:01<00:28,  6.39it/s][6/6] extract embeddings:   5%|▌         | 10/189 [00:01<00:19,  9.33it/s][6/6] extract embeddings:   7%|▋         | 13/189 [00:01<00:14, 12.21it/s][6/6] extract embeddings:   8%|▊         | 16/189 [00:01<00:11, 15.12it/s][6/6] extract embeddings:  10%|█         | 19/189 [00:02<00:09, 17.56it/s][6/6] extract embeddings:  12%|█▏        | 22/189 [00:02<00:08, 19.18it/s][6/6] extract embeddings:  13%|█▎        | 25/189 [00:02<00:07, 21.06it/s][6/6] extract embeddings:  15%|█▍        | 28/189 [00:02<00:07, 21.65it/s][6/6] extract embeddings:  16%|█▋        | 31/189 [00:02<00:07, 22.48it/s][6/6] extract embeddings:  18%|█▊        | 34/189 [00:02<00:06, 22.96it/s][6/6] extract embeddings:  20%|█▉        | 37/189 [00:02<00:06, 23.48it/s][6/6] extract embeddings:  21%|██        | 40/189 [00:02<00:06, 24.26it/s][6/6] extract embeddings:  23%|██▎       | 44/189 [00:03<00:05, 25.71it/s][6/6] extract embeddings:  25%|██▍       | 47/189 [00:03<00:05, 25.13it/s][6/6] extract embeddings:  26%|██▋       | 50/189 [00:03<00:05, 25.07it/s][6/6] extract embeddings:  28%|██▊       | 53/189 [00:03<00:05, 24.82it/s][6/6] extract embeddings:  30%|██▉       | 56/189 [00:03<00:05, 26.10it/s][6/6] extract embeddings:  31%|███       | 59/189 [00:03<00:04, 27.07it/s][6/6] extract embeddings:  33%|███▎      | 62/189 [00:03<00:04, 26.22it/s][6/6] extract embeddings:  34%|███▍      | 65/189 [00:03<00:04, 25.90it/s][6/6] extract embeddings:  36%|███▌      | 68/189 [00:04<00:05, 23.95it/s][6/6] extract embeddings:  38%|███▊      | 71/189 [00:04<00:05, 22.62it/s][6/6] extract embeddings:  39%|███▉      | 74/189 [00:04<00:05, 21.37it/s][6/6] extract embeddings:  41%|████      | 77/189 [00:04<00:04, 22.43it/s][6/6] extract embeddings:  42%|████▏     | 80/189 [00:04<00:05, 21.40it/s][6/6] extract embeddings:  44%|████▍     | 83/189 [00:04<00:05, 21.10it/s][6/6] extract embeddings:  46%|████▌     | 86/189 [00:04<00:04, 21.29it/s][6/6] extract embeddings:  47%|████▋     | 89/189 [00:05<00:04, 23.25it/s][6/6] extract embeddings:  49%|████▊     | 92/189 [00:05<00:04, 21.85it/s][6/6] extract embeddings:  50%|█████     | 95/189 [00:05<00:04, 21.53it/s][6/6] extract embeddings:  52%|█████▏    | 98/189 [00:05<00:04, 21.50it/s][6/6] extract embeddings:  53%|█████▎    | 101/189 [00:05<00:03, 22.05it/s][6/6] extract embeddings:  55%|█████▌    | 104/189 [00:05<00:03, 21.48it/s][6/6] extract embeddings:  57%|█████▋    | 107/189 [00:05<00:03, 21.26it/s][6/6] extract embeddings:  58%|█████▊    | 110/189 [00:06<00:03, 22.01it/s][6/6] extract embeddings:  60%|█████▉    | 113/189 [00:06<00:03, 21.84it/s][6/6] extract embeddings:  61%|██████▏   | 116/189 [00:06<00:03, 21.41it/s][6/6] extract embeddings:  63%|██████▎   | 119/189 [00:06<00:03, 20.88it/s][6/6] extract embeddings:  65%|██████▍   | 122/189 [00:06<00:03, 21.04it/s][6/6] extract embeddings:  66%|██████▌   | 125/189 [00:06<00:02, 21.60it/s][6/6] extract embeddings:  68%|██████▊   | 128/189 [00:06<00:02, 20.63it/s][6/6] extract embeddings:  69%|██████▉   | 131/189 [00:07<00:02, 21.23it/s][6/6] extract embeddings:  71%|███████   | 134/189 [00:07<00:02, 21.54it/s][6/6] extract embeddings:  73%|███████▎  | 138/189 [00:07<00:02, 24.14it/s][6/6] extract embeddings:  75%|███████▌  | 142/189 [00:07<00:01, 26.34it/s][6/6] extract embeddings:  77%|███████▋  | 146/189 [00:07<00:01, 27.58it/s][6/6] extract embeddings:  79%|███████▉  | 149/189 [00:07<00:01, 25.92it/s][6/6] extract embeddings:  80%|████████  | 152/189 [00:07<00:01, 24.09it/s][6/6] extract embeddings:  82%|████████▏ | 155/189 [00:07<00:01, 23.06it/s][6/6] extract embeddings:  84%|████████▎ | 158/189 [00:08<00:01, 22.21it/s][6/6] extract embeddings:  85%|████████▌ | 161/189 [00:08<00:01, 22.11it/s][6/6] extract embeddings:  87%|████████▋ | 164/189 [00:08<00:01, 21.74it/s][6/6] extract embeddings:  89%|████████▉ | 168/189 [00:08<00:00, 23.16it/s][6/6] extract embeddings:  90%|█████████ | 171/189 [00:08<00:00, 22.67it/s][6/6] extract embeddings:  92%|█████████▏| 174/189 [00:08<00:00, 22.12it/s][6/6] extract embeddings:  94%|█████████▎| 177/189 [00:08<00:00, 20.66it/s][6/6] extract embeddings:  95%|█████████▌| 180/189 [00:09<00:00, 21.29it/s][6/6] extract embeddings:  97%|█████████▋| 183/189 [00:09<00:00, 21.15it/s][6/6] extract embeddings:  98%|█████████▊| 186/189 [00:09<00:00, 21.24it/s][6/6] extract embeddings: 100%|██████████| 189/189 [00:09<00:00, 22.46it/s][6/6] extract embeddings: 100%|██████████| 189/189 [00:09<00:00, 19.76it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.24it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.50it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.12it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.34it/s]
[NeMo I 2025-04-17 01:26:07 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:26:08 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              44.996885   444.120  ...   17.310060  3.897609
    Harker-ES                       37.063904  2178.782  ...   61.170013  2.807533
    Harker-MN                       47.502635   366.767  ...   27.043936  7.373601
    Longfellow-Block-1              31.008036   492.417  ...    9.218995  1.872193
    TOTAL                           38.318831  3482.086  ...  114.743004  3.295238
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:26:08 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0715 | MISS: 0.2787 | CER: 0.0330 | DER: 0.3832 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.55, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.55, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.84s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:26:20 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:26:20 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:26:20 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:26:20 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:26:20 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:26:21 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:26:21 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:26:21 features:305] PADDING: 16
[NeMo I 2025-04-17 01:26:21 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:26:21 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:26:21 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:26:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:26:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:26:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:26:21 collections:880] Dataset successfully loaded with 2180 items and total duration provided from manifest is  1.21 hours.
[NeMo I 2025-04-17 01:26:21 collections:886] # 2180 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/35 [00:02<01:12,  2.15s/it][1/6] extract embeddings:  11%|█▏        | 4/35 [00:02<00:13,  2.27it/s][1/6] extract embeddings:  17%|█▋        | 6/35 [00:02<00:08,  3.59it/s][1/6] extract embeddings:  23%|██▎       | 8/35 [00:02<00:05,  5.03it/s][1/6] extract embeddings:  29%|██▊       | 10/35 [00:02<00:03,  6.46it/s][1/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02,  7.83it/s][1/6] extract embeddings:  40%|████      | 14/35 [00:02<00:02,  9.17it/s][1/6] extract embeddings:  46%|████▌     | 16/35 [00:03<00:01, 10.12it/s][1/6] extract embeddings:  51%|█████▏    | 18/35 [00:03<00:01, 10.89it/s][1/6] extract embeddings:  57%|█████▋    | 20/35 [00:03<00:01, 11.76it/s][1/6] extract embeddings:  63%|██████▎   | 22/35 [00:03<00:01, 12.26it/s][1/6] extract embeddings:  69%|██████▊   | 24/35 [00:03<00:00, 12.91it/s][1/6] extract embeddings:  74%|███████▍  | 26/35 [00:03<00:00, 12.97it/s][1/6] extract embeddings:  80%|████████  | 28/35 [00:04<00:00, 13.17it/s][1/6] extract embeddings:  86%|████████▌ | 30/35 [00:04<00:00, 13.24it/s][1/6] extract embeddings:  91%|█████████▏| 32/35 [00:04<00:00, 13.18it/s][1/6] extract embeddings:  97%|█████████▋| 34/35 [00:04<00:00, 13.42it/s][1/6] extract embeddings: 100%|██████████| 35/35 [00:04<00:00,  7.73it/s]
[NeMo I 2025-04-17 01:26:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:26:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:26:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:26:26 collections:880] Dataset successfully loaded with 2491 items and total duration provided from manifest is  1.26 hours.
[NeMo I 2025-04-17 01:26:26 collections:886] # 2491 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:54,  1.44s/it][2/6] extract embeddings:   8%|▊         | 3/39 [00:01<00:14,  2.42it/s][2/6] extract embeddings:  13%|█▎        | 5/39 [00:01<00:07,  4.36it/s][2/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:05,  6.25it/s][2/6] extract embeddings:  23%|██▎       | 9/39 [00:01<00:03,  7.94it/s][2/6] extract embeddings:  28%|██▊       | 11/39 [00:02<00:02,  9.41it/s][2/6] extract embeddings:  33%|███▎      | 13/39 [00:02<00:02, 10.58it/s][2/6] extract embeddings:  38%|███▊      | 15/39 [00:02<00:02, 11.51it/s][2/6] extract embeddings:  44%|████▎     | 17/39 [00:02<00:01, 12.28it/s][2/6] extract embeddings:  49%|████▊     | 19/39 [00:02<00:01, 12.53it/s][2/6] extract embeddings:  54%|█████▍    | 21/39 [00:02<00:01, 13.00it/s][2/6] extract embeddings:  59%|█████▉    | 23/39 [00:02<00:01, 13.49it/s][2/6] extract embeddings:  64%|██████▍   | 25/39 [00:03<00:01, 13.30it/s][2/6] extract embeddings:  69%|██████▉   | 27/39 [00:03<00:00, 13.76it/s][2/6] extract embeddings:  74%|███████▍  | 29/39 [00:03<00:00, 13.68it/s][2/6] extract embeddings:  79%|███████▉  | 31/39 [00:03<00:00, 13.85it/s][2/6] extract embeddings:  85%|████████▍ | 33/39 [00:03<00:00, 13.42it/s][2/6] extract embeddings:  90%|████████▉ | 35/39 [00:03<00:00, 13.56it/s][2/6] extract embeddings:  95%|█████████▍| 37/39 [00:03<00:00, 14.12it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:04<00:00, 13.81it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:04<00:00,  9.47it/s]
[NeMo I 2025-04-17 01:26:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:26:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:26:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:26:31 collections:880] Dataset successfully loaded with 2997 items and total duration provided from manifest is  1.32 hours.
[NeMo I 2025-04-17 01:26:31 collections:886] # 2997 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:56,  1.23s/it][3/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:11,  3.64it/s][3/6] extract embeddings:  13%|█▎        | 6/47 [00:01<00:07,  5.65it/s][3/6] extract embeddings:  17%|█▋        | 8/47 [00:01<00:05,  7.52it/s][3/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:04,  9.08it/s][3/6] extract embeddings:  26%|██▌       | 12/47 [00:01<00:03, 10.69it/s][3/6] extract embeddings:  30%|██▉       | 14/47 [00:02<00:02, 11.82it/s][3/6] extract embeddings:  34%|███▍      | 16/47 [00:02<00:02, 12.43it/s][3/6] extract embeddings:  38%|███▊      | 18/47 [00:02<00:02, 12.83it/s][3/6] extract embeddings:  43%|████▎     | 20/47 [00:02<00:01, 13.69it/s][3/6] extract embeddings:  47%|████▋     | 22/47 [00:02<00:01, 13.53it/s][3/6] extract embeddings:  51%|█████     | 24/47 [00:02<00:01, 14.40it/s][3/6] extract embeddings:  55%|█████▌    | 26/47 [00:02<00:01, 14.69it/s][3/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:01, 14.96it/s][3/6] extract embeddings:  64%|██████▍   | 30/47 [00:03<00:01, 14.88it/s][3/6] extract embeddings:  68%|██████▊   | 32/47 [00:03<00:00, 15.30it/s][3/6] extract embeddings:  72%|███████▏  | 34/47 [00:03<00:00, 15.33it/s][3/6] extract embeddings:  77%|███████▋  | 36/47 [00:03<00:00, 15.42it/s][3/6] extract embeddings:  81%|████████  | 38/47 [00:03<00:00, 15.20it/s][3/6] extract embeddings:  85%|████████▌ | 40/47 [00:03<00:00, 15.01it/s][3/6] extract embeddings:  89%|████████▉ | 42/47 [00:03<00:00, 15.17it/s][3/6] extract embeddings:  94%|█████████▎| 44/47 [00:03<00:00, 14.95it/s][3/6] extract embeddings:  98%|█████████▊| 46/47 [00:04<00:00, 14.67it/s][3/6] extract embeddings: 100%|██████████| 47/47 [00:04<00:00, 11.12it/s]
[NeMo I 2025-04-17 01:26:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:26:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:26:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:26:35 collections:880] Dataset successfully loaded with 3902 items and total duration provided from manifest is  1.39 hours.
[NeMo I 2025-04-17 01:26:35 collections:886] # 3902 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/61 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/61 [00:01<01:11,  1.19s/it][4/6] extract embeddings:   7%|▋         | 4/61 [00:01<00:14,  3.88it/s][4/6] extract embeddings:  10%|▉         | 6/61 [00:01<00:09,  5.97it/s][4/6] extract embeddings:  15%|█▍        | 9/61 [00:01<00:05,  9.17it/s][4/6] extract embeddings:  18%|█▊        | 11/61 [00:01<00:04, 10.35it/s][4/6] extract embeddings:  21%|██▏       | 13/61 [00:01<00:04, 11.61it/s][4/6] extract embeddings:  25%|██▍       | 15/61 [00:01<00:03, 13.15it/s][4/6] extract embeddings:  28%|██▊       | 17/61 [00:02<00:03, 13.83it/s][4/6] extract embeddings:  31%|███       | 19/61 [00:02<00:02, 14.06it/s][4/6] extract embeddings:  36%|███▌      | 22/61 [00:02<00:02, 16.43it/s][4/6] extract embeddings:  41%|████      | 25/61 [00:02<00:02, 17.71it/s][4/6] extract embeddings:  46%|████▌     | 28/61 [00:02<00:01, 19.31it/s][4/6] extract embeddings:  51%|█████     | 31/61 [00:02<00:01, 20.57it/s][4/6] extract embeddings:  56%|█████▌    | 34/61 [00:02<00:01, 21.11it/s][4/6] extract embeddings:  61%|██████    | 37/61 [00:02<00:01, 21.15it/s][4/6] extract embeddings:  66%|██████▌   | 40/61 [00:03<00:00, 21.66it/s][4/6] extract embeddings:  70%|███████   | 43/61 [00:03<00:00, 21.41it/s][4/6] extract embeddings:  75%|███████▌  | 46/61 [00:03<00:00, 21.64it/s][4/6] extract embeddings:  80%|████████  | 49/61 [00:03<00:00, 21.10it/s][4/6] extract embeddings:  85%|████████▌ | 52/61 [00:03<00:00, 21.66it/s][4/6] extract embeddings:  90%|█████████ | 55/61 [00:03<00:00, 21.95it/s][4/6] extract embeddings:  95%|█████████▌| 58/61 [00:03<00:00, 21.63it/s][4/6] extract embeddings: 100%|██████████| 61/61 [00:04<00:00, 21.20it/s][4/6] extract embeddings: 100%|██████████| 61/61 [00:04<00:00, 14.72it/s]
[NeMo I 2025-04-17 01:26:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:26:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:26:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:26:39 collections:880] Dataset successfully loaded with 5809 items and total duration provided from manifest is  1.48 hours.
[NeMo I 2025-04-17 01:26:39 collections:886] # 5809 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/91 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/91 [00:01<01:47,  1.19s/it][5/6] extract embeddings:   4%|▍         | 4/91 [00:01<00:21,  3.96it/s][5/6] extract embeddings:   8%|▊         | 7/91 [00:01<00:11,  7.32it/s][5/6] extract embeddings:  11%|█         | 10/91 [00:01<00:07, 10.82it/s][5/6] extract embeddings:  14%|█▍        | 13/91 [00:01<00:05, 14.01it/s][5/6] extract embeddings:  18%|█▊        | 16/91 [00:01<00:04, 17.09it/s][5/6] extract embeddings:  21%|██        | 19/91 [00:01<00:03, 19.29it/s][5/6] extract embeddings:  24%|██▍       | 22/91 [00:01<00:03, 20.59it/s][5/6] extract embeddings:  27%|██▋       | 25/91 [00:02<00:02, 22.49it/s][5/6] extract embeddings:  31%|███       | 28/91 [00:02<00:02, 23.54it/s][5/6] extract embeddings:  34%|███▍      | 31/91 [00:02<00:02, 24.36it/s][5/6] extract embeddings:  37%|███▋      | 34/91 [00:02<00:02, 24.73it/s][5/6] extract embeddings:  41%|████      | 37/91 [00:02<00:02, 24.62it/s][5/6] extract embeddings:  44%|████▍     | 40/91 [00:02<00:02, 24.73it/s][5/6] extract embeddings:  47%|████▋     | 43/91 [00:02<00:01, 25.01it/s][5/6] extract embeddings:  51%|█████     | 46/91 [00:02<00:01, 26.03it/s][5/6] extract embeddings:  54%|█████▍    | 49/91 [00:02<00:01, 26.72it/s][5/6] extract embeddings:  57%|█████▋    | 52/91 [00:03<00:01, 25.18it/s][5/6] extract embeddings:  60%|██████    | 55/91 [00:03<00:01, 26.30it/s][5/6] extract embeddings:  64%|██████▎   | 58/91 [00:03<00:01, 25.64it/s][5/6] extract embeddings:  67%|██████▋   | 61/91 [00:03<00:01, 26.67it/s][5/6] extract embeddings:  70%|███████   | 64/91 [00:03<00:01, 26.23it/s][5/6] extract embeddings:  74%|███████▎  | 67/91 [00:03<00:00, 26.43it/s][5/6] extract embeddings:  77%|███████▋  | 70/91 [00:03<00:00, 25.58it/s][5/6] extract embeddings:  80%|████████  | 73/91 [00:03<00:00, 25.41it/s][5/6] extract embeddings:  84%|████████▎ | 76/91 [00:04<00:00, 25.71it/s][5/6] extract embeddings:  87%|████████▋ | 79/91 [00:04<00:00, 26.09it/s][5/6] extract embeddings:  90%|█████████ | 82/91 [00:04<00:00, 25.66it/s][5/6] extract embeddings:  93%|█████████▎| 85/91 [00:04<00:00, 26.78it/s][5/6] extract embeddings:  97%|█████████▋| 88/91 [00:04<00:00, 26.47it/s][5/6] extract embeddings: 100%|██████████| 91/91 [00:04<00:00, 26.97it/s][5/6] extract embeddings: 100%|██████████| 91/91 [00:04<00:00, 19.68it/s]
[NeMo I 2025-04-17 01:26:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:26:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:26:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:26:44 collections:880] Dataset successfully loaded with 11809 items and total duration provided from manifest is  1.58 hours.
[NeMo I 2025-04-17 01:26:44 collections:886] # 11809 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/185 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/185 [00:01<03:30,  1.14s/it][6/6] extract embeddings:   3%|▎         | 5/185 [00:01<00:35,  5.10it/s][6/6] extract embeddings:   5%|▍         | 9/185 [00:01<00:18,  9.51it/s][6/6] extract embeddings:   7%|▋         | 13/185 [00:01<00:12, 13.61it/s][6/6] extract embeddings:   9%|▉         | 17/185 [00:01<00:09, 17.44it/s][6/6] extract embeddings:  11%|█▏        | 21/185 [00:01<00:07, 21.35it/s][6/6] extract embeddings:  14%|█▎        | 25/185 [00:01<00:06, 24.89it/s][6/6] extract embeddings:  16%|█▌        | 29/185 [00:02<00:06, 25.98it/s][6/6] extract embeddings:  18%|█▊        | 33/185 [00:02<00:05, 27.93it/s][6/6] extract embeddings:  20%|██        | 37/185 [00:02<00:05, 29.40it/s][6/6] extract embeddings:  22%|██▏       | 41/185 [00:02<00:04, 30.38it/s][6/6] extract embeddings:  24%|██▍       | 45/185 [00:02<00:04, 29.88it/s][6/6] extract embeddings:  26%|██▋       | 49/185 [00:02<00:04, 31.36it/s][6/6] extract embeddings:  29%|██▊       | 53/185 [00:02<00:04, 32.06it/s][6/6] extract embeddings:  31%|███       | 57/185 [00:02<00:03, 32.74it/s][6/6] extract embeddings:  33%|███▎      | 61/185 [00:02<00:03, 32.45it/s][6/6] extract embeddings:  35%|███▌      | 65/185 [00:03<00:03, 32.11it/s][6/6] extract embeddings:  37%|███▋      | 69/185 [00:03<00:03, 33.27it/s][6/6] extract embeddings:  39%|███▉      | 73/185 [00:03<00:03, 33.63it/s][6/6] extract embeddings:  42%|████▏     | 77/185 [00:03<00:03, 33.88it/s][6/6] extract embeddings:  44%|████▍     | 81/185 [00:03<00:03, 34.06it/s][6/6] extract embeddings:  46%|████▌     | 85/185 [00:03<00:02, 33.75it/s][6/6] extract embeddings:  48%|████▊     | 89/185 [00:03<00:02, 33.84it/s][6/6] extract embeddings:  50%|█████     | 93/185 [00:03<00:02, 34.25it/s][6/6] extract embeddings:  52%|█████▏    | 97/185 [00:04<00:02, 34.15it/s][6/6] extract embeddings:  55%|█████▍    | 101/185 [00:04<00:02, 33.20it/s][6/6] extract embeddings:  57%|█████▋    | 105/185 [00:04<00:02, 33.75it/s][6/6] extract embeddings:  59%|█████▉    | 109/185 [00:04<00:02, 33.19it/s][6/6] extract embeddings:  61%|██████    | 113/185 [00:04<00:02, 32.84it/s][6/6] extract embeddings:  63%|██████▎   | 117/185 [00:04<00:02, 33.29it/s][6/6] extract embeddings:  65%|██████▌   | 121/185 [00:04<00:01, 33.11it/s][6/6] extract embeddings:  68%|██████▊   | 125/185 [00:04<00:01, 33.52it/s][6/6] extract embeddings:  70%|██████▉   | 129/185 [00:04<00:01, 34.18it/s][6/6] extract embeddings:  72%|███████▏  | 133/185 [00:05<00:01, 33.27it/s][6/6] extract embeddings:  74%|███████▍  | 137/185 [00:05<00:01, 32.74it/s][6/6] extract embeddings:  76%|███████▌  | 141/185 [00:05<00:01, 33.81it/s][6/6] extract embeddings:  78%|███████▊  | 145/185 [00:05<00:01, 33.05it/s][6/6] extract embeddings:  81%|████████  | 149/185 [00:05<00:01, 33.57it/s][6/6] extract embeddings:  83%|████████▎ | 153/185 [00:05<00:00, 33.63it/s][6/6] extract embeddings:  85%|████████▍ | 157/185 [00:05<00:00, 32.94it/s][6/6] extract embeddings:  87%|████████▋ | 161/185 [00:05<00:00, 32.72it/s][6/6] extract embeddings:  89%|████████▉ | 165/185 [00:06<00:00, 32.58it/s][6/6] extract embeddings:  91%|█████████▏| 169/185 [00:06<00:00, 33.13it/s][6/6] extract embeddings:  94%|█████████▎| 173/185 [00:06<00:00, 32.60it/s][6/6] extract embeddings:  96%|█████████▌| 177/185 [00:06<00:00, 31.34it/s][6/6] extract embeddings:  98%|█████████▊| 181/185 [00:06<00:00, 32.21it/s][6/6] extract embeddings: 100%|██████████| 185/185 [00:06<00:00, 33.30it/s][6/6] extract embeddings: 100%|██████████| 185/185 [00:06<00:00, 27.47it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.25it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.56it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.19it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.83it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.41it/s]
[NeMo I 2025-04-17 01:26:53 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:26:54 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              45.900919   444.120  ...   15.885034  3.576744
    Harker-ES                       37.481681  2178.782  ...   48.912800  2.244961
    Harker-MN                       48.782196   366.767  ...   27.966973  7.625270
    Longfellow-Block-1              32.027502   492.417  ...    8.341987  1.694090
    TOTAL                           38.974487  3482.086  ...  101.106795  2.903627
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:26:54 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0699 | MISS: 0.2908 | CER: 0.0290 | DER: 0.3897 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.86s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:27:07 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:27:07 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:27:07 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:27:07 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:27:07 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:27:07 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:27:07 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:27:07 features:305] PADDING: 16
[NeMo I 2025-04-17 01:27:08 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:27:08 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:27:08 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:27:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:27:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:27:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:27:08 collections:880] Dataset successfully loaded with 2166 items and total duration provided from manifest is  1.17 hours.
[NeMo I 2025-04-17 01:27:08 collections:886] # 2166 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:02<01:06,  2.01s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.44it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.93it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.63it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.48it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  9.20it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.72it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 12.52it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 13.91it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:00, 14.55it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 15.47it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 16.59it/s][1/6] extract embeddings:  76%|███████▋  | 26/34 [00:03<00:00, 16.73it/s][1/6] extract embeddings:  82%|████████▏ | 28/34 [00:03<00:00, 16.60it/s][1/6] extract embeddings:  88%|████████▊ | 30/34 [00:03<00:00, 17.07it/s][1/6] extract embeddings:  94%|█████████▍| 32/34 [00:03<00:00, 17.47it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:03<00:00,  8.91it/s]
[NeMo I 2025-04-17 01:27:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:27:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:27:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:27:12 collections:880] Dataset successfully loaded with 2475 items and total duration provided from manifest is  1.22 hours.
[NeMo I 2025-04-17 01:27:12 collections:886] # 2475 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:54,  1.42s/it][2/6] extract embeddings:  10%|█         | 4/39 [00:01<00:10,  3.22it/s][2/6] extract embeddings:  15%|█▌        | 6/39 [00:01<00:06,  4.99it/s][2/6] extract embeddings:  21%|██        | 8/39 [00:01<00:04,  6.94it/s][2/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:03,  8.86it/s][2/6] extract embeddings:  31%|███       | 12/39 [00:02<00:02, 10.74it/s][2/6] extract embeddings:  36%|███▌      | 14/39 [00:02<00:02, 12.41it/s][2/6] extract embeddings:  41%|████      | 16/39 [00:02<00:01, 14.08it/s][2/6] extract embeddings:  46%|████▌     | 18/39 [00:02<00:01, 15.24it/s][2/6] extract embeddings:  54%|█████▍    | 21/39 [00:02<00:01, 16.92it/s][2/6] extract embeddings:  59%|█████▉    | 23/39 [00:02<00:00, 17.04it/s][2/6] extract embeddings:  64%|██████▍   | 25/39 [00:02<00:00, 17.53it/s][2/6] extract embeddings:  72%|███████▏  | 28/39 [00:02<00:00, 18.26it/s][2/6] extract embeddings:  77%|███████▋  | 30/39 [00:02<00:00, 18.06it/s][2/6] extract embeddings:  82%|████████▏ | 32/39 [00:03<00:00, 17.81it/s][2/6] extract embeddings:  87%|████████▋ | 34/39 [00:03<00:00, 18.29it/s][2/6] extract embeddings:  92%|█████████▏| 36/39 [00:03<00:00, 17.90it/s][2/6] extract embeddings:  97%|█████████▋| 38/39 [00:03<00:00, 17.83it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:03<00:00, 11.19it/s]
[NeMo I 2025-04-17 01:27:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:27:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:27:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:27:16 collections:880] Dataset successfully loaded with 2959 items and total duration provided from manifest is  1.28 hours.
[NeMo I 2025-04-17 01:27:16 collections:886] # 2959 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:53,  1.15s/it][3/6] extract embeddings:   6%|▋         | 3/47 [00:01<00:14,  2.97it/s][3/6] extract embeddings:  11%|█         | 5/47 [00:01<00:08,  5.21it/s][3/6] extract embeddings:  17%|█▋        | 8/47 [00:01<00:04,  8.62it/s][3/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:03, 10.49it/s][3/6] extract embeddings:  28%|██▊       | 13/47 [00:01<00:02, 13.43it/s][3/6] extract embeddings:  34%|███▍      | 16/47 [00:01<00:02, 15.27it/s][3/6] extract embeddings:  40%|████      | 19/47 [00:02<00:01, 17.08it/s][3/6] extract embeddings:  47%|████▋     | 22/47 [00:02<00:01, 17.63it/s][3/6] extract embeddings:  53%|█████▎    | 25/47 [00:02<00:01, 18.44it/s][3/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:01, 18.59it/s][3/6] extract embeddings:  64%|██████▍   | 30/47 [00:02<00:00, 18.73it/s][3/6] extract embeddings:  68%|██████▊   | 32/47 [00:02<00:00, 18.95it/s][3/6] extract embeddings:  74%|███████▍  | 35/47 [00:02<00:00, 19.03it/s][3/6] extract embeddings:  81%|████████  | 38/47 [00:03<00:00, 19.43it/s][3/6] extract embeddings:  85%|████████▌ | 40/47 [00:03<00:00, 19.28it/s][3/6] extract embeddings:  89%|████████▉ | 42/47 [00:03<00:00, 19.32it/s][3/6] extract embeddings:  94%|█████████▎| 44/47 [00:03<00:00, 19.17it/s][3/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 21.27it/s][3/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 13.53it/s]
[NeMo I 2025-04-17 01:27:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:27:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:27:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:27:19 collections:880] Dataset successfully loaded with 3836 items and total duration provided from manifest is  1.36 hours.
[NeMo I 2025-04-17 01:27:19 collections:886] # 3836 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/60 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/60 [00:01<01:20,  1.37s/it][4/6] extract embeddings:   7%|▋         | 4/60 [00:01<00:16,  3.41it/s][4/6] extract embeddings:  12%|█▏        | 7/60 [00:01<00:08,  6.28it/s][4/6] extract embeddings:  17%|█▋        | 10/60 [00:01<00:05,  9.10it/s][4/6] extract embeddings:  22%|██▏       | 13/60 [00:01<00:04, 11.73it/s][4/6] extract embeddings:  27%|██▋       | 16/60 [00:02<00:03, 13.94it/s][4/6] extract embeddings:  32%|███▏      | 19/60 [00:02<00:02, 16.11it/s][4/6] extract embeddings:  37%|███▋      | 22/60 [00:02<00:02, 17.58it/s][4/6] extract embeddings:  42%|████▏     | 25/60 [00:02<00:01, 19.27it/s][4/6] extract embeddings:  47%|████▋     | 28/60 [00:02<00:01, 20.06it/s][4/6] extract embeddings:  52%|█████▏    | 31/60 [00:02<00:01, 20.46it/s][4/6] extract embeddings:  57%|█████▋    | 34/60 [00:02<00:01, 21.41it/s][4/6] extract embeddings:  62%|██████▏   | 37/60 [00:02<00:01, 21.51it/s][4/6] extract embeddings:  67%|██████▋   | 40/60 [00:03<00:00, 22.42it/s][4/6] extract embeddings:  72%|███████▏  | 43/60 [00:03<00:00, 22.21it/s][4/6] extract embeddings:  77%|███████▋  | 46/60 [00:03<00:00, 22.37it/s][4/6] extract embeddings:  82%|████████▏ | 49/60 [00:03<00:00, 22.61it/s][4/6] extract embeddings:  87%|████████▋ | 52/60 [00:03<00:00, 22.50it/s][4/6] extract embeddings:  92%|█████████▏| 55/60 [00:03<00:00, 22.94it/s][4/6] extract embeddings:  97%|█████████▋| 58/60 [00:03<00:00, 22.86it/s][4/6] extract embeddings: 100%|██████████| 60/60 [00:03<00:00, 15.03it/s]
[NeMo I 2025-04-17 01:27:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:27:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:27:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:27:23 collections:880] Dataset successfully loaded with 5705 items and total duration provided from manifest is  1.44 hours.
[NeMo I 2025-04-17 01:27:23 collections:886] # 5705 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/90 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/90 [00:01<01:59,  1.34s/it][5/6] extract embeddings:   4%|▍         | 4/90 [00:01<00:24,  3.56it/s][5/6] extract embeddings:   8%|▊         | 7/90 [00:01<00:12,  6.70it/s][5/6] extract embeddings:  11%|█         | 10/90 [00:01<00:08,  9.95it/s][5/6] extract embeddings:  14%|█▍        | 13/90 [00:01<00:05, 13.06it/s][5/6] extract embeddings:  18%|█▊        | 16/90 [00:01<00:04, 15.67it/s][5/6] extract embeddings:  21%|██        | 19/90 [00:01<00:03, 18.47it/s][5/6] extract embeddings:  24%|██▍       | 22/90 [00:02<00:03, 20.54it/s][5/6] extract embeddings:  28%|██▊       | 25/90 [00:02<00:02, 22.30it/s][5/6] extract embeddings:  31%|███       | 28/90 [00:02<00:02, 23.67it/s][5/6] extract embeddings:  34%|███▍      | 31/90 [00:02<00:02, 24.35it/s][5/6] extract embeddings:  38%|███▊      | 34/90 [00:02<00:02, 24.58it/s][5/6] extract embeddings:  41%|████      | 37/90 [00:02<00:02, 25.50it/s][5/6] extract embeddings:  44%|████▍     | 40/90 [00:02<00:01, 25.29it/s][5/6] extract embeddings:  48%|████▊     | 43/90 [00:02<00:01, 24.96it/s][5/6] extract embeddings:  51%|█████     | 46/90 [00:03<00:01, 25.32it/s][5/6] extract embeddings:  54%|█████▍    | 49/90 [00:03<00:01, 26.01it/s][5/6] extract embeddings:  58%|█████▊    | 52/90 [00:03<00:01, 26.00it/s][5/6] extract embeddings:  61%|██████    | 55/90 [00:03<00:01, 25.61it/s][5/6] extract embeddings:  64%|██████▍   | 58/90 [00:03<00:01, 24.97it/s][5/6] extract embeddings:  68%|██████▊   | 61/90 [00:03<00:01, 25.77it/s][5/6] extract embeddings:  71%|███████   | 64/90 [00:03<00:01, 25.20it/s][5/6] extract embeddings:  74%|███████▍  | 67/90 [00:03<00:00, 25.48it/s][5/6] extract embeddings:  78%|███████▊  | 70/90 [00:03<00:00, 24.94it/s][5/6] extract embeddings:  81%|████████  | 73/90 [00:04<00:00, 25.09it/s][5/6] extract embeddings:  84%|████████▍ | 76/90 [00:04<00:00, 25.85it/s][5/6] extract embeddings:  88%|████████▊ | 79/90 [00:04<00:00, 25.85it/s][5/6] extract embeddings:  91%|█████████ | 82/90 [00:04<00:00, 26.52it/s][5/6] extract embeddings:  94%|█████████▍| 85/90 [00:04<00:00, 25.84it/s][5/6] extract embeddings:  98%|█████████▊| 88/90 [00:04<00:00, 26.06it/s][5/6] extract embeddings: 100%|██████████| 90/90 [00:04<00:00, 18.86it/s]
[NeMo I 2025-04-17 01:27:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:27:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:27:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:27:28 collections:880] Dataset successfully loaded with 11592 items and total duration provided from manifest is  1.55 hours.
[NeMo I 2025-04-17 01:27:28 collections:886] # 11592 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/182 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/182 [00:01<03:27,  1.15s/it][6/6] extract embeddings:   3%|▎         | 5/182 [00:01<00:34,  5.20it/s][6/6] extract embeddings:   5%|▍         | 9/182 [00:01<00:17,  9.73it/s][6/6] extract embeddings:   7%|▋         | 13/182 [00:01<00:11, 14.22it/s][6/6] extract embeddings:   9%|▉         | 17/182 [00:01<00:09, 17.75it/s][6/6] extract embeddings:  12%|█▏        | 21/182 [00:01<00:07, 21.63it/s][6/6] extract embeddings:  14%|█▎        | 25/182 [00:01<00:06, 23.94it/s][6/6] extract embeddings:  16%|█▌        | 29/182 [00:01<00:05, 26.19it/s][6/6] extract embeddings:  18%|█▊        | 33/182 [00:02<00:05, 28.43it/s][6/6] extract embeddings:  20%|██        | 37/182 [00:02<00:04, 30.32it/s][6/6] extract embeddings:  23%|██▎       | 41/182 [00:02<00:04, 29.49it/s][6/6] extract embeddings:  25%|██▍       | 45/182 [00:02<00:04, 30.36it/s][6/6] extract embeddings:  27%|██▋       | 49/182 [00:02<00:04, 29.78it/s][6/6] extract embeddings:  29%|██▉       | 53/182 [00:02<00:04, 30.08it/s][6/6] extract embeddings:  31%|███▏      | 57/182 [00:02<00:04, 31.21it/s][6/6] extract embeddings:  34%|███▎      | 61/182 [00:03<00:04, 30.12it/s][6/6] extract embeddings:  36%|███▌      | 65/182 [00:03<00:03, 31.59it/s][6/6] extract embeddings:  38%|███▊      | 69/182 [00:03<00:03, 31.70it/s][6/6] extract embeddings:  40%|████      | 73/182 [00:03<00:03, 31.95it/s][6/6] extract embeddings:  42%|████▏     | 77/182 [00:03<00:03, 31.51it/s][6/6] extract embeddings:  45%|████▍     | 81/182 [00:03<00:03, 32.39it/s][6/6] extract embeddings:  47%|████▋     | 85/182 [00:03<00:03, 32.14it/s][6/6] extract embeddings:  49%|████▉     | 89/182 [00:03<00:02, 32.79it/s][6/6] extract embeddings:  51%|█████     | 93/182 [00:03<00:02, 32.43it/s][6/6] extract embeddings:  53%|█████▎    | 97/182 [00:04<00:02, 32.89it/s][6/6] extract embeddings:  55%|█████▌    | 101/182 [00:04<00:02, 32.82it/s][6/6] extract embeddings:  58%|█████▊    | 105/182 [00:04<00:02, 32.65it/s][6/6] extract embeddings:  60%|█████▉    | 109/182 [00:04<00:02, 32.81it/s][6/6] extract embeddings:  62%|██████▏   | 113/182 [00:04<00:02, 33.27it/s][6/6] extract embeddings:  64%|██████▍   | 117/182 [00:04<00:01, 33.64it/s][6/6] extract embeddings:  66%|██████▋   | 121/182 [00:04<00:01, 33.79it/s][6/6] extract embeddings:  69%|██████▊   | 125/182 [00:04<00:01, 34.00it/s][6/6] extract embeddings:  71%|███████   | 129/182 [00:05<00:01, 33.95it/s][6/6] extract embeddings:  73%|███████▎  | 133/182 [00:05<00:01, 33.52it/s][6/6] extract embeddings:  75%|███████▌  | 137/182 [00:05<00:01, 33.86it/s][6/6] extract embeddings:  77%|███████▋  | 141/182 [00:05<00:01, 34.02it/s][6/6] extract embeddings:  80%|███████▉  | 145/182 [00:05<00:01, 34.11it/s][6/6] extract embeddings:  82%|████████▏ | 149/182 [00:05<00:00, 34.45it/s][6/6] extract embeddings:  84%|████████▍ | 153/182 [00:05<00:00, 34.15it/s][6/6] extract embeddings:  86%|████████▋ | 157/182 [00:05<00:00, 33.57it/s][6/6] extract embeddings:  88%|████████▊ | 161/182 [00:06<00:00, 33.16it/s][6/6] extract embeddings:  91%|█████████ | 165/182 [00:06<00:00, 33.88it/s][6/6] extract embeddings:  93%|█████████▎| 169/182 [00:06<00:00, 33.28it/s][6/6] extract embeddings:  95%|█████████▌| 173/182 [00:06<00:00, 33.83it/s][6/6] extract embeddings:  97%|█████████▋| 177/182 [00:06<00:00, 33.05it/s][6/6] extract embeddings:  99%|█████████▉| 181/182 [00:06<00:00, 33.15it/s][6/6] extract embeddings: 100%|██████████| 182/182 [00:06<00:00, 27.34it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.21it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.60it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.25it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.46it/s]
[NeMo I 2025-04-17 01:27:37 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:27:38 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              46.445815   444.120  ...   16.355075  3.682580
    Harker-ES                       38.465146  2178.782  ...   51.092762  2.345015
    Harker-MN                       49.846380   366.767  ...   28.449983  7.756964
    Longfellow-Block-1              33.194988   492.417  ...    9.181010  1.864479
    TOTAL                           39.936540  3482.086  ...  105.078830  3.017698
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:27:38 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0683 | MISS: 0.3009 | CER: 0.0302 | DER: 0.3994 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.82s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:27:51 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:27:51 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:27:51 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:27:51 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:27:51 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:27:51 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:27:51 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:27:51 features:305] PADDING: 16
[NeMo I 2025-04-17 01:27:52 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:27:52 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:27:52 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:27:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:27:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:27:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:27:52 collections:880] Dataset successfully loaded with 2131 items and total duration provided from manifest is  1.13 hours.
[NeMo I 2025-04-17 01:27:52 collections:886] # 2131 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:01<01:05,  1.99s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.46it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.96it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.69it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.52it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  9.16it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.77it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 12.54it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 13.84it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:02<00:00, 14.62it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 15.60it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 16.52it/s][1/6] extract embeddings:  76%|███████▋  | 26/34 [00:03<00:00, 16.12it/s][1/6] extract embeddings:  82%|████████▏ | 28/34 [00:03<00:00, 16.14it/s][1/6] extract embeddings:  88%|████████▊ | 30/34 [00:03<00:00, 16.27it/s][1/6] extract embeddings:  94%|█████████▍| 32/34 [00:03<00:00, 16.89it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:03<00:00,  8.94it/s]
[NeMo I 2025-04-17 01:27:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:27:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:27:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:27:55 collections:880] Dataset successfully loaded with 2432 items and total duration provided from manifest is  1.18 hours.
[NeMo I 2025-04-17 01:27:55 collections:886] # 2432 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:52,  1.42s/it][2/6] extract embeddings:   8%|▊         | 3/38 [00:01<00:14,  2.44it/s][2/6] extract embeddings:  13%|█▎        | 5/38 [00:01<00:07,  4.35it/s][2/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  6.37it/s][2/6] extract embeddings:  24%|██▎       | 9/38 [00:01<00:03,  8.57it/s][2/6] extract embeddings:  29%|██▉       | 11/38 [00:01<00:02, 10.70it/s][2/6] extract embeddings:  34%|███▍      | 13/38 [00:02<00:02, 12.18it/s][2/6] extract embeddings:  39%|███▉      | 15/38 [00:02<00:01, 13.83it/s][2/6] extract embeddings:  45%|████▍     | 17/38 [00:02<00:01, 15.32it/s][2/6] extract embeddings:  53%|█████▎    | 20/38 [00:02<00:01, 16.66it/s][2/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 17.44it/s][2/6] extract embeddings:  63%|██████▎   | 24/38 [00:02<00:00, 17.51it/s][2/6] extract embeddings:  71%|███████   | 27/38 [00:02<00:00, 18.10it/s][2/6] extract embeddings:  76%|███████▋  | 29/38 [00:02<00:00, 18.41it/s][2/6] extract embeddings:  82%|████████▏ | 31/38 [00:03<00:00, 18.69it/s][2/6] extract embeddings:  87%|████████▋ | 33/38 [00:03<00:00, 18.27it/s][2/6] extract embeddings:  92%|█████████▏| 35/38 [00:03<00:00, 18.71it/s][2/6] extract embeddings:  97%|█████████▋| 37/38 [00:03<00:00, 18.28it/s][2/6] extract embeddings: 100%|██████████| 38/38 [00:03<00:00, 11.06it/s]
[NeMo I 2025-04-17 01:27:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:27:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:27:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:27:59 collections:880] Dataset successfully loaded with 2898 items and total duration provided from manifest is  1.24 hours.
[NeMo I 2025-04-17 01:27:59 collections:886] # 2898 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:53,  1.19s/it][3/6] extract embeddings:   9%|▊         | 4/46 [00:01<00:11,  3.77it/s][3/6] extract embeddings:  15%|█▌        | 7/46 [00:01<00:05,  6.65it/s][3/6] extract embeddings:  22%|██▏       | 10/46 [00:01<00:03,  9.47it/s][3/6] extract embeddings:  26%|██▌       | 12/46 [00:01<00:03, 11.17it/s][3/6] extract embeddings:  33%|███▎      | 15/46 [00:01<00:02, 13.15it/s][3/6] extract embeddings:  39%|███▉      | 18/46 [00:02<00:01, 15.04it/s][3/6] extract embeddings:  43%|████▎     | 20/46 [00:02<00:01, 16.02it/s][3/6] extract embeddings:  50%|█████     | 23/46 [00:02<00:01, 17.71it/s][3/6] extract embeddings:  57%|█████▋    | 26/46 [00:02<00:01, 18.38it/s][3/6] extract embeddings:  63%|██████▎   | 29/46 [00:02<00:00, 18.51it/s][3/6] extract embeddings:  70%|██████▉   | 32/46 [00:02<00:00, 19.17it/s][3/6] extract embeddings:  76%|███████▌  | 35/46 [00:02<00:00, 19.43it/s][3/6] extract embeddings:  83%|████████▎ | 38/46 [00:03<00:00, 19.77it/s][3/6] extract embeddings:  89%|████████▉ | 41/46 [00:03<00:00, 19.39it/s][3/6] extract embeddings:  93%|█████████▎| 43/46 [00:03<00:00, 19.32it/s][3/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 20.47it/s][3/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 13.29it/s]
[NeMo I 2025-04-17 01:28:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:28:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:28:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:28:03 collections:880] Dataset successfully loaded with 3754 items and total duration provided from manifest is  1.32 hours.
[NeMo I 2025-04-17 01:28:03 collections:886] # 3754 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/59 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/59 [00:01<01:08,  1.18s/it][4/6] extract embeddings:   7%|▋         | 4/59 [00:01<00:14,  3.86it/s][4/6] extract embeddings:  12%|█▏        | 7/59 [00:01<00:07,  7.03it/s][4/6] extract embeddings:  17%|█▋        | 10/59 [00:01<00:04, 10.09it/s][4/6] extract embeddings:  22%|██▏       | 13/59 [00:01<00:03, 12.67it/s][4/6] extract embeddings:  27%|██▋       | 16/59 [00:01<00:02, 14.94it/s][4/6] extract embeddings:  32%|███▏      | 19/59 [00:01<00:02, 17.11it/s][4/6] extract embeddings:  37%|███▋      | 22/59 [00:02<00:01, 18.58it/s][4/6] extract embeddings:  42%|████▏     | 25/59 [00:02<00:01, 19.47it/s][4/6] extract embeddings:  47%|████▋     | 28/59 [00:02<00:01, 19.79it/s][4/6] extract embeddings:  53%|█████▎    | 31/59 [00:02<00:01, 20.63it/s][4/6] extract embeddings:  58%|█████▊    | 34/59 [00:02<00:01, 20.30it/s][4/6] extract embeddings:  63%|██████▎   | 37/59 [00:02<00:01, 21.04it/s][4/6] extract embeddings:  68%|██████▊   | 40/59 [00:02<00:00, 21.47it/s][4/6] extract embeddings:  73%|███████▎  | 43/59 [00:03<00:00, 21.81it/s][4/6] extract embeddings:  78%|███████▊  | 46/59 [00:03<00:00, 22.24it/s][4/6] extract embeddings:  83%|████████▎ | 49/59 [00:03<00:00, 21.77it/s][4/6] extract embeddings:  88%|████████▊ | 52/59 [00:03<00:00, 21.91it/s][4/6] extract embeddings:  93%|█████████▎| 55/59 [00:03<00:00, 22.24it/s][4/6] extract embeddings:  98%|█████████▊| 58/59 [00:03<00:00, 21.77it/s][4/6] extract embeddings: 100%|██████████| 59/59 [00:03<00:00, 15.44it/s]
[NeMo I 2025-04-17 01:28:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:28:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:28:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:28:07 collections:880] Dataset successfully loaded with 5569 items and total duration provided from manifest is  1.40 hours.
[NeMo I 2025-04-17 01:28:07 collections:886] # 5569 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/88 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/88 [00:01<02:04,  1.43s/it][5/6] extract embeddings:   5%|▍         | 4/88 [00:01<00:25,  3.32it/s][5/6] extract embeddings:   8%|▊         | 7/88 [00:01<00:12,  6.32it/s][5/6] extract embeddings:  11%|█▏        | 10/88 [00:01<00:08,  9.33it/s][5/6] extract embeddings:  15%|█▍        | 13/88 [00:01<00:06, 12.33it/s][5/6] extract embeddings:  18%|█▊        | 16/88 [00:02<00:04, 14.82it/s][5/6] extract embeddings:  22%|██▏       | 19/88 [00:02<00:04, 17.18it/s][5/6] extract embeddings:  25%|██▌       | 22/88 [00:02<00:03, 19.42it/s][5/6] extract embeddings:  28%|██▊       | 25/88 [00:02<00:03, 20.92it/s][5/6] extract embeddings:  32%|███▏      | 28/88 [00:02<00:02, 22.47it/s][5/6] extract embeddings:  35%|███▌      | 31/88 [00:02<00:02, 23.48it/s][5/6] extract embeddings:  39%|███▊      | 34/88 [00:02<00:02, 25.00it/s][5/6] extract embeddings:  42%|████▏     | 37/88 [00:02<00:02, 24.75it/s][5/6] extract embeddings:  45%|████▌     | 40/88 [00:02<00:01, 24.63it/s][5/6] extract embeddings:  49%|████▉     | 43/88 [00:03<00:01, 25.44it/s][5/6] extract embeddings:  52%|█████▏    | 46/88 [00:03<00:01, 25.35it/s][5/6] extract embeddings:  56%|█████▌    | 49/88 [00:03<00:01, 26.30it/s][5/6] extract embeddings:  59%|█████▉    | 52/88 [00:03<00:01, 26.16it/s][5/6] extract embeddings:  62%|██████▎   | 55/88 [00:03<00:01, 25.76it/s][5/6] extract embeddings:  66%|██████▌   | 58/88 [00:03<00:01, 25.19it/s][5/6] extract embeddings:  69%|██████▉   | 61/88 [00:03<00:01, 24.97it/s][5/6] extract embeddings:  73%|███████▎  | 64/88 [00:03<00:00, 25.20it/s][5/6] extract embeddings:  76%|███████▌  | 67/88 [00:03<00:00, 25.95it/s][5/6] extract embeddings:  80%|███████▉  | 70/88 [00:04<00:00, 25.61it/s][5/6] extract embeddings:  83%|████████▎ | 73/88 [00:04<00:00, 25.73it/s][5/6] extract embeddings:  86%|████████▋ | 76/88 [00:04<00:00, 25.57it/s][5/6] extract embeddings:  90%|████████▉ | 79/88 [00:04<00:00, 24.76it/s][5/6] extract embeddings:  93%|█████████▎| 82/88 [00:04<00:00, 25.16it/s][5/6] extract embeddings:  97%|█████████▋| 85/88 [00:04<00:00, 25.63it/s][5/6] extract embeddings: 100%|██████████| 88/88 [00:04<00:00, 24.94it/s][5/6] extract embeddings: 100%|██████████| 88/88 [00:04<00:00, 18.14it/s]
[NeMo I 2025-04-17 01:28:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:28:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:28:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:28:12 collections:880] Dataset successfully loaded with 11321 items and total duration provided from manifest is  1.51 hours.
[NeMo I 2025-04-17 01:28:12 collections:886] # 11321 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/177 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/177 [00:01<03:27,  1.18s/it][6/6] extract embeddings:   3%|▎         | 5/177 [00:01<00:34,  5.01it/s][6/6] extract embeddings:   5%|▍         | 8/177 [00:01<00:20,  8.25it/s][6/6] extract embeddings:   7%|▋         | 12/177 [00:01<00:12, 12.73it/s][6/6] extract embeddings:   9%|▉         | 16/177 [00:01<00:09, 17.12it/s][6/6] extract embeddings:  11%|█▏        | 20/177 [00:01<00:07, 21.28it/s][6/6] extract embeddings:  14%|█▎        | 24/177 [00:01<00:06, 24.11it/s][6/6] extract embeddings:  16%|█▌        | 28/177 [00:02<00:05, 26.01it/s][6/6] extract embeddings:  18%|█▊        | 32/177 [00:02<00:05, 28.00it/s][6/6] extract embeddings:  20%|██        | 36/177 [00:02<00:04, 29.24it/s][6/6] extract embeddings:  23%|██▎       | 40/177 [00:02<00:04, 30.10it/s][6/6] extract embeddings:  25%|██▍       | 44/177 [00:02<00:04, 30.47it/s][6/6] extract embeddings:  27%|██▋       | 48/177 [00:02<00:04, 31.88it/s][6/6] extract embeddings:  29%|██▉       | 52/177 [00:02<00:03, 31.82it/s][6/6] extract embeddings:  32%|███▏      | 56/177 [00:02<00:03, 31.73it/s][6/6] extract embeddings:  34%|███▍      | 60/177 [00:02<00:03, 31.75it/s][6/6] extract embeddings:  36%|███▌      | 64/177 [00:03<00:03, 31.82it/s][6/6] extract embeddings:  38%|███▊      | 68/177 [00:03<00:03, 31.30it/s][6/6] extract embeddings:  41%|████      | 72/177 [00:03<00:03, 31.05it/s][6/6] extract embeddings:  43%|████▎     | 76/177 [00:03<00:03, 30.91it/s][6/6] extract embeddings:  45%|████▌     | 80/177 [00:03<00:03, 31.21it/s][6/6] extract embeddings:  47%|████▋     | 84/177 [00:03<00:02, 31.51it/s][6/6] extract embeddings:  50%|████▉     | 88/177 [00:03<00:02, 31.60it/s][6/6] extract embeddings:  52%|█████▏    | 92/177 [00:04<00:02, 31.77it/s][6/6] extract embeddings:  54%|█████▍    | 96/177 [00:04<00:02, 32.22it/s][6/6] extract embeddings:  56%|█████▋    | 100/177 [00:04<00:02, 32.72it/s][6/6] extract embeddings:  59%|█████▉    | 104/177 [00:04<00:02, 32.26it/s][6/6] extract embeddings:  61%|██████    | 108/177 [00:04<00:02, 32.39it/s][6/6] extract embeddings:  63%|██████▎   | 112/177 [00:04<00:02, 31.43it/s][6/6] extract embeddings:  66%|██████▌   | 116/177 [00:04<00:01, 31.93it/s][6/6] extract embeddings:  68%|██████▊   | 120/177 [00:04<00:01, 31.62it/s][6/6] extract embeddings:  70%|███████   | 124/177 [00:04<00:01, 32.81it/s][6/6] extract embeddings:  72%|███████▏  | 128/177 [00:05<00:01, 31.49it/s][6/6] extract embeddings:  75%|███████▍  | 132/177 [00:05<00:01, 32.78it/s][6/6] extract embeddings:  77%|███████▋  | 136/177 [00:05<00:01, 32.45it/s][6/6] extract embeddings:  79%|███████▉  | 140/177 [00:05<00:01, 32.02it/s][6/6] extract embeddings:  81%|████████▏ | 144/177 [00:05<00:01, 32.72it/s][6/6] extract embeddings:  84%|████████▎ | 148/177 [00:05<00:00, 33.23it/s][6/6] extract embeddings:  86%|████████▌ | 152/177 [00:05<00:00, 33.59it/s][6/6] extract embeddings:  88%|████████▊ | 156/177 [00:05<00:00, 32.99it/s][6/6] extract embeddings:  90%|█████████ | 160/177 [00:06<00:00, 32.76it/s][6/6] extract embeddings:  93%|█████████▎| 164/177 [00:06<00:00, 32.12it/s][6/6] extract embeddings:  95%|█████████▍| 168/177 [00:06<00:00, 32.15it/s][6/6] extract embeddings:  97%|█████████▋| 172/177 [00:06<00:00, 31.78it/s][6/6] extract embeddings:  99%|█████████▉| 176/177 [00:06<00:00, 31.22it/s][6/6] extract embeddings: 100%|██████████| 177/177 [00:06<00:00, 26.52it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.31it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.64it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.31it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.76it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.44it/s]
[NeMo I 2025-04-17 01:28:21 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:28:22 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              47.273268   444.120  ...   14.640075  3.296423
    Harker-ES                       39.604990  2178.782  ...   50.641435  2.324300
    Harker-MN                       51.693618   366.767  ...   32.910944  8.973257
    Longfellow-Block-1              33.968938   492.417  ...    8.242027  1.673790
    TOTAL                           41.059307  3482.086  ...  106.434481  3.056630
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:28:22 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0653 | MISS: 0.3147 | CER: 0.0306 | DER: 0.4106 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.84s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.96s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.26s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:28:34 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:28:34 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:28:34 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:28:34 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:28:34 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:28:34 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:28:34 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:28:34 features:305] PADDING: 16
[NeMo I 2025-04-17 01:28:35 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:28:35 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:28:35 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:28:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:28:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:28:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:28:35 collections:880] Dataset successfully loaded with 2113 items and total duration provided from manifest is  1.08 hours.
[NeMo I 2025-04-17 01:28:35 collections:886] # 2113 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:01<01:05,  1.98s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.48it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.97it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.66it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.49it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  8.96it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.53it/s][1/6] extract embeddings:  50%|█████     | 17/34 [00:02<00:01, 13.11it/s][1/6] extract embeddings:  56%|█████▌    | 19/34 [00:02<00:01, 14.12it/s][1/6] extract embeddings:  62%|██████▏   | 21/34 [00:03<00:00, 14.54it/s][1/6] extract embeddings:  68%|██████▊   | 23/34 [00:03<00:00, 15.32it/s][1/6] extract embeddings:  74%|███████▎  | 25/34 [00:03<00:00, 16.00it/s][1/6] extract embeddings:  79%|███████▉  | 27/34 [00:03<00:00, 16.14it/s][1/6] extract embeddings:  85%|████████▌ | 29/34 [00:03<00:00, 16.23it/s][1/6] extract embeddings:  91%|█████████ | 31/34 [00:03<00:00, 17.06it/s][1/6] extract embeddings:  97%|█████████▋| 33/34 [00:03<00:00, 17.72it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:03<00:00,  8.93it/s]
[NeMo I 2025-04-17 01:28:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:28:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:28:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:28:39 collections:880] Dataset successfully loaded with 2395 items and total duration provided from manifest is  1.13 hours.
[NeMo I 2025-04-17 01:28:39 collections:886] # 2395 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:51,  1.40s/it][2/6] extract embeddings:   8%|▊         | 3/38 [00:01<00:14,  2.48it/s][2/6] extract embeddings:  13%|█▎        | 5/38 [00:01<00:07,  4.40it/s][2/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  6.54it/s][2/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02,  9.47it/s][2/6] extract embeddings:  32%|███▏      | 12/38 [00:02<00:02, 11.22it/s][2/6] extract embeddings:  37%|███▋      | 14/38 [00:02<00:01, 12.82it/s][2/6] extract embeddings:  42%|████▏     | 16/38 [00:02<00:01, 14.25it/s][2/6] extract embeddings:  47%|████▋     | 18/38 [00:02<00:01, 15.26it/s][2/6] extract embeddings:  53%|█████▎    | 20/38 [00:02<00:01, 15.90it/s][2/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 16.19it/s][2/6] extract embeddings:  63%|██████▎   | 24/38 [00:02<00:00, 16.25it/s][2/6] extract embeddings:  71%|███████   | 27/38 [00:02<00:00, 17.47it/s][2/6] extract embeddings:  76%|███████▋  | 29/38 [00:02<00:00, 17.57it/s][2/6] extract embeddings:  82%|████████▏ | 31/38 [00:03<00:00, 17.08it/s][2/6] extract embeddings:  87%|████████▋ | 33/38 [00:03<00:00, 17.10it/s][2/6] extract embeddings:  92%|█████████▏| 35/38 [00:03<00:00, 17.41it/s][2/6] extract embeddings:  97%|█████████▋| 37/38 [00:03<00:00, 17.75it/s][2/6] extract embeddings: 100%|██████████| 38/38 [00:03<00:00, 11.00it/s]
[NeMo I 2025-04-17 01:28:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:28:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:28:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:28:42 collections:880] Dataset successfully loaded with 2838 items and total duration provided from manifest is  1.19 hours.
[NeMo I 2025-04-17 01:28:42 collections:886] # 2838 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/45 [00:01<00:50,  1.15s/it][3/6] extract embeddings:   9%|▉         | 4/45 [00:01<00:10,  3.84it/s][3/6] extract embeddings:  16%|█▌        | 7/45 [00:01<00:05,  6.76it/s][3/6] extract embeddings:  22%|██▏       | 10/45 [00:01<00:03,  9.59it/s][3/6] extract embeddings:  29%|██▉       | 13/45 [00:01<00:02, 11.97it/s][3/6] extract embeddings:  36%|███▌      | 16/45 [00:01<00:02, 13.91it/s][3/6] extract embeddings:  40%|████      | 18/45 [00:02<00:01, 15.04it/s][3/6] extract embeddings:  47%|████▋     | 21/45 [00:02<00:01, 16.55it/s][3/6] extract embeddings:  51%|█████     | 23/45 [00:02<00:01, 16.97it/s][3/6] extract embeddings:  56%|█████▌    | 25/45 [00:02<00:01, 17.56it/s][3/6] extract embeddings:  60%|██████    | 27/45 [00:02<00:00, 18.12it/s][3/6] extract embeddings:  67%|██████▋   | 30/45 [00:02<00:00, 19.10it/s][3/6] extract embeddings:  73%|███████▎  | 33/45 [00:02<00:00, 19.18it/s][3/6] extract embeddings:  78%|███████▊  | 35/45 [00:02<00:00, 18.87it/s][3/6] extract embeddings:  82%|████████▏ | 37/45 [00:02<00:00, 19.11it/s][3/6] extract embeddings:  89%|████████▉ | 40/45 [00:03<00:00, 19.46it/s][3/6] extract embeddings:  93%|█████████▎| 42/45 [00:03<00:00, 19.44it/s][3/6] extract embeddings: 100%|██████████| 45/45 [00:03<00:00, 21.09it/s][3/6] extract embeddings: 100%|██████████| 45/45 [00:03<00:00, 13.32it/s]
[NeMo I 2025-04-17 01:28:46 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:28:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:28:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:28:46 collections:880] Dataset successfully loaded with 3659 items and total duration provided from manifest is  1.26 hours.
[NeMo I 2025-04-17 01:28:46 collections:886] # 3659 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/58 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/58 [00:01<01:05,  1.14s/it][4/6] extract embeddings:   7%|▋         | 4/58 [00:01<00:13,  3.88it/s][4/6] extract embeddings:  12%|█▏        | 7/58 [00:01<00:07,  6.98it/s][4/6] extract embeddings:  16%|█▌        | 9/58 [00:01<00:05,  8.93it/s][4/6] extract embeddings:  21%|██        | 12/58 [00:01<00:03, 11.92it/s][4/6] extract embeddings:  26%|██▌       | 15/58 [00:01<00:02, 14.50it/s][4/6] extract embeddings:  31%|███       | 18/58 [00:01<00:02, 16.59it/s][4/6] extract embeddings:  36%|███▌      | 21/58 [00:02<00:02, 17.97it/s][4/6] extract embeddings:  41%|████▏     | 24/58 [00:02<00:01, 19.37it/s][4/6] extract embeddings:  47%|████▋     | 27/58 [00:02<00:01, 20.15it/s][4/6] extract embeddings:  52%|█████▏    | 30/58 [00:02<00:01, 21.23it/s][4/6] extract embeddings:  57%|█████▋    | 33/58 [00:02<00:01, 21.41it/s][4/6] extract embeddings:  62%|██████▏   | 36/58 [00:02<00:01, 21.92it/s][4/6] extract embeddings:  67%|██████▋   | 39/58 [00:02<00:00, 22.37it/s][4/6] extract embeddings:  72%|███████▏  | 42/58 [00:02<00:00, 22.03it/s][4/6] extract embeddings:  78%|███████▊  | 45/58 [00:03<00:00, 21.30it/s][4/6] extract embeddings:  83%|████████▎ | 48/58 [00:03<00:00, 21.53it/s][4/6] extract embeddings:  88%|████████▊ | 51/58 [00:03<00:00, 21.56it/s][4/6] extract embeddings:  93%|█████████▎| 54/58 [00:03<00:00, 21.86it/s][4/6] extract embeddings:  98%|█████████▊| 57/58 [00:03<00:00, 22.13it/s][4/6] extract embeddings: 100%|██████████| 58/58 [00:03<00:00, 15.40it/s]
[NeMo I 2025-04-17 01:28:50 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:28:50 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:28:50 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:28:50 collections:880] Dataset successfully loaded with 5415 items and total duration provided from manifest is  1.35 hours.
[NeMo I 2025-04-17 01:28:50 collections:886] # 5415 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/85 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/85 [00:01<01:35,  1.14s/it][5/6] extract embeddings:   5%|▍         | 4/85 [00:01<00:19,  4.06it/s][5/6] extract embeddings:   8%|▊         | 7/85 [00:01<00:10,  7.49it/s][5/6] extract embeddings:  12%|█▏        | 10/85 [00:01<00:07, 10.57it/s][5/6] extract embeddings:  15%|█▌        | 13/85 [00:01<00:05, 13.75it/s][5/6] extract embeddings:  19%|█▉        | 16/85 [00:01<00:04, 16.82it/s][5/6] extract embeddings:  22%|██▏       | 19/85 [00:01<00:03, 19.26it/s][5/6] extract embeddings:  26%|██▌       | 22/85 [00:01<00:02, 21.22it/s][5/6] extract embeddings:  29%|██▉       | 25/85 [00:02<00:02, 22.20it/s][5/6] extract embeddings:  33%|███▎      | 28/85 [00:02<00:02, 23.30it/s][5/6] extract embeddings:  36%|███▋      | 31/85 [00:02<00:02, 23.42it/s][5/6] extract embeddings:  40%|████      | 34/85 [00:02<00:02, 25.04it/s][5/6] extract embeddings:  44%|████▎     | 37/85 [00:02<00:01, 24.78it/s][5/6] extract embeddings:  47%|████▋     | 40/85 [00:02<00:01, 24.60it/s][5/6] extract embeddings:  51%|█████     | 43/85 [00:02<00:01, 25.09it/s][5/6] extract embeddings:  54%|█████▍    | 46/85 [00:02<00:01, 24.82it/s][5/6] extract embeddings:  58%|█████▊    | 49/85 [00:03<00:01, 24.65it/s][5/6] extract embeddings:  61%|██████    | 52/85 [00:03<00:01, 24.47it/s][5/6] extract embeddings:  65%|██████▍   | 55/85 [00:03<00:01, 25.13it/s][5/6] extract embeddings:  68%|██████▊   | 58/85 [00:03<00:01, 25.74it/s][5/6] extract embeddings:  72%|███████▏  | 61/85 [00:03<00:00, 25.51it/s][5/6] extract embeddings:  75%|███████▌  | 64/85 [00:03<00:00, 25.11it/s][5/6] extract embeddings:  79%|███████▉  | 67/85 [00:03<00:00, 25.45it/s][5/6] extract embeddings:  82%|████████▏ | 70/85 [00:03<00:00, 25.27it/s][5/6] extract embeddings:  86%|████████▌ | 73/85 [00:03<00:00, 25.37it/s][5/6] extract embeddings:  89%|████████▉ | 76/85 [00:04<00:00, 25.26it/s][5/6] extract embeddings:  93%|█████████▎| 79/85 [00:04<00:00, 25.41it/s][5/6] extract embeddings:  96%|█████████▋| 82/85 [00:04<00:00, 26.05it/s][5/6] extract embeddings: 100%|██████████| 85/85 [00:04<00:00, 26.08it/s][5/6] extract embeddings: 100%|██████████| 85/85 [00:04<00:00, 19.13it/s]
[NeMo I 2025-04-17 01:28:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:28:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:28:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:28:55 collections:880] Dataset successfully loaded with 10990 items and total duration provided from manifest is  1.47 hours.
[NeMo I 2025-04-17 01:28:55 collections:886] # 10990 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/172 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/172 [00:01<03:15,  1.15s/it][6/6] extract embeddings:   3%|▎         | 5/172 [00:01<00:32,  5.14it/s][6/6] extract embeddings:   5%|▌         | 9/172 [00:01<00:17,  9.57it/s][6/6] extract embeddings:   8%|▊         | 13/172 [00:01<00:11, 13.88it/s][6/6] extract embeddings:   9%|▉         | 16/172 [00:01<00:09, 16.74it/s][6/6] extract embeddings:  12%|█▏        | 20/172 [00:01<00:07, 20.32it/s][6/6] extract embeddings:  13%|█▎        | 23/172 [00:01<00:06, 22.35it/s][6/6] extract embeddings:  16%|█▌        | 27/172 [00:01<00:05, 25.53it/s][6/6] extract embeddings:  18%|█▊        | 31/172 [00:02<00:05, 27.87it/s][6/6] extract embeddings:  20%|██        | 35/172 [00:02<00:04, 29.78it/s][6/6] extract embeddings:  23%|██▎       | 39/172 [00:02<00:04, 29.95it/s][6/6] extract embeddings:  25%|██▌       | 43/172 [00:02<00:04, 31.65it/s][6/6] extract embeddings:  27%|██▋       | 47/172 [00:02<00:03, 31.92it/s][6/6] extract embeddings:  30%|██▉       | 51/172 [00:02<00:03, 32.23it/s][6/6] extract embeddings:  32%|███▏      | 55/172 [00:02<00:03, 31.98it/s][6/6] extract embeddings:  34%|███▍      | 59/172 [00:02<00:03, 32.53it/s][6/6] extract embeddings:  37%|███▋      | 63/172 [00:03<00:03, 33.00it/s][6/6] extract embeddings:  39%|███▉      | 67/172 [00:03<00:03, 32.35it/s][6/6] extract embeddings:  41%|████▏     | 71/172 [00:03<00:03, 32.01it/s][6/6] extract embeddings:  44%|████▎     | 75/172 [00:03<00:02, 32.82it/s][6/6] extract embeddings:  46%|████▌     | 79/172 [00:03<00:02, 32.34it/s][6/6] extract embeddings:  48%|████▊     | 83/172 [00:03<00:02, 31.69it/s][6/6] extract embeddings:  51%|█████     | 87/172 [00:03<00:02, 30.97it/s][6/6] extract embeddings:  53%|█████▎    | 91/172 [00:03<00:02, 31.34it/s][6/6] extract embeddings:  55%|█████▌    | 95/172 [00:04<00:02, 30.91it/s][6/6] extract embeddings:  58%|█████▊    | 99/172 [00:04<00:02, 30.55it/s][6/6] extract embeddings:  60%|█████▉    | 103/172 [00:04<00:02, 30.16it/s][6/6] extract embeddings:  62%|██████▏   | 107/172 [00:04<00:02, 30.67it/s][6/6] extract embeddings:  65%|██████▍   | 111/172 [00:04<00:01, 31.64it/s][6/6] extract embeddings:  67%|██████▋   | 115/172 [00:04<00:01, 32.25it/s][6/6] extract embeddings:  69%|██████▉   | 119/172 [00:04<00:01, 31.75it/s][6/6] extract embeddings:  72%|███████▏  | 123/172 [00:04<00:01, 31.45it/s][6/6] extract embeddings:  74%|███████▍  | 127/172 [00:05<00:01, 31.36it/s][6/6] extract embeddings:  76%|███████▌  | 131/172 [00:05<00:01, 31.64it/s][6/6] extract embeddings:  78%|███████▊  | 135/172 [00:05<00:01, 30.40it/s][6/6] extract embeddings:  81%|████████  | 139/172 [00:05<00:01, 31.86it/s][6/6] extract embeddings:  83%|████████▎ | 143/172 [00:05<00:00, 31.20it/s][6/6] extract embeddings:  85%|████████▌ | 147/172 [00:05<00:00, 31.54it/s][6/6] extract embeddings:  88%|████████▊ | 151/172 [00:05<00:00, 31.40it/s][6/6] extract embeddings:  90%|█████████ | 155/172 [00:05<00:00, 32.05it/s][6/6] extract embeddings:  92%|█████████▏| 159/172 [00:06<00:00, 32.67it/s][6/6] extract embeddings:  95%|█████████▍| 163/172 [00:06<00:00, 33.11it/s][6/6] extract embeddings:  97%|█████████▋| 167/172 [00:06<00:00, 33.16it/s][6/6] extract embeddings:  99%|█████████▉| 171/172 [00:06<00:00, 32.95it/s][6/6] extract embeddings: 100%|██████████| 172/172 [00:06<00:00, 26.42it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:02,  1.28it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.37it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.02it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.50it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s]
[NeMo I 2025-04-17 01:29:04 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:29:05 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              48.167158   444.120  ...   15.190017  3.420251
    Harker-ES                       40.841980  2178.782  ...   46.958122  2.155246
    Harker-MN                       51.700433   366.767  ...   32.660960  8.905098
    Longfellow-Block-1              36.692839   492.417  ...   11.956965  2.428219
    TOTAL                           42.333233  3482.086  ...  106.766064  3.066152
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:29:05 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0625 | MISS: 0.3302 | CER: 0.0307 | DER: 0.4233 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:29:16 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:29:16 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:29:16 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:29:16 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:29:16 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:29:17 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:29:17 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:29:17 features:305] PADDING: 16
[NeMo I 2025-04-17 01:29:17 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:29:17 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:29:17 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:29:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:29:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:29:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:29:17 collections:880] Dataset successfully loaded with 2098 items and total duration provided from manifest is  1.03 hours.
[NeMo I 2025-04-17 01:29:17 collections:886] # 2098 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:05,  2.04s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:12,  2.41it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.86it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.30it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  7.78it/s][1/6] extract embeddings:  39%|███▉      | 13/33 [00:02<00:02,  9.34it/s][1/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 10.99it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 12.36it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:03<00:01, 13.42it/s][1/6] extract embeddings:  64%|██████▎   | 21/33 [00:03<00:00, 14.75it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:03<00:00, 15.63it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 15.94it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 16.13it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 16.10it/s][1/6] extract embeddings:  94%|█████████▍| 31/33 [00:03<00:00, 16.90it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.67it/s]
[NeMo I 2025-04-17 01:29:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:29:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:29:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:29:21 collections:880] Dataset successfully loaded with 2372 items and total duration provided from manifest is  1.08 hours.
[NeMo I 2025-04-17 01:29:21 collections:886] # 2372 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:50,  1.38s/it][2/6] extract embeddings:   8%|▊         | 3/38 [00:01<00:13,  2.52it/s][2/6] extract embeddings:  13%|█▎        | 5/38 [00:01<00:07,  4.57it/s][2/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  6.69it/s][2/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02,  9.77it/s][2/6] extract embeddings:  32%|███▏      | 12/38 [00:01<00:02, 11.25it/s][2/6] extract embeddings:  37%|███▋      | 14/38 [00:02<00:01, 12.89it/s][2/6] extract embeddings:  45%|████▍     | 17/38 [00:02<00:01, 15.17it/s][2/6] extract embeddings:  53%|█████▎    | 20/38 [00:02<00:01, 16.66it/s][2/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 17.14it/s][2/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 18.32it/s][2/6] extract embeddings:  71%|███████   | 27/38 [00:02<00:00, 18.52it/s][2/6] extract embeddings:  76%|███████▋  | 29/38 [00:02<00:00, 18.25it/s][2/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 18.36it/s][2/6] extract embeddings:  87%|████████▋ | 33/38 [00:03<00:00, 18.38it/s][2/6] extract embeddings:  92%|█████████▏| 35/38 [00:03<00:00, 18.76it/s][2/6] extract embeddings:  97%|█████████▋| 37/38 [00:03<00:00, 18.61it/s][2/6] extract embeddings: 100%|██████████| 38/38 [00:03<00:00, 11.44it/s]
[NeMo I 2025-04-17 01:29:24 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:29:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:29:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:29:25 collections:880] Dataset successfully loaded with 2782 items and total duration provided from manifest is  1.14 hours.
[NeMo I 2025-04-17 01:29:25 collections:886] # 2782 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:51,  1.19s/it][3/6] extract embeddings:   7%|▋         | 3/44 [00:01<00:14,  2.88it/s][3/6] extract embeddings:  11%|█▏        | 5/44 [00:01<00:07,  5.12it/s][3/6] extract embeddings:  18%|█▊        | 8/44 [00:01<00:04,  8.51it/s][3/6] extract embeddings:  25%|██▌       | 11/44 [00:01<00:02, 11.36it/s][3/6] extract embeddings:  30%|██▉       | 13/44 [00:01<00:02, 12.95it/s][3/6] extract embeddings:  34%|███▍      | 15/44 [00:01<00:02, 14.08it/s][3/6] extract embeddings:  41%|████      | 18/44 [00:02<00:01, 15.89it/s][3/6] extract embeddings:  48%|████▊     | 21/44 [00:02<00:01, 17.57it/s][3/6] extract embeddings:  52%|█████▏    | 23/44 [00:02<00:01, 17.88it/s][3/6] extract embeddings:  57%|█████▋    | 25/44 [00:02<00:01, 18.39it/s][3/6] extract embeddings:  64%|██████▎   | 28/44 [00:02<00:00, 19.06it/s][3/6] extract embeddings:  70%|███████   | 31/44 [00:02<00:00, 20.05it/s][3/6] extract embeddings:  77%|███████▋  | 34/44 [00:02<00:00, 19.82it/s][3/6] extract embeddings:  84%|████████▍ | 37/44 [00:02<00:00, 19.41it/s][3/6] extract embeddings:  89%|████████▊ | 39/44 [00:03<00:00, 19.38it/s][3/6] extract embeddings:  95%|█████████▌| 42/44 [00:03<00:00, 19.77it/s][3/6] extract embeddings: 100%|██████████| 44/44 [00:03<00:00, 13.12it/s]
[NeMo I 2025-04-17 01:29:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:29:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:29:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:29:28 collections:880] Dataset successfully loaded with 3573 items and total duration provided from manifest is  1.21 hours.
[NeMo I 2025-04-17 01:29:28 collections:886] # 3573 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/56 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/56 [00:01<01:04,  1.17s/it][4/6] extract embeddings:   7%|▋         | 4/56 [00:01<00:13,  3.88it/s][4/6] extract embeddings:  12%|█▎        | 7/56 [00:01<00:07,  6.99it/s][4/6] extract embeddings:  18%|█▊        | 10/56 [00:01<00:04, 10.16it/s][4/6] extract embeddings:  23%|██▎       | 13/56 [00:01<00:03, 12.72it/s][4/6] extract embeddings:  29%|██▊       | 16/56 [00:01<00:02, 15.17it/s][4/6] extract embeddings:  34%|███▍      | 19/56 [00:01<00:02, 17.05it/s][4/6] extract embeddings:  39%|███▉      | 22/56 [00:02<00:01, 18.67it/s][4/6] extract embeddings:  45%|████▍     | 25/56 [00:02<00:01, 19.34it/s][4/6] extract embeddings:  50%|█████     | 28/56 [00:02<00:01, 20.35it/s][4/6] extract embeddings:  55%|█████▌    | 31/56 [00:02<00:01, 21.09it/s][4/6] extract embeddings:  61%|██████    | 34/56 [00:02<00:01, 21.07it/s][4/6] extract embeddings:  66%|██████▌   | 37/56 [00:02<00:00, 20.42it/s][4/6] extract embeddings:  71%|███████▏  | 40/56 [00:02<00:00, 21.30it/s][4/6] extract embeddings:  77%|███████▋  | 43/56 [00:03<00:00, 21.38it/s][4/6] extract embeddings:  82%|████████▏ | 46/56 [00:03<00:00, 20.58it/s][4/6] extract embeddings:  88%|████████▊ | 49/56 [00:03<00:00, 21.28it/s][4/6] extract embeddings:  93%|█████████▎| 52/56 [00:03<00:00, 21.70it/s][4/6] extract embeddings:  98%|█████████▊| 55/56 [00:03<00:00, 22.62it/s][4/6] extract embeddings: 100%|██████████| 56/56 [00:03<00:00, 15.16it/s]
[NeMo I 2025-04-17 01:29:32 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:29:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:29:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:29:32 collections:880] Dataset successfully loaded with 5241 items and total duration provided from manifest is  1.30 hours.
[NeMo I 2025-04-17 01:29:32 collections:886] # 5241 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/82 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/82 [00:01<01:41,  1.25s/it][5/6] extract embeddings:   5%|▍         | 4/82 [00:01<00:20,  3.75it/s][5/6] extract embeddings:   9%|▊         | 7/82 [00:01<00:10,  6.87it/s][5/6] extract embeddings:  12%|█▏        | 10/82 [00:01<00:07, 10.19it/s][5/6] extract embeddings:  16%|█▌        | 13/82 [00:01<00:05, 13.13it/s][5/6] extract embeddings:  20%|█▉        | 16/82 [00:01<00:04, 16.33it/s][5/6] extract embeddings:  23%|██▎       | 19/82 [00:01<00:03, 18.95it/s][5/6] extract embeddings:  27%|██▋       | 22/82 [00:02<00:02, 20.70it/s][5/6] extract embeddings:  30%|███       | 25/82 [00:02<00:02, 22.36it/s][5/6] extract embeddings:  34%|███▍      | 28/82 [00:02<00:02, 23.34it/s][5/6] extract embeddings:  38%|███▊      | 31/82 [00:02<00:02, 24.30it/s][5/6] extract embeddings:  41%|████▏     | 34/82 [00:02<00:01, 24.05it/s][5/6] extract embeddings:  45%|████▌     | 37/82 [00:02<00:01, 24.81it/s][5/6] extract embeddings:  49%|████▉     | 40/82 [00:02<00:01, 24.71it/s][5/6] extract embeddings:  52%|█████▏    | 43/82 [00:02<00:01, 24.88it/s][5/6] extract embeddings:  56%|█████▌    | 46/82 [00:02<00:01, 25.76it/s][5/6] extract embeddings:  60%|█████▉    | 49/82 [00:03<00:01, 25.53it/s][5/6] extract embeddings:  63%|██████▎   | 52/82 [00:03<00:01, 25.64it/s][5/6] extract embeddings:  67%|██████▋   | 55/82 [00:03<00:01, 24.75it/s][5/6] extract embeddings:  71%|███████   | 58/82 [00:03<00:00, 25.25it/s][5/6] extract embeddings:  74%|███████▍  | 61/82 [00:03<00:00, 25.17it/s][5/6] extract embeddings:  78%|███████▊  | 64/82 [00:03<00:00, 24.75it/s][5/6] extract embeddings:  82%|████████▏ | 67/82 [00:03<00:00, 24.64it/s][5/6] extract embeddings:  85%|████████▌ | 70/82 [00:03<00:00, 25.57it/s][5/6] extract embeddings:  89%|████████▉ | 73/82 [00:04<00:00, 25.83it/s][5/6] extract embeddings:  93%|█████████▎| 76/82 [00:04<00:00, 26.01it/s][5/6] extract embeddings:  96%|█████████▋| 79/82 [00:04<00:00, 26.16it/s][5/6] extract embeddings: 100%|██████████| 82/82 [00:04<00:00, 26.44it/s][5/6] extract embeddings: 100%|██████████| 82/82 [00:04<00:00, 18.61it/s]
[NeMo I 2025-04-17 01:29:37 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:29:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:29:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:29:37 collections:880] Dataset successfully loaded with 10614 items and total duration provided from manifest is  1.41 hours.
[NeMo I 2025-04-17 01:29:37 collections:886] # 10614 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/166 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/166 [00:01<03:39,  1.33s/it][6/6] extract embeddings:   3%|▎         | 5/166 [00:01<00:35,  4.53it/s][6/6] extract embeddings:   5%|▌         | 9/166 [00:01<00:18,  8.47it/s][6/6] extract embeddings:   8%|▊         | 13/166 [00:01<00:12, 12.58it/s][6/6] extract embeddings:  10%|▉         | 16/166 [00:01<00:09, 15.30it/s][6/6] extract embeddings:  12%|█▏        | 20/166 [00:01<00:07, 18.79it/s][6/6] extract embeddings:  14%|█▍        | 24/166 [00:02<00:06, 22.32it/s][6/6] extract embeddings:  17%|█▋        | 28/166 [00:02<00:05, 25.34it/s][6/6] extract embeddings:  19%|█▉        | 32/166 [00:02<00:04, 27.26it/s][6/6] extract embeddings:  22%|██▏       | 36/166 [00:02<00:04, 28.15it/s][6/6] extract embeddings:  24%|██▍       | 40/166 [00:02<00:04, 28.64it/s][6/6] extract embeddings:  27%|██▋       | 44/166 [00:02<00:04, 30.03it/s][6/6] extract embeddings:  29%|██▉       | 48/166 [00:02<00:03, 30.61it/s][6/6] extract embeddings:  31%|███▏      | 52/166 [00:02<00:03, 29.82it/s][6/6] extract embeddings:  34%|███▎      | 56/166 [00:03<00:03, 30.95it/s][6/6] extract embeddings:  36%|███▌      | 60/166 [00:03<00:03, 32.00it/s][6/6] extract embeddings:  39%|███▊      | 64/166 [00:03<00:03, 32.41it/s][6/6] extract embeddings:  41%|████      | 68/166 [00:03<00:02, 33.20it/s][6/6] extract embeddings:  43%|████▎     | 72/166 [00:03<00:02, 32.64it/s][6/6] extract embeddings:  46%|████▌     | 76/166 [00:03<00:02, 33.37it/s][6/6] extract embeddings:  48%|████▊     | 80/166 [00:03<00:02, 33.35it/s][6/6] extract embeddings:  51%|█████     | 84/166 [00:03<00:02, 33.02it/s][6/6] extract embeddings:  53%|█████▎    | 88/166 [00:04<00:02, 32.01it/s][6/6] extract embeddings:  55%|█████▌    | 92/166 [00:04<00:02, 31.99it/s][6/6] extract embeddings:  58%|█████▊    | 96/166 [00:04<00:02, 32.10it/s][6/6] extract embeddings:  60%|██████    | 100/166 [00:04<00:02, 32.33it/s][6/6] extract embeddings:  63%|██████▎   | 104/166 [00:04<00:01, 32.55it/s][6/6] extract embeddings:  65%|██████▌   | 108/166 [00:04<00:01, 32.85it/s][6/6] extract embeddings:  67%|██████▋   | 112/166 [00:04<00:01, 31.15it/s][6/6] extract embeddings:  70%|██████▉   | 116/166 [00:04<00:01, 31.54it/s][6/6] extract embeddings:  72%|███████▏  | 120/166 [00:05<00:01, 32.58it/s][6/6] extract embeddings:  75%|███████▍  | 124/166 [00:05<00:01, 32.87it/s][6/6] extract embeddings:  77%|███████▋  | 128/166 [00:05<00:01, 31.99it/s][6/6] extract embeddings:  80%|███████▉  | 132/166 [00:05<00:01, 32.03it/s][6/6] extract embeddings:  82%|████████▏ | 136/166 [00:05<00:00, 32.31it/s][6/6] extract embeddings:  84%|████████▍ | 140/166 [00:05<00:00, 33.44it/s][6/6] extract embeddings:  87%|████████▋ | 144/166 [00:05<00:00, 33.31it/s][6/6] extract embeddings:  89%|████████▉ | 148/166 [00:05<00:00, 33.42it/s][6/6] extract embeddings:  92%|█████████▏| 152/166 [00:05<00:00, 33.53it/s][6/6] extract embeddings:  94%|█████████▍| 156/166 [00:06<00:00, 32.96it/s][6/6] extract embeddings:  96%|█████████▋| 160/166 [00:06<00:00, 32.89it/s][6/6] extract embeddings:  99%|█████████▉| 164/166 [00:06<00:00, 32.92it/s][6/6] extract embeddings: 100%|██████████| 166/166 [00:06<00:00, 25.70it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.73it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.60it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.31it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.39it/s]
[NeMo I 2025-04-17 01:29:45 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:29:46 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              49.602579   444.120  ...  15.445086  3.477683
    Harker-ES                       42.409702  2178.782  ...  45.106127  2.070245
    Harker-MN                       52.001390   366.767  ...  28.442903  7.755033
    Longfellow-Block-1              38.104631   492.417  ...   8.578929  1.742208
    TOTAL                           43.728603  3482.086  ...  97.573045  2.802143
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:29:46 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0597 | MISS: 0.3496 | CER: 0.0280 | DER: 0.4373 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:29:58 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:29:58 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:29:58 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:29:58 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:29:58 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:29:58 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:29:58 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:29:58 features:305] PADDING: 16
[NeMo I 2025-04-17 01:29:59 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:29:59 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:29:59 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:29:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:29:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:29:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:29:59 collections:880] Dataset successfully loaded with 2075 items and total duration provided from manifest is  0.97 hours.
[NeMo I 2025-04-17 01:29:59 collections:886] # 2075 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  1.98s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.47it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.98it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.69it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.43it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  9.09it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.85it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.59it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 14.47it/s][1/6] extract embeddings:  64%|██████▎   | 21/33 [00:03<00:00, 15.41it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:03<00:00, 15.96it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 10.14it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 12.54it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 13.92it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 15.10it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.36it/s]
[NeMo I 2025-04-17 01:30:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:30:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:03 collections:880] Dataset successfully loaded with 2317 items and total duration provided from manifest is  1.01 hours.
[NeMo I 2025-04-17 01:30:03 collections:886] # 2317 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:50,  1.41s/it][2/6] extract embeddings:   8%|▊         | 3/37 [00:01<00:13,  2.47it/s][2/6] extract embeddings:  14%|█▎        | 5/37 [00:01<00:07,  4.41it/s][2/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  6.52it/s][2/6] extract embeddings:  24%|██▍       | 9/37 [00:01<00:03,  8.56it/s][2/6] extract embeddings:  30%|██▉       | 11/37 [00:01<00:02, 10.15it/s][2/6] extract embeddings:  38%|███▊      | 14/37 [00:02<00:01, 12.62it/s][2/6] extract embeddings:  43%|████▎     | 16/37 [00:02<00:01, 14.12it/s][2/6] extract embeddings:  51%|█████▏    | 19/37 [00:02<00:01, 16.01it/s][2/6] extract embeddings:  57%|█████▋    | 21/37 [00:02<00:00, 16.88it/s][2/6] extract embeddings:  65%|██████▍   | 24/37 [00:02<00:00, 18.21it/s][2/6] extract embeddings:  73%|███████▎  | 27/37 [00:02<00:00, 18.76it/s][2/6] extract embeddings:  78%|███████▊  | 29/37 [00:02<00:00, 18.70it/s][2/6] extract embeddings:  84%|████████▍ | 31/37 [00:03<00:00, 18.41it/s][2/6] extract embeddings:  89%|████████▉ | 33/37 [00:03<00:00, 18.51it/s][2/6] extract embeddings:  95%|█████████▍| 35/37 [00:03<00:00, 18.63it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 11.12it/s]
[NeMo I 2025-04-17 01:30:06 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:30:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:07 collections:880] Dataset successfully loaded with 2703 items and total duration provided from manifest is  1.07 hours.
[NeMo I 2025-04-17 01:30:07 collections:886] # 2703 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:50,  1.21s/it][3/6] extract embeddings:   9%|▉         | 4/43 [00:01<00:10,  3.73it/s][3/6] extract embeddings:  14%|█▍        | 6/43 [00:01<00:06,  5.77it/s][3/6] extract embeddings:  21%|██        | 9/43 [00:01<00:03,  8.81it/s][3/6] extract embeddings:  26%|██▌       | 11/43 [00:01<00:03, 10.65it/s][3/6] extract embeddings:  30%|███       | 13/43 [00:01<00:02, 12.36it/s][3/6] extract embeddings:  37%|███▋      | 16/43 [00:01<00:01, 14.68it/s][3/6] extract embeddings:  44%|████▍     | 19/43 [00:02<00:01, 16.84it/s][3/6] extract embeddings:  51%|█████     | 22/43 [00:02<00:01, 17.57it/s][3/6] extract embeddings:  56%|█████▌    | 24/43 [00:02<00:01, 17.91it/s][3/6] extract embeddings:  63%|██████▎   | 27/43 [00:02<00:00, 19.32it/s][3/6] extract embeddings:  70%|██████▉   | 30/43 [00:02<00:00, 19.90it/s][3/6] extract embeddings:  77%|███████▋  | 33/43 [00:02<00:00, 19.52it/s][3/6] extract embeddings:  84%|████████▎ | 36/43 [00:02<00:00, 19.66it/s][3/6] extract embeddings:  91%|█████████ | 39/43 [00:03<00:00, 19.47it/s][3/6] extract embeddings:  98%|█████████▊| 42/43 [00:03<00:00, 20.18it/s][3/6] extract embeddings: 100%|██████████| 43/43 [00:03<00:00, 13.11it/s]
[NeMo I 2025-04-17 01:30:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:30:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:10 collections:880] Dataset successfully loaded with 3446 items and total duration provided from manifest is  1.14 hours.
[NeMo I 2025-04-17 01:30:10 collections:886] # 3446 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/54 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/54 [00:01<01:02,  1.17s/it][4/6] extract embeddings:   7%|▋         | 4/54 [00:01<00:12,  3.89it/s][4/6] extract embeddings:  13%|█▎        | 7/54 [00:01<00:06,  7.00it/s][4/6] extract embeddings:  19%|█▊        | 10/54 [00:01<00:04, 10.07it/s][4/6] extract embeddings:  24%|██▍       | 13/54 [00:01<00:03, 12.68it/s][4/6] extract embeddings:  30%|██▉       | 16/54 [00:01<00:02, 15.00it/s][4/6] extract embeddings:  35%|███▌      | 19/54 [00:01<00:02, 17.05it/s][4/6] extract embeddings:  41%|████      | 22/54 [00:02<00:01, 18.12it/s][4/6] extract embeddings:  46%|████▋     | 25/54 [00:02<00:01, 19.98it/s][4/6] extract embeddings:  52%|█████▏    | 28/54 [00:02<00:01, 19.93it/s][4/6] extract embeddings:  57%|█████▋    | 31/54 [00:02<00:01, 20.62it/s][4/6] extract embeddings:  63%|██████▎   | 34/54 [00:02<00:00, 21.41it/s][4/6] extract embeddings:  69%|██████▊   | 37/54 [00:02<00:00, 21.69it/s][4/6] extract embeddings:  74%|███████▍  | 40/54 [00:02<00:00, 21.66it/s][4/6] extract embeddings:  80%|███████▉  | 43/54 [00:03<00:00, 22.13it/s][4/6] extract embeddings:  85%|████████▌ | 46/54 [00:03<00:00, 21.67it/s][4/6] extract embeddings:  91%|█████████ | 49/54 [00:03<00:00, 22.12it/s][4/6] extract embeddings:  96%|█████████▋| 52/54 [00:03<00:00, 22.41it/s][4/6] extract embeddings: 100%|██████████| 54/54 [00:03<00:00, 15.21it/s]
[NeMo I 2025-04-17 01:30:14 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:30:14 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:14 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:14 collections:880] Dataset successfully loaded with 5001 items and total duration provided from manifest is  1.23 hours.
[NeMo I 2025-04-17 01:30:14 collections:886] # 5001 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/79 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/79 [00:01<01:52,  1.44s/it][5/6] extract embeddings:   5%|▌         | 4/79 [00:01<00:22,  3.32it/s][5/6] extract embeddings:   9%|▉         | 7/79 [00:01<00:11,  6.18it/s][5/6] extract embeddings:  13%|█▎        | 10/79 [00:01<00:07,  9.33it/s][5/6] extract embeddings:  16%|█▋        | 13/79 [00:01<00:05, 12.06it/s][5/6] extract embeddings:  20%|██        | 16/79 [00:02<00:04, 14.99it/s][5/6] extract embeddings:  24%|██▍       | 19/79 [00:02<00:03, 17.11it/s][5/6] extract embeddings:  28%|██▊       | 22/79 [00:02<00:02, 19.65it/s][5/6] extract embeddings:  32%|███▏      | 25/79 [00:02<00:02, 20.28it/s][5/6] extract embeddings:  35%|███▌      | 28/79 [00:02<00:02, 21.95it/s][5/6] extract embeddings:  39%|███▉      | 31/79 [00:02<00:02, 23.48it/s][5/6] extract embeddings:  43%|████▎     | 34/79 [00:02<00:01, 23.54it/s][5/6] extract embeddings:  47%|████▋     | 37/79 [00:02<00:01, 24.43it/s][5/6] extract embeddings:  51%|█████     | 40/79 [00:02<00:01, 25.62it/s][5/6] extract embeddings:  54%|█████▍    | 43/79 [00:03<00:01, 25.35it/s][5/6] extract embeddings:  58%|█████▊    | 46/79 [00:03<00:01, 25.96it/s][5/6] extract embeddings:  62%|██████▏   | 49/79 [00:03<00:01, 24.82it/s][5/6] extract embeddings:  66%|██████▌   | 52/79 [00:03<00:01, 26.07it/s][5/6] extract embeddings:  70%|██████▉   | 55/79 [00:03<00:00, 25.50it/s][5/6] extract embeddings:  73%|███████▎  | 58/79 [00:03<00:00, 26.07it/s][5/6] extract embeddings:  77%|███████▋  | 61/79 [00:03<00:00, 26.04it/s][5/6] extract embeddings:  81%|████████  | 64/79 [00:03<00:00, 25.43it/s][5/6] extract embeddings:  85%|████████▍ | 67/79 [00:04<00:00, 25.09it/s][5/6] extract embeddings:  89%|████████▊ | 70/79 [00:04<00:00, 24.58it/s][5/6] extract embeddings:  92%|█████████▏| 73/79 [00:04<00:00, 24.97it/s][5/6] extract embeddings:  96%|█████████▌| 76/79 [00:04<00:00, 25.72it/s][5/6] extract embeddings: 100%|██████████| 79/79 [00:04<00:00, 25.28it/s][5/6] extract embeddings: 100%|██████████| 79/79 [00:04<00:00, 17.48it/s]
[NeMo I 2025-04-17 01:30:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:30:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:19 collections:880] Dataset successfully loaded with 10125 items and total duration provided from manifest is  1.34 hours.
[NeMo I 2025-04-17 01:30:19 collections:886] # 10125 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/159 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/159 [00:01<03:03,  1.16s/it][6/6] extract embeddings:   3%|▎         | 5/159 [00:01<00:30,  5.06it/s][6/6] extract embeddings:   6%|▌         | 9/159 [00:01<00:15,  9.62it/s][6/6] extract embeddings:   8%|▊         | 13/159 [00:01<00:10, 13.90it/s][6/6] extract embeddings:  10%|█         | 16/159 [00:01<00:08, 16.75it/s][6/6] extract embeddings:  13%|█▎        | 20/159 [00:01<00:06, 20.86it/s][6/6] extract embeddings:  15%|█▌        | 24/159 [00:01<00:05, 23.26it/s][6/6] extract embeddings:  18%|█▊        | 28/159 [00:01<00:05, 25.61it/s][6/6] extract embeddings:  20%|██        | 32/159 [00:02<00:04, 27.47it/s][6/6] extract embeddings:  23%|██▎       | 36/159 [00:02<00:04, 28.51it/s][6/6] extract embeddings:  25%|██▌       | 40/159 [00:02<00:04, 29.06it/s][6/6] extract embeddings:  28%|██▊       | 44/159 [00:02<00:03, 29.25it/s][6/6] extract embeddings:  30%|███       | 48/159 [00:02<00:03, 29.25it/s][6/6] extract embeddings:  33%|███▎      | 52/159 [00:02<00:03, 30.93it/s][6/6] extract embeddings:  35%|███▌      | 56/159 [00:02<00:03, 30.76it/s][6/6] extract embeddings:  38%|███▊      | 60/159 [00:03<00:03, 31.08it/s][6/6] extract embeddings:  40%|████      | 64/159 [00:03<00:03, 30.89it/s][6/6] extract embeddings:  43%|████▎     | 68/159 [00:03<00:02, 30.69it/s][6/6] extract embeddings:  45%|████▌     | 72/159 [00:03<00:02, 30.87it/s][6/6] extract embeddings:  48%|████▊     | 76/159 [00:03<00:02, 31.70it/s][6/6] extract embeddings:  50%|█████     | 80/159 [00:03<00:02, 31.16it/s][6/6] extract embeddings:  53%|█████▎    | 84/159 [00:03<00:02, 31.50it/s][6/6] extract embeddings:  55%|█████▌    | 88/159 [00:03<00:02, 31.13it/s][6/6] extract embeddings:  58%|█████▊    | 92/159 [00:04<00:02, 31.46it/s][6/6] extract embeddings:  60%|██████    | 96/159 [00:04<00:02, 31.32it/s][6/6] extract embeddings:  63%|██████▎   | 100/159 [00:04<00:01, 30.52it/s][6/6] extract embeddings:  65%|██████▌   | 104/159 [00:04<00:01, 30.73it/s][6/6] extract embeddings:  68%|██████▊   | 108/159 [00:04<00:01, 31.32it/s][6/6] extract embeddings:  70%|███████   | 112/159 [00:04<00:01, 31.61it/s][6/6] extract embeddings:  73%|███████▎  | 116/159 [00:04<00:01, 31.65it/s][6/6] extract embeddings:  75%|███████▌  | 120/159 [00:04<00:01, 32.65it/s][6/6] extract embeddings:  78%|███████▊  | 124/159 [00:05<00:01, 32.63it/s][6/6] extract embeddings:  81%|████████  | 128/159 [00:05<00:00, 32.15it/s][6/6] extract embeddings:  83%|████████▎ | 132/159 [00:05<00:00, 32.77it/s][6/6] extract embeddings:  86%|████████▌ | 136/159 [00:05<00:00, 32.72it/s][6/6] extract embeddings:  88%|████████▊ | 140/159 [00:05<00:00, 32.64it/s][6/6] extract embeddings:  91%|█████████ | 144/159 [00:05<00:00, 33.27it/s][6/6] extract embeddings:  93%|█████████▎| 148/159 [00:05<00:00, 31.56it/s][6/6] extract embeddings:  96%|█████████▌| 152/159 [00:05<00:00, 32.12it/s][6/6] extract embeddings:  98%|█████████▊| 156/159 [00:06<00:00, 30.92it/s][6/6] extract embeddings: 100%|██████████| 159/159 [00:06<00:00, 25.81it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.07it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.80it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.53it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.63it/s]
[NeMo I 2025-04-17 01:30:27 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:30:28 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              51.438716   444.120  ...  15.180082  3.418014
    Harker-ES                       45.030231  2178.782  ...  41.142625  1.888331
    Harker-MN                       53.510534   366.767  ...  27.604938  7.526560
    Longfellow-Block-1              40.678929   492.417  ...   9.500970  1.929456
    TOTAL                           46.125487  3482.086  ...  93.428615  2.683122
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:30:28 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0567 | MISS: 0.3777 | CER: 0.0268 | DER: 0.4613 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.82s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.97s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.26s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.18s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:30:40 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:30:40 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:30:40 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:30:40 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:30:40 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:30:40 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:30:40 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:30:40 features:305] PADDING: 16
[NeMo I 2025-04-17 01:30:40 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:30:41 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:30:41 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:30:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:30:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:41 collections:880] Dataset successfully loaded with 2059 items and total duration provided from manifest is  0.88 hours.
[NeMo I 2025-04-17 01:30:41 collections:886] # 2059 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  1.99s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.45it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.64it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  6.97it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  8.38it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.05it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 11.68it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:01, 13.96it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 16.00it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 16.30it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 16.84it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 16.87it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 16.73it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 17.20it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  9.07it/s]
[NeMo I 2025-04-17 01:30:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:30:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:44 collections:880] Dataset successfully loaded with 2276 items and total duration provided from manifest is  0.93 hours.
[NeMo I 2025-04-17 01:30:44 collections:886] # 2276 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:48,  1.40s/it][2/6] extract embeddings:  11%|█         | 4/36 [00:01<00:09,  3.25it/s][2/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  5.85it/s][2/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:03,  8.39it/s][2/6] extract embeddings:  33%|███▎      | 12/36 [00:01<00:02, 10.01it/s][2/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:01, 11.54it/s][2/6] extract embeddings:  44%|████▍     | 16/36 [00:02<00:01, 13.16it/s][2/6] extract embeddings:  50%|█████     | 18/36 [00:02<00:01, 14.50it/s][2/6] extract embeddings:  58%|█████▊    | 21/36 [00:02<00:00, 16.44it/s][2/6] extract embeddings:  67%|██████▋   | 24/36 [00:02<00:00, 18.17it/s][2/6] extract embeddings:  75%|███████▌  | 27/36 [00:02<00:00, 18.10it/s][2/6] extract embeddings:  83%|████████▎ | 30/36 [00:02<00:00, 18.28it/s][2/6] extract embeddings:  92%|█████████▏| 33/36 [00:03<00:00, 18.54it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 20.32it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 11.23it/s]
[NeMo I 2025-04-17 01:30:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:30:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:48 collections:880] Dataset successfully loaded with 2612 items and total duration provided from manifest is  0.98 hours.
[NeMo I 2025-04-17 01:30:48 collections:886] # 2612 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:45,  1.14s/it][3/6] extract embeddings:  10%|▉         | 4/41 [00:01<00:09,  3.95it/s][3/6] extract embeddings:  15%|█▍        | 6/41 [00:01<00:05,  6.07it/s][3/6] extract embeddings:  22%|██▏       | 9/41 [00:01<00:03,  9.40it/s][3/6] extract embeddings:  27%|██▋       | 11/41 [00:01<00:02, 11.19it/s][3/6] extract embeddings:  32%|███▏      | 13/41 [00:01<00:02, 12.77it/s][3/6] extract embeddings:  37%|███▋      | 15/41 [00:01<00:01, 14.18it/s][3/6] extract embeddings:  44%|████▍     | 18/41 [00:01<00:01, 16.87it/s][3/6] extract embeddings:  51%|█████     | 21/41 [00:02<00:01, 17.98it/s][3/6] extract embeddings:  59%|█████▊    | 24/41 [00:02<00:00, 18.54it/s][3/6] extract embeddings:  66%|██████▌   | 27/41 [00:02<00:00, 19.88it/s][3/6] extract embeddings:  73%|███████▎  | 30/41 [00:02<00:00, 19.85it/s][3/6] extract embeddings:  80%|████████  | 33/41 [00:02<00:00, 20.18it/s][3/6] extract embeddings:  88%|████████▊ | 36/41 [00:02<00:00, 20.03it/s][3/6] extract embeddings:  95%|█████████▌| 39/41 [00:02<00:00, 20.31it/s][3/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 13.28it/s]
[NeMo I 2025-04-17 01:30:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:30:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:51 collections:880] Dataset successfully loaded with 3271 items and total duration provided from manifest is  1.05 hours.
[NeMo I 2025-04-17 01:30:51 collections:886] # 3271 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/52 [00:01<00:58,  1.15s/it][4/6] extract embeddings:   8%|▊         | 4/52 [00:01<00:12,  3.98it/s][4/6] extract embeddings:  12%|█▏        | 6/52 [00:01<00:07,  6.03it/s][4/6] extract embeddings:  17%|█▋        | 9/52 [00:01<00:04,  9.36it/s][4/6] extract embeddings:  23%|██▎       | 12/52 [00:01<00:03, 12.62it/s][4/6] extract embeddings:  29%|██▉       | 15/52 [00:01<00:02, 14.87it/s][4/6] extract embeddings:  35%|███▍      | 18/52 [00:01<00:01, 17.11it/s][4/6] extract embeddings:  40%|████      | 21/52 [00:02<00:01, 18.80it/s][4/6] extract embeddings:  46%|████▌     | 24/52 [00:02<00:01, 20.35it/s][4/6] extract embeddings:  52%|█████▏    | 27/52 [00:02<00:01, 21.28it/s][4/6] extract embeddings:  58%|█████▊    | 30/52 [00:02<00:00, 22.24it/s][4/6] extract embeddings:  63%|██████▎   | 33/52 [00:02<00:00, 22.66it/s][4/6] extract embeddings:  69%|██████▉   | 36/52 [00:02<00:00, 23.45it/s][4/6] extract embeddings:  75%|███████▌  | 39/52 [00:02<00:00, 23.25it/s][4/6] extract embeddings:  81%|████████  | 42/52 [00:02<00:00, 23.09it/s][4/6] extract embeddings:  87%|████████▋ | 45/52 [00:03<00:00, 23.21it/s][4/6] extract embeddings:  92%|█████████▏| 48/52 [00:03<00:00, 24.03it/s][4/6] extract embeddings:  98%|█████████▊| 51/52 [00:03<00:00, 23.88it/s][4/6] extract embeddings: 100%|██████████| 52/52 [00:03<00:00, 15.55it/s]
[NeMo I 2025-04-17 01:30:54 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:30:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:55 collections:880] Dataset successfully loaded with 4708 items and total duration provided from manifest is  1.13 hours.
[NeMo I 2025-04-17 01:30:55 collections:886] # 4708 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/74 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/74 [00:01<01:22,  1.12s/it][5/6] extract embeddings:   5%|▌         | 4/74 [00:01<00:16,  4.14it/s][5/6] extract embeddings:   9%|▉         | 7/74 [00:01<00:08,  7.50it/s][5/6] extract embeddings:  14%|█▎        | 10/74 [00:01<00:05, 10.98it/s][5/6] extract embeddings:  18%|█▊        | 13/74 [00:01<00:04, 14.06it/s][5/6] extract embeddings:  22%|██▏       | 16/74 [00:01<00:03, 16.63it/s][5/6] extract embeddings:  26%|██▌       | 19/74 [00:01<00:02, 18.87it/s][5/6] extract embeddings:  30%|██▉       | 22/74 [00:01<00:02, 20.52it/s][5/6] extract embeddings:  34%|███▍      | 25/74 [00:02<00:02, 21.96it/s][5/6] extract embeddings:  38%|███▊      | 28/74 [00:02<00:01, 23.36it/s][5/6] extract embeddings:  42%|████▏     | 31/74 [00:02<00:01, 24.33it/s][5/6] extract embeddings:  46%|████▌     | 34/74 [00:02<00:01, 25.12it/s][5/6] extract embeddings:  50%|█████     | 37/74 [00:02<00:01, 24.07it/s][5/6] extract embeddings:  54%|█████▍    | 40/74 [00:02<00:01, 24.92it/s][5/6] extract embeddings:  58%|█████▊    | 43/74 [00:02<00:01, 25.44it/s][5/6] extract embeddings:  62%|██████▏   | 46/74 [00:02<00:01, 26.11it/s][5/6] extract embeddings:  66%|██████▌   | 49/74 [00:02<00:00, 25.76it/s][5/6] extract embeddings:  70%|███████   | 52/74 [00:03<00:00, 25.25it/s][5/6] extract embeddings:  74%|███████▍  | 55/74 [00:03<00:00, 26.21it/s][5/6] extract embeddings:  78%|███████▊  | 58/74 [00:03<00:00, 25.85it/s][5/6] extract embeddings:  82%|████████▏ | 61/74 [00:03<00:00, 26.26it/s][5/6] extract embeddings:  86%|████████▋ | 64/74 [00:03<00:00, 26.31it/s][5/6] extract embeddings:  91%|█████████ | 67/74 [00:03<00:00, 26.34it/s][5/6] extract embeddings:  95%|█████████▍| 70/74 [00:03<00:00, 26.31it/s][5/6] extract embeddings:  99%|█████████▊| 73/74 [00:03<00:00, 26.45it/s][5/6] extract embeddings: 100%|██████████| 74/74 [00:03<00:00, 18.82it/s]
[NeMo I 2025-04-17 01:30:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:30:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:30:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:30:59 collections:880] Dataset successfully loaded with 9462 items and total duration provided from manifest is  1.25 hours.
[NeMo I 2025-04-17 01:30:59 collections:886] # 9462 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/148 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/148 [00:01<03:01,  1.23s/it][6/6] extract embeddings:   3%|▎         | 5/148 [00:01<00:29,  4.84it/s][6/6] extract embeddings:   6%|▌         | 9/148 [00:01<00:15,  9.11it/s][6/6] extract embeddings:   9%|▉         | 13/148 [00:01<00:10, 13.25it/s][6/6] extract embeddings:  11%|█▏        | 17/148 [00:01<00:07, 17.20it/s][6/6] extract embeddings:  14%|█▍        | 21/148 [00:01<00:06, 20.46it/s][6/6] extract embeddings:  17%|█▋        | 25/148 [00:01<00:05, 23.12it/s][6/6] extract embeddings:  20%|█▉        | 29/148 [00:02<00:04, 25.86it/s][6/6] extract embeddings:  22%|██▏       | 33/148 [00:02<00:04, 27.44it/s][6/6] extract embeddings:  25%|██▌       | 37/148 [00:02<00:03, 28.41it/s][6/6] extract embeddings:  28%|██▊       | 41/148 [00:02<00:03, 28.32it/s][6/6] extract embeddings:  30%|███       | 45/148 [00:02<00:03, 29.71it/s][6/6] extract embeddings:  33%|███▎      | 49/148 [00:02<00:03, 30.69it/s][6/6] extract embeddings:  36%|███▌      | 53/148 [00:02<00:03, 30.18it/s][6/6] extract embeddings:  39%|███▊      | 57/148 [00:02<00:02, 31.18it/s][6/6] extract embeddings:  41%|████      | 61/148 [00:03<00:02, 31.81it/s][6/6] extract embeddings:  44%|████▍     | 65/148 [00:03<00:02, 31.48it/s][6/6] extract embeddings:  47%|████▋     | 69/148 [00:03<00:02, 30.48it/s][6/6] extract embeddings:  49%|████▉     | 73/148 [00:03<00:02, 30.23it/s][6/6] extract embeddings:  52%|█████▏    | 77/148 [00:03<00:02, 30.98it/s][6/6] extract embeddings:  55%|█████▍    | 81/148 [00:03<00:02, 31.70it/s][6/6] extract embeddings:  57%|█████▋    | 85/148 [00:03<00:01, 31.70it/s][6/6] extract embeddings:  60%|██████    | 89/148 [00:03<00:01, 32.25it/s][6/6] extract embeddings:  63%|██████▎   | 93/148 [00:04<00:01, 31.61it/s][6/6] extract embeddings:  66%|██████▌   | 97/148 [00:04<00:01, 32.71it/s][6/6] extract embeddings:  68%|██████▊   | 101/148 [00:04<00:01, 32.83it/s][6/6] extract embeddings:  71%|███████   | 105/148 [00:04<00:01, 31.85it/s][6/6] extract embeddings:  74%|███████▎  | 109/148 [00:04<00:01, 32.81it/s][6/6] extract embeddings:  76%|███████▋  | 113/148 [00:04<00:01, 32.43it/s][6/6] extract embeddings:  79%|███████▉  | 117/148 [00:04<00:00, 32.94it/s][6/6] extract embeddings:  82%|████████▏ | 121/148 [00:04<00:00, 33.06it/s][6/6] extract embeddings:  84%|████████▍ | 125/148 [00:05<00:00, 33.21it/s][6/6] extract embeddings:  87%|████████▋ | 129/148 [00:05<00:00, 33.22it/s][6/6] extract embeddings:  90%|████████▉ | 133/148 [00:05<00:00, 33.62it/s][6/6] extract embeddings:  93%|█████████▎| 137/148 [00:05<00:00, 33.21it/s][6/6] extract embeddings:  95%|█████████▌| 141/148 [00:05<00:00, 32.92it/s][6/6] extract embeddings:  98%|█████████▊| 145/148 [00:05<00:00, 32.26it/s][6/6] extract embeddings: 100%|██████████| 148/148 [00:05<00:00, 25.40it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.16it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.89it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.47it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.65it/s]
[NeMo I 2025-04-17 01:31:06 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:31:08 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              54.848861   444.120  ...  16.045037  3.612771
    Harker-ES                       47.856218  2178.782  ...  35.576214  1.632849
    Harker-MN                       55.046965   366.767  ...  28.189874  7.686044
    Longfellow-Block-1              43.757010   492.417  ...   9.134976  1.855130
    TOTAL                           48.925802  3482.086  ...  88.946101  2.554391
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:31:08 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0516 | MISS: 0.4122 | CER: 0.0255 | DER: 0.4893 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.25
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.25 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.75s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:31:19 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:31:19 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:31:19 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:31:19 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:31:19 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:31:20 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:31:20 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:31:20 features:305] PADDING: 16
[NeMo I 2025-04-17 01:31:20 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:31:20 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:31:20 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:31:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:31:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:31:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:31:20 collections:880] Dataset successfully loaded with 2037 items and total duration provided from manifest is  0.79 hours.
[NeMo I 2025-04-17 01:31:20 collections:886] # 2037 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:05,  2.10s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.35it/s][1/6] extract embeddings:  19%|█▉        | 6/32 [00:02<00:06,  3.81it/s][1/6] extract embeddings:  25%|██▌       | 8/32 [00:02<00:04,  5.53it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.24it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01, 10.09it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.75it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 13.87it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:03<00:00, 15.81it/s][1/6] extract embeddings:  75%|███████▌  | 24/32 [00:03<00:00, 15.93it/s][1/6] extract embeddings:  81%|████████▏ | 26/32 [00:03<00:00, 16.51it/s][1/6] extract embeddings:  91%|█████████ | 29/32 [00:03<00:00, 17.58it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 17.93it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  8.72it/s]
[NeMo I 2025-04-17 01:31:24 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:31:24 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:31:24 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:31:24 collections:880] Dataset successfully loaded with 2210 items and total duration provided from manifest is  0.83 hours.
[NeMo I 2025-04-17 01:31:24 collections:886] # 2210 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:47,  1.41s/it][2/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:09,  3.25it/s][2/6] extract embeddings:  20%|██        | 7/35 [00:01<00:04,  5.93it/s][2/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02,  8.57it/s][2/6] extract embeddings:  34%|███▍      | 12/35 [00:01<00:02, 10.12it/s][2/6] extract embeddings:  43%|████▎     | 15/35 [00:02<00:01, 12.91it/s][2/6] extract embeddings:  51%|█████▏    | 18/35 [00:02<00:01, 15.00it/s][2/6] extract embeddings:  60%|██████    | 21/35 [00:02<00:00, 17.06it/s][2/6] extract embeddings:  69%|██████▊   | 24/35 [00:02<00:00, 17.95it/s][2/6] extract embeddings:  77%|███████▋  | 27/35 [00:02<00:00, 18.84it/s][2/6] extract embeddings:  86%|████████▌ | 30/35 [00:02<00:00, 18.81it/s][2/6] extract embeddings:  94%|█████████▍| 33/35 [00:02<00:00, 19.67it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 11.43it/s]
[NeMo I 2025-04-17 01:31:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:31:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:31:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:31:28 collections:880] Dataset successfully loaded with 2497 items and total duration provided from manifest is  0.87 hours.
[NeMo I 2025-04-17 01:31:28 collections:886] # 2497 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:44,  1.14s/it][3/6] extract embeddings:  10%|█         | 4/40 [00:01<00:09,  3.93it/s][3/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:04,  6.97it/s][3/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  8.84it/s][3/6] extract embeddings:  30%|███       | 12/40 [00:01<00:02, 11.57it/s][3/6] extract embeddings:  38%|███▊      | 15/40 [00:01<00:01, 13.93it/s][3/6] extract embeddings:  45%|████▌     | 18/40 [00:01<00:01, 16.17it/s][3/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 17.93it/s][3/6] extract embeddings:  60%|██████    | 24/40 [00:02<00:00, 19.24it/s][3/6] extract embeddings:  68%|██████▊   | 27/40 [00:02<00:00, 20.17it/s][3/6] extract embeddings:  75%|███████▌  | 30/40 [00:02<00:00, 20.03it/s][3/6] extract embeddings:  82%|████████▎ | 33/40 [00:02<00:00, 19.46it/s][3/6] extract embeddings:  90%|█████████ | 36/40 [00:02<00:00, 19.88it/s][3/6] extract embeddings:  98%|█████████▊| 39/40 [00:02<00:00, 20.45it/s][3/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 13.24it/s]
[NeMo I 2025-04-17 01:31:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:31:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:31:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:31:31 collections:880] Dataset successfully loaded with 3075 items and total duration provided from manifest is  0.93 hours.
[NeMo I 2025-04-17 01:31:31 collections:886] # 3075 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/49 [00:01<00:58,  1.22s/it][4/6] extract embeddings:   8%|▊         | 4/49 [00:01<00:11,  3.78it/s][4/6] extract embeddings:  14%|█▍        | 7/49 [00:01<00:06,  6.89it/s][4/6] extract embeddings:  20%|██        | 10/49 [00:01<00:03,  9.88it/s][4/6] extract embeddings:  27%|██▋       | 13/49 [00:01<00:02, 12.43it/s][4/6] extract embeddings:  33%|███▎      | 16/49 [00:01<00:02, 14.39it/s][4/6] extract embeddings:  39%|███▉      | 19/49 [00:02<00:01, 16.35it/s][4/6] extract embeddings:  45%|████▍     | 22/49 [00:02<00:01, 18.64it/s][4/6] extract embeddings:  51%|█████     | 25/49 [00:02<00:01, 19.60it/s][4/6] extract embeddings:  57%|█████▋    | 28/49 [00:02<00:01, 20.64it/s][4/6] extract embeddings:  63%|██████▎   | 31/49 [00:02<00:00, 21.07it/s][4/6] extract embeddings:  69%|██████▉   | 34/49 [00:02<00:00, 20.69it/s][4/6] extract embeddings:  76%|███████▌  | 37/49 [00:02<00:00, 21.55it/s][4/6] extract embeddings:  82%|████████▏ | 40/49 [00:02<00:00, 21.93it/s][4/6] extract embeddings:  88%|████████▊ | 43/49 [00:03<00:00, 22.72it/s][4/6] extract embeddings:  94%|█████████▍| 46/49 [00:03<00:00, 22.13it/s][4/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 22.17it/s][4/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 14.53it/s]
[NeMo I 2025-04-17 01:31:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:31:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:31:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:31:34 collections:880] Dataset successfully loaded with 4343 items and total duration provided from manifest is  1.01 hours.
[NeMo I 2025-04-17 01:31:34 collections:886] # 4343 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/68 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/68 [00:01<01:17,  1.15s/it][5/6] extract embeddings:   6%|▌         | 4/68 [00:01<00:15,  4.06it/s][5/6] extract embeddings:  10%|█         | 7/68 [00:01<00:08,  7.37it/s][5/6] extract embeddings:  15%|█▍        | 10/68 [00:01<00:05, 10.83it/s][5/6] extract embeddings:  19%|█▉        | 13/68 [00:01<00:03, 13.88it/s][5/6] extract embeddings:  24%|██▎       | 16/68 [00:01<00:03, 16.98it/s][5/6] extract embeddings:  28%|██▊       | 19/68 [00:01<00:02, 19.10it/s][5/6] extract embeddings:  32%|███▏      | 22/68 [00:01<00:02, 20.64it/s][5/6] extract embeddings:  37%|███▋      | 25/68 [00:02<00:01, 22.23it/s][5/6] extract embeddings:  41%|████      | 28/68 [00:02<00:01, 23.79it/s][5/6] extract embeddings:  46%|████▌     | 31/68 [00:02<00:01, 25.14it/s][5/6] extract embeddings:  50%|█████     | 34/68 [00:02<00:01, 25.36it/s][5/6] extract embeddings:  54%|█████▍    | 37/68 [00:02<00:01, 25.45it/s][5/6] extract embeddings:  59%|█████▉    | 40/68 [00:02<00:01, 24.17it/s][5/6] extract embeddings:  65%|██████▍   | 44/68 [00:02<00:00, 25.60it/s][5/6] extract embeddings:  69%|██████▉   | 47/68 [00:02<00:00, 26.26it/s][5/6] extract embeddings:  74%|███████▎  | 50/68 [00:03<00:00, 25.89it/s][5/6] extract embeddings:  78%|███████▊  | 53/68 [00:03<00:00, 26.30it/s][5/6] extract embeddings:  82%|████████▏ | 56/68 [00:03<00:00, 26.17it/s][5/6] extract embeddings:  87%|████████▋ | 59/68 [00:03<00:00, 25.81it/s][5/6] extract embeddings:  91%|█████████ | 62/68 [00:03<00:00, 26.21it/s][5/6] extract embeddings:  96%|█████████▌| 65/68 [00:03<00:00, 26.40it/s][5/6] extract embeddings: 100%|██████████| 68/68 [00:03<00:00, 18.37it/s]
[NeMo I 2025-04-17 01:31:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:31:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:31:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:31:38 collections:880] Dataset successfully loaded with 8657 items and total duration provided from manifest is  1.13 hours.
[NeMo I 2025-04-17 01:31:38 collections:886] # 8657 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/136 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/136 [00:01<02:48,  1.25s/it][6/6] extract embeddings:   4%|▎         | 5/136 [00:01<00:27,  4.78it/s][6/6] extract embeddings:   6%|▌         | 8/136 [00:01<00:16,  7.97it/s][6/6] extract embeddings:   9%|▉         | 12/136 [00:01<00:09, 12.51it/s][6/6] extract embeddings:  12%|█▏        | 16/136 [00:01<00:07, 17.04it/s][6/6] extract embeddings:  15%|█▍        | 20/136 [00:01<00:05, 20.18it/s][6/6] extract embeddings:  18%|█▊        | 24/136 [00:01<00:04, 23.05it/s][6/6] extract embeddings:  21%|██        | 28/136 [00:02<00:04, 25.66it/s][6/6] extract embeddings:  24%|██▎       | 32/136 [00:02<00:03, 27.59it/s][6/6] extract embeddings:  26%|██▋       | 36/136 [00:02<00:03, 29.90it/s][6/6] extract embeddings:  29%|██▉       | 40/136 [00:02<00:03, 30.45it/s][6/6] extract embeddings:  32%|███▏      | 44/136 [00:02<00:02, 30.76it/s][6/6] extract embeddings:  35%|███▌      | 48/136 [00:02<00:02, 30.62it/s][6/6] extract embeddings:  38%|███▊      | 52/136 [00:02<00:02, 31.10it/s][6/6] extract embeddings:  41%|████      | 56/136 [00:02<00:02, 32.13it/s][6/6] extract embeddings:  44%|████▍     | 60/136 [00:03<00:02, 30.96it/s][6/6] extract embeddings:  47%|████▋     | 64/136 [00:03<00:02, 31.27it/s][6/6] extract embeddings:  50%|█████     | 68/136 [00:03<00:02, 30.99it/s][6/6] extract embeddings:  53%|█████▎    | 72/136 [00:03<00:02, 31.87it/s][6/6] extract embeddings:  56%|█████▌    | 76/136 [00:03<00:01, 32.69it/s][6/6] extract embeddings:  59%|█████▉    | 80/136 [00:03<00:01, 33.59it/s][6/6] extract embeddings:  62%|██████▏   | 84/136 [00:03<00:01, 33.33it/s][6/6] extract embeddings:  65%|██████▍   | 88/136 [00:03<00:01, 33.57it/s][6/6] extract embeddings:  68%|██████▊   | 92/136 [00:04<00:01, 33.73it/s][6/6] extract embeddings:  71%|███████   | 96/136 [00:04<00:01, 33.60it/s][6/6] extract embeddings:  74%|███████▎  | 100/136 [00:04<00:01, 33.53it/s][6/6] extract embeddings:  76%|███████▋  | 104/136 [00:04<00:00, 33.80it/s][6/6] extract embeddings:  79%|███████▉  | 108/136 [00:04<00:00, 33.00it/s][6/6] extract embeddings:  82%|████████▏ | 112/136 [00:04<00:00, 32.90it/s][6/6] extract embeddings:  85%|████████▌ | 116/136 [00:04<00:00, 32.53it/s][6/6] extract embeddings:  88%|████████▊ | 120/136 [00:04<00:00, 32.98it/s][6/6] extract embeddings:  91%|█████████ | 124/136 [00:04<00:00, 33.13it/s][6/6] extract embeddings:  94%|█████████▍| 128/136 [00:05<00:00, 33.23it/s][6/6] extract embeddings:  97%|█████████▋| 132/136 [00:05<00:00, 33.61it/s][6/6] extract embeddings: 100%|██████████| 136/136 [00:05<00:00, 34.57it/s][6/6] extract embeddings: 100%|██████████| 136/136 [00:05<00:00, 25.36it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.17it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.09it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.66it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s]
[NeMo I 2025-04-17 01:31:45 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:31:46 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              57.133103   444.120  ...  15.130015  3.406740
    Harker-ES                       52.055707  2178.782  ...  33.505019  1.537787
    Harker-MN                       57.374071   366.767  ...  29.547906  8.056315
    Longfellow-Block-1              47.711443   492.417  ...   9.805004  1.991199
    TOTAL                           52.649140  3482.086  ...  87.987944  2.526875
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:31:46 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0455 | MISS: 0.4557 | CER: 0.0253 | DER: 0.5265 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.35, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.35, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.76s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.94s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:31:58 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:31:58 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:31:58 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:31:58 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:31:58 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:31:58 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:31:58 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:31:58 features:305] PADDING: 16
[NeMo I 2025-04-17 01:31:59 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:31:59 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:31:59 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:31:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:31:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:31:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:31:59 collections:880] Dataset successfully loaded with 2169 items and total duration provided from manifest is  1.20 hours.
[NeMo I 2025-04-17 01:31:59 collections:886] # 2169 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:01<01:05,  2.00s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.43it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.88it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.52it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.25it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  8.85it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.50it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 12.06it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 13.05it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:01, 13.74it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 14.93it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 10.55it/s][1/6] extract embeddings:  79%|███████▉  | 27/34 [00:03<00:00, 13.62it/s][1/6] extract embeddings:  85%|████████▌ | 29/34 [00:03<00:00, 14.41it/s][1/6] extract embeddings:  91%|█████████ | 31/34 [00:03<00:00, 14.79it/s][1/6] extract embeddings:  97%|█████████▋| 33/34 [00:03<00:00, 15.27it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:04<00:00,  8.35it/s]
[NeMo I 2025-04-17 01:32:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:32:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:03 collections:880] Dataset successfully loaded with 2486 items and total duration provided from manifest is  1.25 hours.
[NeMo I 2025-04-17 01:32:03 collections:886] # 2486 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:53,  1.39s/it][2/6] extract embeddings:  10%|█         | 4/39 [00:01<00:10,  3.26it/s][2/6] extract embeddings:  15%|█▌        | 6/39 [00:01<00:06,  4.99it/s][2/6] extract embeddings:  21%|██        | 8/39 [00:01<00:04,  6.95it/s][2/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:03,  8.97it/s][2/6] extract embeddings:  31%|███       | 12/39 [00:02<00:02, 10.33it/s][2/6] extract embeddings:  36%|███▌      | 14/39 [00:02<00:02, 12.05it/s][2/6] extract embeddings:  41%|████      | 16/39 [00:02<00:01, 13.71it/s][2/6] extract embeddings:  46%|████▌     | 18/39 [00:02<00:01, 14.73it/s][2/6] extract embeddings:  54%|█████▍    | 21/39 [00:02<00:01, 16.58it/s][2/6] extract embeddings:  59%|█████▉    | 23/39 [00:02<00:00, 16.45it/s][2/6] extract embeddings:  64%|██████▍   | 25/39 [00:02<00:00, 16.55it/s][2/6] extract embeddings:  69%|██████▉   | 27/39 [00:02<00:00, 16.57it/s][2/6] extract embeddings:  74%|███████▍  | 29/39 [00:02<00:00, 16.83it/s][2/6] extract embeddings:  79%|███████▉  | 31/39 [00:03<00:00, 16.64it/s][2/6] extract embeddings:  85%|████████▍ | 33/39 [00:03<00:00, 16.66it/s][2/6] extract embeddings:  90%|████████▉ | 35/39 [00:03<00:00, 16.29it/s][2/6] extract embeddings:  95%|█████████▍| 37/39 [00:03<00:00, 16.07it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:03<00:00, 10.83it/s]
[NeMo I 2025-04-17 01:32:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:32:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:07 collections:880] Dataset successfully loaded with 2994 items and total duration provided from manifest is  1.32 hours.
[NeMo I 2025-04-17 01:32:07 collections:886] # 2994 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:53,  1.15s/it][3/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:11,  3.90it/s][3/6] extract embeddings:  13%|█▎        | 6/47 [00:01<00:06,  5.95it/s][3/6] extract embeddings:  19%|█▉        | 9/47 [00:01<00:04,  9.05it/s][3/6] extract embeddings:  26%|██▌       | 12/47 [00:01<00:02, 11.71it/s][3/6] extract embeddings:  30%|██▉       | 14/47 [00:01<00:02, 13.21it/s][3/6] extract embeddings:  34%|███▍      | 16/47 [00:01<00:02, 14.50it/s][3/6] extract embeddings:  40%|████      | 19/47 [00:02<00:01, 16.24it/s][3/6] extract embeddings:  47%|████▋     | 22/47 [00:02<00:01, 17.73it/s][3/6] extract embeddings:  53%|█████▎    | 25/47 [00:02<00:01, 18.32it/s][3/6] extract embeddings:  57%|█████▋    | 27/47 [00:02<00:01, 18.33it/s][3/6] extract embeddings:  62%|██████▏   | 29/47 [00:02<00:01, 17.79it/s][3/6] extract embeddings:  68%|██████▊   | 32/47 [00:02<00:00, 18.43it/s][3/6] extract embeddings:  72%|███████▏  | 34/47 [00:02<00:00, 18.51it/s][3/6] extract embeddings:  77%|███████▋  | 36/47 [00:02<00:00, 18.25it/s][3/6] extract embeddings:  81%|████████  | 38/47 [00:03<00:00, 18.66it/s][3/6] extract embeddings:  85%|████████▌ | 40/47 [00:03<00:00, 18.41it/s][3/6] extract embeddings:  91%|█████████▏| 43/47 [00:03<00:00, 18.93it/s][3/6] extract embeddings:  96%|█████████▌| 45/47 [00:03<00:00, 18.91it/s][3/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 13.28it/s]
[NeMo I 2025-04-17 01:32:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:32:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:11 collections:880] Dataset successfully loaded with 3891 items and total duration provided from manifest is  1.39 hours.
[NeMo I 2025-04-17 01:32:11 collections:886] # 3891 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/61 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/61 [00:01<01:12,  1.21s/it][4/6] extract embeddings:   7%|▋         | 4/61 [00:01<00:15,  3.74it/s][4/6] extract embeddings:  10%|▉         | 6/61 [00:01<00:09,  5.79it/s][4/6] extract embeddings:  15%|█▍        | 9/61 [00:01<00:05,  9.00it/s][4/6] extract embeddings:  20%|█▉        | 12/61 [00:01<00:04, 12.10it/s][4/6] extract embeddings:  25%|██▍       | 15/61 [00:01<00:03, 14.34it/s][4/6] extract embeddings:  30%|██▉       | 18/61 [00:02<00:02, 15.87it/s][4/6] extract embeddings:  34%|███▍      | 21/61 [00:02<00:02, 17.42it/s][4/6] extract embeddings:  39%|███▉      | 24/61 [00:02<00:01, 18.66it/s][4/6] extract embeddings:  44%|████▍     | 27/61 [00:02<00:01, 19.96it/s][4/6] extract embeddings:  49%|████▉     | 30/61 [00:02<00:01, 20.37it/s][4/6] extract embeddings:  54%|█████▍    | 33/61 [00:02<00:01, 21.10it/s][4/6] extract embeddings:  59%|█████▉    | 36/61 [00:02<00:01, 21.47it/s][4/6] extract embeddings:  64%|██████▍   | 39/61 [00:02<00:01, 21.95it/s][4/6] extract embeddings:  69%|██████▉   | 42/61 [00:03<00:00, 22.10it/s][4/6] extract embeddings:  74%|███████▍  | 45/61 [00:03<00:00, 21.70it/s][4/6] extract embeddings:  79%|███████▊  | 48/61 [00:03<00:00, 21.34it/s][4/6] extract embeddings:  84%|████████▎ | 51/61 [00:03<00:00, 21.11it/s][4/6] extract embeddings:  89%|████████▊ | 54/61 [00:03<00:00, 21.52it/s][4/6] extract embeddings:  93%|█████████▎| 57/61 [00:03<00:00, 21.63it/s][4/6] extract embeddings:  98%|█████████▊| 60/61 [00:03<00:00, 22.00it/s][4/6] extract embeddings: 100%|██████████| 61/61 [00:04<00:00, 15.25it/s]
[NeMo I 2025-04-17 01:32:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:32:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:15 collections:880] Dataset successfully loaded with 5795 items and total duration provided from manifest is  1.47 hours.
[NeMo I 2025-04-17 01:32:15 collections:886] # 5795 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/91 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/91 [00:01<01:43,  1.15s/it][5/6] extract embeddings:   4%|▍         | 4/91 [00:01<00:21,  3.96it/s][5/6] extract embeddings:   8%|▊         | 7/91 [00:01<00:11,  7.37it/s][5/6] extract embeddings:  11%|█         | 10/91 [00:01<00:07, 10.82it/s][5/6] extract embeddings:  14%|█▍        | 13/91 [00:01<00:05, 14.25it/s][5/6] extract embeddings:  18%|█▊        | 16/91 [00:01<00:04, 16.95it/s][5/6] extract embeddings:  21%|██        | 19/91 [00:01<00:03, 19.00it/s][5/6] extract embeddings:  24%|██▍       | 22/91 [00:01<00:03, 20.33it/s][5/6] extract embeddings:  27%|██▋       | 25/91 [00:02<00:03, 21.72it/s][5/6] extract embeddings:  31%|███       | 28/91 [00:02<00:02, 22.05it/s][5/6] extract embeddings:  34%|███▍      | 31/91 [00:02<00:02, 23.43it/s][5/6] extract embeddings:  37%|███▋      | 34/91 [00:02<00:02, 23.37it/s][5/6] extract embeddings:  41%|████      | 37/91 [00:02<00:02, 24.13it/s][5/6] extract embeddings:  44%|████▍     | 40/91 [00:02<00:02, 24.47it/s][5/6] extract embeddings:  47%|████▋     | 43/91 [00:02<00:01, 24.39it/s][5/6] extract embeddings:  51%|█████     | 46/91 [00:02<00:01, 24.69it/s][5/6] extract embeddings:  54%|█████▍    | 49/91 [00:03<00:01, 25.48it/s][5/6] extract embeddings:  57%|█████▋    | 52/91 [00:03<00:01, 25.74it/s][5/6] extract embeddings:  60%|██████    | 55/91 [00:03<00:01, 25.75it/s][5/6] extract embeddings:  64%|██████▎   | 58/91 [00:03<00:01, 26.13it/s][5/6] extract embeddings:  67%|██████▋   | 61/91 [00:03<00:01, 25.46it/s][5/6] extract embeddings:  70%|███████   | 64/91 [00:03<00:01, 25.20it/s][5/6] extract embeddings:  74%|███████▎  | 67/91 [00:03<00:00, 25.53it/s][5/6] extract embeddings:  77%|███████▋  | 70/91 [00:03<00:00, 25.70it/s][5/6] extract embeddings:  80%|████████  | 73/91 [00:03<00:00, 26.26it/s][5/6] extract embeddings:  84%|████████▎ | 76/91 [00:04<00:00, 25.76it/s][5/6] extract embeddings:  87%|████████▋ | 79/91 [00:04<00:00, 26.04it/s][5/6] extract embeddings:  90%|█████████ | 82/91 [00:04<00:00, 26.06it/s][5/6] extract embeddings:  93%|█████████▎| 85/91 [00:04<00:00, 25.68it/s][5/6] extract embeddings:  97%|█████████▋| 88/91 [00:04<00:00, 25.78it/s][5/6] extract embeddings: 100%|██████████| 91/91 [00:04<00:00, 19.52it/s]
[NeMo I 2025-04-17 01:32:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:32:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:20 collections:880] Dataset successfully loaded with 11782 items and total duration provided from manifest is  1.58 hours.
[NeMo I 2025-04-17 01:32:20 collections:886] # 11782 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/185 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/185 [00:01<04:08,  1.35s/it][6/6] extract embeddings:   3%|▎         | 5/185 [00:01<00:40,  4.41it/s][6/6] extract embeddings:   4%|▍         | 8/185 [00:01<00:23,  7.39it/s][6/6] extract embeddings:   6%|▋         | 12/185 [00:01<00:14, 11.79it/s][6/6] extract embeddings:   9%|▊         | 16/185 [00:01<00:10, 15.83it/s][6/6] extract embeddings:  11%|█         | 20/185 [00:01<00:08, 19.60it/s][6/6] extract embeddings:  13%|█▎        | 24/185 [00:02<00:07, 22.74it/s][6/6] extract embeddings:  15%|█▌        | 28/185 [00:02<00:06, 25.14it/s][6/6] extract embeddings:  17%|█▋        | 32/185 [00:02<00:05, 27.54it/s][6/6] extract embeddings:  19%|█▉        | 36/185 [00:02<00:05, 28.91it/s][6/6] extract embeddings:  22%|██▏       | 40/185 [00:02<00:04, 30.29it/s][6/6] extract embeddings:  24%|██▍       | 44/185 [00:02<00:04, 30.60it/s][6/6] extract embeddings:  26%|██▌       | 48/185 [00:02<00:04, 30.86it/s][6/6] extract embeddings:  28%|██▊       | 52/185 [00:02<00:04, 31.50it/s][6/6] extract embeddings:  30%|███       | 56/185 [00:03<00:04, 31.86it/s][6/6] extract embeddings:  32%|███▏      | 60/185 [00:03<00:03, 32.15it/s][6/6] extract embeddings:  35%|███▍      | 64/185 [00:03<00:03, 31.11it/s][6/6] extract embeddings:  37%|███▋      | 68/185 [00:03<00:03, 31.36it/s][6/6] extract embeddings:  39%|███▉      | 72/185 [00:03<00:03, 31.36it/s][6/6] extract embeddings:  41%|████      | 76/185 [00:03<00:03, 32.29it/s][6/6] extract embeddings:  43%|████▎     | 80/185 [00:03<00:03, 32.68it/s][6/6] extract embeddings:  45%|████▌     | 84/185 [00:03<00:03, 33.55it/s][6/6] extract embeddings:  48%|████▊     | 88/185 [00:04<00:02, 32.35it/s][6/6] extract embeddings:  50%|████▉     | 92/185 [00:04<00:02, 31.70it/s][6/6] extract embeddings:  52%|█████▏    | 96/185 [00:04<00:02, 32.09it/s][6/6] extract embeddings:  54%|█████▍    | 100/185 [00:04<00:02, 33.26it/s][6/6] extract embeddings:  56%|█████▌    | 104/185 [00:04<00:02, 32.23it/s][6/6] extract embeddings:  58%|█████▊    | 108/185 [00:04<00:02, 31.70it/s][6/6] extract embeddings:  61%|██████    | 112/185 [00:04<00:02, 31.94it/s][6/6] extract embeddings:  63%|██████▎   | 116/185 [00:04<00:02, 32.54it/s][6/6] extract embeddings:  65%|██████▍   | 120/185 [00:05<00:01, 32.50it/s][6/6] extract embeddings:  67%|██████▋   | 124/185 [00:05<00:01, 31.31it/s][6/6] extract embeddings:  69%|██████▉   | 128/185 [00:05<00:01, 31.54it/s][6/6] extract embeddings:  71%|███████▏  | 132/185 [00:05<00:01, 31.38it/s][6/6] extract embeddings:  74%|███████▎  | 136/185 [00:05<00:01, 32.48it/s][6/6] extract embeddings:  76%|███████▌  | 140/185 [00:05<00:01, 31.97it/s][6/6] extract embeddings:  78%|███████▊  | 144/185 [00:05<00:01, 32.20it/s][6/6] extract embeddings:  80%|████████  | 148/185 [00:05<00:01, 33.06it/s][6/6] extract embeddings:  82%|████████▏ | 152/185 [00:06<00:00, 33.11it/s][6/6] extract embeddings:  84%|████████▍ | 156/185 [00:06<00:00, 33.98it/s][6/6] extract embeddings:  86%|████████▋ | 160/185 [00:06<00:00, 32.87it/s][6/6] extract embeddings:  89%|████████▊ | 164/185 [00:06<00:00, 33.39it/s][6/6] extract embeddings:  91%|█████████ | 168/185 [00:06<00:00, 32.30it/s][6/6] extract embeddings:  93%|█████████▎| 172/185 [00:06<00:00, 32.46it/s][6/6] extract embeddings:  95%|█████████▌| 176/185 [00:06<00:00, 32.78it/s][6/6] extract embeddings:  97%|█████████▋| 180/185 [00:06<00:00, 33.13it/s][6/6] extract embeddings:  99%|█████████▉| 184/185 [00:06<00:00, 32.46it/s][6/6] extract embeddings: 100%|██████████| 185/185 [00:07<00:00, 26.25it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.25it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.58it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.23it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.45it/s]
[NeMo I 2025-04-17 01:32:29 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:32:30 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              45.890802   444.120  ...   16.240022  3.656674
    Harker-ES                       37.681411  2178.782  ...   57.149478  2.623001
    Harker-MN                       47.103254   366.767  ...   26.527025  7.232664
    Longfellow-Block-1              32.671036   492.417  ...    9.428957  1.914832
    TOTAL                           39.012332  3482.086  ...  109.345482  3.140229
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:32:30 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0680 | MISS: 0.2907 | CER: 0.0314 | DER: 0.3901 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.40, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.4, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.80s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:32:42 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:32:42 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:32:42 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:32:42 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:32:42 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:32:42 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:32:42 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:32:42 features:305] PADDING: 16
[NeMo I 2025-04-17 01:32:43 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:32:43 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:32:43 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:32:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:32:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:43 collections:880] Dataset successfully loaded with 2161 items and total duration provided from manifest is  1.18 hours.
[NeMo I 2025-04-17 01:32:43 collections:886] # 2161 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:02<01:07,  2.03s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.41it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.80it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.50it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.11it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  8.71it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.16it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 11.86it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 13.14it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:01, 13.48it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 14.26it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 15.03it/s][1/6] extract embeddings:  76%|███████▋  | 26/34 [00:03<00:00, 15.40it/s][1/6] extract embeddings:  82%|████████▏ | 28/34 [00:03<00:00, 15.08it/s][1/6] extract embeddings:  88%|████████▊ | 30/34 [00:03<00:00, 15.63it/s][1/6] extract embeddings:  94%|█████████▍| 32/34 [00:03<00:00, 15.92it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:03<00:00,  8.52it/s]
[NeMo I 2025-04-17 01:32:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:32:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:47 collections:880] Dataset successfully loaded with 2473 items and total duration provided from manifest is  1.23 hours.
[NeMo I 2025-04-17 01:32:47 collections:886] # 2473 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:53,  1.40s/it][2/6] extract embeddings:   8%|▊         | 3/39 [00:01<00:14,  2.49it/s][2/6] extract embeddings:  13%|█▎        | 5/39 [00:01<00:07,  4.44it/s][2/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  6.58it/s][2/6] extract embeddings:  23%|██▎       | 9/39 [00:01<00:03,  8.60it/s][2/6] extract embeddings:  28%|██▊       | 11/39 [00:01<00:02, 10.68it/s][2/6] extract embeddings:  33%|███▎      | 13/39 [00:02<00:02, 12.50it/s][2/6] extract embeddings:  38%|███▊      | 15/39 [00:02<00:01, 13.50it/s][2/6] extract embeddings:  44%|████▎     | 17/39 [00:02<00:01, 14.99it/s][2/6] extract embeddings:  49%|████▊     | 19/39 [00:02<00:01, 15.45it/s][2/6] extract embeddings:  56%|█████▋    | 22/39 [00:02<00:00, 17.10it/s][2/6] extract embeddings:  62%|██████▏   | 24/39 [00:02<00:00, 16.77it/s][2/6] extract embeddings:  69%|██████▉   | 27/39 [00:02<00:00, 17.76it/s][2/6] extract embeddings:  74%|███████▍  | 29/39 [00:02<00:00, 17.51it/s][2/6] extract embeddings:  79%|███████▉  | 31/39 [00:03<00:00, 17.97it/s][2/6] extract embeddings:  85%|████████▍ | 33/39 [00:03<00:00, 17.56it/s][2/6] extract embeddings:  90%|████████▉ | 35/39 [00:03<00:00, 17.79it/s][2/6] extract embeddings:  95%|█████████▍| 37/39 [00:03<00:00, 18.03it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:03<00:00, 11.15it/s]
[NeMo I 2025-04-17 01:32:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:32:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:51 collections:880] Dataset successfully loaded with 2971 items and total duration provided from manifest is  1.29 hours.
[NeMo I 2025-04-17 01:32:51 collections:886] # 2971 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:53,  1.17s/it][3/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:11,  3.79it/s][3/6] extract embeddings:  13%|█▎        | 6/47 [00:01<00:07,  5.73it/s][3/6] extract embeddings:  19%|█▉        | 9/47 [00:01<00:04,  8.75it/s][3/6] extract embeddings:  26%|██▌       | 12/47 [00:01<00:03, 11.47it/s][3/6] extract embeddings:  30%|██▉       | 14/47 [00:01<00:02, 12.76it/s][3/6] extract embeddings:  34%|███▍      | 16/47 [00:01<00:02, 14.16it/s][3/6] extract embeddings:  38%|███▊      | 18/47 [00:02<00:01, 15.43it/s][3/6] extract embeddings:  45%|████▍     | 21/47 [00:02<00:01, 17.24it/s][3/6] extract embeddings:  49%|████▉     | 23/47 [00:02<00:01, 17.03it/s][3/6] extract embeddings:  55%|█████▌    | 26/47 [00:02<00:01, 17.91it/s][3/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:01, 17.80it/s][3/6] extract embeddings:  64%|██████▍   | 30/47 [00:02<00:00, 18.17it/s][3/6] extract embeddings:  70%|███████   | 33/47 [00:02<00:00, 19.06it/s][3/6] extract embeddings:  74%|███████▍  | 35/47 [00:02<00:00, 19.20it/s][3/6] extract embeddings:  79%|███████▊  | 37/47 [00:03<00:00, 19.19it/s][3/6] extract embeddings:  83%|████████▎ | 39/47 [00:03<00:00, 18.29it/s][3/6] extract embeddings:  87%|████████▋ | 41/47 [00:03<00:00, 18.40it/s][3/6] extract embeddings:  91%|█████████▏| 43/47 [00:03<00:00, 18.24it/s][3/6] extract embeddings:  96%|█████████▌| 45/47 [00:03<00:00, 18.13it/s][3/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 13.11it/s]
[NeMo I 2025-04-17 01:32:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:32:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:55 collections:880] Dataset successfully loaded with 3849 items and total duration provided from manifest is  1.36 hours.
[NeMo I 2025-04-17 01:32:55 collections:886] # 3849 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/61 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/61 [00:01<01:10,  1.17s/it][4/6] extract embeddings:   7%|▋         | 4/61 [00:01<00:14,  3.88it/s][4/6] extract embeddings:  10%|▉         | 6/61 [00:01<00:09,  5.97it/s][4/6] extract embeddings:  13%|█▎        | 8/61 [00:01<00:06,  8.04it/s][4/6] extract embeddings:  18%|█▊        | 11/61 [00:01<00:04, 11.41it/s][4/6] extract embeddings:  23%|██▎       | 14/61 [00:01<00:03, 14.29it/s][4/6] extract embeddings:  28%|██▊       | 17/61 [00:01<00:02, 15.99it/s][4/6] extract embeddings:  33%|███▎      | 20/61 [00:02<00:02, 17.76it/s][4/6] extract embeddings:  38%|███▊      | 23/61 [00:02<00:02, 18.66it/s][4/6] extract embeddings:  43%|████▎     | 26/61 [00:02<00:01, 19.92it/s][4/6] extract embeddings:  48%|████▊     | 29/61 [00:02<00:01, 19.86it/s][4/6] extract embeddings:  52%|█████▏    | 32/61 [00:02<00:01, 20.74it/s][4/6] extract embeddings:  57%|█████▋    | 35/61 [00:02<00:01, 21.63it/s][4/6] extract embeddings:  62%|██████▏   | 38/61 [00:02<00:01, 21.21it/s][4/6] extract embeddings:  67%|██████▋   | 41/61 [00:03<00:00, 22.03it/s][4/6] extract embeddings:  72%|███████▏  | 44/61 [00:03<00:00, 21.67it/s][4/6] extract embeddings:  77%|███████▋  | 47/61 [00:03<00:00, 22.09it/s][4/6] extract embeddings:  82%|████████▏ | 50/61 [00:03<00:00, 21.59it/s][4/6] extract embeddings:  87%|████████▋ | 53/61 [00:03<00:00, 21.25it/s][4/6] extract embeddings:  92%|█████████▏| 56/61 [00:03<00:00, 21.96it/s][4/6] extract embeddings:  97%|█████████▋| 59/61 [00:03<00:00, 22.18it/s][4/6] extract embeddings: 100%|██████████| 61/61 [00:03<00:00, 15.50it/s]
[NeMo I 2025-04-17 01:32:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:32:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:32:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:32:59 collections:880] Dataset successfully loaded with 5725 items and total duration provided from manifest is  1.45 hours.
[NeMo I 2025-04-17 01:32:59 collections:886] # 5725 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/90 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/90 [00:01<01:57,  1.32s/it][5/6] extract embeddings:   4%|▍         | 4/90 [00:01<00:23,  3.61it/s][5/6] extract embeddings:   8%|▊         | 7/90 [00:01<00:12,  6.77it/s][5/6] extract embeddings:  11%|█         | 10/90 [00:01<00:08,  9.94it/s][5/6] extract embeddings:  14%|█▍        | 13/90 [00:01<00:06, 12.53it/s][5/6] extract embeddings:  18%|█▊        | 16/90 [00:01<00:05, 14.61it/s][5/6] extract embeddings:  21%|██        | 19/90 [00:02<00:04, 17.06it/s][5/6] extract embeddings:  24%|██▍       | 22/90 [00:02<00:03, 19.33it/s][5/6] extract embeddings:  28%|██▊       | 25/90 [00:02<00:03, 20.61it/s][5/6] extract embeddings:  31%|███       | 28/90 [00:02<00:02, 22.41it/s][5/6] extract embeddings:  34%|███▍      | 31/90 [00:02<00:02, 23.02it/s][5/6] extract embeddings:  38%|███▊      | 34/90 [00:02<00:02, 23.50it/s][5/6] extract embeddings:  41%|████      | 37/90 [00:02<00:02, 23.53it/s][5/6] extract embeddings:  44%|████▍     | 40/90 [00:02<00:02, 24.71it/s][5/6] extract embeddings:  48%|████▊     | 43/90 [00:02<00:01, 24.46it/s][5/6] extract embeddings:  51%|█████     | 46/90 [00:03<00:01, 24.76it/s][5/6] extract embeddings:  54%|█████▍    | 49/90 [00:03<00:01, 24.98it/s][5/6] extract embeddings:  58%|█████▊    | 52/90 [00:03<00:01, 25.32it/s][5/6] extract embeddings:  61%|██████    | 55/90 [00:03<00:01, 24.92it/s][5/6] extract embeddings:  64%|██████▍   | 58/90 [00:03<00:01, 25.96it/s][5/6] extract embeddings:  68%|██████▊   | 61/90 [00:03<00:01, 25.83it/s][5/6] extract embeddings:  71%|███████   | 64/90 [00:03<00:01, 25.30it/s][5/6] extract embeddings:  74%|███████▍  | 67/90 [00:03<00:00, 25.83it/s][5/6] extract embeddings:  78%|███████▊  | 70/90 [00:04<00:00, 26.06it/s][5/6] extract embeddings:  81%|████████  | 73/90 [00:04<00:00, 26.03it/s][5/6] extract embeddings:  84%|████████▍ | 76/90 [00:04<00:00, 26.43it/s][5/6] extract embeddings:  88%|████████▊ | 79/90 [00:04<00:00, 26.61it/s][5/6] extract embeddings:  91%|█████████ | 82/90 [00:04<00:00, 26.10it/s][5/6] extract embeddings:  94%|█████████▍| 85/90 [00:04<00:00, 25.88it/s][5/6] extract embeddings:  98%|█████████▊| 88/90 [00:04<00:00, 24.83it/s][5/6] extract embeddings: 100%|██████████| 90/90 [00:04<00:00, 18.65it/s]
[NeMo I 2025-04-17 01:33:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:33:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:33:04 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:33:04 collections:880] Dataset successfully loaded with 11634 items and total duration provided from manifest is  1.56 hours.
[NeMo I 2025-04-17 01:33:04 collections:886] # 11634 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/182 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/182 [00:01<03:25,  1.13s/it][6/6] extract embeddings:   3%|▎         | 5/182 [00:01<00:33,  5.21it/s][6/6] extract embeddings:   5%|▍         | 9/182 [00:01<00:17,  9.68it/s][6/6] extract embeddings:   7%|▋         | 13/182 [00:01<00:11, 14.14it/s][6/6] extract embeddings:   9%|▉         | 17/182 [00:01<00:09, 18.16it/s][6/6] extract embeddings:  12%|█▏        | 21/182 [00:01<00:07, 21.55it/s][6/6] extract embeddings:  14%|█▎        | 25/182 [00:01<00:06, 25.08it/s][6/6] extract embeddings:  16%|█▌        | 29/182 [00:01<00:05, 27.39it/s][6/6] extract embeddings:  18%|█▊        | 33/182 [00:02<00:05, 28.27it/s][6/6] extract embeddings:  20%|██        | 37/182 [00:02<00:04, 29.52it/s][6/6] extract embeddings:  23%|██▎       | 41/182 [00:02<00:04, 29.25it/s][6/6] extract embeddings:  25%|██▍       | 45/182 [00:02<00:04, 30.59it/s][6/6] extract embeddings:  27%|██▋       | 49/182 [00:02<00:04, 29.93it/s][6/6] extract embeddings:  29%|██▉       | 53/182 [00:02<00:04, 29.68it/s][6/6] extract embeddings:  31%|███▏      | 57/182 [00:02<00:04, 29.63it/s][6/6] extract embeddings:  34%|███▎      | 61/182 [00:03<00:04, 29.87it/s][6/6] extract embeddings:  36%|███▌      | 65/182 [00:03<00:03, 30.08it/s][6/6] extract embeddings:  38%|███▊      | 69/182 [00:03<00:03, 31.28it/s][6/6] extract embeddings:  40%|████      | 73/182 [00:03<00:03, 30.85it/s][6/6] extract embeddings:  42%|████▏     | 77/182 [00:03<00:03, 30.60it/s][6/6] extract embeddings:  45%|████▍     | 81/182 [00:03<00:03, 31.96it/s][6/6] extract embeddings:  47%|████▋     | 85/182 [00:03<00:03, 31.99it/s][6/6] extract embeddings:  49%|████▉     | 89/182 [00:03<00:02, 32.66it/s][6/6] extract embeddings:  51%|█████     | 93/182 [00:03<00:02, 33.23it/s][6/6] extract embeddings:  53%|█████▎    | 97/182 [00:04<00:02, 32.24it/s][6/6] extract embeddings:  55%|█████▌    | 101/182 [00:04<00:02, 32.59it/s][6/6] extract embeddings:  58%|█████▊    | 105/182 [00:04<00:02, 33.58it/s][6/6] extract embeddings:  60%|█████▉    | 109/182 [00:04<00:02, 32.43it/s][6/6] extract embeddings:  62%|██████▏   | 113/182 [00:04<00:02, 32.39it/s][6/6] extract embeddings:  64%|██████▍   | 117/182 [00:04<00:01, 32.67it/s][6/6] extract embeddings:  66%|██████▋   | 121/182 [00:04<00:01, 32.54it/s][6/6] extract embeddings:  69%|██████▊   | 125/182 [00:04<00:01, 32.36it/s][6/6] extract embeddings:  71%|███████   | 129/182 [00:05<00:01, 32.08it/s][6/6] extract embeddings:  73%|███████▎  | 133/182 [00:05<00:01, 31.98it/s][6/6] extract embeddings:  75%|███████▌  | 137/182 [00:05<00:01, 31.94it/s][6/6] extract embeddings:  77%|███████▋  | 141/182 [00:05<00:01, 32.30it/s][6/6] extract embeddings:  80%|███████▉  | 145/182 [00:05<00:01, 32.02it/s][6/6] extract embeddings:  82%|████████▏ | 149/182 [00:05<00:01, 31.28it/s][6/6] extract embeddings:  84%|████████▍ | 153/182 [00:05<00:00, 30.54it/s][6/6] extract embeddings:  86%|████████▋ | 157/182 [00:05<00:00, 31.68it/s][6/6] extract embeddings:  88%|████████▊ | 161/182 [00:06<00:00, 31.56it/s][6/6] extract embeddings:  91%|█████████ | 165/182 [00:06<00:00, 31.72it/s][6/6] extract embeddings:  93%|█████████▎| 169/182 [00:06<00:00, 31.27it/s][6/6] extract embeddings:  95%|█████████▌| 173/182 [00:06<00:00, 30.61it/s][6/6] extract embeddings:  97%|█████████▋| 177/182 [00:06<00:00, 30.10it/s][6/6] extract embeddings:  99%|█████████▉| 181/182 [00:06<00:00, 30.91it/s][6/6] extract embeddings: 100%|██████████| 182/182 [00:06<00:00, 26.63it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.37it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.62it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.29it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.42it/s]
[NeMo I 2025-04-17 01:33:13 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:33:14 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              46.550565   444.120  ...   15.110047  3.402244
    Harker-ES                       38.061134  2178.782  ...   50.987792  2.340197
    Harker-MN                       48.746242   366.767  ...   29.914031  8.156140
    Longfellow-Block-1              33.323539   492.417  ...    8.828970  1.792987
    TOTAL                           39.599407  3482.086  ...  104.840842  3.010863
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:33:14 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0674 | MISS: 0.2985 | CER: 0.0301 | DER: 0.3960 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.45, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.45, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.83s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.95s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:33:26 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:33:26 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:33:26 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:33:26 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:33:26 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:33:26 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:33:26 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:33:26 features:305] PADDING: 16
[NeMo I 2025-04-17 01:33:26 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:33:26 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:33:26 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:33:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:33:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:33:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:33:26 collections:880] Dataset successfully loaded with 2148 items and total duration provided from manifest is  1.15 hours.
[NeMo I 2025-04-17 01:33:26 collections:886] # 2148 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:01<01:05,  1.98s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.48it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.94it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.63it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.26it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  8.75it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.28it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 11.70it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 13.19it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:01, 13.96it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 15.09it/s][1/6] extract embeddings:  71%|███████   | 24/34 [00:03<00:00, 15.79it/s][1/6] extract embeddings:  76%|███████▋  | 26/34 [00:03<00:00, 15.72it/s][1/6] extract embeddings:  82%|████████▏ | 28/34 [00:03<00:00, 16.10it/s][1/6] extract embeddings:  88%|████████▊ | 30/34 [00:03<00:00, 16.11it/s][1/6] extract embeddings:  94%|█████████▍| 32/34 [00:03<00:00, 16.81it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:03<00:00,  8.77it/s]
[NeMo I 2025-04-17 01:33:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:33:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:33:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:33:30 collections:880] Dataset successfully loaded with 2457 items and total duration provided from manifest is  1.20 hours.
[NeMo I 2025-04-17 01:33:30 collections:886] # 2457 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:53,  1.40s/it][2/6] extract embeddings:   8%|▊         | 3/39 [00:01<00:14,  2.49it/s][2/6] extract embeddings:  13%|█▎        | 5/39 [00:01<00:07,  4.36it/s][2/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  6.44it/s][2/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:03,  9.28it/s][2/6] extract embeddings:  31%|███       | 12/39 [00:02<00:02, 10.66it/s][2/6] extract embeddings:  36%|███▌      | 14/39 [00:02<00:02, 12.28it/s][2/6] extract embeddings:  41%|████      | 16/39 [00:02<00:01, 13.91it/s][2/6] extract embeddings:  46%|████▌     | 18/39 [00:02<00:01, 14.81it/s][2/6] extract embeddings:  51%|█████▏    | 20/39 [00:02<00:01, 15.77it/s][2/6] extract embeddings:  56%|█████▋    | 22/39 [00:02<00:01, 16.56it/s][2/6] extract embeddings:  62%|██████▏   | 24/39 [00:02<00:00, 16.48it/s][2/6] extract embeddings:  69%|██████▉   | 27/39 [00:02<00:00, 17.74it/s][2/6] extract embeddings:  74%|███████▍  | 29/39 [00:02<00:00, 17.82it/s][2/6] extract embeddings:  79%|███████▉  | 31/39 [00:03<00:00, 17.27it/s][2/6] extract embeddings:  85%|████████▍ | 33/39 [00:03<00:00, 16.42it/s][2/6] extract embeddings:  90%|████████▉ | 35/39 [00:03<00:00, 17.01it/s][2/6] extract embeddings:  97%|█████████▋| 38/39 [00:03<00:00, 18.07it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:03<00:00, 11.03it/s]
[NeMo I 2025-04-17 01:33:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:33:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:33:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:33:34 collections:880] Dataset successfully loaded with 2938 items and total duration provided from manifest is  1.26 hours.
[NeMo I 2025-04-17 01:33:34 collections:886] # 2938 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:53,  1.19s/it][3/6] extract embeddings:   7%|▋         | 3/46 [00:01<00:15,  2.86it/s][3/6] extract embeddings:  11%|█         | 5/46 [00:01<00:08,  5.10it/s][3/6] extract embeddings:  17%|█▋        | 8/46 [00:01<00:04,  8.44it/s][3/6] extract embeddings:  22%|██▏       | 10/46 [00:01<00:03, 10.34it/s][3/6] extract embeddings:  28%|██▊       | 13/46 [00:01<00:02, 12.83it/s][3/6] extract embeddings:  35%|███▍      | 16/46 [00:01<00:02, 14.51it/s][3/6] extract embeddings:  41%|████▏     | 19/46 [00:02<00:01, 16.41it/s][3/6] extract embeddings:  48%|████▊     | 22/46 [00:02<00:01, 17.56it/s][3/6] extract embeddings:  54%|█████▍    | 25/46 [00:02<00:01, 18.65it/s][3/6] extract embeddings:  61%|██████    | 28/46 [00:02<00:00, 19.01it/s][3/6] extract embeddings:  67%|██████▋   | 31/46 [00:02<00:00, 19.50it/s][3/6] extract embeddings:  74%|███████▍  | 34/46 [00:02<00:00, 19.93it/s][3/6] extract embeddings:  80%|████████  | 37/46 [00:02<00:00, 19.96it/s][3/6] extract embeddings:  87%|████████▋ | 40/46 [00:03<00:00, 18.89it/s][3/6] extract embeddings:  91%|█████████▏| 42/46 [00:03<00:00, 18.97it/s][3/6] extract embeddings:  98%|█████████▊| 45/46 [00:03<00:00, 19.00it/s][3/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 13.14it/s]
[NeMo I 2025-04-17 01:33:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:33:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:33:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:33:38 collections:880] Dataset successfully loaded with 3800 items and total duration provided from manifest is  1.33 hours.
[NeMo I 2025-04-17 01:33:38 collections:886] # 3800 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/60 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/60 [00:01<01:07,  1.14s/it][4/6] extract embeddings:   7%|▋         | 4/60 [00:01<00:14,  3.97it/s][4/6] extract embeddings:  10%|█         | 6/60 [00:01<00:08,  6.04it/s][4/6] extract embeddings:  15%|█▌        | 9/60 [00:01<00:05,  9.42it/s][4/6] extract embeddings:  20%|██        | 12/60 [00:01<00:03, 12.13it/s][4/6] extract embeddings:  25%|██▌       | 15/60 [00:01<00:03, 14.49it/s][4/6] extract embeddings:  30%|███       | 18/60 [00:01<00:02, 16.18it/s][4/6] extract embeddings:  35%|███▌      | 21/60 [00:02<00:02, 17.97it/s][4/6] extract embeddings:  40%|████      | 24/60 [00:02<00:01, 19.41it/s][4/6] extract embeddings:  45%|████▌     | 27/60 [00:02<00:01, 20.00it/s][4/6] extract embeddings:  50%|█████     | 30/60 [00:02<00:01, 20.77it/s][4/6] extract embeddings:  55%|█████▌    | 33/60 [00:02<00:01, 21.18it/s][4/6] extract embeddings:  60%|██████    | 36/60 [00:02<00:01, 20.01it/s][4/6] extract embeddings:  65%|██████▌   | 39/60 [00:02<00:01, 20.73it/s][4/6] extract embeddings:  70%|███████   | 42/60 [00:03<00:00, 21.16it/s][4/6] extract embeddings:  75%|███████▌  | 45/60 [00:03<00:00, 20.60it/s][4/6] extract embeddings:  80%|████████  | 48/60 [00:03<00:00, 21.55it/s][4/6] extract embeddings:  85%|████████▌ | 51/60 [00:03<00:00, 21.06it/s][4/6] extract embeddings:  90%|█████████ | 54/60 [00:03<00:00, 20.95it/s][4/6] extract embeddings:  95%|█████████▌| 57/60 [00:03<00:00, 21.31it/s][4/6] extract embeddings: 100%|██████████| 60/60 [00:03<00:00, 23.19it/s][4/6] extract embeddings: 100%|██████████| 60/60 [00:03<00:00, 15.48it/s]
[NeMo I 2025-04-17 01:33:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:33:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:33:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:33:42 collections:880] Dataset successfully loaded with 5640 items and total duration provided from manifest is  1.42 hours.
[NeMo I 2025-04-17 01:33:42 collections:886] # 5640 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/89 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/89 [00:01<01:49,  1.25s/it][5/6] extract embeddings:   4%|▍         | 4/89 [00:01<00:22,  3.78it/s][5/6] extract embeddings:   8%|▊         | 7/89 [00:01<00:11,  6.97it/s][5/6] extract embeddings:  11%|█         | 10/89 [00:01<00:07, 10.12it/s][5/6] extract embeddings:  15%|█▍        | 13/89 [00:01<00:05, 13.04it/s][5/6] extract embeddings:  18%|█▊        | 16/89 [00:01<00:04, 16.00it/s][5/6] extract embeddings:  21%|██▏       | 19/89 [00:01<00:03, 18.87it/s][5/6] extract embeddings:  25%|██▍       | 22/89 [00:02<00:03, 20.29it/s][5/6] extract embeddings:  28%|██▊       | 25/89 [00:02<00:02, 21.99it/s][5/6] extract embeddings:  31%|███▏      | 28/89 [00:02<00:02, 23.67it/s][5/6] extract embeddings:  35%|███▍      | 31/89 [00:02<00:02, 23.98it/s][5/6] extract embeddings:  38%|███▊      | 34/89 [00:02<00:02, 25.00it/s][5/6] extract embeddings:  42%|████▏     | 37/89 [00:02<00:02, 24.93it/s][5/6] extract embeddings:  45%|████▍     | 40/89 [00:02<00:01, 25.46it/s][5/6] extract embeddings:  48%|████▊     | 43/89 [00:02<00:01, 24.90it/s][5/6] extract embeddings:  52%|█████▏    | 46/89 [00:02<00:01, 25.48it/s][5/6] extract embeddings:  55%|█████▌    | 49/89 [00:03<00:01, 25.95it/s][5/6] extract embeddings:  58%|█████▊    | 52/89 [00:03<00:01, 26.06it/s][5/6] extract embeddings:  62%|██████▏   | 55/89 [00:03<00:01, 26.18it/s][5/6] extract embeddings:  65%|██████▌   | 58/89 [00:03<00:01, 26.24it/s][5/6] extract embeddings:  69%|██████▊   | 61/89 [00:03<00:01, 25.24it/s][5/6] extract embeddings:  72%|███████▏  | 64/89 [00:03<00:01, 24.69it/s][5/6] extract embeddings:  75%|███████▌  | 67/89 [00:03<00:00, 25.47it/s][5/6] extract embeddings:  79%|███████▊  | 70/89 [00:03<00:00, 25.58it/s][5/6] extract embeddings:  82%|████████▏ | 73/89 [00:04<00:00, 25.40it/s][5/6] extract embeddings:  85%|████████▌ | 76/89 [00:04<00:00, 24.87it/s][5/6] extract embeddings:  89%|████████▉ | 79/89 [00:04<00:00, 24.34it/s][5/6] extract embeddings:  92%|█████████▏| 82/89 [00:04<00:00, 25.07it/s][5/6] extract embeddings:  96%|█████████▌| 85/89 [00:04<00:00, 25.91it/s][5/6] extract embeddings:  99%|█████████▉| 88/89 [00:04<00:00, 26.26it/s][5/6] extract embeddings: 100%|██████████| 89/89 [00:04<00:00, 19.05it/s]
[NeMo I 2025-04-17 01:33:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:33:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:33:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:33:47 collections:880] Dataset successfully loaded with 11439 items and total duration provided from manifest is  1.53 hours.
[NeMo I 2025-04-17 01:33:47 collections:886] # 11439 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/179 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/179 [00:01<03:26,  1.16s/it][6/6] extract embeddings:   3%|▎         | 5/179 [00:01<00:34,  5.06it/s][6/6] extract embeddings:   5%|▌         | 9/179 [00:01<00:18,  9.37it/s][6/6] extract embeddings:   7%|▋         | 13/179 [00:01<00:12, 13.77it/s][6/6] extract embeddings:   9%|▉         | 17/179 [00:01<00:09, 17.99it/s][6/6] extract embeddings:  12%|█▏        | 21/179 [00:01<00:07, 21.09it/s][6/6] extract embeddings:  14%|█▍        | 25/179 [00:01<00:06, 24.07it/s][6/6] extract embeddings:  16%|█▌        | 29/179 [00:02<00:05, 26.68it/s][6/6] extract embeddings:  18%|█▊        | 33/179 [00:02<00:05, 27.85it/s][6/6] extract embeddings:  21%|██        | 37/179 [00:02<00:04, 28.96it/s][6/6] extract embeddings:  23%|██▎       | 41/179 [00:02<00:04, 29.91it/s][6/6] extract embeddings:  25%|██▌       | 45/179 [00:02<00:04, 30.86it/s][6/6] extract embeddings:  27%|██▋       | 49/179 [00:02<00:04, 31.99it/s][6/6] extract embeddings:  30%|██▉       | 53/179 [00:02<00:03, 32.49it/s][6/6] extract embeddings:  32%|███▏      | 57/179 [00:02<00:03, 33.25it/s][6/6] extract embeddings:  34%|███▍      | 61/179 [00:02<00:03, 31.90it/s][6/6] extract embeddings:  36%|███▋      | 65/179 [00:03<00:03, 31.22it/s][6/6] extract embeddings:  39%|███▊      | 69/179 [00:03<00:03, 29.76it/s][6/6] extract embeddings:  41%|████      | 73/179 [00:03<00:03, 31.08it/s][6/6] extract embeddings:  43%|████▎     | 77/179 [00:03<00:03, 31.51it/s][6/6] extract embeddings:  45%|████▌     | 81/179 [00:03<00:03, 31.97it/s][6/6] extract embeddings:  47%|████▋     | 85/179 [00:03<00:02, 32.30it/s][6/6] extract embeddings:  50%|████▉     | 89/179 [00:03<00:02, 32.29it/s][6/6] extract embeddings:  52%|█████▏    | 93/179 [00:03<00:02, 32.84it/s][6/6] extract embeddings:  54%|█████▍    | 97/179 [00:04<00:02, 32.33it/s][6/6] extract embeddings:  56%|█████▋    | 101/179 [00:04<00:02, 31.78it/s][6/6] extract embeddings:  59%|█████▊    | 105/179 [00:04<00:02, 32.48it/s][6/6] extract embeddings:  61%|██████    | 109/179 [00:04<00:02, 32.43it/s][6/6] extract embeddings:  63%|██████▎   | 113/179 [00:04<00:02, 32.93it/s][6/6] extract embeddings:  65%|██████▌   | 117/179 [00:04<00:01, 32.67it/s][6/6] extract embeddings:  68%|██████▊   | 121/179 [00:04<00:01, 32.67it/s][6/6] extract embeddings:  70%|██████▉   | 125/179 [00:04<00:01, 33.26it/s][6/6] extract embeddings:  72%|███████▏  | 129/179 [00:05<00:01, 33.28it/s][6/6] extract embeddings:  74%|███████▍  | 133/179 [00:05<00:01, 33.31it/s][6/6] extract embeddings:  77%|███████▋  | 137/179 [00:05<00:01, 33.24it/s][6/6] extract embeddings:  79%|███████▉  | 141/179 [00:05<00:01, 33.95it/s][6/6] extract embeddings:  81%|████████  | 145/179 [00:05<00:01, 33.82it/s][6/6] extract embeddings:  83%|████████▎ | 149/179 [00:05<00:00, 33.34it/s][6/6] extract embeddings:  85%|████████▌ | 153/179 [00:05<00:00, 31.90it/s][6/6] extract embeddings:  88%|████████▊ | 157/179 [00:05<00:00, 32.61it/s][6/6] extract embeddings:  90%|████████▉ | 161/179 [00:06<00:00, 33.22it/s][6/6] extract embeddings:  92%|█████████▏| 165/179 [00:06<00:00, 32.92it/s][6/6] extract embeddings:  94%|█████████▍| 169/179 [00:06<00:00, 33.50it/s][6/6] extract embeddings:  97%|█████████▋| 173/179 [00:06<00:00, 34.14it/s][6/6] extract embeddings:  99%|█████████▉| 177/179 [00:06<00:00, 33.78it/s][6/6] extract embeddings: 100%|██████████| 179/179 [00:06<00:00, 27.03it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.31it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.65it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.31it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.43it/s]
[NeMo I 2025-04-17 01:33:56 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:33:57 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              46.243178   444.120  ...   14.025048  3.157941
    Harker-ES                       39.097662  2178.782  ...   50.408089  2.313590
    Harker-MN                       48.865140   366.767  ...   28.077005  7.655270
    Longfellow-Block-1              34.353140   492.417  ...    8.968989  1.821421
    TOTAL                           40.366893  3482.086  ...  101.479130  2.914320
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:33:57 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0656 | MISS: 0.3089 | CER: 0.0291 | DER: 0.4037 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.50, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.5, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:34:08 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:34:08 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:34:08 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:34:08 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:34:08 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:34:08 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:34:08 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:34:08 features:305] PADDING: 16
[NeMo I 2025-04-17 01:34:09 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:34:09 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:34:09 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:34:09 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:34:09 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:34:09 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:34:09 collections:880] Dataset successfully loaded with 2142 items and total duration provided from manifest is  1.12 hours.
[NeMo I 2025-04-17 01:34:09 collections:886] # 2142 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:02<01:06,  2.01s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.43it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.93it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.56it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.33it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  9.05it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.73it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 12.46it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 13.74it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:00, 14.21it/s][1/6] extract embeddings:  65%|██████▍   | 22/34 [00:03<00:00, 15.56it/s][1/6] extract embeddings:  74%|███████▎  | 25/34 [00:03<00:00, 16.00it/s][1/6] extract embeddings:  79%|███████▉  | 27/34 [00:03<00:00, 16.01it/s][1/6] extract embeddings:  85%|████████▌ | 29/34 [00:03<00:00, 16.04it/s][1/6] extract embeddings:  91%|█████████ | 31/34 [00:03<00:00, 16.68it/s][1/6] extract embeddings:  97%|█████████▋| 33/34 [00:03<00:00, 16.84it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:03<00:00,  8.84it/s]
[NeMo I 2025-04-17 01:34:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:34:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:34:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:34:13 collections:880] Dataset successfully loaded with 2441 items and total duration provided from manifest is  1.18 hours.
[NeMo I 2025-04-17 01:34:13 collections:886] # 2441 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:53,  1.41s/it][2/6] extract embeddings:   8%|▊         | 3/39 [00:01<00:14,  2.46it/s][2/6] extract embeddings:  13%|█▎        | 5/39 [00:01<00:07,  4.41it/s][2/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  6.42it/s][2/6] extract embeddings:  23%|██▎       | 9/39 [00:01<00:03,  8.61it/s][2/6] extract embeddings:  28%|██▊       | 11/39 [00:01<00:02, 10.49it/s][2/6] extract embeddings:  33%|███▎      | 13/39 [00:02<00:02, 11.98it/s][2/6] extract embeddings:  38%|███▊      | 15/39 [00:02<00:01, 13.27it/s][2/6] extract embeddings:  44%|████▎     | 17/39 [00:02<00:01, 13.99it/s][2/6] extract embeddings:  49%|████▊     | 19/39 [00:02<00:01, 15.38it/s][2/6] extract embeddings:  54%|█████▍    | 21/39 [00:02<00:01, 15.49it/s][2/6] extract embeddings:  59%|█████▉    | 23/39 [00:02<00:01, 15.74it/s][2/6] extract embeddings:  67%|██████▋   | 26/39 [00:02<00:00, 16.86it/s][2/6] extract embeddings:  72%|███████▏  | 28/39 [00:02<00:00, 17.27it/s][2/6] extract embeddings:  77%|███████▋  | 30/39 [00:03<00:00, 17.49it/s][2/6] extract embeddings:  82%|████████▏ | 32/39 [00:03<00:00, 17.60it/s][2/6] extract embeddings:  87%|████████▋ | 34/39 [00:03<00:00, 17.46it/s][2/6] extract embeddings:  92%|█████████▏| 36/39 [00:03<00:00, 17.71it/s][2/6] extract embeddings:  97%|█████████▋| 38/39 [00:03<00:00, 17.40it/s][2/6] extract embeddings: 100%|██████████| 39/39 [00:03<00:00, 10.92it/s]
[NeMo I 2025-04-17 01:34:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:34:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:34:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:34:17 collections:880] Dataset successfully loaded with 2915 items and total duration provided from manifest is  1.24 hours.
[NeMo I 2025-04-17 01:34:17 collections:886] # 2915 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:53,  1.18s/it][3/6] extract embeddings:   7%|▋         | 3/46 [00:01<00:14,  2.91it/s][3/6] extract embeddings:  11%|█         | 5/46 [00:01<00:07,  5.16it/s][3/6] extract embeddings:  17%|█▋        | 8/46 [00:01<00:04,  8.58it/s][3/6] extract embeddings:  22%|██▏       | 10/46 [00:01<00:03, 10.44it/s][3/6] extract embeddings:  26%|██▌       | 12/46 [00:01<00:02, 12.14it/s][3/6] extract embeddings:  30%|███       | 14/46 [00:01<00:02, 13.65it/s][3/6] extract embeddings:  35%|███▍      | 16/46 [00:01<00:01, 15.09it/s][3/6] extract embeddings:  41%|████▏     | 19/46 [00:02<00:01, 17.14it/s][3/6] extract embeddings:  46%|████▌     | 21/46 [00:02<00:01, 17.64it/s][3/6] extract embeddings:  50%|█████     | 23/46 [00:02<00:01, 18.04it/s][3/6] extract embeddings:  54%|█████▍    | 25/46 [00:02<00:01, 17.76it/s][3/6] extract embeddings:  59%|█████▊    | 27/46 [00:02<00:01, 17.93it/s][3/6] extract embeddings:  63%|██████▎   | 29/46 [00:02<00:00, 17.73it/s][3/6] extract embeddings:  70%|██████▉   | 32/46 [00:02<00:00, 19.10it/s][3/6] extract embeddings:  74%|███████▍  | 34/46 [00:02<00:00, 19.28it/s][3/6] extract embeddings:  80%|████████  | 37/46 [00:03<00:00, 19.09it/s][3/6] extract embeddings:  85%|████████▍ | 39/46 [00:03<00:00, 19.13it/s][3/6] extract embeddings:  91%|█████████▏| 42/46 [00:03<00:00, 19.65it/s][3/6] extract embeddings:  98%|█████████▊| 45/46 [00:03<00:00, 20.07it/s][3/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 13.20it/s]
[NeMo I 2025-04-17 01:34:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:34:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:34:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:34:21 collections:880] Dataset successfully loaded with 3758 items and total duration provided from manifest is  1.31 hours.
[NeMo I 2025-04-17 01:34:21 collections:886] # 3758 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/59 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/59 [00:01<01:06,  1.15s/it][4/6] extract embeddings:   7%|▋         | 4/59 [00:01<00:13,  3.97it/s][4/6] extract embeddings:  12%|█▏        | 7/59 [00:01<00:07,  7.00it/s][4/6] extract embeddings:  15%|█▌        | 9/59 [00:01<00:05,  8.95it/s][4/6] extract embeddings:  20%|██        | 12/59 [00:01<00:04, 11.74it/s][4/6] extract embeddings:  25%|██▌       | 15/59 [00:01<00:03, 14.15it/s][4/6] extract embeddings:  31%|███       | 18/59 [00:01<00:02, 16.03it/s][4/6] extract embeddings:  36%|███▌      | 21/59 [00:02<00:02, 17.45it/s][4/6] extract embeddings:  41%|████      | 24/59 [00:02<00:01, 18.73it/s][4/6] extract embeddings:  46%|████▌     | 27/59 [00:02<00:01, 19.20it/s][4/6] extract embeddings:  51%|█████     | 30/59 [00:02<00:01, 19.68it/s][4/6] extract embeddings:  56%|█████▌    | 33/59 [00:02<00:01, 20.51it/s][4/6] extract embeddings:  61%|██████    | 36/59 [00:02<00:01, 21.20it/s][4/6] extract embeddings:  66%|██████▌   | 39/59 [00:02<00:00, 21.34it/s][4/6] extract embeddings:  71%|███████   | 42/59 [00:03<00:00, 21.13it/s][4/6] extract embeddings:  76%|███████▋  | 45/59 [00:03<00:00, 21.70it/s][4/6] extract embeddings:  81%|████████▏ | 48/59 [00:03<00:00, 21.47it/s][4/6] extract embeddings:  86%|████████▋ | 51/59 [00:03<00:00, 20.78it/s][4/6] extract embeddings:  92%|█████████▏| 54/59 [00:03<00:00, 21.24it/s][4/6] extract embeddings:  97%|█████████▋| 57/59 [00:03<00:00, 20.95it/s][4/6] extract embeddings: 100%|██████████| 59/59 [00:03<00:00, 15.18it/s]
[NeMo I 2025-04-17 01:34:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:34:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:34:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:34:25 collections:880] Dataset successfully loaded with 5561 items and total duration provided from manifest is  1.40 hours.
[NeMo I 2025-04-17 01:34:25 collections:886] # 5561 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/87 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/87 [00:01<02:03,  1.44s/it][5/6] extract embeddings:   5%|▍         | 4/87 [00:01<00:25,  3.28it/s][5/6] extract embeddings:   7%|▋         | 6/87 [00:01<00:15,  5.15it/s][5/6] extract embeddings:  10%|█         | 9/87 [00:01<00:09,  8.40it/s][5/6] extract embeddings:  14%|█▍        | 12/87 [00:01<00:06, 11.86it/s][5/6] extract embeddings:  17%|█▋        | 15/87 [00:02<00:04, 14.56it/s][5/6] extract embeddings:  21%|██        | 18/87 [00:02<00:04, 16.63it/s][5/6] extract embeddings:  24%|██▍       | 21/87 [00:02<00:03, 19.16it/s][5/6] extract embeddings:  28%|██▊       | 24/87 [00:02<00:03, 20.90it/s][5/6] extract embeddings:  31%|███       | 27/87 [00:02<00:02, 21.94it/s][5/6] extract embeddings:  34%|███▍      | 30/87 [00:02<00:02, 22.88it/s][5/6] extract embeddings:  38%|███▊      | 33/87 [00:02<00:02, 22.89it/s][5/6] extract embeddings:  41%|████▏     | 36/87 [00:02<00:02, 23.68it/s][5/6] extract embeddings:  45%|████▍     | 39/87 [00:02<00:01, 25.08it/s][5/6] extract embeddings:  48%|████▊     | 42/87 [00:03<00:01, 25.08it/s][5/6] extract embeddings:  52%|█████▏    | 45/87 [00:03<00:01, 24.56it/s][5/6] extract embeddings:  55%|█████▌    | 48/87 [00:03<00:01, 24.94it/s][5/6] extract embeddings:  59%|█████▊    | 51/87 [00:03<00:01, 23.97it/s][5/6] extract embeddings:  62%|██████▏   | 54/87 [00:03<00:01, 25.02it/s][5/6] extract embeddings:  66%|██████▌   | 57/87 [00:03<00:01, 25.43it/s][5/6] extract embeddings:  69%|██████▉   | 60/87 [00:03<00:01, 24.84it/s][5/6] extract embeddings:  72%|███████▏  | 63/87 [00:03<00:00, 24.31it/s][5/6] extract embeddings:  76%|███████▌  | 66/87 [00:04<00:00, 23.99it/s][5/6] extract embeddings:  79%|███████▉  | 69/87 [00:04<00:00, 24.75it/s][5/6] extract embeddings:  83%|████████▎ | 72/87 [00:04<00:00, 24.41it/s][5/6] extract embeddings:  86%|████████▌ | 75/87 [00:04<00:00, 25.68it/s][5/6] extract embeddings:  90%|████████▉ | 78/87 [00:04<00:00, 26.37it/s][5/6] extract embeddings:  93%|█████████▎| 81/87 [00:04<00:00, 26.11it/s][5/6] extract embeddings:  97%|█████████▋| 84/87 [00:04<00:00, 25.97it/s][5/6] extract embeddings: 100%|██████████| 87/87 [00:04<00:00, 25.23it/s][5/6] extract embeddings: 100%|██████████| 87/87 [00:04<00:00, 17.77it/s]
[NeMo I 2025-04-17 01:34:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:34:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:34:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:34:30 collections:880] Dataset successfully loaded with 11273 items and total duration provided from manifest is  1.51 hours.
[NeMo I 2025-04-17 01:34:30 collections:886] # 11273 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/177 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/177 [00:01<03:20,  1.14s/it][6/6] extract embeddings:   3%|▎         | 5/177 [00:01<00:32,  5.23it/s][6/6] extract embeddings:   5%|▌         | 9/177 [00:01<00:17,  9.84it/s][6/6] extract embeddings:   7%|▋         | 13/177 [00:01<00:11, 14.01it/s][6/6] extract embeddings:  10%|▉         | 17/177 [00:01<00:08, 18.15it/s][6/6] extract embeddings:  12%|█▏        | 21/177 [00:01<00:07, 20.94it/s][6/6] extract embeddings:  14%|█▍        | 25/177 [00:01<00:06, 23.55it/s][6/6] extract embeddings:  16%|█▋        | 29/177 [00:01<00:05, 26.19it/s][6/6] extract embeddings:  19%|█▊        | 33/177 [00:02<00:05, 27.61it/s][6/6] extract embeddings:  21%|██        | 37/177 [00:02<00:04, 28.76it/s][6/6] extract embeddings:  23%|██▎       | 41/177 [00:02<00:04, 28.16it/s][6/6] extract embeddings:  25%|██▌       | 45/177 [00:02<00:04, 28.17it/s][6/6] extract embeddings:  28%|██▊       | 49/177 [00:02<00:04, 28.99it/s][6/6] extract embeddings:  30%|██▉       | 53/177 [00:02<00:04, 30.09it/s][6/6] extract embeddings:  32%|███▏      | 57/177 [00:02<00:04, 29.76it/s][6/6] extract embeddings:  34%|███▍      | 61/177 [00:03<00:03, 29.92it/s][6/6] extract embeddings:  37%|███▋      | 65/177 [00:03<00:03, 31.25it/s][6/6] extract embeddings:  39%|███▉      | 69/177 [00:03<00:03, 31.10it/s][6/6] extract embeddings:  41%|████      | 73/177 [00:03<00:03, 30.46it/s][6/6] extract embeddings:  44%|████▎     | 77/177 [00:03<00:03, 30.25it/s][6/6] extract embeddings:  46%|████▌     | 81/177 [00:03<00:03, 28.43it/s][6/6] extract embeddings:  48%|████▊     | 85/177 [00:03<00:03, 29.96it/s][6/6] extract embeddings:  50%|█████     | 89/177 [00:03<00:02, 30.69it/s][6/6] extract embeddings:  53%|█████▎    | 93/177 [00:04<00:02, 30.62it/s][6/6] extract embeddings:  55%|█████▍    | 97/177 [00:04<00:02, 31.47it/s][6/6] extract embeddings:  57%|█████▋    | 101/177 [00:04<00:02, 30.66it/s][6/6] extract embeddings:  59%|█████▉    | 105/177 [00:04<00:02, 30.59it/s][6/6] extract embeddings:  62%|██████▏   | 109/177 [00:04<00:02, 30.57it/s][6/6] extract embeddings:  64%|██████▍   | 113/177 [00:04<00:02, 30.99it/s][6/6] extract embeddings:  66%|██████▌   | 117/177 [00:04<00:01, 31.26it/s][6/6] extract embeddings:  68%|██████▊   | 121/177 [00:04<00:01, 31.30it/s][6/6] extract embeddings:  71%|███████   | 125/177 [00:05<00:01, 30.33it/s][6/6] extract embeddings:  73%|███████▎  | 129/177 [00:05<00:01, 30.64it/s][6/6] extract embeddings:  75%|███████▌  | 133/177 [00:05<00:01, 30.91it/s][6/6] extract embeddings:  77%|███████▋  | 137/177 [00:05<00:01, 31.33it/s][6/6] extract embeddings:  80%|███████▉  | 141/177 [00:05<00:01, 31.54it/s][6/6] extract embeddings:  82%|████████▏ | 145/177 [00:05<00:00, 32.44it/s][6/6] extract embeddings:  84%|████████▍ | 149/177 [00:05<00:00, 33.02it/s][6/6] extract embeddings:  86%|████████▋ | 153/177 [00:06<00:00, 31.54it/s][6/6] extract embeddings:  89%|████████▊ | 157/177 [00:06<00:00, 32.07it/s][6/6] extract embeddings:  91%|█████████ | 161/177 [00:06<00:00, 32.31it/s][6/6] extract embeddings:  93%|█████████▎| 165/177 [00:06<00:00, 32.56it/s][6/6] extract embeddings:  95%|█████████▌| 169/177 [00:06<00:00, 31.80it/s][6/6] extract embeddings:  98%|█████████▊| 173/177 [00:06<00:00, 32.08it/s][6/6] extract embeddings: 100%|██████████| 177/177 [00:06<00:00, 32.86it/s][6/6] extract embeddings: 100%|██████████| 177/177 [00:06<00:00, 26.16it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.35it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.68it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.33it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.44it/s]
[NeMo I 2025-04-17 01:34:39 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:34:40 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              46.749797   444.120  ...   14.145061  3.184964
    Harker-ES                       40.090975  2178.782  ...   51.265850  2.352959
    Harker-MN                       49.287752   366.767  ...   28.478013  7.764606
    Longfellow-Block-1              34.854558   492.417  ...    8.047004  1.634185
    TOTAL                           41.168458  3482.086  ...  101.935928  2.927439
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:34:40 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0643 | MISS: 0.3181 | CER: 0.0293 | DER: 0.4117 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.55, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.55, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.77s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.94s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:34:52 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:34:52 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:34:52 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:34:52 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:34:52 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:34:52 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:34:52 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:34:52 features:305] PADDING: 16
[NeMo I 2025-04-17 01:34:52 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:34:52 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:34:52 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:34:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:34:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:34:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:34:52 collections:880] Dataset successfully loaded with 2124 items and total duration provided from manifest is  1.09 hours.
[NeMo I 2025-04-17 01:34:52 collections:886] # 2124 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/34 [00:02<01:06,  2.00s/it][1/6] extract embeddings:  12%|█▏        | 4/34 [00:02<00:12,  2.44it/s][1/6] extract embeddings:  18%|█▊        | 6/34 [00:02<00:07,  3.90it/s][1/6] extract embeddings:  24%|██▎       | 8/34 [00:02<00:04,  5.62it/s][1/6] extract embeddings:  29%|██▉       | 10/34 [00:02<00:03,  7.26it/s][1/6] extract embeddings:  35%|███▌      | 12/34 [00:02<00:02,  9.08it/s][1/6] extract embeddings:  41%|████      | 14/34 [00:02<00:01, 10.78it/s][1/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 12.50it/s][1/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 14.11it/s][1/6] extract embeddings:  59%|█████▉    | 20/34 [00:03<00:00, 14.49it/s][1/6] extract embeddings:  68%|██████▊   | 23/34 [00:03<00:00, 16.17it/s][1/6] extract embeddings:  74%|███████▎  | 25/34 [00:03<00:00, 16.35it/s][1/6] extract embeddings:  79%|███████▉  | 27/34 [00:03<00:00, 16.43it/s][1/6] extract embeddings:  85%|████████▌ | 29/34 [00:03<00:00, 16.02it/s][1/6] extract embeddings:  91%|█████████ | 31/34 [00:03<00:00, 16.69it/s][1/6] extract embeddings:  97%|█████████▋| 33/34 [00:03<00:00, 16.88it/s][1/6] extract embeddings: 100%|██████████| 34/34 [00:03<00:00,  8.90it/s]
[NeMo I 2025-04-17 01:34:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:34:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:34:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:34:56 collections:880] Dataset successfully loaded with 2414 items and total duration provided from manifest is  1.14 hours.
[NeMo I 2025-04-17 01:34:56 collections:886] # 2414 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:51,  1.38s/it][2/6] extract embeddings:   8%|▊         | 3/38 [00:01<00:14,  2.49it/s][2/6] extract embeddings:  13%|█▎        | 5/38 [00:01<00:07,  4.43it/s][2/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  6.29it/s][2/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02,  9.36it/s][2/6] extract embeddings:  32%|███▏      | 12/38 [00:02<00:02, 11.10it/s][2/6] extract embeddings:  37%|███▋      | 14/38 [00:02<00:01, 12.84it/s][2/6] extract embeddings:  42%|████▏     | 16/38 [00:02<00:01, 14.29it/s][2/6] extract embeddings:  47%|████▋     | 18/38 [00:02<00:01, 15.43it/s][2/6] extract embeddings:  53%|█████▎    | 20/38 [00:02<00:01, 16.49it/s][2/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 16.91it/s][2/6] extract embeddings:  63%|██████▎   | 24/38 [00:02<00:00, 16.89it/s][2/6] extract embeddings:  71%|███████   | 27/38 [00:02<00:00, 18.61it/s][2/6] extract embeddings:  76%|███████▋  | 29/38 [00:02<00:00, 18.48it/s][2/6] extract embeddings:  82%|████████▏ | 31/38 [00:03<00:00, 18.31it/s][2/6] extract embeddings:  87%|████████▋ | 33/38 [00:03<00:00, 18.17it/s][2/6] extract embeddings:  92%|█████████▏| 35/38 [00:03<00:00, 17.86it/s][2/6] extract embeddings:  97%|█████████▋| 37/38 [00:03<00:00, 17.71it/s][2/6] extract embeddings: 100%|██████████| 38/38 [00:03<00:00, 11.13it/s]
[NeMo I 2025-04-17 01:35:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:35:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:00 collections:880] Dataset successfully loaded with 2866 items and total duration provided from manifest is  1.20 hours.
[NeMo I 2025-04-17 01:35:00 collections:886] # 2866 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/45 [00:01<00:52,  1.20s/it][3/6] extract embeddings:   9%|▉         | 4/45 [00:01<00:10,  3.75it/s][3/6] extract embeddings:  16%|█▌        | 7/45 [00:01<00:05,  6.68it/s][3/6] extract embeddings:  22%|██▏       | 10/45 [00:01<00:03,  9.35it/s][3/6] extract embeddings:  29%|██▉       | 13/45 [00:01<00:02, 11.85it/s][3/6] extract embeddings:  33%|███▎      | 15/45 [00:01<00:02, 13.24it/s][3/6] extract embeddings:  38%|███▊      | 17/45 [00:02<00:01, 14.26it/s][3/6] extract embeddings:  44%|████▍     | 20/45 [00:02<00:01, 15.95it/s][3/6] extract embeddings:  49%|████▉     | 22/45 [00:02<00:01, 16.19it/s][3/6] extract embeddings:  56%|█████▌    | 25/45 [00:02<00:01, 17.57it/s][3/6] extract embeddings:  60%|██████    | 27/45 [00:02<00:01, 17.11it/s][3/6] extract embeddings:  67%|██████▋   | 30/45 [00:02<00:00, 18.21it/s][3/6] extract embeddings:  73%|███████▎  | 33/45 [00:02<00:00, 18.79it/s][3/6] extract embeddings:  80%|████████  | 36/45 [00:02<00:00, 19.30it/s][3/6] extract embeddings:  84%|████████▍ | 38/45 [00:03<00:00, 19.42it/s][3/6] extract embeddings:  91%|█████████ | 41/45 [00:03<00:00, 19.94it/s][3/6] extract embeddings:  98%|█████████▊| 44/45 [00:03<00:00, 19.61it/s][3/6] extract embeddings: 100%|██████████| 45/45 [00:03<00:00, 13.04it/s]
[NeMo I 2025-04-17 01:35:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:35:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:04 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:04 collections:880] Dataset successfully loaded with 3683 items and total duration provided from manifest is  1.27 hours.
[NeMo I 2025-04-17 01:35:04 collections:886] # 3683 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/58 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/58 [00:01<01:04,  1.13s/it][4/6] extract embeddings:   7%|▋         | 4/58 [00:01<00:13,  4.01it/s][4/6] extract embeddings:  12%|█▏        | 7/58 [00:01<00:07,  7.20it/s][4/6] extract embeddings:  17%|█▋        | 10/58 [00:01<00:04, 10.23it/s][4/6] extract embeddings:  22%|██▏       | 13/58 [00:01<00:03, 12.94it/s][4/6] extract embeddings:  28%|██▊       | 16/58 [00:01<00:02, 14.97it/s][4/6] extract embeddings:  33%|███▎      | 19/58 [00:01<00:02, 16.24it/s][4/6] extract embeddings:  38%|███▊      | 22/58 [00:02<00:01, 18.20it/s][4/6] extract embeddings:  43%|████▎     | 25/58 [00:02<00:01, 19.50it/s][4/6] extract embeddings:  48%|████▊     | 28/58 [00:02<00:01, 20.32it/s][4/6] extract embeddings:  53%|█████▎    | 31/58 [00:02<00:01, 21.01it/s][4/6] extract embeddings:  59%|█████▊    | 34/58 [00:02<00:01, 21.13it/s][4/6] extract embeddings:  64%|██████▍   | 37/58 [00:02<00:01, 20.79it/s][4/6] extract embeddings:  69%|██████▉   | 40/58 [00:02<00:00, 21.91it/s][4/6] extract embeddings:  74%|███████▍  | 43/58 [00:03<00:00, 21.75it/s][4/6] extract embeddings:  79%|███████▉  | 46/58 [00:03<00:00, 22.19it/s][4/6] extract embeddings:  84%|████████▍ | 49/58 [00:03<00:00, 21.51it/s][4/6] extract embeddings:  90%|████████▉ | 52/58 [00:03<00:00, 21.85it/s][4/6] extract embeddings:  95%|█████████▍| 55/58 [00:03<00:00, 22.27it/s][4/6] extract embeddings: 100%|██████████| 58/58 [00:03<00:00, 22.36it/s][4/6] extract embeddings: 100%|██████████| 58/58 [00:03<00:00, 15.58it/s]
[NeMo I 2025-04-17 01:35:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:35:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:08 collections:880] Dataset successfully loaded with 5450 items and total duration provided from manifest is  1.36 hours.
[NeMo I 2025-04-17 01:35:08 collections:886] # 5450 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/86 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/86 [00:01<01:42,  1.21s/it][5/6] extract embeddings:   5%|▍         | 4/86 [00:01<00:21,  3.84it/s][5/6] extract embeddings:   8%|▊         | 7/86 [00:01<00:11,  7.04it/s][5/6] extract embeddings:  12%|█▏        | 10/86 [00:01<00:07, 10.41it/s][5/6] extract embeddings:  15%|█▌        | 13/86 [00:01<00:05, 13.31it/s][5/6] extract embeddings:  19%|█▊        | 16/86 [00:01<00:04, 16.08it/s][5/6] extract embeddings:  22%|██▏       | 19/86 [00:01<00:03, 18.16it/s][5/6] extract embeddings:  26%|██▌       | 22/86 [00:02<00:03, 19.18it/s][5/6] extract embeddings:  29%|██▉       | 25/86 [00:02<00:02, 20.91it/s][5/6] extract embeddings:  33%|███▎      | 28/86 [00:02<00:02, 22.37it/s][5/6] extract embeddings:  36%|███▌      | 31/86 [00:02<00:02, 23.36it/s][5/6] extract embeddings:  40%|███▉      | 34/86 [00:02<00:02, 24.06it/s][5/6] extract embeddings:  43%|████▎     | 37/86 [00:02<00:01, 25.17it/s][5/6] extract embeddings:  47%|████▋     | 40/86 [00:02<00:01, 25.37it/s][5/6] extract embeddings:  50%|█████     | 43/86 [00:02<00:01, 26.39it/s][5/6] extract embeddings:  53%|█████▎    | 46/86 [00:02<00:01, 26.73it/s][5/6] extract embeddings:  57%|█████▋    | 49/86 [00:03<00:01, 26.74it/s][5/6] extract embeddings:  60%|██████    | 52/86 [00:03<00:01, 26.86it/s][5/6] extract embeddings:  64%|██████▍   | 55/86 [00:03<00:01, 26.52it/s][5/6] extract embeddings:  67%|██████▋   | 58/86 [00:03<00:01, 26.89it/s][5/6] extract embeddings:  71%|███████   | 61/86 [00:03<00:00, 26.22it/s][5/6] extract embeddings:  74%|███████▍  | 64/86 [00:03<00:00, 25.52it/s][5/6] extract embeddings:  78%|███████▊  | 67/86 [00:03<00:00, 26.13it/s][5/6] extract embeddings:  81%|████████▏ | 70/86 [00:03<00:00, 25.03it/s][5/6] extract embeddings:  85%|████████▍ | 73/86 [00:03<00:00, 25.84it/s][5/6] extract embeddings:  88%|████████▊ | 76/86 [00:04<00:00, 26.41it/s][5/6] extract embeddings:  92%|█████████▏| 79/86 [00:04<00:00, 25.70it/s][5/6] extract embeddings:  95%|█████████▌| 82/86 [00:04<00:00, 25.80it/s][5/6] extract embeddings:  99%|█████████▉| 85/86 [00:04<00:00, 26.63it/s][5/6] extract embeddings: 100%|██████████| 86/86 [00:04<00:00, 19.12it/s]
[NeMo I 2025-04-17 01:35:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:35:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:12 collections:880] Dataset successfully loaded with 11054 items and total duration provided from manifest is  1.47 hours.
[NeMo I 2025-04-17 01:35:12 collections:886] # 11054 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/173 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/173 [00:01<03:17,  1.15s/it][6/6] extract embeddings:   3%|▎         | 5/173 [00:01<00:32,  5.12it/s][6/6] extract embeddings:   5%|▌         | 9/173 [00:01<00:17,  9.57it/s][6/6] extract embeddings:   8%|▊         | 13/173 [00:01<00:11, 14.12it/s][6/6] extract embeddings:  10%|▉         | 17/173 [00:01<00:08, 18.22it/s][6/6] extract embeddings:  12%|█▏        | 21/173 [00:01<00:06, 21.89it/s][6/6] extract embeddings:  14%|█▍        | 25/173 [00:01<00:05, 24.96it/s][6/6] extract embeddings:  17%|█▋        | 29/173 [00:01<00:05, 26.33it/s][6/6] extract embeddings:  19%|█▉        | 33/173 [00:02<00:05, 27.51it/s][6/6] extract embeddings:  21%|██▏       | 37/173 [00:02<00:04, 28.54it/s][6/6] extract embeddings:  24%|██▎       | 41/173 [00:02<00:04, 29.45it/s][6/6] extract embeddings:  26%|██▌       | 45/173 [00:02<00:04, 30.30it/s][6/6] extract embeddings:  28%|██▊       | 49/173 [00:02<00:03, 31.18it/s][6/6] extract embeddings:  31%|███       | 53/173 [00:02<00:03, 31.94it/s][6/6] extract embeddings:  33%|███▎      | 57/173 [00:02<00:03, 32.44it/s][6/6] extract embeddings:  35%|███▌      | 61/173 [00:02<00:03, 32.63it/s][6/6] extract embeddings:  38%|███▊      | 65/173 [00:03<00:03, 33.12it/s][6/6] extract embeddings:  40%|███▉      | 69/173 [00:03<00:03, 33.47it/s][6/6] extract embeddings:  42%|████▏     | 73/173 [00:03<00:03, 32.84it/s][6/6] extract embeddings:  45%|████▍     | 77/173 [00:03<00:02, 32.03it/s][6/6] extract embeddings:  47%|████▋     | 81/173 [00:03<00:02, 32.17it/s][6/6] extract embeddings:  49%|████▉     | 85/173 [00:03<00:02, 32.40it/s][6/6] extract embeddings:  51%|█████▏    | 89/173 [00:03<00:02, 32.79it/s][6/6] extract embeddings:  54%|█████▍    | 93/173 [00:03<00:02, 32.88it/s][6/6] extract embeddings:  56%|█████▌    | 97/173 [00:04<00:02, 32.64it/s][6/6] extract embeddings:  58%|█████▊    | 101/173 [00:04<00:02, 31.16it/s][6/6] extract embeddings:  61%|██████    | 105/173 [00:04<00:02, 31.44it/s][6/6] extract embeddings:  63%|██████▎   | 109/173 [00:04<00:01, 32.86it/s][6/6] extract embeddings:  65%|██████▌   | 113/173 [00:04<00:01, 32.36it/s][6/6] extract embeddings:  68%|██████▊   | 117/173 [00:04<00:01, 32.00it/s][6/6] extract embeddings:  70%|██████▉   | 121/173 [00:04<00:01, 32.10it/s][6/6] extract embeddings:  72%|███████▏  | 125/173 [00:04<00:01, 32.28it/s][6/6] extract embeddings:  75%|███████▍  | 129/173 [00:05<00:01, 32.28it/s][6/6] extract embeddings:  77%|███████▋  | 133/173 [00:05<00:01, 31.71it/s][6/6] extract embeddings:  79%|███████▉  | 137/173 [00:05<00:01, 32.69it/s][6/6] extract embeddings:  82%|████████▏ | 141/173 [00:05<00:01, 31.86it/s][6/6] extract embeddings:  84%|████████▍ | 145/173 [00:05<00:00, 32.23it/s][6/6] extract embeddings:  86%|████████▌ | 149/173 [00:05<00:00, 32.23it/s][6/6] extract embeddings:  88%|████████▊ | 153/173 [00:05<00:00, 32.86it/s][6/6] extract embeddings:  91%|█████████ | 157/173 [00:05<00:00, 33.45it/s][6/6] extract embeddings:  93%|█████████▎| 161/173 [00:06<00:00, 33.05it/s][6/6] extract embeddings:  95%|█████████▌| 165/173 [00:06<00:00, 33.25it/s][6/6] extract embeddings:  98%|█████████▊| 169/173 [00:06<00:00, 31.81it/s][6/6] extract embeddings: 100%|██████████| 173/173 [00:06<00:00, 32.05it/s][6/6] extract embeddings: 100%|██████████| 173/173 [00:06<00:00, 26.80it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.06it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.64it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.32it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.41it/s]
[NeMo I 2025-04-17 01:35:21 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:35:22 der:208] 
                       diarization error rate     total  ...   confusion          
                                            %            ...                     %
    item                                                 ...                      
    Longfellow-Block-2              47.677467   444.120  ...   14.815066  3.335825
    Harker-ES                       41.188709  2178.782  ...   54.701017  2.510624
    Harker-MN                       50.332547   366.767  ...   28.128984  7.669443
    Longfellow-Block-1              35.939008   492.417  ...    8.599977  1.746483
    TOTAL                           42.237047  3482.086  ...  106.245045  3.051190
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:35:22 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0628 | MISS: 0.3290 | CER: 0.0305 | DER: 0.4224 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.73s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:35:34 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:35:34 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:35:34 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:35:34 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:35:34 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:35:34 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:35:34 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:35:34 features:305] PADDING: 16
[NeMo I 2025-04-17 01:35:34 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:35:34 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:35:34 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:35:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:35:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:34 collections:880] Dataset successfully loaded with 2110 items and total duration provided from manifest is  1.06 hours.
[NeMo I 2025-04-17 01:35:34 collections:886] # 2110 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  2.00s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.45it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.96it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.68it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.46it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  9.27it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.89it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.60it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:01, 14.19it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 14.65it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:03<00:00, 15.91it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 16.07it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 16.25it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 16.25it/s][1/6] extract embeddings:  94%|█████████▍| 31/33 [00:03<00:00, 16.38it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00, 16.64it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.72it/s]
[NeMo I 2025-04-17 01:35:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:35:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:38 collections:880] Dataset successfully loaded with 2396 items and total duration provided from manifest is  1.11 hours.
[NeMo I 2025-04-17 01:35:38 collections:886] # 2396 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:52,  1.42s/it][2/6] extract embeddings:   8%|▊         | 3/38 [00:01<00:14,  2.47it/s][2/6] extract embeddings:  13%|█▎        | 5/38 [00:01<00:07,  4.45it/s][2/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  6.62it/s][2/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02,  9.69it/s][2/6] extract embeddings:  32%|███▏      | 12/38 [00:01<00:02, 11.22it/s][2/6] extract embeddings:  39%|███▉      | 15/38 [00:02<00:01, 13.58it/s][2/6] extract embeddings:  45%|████▍     | 17/38 [00:02<00:01, 14.67it/s][2/6] extract embeddings:  53%|█████▎    | 20/38 [00:02<00:01, 16.28it/s][2/6] extract embeddings:  61%|██████    | 23/38 [00:02<00:00, 17.04it/s][2/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 17.14it/s][2/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 17.52it/s][2/6] extract embeddings:  79%|███████▉  | 30/38 [00:02<00:00, 17.90it/s][2/6] extract embeddings:  84%|████████▍ | 32/38 [00:03<00:00, 17.30it/s][2/6] extract embeddings:  89%|████████▉ | 34/38 [00:03<00:00, 17.64it/s][2/6] extract embeddings:  97%|█████████▋| 37/38 [00:03<00:00, 18.53it/s][2/6] extract embeddings: 100%|██████████| 38/38 [00:03<00:00, 11.21it/s]
[NeMo I 2025-04-17 01:35:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:35:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:42 collections:880] Dataset successfully loaded with 2829 items and total duration provided from manifest is  1.17 hours.
[NeMo I 2025-04-17 01:35:42 collections:886] # 2829 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/45 [00:01<00:51,  1.17s/it][3/6] extract embeddings:   9%|▉         | 4/45 [00:01<00:10,  3.77it/s][3/6] extract embeddings:  16%|█▌        | 7/45 [00:01<00:05,  6.84it/s][3/6] extract embeddings:  20%|██        | 9/45 [00:01<00:04,  8.77it/s][3/6] extract embeddings:  27%|██▋       | 12/45 [00:01<00:02, 11.66it/s][3/6] extract embeddings:  31%|███       | 14/45 [00:01<00:02, 13.10it/s][3/6] extract embeddings:  36%|███▌      | 16/45 [00:01<00:01, 14.50it/s][3/6] extract embeddings:  42%|████▏     | 19/45 [00:02<00:01, 16.78it/s][3/6] extract embeddings:  49%|████▉     | 22/45 [00:02<00:01, 18.47it/s][3/6] extract embeddings:  56%|█████▌    | 25/45 [00:02<00:01, 19.17it/s][3/6] extract embeddings:  62%|██████▏   | 28/45 [00:02<00:00, 19.28it/s][3/6] extract embeddings:  69%|██████▉   | 31/45 [00:02<00:00, 18.87it/s][3/6] extract embeddings:  76%|███████▌  | 34/45 [00:02<00:00, 19.31it/s][3/6] extract embeddings:  80%|████████  | 36/45 [00:02<00:00, 19.22it/s][3/6] extract embeddings:  84%|████████▍ | 38/45 [00:03<00:00, 18.90it/s][3/6] extract embeddings:  91%|█████████ | 41/45 [00:03<00:00, 19.43it/s][3/6] extract embeddings:  98%|█████████▊| 44/45 [00:03<00:00, 20.01it/s][3/6] extract embeddings: 100%|██████████| 45/45 [00:03<00:00, 13.44it/s]
[NeMo I 2025-04-17 01:35:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:35:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:45 collections:880] Dataset successfully loaded with 3622 items and total duration provided from manifest is  1.24 hours.
[NeMo I 2025-04-17 01:35:45 collections:886] # 3622 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/57 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/57 [00:01<01:03,  1.14s/it][4/6] extract embeddings:   7%|▋         | 4/57 [00:01<00:13,  3.95it/s][4/6] extract embeddings:  12%|█▏        | 7/57 [00:01<00:06,  7.20it/s][4/6] extract embeddings:  18%|█▊        | 10/57 [00:01<00:04, 10.39it/s][4/6] extract embeddings:  23%|██▎       | 13/57 [00:01<00:03, 13.09it/s][4/6] extract embeddings:  28%|██▊       | 16/57 [00:01<00:02, 15.38it/s][4/6] extract embeddings:  33%|███▎      | 19/57 [00:01<00:02, 17.08it/s][4/6] extract embeddings:  39%|███▊      | 22/57 [00:02<00:01, 17.92it/s][4/6] extract embeddings:  44%|████▍     | 25/57 [00:02<00:01, 18.90it/s][4/6] extract embeddings:  49%|████▉     | 28/57 [00:02<00:01, 19.95it/s][4/6] extract embeddings:  54%|█████▍    | 31/57 [00:02<00:01, 20.83it/s][4/6] extract embeddings:  60%|█████▉    | 34/57 [00:02<00:01, 20.90it/s][4/6] extract embeddings:  65%|██████▍   | 37/57 [00:02<00:00, 21.49it/s][4/6] extract embeddings:  70%|███████   | 40/57 [00:02<00:00, 21.98it/s][4/6] extract embeddings:  75%|███████▌  | 43/57 [00:03<00:00, 21.89it/s][4/6] extract embeddings:  81%|████████  | 46/57 [00:03<00:00, 21.50it/s][4/6] extract embeddings:  86%|████████▌ | 49/57 [00:03<00:00, 21.43it/s][4/6] extract embeddings:  91%|█████████ | 52/57 [00:03<00:00, 22.23it/s][4/6] extract embeddings:  96%|█████████▋| 55/57 [00:03<00:00, 21.28it/s][4/6] extract embeddings: 100%|██████████| 57/57 [00:03<00:00, 15.49it/s]
[NeMo I 2025-04-17 01:35:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:35:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:49 collections:880] Dataset successfully loaded with 5345 items and total duration provided from manifest is  1.33 hours.
[NeMo I 2025-04-17 01:35:49 collections:886] # 5345 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/84 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/84 [00:01<01:33,  1.13s/it][5/6] extract embeddings:   5%|▍         | 4/84 [00:01<00:19,  4.13it/s][5/6] extract embeddings:   8%|▊         | 7/84 [00:01<00:10,  7.49it/s][5/6] extract embeddings:  12%|█▏        | 10/84 [00:01<00:06, 10.89it/s][5/6] extract embeddings:  15%|█▌        | 13/84 [00:01<00:05, 14.20it/s][5/6] extract embeddings:  19%|█▉        | 16/84 [00:01<00:04, 16.92it/s][5/6] extract embeddings:  23%|██▎       | 19/84 [00:01<00:03, 19.20it/s][5/6] extract embeddings:  26%|██▌       | 22/84 [00:01<00:02, 20.93it/s][5/6] extract embeddings:  30%|██▉       | 25/84 [00:02<00:02, 22.27it/s][5/6] extract embeddings:  33%|███▎      | 28/84 [00:02<00:02, 23.40it/s][5/6] extract embeddings:  37%|███▋      | 31/84 [00:02<00:02, 24.09it/s][5/6] extract embeddings:  40%|████      | 34/84 [00:02<00:02, 23.68it/s][5/6] extract embeddings:  44%|████▍     | 37/84 [00:02<00:01, 24.54it/s][5/6] extract embeddings:  48%|████▊     | 40/84 [00:02<00:01, 25.00it/s][5/6] extract embeddings:  51%|█████     | 43/84 [00:02<00:01, 24.82it/s][5/6] extract embeddings:  55%|█████▍    | 46/84 [00:02<00:01, 25.84it/s][5/6] extract embeddings:  58%|█████▊    | 49/84 [00:02<00:01, 25.34it/s][5/6] extract embeddings:  62%|██████▏   | 52/84 [00:03<00:01, 25.40it/s][5/6] extract embeddings:  65%|██████▌   | 55/84 [00:03<00:01, 25.80it/s][5/6] extract embeddings:  69%|██████▉   | 58/84 [00:03<00:00, 26.19it/s][5/6] extract embeddings:  73%|███████▎  | 61/84 [00:03<00:00, 25.79it/s][5/6] extract embeddings:  76%|███████▌  | 64/84 [00:03<00:00, 26.08it/s][5/6] extract embeddings:  80%|███████▉  | 67/84 [00:03<00:00, 26.74it/s][5/6] extract embeddings:  83%|████████▎ | 70/84 [00:03<00:00, 25.39it/s][5/6] extract embeddings:  87%|████████▋ | 73/84 [00:03<00:00, 25.31it/s][5/6] extract embeddings:  90%|█████████ | 76/84 [00:04<00:00, 24.91it/s][5/6] extract embeddings:  94%|█████████▍| 79/84 [00:04<00:00, 25.12it/s][5/6] extract embeddings:  98%|█████████▊| 82/84 [00:04<00:00, 25.46it/s][5/6] extract embeddings: 100%|██████████| 84/84 [00:04<00:00, 19.28it/s]
[NeMo I 2025-04-17 01:35:54 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:35:54 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:35:54 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:35:54 collections:880] Dataset successfully loaded with 10840 items and total duration provided from manifest is  1.44 hours.
[NeMo I 2025-04-17 01:35:54 collections:886] # 10840 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/170 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/170 [00:01<03:47,  1.34s/it][6/6] extract embeddings:   3%|▎         | 5/170 [00:01<00:36,  4.49it/s][6/6] extract embeddings:   5%|▌         | 9/170 [00:01<00:18,  8.51it/s][6/6] extract embeddings:   8%|▊         | 13/170 [00:01<00:12, 12.74it/s][6/6] extract embeddings:  10%|█         | 17/170 [00:01<00:09, 16.87it/s][6/6] extract embeddings:  12%|█▏        | 21/170 [00:01<00:07, 20.44it/s][6/6] extract embeddings:  15%|█▍        | 25/170 [00:02<00:06, 23.70it/s][6/6] extract embeddings:  17%|█▋        | 29/170 [00:02<00:05, 26.31it/s][6/6] extract embeddings:  19%|█▉        | 33/170 [00:02<00:04, 28.08it/s][6/6] extract embeddings:  22%|██▏       | 37/170 [00:02<00:04, 29.90it/s][6/6] extract embeddings:  24%|██▍       | 41/170 [00:02<00:04, 30.80it/s][6/6] extract embeddings:  26%|██▋       | 45/170 [00:02<00:03, 31.62it/s][6/6] extract embeddings:  29%|██▉       | 49/170 [00:02<00:03, 31.24it/s][6/6] extract embeddings:  31%|███       | 53/170 [00:02<00:03, 31.94it/s][6/6] extract embeddings:  34%|███▎      | 57/170 [00:02<00:03, 32.89it/s][6/6] extract embeddings:  36%|███▌      | 61/170 [00:03<00:03, 33.03it/s][6/6] extract embeddings:  38%|███▊      | 65/170 [00:03<00:03, 33.00it/s][6/6] extract embeddings:  41%|████      | 69/170 [00:03<00:03, 33.08it/s][6/6] extract embeddings:  43%|████▎     | 73/170 [00:03<00:02, 33.13it/s][6/6] extract embeddings:  45%|████▌     | 77/170 [00:03<00:02, 32.62it/s][6/6] extract embeddings:  48%|████▊     | 81/170 [00:03<00:02, 32.63it/s][6/6] extract embeddings:  50%|█████     | 85/170 [00:03<00:02, 32.48it/s][6/6] extract embeddings:  52%|█████▏    | 89/170 [00:03<00:02, 33.25it/s][6/6] extract embeddings:  55%|█████▍    | 93/170 [00:04<00:02, 33.52it/s][6/6] extract embeddings:  57%|█████▋    | 97/170 [00:04<00:02, 33.65it/s][6/6] extract embeddings:  59%|█████▉    | 101/170 [00:04<00:02, 33.94it/s][6/6] extract embeddings:  62%|██████▏   | 105/170 [00:04<00:01, 34.10it/s][6/6] extract embeddings:  64%|██████▍   | 109/170 [00:04<00:01, 33.75it/s][6/6] extract embeddings:  66%|██████▋   | 113/170 [00:04<00:01, 33.74it/s][6/6] extract embeddings:  69%|██████▉   | 117/170 [00:04<00:01, 33.77it/s][6/6] extract embeddings:  71%|███████   | 121/170 [00:04<00:01, 33.94it/s][6/6] extract embeddings:  74%|███████▎  | 125/170 [00:05<00:01, 33.83it/s][6/6] extract embeddings:  76%|███████▌  | 129/170 [00:05<00:01, 34.01it/s][6/6] extract embeddings:  78%|███████▊  | 133/170 [00:05<00:01, 34.16it/s][6/6] extract embeddings:  81%|████████  | 137/170 [00:05<00:00, 33.99it/s][6/6] extract embeddings:  83%|████████▎ | 141/170 [00:05<00:00, 33.33it/s][6/6] extract embeddings:  85%|████████▌ | 145/170 [00:05<00:00, 33.50it/s][6/6] extract embeddings:  88%|████████▊ | 149/170 [00:05<00:00, 34.52it/s][6/6] extract embeddings:  90%|█████████ | 153/170 [00:05<00:00, 33.88it/s][6/6] extract embeddings:  92%|█████████▏| 157/170 [00:05<00:00, 34.28it/s][6/6] extract embeddings:  95%|█████████▍| 161/170 [00:06<00:00, 33.80it/s][6/6] extract embeddings:  97%|█████████▋| 165/170 [00:06<00:00, 34.61it/s][6/6] extract embeddings:  99%|█████████▉| 169/170 [00:06<00:00, 34.11it/s][6/6] extract embeddings: 100%|██████████| 170/170 [00:06<00:00, 26.63it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.97it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.03it/s]clustering:  75%|███████▌  | 3/4 [00:02<00:00,  1.57it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.05it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s]
[NeMo I 2025-04-17 01:36:04 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:36:05 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              48.364242   444.120  ...  14.455072  3.254767
    Harker-ES                       41.888914  2178.782  ...  47.718793  2.190159
    Harker-MN                       50.534603   366.767  ...  26.823040  7.313373
    Longfellow-Block-1              36.621334   492.417  ...   8.419970  1.709927
    TOTAL                           42.880541  3482.086  ...  97.416875  2.797659
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:36:05 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0614 | MISS: 0.3394 | CER: 0.0280 | DER: 0.4288 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.81s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.94s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.25s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.08it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:36:16 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:36:16 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:36:16 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:36:16 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:36:16 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:36:17 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:36:17 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:36:17 features:305] PADDING: 16
[NeMo I 2025-04-17 01:36:17 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:36:17 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:36:17 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:36:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:36:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:36:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:36:17 collections:880] Dataset successfully loaded with 2086 items and total duration provided from manifest is  1.02 hours.
[NeMo I 2025-04-17 01:36:17 collections:886] # 2086 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  1.99s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.46it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.98it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.74it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.45it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  9.29it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 11.07it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 13.70it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 14.56it/s][1/6] extract embeddings:  64%|██████▎   | 21/33 [00:03<00:00, 15.27it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:03<00:00, 16.12it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 15.99it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 16.47it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 16.33it/s][1/6] extract embeddings:  94%|█████████▍| 31/33 [00:03<00:00, 17.22it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.92it/s]
[NeMo I 2025-04-17 01:36:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:36:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:36:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:36:21 collections:880] Dataset successfully loaded with 2367 items and total duration provided from manifest is  1.07 hours.
[NeMo I 2025-04-17 01:36:21 collections:886] # 2367 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:50,  1.39s/it][2/6] extract embeddings:   8%|▊         | 3/37 [00:01<00:13,  2.51it/s][2/6] extract embeddings:  16%|█▌        | 6/37 [00:01<00:05,  5.39it/s][2/6] extract embeddings:  22%|██▏       | 8/37 [00:01<00:03,  7.26it/s][2/6] extract embeddings:  30%|██▉       | 11/37 [00:01<00:02, 10.10it/s][2/6] extract embeddings:  35%|███▌      | 13/37 [00:02<00:02, 11.81it/s][2/6] extract embeddings:  41%|████      | 15/37 [00:02<00:01, 13.43it/s][2/6] extract embeddings:  49%|████▊     | 18/37 [00:02<00:01, 15.73it/s][2/6] extract embeddings:  57%|█████▋    | 21/37 [00:02<00:00, 17.25it/s][2/6] extract embeddings:  65%|██████▍   | 24/37 [00:02<00:00, 18.00it/s][2/6] extract embeddings:  70%|███████   | 26/37 [00:02<00:00, 17.82it/s][2/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 18.33it/s][2/6] extract embeddings:  81%|████████  | 30/37 [00:02<00:00, 18.53it/s][2/6] extract embeddings:  86%|████████▋ | 32/37 [00:02<00:00, 18.24it/s][2/6] extract embeddings:  95%|█████████▍| 35/37 [00:03<00:00, 19.06it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 18.17it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 11.28it/s]
[NeMo I 2025-04-17 01:36:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:36:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:36:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:36:25 collections:880] Dataset successfully loaded with 2777 items and total duration provided from manifest is  1.13 hours.
[NeMo I 2025-04-17 01:36:25 collections:886] # 2777 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:53,  1.24s/it][3/6] extract embeddings:   9%|▉         | 4/44 [00:01<00:10,  3.66it/s][3/6] extract embeddings:  14%|█▎        | 6/44 [00:01<00:06,  5.65it/s][3/6] extract embeddings:  20%|██        | 9/44 [00:01<00:04,  8.71it/s][3/6] extract embeddings:  27%|██▋       | 12/44 [00:01<00:02, 11.41it/s][3/6] extract embeddings:  34%|███▍      | 15/44 [00:01<00:02, 13.76it/s][3/6] extract embeddings:  41%|████      | 18/44 [00:02<00:01, 15.73it/s][3/6] extract embeddings:  48%|████▊     | 21/44 [00:02<00:01, 17.22it/s][3/6] extract embeddings:  55%|█████▍    | 24/44 [00:02<00:01, 18.51it/s][3/6] extract embeddings:  61%|██████▏   | 27/44 [00:02<00:00, 18.83it/s][3/6] extract embeddings:  68%|██████▊   | 30/44 [00:02<00:00, 19.65it/s][3/6] extract embeddings:  75%|███████▌  | 33/44 [00:02<00:00, 19.58it/s][3/6] extract embeddings:  82%|████████▏ | 36/44 [00:02<00:00, 20.30it/s][3/6] extract embeddings:  89%|████████▊ | 39/44 [00:03<00:00, 20.18it/s][3/6] extract embeddings:  95%|█████████▌| 42/44 [00:03<00:00, 20.36it/s][3/6] extract embeddings: 100%|██████████| 44/44 [00:03<00:00, 13.30it/s]
[NeMo I 2025-04-17 01:36:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:36:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:36:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:36:28 collections:880] Dataset successfully loaded with 3544 items and total duration provided from manifest is  1.20 hours.
[NeMo I 2025-04-17 01:36:28 collections:886] # 3544 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/56 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/56 [00:01<01:03,  1.16s/it][4/6] extract embeddings:   7%|▋         | 4/56 [00:01<00:13,  3.95it/s][4/6] extract embeddings:  12%|█▎        | 7/56 [00:01<00:06,  7.10it/s][4/6] extract embeddings:  18%|█▊        | 10/56 [00:01<00:04, 10.10it/s][4/6] extract embeddings:  23%|██▎       | 13/56 [00:01<00:03, 13.18it/s][4/6] extract embeddings:  29%|██▊       | 16/56 [00:01<00:02, 15.59it/s][4/6] extract embeddings:  34%|███▍      | 19/56 [00:01<00:02, 17.27it/s][4/6] extract embeddings:  39%|███▉      | 22/56 [00:02<00:01, 18.75it/s][4/6] extract embeddings:  45%|████▍     | 25/56 [00:02<00:01, 19.93it/s][4/6] extract embeddings:  50%|█████     | 28/56 [00:02<00:01, 20.99it/s][4/6] extract embeddings:  55%|█████▌    | 31/56 [00:02<00:01, 21.72it/s][4/6] extract embeddings:  61%|██████    | 34/56 [00:02<00:01, 21.54it/s][4/6] extract embeddings:  66%|██████▌   | 37/56 [00:02<00:00, 22.18it/s][4/6] extract embeddings:  71%|███████▏  | 40/56 [00:02<00:00, 22.61it/s][4/6] extract embeddings:  77%|███████▋  | 43/56 [00:02<00:00, 22.11it/s][4/6] extract embeddings:  82%|████████▏ | 46/56 [00:03<00:00, 22.32it/s][4/6] extract embeddings:  88%|████████▊ | 49/56 [00:03<00:00, 22.25it/s][4/6] extract embeddings:  93%|█████████▎| 52/56 [00:03<00:00, 22.95it/s][4/6] extract embeddings:  98%|█████████▊| 55/56 [00:03<00:00, 22.53it/s][4/6] extract embeddings: 100%|██████████| 56/56 [00:03<00:00, 15.74it/s]
[NeMo I 2025-04-17 01:36:32 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:36:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:36:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:36:32 collections:880] Dataset successfully loaded with 5222 items and total duration provided from manifest is  1.29 hours.
[NeMo I 2025-04-17 01:36:32 collections:886] # 5222 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/82 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/82 [00:01<01:49,  1.35s/it][5/6] extract embeddings:   5%|▍         | 4/82 [00:01<00:22,  3.51it/s][5/6] extract embeddings:   9%|▊         | 7/82 [00:01<00:11,  6.60it/s][5/6] extract embeddings:  12%|█▏        | 10/82 [00:01<00:07,  9.93it/s][5/6] extract embeddings:  16%|█▌        | 13/82 [00:01<00:05, 13.07it/s][5/6] extract embeddings:  21%|██        | 17/82 [00:01<00:03, 16.92it/s][5/6] extract embeddings:  26%|██▌       | 21/82 [00:02<00:03, 20.04it/s][5/6] extract embeddings:  29%|██▉       | 24/82 [00:02<00:02, 21.64it/s][5/6] extract embeddings:  33%|███▎      | 27/82 [00:02<00:02, 22.89it/s][5/6] extract embeddings:  37%|███▋      | 30/82 [00:02<00:02, 24.00it/s][5/6] extract embeddings:  40%|████      | 33/82 [00:02<00:01, 25.29it/s][5/6] extract embeddings:  44%|████▍     | 36/82 [00:02<00:01, 26.35it/s][5/6] extract embeddings:  48%|████▊     | 39/82 [00:02<00:01, 26.68it/s][5/6] extract embeddings:  51%|█████     | 42/82 [00:02<00:01, 26.96it/s][5/6] extract embeddings:  55%|█████▍    | 45/82 [00:02<00:01, 27.31it/s][5/6] extract embeddings:  59%|█████▊    | 48/82 [00:03<00:01, 27.46it/s][5/6] extract embeddings:  62%|██████▏   | 51/82 [00:03<00:01, 27.13it/s][5/6] extract embeddings:  66%|██████▌   | 54/82 [00:03<00:01, 27.75it/s][5/6] extract embeddings:  70%|██████▉   | 57/82 [00:03<00:00, 27.45it/s][5/6] extract embeddings:  73%|███████▎  | 60/82 [00:03<00:00, 27.41it/s][5/6] extract embeddings:  77%|███████▋  | 63/82 [00:03<00:00, 27.57it/s][5/6] extract embeddings:  80%|████████  | 66/82 [00:03<00:00, 27.71it/s][5/6] extract embeddings:  84%|████████▍ | 69/82 [00:03<00:00, 27.27it/s][5/6] extract embeddings:  88%|████████▊ | 72/82 [00:03<00:00, 27.78it/s][5/6] extract embeddings:  91%|█████████▏| 75/82 [00:04<00:00, 27.29it/s][5/6] extract embeddings:  95%|█████████▌| 78/82 [00:04<00:00, 26.56it/s][5/6] extract embeddings:  99%|█████████▉| 81/82 [00:04<00:00, 26.89it/s][5/6] extract embeddings: 100%|██████████| 82/82 [00:04<00:00, 18.98it/s]
[NeMo I 2025-04-17 01:36:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:36:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:36:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:36:36 collections:880] Dataset successfully loaded with 10570 items and total duration provided from manifest is  1.40 hours.
[NeMo I 2025-04-17 01:36:36 collections:886] # 10570 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/166 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/166 [00:01<03:05,  1.12s/it][6/6] extract embeddings:   3%|▎         | 5/166 [00:01<00:31,  5.18it/s][6/6] extract embeddings:   5%|▌         | 9/166 [00:01<00:16,  9.57it/s][6/6] extract embeddings:   8%|▊         | 13/166 [00:01<00:10, 14.14it/s][6/6] extract embeddings:  10%|█         | 17/166 [00:01<00:08, 17.93it/s][6/6] extract embeddings:  13%|█▎        | 21/166 [00:01<00:06, 21.67it/s][6/6] extract embeddings:  15%|█▌        | 25/166 [00:01<00:05, 24.50it/s][6/6] extract embeddings:  17%|█▋        | 29/166 [00:01<00:05, 26.26it/s][6/6] extract embeddings:  20%|█▉        | 33/166 [00:02<00:04, 28.31it/s][6/6] extract embeddings:  22%|██▏       | 37/166 [00:02<00:04, 29.93it/s][6/6] extract embeddings:  25%|██▍       | 41/166 [00:02<00:03, 31.65it/s][6/6] extract embeddings:  27%|██▋       | 45/166 [00:02<00:03, 32.09it/s][6/6] extract embeddings:  30%|██▉       | 49/166 [00:02<00:03, 32.12it/s][6/6] extract embeddings:  32%|███▏      | 53/166 [00:02<00:03, 32.77it/s][6/6] extract embeddings:  34%|███▍      | 57/166 [00:02<00:03, 31.29it/s][6/6] extract embeddings:  37%|███▋      | 61/166 [00:02<00:03, 31.90it/s][6/6] extract embeddings:  39%|███▉      | 65/166 [00:03<00:03, 32.01it/s][6/6] extract embeddings:  42%|████▏     | 69/166 [00:03<00:02, 32.72it/s][6/6] extract embeddings:  44%|████▍     | 73/166 [00:03<00:02, 32.49it/s][6/6] extract embeddings:  46%|████▋     | 77/166 [00:03<00:02, 32.96it/s][6/6] extract embeddings:  49%|████▉     | 81/166 [00:03<00:02, 33.17it/s][6/6] extract embeddings:  51%|█████     | 85/166 [00:03<00:02, 32.66it/s][6/6] extract embeddings:  54%|█████▎    | 89/166 [00:03<00:02, 33.82it/s][6/6] extract embeddings:  56%|█████▌    | 93/166 [00:03<00:02, 32.11it/s][6/6] extract embeddings:  58%|█████▊    | 97/166 [00:04<00:02, 32.08it/s][6/6] extract embeddings:  61%|██████    | 101/166 [00:04<00:01, 32.59it/s][6/6] extract embeddings:  63%|██████▎   | 105/166 [00:04<00:01, 31.93it/s][6/6] extract embeddings:  66%|██████▌   | 109/166 [00:04<00:01, 32.50it/s][6/6] extract embeddings:  68%|██████▊   | 113/166 [00:04<00:01, 32.95it/s][6/6] extract embeddings:  70%|███████   | 117/166 [00:04<00:01, 31.20it/s][6/6] extract embeddings:  73%|███████▎  | 121/166 [00:04<00:01, 32.18it/s][6/6] extract embeddings:  75%|███████▌  | 125/166 [00:04<00:01, 32.58it/s][6/6] extract embeddings:  78%|███████▊  | 129/166 [00:05<00:01, 31.37it/s][6/6] extract embeddings:  80%|████████  | 133/166 [00:05<00:01, 32.45it/s][6/6] extract embeddings:  83%|████████▎ | 137/166 [00:05<00:00, 33.32it/s][6/6] extract embeddings:  85%|████████▍ | 141/166 [00:05<00:00, 33.84it/s][6/6] extract embeddings:  87%|████████▋ | 145/166 [00:05<00:00, 34.59it/s][6/6] extract embeddings:  90%|████████▉ | 149/166 [00:05<00:00, 34.93it/s][6/6] extract embeddings:  92%|█████████▏| 153/166 [00:05<00:00, 33.67it/s][6/6] extract embeddings:  95%|█████████▍| 157/166 [00:05<00:00, 33.76it/s][6/6] extract embeddings:  97%|█████████▋| 161/166 [00:05<00:00, 33.03it/s][6/6] extract embeddings:  99%|█████████▉| 165/166 [00:06<00:00, 33.98it/s][6/6] extract embeddings: 100%|██████████| 166/166 [00:06<00:00, 27.01it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.04it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.70it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.40it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.50it/s]
[NeMo I 2025-04-17 01:36:45 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:36:46 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              49.974147   444.120  ...  15.925093  3.585764
    Harker-ES                       43.149924  2178.782  ...  46.100881  2.115901
    Harker-MN                       51.471970   366.767  ...  28.307986  7.718248
    Longfellow-Block-1              37.546165   492.417  ...   7.583990  1.540156
    TOTAL                           44.104421  3482.086  ...  97.917950  2.812049
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:36:46 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0592 | MISS: 0.3537 | CER: 0.0281 | DER: 0.4410 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.81s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.93s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.16s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:36:58 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:36:58 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:36:58 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:36:58 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:36:58 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:36:58 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:36:58 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:36:58 features:305] PADDING: 16
[NeMo I 2025-04-17 01:36:58 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:36:58 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:36:58 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:36:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:36:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:36:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:36:58 collections:880] Dataset successfully loaded with 2083 items and total duration provided from manifest is  0.98 hours.
[NeMo I 2025-04-17 01:36:58 collections:886] # 2083 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:05,  2.06s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:12,  2.38it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.51it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.07it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  7.70it/s][1/6] extract embeddings:  39%|███▉      | 13/33 [00:02<00:02,  9.45it/s][1/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 10.95it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:01, 13.30it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:03<00:00, 14.17it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 15.32it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 16.76it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 16.73it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 16.84it/s][1/6] extract embeddings:  94%|█████████▍| 31/33 [00:03<00:00, 17.31it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.78it/s]
[NeMo I 2025-04-17 01:37:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:37:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:02 collections:880] Dataset successfully loaded with 2343 items and total duration provided from manifest is  1.03 hours.
[NeMo I 2025-04-17 01:37:02 collections:886] # 2343 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:49,  1.37s/it][2/6] extract embeddings:   8%|▊         | 3/37 [00:01<00:13,  2.52it/s][2/6] extract embeddings:  14%|█▎        | 5/37 [00:01<00:07,  4.48it/s][2/6] extract embeddings:  22%|██▏       | 8/37 [00:01<00:03,  7.63it/s][2/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02,  9.55it/s][2/6] extract embeddings:  32%|███▏      | 12/37 [00:01<00:02, 11.07it/s][2/6] extract embeddings:  41%|████      | 15/37 [00:02<00:01, 13.73it/s][2/6] extract embeddings:  46%|████▌     | 17/37 [00:02<00:01, 14.85it/s][2/6] extract embeddings:  51%|█████▏    | 19/37 [00:02<00:01, 15.95it/s][2/6] extract embeddings:  57%|█████▋    | 21/37 [00:02<00:00, 16.49it/s][2/6] extract embeddings:  62%|██████▏   | 23/37 [00:02<00:00, 17.02it/s][2/6] extract embeddings:  70%|███████   | 26/37 [00:02<00:00, 18.43it/s][2/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 17.95it/s][2/6] extract embeddings:  81%|████████  | 30/37 [00:02<00:00, 18.25it/s][2/6] extract embeddings:  86%|████████▋ | 32/37 [00:03<00:00, 18.30it/s][2/6] extract embeddings:  92%|█████████▏| 34/37 [00:03<00:00, 18.23it/s][2/6] extract embeddings:  97%|█████████▋| 36/37 [00:03<00:00, 18.36it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 11.25it/s]
[NeMo I 2025-04-17 01:37:06 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:37:06 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:06 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:06 collections:880] Dataset successfully loaded with 2737 items and total duration provided from manifest is  1.09 hours.
[NeMo I 2025-04-17 01:37:06 collections:886] # 2737 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:48,  1.15s/it][3/6] extract embeddings:   9%|▉         | 4/43 [00:01<00:10,  3.85it/s][3/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:05,  6.89it/s][3/6] extract embeddings:  23%|██▎       | 10/43 [00:01<00:03,  9.75it/s][3/6] extract embeddings:  30%|███       | 13/43 [00:01<00:02, 12.01it/s][3/6] extract embeddings:  37%|███▋      | 16/43 [00:01<00:01, 14.27it/s][3/6] extract embeddings:  44%|████▍     | 19/43 [00:02<00:01, 15.77it/s][3/6] extract embeddings:  49%|████▉     | 21/43 [00:02<00:01, 16.21it/s][3/6] extract embeddings:  56%|█████▌    | 24/43 [00:02<00:01, 17.59it/s][3/6] extract embeddings:  63%|██████▎   | 27/43 [00:02<00:00, 18.49it/s][3/6] extract embeddings:  70%|██████▉   | 30/43 [00:02<00:00, 19.16it/s][3/6] extract embeddings:  77%|███████▋  | 33/43 [00:02<00:00, 19.42it/s][3/6] extract embeddings:  84%|████████▎ | 36/43 [00:02<00:00, 19.04it/s][3/6] extract embeddings:  91%|█████████ | 39/43 [00:03<00:00, 19.77it/s][3/6] extract embeddings:  98%|█████████▊| 42/43 [00:03<00:00, 20.00it/s][3/6] extract embeddings: 100%|██████████| 43/43 [00:03<00:00, 13.25it/s]
[NeMo I 2025-04-17 01:37:09 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:37:09 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:09 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:09 collections:880] Dataset successfully loaded with 3474 items and total duration provided from manifest is  1.16 hours.
[NeMo I 2025-04-17 01:37:09 collections:886] # 3474 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/55 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/55 [00:01<01:04,  1.19s/it][4/6] extract embeddings:   7%|▋         | 4/55 [00:01<00:13,  3.86it/s][4/6] extract embeddings:  13%|█▎        | 7/55 [00:01<00:06,  6.98it/s][4/6] extract embeddings:  18%|█▊        | 10/55 [00:01<00:04, 10.20it/s][4/6] extract embeddings:  24%|██▎       | 13/55 [00:01<00:03, 13.06it/s][4/6] extract embeddings:  29%|██▉       | 16/55 [00:01<00:02, 15.38it/s][4/6] extract embeddings:  35%|███▍      | 19/55 [00:01<00:02, 17.09it/s][4/6] extract embeddings:  40%|████      | 22/55 [00:02<00:01, 18.40it/s][4/6] extract embeddings:  45%|████▌     | 25/55 [00:02<00:01, 19.58it/s][4/6] extract embeddings:  51%|█████     | 28/55 [00:02<00:01, 20.96it/s][4/6] extract embeddings:  56%|█████▋    | 31/55 [00:02<00:01, 20.80it/s][4/6] extract embeddings:  62%|██████▏   | 34/55 [00:02<00:00, 21.31it/s][4/6] extract embeddings:  67%|██████▋   | 37/55 [00:02<00:00, 21.89it/s][4/6] extract embeddings:  73%|███████▎  | 40/55 [00:02<00:00, 21.49it/s][4/6] extract embeddings:  78%|███████▊  | 43/55 [00:03<00:00, 21.84it/s][4/6] extract embeddings:  84%|████████▎ | 46/55 [00:03<00:00, 21.10it/s][4/6] extract embeddings:  89%|████████▉ | 49/55 [00:03<00:00, 21.09it/s][4/6] extract embeddings:  95%|█████████▍| 52/55 [00:03<00:00, 21.23it/s][4/6] extract embeddings: 100%|██████████| 55/55 [00:03<00:00, 22.82it/s][4/6] extract embeddings: 100%|██████████| 55/55 [00:03<00:00, 15.27it/s]
[NeMo I 2025-04-17 01:37:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:37:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:13 collections:880] Dataset successfully loaded with 5096 items and total duration provided from manifest is  1.25 hours.
[NeMo I 2025-04-17 01:37:13 collections:886] # 5096 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/80 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/80 [00:01<01:31,  1.16s/it][5/6] extract embeddings:   6%|▋         | 5/80 [00:01<00:15,  4.86it/s][5/6] extract embeddings:  10%|█         | 8/80 [00:01<00:08,  8.01it/s][5/6] extract embeddings:  14%|█▍        | 11/80 [00:01<00:06, 11.07it/s][5/6] extract embeddings:  18%|█▊        | 14/80 [00:01<00:04, 13.88it/s][5/6] extract embeddings:  21%|██▏       | 17/80 [00:01<00:03, 16.55it/s][5/6] extract embeddings:  25%|██▌       | 20/80 [00:01<00:03, 18.78it/s][5/6] extract embeddings:  29%|██▉       | 23/80 [00:02<00:02, 20.62it/s][5/6] extract embeddings:  32%|███▎      | 26/80 [00:02<00:02, 21.71it/s][5/6] extract embeddings:  36%|███▋      | 29/80 [00:02<00:02, 23.00it/s][5/6] extract embeddings:  40%|████      | 32/80 [00:02<00:02, 23.87it/s][5/6] extract embeddings:  44%|████▍     | 35/80 [00:02<00:01, 24.30it/s][5/6] extract embeddings:  48%|████▊     | 38/80 [00:02<00:01, 24.88it/s][5/6] extract embeddings:  51%|█████▏    | 41/80 [00:02<00:01, 25.40it/s][5/6] extract embeddings:  55%|█████▌    | 44/80 [00:02<00:01, 23.89it/s][5/6] extract embeddings:  59%|█████▉    | 47/80 [00:02<00:01, 24.29it/s][5/6] extract embeddings:  62%|██████▎   | 50/80 [00:03<00:01, 25.17it/s][5/6] extract embeddings:  66%|██████▋   | 53/80 [00:03<00:01, 26.06it/s][5/6] extract embeddings:  70%|███████   | 56/80 [00:03<00:00, 25.52it/s][5/6] extract embeddings:  74%|███████▍  | 59/80 [00:03<00:00, 24.45it/s][5/6] extract embeddings:  78%|███████▊  | 62/80 [00:03<00:00, 23.86it/s][5/6] extract embeddings:  81%|████████▏ | 65/80 [00:03<00:00, 24.09it/s][5/6] extract embeddings:  85%|████████▌ | 68/80 [00:03<00:00, 24.28it/s][5/6] extract embeddings:  89%|████████▉ | 71/80 [00:03<00:00, 23.70it/s][5/6] extract embeddings:  92%|█████████▎| 74/80 [00:04<00:00, 24.18it/s][5/6] extract embeddings:  96%|█████████▋| 77/80 [00:04<00:00, 23.82it/s][5/6] extract embeddings: 100%|██████████| 80/80 [00:04<00:00, 22.46it/s][5/6] extract embeddings: 100%|██████████| 80/80 [00:04<00:00, 18.28it/s]
[NeMo I 2025-04-17 01:37:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:37:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:22 collections:880] Dataset successfully loaded with 10284 items and total duration provided from manifest is  1.36 hours.
[NeMo I 2025-04-17 01:37:22 collections:886] # 10284 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/161 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/161 [00:01<03:19,  1.25s/it][6/6] extract embeddings:   3%|▎         | 5/161 [00:01<00:33,  4.73it/s][6/6] extract embeddings:   6%|▌         | 9/161 [00:01<00:17,  8.89it/s][6/6] extract embeddings:   8%|▊         | 13/161 [00:01<00:11, 13.06it/s][6/6] extract embeddings:  11%|█         | 17/161 [00:01<00:08, 17.04it/s][6/6] extract embeddings:  13%|█▎        | 21/161 [00:01<00:06, 20.61it/s][6/6] extract embeddings:  16%|█▌        | 25/161 [00:01<00:05, 23.46it/s][6/6] extract embeddings:  18%|█▊        | 29/161 [00:02<00:05, 26.17it/s][6/6] extract embeddings:  20%|██        | 33/161 [00:02<00:04, 28.60it/s][6/6] extract embeddings:  23%|██▎       | 37/161 [00:02<00:04, 29.48it/s][6/6] extract embeddings:  25%|██▌       | 41/161 [00:02<00:03, 30.48it/s][6/6] extract embeddings:  28%|██▊       | 45/161 [00:02<00:03, 30.45it/s][6/6] extract embeddings:  30%|███       | 49/161 [00:02<00:03, 31.82it/s][6/6] extract embeddings:  33%|███▎      | 53/161 [00:02<00:03, 31.86it/s][6/6] extract embeddings:  35%|███▌      | 57/161 [00:02<00:03, 31.91it/s][6/6] extract embeddings:  38%|███▊      | 61/161 [00:03<00:03, 31.85it/s][6/6] extract embeddings:  40%|████      | 65/161 [00:03<00:02, 32.05it/s][6/6] extract embeddings:  43%|████▎     | 69/161 [00:03<00:02, 31.15it/s][6/6] extract embeddings:  45%|████▌     | 73/161 [00:03<00:02, 32.08it/s][6/6] extract embeddings:  48%|████▊     | 77/161 [00:03<00:02, 31.84it/s][6/6] extract embeddings:  50%|█████     | 81/161 [00:03<00:02, 31.65it/s][6/6] extract embeddings:  53%|█████▎    | 85/161 [00:03<00:02, 31.83it/s][6/6] extract embeddings:  55%|█████▌    | 89/161 [00:03<00:02, 32.37it/s][6/6] extract embeddings:  58%|█████▊    | 93/161 [00:04<00:02, 32.72it/s][6/6] extract embeddings:  60%|██████    | 97/161 [00:04<00:01, 32.45it/s][6/6] extract embeddings:  63%|██████▎   | 101/161 [00:04<00:01, 32.99it/s][6/6] extract embeddings:  65%|██████▌   | 105/161 [00:04<00:01, 32.87it/s][6/6] extract embeddings:  68%|██████▊   | 109/161 [00:04<00:01, 33.57it/s][6/6] extract embeddings:  70%|███████   | 113/161 [00:04<00:01, 31.59it/s][6/6] extract embeddings:  73%|███████▎  | 117/161 [00:04<00:01, 32.32it/s][6/6] extract embeddings:  75%|███████▌  | 121/161 [00:04<00:01, 33.03it/s][6/6] extract embeddings:  78%|███████▊  | 125/161 [00:05<00:01, 31.75it/s][6/6] extract embeddings:  80%|████████  | 129/161 [00:05<00:00, 32.31it/s][6/6] extract embeddings:  83%|████████▎ | 133/161 [00:05<00:00, 32.43it/s][6/6] extract embeddings:  85%|████████▌ | 137/161 [00:05<00:00, 31.94it/s][6/6] extract embeddings:  88%|████████▊ | 141/161 [00:05<00:00, 32.66it/s][6/6] extract embeddings:  90%|█████████ | 145/161 [00:05<00:00, 32.56it/s][6/6] extract embeddings:  93%|█████████▎| 149/161 [00:05<00:00, 33.09it/s][6/6] extract embeddings:  95%|█████████▌| 153/161 [00:05<00:00, 32.93it/s][6/6] extract embeddings:  98%|█████████▊| 157/161 [00:06<00:00, 31.70it/s][6/6] extract embeddings: 100%|██████████| 161/161 [00:06<00:00, 31.14it/s][6/6] extract embeddings: 100%|██████████| 161/161 [00:06<00:00, 25.92it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.04it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.72it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.45it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.55it/s]
[NeMo I 2025-04-17 01:37:30 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:37:32 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              50.967104   444.120  ...  15.405018  3.468661
    Harker-ES                       44.042005  2178.782  ...  39.692187  1.821760
    Harker-MN                       51.728527   366.767  ...  29.420993  8.021712
    Longfellow-Block-1              39.194748   492.417  ...   8.205977  1.666469
    TOTAL                           45.049409  3482.086  ...  92.724175  2.662892
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:37:32 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0566 | MISS: 0.3672 | CER: 0.0266 | DER: 0.4505 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.79s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.93s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.16s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:37:43 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:37:43 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:37:43 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:37:43 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:37:43 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:37:43 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:37:43 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:37:43 features:305] PADDING: 16
[NeMo I 2025-04-17 01:37:44 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:37:44 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:37:44 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:37:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:37:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:44 collections:880] Dataset successfully loaded with 2075 items and total duration provided from manifest is  0.94 hours.
[NeMo I 2025-04-17 01:37:44 collections:886] # 2075 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  1.99s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.46it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.98it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.74it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.44it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  9.35it/s][1/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 12.04it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 13.49it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 14.73it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 16.33it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 16.76it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 17.49it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 17.42it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 18.08it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 18.09it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  9.08it/s]
[NeMo I 2025-04-17 01:37:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:37:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:48 collections:880] Dataset successfully loaded with 2319 items and total duration provided from manifest is  0.99 hours.
[NeMo I 2025-04-17 01:37:48 collections:886] # 2319 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:51,  1.42s/it][2/6] extract embeddings:  11%|█         | 4/37 [00:01<00:10,  3.23it/s][2/6] extract embeddings:  16%|█▌        | 6/37 [00:01<00:06,  5.06it/s][2/6] extract embeddings:  24%|██▍       | 9/37 [00:01<00:03,  8.02it/s][2/6] extract embeddings:  30%|██▉       | 11/37 [00:01<00:02,  9.86it/s][2/6] extract embeddings:  35%|███▌      | 13/37 [00:02<00:02, 11.68it/s][2/6] extract embeddings:  41%|████      | 15/37 [00:02<00:01, 12.81it/s][2/6] extract embeddings:  49%|████▊     | 18/37 [00:02<00:01, 15.40it/s][2/6] extract embeddings:  57%|█████▋    | 21/37 [00:02<00:00, 16.27it/s][2/6] extract embeddings:  65%|██████▍   | 24/37 [00:02<00:00, 17.55it/s][2/6] extract embeddings:  70%|███████   | 26/37 [00:02<00:00, 18.05it/s][2/6] extract embeddings:  78%|███████▊  | 29/37 [00:02<00:00, 18.71it/s][2/6] extract embeddings:  84%|████████▍ | 31/37 [00:02<00:00, 18.12it/s][2/6] extract embeddings:  89%|████████▉ | 33/37 [00:03<00:00, 18.47it/s][2/6] extract embeddings:  97%|█████████▋| 36/37 [00:03<00:00, 19.54it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 11.34it/s]
[NeMo I 2025-04-17 01:37:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:37:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:51 collections:880] Dataset successfully loaded with 2686 items and total duration provided from manifest is  1.04 hours.
[NeMo I 2025-04-17 01:37:51 collections:886] # 2686 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:47,  1.15s/it][3/6] extract embeddings:  10%|▉         | 4/42 [00:01<00:09,  3.91it/s][3/6] extract embeddings:  14%|█▍        | 6/42 [00:01<00:06,  6.00it/s][3/6] extract embeddings:  21%|██▏       | 9/42 [00:01<00:03,  9.29it/s][3/6] extract embeddings:  26%|██▌       | 11/42 [00:01<00:02, 11.09it/s][3/6] extract embeddings:  31%|███       | 13/42 [00:01<00:02, 12.63it/s][3/6] extract embeddings:  38%|███▊      | 16/42 [00:01<00:01, 14.92it/s][3/6] extract embeddings:  45%|████▌     | 19/42 [00:02<00:01, 17.18it/s][3/6] extract embeddings:  52%|█████▏    | 22/42 [00:02<00:01, 18.59it/s][3/6] extract embeddings:  60%|█████▉    | 25/42 [00:02<00:00, 18.95it/s][3/6] extract embeddings:  67%|██████▋   | 28/42 [00:02<00:00, 20.19it/s][3/6] extract embeddings:  74%|███████▍  | 31/42 [00:02<00:00, 20.40it/s][3/6] extract embeddings:  81%|████████  | 34/42 [00:02<00:00, 20.76it/s][3/6] extract embeddings:  88%|████████▊ | 37/42 [00:02<00:00, 20.22it/s][3/6] extract embeddings:  95%|█████████▌| 40/42 [00:03<00:00, 20.38it/s][3/6] extract embeddings: 100%|██████████| 42/42 [00:03<00:00, 13.32it/s]
[NeMo I 2025-04-17 01:37:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:37:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:55 collections:880] Dataset successfully loaded with 3393 items and total duration provided from manifest is  1.11 hours.
[NeMo I 2025-04-17 01:37:55 collections:886] # 3393 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/54 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/54 [00:01<01:00,  1.14s/it][4/6] extract embeddings:   7%|▋         | 4/54 [00:01<00:12,  3.97it/s][4/6] extract embeddings:  13%|█▎        | 7/54 [00:01<00:06,  7.04it/s][4/6] extract embeddings:  19%|█▊        | 10/54 [00:01<00:04, 10.18it/s][4/6] extract embeddings:  24%|██▍       | 13/54 [00:01<00:03, 12.92it/s][4/6] extract embeddings:  30%|██▉       | 16/54 [00:01<00:02, 15.44it/s][4/6] extract embeddings:  35%|███▌      | 19/54 [00:01<00:01, 17.54it/s][4/6] extract embeddings:  41%|████      | 22/54 [00:02<00:01, 19.44it/s][4/6] extract embeddings:  46%|████▋     | 25/54 [00:02<00:01, 20.30it/s][4/6] extract embeddings:  52%|█████▏    | 28/54 [00:02<00:01, 21.37it/s][4/6] extract embeddings:  57%|█████▋    | 31/54 [00:02<00:01, 21.96it/s][4/6] extract embeddings:  63%|██████▎   | 34/54 [00:02<00:00, 22.62it/s][4/6] extract embeddings:  69%|██████▊   | 37/54 [00:02<00:00, 22.69it/s][4/6] extract embeddings:  74%|███████▍  | 40/54 [00:02<00:00, 22.17it/s][4/6] extract embeddings:  80%|███████▉  | 43/54 [00:02<00:00, 22.58it/s][4/6] extract embeddings:  85%|████████▌ | 46/54 [00:03<00:00, 22.60it/s][4/6] extract embeddings:  91%|█████████ | 49/54 [00:03<00:00, 22.33it/s][4/6] extract embeddings:  96%|█████████▋| 52/54 [00:03<00:00, 22.81it/s][4/6] extract embeddings: 100%|██████████| 54/54 [00:03<00:00, 15.49it/s]
[NeMo I 2025-04-17 01:37:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:37:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:37:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:37:58 collections:880] Dataset successfully loaded with 4939 items and total duration provided from manifest is  1.20 hours.
[NeMo I 2025-04-17 01:37:58 collections:886] # 4939 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/78 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/78 [00:01<01:37,  1.26s/it][5/6] extract embeddings:   5%|▌         | 4/78 [00:01<00:19,  3.75it/s][5/6] extract embeddings:   9%|▉         | 7/78 [00:01<00:10,  7.00it/s][5/6] extract embeddings:  13%|█▎        | 10/78 [00:01<00:06, 10.29it/s][5/6] extract embeddings:  17%|█▋        | 13/78 [00:01<00:04, 13.45it/s][5/6] extract embeddings:  21%|██        | 16/78 [00:01<00:03, 16.62it/s][5/6] extract embeddings:  24%|██▍       | 19/78 [00:01<00:03, 19.14it/s][5/6] extract embeddings:  28%|██▊       | 22/78 [00:02<00:02, 20.26it/s][5/6] extract embeddings:  32%|███▏      | 25/78 [00:02<00:02, 22.37it/s][5/6] extract embeddings:  36%|███▌      | 28/78 [00:02<00:02, 23.62it/s][5/6] extract embeddings:  40%|███▉      | 31/78 [00:02<00:01, 24.51it/s][5/6] extract embeddings:  44%|████▎     | 34/78 [00:02<00:01, 25.17it/s][5/6] extract embeddings:  47%|████▋     | 37/78 [00:02<00:01, 25.97it/s][5/6] extract embeddings:  51%|█████▏    | 40/78 [00:02<00:01, 25.99it/s][5/6] extract embeddings:  55%|█████▌    | 43/78 [00:02<00:01, 25.98it/s][5/6] extract embeddings:  59%|█████▉    | 46/78 [00:02<00:01, 26.02it/s][5/6] extract embeddings:  63%|██████▎   | 49/78 [00:03<00:01, 25.64it/s][5/6] extract embeddings:  67%|██████▋   | 52/78 [00:03<00:00, 26.26it/s][5/6] extract embeddings:  71%|███████   | 55/78 [00:03<00:00, 25.85it/s][5/6] extract embeddings:  74%|███████▍  | 58/78 [00:03<00:00, 26.68it/s][5/6] extract embeddings:  78%|███████▊  | 61/78 [00:03<00:00, 26.16it/s][5/6] extract embeddings:  82%|████████▏ | 64/78 [00:03<00:00, 26.31it/s][5/6] extract embeddings:  86%|████████▌ | 67/78 [00:03<00:00, 26.00it/s][5/6] extract embeddings:  90%|████████▉ | 70/78 [00:03<00:00, 26.67it/s][5/6] extract embeddings:  94%|█████████▎| 73/78 [00:03<00:00, 27.45it/s][5/6] extract embeddings:  97%|█████████▋| 76/78 [00:04<00:00, 27.04it/s][5/6] extract embeddings: 100%|██████████| 78/78 [00:04<00:00, 18.82it/s]
[NeMo I 2025-04-17 01:38:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:38:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:38:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:38:03 collections:880] Dataset successfully loaded with 9938 items and total duration provided from manifest is  1.31 hours.
[NeMo I 2025-04-17 01:38:03 collections:886] # 9938 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/156 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/156 [00:01<03:00,  1.16s/it][6/6] extract embeddings:   3%|▎         | 5/156 [00:01<00:30,  5.00it/s][6/6] extract embeddings:   6%|▌         | 9/156 [00:01<00:15,  9.44it/s][6/6] extract embeddings:   8%|▊         | 13/156 [00:01<00:10, 13.85it/s][6/6] extract embeddings:  11%|█         | 17/156 [00:01<00:07, 18.05it/s][6/6] extract embeddings:  13%|█▎        | 21/156 [00:01<00:06, 21.87it/s][6/6] extract embeddings:  16%|█▌        | 25/156 [00:01<00:05, 24.94it/s][6/6] extract embeddings:  19%|█▊        | 29/156 [00:02<00:04, 26.02it/s][6/6] extract embeddings:  21%|██        | 33/156 [00:02<00:04, 27.97it/s][6/6] extract embeddings:  24%|██▎       | 37/156 [00:02<00:04, 29.50it/s][6/6] extract embeddings:  26%|██▋       | 41/156 [00:02<00:03, 31.11it/s][6/6] extract embeddings:  29%|██▉       | 45/156 [00:02<00:03, 30.57it/s][6/6] extract embeddings:  31%|███▏      | 49/156 [00:02<00:03, 31.06it/s][6/6] extract embeddings:  34%|███▍      | 53/156 [00:02<00:03, 32.03it/s][6/6] extract embeddings:  37%|███▋      | 57/156 [00:02<00:03, 32.02it/s][6/6] extract embeddings:  39%|███▉      | 61/156 [00:02<00:02, 32.99it/s][6/6] extract embeddings:  42%|████▏     | 65/156 [00:03<00:02, 33.05it/s][6/6] extract embeddings:  44%|████▍     | 69/156 [00:03<00:02, 33.65it/s][6/6] extract embeddings:  47%|████▋     | 73/156 [00:03<00:02, 33.67it/s][6/6] extract embeddings:  49%|████▉     | 77/156 [00:03<00:02, 33.95it/s][6/6] extract embeddings:  52%|█████▏    | 81/156 [00:03<00:02, 34.10it/s][6/6] extract embeddings:  54%|█████▍    | 85/156 [00:03<00:02, 32.94it/s][6/6] extract embeddings:  57%|█████▋    | 89/156 [00:03<00:02, 32.84it/s][6/6] extract embeddings:  60%|█████▉    | 93/156 [00:03<00:01, 32.67it/s][6/6] extract embeddings:  62%|██████▏   | 97/156 [00:04<00:01, 31.70it/s][6/6] extract embeddings:  65%|██████▍   | 101/156 [00:04<00:01, 30.06it/s][6/6] extract embeddings:  67%|██████▋   | 105/156 [00:04<00:01, 25.52it/s][6/6] extract embeddings:  69%|██████▉   | 108/156 [00:04<00:02, 23.70it/s][6/6] extract embeddings:  71%|███████   | 111/156 [00:04<00:02, 21.48it/s][6/6] extract embeddings:  73%|███████▎  | 114/156 [00:04<00:02, 20.96it/s][6/6] extract embeddings:  75%|███████▌  | 117/156 [00:05<00:01, 20.19it/s][6/6] extract embeddings:  77%|███████▋  | 120/156 [00:05<00:01, 20.22it/s][6/6] extract embeddings:  79%|███████▉  | 123/156 [00:05<00:01, 20.50it/s][6/6] extract embeddings:  81%|████████  | 126/156 [00:05<00:01, 20.29it/s][6/6] extract embeddings:  83%|████████▎ | 129/156 [00:05<00:01, 20.29it/s][6/6] extract embeddings:  85%|████████▍ | 132/156 [00:05<00:01, 20.01it/s][6/6] extract embeddings:  87%|████████▋ | 135/156 [00:05<00:01, 20.87it/s][6/6] extract embeddings:  88%|████████▊ | 138/156 [00:06<00:00, 21.95it/s][6/6] extract embeddings:  90%|█████████ | 141/156 [00:06<00:00, 21.06it/s][6/6] extract embeddings:  92%|█████████▏| 144/156 [00:06<00:00, 20.31it/s][6/6] extract embeddings:  94%|█████████▍| 147/156 [00:06<00:00, 20.40it/s][6/6] extract embeddings:  96%|█████████▌| 150/156 [00:06<00:00, 19.64it/s][6/6] extract embeddings:  98%|█████████▊| 153/156 [00:06<00:00, 19.81it/s][6/6] extract embeddings:  99%|█████████▉| 155/156 [00:06<00:00, 19.51it/s][6/6] extract embeddings: 100%|██████████| 156/156 [00:07<00:00, 22.27it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.11it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.86it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.62it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.71it/s]
[NeMo I 2025-04-17 01:38:12 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:38:13 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              52.492549   444.120  ...  17.410015  3.920115
    Harker-ES                       45.485843  2178.782  ...  38.405351  1.762698
    Harker-MN                       52.471200   366.767  ...  27.456958  7.486213
    Longfellow-Block-1              41.373581   492.417  ...   8.644965  1.755619
    TOTAL                           46.533740  3482.086  ...  91.917289  2.639719
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:38:13 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0540 | MISS: 0.3850 | CER: 0.0264 | DER: 0.4653 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.78s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.93s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.16s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:38:25 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:38:25 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:38:25 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:38:25 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:38:25 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:38:25 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:38:25 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:38:25 features:305] PADDING: 16
[NeMo I 2025-04-17 01:38:25 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:38:25 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:38:25 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:38:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:38:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:38:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:38:26 collections:880] Dataset successfully loaded with 2065 items and total duration provided from manifest is  0.89 hours.
[NeMo I 2025-04-17 01:38:26 collections:886] # 2065 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:04,  2.01s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.43it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:07,  3.80it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.28it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  6.76it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  8.28it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01,  9.91it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 10.86it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:03<00:01, 12.36it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:03<00:01, 12.86it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 13.29it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 13.47it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 13.80it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 13.61it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 14.05it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:04<00:00, 14.22it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:04<00:00,  8.04it/s]
[NeMo I 2025-04-17 01:38:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:38:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:38:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:38:30 collections:880] Dataset successfully loaded with 2281 items and total duration provided from manifest is  0.93 hours.
[NeMo I 2025-04-17 01:38:30 collections:886] # 2281 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:51,  1.47s/it][2/6] extract embeddings:   8%|▊         | 3/36 [00:01<00:14,  2.33it/s][2/6] extract embeddings:  14%|█▍        | 5/36 [00:01<00:07,  4.09it/s][2/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  6.02it/s][2/6] extract embeddings:  25%|██▌       | 9/36 [00:01<00:03,  7.71it/s][2/6] extract embeddings:  31%|███       | 11/36 [00:02<00:02,  9.15it/s][2/6] extract embeddings:  36%|███▌      | 13/36 [00:02<00:02, 10.70it/s][2/6] extract embeddings:  42%|████▏     | 15/36 [00:02<00:01, 12.37it/s][2/6] extract embeddings:  47%|████▋     | 17/36 [00:02<00:01, 13.13it/s][2/6] extract embeddings:  53%|█████▎    | 19/36 [00:02<00:01, 13.70it/s][2/6] extract embeddings:  58%|█████▊    | 21/36 [00:02<00:01, 13.88it/s][2/6] extract embeddings:  64%|██████▍   | 23/36 [00:02<00:00, 14.49it/s][2/6] extract embeddings:  69%|██████▉   | 25/36 [00:03<00:00, 14.69it/s][2/6] extract embeddings:  75%|███████▌  | 27/36 [00:03<00:00, 14.42it/s][2/6] extract embeddings:  81%|████████  | 29/36 [00:03<00:00, 14.58it/s][2/6] extract embeddings:  86%|████████▌ | 31/36 [00:03<00:00, 14.55it/s][2/6] extract embeddings:  92%|█████████▏| 33/36 [00:03<00:00, 15.28it/s][2/6] extract embeddings:  97%|█████████▋| 35/36 [00:03<00:00, 16.12it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00,  9.64it/s]
[NeMo I 2025-04-17 01:38:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:38:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:38:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:38:34 collections:880] Dataset successfully loaded with 2624 items and total duration provided from manifest is  0.98 hours.
[NeMo I 2025-04-17 01:38:34 collections:886] # 2624 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:51,  1.29s/it][3/6] extract embeddings:   7%|▋         | 3/41 [00:01<00:14,  2.65it/s][3/6] extract embeddings:  12%|█▏        | 5/41 [00:01<00:07,  4.70it/s][3/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:05,  6.78it/s][3/6] extract embeddings:  24%|██▍       | 10/41 [00:01<00:03, 10.16it/s][3/6] extract embeddings:  29%|██▉       | 12/41 [00:01<00:02, 11.85it/s][3/6] extract embeddings:  34%|███▍      | 14/41 [00:01<00:02, 13.30it/s][3/6] extract embeddings:  39%|███▉      | 16/41 [00:02<00:01, 13.91it/s][3/6] extract embeddings:  44%|████▍     | 18/41 [00:02<00:01, 14.75it/s][3/6] extract embeddings:  49%|████▉     | 20/41 [00:02<00:01, 15.48it/s][3/6] extract embeddings:  54%|█████▎    | 22/41 [00:02<00:01, 15.29it/s][3/6] extract embeddings:  59%|█████▊    | 24/41 [00:02<00:01, 15.10it/s][3/6] extract embeddings:  63%|██████▎   | 26/41 [00:02<00:01, 14.99it/s][3/6] extract embeddings:  68%|██████▊   | 28/41 [00:02<00:00, 15.27it/s][3/6] extract embeddings:  73%|███████▎  | 30/41 [00:03<00:00, 15.09it/s][3/6] extract embeddings:  78%|███████▊  | 32/41 [00:03<00:00, 14.84it/s][3/6] extract embeddings:  83%|████████▎ | 34/41 [00:03<00:00, 15.21it/s][3/6] extract embeddings:  88%|████████▊ | 36/41 [00:03<00:00, 15.19it/s][3/6] extract embeddings:  93%|█████████▎| 38/41 [00:03<00:00, 15.46it/s][3/6] extract embeddings:  98%|█████████▊| 40/41 [00:03<00:00, 15.46it/s][3/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 10.93it/s]
[NeMo I 2025-04-17 01:38:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:38:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:38:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:38:38 collections:880] Dataset successfully loaded with 3284 items and total duration provided from manifest is  1.05 hours.
[NeMo I 2025-04-17 01:38:38 collections:886] # 3284 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/52 [00:01<01:04,  1.26s/it][4/6] extract embeddings:   6%|▌         | 3/52 [00:01<00:18,  2.71it/s][4/6] extract embeddings:  10%|▉         | 5/52 [00:01<00:09,  4.81it/s][4/6] extract embeddings:  13%|█▎        | 7/52 [00:01<00:06,  7.08it/s][4/6] extract embeddings:  17%|█▋        | 9/52 [00:01<00:04,  9.04it/s][4/6] extract embeddings:  21%|██        | 11/52 [00:01<00:03, 10.82it/s][4/6] extract embeddings:  25%|██▌       | 13/52 [00:01<00:03, 11.59it/s][4/6] extract embeddings:  29%|██▉       | 15/52 [00:02<00:03, 11.46it/s][4/6] extract embeddings:  33%|███▎      | 17/52 [00:02<00:02, 12.82it/s][4/6] extract embeddings:  37%|███▋      | 19/52 [00:02<00:02, 13.91it/s][4/6] extract embeddings:  40%|████      | 21/52 [00:02<00:02, 14.90it/s][4/6] extract embeddings:  44%|████▍     | 23/52 [00:02<00:01, 15.86it/s][4/6] extract embeddings:  48%|████▊     | 25/52 [00:02<00:01, 16.45it/s][4/6] extract embeddings:  52%|█████▏    | 27/52 [00:02<00:01, 16.35it/s][4/6] extract embeddings:  56%|█████▌    | 29/52 [00:02<00:01, 16.61it/s][4/6] extract embeddings:  60%|█████▉    | 31/52 [00:03<00:01, 16.29it/s][4/6] extract embeddings:  63%|██████▎   | 33/52 [00:03<00:01, 16.52it/s][4/6] extract embeddings:  67%|██████▋   | 35/52 [00:03<00:01, 11.82it/s][4/6] extract embeddings:  71%|███████   | 37/52 [00:03<00:01,  9.14it/s][4/6] extract embeddings:  75%|███████▌  | 39/52 [00:04<00:01,  7.84it/s][4/6] extract embeddings:  77%|███████▋  | 40/52 [00:04<00:01,  7.45it/s][4/6] extract embeddings:  79%|███████▉  | 41/52 [00:04<00:02,  4.81it/s][4/6] extract embeddings:  81%|████████  | 42/52 [00:05<00:02,  4.92it/s][4/6] extract embeddings:  83%|████████▎ | 43/52 [00:05<00:01,  5.01it/s][4/6] extract embeddings:  85%|████████▍ | 44/52 [00:05<00:01,  5.03it/s][4/6] extract embeddings:  87%|████████▋ | 45/52 [00:05<00:01,  5.44it/s][4/6] extract embeddings:  88%|████████▊ | 46/52 [00:05<00:01,  5.68it/s][4/6] extract embeddings:  90%|█████████ | 47/52 [00:05<00:00,  5.83it/s][4/6] extract embeddings:  92%|█████████▏| 48/52 [00:06<00:00,  6.03it/s][4/6] extract embeddings:  94%|█████████▍| 49/52 [00:06<00:00,  6.27it/s][4/6] extract embeddings:  96%|█████████▌| 50/52 [00:06<00:00,  6.34it/s][4/6] extract embeddings:  98%|█████████▊| 51/52 [00:06<00:00,  6.12it/s][4/6] extract embeddings: 100%|██████████| 52/52 [00:06<00:00,  7.91it/s]
[NeMo I 2025-04-17 01:38:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:38:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:38:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:38:44 collections:880] Dataset successfully loaded with 4735 items and total duration provided from manifest is  1.14 hours.
[NeMo I 2025-04-17 01:38:44 collections:886] # 4735 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/74 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/74 [00:04<05:25,  4.45s/it][5/6] extract embeddings:   3%|▎         | 2/74 [00:04<02:18,  1.92s/it][5/6] extract embeddings:   4%|▍         | 3/74 [00:04<01:19,  1.12s/it][5/6] extract embeddings:   5%|▌         | 4/74 [00:04<00:51,  1.35it/s][5/6] extract embeddings:   7%|▋         | 5/74 [00:05<00:44,  1.56it/s][5/6] extract embeddings:   8%|▊         | 6/74 [00:05<00:32,  2.07it/s][5/6] extract embeddings:   9%|▉         | 7/74 [00:05<00:25,  2.62it/s][5/6] extract embeddings:  11%|█         | 8/74 [00:05<00:20,  3.18it/s][5/6] extract embeddings:  12%|█▏        | 9/74 [00:06<00:17,  3.74it/s][5/6] extract embeddings:  14%|█▎        | 10/74 [00:06<00:15,  4.21it/s][5/6] extract embeddings:  15%|█▍        | 11/74 [00:06<00:13,  4.66it/s][5/6] extract embeddings:  16%|█▌        | 12/74 [00:06<00:13,  4.70it/s][5/6] extract embeddings:  18%|█▊        | 13/74 [00:06<00:12,  5.06it/s][5/6] extract embeddings:  19%|█▉        | 14/74 [00:06<00:11,  5.21it/s][5/6] extract embeddings:  20%|██        | 15/74 [00:07<00:10,  5.42it/s][5/6] extract embeddings:  22%|██▏       | 16/74 [00:07<00:10,  5.57it/s][5/6] extract embeddings:  23%|██▎       | 17/74 [00:07<00:10,  5.65it/s][5/6] extract embeddings:  24%|██▍       | 18/74 [00:07<00:10,  5.46it/s][5/6] extract embeddings:  26%|██▌       | 19/74 [00:07<00:09,  5.92it/s][5/6] extract embeddings:  27%|██▋       | 20/74 [00:07<00:09,  5.91it/s][5/6] extract embeddings:  28%|██▊       | 21/74 [00:08<00:08,  6.04it/s][5/6] extract embeddings:  30%|██▉       | 22/74 [00:08<00:08,  5.94it/s][5/6] extract embeddings:  31%|███       | 23/74 [00:08<00:08,  5.86it/s][5/6] extract embeddings:  32%|███▏      | 24/74 [00:08<00:09,  5.41it/s][5/6] extract embeddings:  34%|███▍      | 25/74 [00:08<00:08,  5.50it/s][5/6] extract embeddings:  35%|███▌      | 26/74 [00:09<00:08,  5.57it/s][5/6] extract embeddings:  36%|███▋      | 27/74 [00:09<00:08,  5.71it/s][5/6] extract embeddings:  38%|███▊      | 28/74 [00:09<00:08,  5.73it/s][5/6] extract embeddings:  39%|███▉      | 29/74 [00:09<00:07,  5.76it/s][5/6] extract embeddings:  41%|████      | 30/74 [00:09<00:08,  5.42it/s][5/6] extract embeddings:  42%|████▏     | 31/74 [00:09<00:07,  5.53it/s][5/6] extract embeddings:  43%|████▎     | 32/74 [00:10<00:07,  5.78it/s][5/6] extract embeddings:  45%|████▍     | 33/74 [00:10<00:06,  5.95it/s][5/6] extract embeddings:  46%|████▌     | 34/74 [00:10<00:06,  5.82it/s][5/6] extract embeddings:  47%|████▋     | 35/74 [00:10<00:06,  5.97it/s][5/6] extract embeddings:  49%|████▊     | 36/74 [00:10<00:06,  6.12it/s][5/6] extract embeddings:  50%|█████     | 37/74 [00:10<00:06,  6.01it/s][5/6] extract embeddings:  51%|█████▏    | 38/74 [00:11<00:05,  6.07it/s][5/6] extract embeddings:  53%|█████▎    | 39/74 [00:11<00:05,  5.99it/s][5/6] extract embeddings:  54%|█████▍    | 40/74 [00:11<00:05,  5.90it/s][5/6] extract embeddings:  55%|█████▌    | 41/74 [00:11<00:05,  5.99it/s][5/6] extract embeddings:  57%|█████▋    | 42/74 [00:11<00:05,  5.91it/s][5/6] extract embeddings:  58%|█████▊    | 43/74 [00:12<00:07,  4.37it/s][5/6] extract embeddings:  59%|█████▉    | 44/74 [00:12<00:06,  4.75it/s][5/6] extract embeddings:  61%|██████    | 45/74 [00:12<00:05,  5.04it/s][5/6] extract embeddings:  62%|██████▏   | 46/74 [00:12<00:05,  5.25it/s][5/6] extract embeddings:  64%|██████▎   | 47/74 [00:12<00:04,  5.45it/s][5/6] extract embeddings:  65%|██████▍   | 48/74 [00:12<00:04,  5.56it/s][5/6] extract embeddings:  66%|██████▌   | 49/74 [00:13<00:04,  5.76it/s][5/6] extract embeddings:  68%|██████▊   | 50/74 [00:13<00:04,  5.79it/s][5/6] extract embeddings:  69%|██████▉   | 51/74 [00:13<00:03,  5.80it/s][5/6] extract embeddings:  70%|███████   | 52/74 [00:13<00:03,  5.91it/s][5/6] extract embeddings:  72%|███████▏  | 53/74 [00:13<00:03,  5.45it/s][5/6] extract embeddings:  73%|███████▎  | 54/74 [00:14<00:03,  5.78it/s][5/6] extract embeddings:  74%|███████▍  | 55/74 [00:14<00:03,  5.79it/s][5/6] extract embeddings:  76%|███████▌  | 56/74 [00:14<00:03,  5.84it/s][5/6] extract embeddings:  77%|███████▋  | 57/74 [00:14<00:02,  5.85it/s][5/6] extract embeddings:  78%|███████▊  | 58/74 [00:14<00:02,  5.88it/s][5/6] extract embeddings:  80%|███████▉  | 59/74 [00:14<00:02,  5.95it/s][5/6] extract embeddings:  81%|████████  | 60/74 [00:15<00:02,  5.95it/s][5/6] extract embeddings:  82%|████████▏ | 61/74 [00:15<00:02,  6.33it/s][5/6] extract embeddings:  84%|████████▍ | 62/74 [00:15<00:01,  6.44it/s][5/6] extract embeddings:  85%|████████▌ | 63/74 [00:15<00:01,  6.31it/s][5/6] extract embeddings:  86%|████████▋ | 64/74 [00:15<00:01,  6.18it/s][5/6] extract embeddings:  88%|████████▊ | 65/74 [00:15<00:01,  5.98it/s][5/6] extract embeddings:  89%|████████▉ | 66/74 [00:15<00:01,  5.93it/s][5/6] extract embeddings:  91%|█████████ | 67/74 [00:16<00:01,  6.17it/s][5/6] extract embeddings:  92%|█████████▏| 68/74 [00:16<00:00,  6.46it/s][5/6] extract embeddings:  93%|█████████▎| 69/74 [00:16<00:00,  6.67it/s][5/6] extract embeddings:  95%|█████████▍| 70/74 [00:16<00:00,  6.51it/s][5/6] extract embeddings:  96%|█████████▌| 71/74 [00:16<00:00,  6.36it/s][5/6] extract embeddings:  97%|█████████▋| 72/74 [00:16<00:00,  6.51it/s][5/6] extract embeddings:  99%|█████████▊| 73/74 [00:17<00:00,  6.27it/s][5/6] extract embeddings: 100%|██████████| 74/74 [00:17<00:00,  6.16it/s][5/6] extract embeddings: 100%|██████████| 74/74 [00:17<00:00,  4.29it/s]
[NeMo I 2025-04-17 01:39:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:39:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:39:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:39:02 collections:880] Dataset successfully loaded with 9502 items and total duration provided from manifest is  1.25 hours.
[NeMo I 2025-04-17 01:39:02 collections:886] # 9502 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/149 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/149 [00:03<08:45,  3.55s/it][6/6] extract embeddings:   1%|▏         | 2/149 [00:03<03:46,  1.54s/it][6/6] extract embeddings:   2%|▏         | 3/149 [00:03<02:12,  1.10it/s][6/6] extract embeddings:   3%|▎         | 4/149 [00:03<01:28,  1.64it/s][6/6] extract embeddings:   3%|▎         | 5/149 [00:04<01:04,  2.23it/s][6/6] extract embeddings:   4%|▍         | 6/149 [00:04<00:48,  2.93it/s][6/6] extract embeddings:   5%|▍         | 7/149 [00:04<00:39,  3.58it/s][6/6] extract embeddings:   5%|▌         | 8/149 [00:04<00:34,  4.12it/s][6/6] extract embeddings:   6%|▌         | 9/149 [00:04<00:29,  4.68it/s][6/6] extract embeddings:   7%|▋         | 10/149 [00:04<00:27,  5.01it/s][6/6] extract embeddings:   7%|▋         | 11/149 [00:05<00:25,  5.31it/s][6/6] extract embeddings:   8%|▊         | 12/149 [00:05<00:24,  5.55it/s][6/6] extract embeddings:   9%|▊         | 13/149 [00:05<00:23,  5.73it/s][6/6] extract embeddings:   9%|▉         | 14/149 [00:05<00:22,  5.91it/s][6/6] extract embeddings:  10%|█         | 15/149 [00:05<00:22,  5.97it/s][6/6] extract embeddings:  11%|█         | 16/149 [00:05<00:21,  6.05it/s][6/6] extract embeddings:  11%|█▏        | 17/149 [00:06<00:21,  6.10it/s][6/6] extract embeddings:  12%|█▏        | 18/149 [00:06<00:20,  6.50it/s][6/6] extract embeddings:  13%|█▎        | 19/149 [00:06<00:20,  6.39it/s][6/6] extract embeddings:  13%|█▎        | 20/149 [00:06<00:20,  6.43it/s][6/6] extract embeddings:  14%|█▍        | 21/149 [00:06<00:20,  6.24it/s][6/6] extract embeddings:  15%|█▍        | 22/149 [00:06<00:19,  6.37it/s][6/6] extract embeddings:  15%|█▌        | 23/149 [00:06<00:19,  6.59it/s][6/6] extract embeddings:  16%|█▌        | 24/149 [00:07<00:19,  6.55it/s][6/6] extract embeddings:  17%|█▋        | 25/149 [00:07<00:17,  6.90it/s][6/6] extract embeddings:  17%|█▋        | 26/149 [00:07<00:18,  6.72it/s][6/6] extract embeddings:  18%|█▊        | 27/149 [00:07<00:18,  6.66it/s][6/6] extract embeddings:  19%|█▉        | 28/149 [00:07<00:18,  6.48it/s][6/6] extract embeddings:  19%|█▉        | 29/149 [00:07<00:18,  6.50it/s][6/6] extract embeddings:  20%|██        | 30/149 [00:08<00:18,  6.44it/s][6/6] extract embeddings:  21%|██        | 31/149 [00:08<00:18,  6.36it/s][6/6] extract embeddings:  21%|██▏       | 32/149 [00:08<00:18,  6.26it/s][6/6] extract embeddings:  22%|██▏       | 33/149 [00:08<00:18,  6.38it/s][6/6] extract embeddings:  23%|██▎       | 34/149 [00:08<00:18,  6.31it/s][6/6] extract embeddings:  23%|██▎       | 35/149 [00:08<00:18,  6.26it/s][6/6] extract embeddings:  24%|██▍       | 36/149 [00:08<00:17,  6.39it/s][6/6] extract embeddings:  25%|██▍       | 37/149 [00:09<00:16,  6.69it/s][6/6] extract embeddings:  26%|██▌       | 38/149 [00:09<00:16,  6.55it/s][6/6] extract embeddings:  26%|██▌       | 39/149 [00:09<00:16,  6.54it/s][6/6] extract embeddings:  27%|██▋       | 40/149 [00:09<00:17,  6.38it/s][6/6] extract embeddings:  28%|██▊       | 41/149 [00:09<00:17,  6.24it/s][6/6] extract embeddings:  28%|██▊       | 42/149 [00:09<00:16,  6.35it/s][6/6] extract embeddings:  29%|██▉       | 43/149 [00:10<00:16,  6.39it/s][6/6] extract embeddings:  30%|██▉       | 44/149 [00:10<00:15,  6.73it/s][6/6] extract embeddings:  30%|███       | 45/149 [00:10<00:15,  6.53it/s][6/6] extract embeddings:  31%|███       | 46/149 [00:10<00:15,  6.76it/s][6/6] extract embeddings:  32%|███▏      | 47/149 [00:10<00:14,  6.97it/s][6/6] extract embeddings:  32%|███▏      | 48/149 [00:10<00:15,  6.69it/s][6/6] extract embeddings:  33%|███▎      | 49/149 [00:10<00:15,  6.59it/s][6/6] extract embeddings:  34%|███▎      | 50/149 [00:11<00:14,  7.04it/s][6/6] extract embeddings:  34%|███▍      | 51/149 [00:11<00:14,  6.85it/s][6/6] extract embeddings:  35%|███▍      | 52/149 [00:11<00:13,  7.06it/s][6/6] extract embeddings:  36%|███▌      | 53/149 [00:11<00:13,  7.20it/s][6/6] extract embeddings:  36%|███▌      | 54/149 [00:11<00:12,  7.31it/s][6/6] extract embeddings:  37%|███▋      | 55/149 [00:11<00:12,  7.37it/s][6/6] extract embeddings:  38%|███▊      | 56/149 [00:11<00:13,  6.87it/s][6/6] extract embeddings:  38%|███▊      | 57/149 [00:12<00:13,  6.80it/s][6/6] extract embeddings:  39%|███▉      | 58/149 [00:12<00:13,  6.60it/s][6/6] extract embeddings:  40%|███▉      | 59/149 [00:12<00:13,  6.56it/s][6/6] extract embeddings:  40%|████      | 60/149 [00:12<00:13,  6.44it/s][6/6] extract embeddings:  41%|████      | 61/149 [00:12<00:13,  6.38it/s][6/6] extract embeddings:  42%|████▏     | 62/149 [00:12<00:13,  6.41it/s][6/6] extract embeddings:  42%|████▏     | 63/149 [00:13<00:13,  6.36it/s][6/6] extract embeddings:  43%|████▎     | 64/149 [00:13<00:13,  6.36it/s][6/6] extract embeddings:  44%|████▎     | 65/149 [00:13<00:13,  6.28it/s][6/6] extract embeddings:  44%|████▍     | 66/149 [00:13<00:12,  6.62it/s][6/6] extract embeddings:  45%|████▍     | 67/149 [00:13<00:12,  6.43it/s][6/6] extract embeddings:  46%|████▌     | 68/149 [00:13<00:12,  6.41it/s][6/6] extract embeddings:  46%|████▋     | 69/149 [00:13<00:12,  6.35it/s][6/6] extract embeddings:  47%|████▋     | 70/149 [00:14<00:14,  5.51it/s][6/6] extract embeddings:  48%|████▊     | 71/149 [00:14<00:13,  5.83it/s][6/6] extract embeddings:  48%|████▊     | 72/149 [00:14<00:13,  5.92it/s][6/6] extract embeddings:  49%|████▉     | 73/149 [00:14<00:12,  6.06it/s][6/6] extract embeddings:  50%|████▉     | 74/149 [00:14<00:12,  6.12it/s][6/6] extract embeddings:  50%|█████     | 75/149 [00:14<00:11,  6.23it/s][6/6] extract embeddings:  51%|█████     | 76/149 [00:15<00:11,  6.22it/s][6/6] extract embeddings:  52%|█████▏    | 77/149 [00:15<00:11,  6.25it/s][6/6] extract embeddings:  52%|█████▏    | 78/149 [00:15<00:10,  6.60it/s][6/6] extract embeddings:  53%|█████▎    | 79/149 [00:15<00:10,  6.44it/s][6/6] extract embeddings:  54%|█████▎    | 80/149 [00:15<00:10,  6.41it/s][6/6] extract embeddings:  54%|█████▍    | 81/149 [00:15<00:10,  6.38it/s][6/6] extract embeddings:  55%|█████▌    | 82/149 [00:16<00:10,  6.58it/s][6/6] extract embeddings:  56%|█████▌    | 83/149 [00:16<00:09,  6.66it/s][6/6] extract embeddings:  56%|█████▋    | 84/149 [00:16<00:09,  6.74it/s][6/6] extract embeddings:  57%|█████▋    | 85/149 [00:16<00:09,  6.67it/s][6/6] extract embeddings:  58%|█████▊    | 86/149 [00:16<00:09,  6.41it/s][6/6] extract embeddings:  58%|█████▊    | 87/149 [00:16<00:09,  6.46it/s][6/6] extract embeddings:  59%|█████▉    | 88/149 [00:16<00:09,  6.40it/s][6/6] extract embeddings:  60%|█████▉    | 89/149 [00:17<00:09,  6.35it/s][6/6] extract embeddings:  60%|██████    | 90/149 [00:17<00:09,  6.38it/s][6/6] extract embeddings:  61%|██████    | 91/149 [00:17<00:09,  6.41it/s][6/6] extract embeddings:  62%|██████▏   | 92/149 [00:17<00:08,  6.64it/s][6/6] extract embeddings:  62%|██████▏   | 93/149 [00:17<00:08,  6.70it/s][6/6] extract embeddings:  63%|██████▎   | 94/149 [00:17<00:08,  6.59it/s][6/6] extract embeddings:  64%|██████▍   | 95/149 [00:18<00:07,  6.86it/s][6/6] extract embeddings:  64%|██████▍   | 96/149 [00:18<00:07,  6.79it/s][6/6] extract embeddings:  65%|██████▌   | 97/149 [00:18<00:07,  6.62it/s][6/6] extract embeddings:  66%|██████▌   | 98/149 [00:18<00:07,  6.71it/s][6/6] extract embeddings:  66%|██████▋   | 99/149 [00:18<00:07,  6.74it/s][6/6] extract embeddings:  67%|██████▋   | 100/149 [00:18<00:06,  7.08it/s][6/6] extract embeddings:  68%|██████▊   | 101/149 [00:18<00:06,  7.31it/s][6/6] extract embeddings:  68%|██████▊   | 102/149 [00:18<00:06,  7.56it/s][6/6] extract embeddings:  69%|██████▉   | 103/149 [00:19<00:06,  7.54it/s][6/6] extract embeddings:  70%|██████▉   | 104/149 [00:19<00:05,  7.63it/s][6/6] extract embeddings:  70%|███████   | 105/149 [00:19<00:06,  7.10it/s][6/6] extract embeddings:  71%|███████   | 106/149 [00:19<00:06,  6.89it/s][6/6] extract embeddings:  72%|███████▏  | 107/149 [00:19<00:05,  7.05it/s][6/6] extract embeddings:  72%|███████▏  | 108/149 [00:19<00:05,  7.32it/s][6/6] extract embeddings:  73%|███████▎  | 109/149 [00:19<00:05,  6.96it/s][6/6] extract embeddings:  74%|███████▍  | 110/149 [00:20<00:05,  6.78it/s][6/6] extract embeddings:  74%|███████▍  | 111/149 [00:20<00:05,  6.43it/s][6/6] extract embeddings:  75%|███████▌  | 112/149 [00:20<00:05,  6.97it/s][6/6] extract embeddings:  76%|███████▌  | 113/149 [00:20<00:05,  7.07it/s][6/6] extract embeddings:  77%|███████▋  | 114/149 [00:20<00:05,  6.71it/s][6/6] extract embeddings:  77%|███████▋  | 115/149 [00:20<00:05,  6.64it/s][6/6] extract embeddings:  78%|███████▊  | 116/149 [00:21<00:05,  6.59it/s][6/6] extract embeddings:  79%|███████▊  | 117/149 [00:21<00:04,  6.55it/s][6/6] extract embeddings:  79%|███████▉  | 118/149 [00:21<00:04,  6.35it/s][6/6] extract embeddings:  80%|███████▉  | 119/149 [00:21<00:04,  6.46it/s][6/6] extract embeddings:  81%|████████  | 120/149 [00:21<00:04,  6.51it/s][6/6] extract embeddings:  81%|████████  | 121/149 [00:21<00:04,  6.48it/s][6/6] extract embeddings:  82%|████████▏ | 122/149 [00:21<00:04,  6.37it/s][6/6] extract embeddings:  83%|████████▎ | 123/149 [00:22<00:04,  6.28it/s][6/6] extract embeddings:  83%|████████▎ | 124/149 [00:22<00:03,  6.27it/s][6/6] extract embeddings:  84%|████████▍ | 125/149 [00:22<00:03,  6.18it/s][6/6] extract embeddings:  85%|████████▍ | 126/149 [00:22<00:03,  6.17it/s][6/6] extract embeddings:  85%|████████▌ | 127/149 [00:22<00:03,  6.24it/s][6/6] extract embeddings:  86%|████████▌ | 128/149 [00:22<00:03,  6.32it/s][6/6] extract embeddings:  87%|████████▋ | 129/149 [00:23<00:03,  6.31it/s][6/6] extract embeddings:  87%|████████▋ | 130/149 [00:23<00:03,  6.24it/s][6/6] extract embeddings:  88%|████████▊ | 131/149 [00:23<00:02,  6.24it/s][6/6] extract embeddings:  89%|████████▊ | 132/149 [00:23<00:02,  6.21it/s][6/6] extract embeddings:  89%|████████▉ | 133/149 [00:23<00:02,  6.31it/s][6/6] extract embeddings:  90%|████████▉ | 134/149 [00:23<00:02,  6.36it/s][6/6] extract embeddings:  91%|█████████ | 135/149 [00:24<00:02,  6.35it/s][6/6] extract embeddings:  91%|█████████▏| 136/149 [00:24<00:02,  6.39it/s][6/6] extract embeddings:  92%|█████████▏| 137/149 [00:24<00:02,  4.43it/s][6/6] extract embeddings:  93%|█████████▎| 138/149 [00:24<00:02,  4.97it/s][6/6] extract embeddings:  93%|█████████▎| 139/149 [00:24<00:01,  5.30it/s][6/6] extract embeddings:  94%|█████████▍| 140/149 [00:25<00:01,  5.56it/s][6/6] extract embeddings:  95%|█████████▍| 141/149 [00:25<00:01,  5.77it/s][6/6] extract embeddings:  95%|█████████▌| 142/149 [00:25<00:01,  6.36it/s][6/6] extract embeddings:  96%|█████████▌| 143/149 [00:25<00:00,  6.24it/s][6/6] extract embeddings:  97%|█████████▋| 144/149 [00:25<00:00,  6.63it/s][6/6] extract embeddings:  97%|█████████▋| 145/149 [00:25<00:00,  6.56it/s][6/6] extract embeddings:  98%|█████████▊| 146/149 [00:25<00:00,  6.62it/s][6/6] extract embeddings:  99%|█████████▊| 147/149 [00:26<00:00,  6.87it/s][6/6] extract embeddings:  99%|█████████▉| 148/149 [00:26<00:00,  6.23it/s][6/6] extract embeddings: 100%|██████████| 149/149 [00:26<00:00,  6.92it/s][6/6] extract embeddings: 100%|██████████| 149/149 [00:26<00:00,  5.64it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.77it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.77it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.02it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.59it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.27it/s]
[NeMo I 2025-04-17 01:39:30 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:39:32 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              53.313193   444.120  ...  14.635018  3.295285
    Harker-ES                       48.381846  2178.782  ...  43.717890  2.006529
    Harker-MN                       54.239640   366.767  ...  27.309993  7.446142
    Longfellow-Block-1              43.894087   492.417  ...   8.731962  1.773286
    TOTAL                           48.993177  3482.086  ...  94.394863  2.710871
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:39:32 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0518 | MISS: 0.4110 | CER: 0.0271 | DER: 0.4899 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.87s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.98s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.26s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.07it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.19s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:39:44 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:39:44 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:39:44 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:39:44 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:39:44 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:39:44 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:39:44 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:39:44 features:305] PADDING: 16
[NeMo I 2025-04-17 01:39:45 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:39:45 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:39:45 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:39:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:39:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:39:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:39:45 collections:880] Dataset successfully loaded with 2060 items and total duration provided from manifest is  0.81 hours.
[NeMo I 2025-04-17 01:39:45 collections:886] # 2060 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:07,  2.12s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:12,  2.31it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:07,  3.67it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.16it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  6.51it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  8.11it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01,  9.67it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:03<00:01, 11.20it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:03<00:01, 12.58it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:03<00:00, 13.31it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 13.76it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 14.18it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 14.63it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 14.45it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 14.98it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:04<00:00, 14.93it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:04<00:00,  8.01it/s]
[NeMo I 2025-04-17 01:39:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:39:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:39:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:39:49 collections:880] Dataset successfully loaded with 2259 items and total duration provided from manifest is  0.86 hours.
[NeMo I 2025-04-17 01:39:49 collections:886] # 2259 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:54,  1.57s/it][2/6] extract embeddings:   8%|▊         | 3/36 [00:01<00:14,  2.22it/s][2/6] extract embeddings:  14%|█▍        | 5/36 [00:01<00:07,  3.92it/s][2/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:05,  5.64it/s][2/6] extract embeddings:  25%|██▌       | 9/36 [00:02<00:03,  7.49it/s][2/6] extract embeddings:  31%|███       | 11/36 [00:02<00:02,  8.98it/s][2/6] extract embeddings:  36%|███▌      | 13/36 [00:02<00:02, 10.45it/s][2/6] extract embeddings:  42%|████▏     | 15/36 [00:02<00:01, 12.33it/s][2/6] extract embeddings:  50%|█████     | 18/36 [00:02<00:01, 14.97it/s][2/6] extract embeddings:  58%|█████▊    | 21/36 [00:02<00:00, 16.66it/s][2/6] extract embeddings:  67%|██████▋   | 24/36 [00:02<00:00, 18.61it/s][2/6] extract embeddings:  75%|███████▌  | 27/36 [00:03<00:00, 19.18it/s][2/6] extract embeddings:  83%|████████▎ | 30/36 [00:03<00:00, 18.45it/s][2/6] extract embeddings:  92%|█████████▏| 33/36 [00:03<00:00, 19.34it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 20.65it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 10.32it/s]
[NeMo I 2025-04-17 01:39:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:39:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:39:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:39:53 collections:880] Dataset successfully loaded with 2554 items and total duration provided from manifest is  0.90 hours.
[NeMo I 2025-04-17 01:39:53 collections:886] # 2554 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:47,  1.21s/it][3/6] extract embeddings:  10%|█         | 4/40 [00:01<00:09,  3.77it/s][3/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:04,  6.79it/s][3/6] extract embeddings:  25%|██▌       | 10/40 [00:01<00:03,  9.75it/s][3/6] extract embeddings:  32%|███▎      | 13/40 [00:01<00:02, 12.41it/s][3/6] extract embeddings:  40%|████      | 16/40 [00:01<00:01, 14.65it/s][3/6] extract embeddings:  48%|████▊     | 19/40 [00:02<00:01, 16.41it/s][3/6] extract embeddings:  55%|█████▌    | 22/40 [00:02<00:00, 18.20it/s][3/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:00, 19.16it/s][3/6] extract embeddings:  70%|███████   | 28/40 [00:02<00:00, 20.25it/s][3/6] extract embeddings:  78%|███████▊  | 31/40 [00:02<00:00, 20.76it/s][3/6] extract embeddings:  85%|████████▌ | 34/40 [00:02<00:00, 20.39it/s][3/6] extract embeddings:  92%|█████████▎| 37/40 [00:02<00:00, 21.50it/s][3/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 21.65it/s][3/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 13.34it/s]
[NeMo I 2025-04-17 01:39:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:39:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:39:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:39:56 collections:880] Dataset successfully loaded with 3142 items and total duration provided from manifest is  0.96 hours.
[NeMo I 2025-04-17 01:39:56 collections:886] # 3142 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/50 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/50 [00:01<00:56,  1.16s/it][4/6] extract embeddings:   8%|▊         | 4/50 [00:01<00:11,  3.94it/s][4/6] extract embeddings:  14%|█▍        | 7/50 [00:01<00:06,  7.10it/s][4/6] extract embeddings:  20%|██        | 10/50 [00:01<00:04,  9.95it/s][4/6] extract embeddings:  26%|██▌       | 13/50 [00:01<00:02, 12.51it/s][4/6] extract embeddings:  32%|███▏      | 16/50 [00:01<00:02, 14.96it/s][4/6] extract embeddings:  38%|███▊      | 19/50 [00:01<00:01, 17.25it/s][4/6] extract embeddings:  44%|████▍     | 22/50 [00:02<00:01, 19.10it/s][4/6] extract embeddings:  50%|█████     | 25/50 [00:02<00:01, 19.79it/s][4/6] extract embeddings:  56%|█████▌    | 28/50 [00:02<00:01, 21.15it/s][4/6] extract embeddings:  62%|██████▏   | 31/50 [00:02<00:00, 21.84it/s][4/6] extract embeddings:  68%|██████▊   | 34/50 [00:02<00:00, 22.53it/s][4/6] extract embeddings:  74%|███████▍  | 37/50 [00:02<00:00, 22.95it/s][4/6] extract embeddings:  80%|████████  | 40/50 [00:02<00:00, 23.39it/s][4/6] extract embeddings:  86%|████████▌ | 43/50 [00:02<00:00, 23.16it/s][4/6] extract embeddings:  92%|█████████▏| 46/50 [00:03<00:00, 23.46it/s][4/6] extract embeddings:  98%|█████████▊| 49/50 [00:03<00:00, 23.35it/s][4/6] extract embeddings: 100%|██████████| 50/50 [00:03<00:00, 15.27it/s]
[NeMo I 2025-04-17 01:40:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:40:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:40:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:40:00 collections:880] Dataset successfully loaded with 4463 items and total duration provided from manifest is  1.05 hours.
[NeMo I 2025-04-17 01:40:00 collections:886] # 4463 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/70 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/70 [00:01<01:19,  1.15s/it][5/6] extract embeddings:   6%|▌         | 4/70 [00:01<00:16,  4.04it/s][5/6] extract embeddings:  10%|█         | 7/70 [00:01<00:08,  7.40it/s][5/6] extract embeddings:  14%|█▍        | 10/70 [00:01<00:05, 10.91it/s][5/6] extract embeddings:  19%|█▊        | 13/70 [00:01<00:04, 13.28it/s][5/6] extract embeddings:  23%|██▎       | 16/70 [00:01<00:03, 16.06it/s][5/6] extract embeddings:  27%|██▋       | 19/70 [00:01<00:02, 18.61it/s][5/6] extract embeddings:  31%|███▏      | 22/70 [00:01<00:02, 20.84it/s][5/6] extract embeddings:  36%|███▌      | 25/70 [00:02<00:01, 22.63it/s][5/6] extract embeddings:  40%|████      | 28/70 [00:02<00:01, 23.31it/s][5/6] extract embeddings:  44%|████▍     | 31/70 [00:02<00:01, 24.56it/s][5/6] extract embeddings:  49%|████▊     | 34/70 [00:02<00:01, 25.65it/s][5/6] extract embeddings:  53%|█████▎    | 37/70 [00:02<00:01, 26.03it/s][5/6] extract embeddings:  57%|█████▋    | 40/70 [00:02<00:01, 26.82it/s][5/6] extract embeddings:  61%|██████▏   | 43/70 [00:02<00:01, 26.75it/s][5/6] extract embeddings:  66%|██████▌   | 46/70 [00:02<00:00, 26.82it/s][5/6] extract embeddings:  70%|███████   | 49/70 [00:02<00:00, 26.89it/s][5/6] extract embeddings:  74%|███████▍  | 52/70 [00:03<00:00, 27.37it/s][5/6] extract embeddings:  79%|███████▊  | 55/70 [00:03<00:00, 26.89it/s][5/6] extract embeddings:  83%|████████▎ | 58/70 [00:03<00:00, 26.77it/s][5/6] extract embeddings:  87%|████████▋ | 61/70 [00:03<00:00, 25.51it/s][5/6] extract embeddings:  91%|█████████▏| 64/70 [00:03<00:00, 25.58it/s][5/6] extract embeddings:  96%|█████████▌| 67/70 [00:03<00:00, 26.64it/s][5/6] extract embeddings: 100%|██████████| 70/70 [00:03<00:00, 27.03it/s][5/6] extract embeddings: 100%|██████████| 70/70 [00:03<00:00, 18.56it/s]
[NeMo I 2025-04-17 01:40:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:40:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:40:04 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:40:04 collections:880] Dataset successfully loaded with 8885 items and total duration provided from manifest is  1.16 hours.
[NeMo I 2025-04-17 01:40:04 collections:886] # 8885 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/139 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/139 [00:01<03:12,  1.39s/it][6/6] extract embeddings:   4%|▎         | 5/139 [00:01<00:31,  4.28it/s][6/6] extract embeddings:   6%|▌         | 8/139 [00:01<00:18,  7.23it/s][6/6] extract embeddings:   9%|▊         | 12/139 [00:01<00:11, 11.47it/s][6/6] extract embeddings:  12%|█▏        | 16/139 [00:01<00:07, 15.83it/s][6/6] extract embeddings:  14%|█▍        | 20/139 [00:01<00:05, 19.87it/s][6/6] extract embeddings:  17%|█▋        | 24/139 [00:02<00:05, 22.88it/s][6/6] extract embeddings:  20%|██        | 28/139 [00:02<00:04, 24.93it/s][6/6] extract embeddings:  23%|██▎       | 32/139 [00:02<00:04, 26.39it/s][6/6] extract embeddings:  26%|██▌       | 36/139 [00:02<00:03, 27.18it/s][6/6] extract embeddings:  29%|██▉       | 40/139 [00:02<00:03, 28.01it/s][6/6] extract embeddings:  32%|███▏      | 44/139 [00:02<00:03, 29.95it/s][6/6] extract embeddings:  35%|███▍      | 48/139 [00:02<00:03, 29.51it/s][6/6] extract embeddings:  37%|███▋      | 52/139 [00:02<00:02, 30.86it/s][6/6] extract embeddings:  40%|████      | 56/139 [00:03<00:02, 31.57it/s][6/6] extract embeddings:  43%|████▎     | 60/139 [00:03<00:02, 31.14it/s][6/6] extract embeddings:  46%|████▌     | 64/139 [00:03<00:02, 31.21it/s][6/6] extract embeddings:  49%|████▉     | 68/139 [00:03<00:02, 32.14it/s][6/6] extract embeddings:  52%|█████▏    | 72/139 [00:03<00:02, 31.59it/s][6/6] extract embeddings:  55%|█████▍    | 76/139 [00:03<00:01, 31.81it/s][6/6] extract embeddings:  58%|█████▊    | 80/139 [00:03<00:01, 31.65it/s][6/6] extract embeddings:  60%|██████    | 84/139 [00:03<00:01, 32.38it/s][6/6] extract embeddings:  63%|██████▎   | 88/139 [00:04<00:01, 31.94it/s][6/6] extract embeddings:  66%|██████▌   | 92/139 [00:04<00:01, 30.89it/s][6/6] extract embeddings:  69%|██████▉   | 96/139 [00:04<00:01, 30.95it/s][6/6] extract embeddings:  72%|███████▏  | 100/139 [00:04<00:01, 31.75it/s][6/6] extract embeddings:  75%|███████▍  | 104/139 [00:04<00:01, 31.25it/s][6/6] extract embeddings:  78%|███████▊  | 108/139 [00:04<00:00, 32.35it/s][6/6] extract embeddings:  81%|████████  | 112/139 [00:04<00:00, 32.64it/s][6/6] extract embeddings:  83%|████████▎ | 116/139 [00:04<00:00, 32.10it/s][6/6] extract embeddings:  86%|████████▋ | 120/139 [00:05<00:00, 32.01it/s][6/6] extract embeddings:  89%|████████▉ | 124/139 [00:05<00:00, 32.54it/s][6/6] extract embeddings:  92%|█████████▏| 128/139 [00:05<00:00, 33.43it/s][6/6] extract embeddings:  95%|█████████▍| 132/139 [00:05<00:00, 33.55it/s][6/6] extract embeddings:  98%|█████████▊| 136/139 [00:05<00:00, 33.83it/s][6/6] extract embeddings: 100%|██████████| 139/139 [00:05<00:00, 24.37it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.24it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.09it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.67it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s]
[NeMo I 2025-04-17 01:40:11 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:40:12 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              57.056588   444.120  ...  14.400107  3.242391
    Harker-ES                       50.800735  2178.782  ...  34.400503  1.578887
    Harker-MN                       55.903676   366.767  ...  28.617927  7.802754
    Longfellow-Block-1              47.317822   492.417  ...   9.061992  1.840309
    TOTAL                           51.643590  3482.086  ...  86.480529  2.483584
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:40:12 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0467 | MISS: 0.4449 | CER: 0.0248 | DER: 0.5164 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.30
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.3 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.82s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.94s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:40:24 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:40:24 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:40:24 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:40:24 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:40:24 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:40:24 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:40:24 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:40:24 features:305] PADDING: 16
[NeMo I 2025-04-17 01:40:25 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:40:25 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:40:25 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:40:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:40:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:40:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:40:25 collections:880] Dataset successfully loaded with 2037 items and total duration provided from manifest is  0.72 hours.
[NeMo I 2025-04-17 01:40:25 collections:886] # 2037 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:02,  2.02s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.42it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.66it/s][1/6] extract embeddings:  28%|██▊       | 9/32 [00:02<00:03,  6.22it/s][1/6] extract embeddings:  34%|███▍      | 11/32 [00:02<00:02,  7.78it/s][1/6] extract embeddings:  44%|████▍     | 14/32 [00:02<00:01, 10.69it/s][1/6] extract embeddings:  53%|█████▎    | 17/32 [00:02<00:01, 13.12it/s][1/6] extract embeddings:  62%|██████▎   | 20/32 [00:02<00:00, 15.01it/s][1/6] extract embeddings:  72%|███████▏  | 23/32 [00:03<00:00, 16.29it/s][1/6] extract embeddings:  81%|████████▏ | 26/32 [00:03<00:00, 17.03it/s][1/6] extract embeddings:  91%|█████████ | 29/32 [00:03<00:00, 18.16it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00, 18.91it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.05it/s]
[NeMo I 2025-04-17 01:40:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:40:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:40:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:40:28 collections:880] Dataset successfully loaded with 2189 items and total duration provided from manifest is  0.75 hours.
[NeMo I 2025-04-17 01:40:28 collections:886] # 2189 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:47,  1.38s/it][2/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:09,  3.34it/s][2/6] extract embeddings:  20%|██        | 7/35 [00:01<00:04,  6.05it/s][2/6] extract embeddings:  26%|██▌       | 9/35 [00:01<00:03,  7.91it/s][2/6] extract embeddings:  34%|███▍      | 12/35 [00:01<00:02, 10.68it/s][2/6] extract embeddings:  43%|████▎     | 15/35 [00:02<00:01, 13.22it/s][2/6] extract embeddings:  51%|█████▏    | 18/35 [00:02<00:01, 15.67it/s][2/6] extract embeddings:  60%|██████    | 21/35 [00:02<00:00, 17.57it/s][2/6] extract embeddings:  69%|██████▊   | 24/35 [00:02<00:00, 19.15it/s][2/6] extract embeddings:  77%|███████▋  | 27/35 [00:02<00:00, 19.65it/s][2/6] extract embeddings:  86%|████████▌ | 30/35 [00:02<00:00, 19.27it/s][2/6] extract embeddings:  94%|█████████▍| 33/35 [00:02<00:00, 19.85it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 11.76it/s]
[NeMo I 2025-04-17 01:40:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:40:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:40:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:40:32 collections:880] Dataset successfully loaded with 2437 items and total duration provided from manifest is  0.79 hours.
[NeMo I 2025-04-17 01:40:32 collections:886] # 2437 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:43,  1.14s/it][3/6] extract embeddings:  10%|█         | 4/39 [00:01<00:08,  3.93it/s][3/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  6.89it/s][3/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:02,  9.90it/s][3/6] extract embeddings:  33%|███▎      | 13/39 [00:01<00:02, 12.39it/s][3/6] extract embeddings:  41%|████      | 16/39 [00:01<00:01, 14.71it/s][3/6] extract embeddings:  49%|████▊     | 19/39 [00:01<00:01, 16.92it/s][3/6] extract embeddings:  56%|█████▋    | 22/39 [00:02<00:00, 18.48it/s][3/6] extract embeddings:  64%|██████▍   | 25/39 [00:02<00:00, 19.36it/s][3/6] extract embeddings:  72%|███████▏  | 28/39 [00:02<00:00, 20.13it/s][3/6] extract embeddings:  79%|███████▉  | 31/39 [00:02<00:00, 20.75it/s][3/6] extract embeddings:  87%|████████▋ | 34/39 [00:02<00:00, 21.20it/s][3/6] extract embeddings:  95%|█████████▍| 37/39 [00:02<00:00, 20.63it/s][3/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 13.50it/s]
[NeMo I 2025-04-17 01:40:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:40:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:40:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:40:35 collections:880] Dataset successfully loaded with 2947 items and total duration provided from manifest is  0.85 hours.
[NeMo I 2025-04-17 01:40:35 collections:886] # 2947 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:53,  1.16s/it][4/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:10,  3.96it/s][4/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:05,  7.08it/s][4/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:03, 10.10it/s][4/6] extract embeddings:  28%|██▊       | 13/47 [00:01<00:02, 13.05it/s][4/6] extract embeddings:  34%|███▍      | 16/47 [00:01<00:02, 15.41it/s][4/6] extract embeddings:  40%|████      | 19/47 [00:01<00:01, 17.98it/s][4/6] extract embeddings:  47%|████▋     | 22/47 [00:02<00:01, 19.68it/s][4/6] extract embeddings:  53%|█████▎    | 25/47 [00:02<00:01, 20.80it/s][4/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:00, 21.41it/s][4/6] extract embeddings:  66%|██████▌   | 31/47 [00:02<00:00, 22.50it/s][4/6] extract embeddings:  72%|███████▏  | 34/47 [00:02<00:00, 23.10it/s][4/6] extract embeddings:  79%|███████▊  | 37/47 [00:02<00:00, 23.43it/s][4/6] extract embeddings:  85%|████████▌ | 40/47 [00:02<00:00, 23.53it/s][4/6] extract embeddings:  91%|█████████▏| 43/47 [00:02<00:00, 23.41it/s][4/6] extract embeddings:  98%|█████████▊| 46/47 [00:03<00:00, 23.99it/s][4/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 15.20it/s]
[NeMo I 2025-04-17 01:40:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:40:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:40:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:40:38 collections:880] Dataset successfully loaded with 4097 items and total duration provided from manifest is  0.93 hours.
[NeMo I 2025-04-17 01:40:38 collections:886] # 4097 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/65 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/65 [00:01<01:12,  1.13s/it][5/6] extract embeddings:   6%|▌         | 4/65 [00:01<00:14,  4.09it/s][5/6] extract embeddings:  11%|█         | 7/65 [00:01<00:07,  7.36it/s][5/6] extract embeddings:  15%|█▌        | 10/65 [00:01<00:05, 10.57it/s][5/6] extract embeddings:  22%|██▏       | 14/65 [00:01<00:03, 14.63it/s][5/6] extract embeddings:  26%|██▌       | 17/65 [00:01<00:02, 17.07it/s][5/6] extract embeddings:  31%|███       | 20/65 [00:01<00:02, 19.46it/s][5/6] extract embeddings:  35%|███▌      | 23/65 [00:01<00:02, 20.87it/s][5/6] extract embeddings:  40%|████      | 26/65 [00:02<00:01, 22.25it/s][5/6] extract embeddings:  45%|████▍     | 29/65 [00:02<00:01, 23.98it/s][5/6] extract embeddings:  49%|████▉     | 32/65 [00:02<00:01, 24.88it/s][5/6] extract embeddings:  54%|█████▍    | 35/65 [00:02<00:01, 26.03it/s][5/6] extract embeddings:  58%|█████▊    | 38/65 [00:02<00:01, 26.53it/s][5/6] extract embeddings:  63%|██████▎   | 41/65 [00:02<00:00, 26.83it/s][5/6] extract embeddings:  68%|██████▊   | 44/65 [00:02<00:00, 26.98it/s][5/6] extract embeddings:  72%|███████▏  | 47/65 [00:02<00:00, 26.31it/s][5/6] extract embeddings:  77%|███████▋  | 50/65 [00:02<00:00, 25.24it/s][5/6] extract embeddings:  82%|████████▏ | 53/65 [00:03<00:00, 25.55it/s][5/6] extract embeddings:  86%|████████▌ | 56/65 [00:03<00:00, 25.88it/s][5/6] extract embeddings:  92%|█████████▏| 60/65 [00:03<00:00, 26.86it/s][5/6] extract embeddings:  97%|█████████▋| 63/65 [00:03<00:00, 26.50it/s][5/6] extract embeddings: 100%|██████████| 65/65 [00:03<00:00, 18.19it/s]
[NeMo I 2025-04-17 01:40:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:40:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:40:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:40:42 collections:880] Dataset successfully loaded with 8072 items and total duration provided from manifest is  1.04 hours.
[NeMo I 2025-04-17 01:40:42 collections:886] # 8072 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/127 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/127 [00:01<02:24,  1.15s/it][6/6] extract embeddings:   4%|▍         | 5/127 [00:01<00:23,  5.18it/s][6/6] extract embeddings:   7%|▋         | 9/127 [00:01<00:12,  9.64it/s][6/6] extract embeddings:  10%|█         | 13/127 [00:01<00:08, 14.08it/s][6/6] extract embeddings:  13%|█▎        | 17/127 [00:01<00:06, 17.87it/s][6/6] extract embeddings:  17%|█▋        | 21/127 [00:01<00:04, 21.40it/s][6/6] extract embeddings:  20%|█▉        | 25/127 [00:01<00:04, 24.73it/s][6/6] extract embeddings:  23%|██▎       | 29/127 [00:01<00:03, 26.97it/s][6/6] extract embeddings:  26%|██▌       | 33/127 [00:02<00:03, 27.40it/s][6/6] extract embeddings:  29%|██▉       | 37/127 [00:02<00:03, 28.73it/s][6/6] extract embeddings:  32%|███▏      | 41/127 [00:02<00:02, 29.57it/s][6/6] extract embeddings:  35%|███▌      | 45/127 [00:02<00:02, 30.88it/s][6/6] extract embeddings:  39%|███▊      | 49/127 [00:02<00:02, 32.13it/s][6/6] extract embeddings:  42%|████▏     | 53/127 [00:02<00:02, 31.43it/s][6/6] extract embeddings:  45%|████▍     | 57/127 [00:02<00:02, 31.23it/s][6/6] extract embeddings:  48%|████▊     | 61/127 [00:02<00:02, 31.92it/s][6/6] extract embeddings:  51%|█████     | 65/127 [00:03<00:01, 32.83it/s][6/6] extract embeddings:  54%|█████▍    | 69/127 [00:03<00:01, 32.80it/s][6/6] extract embeddings:  57%|█████▋    | 73/127 [00:03<00:01, 32.64it/s][6/6] extract embeddings:  61%|██████    | 77/127 [00:03<00:01, 33.50it/s][6/6] extract embeddings:  64%|██████▍   | 81/127 [00:03<00:01, 33.45it/s][6/6] extract embeddings:  67%|██████▋   | 85/127 [00:03<00:01, 33.75it/s][6/6] extract embeddings:  70%|███████   | 89/127 [00:03<00:01, 33.34it/s][6/6] extract embeddings:  73%|███████▎  | 93/127 [00:03<00:01, 33.46it/s][6/6] extract embeddings:  76%|███████▋  | 97/127 [00:04<00:00, 33.25it/s][6/6] extract embeddings:  80%|███████▉  | 101/127 [00:04<00:00, 32.95it/s][6/6] extract embeddings:  83%|████████▎ | 105/127 [00:04<00:00, 32.07it/s][6/6] extract embeddings:  86%|████████▌ | 109/127 [00:04<00:00, 33.19it/s][6/6] extract embeddings:  89%|████████▉ | 113/127 [00:04<00:00, 33.31it/s][6/6] extract embeddings:  92%|█████████▏| 117/127 [00:04<00:00, 33.23it/s][6/6] extract embeddings:  95%|█████████▌| 121/127 [00:04<00:00, 33.54it/s][6/6] extract embeddings:  98%|█████████▊| 125/127 [00:04<00:00, 33.81it/s][6/6] extract embeddings: 100%|██████████| 127/127 [00:04<00:00, 25.60it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.24it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.22it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.85it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.52it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s]
[NeMo I 2025-04-17 01:40:48 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:40:49 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              59.262012   444.120  ...  12.685020  2.856214
    Harker-ES                       55.441971  2178.782  ...  37.493576  1.720850
    Harker-MN                       57.999519   366.767  ...  27.388956  7.467672
    Longfellow-Block-1              50.867529   492.417  ...   9.647031  1.959118
    TOTAL                           55.551689  3482.086  ...  87.214583  2.504665
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:40:49 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0411 | MISS: 0.4894 | CER: 0.0250 | DER: 0.5555 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.40, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.4, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.80s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.94s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.24s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.09it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.17s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:41:01 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:41:01 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:41:01 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:41:01 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:41:01 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:41:02 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:41:02 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:41:02 features:305] PADDING: 16
[NeMo I 2025-04-17 01:41:02 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:41:02 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:41:02 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:41:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:41:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:02 collections:880] Dataset successfully loaded with 2101 items and total duration provided from manifest is  1.06 hours.
[NeMo I 2025-04-17 01:41:02 collections:886] # 2101 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  1.99s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.46it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.94it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.66it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.38it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  8.96it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.68it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.00it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 14.14it/s][1/6] extract embeddings:  64%|██████▎   | 21/33 [00:03<00:00, 14.43it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 16.00it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 16.29it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 16.19it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 16.52it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 16.88it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.75it/s]
[NeMo I 2025-04-17 01:41:06 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:41:06 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:06 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:06 collections:880] Dataset successfully loaded with 2378 items and total duration provided from manifest is  1.11 hours.
[NeMo I 2025-04-17 01:41:06 collections:886] # 2378 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:58,  1.58s/it][2/6] extract embeddings:   8%|▊         | 3/38 [00:01<00:15,  2.24it/s][2/6] extract embeddings:  13%|█▎        | 5/38 [00:01<00:08,  4.06it/s][2/6] extract embeddings:  21%|██        | 8/38 [00:01<00:04,  6.92it/s][2/6] extract embeddings:  26%|██▋       | 10/38 [00:02<00:03,  8.69it/s][2/6] extract embeddings:  32%|███▏      | 12/38 [00:02<00:02, 10.26it/s][2/6] extract embeddings:  37%|███▋      | 14/38 [00:02<00:02, 11.82it/s][2/6] extract embeddings:  42%|████▏     | 16/38 [00:02<00:01, 13.28it/s][2/6] extract embeddings:  47%|████▋     | 18/38 [00:02<00:01, 14.67it/s][2/6] extract embeddings:  53%|█████▎    | 20/38 [00:02<00:01, 15.69it/s][2/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 16.55it/s][2/6] extract embeddings:  63%|██████▎   | 24/38 [00:02<00:00, 17.28it/s][2/6] extract embeddings:  68%|██████▊   | 26/38 [00:02<00:00, 17.74it/s][2/6] extract embeddings:  74%|███████▎  | 28/38 [00:03<00:00, 17.72it/s][2/6] extract embeddings:  79%|███████▉  | 30/38 [00:03<00:00, 17.60it/s][2/6] extract embeddings:  84%|████████▍ | 32/38 [00:03<00:00, 17.39it/s][2/6] extract embeddings:  89%|████████▉ | 34/38 [00:03<00:00, 18.06it/s][2/6] extract embeddings:  95%|█████████▍| 36/38 [00:03<00:00, 18.52it/s][2/6] extract embeddings: 100%|██████████| 38/38 [00:03<00:00, 10.58it/s]
[NeMo I 2025-04-17 01:41:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:41:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:10 collections:880] Dataset successfully loaded with 2818 items and total duration provided from manifest is  1.17 hours.
[NeMo I 2025-04-17 01:41:10 collections:886] # 2818 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/45 [00:01<00:50,  1.15s/it][3/6] extract embeddings:   9%|▉         | 4/45 [00:01<00:10,  3.86it/s][3/6] extract embeddings:  13%|█▎        | 6/45 [00:01<00:06,  5.91it/s][3/6] extract embeddings:  18%|█▊        | 8/45 [00:01<00:04,  8.02it/s][3/6] extract embeddings:  22%|██▏       | 10/45 [00:01<00:03, 10.11it/s][3/6] extract embeddings:  29%|██▉       | 13/45 [00:01<00:02, 12.57it/s][3/6] extract embeddings:  36%|███▌      | 16/45 [00:01<00:02, 14.33it/s][3/6] extract embeddings:  42%|████▏     | 19/45 [00:02<00:01, 16.09it/s][3/6] extract embeddings:  47%|████▋     | 21/45 [00:02<00:01, 16.65it/s][3/6] extract embeddings:  51%|█████     | 23/45 [00:02<00:01, 17.42it/s][3/6] extract embeddings:  58%|█████▊    | 26/45 [00:02<00:01, 18.20it/s][3/6] extract embeddings:  64%|██████▍   | 29/45 [00:02<00:00, 19.19it/s][3/6] extract embeddings:  69%|██████▉   | 31/45 [00:02<00:00, 18.69it/s][3/6] extract embeddings:  73%|███████▎  | 33/45 [00:02<00:00, 18.61it/s][3/6] extract embeddings:  80%|████████  | 36/45 [00:02<00:00, 19.35it/s][3/6] extract embeddings:  84%|████████▍ | 38/45 [00:03<00:00, 18.89it/s][3/6] extract embeddings:  89%|████████▉ | 40/45 [00:03<00:00, 18.27it/s][3/6] extract embeddings:  96%|█████████▌| 43/45 [00:03<00:00, 19.22it/s][3/6] extract embeddings: 100%|██████████| 45/45 [00:03<00:00, 13.04it/s]
[NeMo I 2025-04-17 01:41:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:41:14 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:14 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:14 collections:880] Dataset successfully loaded with 3626 items and total duration provided from manifest is  1.24 hours.
[NeMo I 2025-04-17 01:41:14 collections:886] # 3626 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/57 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/57 [00:01<01:05,  1.17s/it][4/6] extract embeddings:   7%|▋         | 4/57 [00:01<00:13,  3.91it/s][4/6] extract embeddings:  12%|█▏        | 7/57 [00:01<00:07,  6.97it/s][4/6] extract embeddings:  18%|█▊        | 10/57 [00:01<00:04, 10.03it/s][4/6] extract embeddings:  23%|██▎       | 13/57 [00:01<00:03, 12.40it/s][4/6] extract embeddings:  28%|██▊       | 16/57 [00:01<00:02, 14.86it/s][4/6] extract embeddings:  33%|███▎      | 19/57 [00:01<00:02, 16.80it/s][4/6] extract embeddings:  39%|███▊      | 22/57 [00:02<00:01, 18.77it/s][4/6] extract embeddings:  44%|████▍     | 25/57 [00:02<00:01, 19.68it/s][4/6] extract embeddings:  49%|████▉     | 28/57 [00:02<00:01, 20.60it/s][4/6] extract embeddings:  54%|█████▍    | 31/57 [00:02<00:01, 20.69it/s][4/6] extract embeddings:  60%|█████▉    | 34/57 [00:02<00:01, 20.59it/s][4/6] extract embeddings:  65%|██████▍   | 37/57 [00:02<00:00, 21.45it/s][4/6] extract embeddings:  70%|███████   | 40/57 [00:02<00:00, 21.88it/s][4/6] extract embeddings:  75%|███████▌  | 43/57 [00:03<00:00, 21.68it/s][4/6] extract embeddings:  81%|████████  | 46/57 [00:03<00:00, 21.32it/s][4/6] extract embeddings:  86%|████████▌ | 49/57 [00:03<00:00, 21.40it/s][4/6] extract embeddings:  91%|█████████ | 52/57 [00:03<00:00, 22.03it/s][4/6] extract embeddings:  96%|█████████▋| 55/57 [00:03<00:00, 21.94it/s][4/6] extract embeddings: 100%|██████████| 57/57 [00:03<00:00, 15.42it/s]
[NeMo I 2025-04-17 01:41:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:41:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:17 collections:880] Dataset successfully loaded with 5354 items and total duration provided from manifest is  1.33 hours.
[NeMo I 2025-04-17 01:41:17 collections:886] # 5354 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/84 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/84 [00:01<01:33,  1.13s/it][5/6] extract embeddings:   5%|▍         | 4/84 [00:01<00:19,  4.14it/s][5/6] extract embeddings:   8%|▊         | 7/84 [00:01<00:10,  7.54it/s][5/6] extract embeddings:  12%|█▏        | 10/84 [00:01<00:06, 10.77it/s][5/6] extract embeddings:  15%|█▌        | 13/84 [00:01<00:05, 13.90it/s][5/6] extract embeddings:  19%|█▉        | 16/84 [00:01<00:04, 16.61it/s][5/6] extract embeddings:  23%|██▎       | 19/84 [00:01<00:03, 19.15it/s][5/6] extract embeddings:  26%|██▌       | 22/84 [00:01<00:03, 20.53it/s][5/6] extract embeddings:  30%|██▉       | 25/84 [00:02<00:02, 22.36it/s][5/6] extract embeddings:  33%|███▎      | 28/84 [00:02<00:02, 23.32it/s][5/6] extract embeddings:  37%|███▋      | 31/84 [00:02<00:02, 23.90it/s][5/6] extract embeddings:  40%|████      | 34/84 [00:02<00:01, 25.09it/s][5/6] extract embeddings:  44%|████▍     | 37/84 [00:02<00:01, 25.14it/s][5/6] extract embeddings:  48%|████▊     | 40/84 [00:02<00:01, 25.65it/s][5/6] extract embeddings:  51%|█████     | 43/84 [00:02<00:01, 25.59it/s][5/6] extract embeddings:  55%|█████▍    | 46/84 [00:02<00:01, 25.16it/s][5/6] extract embeddings:  58%|█████▊    | 49/84 [00:02<00:01, 25.41it/s][5/6] extract embeddings:  62%|██████▏   | 52/84 [00:03<00:01, 25.58it/s][5/6] extract embeddings:  65%|██████▌   | 55/84 [00:03<00:01, 26.50it/s][5/6] extract embeddings:  69%|██████▉   | 58/84 [00:03<00:01, 25.82it/s][5/6] extract embeddings:  73%|███████▎  | 61/84 [00:03<00:00, 25.29it/s][5/6] extract embeddings:  76%|███████▌  | 64/84 [00:03<00:00, 24.91it/s][5/6] extract embeddings:  80%|███████▉  | 67/84 [00:03<00:00, 24.08it/s][5/6] extract embeddings:  85%|████████▍ | 71/84 [00:03<00:00, 25.35it/s][5/6] extract embeddings:  88%|████████▊ | 74/84 [00:03<00:00, 25.83it/s][5/6] extract embeddings:  92%|█████████▏| 77/84 [00:04<00:00, 25.37it/s][5/6] extract embeddings:  95%|█████████▌| 80/84 [00:04<00:00, 26.00it/s][5/6] extract embeddings:  99%|█████████▉| 83/84 [00:04<00:00, 26.08it/s][5/6] extract embeddings: 100%|██████████| 84/84 [00:04<00:00, 19.33it/s]
[NeMo I 2025-04-17 01:41:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:41:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:22 collections:880] Dataset successfully loaded with 10834 items and total duration provided from manifest is  1.44 hours.
[NeMo I 2025-04-17 01:41:22 collections:886] # 10834 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/170 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/170 [00:01<03:08,  1.12s/it][6/6] extract embeddings:   3%|▎         | 5/170 [00:01<00:31,  5.27it/s][6/6] extract embeddings:   5%|▌         | 9/170 [00:01<00:16,  9.87it/s][6/6] extract embeddings:   8%|▊         | 13/170 [00:01<00:10, 14.49it/s][6/6] extract embeddings:  10%|█         | 17/170 [00:01<00:08, 18.26it/s][6/6] extract embeddings:  12%|█▏        | 21/170 [00:01<00:06, 21.39it/s][6/6] extract embeddings:  15%|█▍        | 25/170 [00:01<00:06, 23.94it/s][6/6] extract embeddings:  17%|█▋        | 29/170 [00:01<00:05, 26.80it/s][6/6] extract embeddings:  19%|█▉        | 33/170 [00:02<00:04, 27.82it/s][6/6] extract embeddings:  22%|██▏       | 37/170 [00:02<00:04, 29.05it/s][6/6] extract embeddings:  24%|██▍       | 41/170 [00:02<00:04, 29.93it/s][6/6] extract embeddings:  26%|██▋       | 45/170 [00:02<00:04, 29.78it/s][6/6] extract embeddings:  29%|██▉       | 49/170 [00:02<00:04, 29.87it/s][6/6] extract embeddings:  31%|███       | 53/170 [00:02<00:03, 30.11it/s][6/6] extract embeddings:  34%|███▎      | 57/170 [00:02<00:03, 29.93it/s][6/6] extract embeddings:  36%|███▌      | 61/170 [00:02<00:03, 30.14it/s][6/6] extract embeddings:  38%|███▊      | 65/170 [00:03<00:03, 30.90it/s][6/6] extract embeddings:  41%|████      | 69/170 [00:03<00:03, 30.99it/s][6/6] extract embeddings:  43%|████▎     | 73/170 [00:03<00:03, 31.50it/s][6/6] extract embeddings:  45%|████▌     | 77/170 [00:03<00:02, 32.69it/s][6/6] extract embeddings:  48%|████▊     | 81/170 [00:03<00:02, 32.15it/s][6/6] extract embeddings:  50%|█████     | 85/170 [00:03<00:02, 32.11it/s][6/6] extract embeddings:  52%|█████▏    | 89/170 [00:03<00:02, 31.91it/s][6/6] extract embeddings:  55%|█████▍    | 93/170 [00:04<00:02, 30.69it/s][6/6] extract embeddings:  57%|█████▋    | 97/170 [00:04<00:02, 31.35it/s][6/6] extract embeddings:  59%|█████▉    | 101/170 [00:04<00:02, 30.62it/s][6/6] extract embeddings:  62%|██████▏   | 105/170 [00:04<00:02, 31.24it/s][6/6] extract embeddings:  64%|██████▍   | 109/170 [00:04<00:01, 30.81it/s][6/6] extract embeddings:  66%|██████▋   | 113/170 [00:04<00:01, 30.68it/s][6/6] extract embeddings:  69%|██████▉   | 117/170 [00:04<00:01, 31.04it/s][6/6] extract embeddings:  71%|███████   | 121/170 [00:04<00:01, 31.83it/s][6/6] extract embeddings:  74%|███████▎  | 125/170 [00:05<00:01, 32.21it/s][6/6] extract embeddings:  76%|███████▌  | 129/170 [00:05<00:01, 32.03it/s][6/6] extract embeddings:  78%|███████▊  | 133/170 [00:05<00:01, 31.53it/s][6/6] extract embeddings:  81%|████████  | 137/170 [00:05<00:01, 32.22it/s][6/6] extract embeddings:  83%|████████▎ | 141/170 [00:05<00:00, 31.95it/s][6/6] extract embeddings:  85%|████████▌ | 145/170 [00:05<00:00, 32.80it/s][6/6] extract embeddings:  88%|████████▊ | 149/170 [00:05<00:00, 32.57it/s][6/6] extract embeddings:  90%|█████████ | 153/170 [00:05<00:00, 31.78it/s][6/6] extract embeddings:  92%|█████████▏| 157/170 [00:06<00:00, 31.49it/s][6/6] extract embeddings:  95%|█████████▍| 161/170 [00:06<00:00, 32.80it/s][6/6] extract embeddings:  97%|█████████▋| 165/170 [00:06<00:00, 31.46it/s][6/6] extract embeddings:  99%|█████████▉| 169/170 [00:06<00:00, 32.79it/s][6/6] extract embeddings: 100%|██████████| 170/170 [00:06<00:00, 26.43it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.00it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.65it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.34it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.81it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.44it/s]
[NeMo I 2025-04-17 01:41:31 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:41:32 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              48.189715   444.120  ...  12.820035  2.886615
    Harker-ES                       41.338915  2178.782  ...  43.670477  2.004353
    Harker-MN                       50.984973   366.767  ...  28.863944  7.869831
    Longfellow-Block-1              36.552733   492.417  ...   8.480967  1.722314
    TOTAL                           42.551876  3482.086  ...  93.835423  2.694805
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:41:32 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0606 | MISS: 0.3380 | CER: 0.0269 | DER: 0.4255 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.45, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.45, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.69s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.89s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:41:43 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:41:43 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:41:43 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:41:43 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:41:43 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:41:43 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:41:43 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:41:43 features:305] PADDING: 16
[NeMo I 2025-04-17 01:41:44 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:41:44 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:41:44 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:41:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:41:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:44 collections:880] Dataset successfully loaded with 2100 items and total duration provided from manifest is  1.04 hours.
[NeMo I 2025-04-17 01:41:44 collections:886] # 2100 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:07,  2.10s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:12,  2.34it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:07,  3.75it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.43it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.05it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  8.89it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.52it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.08it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:03<00:01, 13.48it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:03<00:00, 14.41it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 15.34it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 15.57it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 15.98it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 15.58it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 16.43it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 17.29it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.50it/s]
[NeMo I 2025-04-17 01:41:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:41:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:48 collections:880] Dataset successfully loaded with 2369 items and total duration provided from manifest is  1.09 hours.
[NeMo I 2025-04-17 01:41:48 collections:886] # 2369 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:51,  1.38s/it][2/6] extract embeddings:   8%|▊         | 3/38 [00:01<00:13,  2.53it/s][2/6] extract embeddings:  13%|█▎        | 5/38 [00:01<00:07,  4.52it/s][2/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  6.52it/s][2/6] extract embeddings:  24%|██▎       | 9/38 [00:01<00:03,  8.67it/s][2/6] extract embeddings:  29%|██▉       | 11/38 [00:01<00:02, 10.70it/s][2/6] extract embeddings:  34%|███▍      | 13/38 [00:02<00:02, 11.94it/s][2/6] extract embeddings:  39%|███▉      | 15/38 [00:02<00:01, 13.61it/s][2/6] extract embeddings:  45%|████▍     | 17/38 [00:02<00:01, 15.02it/s][2/6] extract embeddings:  53%|█████▎    | 20/38 [00:02<00:01, 16.69it/s][2/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 16.31it/s][2/6] extract embeddings:  63%|██████▎   | 24/38 [00:02<00:00, 16.77it/s][2/6] extract embeddings:  71%|███████   | 27/38 [00:02<00:00, 18.11it/s][2/6] extract embeddings:  76%|███████▋  | 29/38 [00:02<00:00, 18.01it/s][2/6] extract embeddings:  82%|████████▏ | 31/38 [00:03<00:00, 17.62it/s][2/6] extract embeddings:  87%|████████▋ | 33/38 [00:03<00:00, 17.46it/s][2/6] extract embeddings:  92%|█████████▏| 35/38 [00:03<00:00, 18.09it/s][2/6] extract embeddings: 100%|██████████| 38/38 [00:03<00:00, 19.10it/s][2/6] extract embeddings: 100%|██████████| 38/38 [00:03<00:00, 11.11it/s]
[NeMo I 2025-04-17 01:41:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:41:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:51 collections:880] Dataset successfully loaded with 2799 items and total duration provided from manifest is  1.15 hours.
[NeMo I 2025-04-17 01:41:51 collections:886] # 2799 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:50,  1.17s/it][3/6] extract embeddings:   9%|▉         | 4/44 [00:01<00:10,  3.85it/s][3/6] extract embeddings:  14%|█▎        | 6/44 [00:01<00:06,  5.85it/s][3/6] extract embeddings:  20%|██        | 9/44 [00:01<00:03,  9.06it/s][3/6] extract embeddings:  27%|██▋       | 12/44 [00:01<00:02, 11.74it/s][3/6] extract embeddings:  32%|███▏      | 14/44 [00:01<00:02, 13.23it/s][3/6] extract embeddings:  36%|███▋      | 16/44 [00:01<00:01, 14.50it/s][3/6] extract embeddings:  43%|████▎     | 19/44 [00:02<00:01, 16.39it/s][3/6] extract embeddings:  50%|█████     | 22/44 [00:02<00:01, 17.90it/s][3/6] extract embeddings:  57%|█████▋    | 25/44 [00:02<00:01, 17.89it/s][3/6] extract embeddings:  64%|██████▎   | 28/44 [00:02<00:00, 18.87it/s][3/6] extract embeddings:  70%|███████   | 31/44 [00:02<00:00, 19.10it/s][3/6] extract embeddings:  75%|███████▌  | 33/44 [00:02<00:00, 19.22it/s][3/6] extract embeddings:  80%|███████▉  | 35/44 [00:02<00:00, 19.38it/s][3/6] extract embeddings:  84%|████████▍ | 37/44 [00:02<00:00, 19.52it/s][3/6] extract embeddings:  91%|█████████ | 40/44 [00:03<00:00, 19.81it/s][3/6] extract embeddings:  98%|█████████▊| 43/44 [00:03<00:00, 20.58it/s][3/6] extract embeddings: 100%|██████████| 44/44 [00:03<00:00, 13.30it/s]
[NeMo I 2025-04-17 01:41:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:41:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:55 collections:880] Dataset successfully loaded with 3596 items and total duration provided from manifest is  1.22 hours.
[NeMo I 2025-04-17 01:41:55 collections:886] # 3596 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/57 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/57 [00:01<01:04,  1.15s/it][4/6] extract embeddings:   7%|▋         | 4/57 [00:01<00:13,  3.94it/s][4/6] extract embeddings:  12%|█▏        | 7/57 [00:01<00:07,  7.09it/s][4/6] extract embeddings:  18%|█▊        | 10/57 [00:01<00:04, 10.14it/s][4/6] extract embeddings:  23%|██▎       | 13/57 [00:01<00:03, 12.93it/s][4/6] extract embeddings:  28%|██▊       | 16/57 [00:01<00:02, 15.47it/s][4/6] extract embeddings:  33%|███▎      | 19/57 [00:01<00:02, 16.96it/s][4/6] extract embeddings:  39%|███▊      | 22/57 [00:02<00:01, 19.01it/s][4/6] extract embeddings:  44%|████▍     | 25/57 [00:02<00:01, 19.81it/s][4/6] extract embeddings:  49%|████▉     | 28/57 [00:02<00:01, 20.35it/s][4/6] extract embeddings:  54%|█████▍    | 31/57 [00:02<00:01, 21.05it/s][4/6] extract embeddings:  60%|█████▉    | 34/57 [00:02<00:01, 21.76it/s][4/6] extract embeddings:  65%|██████▍   | 37/57 [00:02<00:00, 21.71it/s][4/6] extract embeddings:  70%|███████   | 40/57 [00:02<00:00, 22.32it/s][4/6] extract embeddings:  75%|███████▌  | 43/57 [00:03<00:00, 21.96it/s][4/6] extract embeddings:  81%|████████  | 46/57 [00:03<00:00, 22.51it/s][4/6] extract embeddings:  86%|████████▌ | 49/57 [00:03<00:00, 21.99it/s][4/6] extract embeddings:  91%|█████████ | 52/57 [00:03<00:00, 22.88it/s][4/6] extract embeddings:  96%|█████████▋| 55/57 [00:03<00:00, 21.98it/s][4/6] extract embeddings: 100%|██████████| 57/57 [00:03<00:00, 15.67it/s]
[NeMo I 2025-04-17 01:41:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:41:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:41:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:41:59 collections:880] Dataset successfully loaded with 5290 items and total duration provided from manifest is  1.31 hours.
[NeMo I 2025-04-17 01:41:59 collections:886] # 5290 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/83 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/83 [00:01<01:43,  1.26s/it][5/6] extract embeddings:   5%|▍         | 4/83 [00:01<00:21,  3.74it/s][5/6] extract embeddings:   8%|▊         | 7/83 [00:01<00:11,  6.82it/s][5/6] extract embeddings:  12%|█▏        | 10/83 [00:01<00:07,  9.86it/s][5/6] extract embeddings:  16%|█▌        | 13/83 [00:01<00:05, 13.05it/s][5/6] extract embeddings:  19%|█▉        | 16/83 [00:01<00:04, 16.05it/s][5/6] extract embeddings:  23%|██▎       | 19/83 [00:01<00:03, 18.27it/s][5/6] extract embeddings:  27%|██▋       | 22/83 [00:02<00:02, 20.36it/s][5/6] extract embeddings:  30%|███       | 25/83 [00:02<00:02, 21.32it/s][5/6] extract embeddings:  34%|███▎      | 28/83 [00:02<00:02, 23.03it/s][5/6] extract embeddings:  37%|███▋      | 31/83 [00:02<00:02, 23.93it/s][5/6] extract embeddings:  41%|████      | 34/83 [00:02<00:01, 24.56it/s][5/6] extract embeddings:  45%|████▍     | 37/83 [00:02<00:01, 25.29it/s][5/6] extract embeddings:  48%|████▊     | 40/83 [00:02<00:01, 26.11it/s][5/6] extract embeddings:  52%|█████▏    | 43/83 [00:02<00:01, 25.80it/s][5/6] extract embeddings:  55%|█████▌    | 46/83 [00:02<00:01, 26.28it/s][5/6] extract embeddings:  59%|█████▉    | 49/83 [00:03<00:01, 26.66it/s][5/6] extract embeddings:  63%|██████▎   | 52/83 [00:03<00:01, 26.36it/s][5/6] extract embeddings:  66%|██████▋   | 55/83 [00:03<00:01, 26.24it/s][5/6] extract embeddings:  70%|██████▉   | 58/83 [00:03<00:00, 26.69it/s][5/6] extract embeddings:  73%|███████▎  | 61/83 [00:03<00:00, 26.00it/s][5/6] extract embeddings:  77%|███████▋  | 64/83 [00:03<00:00, 26.41it/s][5/6] extract embeddings:  81%|████████  | 67/83 [00:03<00:00, 25.71it/s][5/6] extract embeddings:  84%|████████▍ | 70/83 [00:03<00:00, 25.77it/s][5/6] extract embeddings:  88%|████████▊ | 73/83 [00:04<00:00, 26.59it/s][5/6] extract embeddings:  92%|█████████▏| 76/83 [00:04<00:00, 26.09it/s][5/6] extract embeddings:  95%|█████████▌| 79/83 [00:04<00:00, 25.77it/s][5/6] extract embeddings:  99%|█████████▉| 82/83 [00:04<00:00, 25.00it/s][5/6] extract embeddings: 100%|██████████| 83/83 [00:04<00:00, 18.76it/s]
[NeMo I 2025-04-17 01:42:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:42:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:42:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:42:03 collections:880] Dataset successfully loaded with 10678 items and total duration provided from manifest is  1.42 hours.
[NeMo I 2025-04-17 01:42:03 collections:886] # 10678 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/167 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/167 [00:01<03:52,  1.40s/it][6/6] extract embeddings:   3%|▎         | 5/167 [00:01<00:37,  4.29it/s][6/6] extract embeddings:   5%|▌         | 9/167 [00:01<00:19,  8.26it/s][6/6] extract embeddings:   8%|▊         | 13/167 [00:01<00:12, 12.43it/s][6/6] extract embeddings:  10%|█         | 17/167 [00:01<00:09, 16.49it/s][6/6] extract embeddings:  13%|█▎        | 21/167 [00:01<00:07, 20.20it/s][6/6] extract embeddings:  15%|█▍        | 25/167 [00:02<00:06, 22.84it/s][6/6] extract embeddings:  17%|█▋        | 29/167 [00:02<00:05, 24.93it/s][6/6] extract embeddings:  20%|█▉        | 33/167 [00:02<00:05, 26.66it/s][6/6] extract embeddings:  22%|██▏       | 37/167 [00:02<00:04, 27.04it/s][6/6] extract embeddings:  25%|██▍       | 41/167 [00:02<00:04, 28.82it/s][6/6] extract embeddings:  27%|██▋       | 45/167 [00:02<00:04, 29.72it/s][6/6] extract embeddings:  29%|██▉       | 49/167 [00:02<00:03, 30.06it/s][6/6] extract embeddings:  32%|███▏      | 53/167 [00:03<00:03, 30.81it/s][6/6] extract embeddings:  34%|███▍      | 57/167 [00:03<00:03, 31.17it/s][6/6] extract embeddings:  37%|███▋      | 61/167 [00:03<00:03, 30.99it/s][6/6] extract embeddings:  39%|███▉      | 65/167 [00:03<00:03, 32.15it/s][6/6] extract embeddings:  41%|████▏     | 69/167 [00:03<00:03, 32.28it/s][6/6] extract embeddings:  44%|████▎     | 73/167 [00:03<00:02, 33.02it/s][6/6] extract embeddings:  46%|████▌     | 77/167 [00:03<00:02, 31.75it/s][6/6] extract embeddings:  49%|████▊     | 81/167 [00:03<00:02, 32.17it/s][6/6] extract embeddings:  51%|█████     | 85/167 [00:04<00:02, 31.32it/s][6/6] extract embeddings:  53%|█████▎    | 89/167 [00:04<00:02, 31.86it/s][6/6] extract embeddings:  56%|█████▌    | 93/167 [00:04<00:02, 30.12it/s][6/6] extract embeddings:  58%|█████▊    | 97/167 [00:04<00:02, 30.78it/s][6/6] extract embeddings:  60%|██████    | 101/167 [00:04<00:02, 31.59it/s][6/6] extract embeddings:  63%|██████▎   | 105/167 [00:04<00:01, 31.52it/s][6/6] extract embeddings:  65%|██████▌   | 109/167 [00:04<00:01, 31.44it/s][6/6] extract embeddings:  68%|██████▊   | 113/167 [00:04<00:01, 31.27it/s][6/6] extract embeddings:  70%|███████   | 117/167 [00:05<00:01, 30.56it/s][6/6] extract embeddings:  72%|███████▏  | 121/167 [00:05<00:01, 31.70it/s][6/6] extract embeddings:  75%|███████▍  | 125/167 [00:05<00:01, 32.14it/s][6/6] extract embeddings:  77%|███████▋  | 129/167 [00:05<00:01, 32.09it/s][6/6] extract embeddings:  80%|███████▉  | 133/167 [00:05<00:01, 32.14it/s][6/6] extract embeddings:  82%|████████▏ | 137/167 [00:05<00:00, 31.88it/s][6/6] extract embeddings:  84%|████████▍ | 141/167 [00:05<00:00, 32.93it/s][6/6] extract embeddings:  87%|████████▋ | 145/167 [00:05<00:00, 32.35it/s][6/6] extract embeddings:  89%|████████▉ | 149/167 [00:06<00:00, 32.39it/s][6/6] extract embeddings:  92%|█████████▏| 153/167 [00:06<00:00, 33.20it/s][6/6] extract embeddings:  94%|█████████▍| 157/167 [00:06<00:00, 32.30it/s][6/6] extract embeddings:  96%|█████████▋| 161/167 [00:06<00:00, 32.24it/s][6/6] extract embeddings:  99%|█████████▉| 165/167 [00:06<00:00, 33.17it/s][6/6] extract embeddings: 100%|██████████| 167/167 [00:06<00:00, 25.33it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.04it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.69it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.37it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.46it/s]
[NeMo I 2025-04-17 01:42:12 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:42:13 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              48.518432   444.120  ...  13.620050  3.066750
    Harker-ES                       42.576346  2178.782  ...  47.273488  2.169721
    Harker-MN                       50.519035   366.767  ...  25.877917  7.055683
    Longfellow-Block-1              37.368900   492.417  ...   9.799978  1.990179
    TOTAL                           43.434418  3482.086  ...  96.571433  2.773379
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:42:13 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0594 | MISS: 0.3472 | CER: 0.0277 | DER: 0.4343 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.50, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.5, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.75s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:42:25 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:42:25 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:42:25 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:42:25 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:42:25 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:42:25 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:42:25 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:42:25 features:305] PADDING: 16
[NeMo I 2025-04-17 01:42:26 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:42:26 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:42:26 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:42:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:42:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:42:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:42:26 collections:880] Dataset successfully loaded with 2091 items and total duration provided from manifest is  1.02 hours.
[NeMo I 2025-04-17 01:42:26 collections:886] # 2091 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  1.97s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.47it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.98it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.63it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.44it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  9.41it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 11.16it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.53it/s][1/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:01, 13.56it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 14.38it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 15.71it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 16.78it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 16.90it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 16.45it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 16.96it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00, 18.99it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.91it/s]
[NeMo I 2025-04-17 01:42:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:42:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:42:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:42:30 collections:880] Dataset successfully loaded with 2350 items and total duration provided from manifest is  1.06 hours.
[NeMo I 2025-04-17 01:42:30 collections:886] # 2350 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:50,  1.39s/it][2/6] extract embeddings:   8%|▊         | 3/37 [00:01<00:13,  2.50it/s][2/6] extract embeddings:  14%|█▎        | 5/37 [00:01<00:07,  4.48it/s][2/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  6.53it/s][2/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02,  9.65it/s][2/6] extract embeddings:  32%|███▏      | 12/37 [00:01<00:02, 11.43it/s][2/6] extract embeddings:  38%|███▊      | 14/37 [00:02<00:01, 12.68it/s][2/6] extract embeddings:  46%|████▌     | 17/37 [00:02<00:01, 14.88it/s][2/6] extract embeddings:  51%|█████▏    | 19/37 [00:02<00:01, 15.92it/s][2/6] extract embeddings:  57%|█████▋    | 21/37 [00:02<00:00, 16.45it/s][2/6] extract embeddings:  65%|██████▍   | 24/37 [00:02<00:00, 17.61it/s][2/6] extract embeddings:  70%|███████   | 26/37 [00:02<00:00, 18.01it/s][2/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 18.14it/s][2/6] extract embeddings:  81%|████████  | 30/37 [00:02<00:00, 18.11it/s][2/6] extract embeddings:  86%|████████▋ | 32/37 [00:03<00:00, 17.29it/s][2/6] extract embeddings:  92%|█████████▏| 34/37 [00:03<00:00, 17.99it/s][2/6] extract embeddings:  97%|█████████▋| 36/37 [00:03<00:00, 18.20it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 11.12it/s]
[NeMo I 2025-04-17 01:42:33 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:42:33 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:42:33 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:42:33 collections:880] Dataset successfully loaded with 2773 items and total duration provided from manifest is  1.12 hours.
[NeMo I 2025-04-17 01:42:33 collections:886] # 2773 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:49,  1.16s/it][3/6] extract embeddings:   9%|▉         | 4/44 [00:01<00:10,  3.87it/s][3/6] extract embeddings:  14%|█▎        | 6/44 [00:01<00:06,  5.91it/s][3/6] extract embeddings:  20%|██        | 9/44 [00:01<00:03,  9.00it/s][3/6] extract embeddings:  25%|██▌       | 11/44 [00:01<00:03, 10.80it/s][3/6] extract embeddings:  30%|██▉       | 13/44 [00:01<00:02, 12.37it/s][3/6] extract embeddings:  36%|███▋      | 16/44 [00:01<00:01, 14.53it/s][3/6] extract embeddings:  43%|████▎     | 19/44 [00:02<00:01, 16.74it/s][3/6] extract embeddings:  48%|████▊     | 21/44 [00:02<00:01, 17.32it/s][3/6] extract embeddings:  55%|█████▍    | 24/44 [00:02<00:01, 18.91it/s][3/6] extract embeddings:  61%|██████▏   | 27/44 [00:02<00:00, 19.26it/s][3/6] extract embeddings:  68%|██████▊   | 30/44 [00:02<00:00, 19.82it/s][3/6] extract embeddings:  75%|███████▌  | 33/44 [00:02<00:00, 19.38it/s][3/6] extract embeddings:  80%|███████▉  | 35/44 [00:02<00:00, 18.49it/s][3/6] extract embeddings:  86%|████████▋ | 38/44 [00:03<00:00, 19.29it/s][3/6] extract embeddings:  91%|█████████ | 40/44 [00:03<00:00, 18.92it/s][3/6] extract embeddings:  98%|█████████▊| 43/44 [00:03<00:00, 19.94it/s][3/6] extract embeddings: 100%|██████████| 44/44 [00:03<00:00, 13.29it/s]
[NeMo I 2025-04-17 01:42:37 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:42:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:42:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:42:37 collections:880] Dataset successfully loaded with 3551 items and total duration provided from manifest is  1.20 hours.
[NeMo I 2025-04-17 01:42:37 collections:886] # 3551 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/56 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/56 [00:01<01:03,  1.15s/it][4/6] extract embeddings:   7%|▋         | 4/56 [00:01<00:13,  3.96it/s][4/6] extract embeddings:  12%|█▎        | 7/56 [00:01<00:06,  7.05it/s][4/6] extract embeddings:  18%|█▊        | 10/56 [00:01<00:04, 10.03it/s][4/6] extract embeddings:  23%|██▎       | 13/56 [00:01<00:03, 12.69it/s][4/6] extract embeddings:  29%|██▊       | 16/56 [00:01<00:02, 15.08it/s][4/6] extract embeddings:  34%|███▍      | 19/56 [00:01<00:02, 16.63it/s][4/6] extract embeddings:  39%|███▉      | 22/56 [00:02<00:01, 18.08it/s][4/6] extract embeddings:  45%|████▍     | 25/56 [00:02<00:01, 19.01it/s][4/6] extract embeddings:  50%|█████     | 28/56 [00:02<00:01, 19.77it/s][4/6] extract embeddings:  55%|█████▌    | 31/56 [00:02<00:01, 20.43it/s][4/6] extract embeddings:  61%|██████    | 34/56 [00:02<00:01, 20.55it/s][4/6] extract embeddings:  66%|██████▌   | 37/56 [00:02<00:00, 20.78it/s][4/6] extract embeddings:  71%|███████▏  | 40/56 [00:02<00:00, 21.63it/s][4/6] extract embeddings:  77%|███████▋  | 43/56 [00:03<00:00, 21.49it/s][4/6] extract embeddings:  82%|████████▏ | 46/56 [00:03<00:00, 20.64it/s][4/6] extract embeddings:  88%|████████▊ | 49/56 [00:03<00:00, 20.47it/s][4/6] extract embeddings:  93%|█████████▎| 52/56 [00:03<00:00, 20.74it/s][4/6] extract embeddings:  98%|█████████▊| 55/56 [00:03<00:00, 21.55it/s][4/6] extract embeddings: 100%|██████████| 56/56 [00:03<00:00, 15.12it/s]
[NeMo I 2025-04-17 01:42:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:42:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:42:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:42:41 collections:880] Dataset successfully loaded with 5211 items and total duration provided from manifest is  1.29 hours.
[NeMo I 2025-04-17 01:42:41 collections:886] # 5211 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/82 [00:00<?, ?it/s][5/6] extract embeddings:   1%|          | 1/82 [00:01<01:33,  1.16s/it][5/6] extract embeddings:   5%|▍         | 4/82 [00:01<00:19,  3.98it/s][5/6] extract embeddings:   9%|▊         | 7/82 [00:01<00:10,  7.27it/s][5/6] extract embeddings:  12%|█▏        | 10/82 [00:01<00:06, 10.66it/s][5/6] extract embeddings:  16%|█▌        | 13/82 [00:01<00:04, 13.94it/s][5/6] extract embeddings:  20%|█▉        | 16/82 [00:01<00:03, 16.79it/s][5/6] extract embeddings:  23%|██▎       | 19/82 [00:01<00:03, 18.93it/s][5/6] extract embeddings:  27%|██▋       | 22/82 [00:01<00:02, 21.03it/s][5/6] extract embeddings:  30%|███       | 25/82 [00:02<00:02, 23.01it/s][5/6] extract embeddings:  34%|███▍      | 28/82 [00:02<00:02, 23.44it/s][5/6] extract embeddings:  38%|███▊      | 31/82 [00:02<00:02, 24.69it/s][5/6] extract embeddings:  41%|████▏     | 34/82 [00:02<00:01, 25.22it/s][5/6] extract embeddings:  45%|████▌     | 37/82 [00:02<00:01, 26.05it/s][5/6] extract embeddings:  49%|████▉     | 40/82 [00:02<00:01, 25.68it/s][5/6] extract embeddings:  52%|█████▏    | 43/82 [00:02<00:01, 26.50it/s][5/6] extract embeddings:  56%|█████▌    | 46/82 [00:02<00:01, 25.84it/s][5/6] extract embeddings:  60%|█████▉    | 49/82 [00:02<00:01, 25.87it/s][5/6] extract embeddings:  63%|██████▎   | 52/82 [00:03<00:01, 26.77it/s][5/6] extract embeddings:  67%|██████▋   | 55/82 [00:03<00:00, 27.37it/s][5/6] extract embeddings:  71%|███████   | 58/82 [00:03<00:00, 27.49it/s][5/6] extract embeddings:  74%|███████▍  | 61/82 [00:03<00:00, 26.41it/s][5/6] extract embeddings:  78%|███████▊  | 64/82 [00:03<00:00, 27.39it/s][5/6] extract embeddings:  82%|████████▏ | 67/82 [00:03<00:00, 27.29it/s][5/6] extract embeddings:  85%|████████▌ | 70/82 [00:03<00:00, 27.08it/s][5/6] extract embeddings:  89%|████████▉ | 73/82 [00:03<00:00, 26.68it/s][5/6] extract embeddings:  93%|█████████▎| 76/82 [00:03<00:00, 26.91it/s][5/6] extract embeddings:  96%|█████████▋| 79/82 [00:04<00:00, 26.97it/s][5/6] extract embeddings: 100%|██████████| 82/82 [00:04<00:00, 19.58it/s]
[NeMo I 2025-04-17 01:42:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:42:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:42:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:42:45 collections:880] Dataset successfully loaded with 10518 items and total duration provided from manifest is  1.40 hours.
[NeMo I 2025-04-17 01:42:45 collections:886] # 10518 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/165 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/165 [00:01<03:16,  1.20s/it][6/6] extract embeddings:   3%|▎         | 5/165 [00:01<00:32,  4.88it/s][6/6] extract embeddings:   5%|▌         | 9/165 [00:01<00:17,  9.14it/s][6/6] extract embeddings:   7%|▋         | 12/165 [00:01<00:12, 12.07it/s][6/6] extract embeddings:  10%|▉         | 16/165 [00:01<00:09, 16.33it/s][6/6] extract embeddings:  12%|█▏        | 20/165 [00:01<00:07, 19.58it/s][6/6] extract embeddings:  15%|█▍        | 24/165 [00:01<00:06, 22.71it/s][6/6] extract embeddings:  17%|█▋        | 28/165 [00:02<00:05, 25.52it/s][6/6] extract embeddings:  19%|█▉        | 32/165 [00:02<00:04, 26.93it/s][6/6] extract embeddings:  22%|██▏       | 36/165 [00:02<00:04, 27.78it/s][6/6] extract embeddings:  24%|██▍       | 40/165 [00:02<00:04, 28.86it/s][6/6] extract embeddings:  27%|██▋       | 44/165 [00:02<00:04, 29.84it/s][6/6] extract embeddings:  29%|██▉       | 48/165 [00:02<00:03, 30.41it/s][6/6] extract embeddings:  32%|███▏      | 52/165 [00:02<00:03, 31.06it/s][6/6] extract embeddings:  34%|███▍      | 56/165 [00:02<00:03, 31.35it/s][6/6] extract embeddings:  36%|███▋      | 60/165 [00:03<00:03, 31.38it/s][6/6] extract embeddings:  39%|███▉      | 64/165 [00:03<00:03, 30.80it/s][6/6] extract embeddings:  41%|████      | 68/165 [00:03<00:03, 31.19it/s][6/6] extract embeddings:  44%|████▎     | 72/165 [00:03<00:03, 29.81it/s][6/6] extract embeddings:  46%|████▌     | 76/165 [00:03<00:02, 30.51it/s][6/6] extract embeddings:  48%|████▊     | 80/165 [00:03<00:02, 30.82it/s][6/6] extract embeddings:  51%|█████     | 84/165 [00:03<00:02, 31.14it/s][6/6] extract embeddings:  53%|█████▎    | 88/165 [00:03<00:02, 32.30it/s][6/6] extract embeddings:  56%|█████▌    | 92/165 [00:04<00:02, 32.44it/s][6/6] extract embeddings:  58%|█████▊    | 96/165 [00:04<00:02, 32.32it/s][6/6] extract embeddings:  61%|██████    | 100/165 [00:04<00:02, 31.39it/s][6/6] extract embeddings:  63%|██████▎   | 104/165 [00:04<00:01, 31.94it/s][6/6] extract embeddings:  65%|██████▌   | 108/165 [00:04<00:01, 32.42it/s][6/6] extract embeddings:  68%|██████▊   | 112/165 [00:04<00:01, 31.99it/s][6/6] extract embeddings:  70%|███████   | 116/165 [00:04<00:01, 32.07it/s][6/6] extract embeddings:  73%|███████▎  | 120/165 [00:04<00:01, 32.72it/s][6/6] extract embeddings:  75%|███████▌  | 124/165 [00:05<00:01, 32.75it/s][6/6] extract embeddings:  78%|███████▊  | 128/165 [00:05<00:01, 30.17it/s][6/6] extract embeddings:  80%|████████  | 132/165 [00:05<00:01, 30.15it/s][6/6] extract embeddings:  82%|████████▏ | 136/165 [00:05<00:00, 31.38it/s][6/6] extract embeddings:  85%|████████▍ | 140/165 [00:05<00:00, 31.02it/s][6/6] extract embeddings:  87%|████████▋ | 144/165 [00:05<00:00, 31.00it/s][6/6] extract embeddings:  90%|████████▉ | 148/165 [00:05<00:00, 30.60it/s][6/6] extract embeddings:  92%|█████████▏| 152/165 [00:06<00:00, 31.47it/s][6/6] extract embeddings:  95%|█████████▍| 156/165 [00:06<00:00, 32.20it/s][6/6] extract embeddings:  97%|█████████▋| 160/165 [00:06<00:00, 33.10it/s][6/6] extract embeddings:  99%|█████████▉| 164/165 [00:06<00:00, 31.66it/s][6/6] extract embeddings: 100%|██████████| 165/165 [00:06<00:00, 25.67it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.09it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.71it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.40it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.51it/s]
[NeMo I 2025-04-17 01:42:53 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:42:55 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              48.730077   444.120  ...  13.570047  3.055491
    Harker-ES                       43.159628  2178.782  ...  43.736486  2.007382
    Harker-MN                       51.342714   366.767  ...  27.100916  7.389137
    Longfellow-Block-1              37.686943   492.417  ...   8.455001  1.717041
    TOTAL                           43.958112  3482.086  ...  92.862451  2.666863
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:42:55 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0578 | MISS: 0.3551 | CER: 0.0267 | DER: 0.4396 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.55, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.55, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.71s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:43:06 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:43:06 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:43:06 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:43:06 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:43:06 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:43:06 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:43:06 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:43:06 features:305] PADDING: 16
[NeMo I 2025-04-17 01:43:07 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:43:07 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:43:07 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:43:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:43:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:07 collections:880] Dataset successfully loaded with 2081 items and total duration provided from manifest is  0.99 hours.
[NeMo I 2025-04-17 01:43:07 collections:886] # 2081 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:04,  2.02s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.42it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.58it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.13it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  7.73it/s][1/6] extract embeddings:  39%|███▉      | 13/33 [00:02<00:02,  9.54it/s][1/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 11.26it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 12.86it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 14.57it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:03<00:00, 16.15it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 15.87it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 16.51it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 16.35it/s][1/6] extract embeddings:  94%|█████████▍| 31/33 [00:03<00:00, 16.87it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.84it/s]
[NeMo I 2025-04-17 01:43:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:43:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:11 collections:880] Dataset successfully loaded with 2330 items and total duration provided from manifest is  1.03 hours.
[NeMo I 2025-04-17 01:43:11 collections:886] # 2330 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:50,  1.41s/it][2/6] extract embeddings:   8%|▊         | 3/37 [00:01<00:13,  2.48it/s][2/6] extract embeddings:  14%|█▎        | 5/37 [00:01<00:07,  4.49it/s][2/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  6.58it/s][2/6] extract embeddings:  24%|██▍       | 9/37 [00:01<00:03,  8.71it/s][2/6] extract embeddings:  30%|██▉       | 11/37 [00:01<00:02, 10.74it/s][2/6] extract embeddings:  35%|███▌      | 13/37 [00:02<00:01, 12.31it/s][2/6] extract embeddings:  43%|████▎     | 16/37 [00:02<00:01, 15.06it/s][2/6] extract embeddings:  51%|█████▏    | 19/37 [00:02<00:01, 16.88it/s][2/6] extract embeddings:  57%|█████▋    | 21/37 [00:02<00:00, 17.50it/s][2/6] extract embeddings:  62%|██████▏   | 23/37 [00:02<00:00, 17.01it/s][2/6] extract embeddings:  70%|███████   | 26/37 [00:02<00:00, 18.34it/s][2/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 17.91it/s][2/6] extract embeddings:  81%|████████  | 30/37 [00:02<00:00, 18.29it/s][2/6] extract embeddings:  86%|████████▋ | 32/37 [00:03<00:00, 18.65it/s][2/6] extract embeddings:  92%|█████████▏| 34/37 [00:03<00:00, 18.23it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 20.24it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 11.23it/s]
[NeMo I 2025-04-17 01:43:14 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:43:14 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:14 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:14 collections:880] Dataset successfully loaded with 2739 items and total duration provided from manifest is  1.09 hours.
[NeMo I 2025-04-17 01:43:14 collections:886] # 2739 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:48,  1.16s/it][3/6] extract embeddings:   9%|▉         | 4/43 [00:01<00:10,  3.84it/s][3/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:05,  6.90it/s][3/6] extract embeddings:  21%|██        | 9/43 [00:01<00:03,  8.72it/s][3/6] extract embeddings:  28%|██▊       | 12/43 [00:01<00:02, 11.65it/s][3/6] extract embeddings:  33%|███▎      | 14/43 [00:01<00:02, 12.97it/s][3/6] extract embeddings:  40%|███▉      | 17/43 [00:01<00:01, 14.99it/s][3/6] extract embeddings:  47%|████▋     | 20/43 [00:02<00:01, 16.93it/s][3/6] extract embeddings:  53%|█████▎    | 23/43 [00:02<00:01, 18.29it/s][3/6] extract embeddings:  60%|██████    | 26/43 [00:02<00:00, 18.68it/s][3/6] extract embeddings:  67%|██████▋   | 29/43 [00:02<00:00, 19.61it/s][3/6] extract embeddings:  74%|███████▍  | 32/43 [00:02<00:00, 19.68it/s][3/6] extract embeddings:  81%|████████▏ | 35/43 [00:02<00:00, 20.50it/s][3/6] extract embeddings:  88%|████████▊ | 38/43 [00:02<00:00, 20.37it/s][3/6] extract embeddings:  95%|█████████▌| 41/43 [00:03<00:00, 20.35it/s][3/6] extract embeddings: 100%|██████████| 43/43 [00:03<00:00, 13.34it/s]
[NeMo I 2025-04-17 01:43:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:43:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:18 collections:880] Dataset successfully loaded with 3488 items and total duration provided from manifest is  1.16 hours.
[NeMo I 2025-04-17 01:43:18 collections:886] # 3488 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/55 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/55 [00:01<01:04,  1.20s/it][4/6] extract embeddings:   7%|▋         | 4/55 [00:01<00:13,  3.82it/s][4/6] extract embeddings:  13%|█▎        | 7/55 [00:01<00:06,  6.95it/s][4/6] extract embeddings:  18%|█▊        | 10/55 [00:01<00:04,  9.89it/s][4/6] extract embeddings:  24%|██▎       | 13/55 [00:01<00:03, 12.50it/s][4/6] extract embeddings:  29%|██▉       | 16/55 [00:01<00:02, 14.34it/s][4/6] extract embeddings:  35%|███▍      | 19/55 [00:02<00:02, 15.55it/s][4/6] extract embeddings:  38%|███▊      | 21/55 [00:02<00:02, 15.89it/s][4/6] extract embeddings:  44%|████▎     | 24/55 [00:02<00:01, 17.99it/s][4/6] extract embeddings:  49%|████▉     | 27/55 [00:02<00:01, 19.07it/s][4/6] extract embeddings:  55%|█████▍    | 30/55 [00:02<00:01, 20.33it/s][4/6] extract embeddings:  60%|██████    | 33/55 [00:02<00:01, 20.95it/s][4/6] extract embeddings:  65%|██████▌   | 36/55 [00:02<00:00, 21.83it/s][4/6] extract embeddings:  71%|███████   | 39/55 [00:02<00:00, 21.56it/s][4/6] extract embeddings:  76%|███████▋  | 42/55 [00:03<00:00, 21.06it/s][4/6] extract embeddings:  82%|████████▏ | 45/55 [00:03<00:00, 21.36it/s][4/6] extract embeddings:  87%|████████▋ | 48/55 [00:03<00:00, 21.36it/s][4/6] extract embeddings:  93%|█████████▎| 51/55 [00:03<00:00, 21.38it/s][4/6] extract embeddings:  98%|█████████▊| 54/55 [00:03<00:00, 21.70it/s][4/6] extract embeddings: 100%|██████████| 55/55 [00:03<00:00, 14.85it/s]
[NeMo I 2025-04-17 01:43:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:43:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:21 collections:880] Dataset successfully loaded with 5108 items and total duration provided from manifest is  1.25 hours.
[NeMo I 2025-04-17 01:43:21 collections:886] # 5108 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/80 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/80 [00:01<01:29,  1.13s/it][5/6] extract embeddings:   5%|▌         | 4/80 [00:01<00:18,  4.10it/s][5/6] extract embeddings:   9%|▉         | 7/80 [00:01<00:09,  7.41it/s][5/6] extract embeddings:  12%|█▎        | 10/80 [00:01<00:06, 10.75it/s][5/6] extract embeddings:  16%|█▋        | 13/80 [00:01<00:04, 13.82it/s][5/6] extract embeddings:  20%|██        | 16/80 [00:01<00:03, 16.66it/s][5/6] extract embeddings:  24%|██▍       | 19/80 [00:01<00:03, 19.23it/s][5/6] extract embeddings:  28%|██▊       | 22/80 [00:01<00:02, 21.30it/s][5/6] extract embeddings:  31%|███▏      | 25/80 [00:02<00:02, 23.01it/s][5/6] extract embeddings:  35%|███▌      | 28/80 [00:02<00:02, 23.98it/s][5/6] extract embeddings:  39%|███▉      | 31/80 [00:02<00:01, 25.00it/s][5/6] extract embeddings:  42%|████▎     | 34/80 [00:02<00:01, 24.62it/s][5/6] extract embeddings:  48%|████▊     | 38/80 [00:02<00:01, 26.09it/s][5/6] extract embeddings:  51%|█████▏    | 41/80 [00:02<00:01, 25.54it/s][5/6] extract embeddings:  55%|█████▌    | 44/80 [00:02<00:01, 25.82it/s][5/6] extract embeddings:  59%|█████▉    | 47/80 [00:02<00:01, 25.80it/s][5/6] extract embeddings:  62%|██████▎   | 50/80 [00:02<00:01, 25.49it/s][5/6] extract embeddings:  66%|██████▋   | 53/80 [00:03<00:01, 26.13it/s][5/6] extract embeddings:  70%|███████   | 56/80 [00:03<00:00, 26.32it/s][5/6] extract embeddings:  74%|███████▍  | 59/80 [00:03<00:00, 25.39it/s][5/6] extract embeddings:  78%|███████▊  | 62/80 [00:03<00:00, 26.06it/s][5/6] extract embeddings:  81%|████████▏ | 65/80 [00:03<00:00, 25.93it/s][5/6] extract embeddings:  85%|████████▌ | 68/80 [00:03<00:00, 26.53it/s][5/6] extract embeddings:  89%|████████▉ | 71/80 [00:03<00:00, 26.50it/s][5/6] extract embeddings:  92%|█████████▎| 74/80 [00:03<00:00, 26.41it/s][5/6] extract embeddings:  96%|█████████▋| 77/80 [00:04<00:00, 25.71it/s][5/6] extract embeddings: 100%|██████████| 80/80 [00:04<00:00, 26.78it/s][5/6] extract embeddings: 100%|██████████| 80/80 [00:04<00:00, 19.26it/s]
[NeMo I 2025-04-17 01:43:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:43:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:26 collections:880] Dataset successfully loaded with 10303 items and total duration provided from manifest is  1.37 hours.
[NeMo I 2025-04-17 01:43:26 collections:886] # 10303 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/161 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/161 [00:01<03:12,  1.20s/it][6/6] extract embeddings:   3%|▎         | 5/161 [00:01<00:31,  4.89it/s][6/6] extract embeddings:   6%|▌         | 9/161 [00:01<00:16,  9.21it/s][6/6] extract embeddings:   8%|▊         | 13/161 [00:01<00:10, 13.55it/s][6/6] extract embeddings:  11%|█         | 17/161 [00:01<00:08, 17.59it/s][6/6] extract embeddings:  13%|█▎        | 21/161 [00:01<00:06, 21.18it/s][6/6] extract embeddings:  16%|█▌        | 25/161 [00:01<00:05, 23.79it/s][6/6] extract embeddings:  18%|█▊        | 29/161 [00:02<00:05, 25.45it/s][6/6] extract embeddings:  20%|██        | 33/161 [00:02<00:04, 27.58it/s][6/6] extract embeddings:  23%|██▎       | 37/161 [00:02<00:04, 27.08it/s][6/6] extract embeddings:  25%|██▌       | 41/161 [00:02<00:04, 28.55it/s][6/6] extract embeddings:  28%|██▊       | 45/161 [00:02<00:03, 30.13it/s][6/6] extract embeddings:  30%|███       | 49/161 [00:02<00:03, 30.53it/s][6/6] extract embeddings:  33%|███▎      | 53/161 [00:02<00:03, 30.77it/s][6/6] extract embeddings:  35%|███▌      | 57/161 [00:02<00:03, 31.89it/s][6/6] extract embeddings:  38%|███▊      | 61/161 [00:03<00:03, 32.72it/s][6/6] extract embeddings:  40%|████      | 65/161 [00:03<00:02, 32.84it/s][6/6] extract embeddings:  43%|████▎     | 69/161 [00:03<00:02, 32.72it/s][6/6] extract embeddings:  45%|████▌     | 73/161 [00:03<00:02, 32.55it/s][6/6] extract embeddings:  48%|████▊     | 77/161 [00:03<00:02, 33.14it/s][6/6] extract embeddings:  50%|█████     | 81/161 [00:03<00:02, 32.87it/s][6/6] extract embeddings:  53%|█████▎    | 85/161 [00:03<00:02, 32.05it/s][6/6] extract embeddings:  55%|█████▌    | 89/161 [00:03<00:02, 31.51it/s][6/6] extract embeddings:  58%|█████▊    | 93/161 [00:04<00:02, 32.42it/s][6/6] extract embeddings:  60%|██████    | 97/161 [00:04<00:01, 32.37it/s][6/6] extract embeddings:  63%|██████▎   | 101/161 [00:04<00:01, 31.38it/s][6/6] extract embeddings:  65%|██████▌   | 105/161 [00:04<00:01, 31.20it/s][6/6] extract embeddings:  68%|██████▊   | 109/161 [00:04<00:01, 30.83it/s][6/6] extract embeddings:  70%|███████   | 113/161 [00:04<00:01, 31.25it/s][6/6] extract embeddings:  73%|███████▎  | 117/161 [00:04<00:01, 31.69it/s][6/6] extract embeddings:  75%|███████▌  | 121/161 [00:04<00:01, 31.80it/s][6/6] extract embeddings:  78%|███████▊  | 125/161 [00:05<00:01, 31.99it/s][6/6] extract embeddings:  80%|████████  | 129/161 [00:05<00:00, 32.28it/s][6/6] extract embeddings:  83%|████████▎ | 133/161 [00:05<00:00, 31.56it/s][6/6] extract embeddings:  85%|████████▌ | 137/161 [00:05<00:00, 31.88it/s][6/6] extract embeddings:  88%|████████▊ | 141/161 [00:05<00:00, 33.07it/s][6/6] extract embeddings:  90%|█████████ | 145/161 [00:05<00:00, 30.91it/s][6/6] extract embeddings:  93%|█████████▎| 149/161 [00:05<00:00, 32.11it/s][6/6] extract embeddings:  95%|█████████▌| 153/161 [00:05<00:00, 33.07it/s][6/6] extract embeddings:  98%|█████████▊| 157/161 [00:06<00:00, 31.84it/s][6/6] extract embeddings: 100%|██████████| 161/161 [00:06<00:00, 31.79it/s][6/6] extract embeddings: 100%|██████████| 161/161 [00:06<00:00, 25.92it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.12it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.77it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.50it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.99it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.60it/s]
[NeMo I 2025-04-17 01:43:34 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:43:35 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              49.330161   444.120  ...  12.655072  2.849471
    Harker-ES                       44.187920  2178.782  ...  43.948429  2.017110
    Harker-MN                       51.781154   366.767  ...  26.162925  7.133391
    Longfellow-Block-1              38.459672   492.417  ...   6.955986  1.412621
    TOTAL                           44.833519  3482.086  ...  89.722412  2.576686
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:43:35 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0566 | MISS: 0.3660 | CER: 0.0258 | DER: 0.4483 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.73s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.92s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:43:47 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:43:47 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:43:47 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:43:47 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:43:47 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:43:47 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:43:47 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:43:47 features:305] PADDING: 16
[NeMo I 2025-04-17 01:43:47 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:43:47 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:43:47 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:43:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:43:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:48 collections:880] Dataset successfully loaded with 2071 items and total duration provided from manifest is  0.96 hours.
[NeMo I 2025-04-17 01:43:48 collections:886] # 2071 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:04,  2.00s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.45it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  3.96it/s][1/6] extract embeddings:  24%|██▍       | 8/33 [00:02<00:04,  5.62it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.44it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  9.31it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.86it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 13.63it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 14.76it/s][1/6] extract embeddings:  64%|██████▎   | 21/33 [00:03<00:00, 15.93it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 17.09it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 16.98it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 16.83it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 17.46it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 17.86it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.99it/s]
[NeMo I 2025-04-17 01:43:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:43:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:51 collections:880] Dataset successfully loaded with 2313 items and total duration provided from manifest is  1.01 hours.
[NeMo I 2025-04-17 01:43:51 collections:886] # 2313 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:50,  1.40s/it][2/6] extract embeddings:   8%|▊         | 3/37 [00:01<00:13,  2.48it/s][2/6] extract embeddings:  14%|█▎        | 5/37 [00:01<00:07,  4.46it/s][2/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  6.61it/s][2/6] extract embeddings:  24%|██▍       | 9/37 [00:01<00:03,  8.78it/s][2/6] extract embeddings:  30%|██▉       | 11/37 [00:01<00:02, 10.38it/s][2/6] extract embeddings:  35%|███▌      | 13/37 [00:02<00:01, 12.29it/s][2/6] extract embeddings:  41%|████      | 15/37 [00:02<00:01, 13.97it/s][2/6] extract embeddings:  46%|████▌     | 17/37 [00:02<00:01, 15.40it/s][2/6] extract embeddings:  54%|█████▍    | 20/37 [00:02<00:00, 17.49it/s][2/6] extract embeddings:  59%|█████▉    | 22/37 [00:02<00:00, 17.73it/s][2/6] extract embeddings:  68%|██████▊   | 25/37 [00:02<00:00, 18.69it/s][2/6] extract embeddings:  73%|███████▎  | 27/37 [00:02<00:00, 18.44it/s][2/6] extract embeddings:  78%|███████▊  | 29/37 [00:02<00:00, 17.85it/s][2/6] extract embeddings:  84%|████████▍ | 31/37 [00:03<00:00, 17.50it/s][2/6] extract embeddings:  89%|████████▉ | 33/37 [00:03<00:00, 17.13it/s][2/6] extract embeddings:  97%|█████████▋| 36/37 [00:03<00:00, 18.45it/s][2/6] extract embeddings: 100%|██████████| 37/37 [00:03<00:00, 11.13it/s]
[NeMo I 2025-04-17 01:43:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:43:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:55 collections:880] Dataset successfully loaded with 2703 items and total duration provided from manifest is  1.06 hours.
[NeMo I 2025-04-17 01:43:55 collections:886] # 2703 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:47,  1.14s/it][3/6] extract embeddings:   9%|▉         | 4/43 [00:01<00:09,  3.93it/s][3/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:05,  7.03it/s][3/6] extract embeddings:  23%|██▎       | 10/43 [00:01<00:03,  9.82it/s][3/6] extract embeddings:  30%|███       | 13/43 [00:01<00:02, 12.51it/s][3/6] extract embeddings:  35%|███▍      | 15/43 [00:01<00:02, 13.46it/s][3/6] extract embeddings:  42%|████▏     | 18/43 [00:01<00:01, 15.57it/s][3/6] extract embeddings:  49%|████▉     | 21/43 [00:02<00:01, 17.40it/s][3/6] extract embeddings:  56%|█████▌    | 24/43 [00:02<00:01, 18.93it/s][3/6] extract embeddings:  63%|██████▎   | 27/43 [00:02<00:00, 18.80it/s][3/6] extract embeddings:  70%|██████▉   | 30/43 [00:02<00:00, 19.26it/s][3/6] extract embeddings:  77%|███████▋  | 33/43 [00:02<00:00, 19.03it/s][3/6] extract embeddings:  84%|████████▎ | 36/43 [00:02<00:00, 19.44it/s][3/6] extract embeddings:  91%|█████████ | 39/43 [00:02<00:00, 19.66it/s][3/6] extract embeddings:  98%|█████████▊| 42/43 [00:03<00:00, 19.20it/s][3/6] extract embeddings: 100%|██████████| 43/43 [00:03<00:00, 13.42it/s]
[NeMo I 2025-04-17 01:43:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:43:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:43:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:43:58 collections:880] Dataset successfully loaded with 3430 items and total duration provided from manifest is  1.13 hours.
[NeMo I 2025-04-17 01:43:58 collections:886] # 3430 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/54 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/54 [00:01<01:01,  1.16s/it][4/6] extract embeddings:   7%|▋         | 4/54 [00:01<00:12,  3.87it/s][4/6] extract embeddings:  13%|█▎        | 7/54 [00:01<00:06,  6.93it/s][4/6] extract embeddings:  19%|█▊        | 10/54 [00:01<00:04, 10.11it/s][4/6] extract embeddings:  24%|██▍       | 13/54 [00:01<00:03, 12.70it/s][4/6] extract embeddings:  30%|██▉       | 16/54 [00:01<00:02, 14.97it/s][4/6] extract embeddings:  35%|███▌      | 19/54 [00:01<00:02, 16.75it/s][4/6] extract embeddings:  41%|████      | 22/54 [00:02<00:01, 18.25it/s][4/6] extract embeddings:  46%|████▋     | 25/54 [00:02<00:01, 19.47it/s][4/6] extract embeddings:  52%|█████▏    | 28/54 [00:02<00:01, 19.69it/s][4/6] extract embeddings:  57%|█████▋    | 31/54 [00:02<00:01, 20.06it/s][4/6] extract embeddings:  63%|██████▎   | 34/54 [00:02<00:00, 20.85it/s][4/6] extract embeddings:  69%|██████▊   | 37/54 [00:02<00:00, 21.22it/s][4/6] extract embeddings:  74%|███████▍  | 40/54 [00:02<00:00, 20.90it/s][4/6] extract embeddings:  80%|███████▉  | 43/54 [00:03<00:00, 20.58it/s][4/6] extract embeddings:  85%|████████▌ | 46/54 [00:03<00:00, 21.16it/s][4/6] extract embeddings:  91%|█████████ | 49/54 [00:03<00:00, 20.73it/s][4/6] extract embeddings:  96%|█████████▋| 52/54 [00:03<00:00, 21.62it/s][4/6] extract embeddings: 100%|██████████| 54/54 [00:03<00:00, 14.96it/s]
[NeMo I 2025-04-17 01:44:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:44:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:44:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:44:02 collections:880] Dataset successfully loaded with 5007 items and total duration provided from manifest is  1.22 hours.
[NeMo I 2025-04-17 01:44:02 collections:886] # 5007 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/79 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/79 [00:01<01:28,  1.13s/it][5/6] extract embeddings:   5%|▌         | 4/79 [00:01<00:18,  4.11it/s][5/6] extract embeddings:   9%|▉         | 7/79 [00:01<00:09,  7.26it/s][5/6] extract embeddings:  13%|█▎        | 10/79 [00:01<00:06, 10.62it/s][5/6] extract embeddings:  16%|█▋        | 13/79 [00:01<00:05, 13.10it/s][5/6] extract embeddings:  20%|██        | 16/79 [00:01<00:03, 16.31it/s][5/6] extract embeddings:  24%|██▍       | 19/79 [00:01<00:03, 18.14it/s][5/6] extract embeddings:  28%|██▊       | 22/79 [00:01<00:02, 20.48it/s][5/6] extract embeddings:  32%|███▏      | 25/79 [00:02<00:02, 22.32it/s][5/6] extract embeddings:  35%|███▌      | 28/79 [00:02<00:02, 22.23it/s][5/6] extract embeddings:  39%|███▉      | 31/79 [00:02<00:02, 23.66it/s][5/6] extract embeddings:  43%|████▎     | 34/79 [00:02<00:01, 24.83it/s][5/6] extract embeddings:  47%|████▋     | 37/79 [00:02<00:01, 24.62it/s][5/6] extract embeddings:  51%|█████     | 40/79 [00:02<00:01, 25.03it/s][5/6] extract embeddings:  56%|█████▌    | 44/79 [00:02<00:01, 25.95it/s][5/6] extract embeddings:  59%|█████▉    | 47/79 [00:02<00:01, 25.39it/s][5/6] extract embeddings:  63%|██████▎   | 50/79 [00:03<00:01, 25.33it/s][5/6] extract embeddings:  67%|██████▋   | 53/79 [00:03<00:00, 26.28it/s][5/6] extract embeddings:  71%|███████   | 56/79 [00:03<00:00, 24.47it/s][5/6] extract embeddings:  75%|███████▍  | 59/79 [00:03<00:00, 24.44it/s][5/6] extract embeddings:  78%|███████▊  | 62/79 [00:03<00:00, 25.12it/s][5/6] extract embeddings:  82%|████████▏ | 65/79 [00:03<00:00, 24.69it/s][5/6] extract embeddings:  86%|████████▌ | 68/79 [00:03<00:00, 24.02it/s][5/6] extract embeddings:  90%|████████▉ | 71/79 [00:03<00:00, 25.00it/s][5/6] extract embeddings:  94%|█████████▎| 74/79 [00:04<00:00, 24.79it/s][5/6] extract embeddings:  97%|█████████▋| 77/79 [00:04<00:00, 25.55it/s][5/6] extract embeddings: 100%|██████████| 79/79 [00:04<00:00, 18.65it/s]
[NeMo I 2025-04-17 01:44:06 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:44:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:44:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:44:07 collections:880] Dataset successfully loaded with 10095 items and total duration provided from manifest is  1.34 hours.
[NeMo I 2025-04-17 01:44:07 collections:886] # 10095 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/158 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/158 [00:01<03:41,  1.41s/it][6/6] extract embeddings:   3%|▎         | 5/158 [00:01<00:36,  4.23it/s][6/6] extract embeddings:   6%|▌         | 9/158 [00:01<00:18,  8.08it/s][6/6] extract embeddings:   8%|▊         | 13/158 [00:01<00:11, 12.14it/s][6/6] extract embeddings:  11%|█         | 17/158 [00:01<00:08, 15.92it/s][6/6] extract embeddings:  13%|█▎        | 21/158 [00:02<00:07, 19.02it/s][6/6] extract embeddings:  16%|█▌        | 25/158 [00:02<00:06, 22.04it/s][6/6] extract embeddings:  18%|█▊        | 29/158 [00:02<00:05, 24.80it/s][6/6] extract embeddings:  21%|██        | 33/158 [00:02<00:04, 26.53it/s][6/6] extract embeddings:  23%|██▎       | 37/158 [00:02<00:04, 27.18it/s][6/6] extract embeddings:  26%|██▌       | 41/158 [00:02<00:04, 27.75it/s][6/6] extract embeddings:  28%|██▊       | 45/158 [00:02<00:03, 29.10it/s][6/6] extract embeddings:  31%|███       | 49/158 [00:02<00:03, 30.07it/s][6/6] extract embeddings:  34%|███▎      | 53/158 [00:03<00:03, 30.26it/s][6/6] extract embeddings:  36%|███▌      | 57/158 [00:03<00:03, 29.95it/s][6/6] extract embeddings:  39%|███▊      | 61/158 [00:03<00:03, 30.94it/s][6/6] extract embeddings:  41%|████      | 65/158 [00:03<00:03, 30.69it/s][6/6] extract embeddings:  44%|████▎     | 69/158 [00:03<00:02, 31.04it/s][6/6] extract embeddings:  46%|████▌     | 73/158 [00:03<00:02, 31.27it/s][6/6] extract embeddings:  49%|████▊     | 77/158 [00:03<00:02, 31.32it/s][6/6] extract embeddings:  51%|█████▏    | 81/158 [00:03<00:02, 31.54it/s][6/6] extract embeddings:  54%|█████▍    | 85/158 [00:04<00:02, 31.49it/s][6/6] extract embeddings:  56%|█████▋    | 89/158 [00:04<00:02, 30.75it/s][6/6] extract embeddings:  59%|█████▉    | 93/158 [00:04<00:02, 31.20it/s][6/6] extract embeddings:  61%|██████▏   | 97/158 [00:04<00:01, 31.27it/s][6/6] extract embeddings:  64%|██████▍   | 101/158 [00:04<00:01, 30.46it/s][6/6] extract embeddings:  66%|██████▋   | 105/158 [00:04<00:01, 29.08it/s][6/6] extract embeddings:  69%|██████▉   | 109/158 [00:04<00:01, 29.49it/s][6/6] extract embeddings:  72%|███████▏  | 113/158 [00:05<00:01, 30.24it/s][6/6] extract embeddings:  74%|███████▍  | 117/158 [00:05<00:01, 30.04it/s][6/6] extract embeddings:  77%|███████▋  | 121/158 [00:05<00:01, 31.05it/s][6/6] extract embeddings:  79%|███████▉  | 125/158 [00:05<00:01, 31.62it/s][6/6] extract embeddings:  82%|████████▏ | 129/158 [00:05<00:00, 31.05it/s][6/6] extract embeddings:  84%|████████▍ | 133/158 [00:05<00:00, 31.35it/s][6/6] extract embeddings:  87%|████████▋ | 137/158 [00:05<00:00, 31.94it/s][6/6] extract embeddings:  89%|████████▉ | 141/158 [00:05<00:00, 31.89it/s][6/6] extract embeddings:  92%|█████████▏| 145/158 [00:06<00:00, 30.84it/s][6/6] extract embeddings:  94%|█████████▍| 149/158 [00:06<00:00, 31.10it/s][6/6] extract embeddings:  97%|█████████▋| 153/158 [00:06<00:00, 31.05it/s][6/6] extract embeddings:  99%|█████████▉| 157/158 [00:06<00:00, 31.20it/s][6/6] extract embeddings: 100%|██████████| 158/158 [00:06<00:00, 24.36it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.15it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.83it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.56it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.62it/s]
[NeMo I 2025-04-17 01:44:15 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:44:16 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              50.244366   444.120  ...  12.975073  2.921524
    Harker-ES                       45.295462  2178.782  ...  44.306502  2.033545
    Harker-MN                       52.457878   366.767  ...  26.495964  7.224195
    Longfellow-Block-1              39.548972   492.417  ...   8.789942  1.785061
    TOTAL                           45.868445  3482.086  ...  92.567482  2.658392
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:44:16 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0551 | MISS: 0.3770 | CER: 0.0266 | DER: 0.4587 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.75s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:44:28 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:44:28 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:44:28 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:44:28 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:44:28 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:44:28 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:44:28 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:44:28 features:305] PADDING: 16
[NeMo I 2025-04-17 01:44:28 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:44:28 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:44:28 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:44:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:44:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:44:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:44:29 collections:880] Dataset successfully loaded with 2057 items and total duration provided from manifest is  0.92 hours.
[NeMo I 2025-04-17 01:44:29 collections:886] # 2057 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:07,  2.12s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:12,  2.32it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:07,  3.76it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.12it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  7.73it/s][1/6] extract embeddings:  39%|███▉      | 13/33 [00:02<00:02,  9.46it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.11it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:03<00:01, 13.91it/s][1/6] extract embeddings:  64%|██████▎   | 21/33 [00:03<00:00, 14.57it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 16.02it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 16.71it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 16.35it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 16.68it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 16.96it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.67it/s]
[NeMo I 2025-04-17 01:44:32 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:44:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:44:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:44:32 collections:880] Dataset successfully loaded with 2295 items and total duration provided from manifest is  0.97 hours.
[NeMo I 2025-04-17 01:44:32 collections:886] # 2295 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:48,  1.40s/it][2/6] extract embeddings:  11%|█         | 4/36 [00:01<00:09,  3.30it/s][2/6] extract embeddings:  17%|█▋        | 6/36 [00:01<00:05,  5.14it/s][2/6] extract embeddings:  25%|██▌       | 9/36 [00:01<00:03,  8.08it/s][2/6] extract embeddings:  33%|███▎      | 12/36 [00:01<00:02, 10.34it/s][2/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:01, 11.86it/s][2/6] extract embeddings:  47%|████▋     | 17/36 [00:02<00:01, 14.27it/s][2/6] extract embeddings:  56%|█████▌    | 20/36 [00:02<00:00, 16.40it/s][2/6] extract embeddings:  64%|██████▍   | 23/36 [00:02<00:00, 16.92it/s][2/6] extract embeddings:  69%|██████▉   | 25/36 [00:02<00:00, 16.89it/s][2/6] extract embeddings:  75%|███████▌  | 27/36 [00:02<00:00, 17.10it/s][2/6] extract embeddings:  83%|████████▎ | 30/36 [00:02<00:00, 17.46it/s][2/6] extract embeddings:  89%|████████▉ | 32/36 [00:03<00:00, 17.56it/s][2/6] extract embeddings:  97%|█████████▋| 35/36 [00:03<00:00, 18.30it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 11.13it/s]
[NeMo I 2025-04-17 01:44:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:44:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:44:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:44:36 collections:880] Dataset successfully loaded with 2665 items and total duration provided from manifest is  1.03 hours.
[NeMo I 2025-04-17 01:44:36 collections:886] # 2665 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:47,  1.15s/it][3/6] extract embeddings:   7%|▋         | 3/42 [00:01<00:13,  2.98it/s][3/6] extract embeddings:  12%|█▏        | 5/42 [00:01<00:07,  5.25it/s][3/6] extract embeddings:  19%|█▉        | 8/42 [00:01<00:03,  8.79it/s][3/6] extract embeddings:  24%|██▍       | 10/42 [00:01<00:02, 10.80it/s][3/6] extract embeddings:  31%|███       | 13/42 [00:01<00:02, 13.42it/s][3/6] extract embeddings:  38%|███▊      | 16/42 [00:01<00:01, 15.62it/s][3/6] extract embeddings:  45%|████▌     | 19/42 [00:01<00:01, 17.92it/s][3/6] extract embeddings:  52%|█████▏    | 22/42 [00:02<00:01, 19.10it/s][3/6] extract embeddings:  60%|█████▉    | 25/42 [00:02<00:00, 18.77it/s][3/6] extract embeddings:  67%|██████▋   | 28/42 [00:02<00:00, 20.11it/s][3/6] extract embeddings:  74%|███████▍  | 31/42 [00:02<00:00, 20.74it/s][3/6] extract embeddings:  81%|████████  | 34/42 [00:02<00:00, 20.59it/s][3/6] extract embeddings:  88%|████████▊ | 37/42 [00:02<00:00, 19.66it/s][3/6] extract embeddings:  95%|█████████▌| 40/42 [00:03<00:00, 20.01it/s][3/6] extract embeddings: 100%|██████████| 42/42 [00:03<00:00, 13.42it/s]
[NeMo I 2025-04-17 01:44:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:44:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:44:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:44:39 collections:880] Dataset successfully loaded with 3361 items and total duration provided from manifest is  1.10 hours.
[NeMo I 2025-04-17 01:44:39 collections:886] # 3361 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/53 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/53 [00:01<00:59,  1.14s/it][4/6] extract embeddings:   8%|▊         | 4/53 [00:01<00:12,  4.02it/s][4/6] extract embeddings:  13%|█▎        | 7/53 [00:01<00:06,  7.23it/s][4/6] extract embeddings:  19%|█▉        | 10/53 [00:01<00:04, 10.39it/s][4/6] extract embeddings:  25%|██▍       | 13/53 [00:01<00:03, 12.81it/s][4/6] extract embeddings:  30%|███       | 16/53 [00:01<00:02, 15.34it/s][4/6] extract embeddings:  36%|███▌      | 19/53 [00:01<00:01, 17.24it/s][4/6] extract embeddings:  42%|████▏     | 22/53 [00:02<00:01, 19.60it/s][4/6] extract embeddings:  47%|████▋     | 25/53 [00:02<00:01, 20.92it/s][4/6] extract embeddings:  53%|█████▎    | 28/53 [00:02<00:01, 21.18it/s][4/6] extract embeddings:  58%|█████▊    | 31/53 [00:02<00:00, 22.08it/s][4/6] extract embeddings:  64%|██████▍   | 34/53 [00:02<00:00, 22.21it/s][4/6] extract embeddings:  70%|██████▉   | 37/53 [00:02<00:00, 22.94it/s][4/6] extract embeddings:  75%|███████▌  | 40/53 [00:02<00:00, 22.04it/s][4/6] extract embeddings:  81%|████████  | 43/53 [00:02<00:00, 22.61it/s][4/6] extract embeddings:  87%|████████▋ | 46/53 [00:03<00:00, 23.20it/s][4/6] extract embeddings:  92%|█████████▏| 49/53 [00:03<00:00, 22.80it/s][4/6] extract embeddings:  98%|█████████▊| 52/53 [00:03<00:00, 23.30it/s][4/6] extract embeddings: 100%|██████████| 53/53 [00:03<00:00, 15.65it/s]
[NeMo I 2025-04-17 01:44:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:44:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:44:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:44:43 collections:880] Dataset successfully loaded with 4899 items and total duration provided from manifest is  1.19 hours.
[NeMo I 2025-04-17 01:44:43 collections:886] # 4899 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/77 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/77 [00:01<01:26,  1.14s/it][5/6] extract embeddings:   5%|▌         | 4/77 [00:01<00:18,  4.00it/s][5/6] extract embeddings:   9%|▉         | 7/77 [00:01<00:09,  7.37it/s][5/6] extract embeddings:  13%|█▎        | 10/77 [00:01<00:06, 10.57it/s][5/6] extract embeddings:  18%|█▊        | 14/77 [00:01<00:04, 14.68it/s][5/6] extract embeddings:  22%|██▏       | 17/77 [00:01<00:03, 17.42it/s][5/6] extract embeddings:  26%|██▌       | 20/77 [00:01<00:02, 19.37it/s][5/6] extract embeddings:  30%|██▉       | 23/77 [00:01<00:02, 20.82it/s][5/6] extract embeddings:  34%|███▍      | 26/77 [00:02<00:02, 22.67it/s][5/6] extract embeddings:  38%|███▊      | 29/77 [00:02<00:02, 23.58it/s][5/6] extract embeddings:  42%|████▏     | 32/77 [00:02<00:01, 24.45it/s][5/6] extract embeddings:  45%|████▌     | 35/77 [00:02<00:01, 25.68it/s][5/6] extract embeddings:  49%|████▉     | 38/77 [00:02<00:01, 26.17it/s][5/6] extract embeddings:  53%|█████▎    | 41/77 [00:02<00:01, 26.70it/s][5/6] extract embeddings:  57%|█████▋    | 44/77 [00:02<00:01, 27.01it/s][5/6] extract embeddings:  61%|██████    | 47/77 [00:02<00:01, 26.66it/s][5/6] extract embeddings:  65%|██████▍   | 50/77 [00:03<00:01, 25.26it/s][5/6] extract embeddings:  69%|██████▉   | 53/77 [00:03<00:00, 25.81it/s][5/6] extract embeddings:  73%|███████▎  | 56/77 [00:03<00:00, 26.65it/s][5/6] extract embeddings:  77%|███████▋  | 59/77 [00:03<00:00, 25.98it/s][5/6] extract embeddings:  81%|████████  | 62/77 [00:03<00:00, 26.02it/s][5/6] extract embeddings:  84%|████████▍ | 65/77 [00:03<00:00, 26.12it/s][5/6] extract embeddings:  88%|████████▊ | 68/77 [00:03<00:00, 26.71it/s][5/6] extract embeddings:  92%|█████████▏| 71/77 [00:03<00:00, 26.89it/s][5/6] extract embeddings:  96%|█████████▌| 74/77 [00:03<00:00, 26.81it/s][5/6] extract embeddings: 100%|██████████| 77/77 [00:04<00:00, 19.21it/s]
[NeMo I 2025-04-17 01:44:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:44:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:44:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:44:47 collections:880] Dataset successfully loaded with 9861 items and total duration provided from manifest is  1.30 hours.
[NeMo I 2025-04-17 01:44:47 collections:886] # 9861 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/155 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/155 [00:01<02:56,  1.15s/it][6/6] extract embeddings:   3%|▎         | 5/155 [00:01<00:29,  5.12it/s][6/6] extract embeddings:   6%|▌         | 9/155 [00:01<00:15,  9.61it/s][6/6] extract embeddings:   8%|▊         | 13/155 [00:01<00:10, 13.99it/s][6/6] extract embeddings:  11%|█         | 17/155 [00:01<00:07, 18.15it/s][6/6] extract embeddings:  14%|█▎        | 21/155 [00:01<00:06, 21.70it/s][6/6] extract embeddings:  16%|█▌        | 25/155 [00:01<00:05, 24.10it/s][6/6] extract embeddings:  19%|█▊        | 29/155 [00:01<00:04, 26.58it/s][6/6] extract embeddings:  21%|██▏       | 33/155 [00:02<00:04, 27.98it/s][6/6] extract embeddings:  24%|██▍       | 37/155 [00:02<00:03, 29.65it/s][6/6] extract embeddings:  26%|██▋       | 41/155 [00:02<00:03, 29.58it/s][6/6] extract embeddings:  29%|██▉       | 45/155 [00:02<00:03, 30.81it/s][6/6] extract embeddings:  32%|███▏      | 49/155 [00:02<00:03, 31.09it/s][6/6] extract embeddings:  34%|███▍      | 53/155 [00:02<00:03, 31.01it/s][6/6] extract embeddings:  37%|███▋      | 57/155 [00:02<00:03, 31.28it/s][6/6] extract embeddings:  39%|███▉      | 61/155 [00:02<00:02, 31.97it/s][6/6] extract embeddings:  42%|████▏     | 65/155 [00:03<00:02, 31.92it/s][6/6] extract embeddings:  45%|████▍     | 69/155 [00:03<00:02, 32.19it/s][6/6] extract embeddings:  47%|████▋     | 73/155 [00:03<00:02, 32.10it/s][6/6] extract embeddings:  50%|████▉     | 77/155 [00:03<00:02, 31.65it/s][6/6] extract embeddings:  52%|█████▏    | 81/155 [00:03<00:02, 32.41it/s][6/6] extract embeddings:  55%|█████▍    | 85/155 [00:03<00:02, 32.04it/s][6/6] extract embeddings:  57%|█████▋    | 89/155 [00:03<00:02, 31.69it/s][6/6] extract embeddings:  60%|██████    | 93/155 [00:03<00:01, 32.29it/s][6/6] extract embeddings:  63%|██████▎   | 97/155 [00:04<00:01, 32.13it/s][6/6] extract embeddings:  65%|██████▌   | 101/155 [00:04<00:01, 32.64it/s][6/6] extract embeddings:  68%|██████▊   | 105/155 [00:04<00:01, 32.15it/s][6/6] extract embeddings:  70%|███████   | 109/155 [00:04<00:01, 30.75it/s][6/6] extract embeddings:  73%|███████▎  | 113/155 [00:04<00:01, 31.49it/s][6/6] extract embeddings:  75%|███████▌  | 117/155 [00:04<00:01, 32.02it/s][6/6] extract embeddings:  78%|███████▊  | 121/155 [00:04<00:01, 32.03it/s][6/6] extract embeddings:  81%|████████  | 125/155 [00:04<00:00, 32.71it/s][6/6] extract embeddings:  83%|████████▎ | 129/155 [00:05<00:00, 31.89it/s][6/6] extract embeddings:  86%|████████▌ | 133/155 [00:05<00:00, 32.58it/s][6/6] extract embeddings:  88%|████████▊ | 137/155 [00:05<00:00, 31.02it/s][6/6] extract embeddings:  91%|█████████ | 141/155 [00:05<00:00, 31.11it/s][6/6] extract embeddings:  94%|█████████▎| 145/155 [00:05<00:00, 31.37it/s][6/6] extract embeddings:  96%|█████████▌| 149/155 [00:05<00:00, 31.48it/s][6/6] extract embeddings:  99%|█████████▊| 153/155 [00:05<00:00, 32.36it/s][6/6] extract embeddings: 100%|██████████| 155/155 [00:05<00:00, 26.09it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.05it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.82it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.56it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.65it/s]
[NeMo I 2025-04-17 01:44:55 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:44:56 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              52.060297   444.120  ...  14.920086  3.359472
    Harker-ES                       46.350110  2178.782  ...  40.907931  1.877560
    Harker-MN                       52.989553   366.767  ...  26.634948  7.262090
    Longfellow-Block-1              40.269095   492.417  ...   8.095979  1.644131
    TOTAL                           46.917799  3482.086  ...  90.558944  2.600710
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:44:56 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0532 | MISS: 0.3900 | CER: 0.0260 | DER: 0.4692 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.75s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:45:08 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:45:08 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:45:08 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:45:08 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:45:08 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:45:08 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:45:08 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:45:08 features:305] PADDING: 16
[NeMo I 2025-04-17 01:45:09 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:45:09 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:45:09 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:45:09 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:45:09 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:09 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:09 collections:880] Dataset successfully loaded with 2069 items and total duration provided from manifest is  0.89 hours.
[NeMo I 2025-04-17 01:45:09 collections:886] # 2069 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:12,  2.26s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:13,  2.18it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:06,  4.16it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  6.32it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  7.70it/s][1/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 10.37it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:03<00:01, 11.82it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:03<00:01, 13.14it/s][1/6] extract embeddings:  64%|██████▎   | 21/33 [00:03<00:00, 14.07it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:03<00:00, 15.04it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 16.01it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 16.54it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 16.91it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 18.46it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.47it/s]
[NeMo I 2025-04-17 01:45:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:45:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:13 collections:880] Dataset successfully loaded with 2289 items and total duration provided from manifest is  0.94 hours.
[NeMo I 2025-04-17 01:45:13 collections:886] # 2289 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:49,  1.41s/it][2/6] extract embeddings:  11%|█         | 4/36 [00:01<00:09,  3.21it/s][2/6] extract embeddings:  17%|█▋        | 6/36 [00:01<00:05,  5.02it/s][2/6] extract embeddings:  25%|██▌       | 9/36 [00:01<00:03,  7.95it/s][2/6] extract embeddings:  31%|███       | 11/36 [00:01<00:02,  9.78it/s][2/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:01, 12.25it/s][2/6] extract embeddings:  47%|████▋     | 17/36 [00:02<00:01, 14.43it/s][2/6] extract embeddings:  56%|█████▌    | 20/36 [00:02<00:00, 16.48it/s][2/6] extract embeddings:  64%|██████▍   | 23/36 [00:02<00:00, 17.48it/s][2/6] extract embeddings:  72%|███████▏  | 26/36 [00:02<00:00, 18.31it/s][2/6] extract embeddings:  81%|████████  | 29/36 [00:02<00:00, 17.86it/s][2/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 17.62it/s][2/6] extract embeddings:  94%|█████████▍| 34/36 [00:03<00:00, 18.67it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 11.21it/s]
[NeMo I 2025-04-17 01:45:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:45:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:16 collections:880] Dataset successfully loaded with 2633 items and total duration provided from manifest is  0.99 hours.
[NeMo I 2025-04-17 01:45:16 collections:886] # 2633 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:47,  1.16s/it][3/6] extract embeddings:  10%|▉         | 4/42 [00:01<00:09,  3.87it/s][3/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:05,  6.89it/s][3/6] extract embeddings:  24%|██▍       | 10/42 [00:01<00:03,  9.85it/s][3/6] extract embeddings:  29%|██▊       | 12/42 [00:01<00:02, 11.44it/s][3/6] extract embeddings:  36%|███▌      | 15/42 [00:01<00:01, 13.52it/s][3/6] extract embeddings:  40%|████      | 17/42 [00:01<00:01, 14.69it/s][3/6] extract embeddings:  48%|████▊     | 20/42 [00:02<00:01, 16.73it/s][3/6] extract embeddings:  55%|█████▍    | 23/42 [00:02<00:01, 18.18it/s][3/6] extract embeddings:  62%|██████▏   | 26/42 [00:02<00:00, 18.58it/s][3/6] extract embeddings:  69%|██████▉   | 29/42 [00:02<00:00, 19.44it/s][3/6] extract embeddings:  76%|███████▌  | 32/42 [00:02<00:00, 19.74it/s][3/6] extract embeddings:  83%|████████▎ | 35/42 [00:02<00:00, 19.85it/s][3/6] extract embeddings:  90%|█████████ | 38/42 [00:02<00:00, 20.17it/s][3/6] extract embeddings:  98%|█████████▊| 41/42 [00:03<00:00, 20.66it/s][3/6] extract embeddings: 100%|██████████| 42/42 [00:03<00:00, 13.34it/s]
[NeMo I 2025-04-17 01:45:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:45:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:20 collections:880] Dataset successfully loaded with 3306 items and total duration provided from manifest is  1.06 hours.
[NeMo I 2025-04-17 01:45:20 collections:886] # 3306 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/52 [00:01<01:00,  1.19s/it][4/6] extract embeddings:   8%|▊         | 4/52 [00:01<00:12,  3.86it/s][4/6] extract embeddings:  13%|█▎        | 7/52 [00:01<00:06,  6.97it/s][4/6] extract embeddings:  19%|█▉        | 10/52 [00:01<00:04,  9.95it/s][4/6] extract embeddings:  25%|██▌       | 13/52 [00:01<00:03, 12.80it/s][4/6] extract embeddings:  31%|███       | 16/52 [00:01<00:02, 14.90it/s][4/6] extract embeddings:  37%|███▋      | 19/52 [00:01<00:01, 16.99it/s][4/6] extract embeddings:  42%|████▏     | 22/52 [00:02<00:01, 18.75it/s][4/6] extract embeddings:  48%|████▊     | 25/52 [00:02<00:01, 19.96it/s][4/6] extract embeddings:  54%|█████▍    | 28/52 [00:02<00:01, 21.30it/s][4/6] extract embeddings:  60%|█████▉    | 31/52 [00:02<00:00, 21.42it/s][4/6] extract embeddings:  65%|██████▌   | 34/52 [00:02<00:00, 22.07it/s][4/6] extract embeddings:  71%|███████   | 37/52 [00:02<00:00, 22.84it/s][4/6] extract embeddings:  77%|███████▋  | 40/52 [00:02<00:00, 22.90it/s][4/6] extract embeddings:  83%|████████▎ | 43/52 [00:02<00:00, 23.20it/s][4/6] extract embeddings:  88%|████████▊ | 46/52 [00:03<00:00, 22.48it/s][4/6] extract embeddings:  94%|█████████▍| 49/52 [00:03<00:00, 22.16it/s][4/6] extract embeddings: 100%|██████████| 52/52 [00:03<00:00, 22.74it/s][4/6] extract embeddings: 100%|██████████| 52/52 [00:03<00:00, 15.18it/s]
[NeMo I 2025-04-17 01:45:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:45:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:23 collections:880] Dataset successfully loaded with 4780 items and total duration provided from manifest is  1.15 hours.
[NeMo I 2025-04-17 01:45:23 collections:886] # 4780 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/75 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/75 [00:01<01:27,  1.19s/it][5/6] extract embeddings:   5%|▌         | 4/75 [00:01<00:17,  3.97it/s][5/6] extract embeddings:   9%|▉         | 7/75 [00:01<00:09,  7.25it/s][5/6] extract embeddings:  13%|█▎        | 10/75 [00:01<00:06, 10.68it/s][5/6] extract embeddings:  17%|█▋        | 13/75 [00:01<00:04, 13.94it/s][5/6] extract embeddings:  21%|██▏       | 16/75 [00:01<00:03, 16.97it/s][5/6] extract embeddings:  25%|██▌       | 19/75 [00:01<00:02, 19.18it/s][5/6] extract embeddings:  29%|██▉       | 22/75 [00:01<00:02, 20.59it/s][5/6] extract embeddings:  33%|███▎      | 25/75 [00:02<00:02, 22.42it/s][5/6] extract embeddings:  37%|███▋      | 28/75 [00:02<00:01, 23.69it/s][5/6] extract embeddings:  41%|████▏     | 31/75 [00:02<00:01, 23.74it/s][5/6] extract embeddings:  45%|████▌     | 34/75 [00:02<00:01, 24.11it/s][5/6] extract embeddings:  49%|████▉     | 37/75 [00:02<00:01, 25.12it/s][5/6] extract embeddings:  53%|█████▎    | 40/75 [00:02<00:01, 25.89it/s][5/6] extract embeddings:  57%|█████▋    | 43/75 [00:02<00:01, 26.73it/s][5/6] extract embeddings:  61%|██████▏   | 46/75 [00:02<00:01, 26.42it/s][5/6] extract embeddings:  65%|██████▌   | 49/75 [00:02<00:00, 26.25it/s][5/6] extract embeddings:  69%|██████▉   | 52/75 [00:03<00:00, 25.99it/s][5/6] extract embeddings:  73%|███████▎  | 55/75 [00:03<00:00, 25.89it/s][5/6] extract embeddings:  77%|███████▋  | 58/75 [00:03<00:00, 25.79it/s][5/6] extract embeddings:  81%|████████▏ | 61/75 [00:03<00:00, 26.10it/s][5/6] extract embeddings:  85%|████████▌ | 64/75 [00:03<00:00, 26.31it/s][5/6] extract embeddings:  89%|████████▉ | 67/75 [00:03<00:00, 25.18it/s][5/6] extract embeddings:  93%|█████████▎| 70/75 [00:03<00:00, 25.03it/s][5/6] extract embeddings:  97%|█████████▋| 73/75 [00:03<00:00, 26.10it/s][5/6] extract embeddings: 100%|██████████| 75/75 [00:04<00:00, 18.69it/s]
[NeMo I 2025-04-17 01:45:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:45:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:27 collections:880] Dataset successfully loaded with 9586 items and total duration provided from manifest is  1.26 hours.
[NeMo I 2025-04-17 01:45:27 collections:886] # 9586 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/150 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/150 [00:01<03:01,  1.22s/it][6/6] extract embeddings:   3%|▎         | 5/150 [00:01<00:29,  4.85it/s][6/6] extract embeddings:   6%|▌         | 9/150 [00:01<00:15,  9.00it/s][6/6] extract embeddings:   9%|▊         | 13/150 [00:01<00:10, 13.30it/s][6/6] extract embeddings:  11%|█▏        | 17/150 [00:01<00:07, 17.24it/s][6/6] extract embeddings:  14%|█▍        | 21/150 [00:01<00:06, 20.96it/s][6/6] extract embeddings:  17%|█▋        | 25/150 [00:01<00:05, 23.96it/s][6/6] extract embeddings:  19%|█▉        | 29/150 [00:02<00:04, 25.92it/s][6/6] extract embeddings:  22%|██▏       | 33/150 [00:02<00:04, 28.36it/s][6/6] extract embeddings:  25%|██▍       | 37/150 [00:02<00:03, 29.10it/s][6/6] extract embeddings:  27%|██▋       | 41/150 [00:02<00:03, 29.81it/s][6/6] extract embeddings:  30%|███       | 45/150 [00:02<00:03, 30.86it/s][6/6] extract embeddings:  33%|███▎      | 49/150 [00:02<00:03, 31.44it/s][6/6] extract embeddings:  35%|███▌      | 53/150 [00:02<00:02, 32.57it/s][6/6] extract embeddings:  38%|███▊      | 57/150 [00:02<00:02, 31.97it/s][6/6] extract embeddings:  41%|████      | 61/150 [00:03<00:02, 32.13it/s][6/6] extract embeddings:  43%|████▎     | 65/150 [00:03<00:02, 32.48it/s][6/6] extract embeddings:  46%|████▌     | 69/150 [00:03<00:02, 31.64it/s][6/6] extract embeddings:  49%|████▊     | 73/150 [00:03<00:02, 31.87it/s][6/6] extract embeddings:  51%|█████▏    | 77/150 [00:03<00:02, 30.67it/s][6/6] extract embeddings:  54%|█████▍    | 81/150 [00:03<00:02, 31.97it/s][6/6] extract embeddings:  57%|█████▋    | 85/150 [00:03<00:02, 31.96it/s][6/6] extract embeddings:  59%|█████▉    | 89/150 [00:03<00:01, 31.96it/s][6/6] extract embeddings:  62%|██████▏   | 93/150 [00:04<00:01, 31.84it/s][6/6] extract embeddings:  65%|██████▍   | 97/150 [00:04<00:01, 33.17it/s][6/6] extract embeddings:  67%|██████▋   | 101/150 [00:04<00:01, 32.00it/s][6/6] extract embeddings:  70%|███████   | 105/150 [00:04<00:01, 32.72it/s][6/6] extract embeddings:  73%|███████▎  | 109/150 [00:04<00:01, 32.04it/s][6/6] extract embeddings:  75%|███████▌  | 113/150 [00:04<00:01, 31.02it/s][6/6] extract embeddings:  78%|███████▊  | 117/150 [00:04<00:01, 31.96it/s][6/6] extract embeddings:  81%|████████  | 121/150 [00:04<00:00, 32.53it/s][6/6] extract embeddings:  83%|████████▎ | 125/150 [00:05<00:00, 32.58it/s][6/6] extract embeddings:  86%|████████▌ | 129/150 [00:05<00:00, 33.05it/s][6/6] extract embeddings:  89%|████████▊ | 133/150 [00:05<00:00, 31.87it/s][6/6] extract embeddings:  91%|█████████▏| 137/150 [00:05<00:00, 31.38it/s][6/6] extract embeddings:  94%|█████████▍| 141/150 [00:05<00:00, 31.64it/s][6/6] extract embeddings:  97%|█████████▋| 145/150 [00:05<00:00, 32.78it/s][6/6] extract embeddings:  99%|█████████▉| 149/150 [00:05<00:00, 31.71it/s][6/6] extract embeddings: 100%|██████████| 150/150 [00:05<00:00, 25.61it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.18it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.91it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.49it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.66it/s]
[NeMo I 2025-04-17 01:45:35 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:45:36 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              52.875376   444.120  ...  14.040006  3.161309
    Harker-ES                       47.637224  2178.782  ...  41.183398  1.890203
    Harker-MN                       52.605353   366.767  ...  25.692971  7.005257
    Longfellow-Block-1              41.667899   492.417  ...   7.318966  1.486335
    TOTAL                           47.984463  3482.086  ...  88.235341  2.533979
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:45:36 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0508 | MISS: 0.4037 | CER: 0.0253 | DER: 0.4798 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:45:48 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:45:48 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:45:48 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:45:48 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:45:48 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:45:48 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:45:48 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:45:48 features:305] PADDING: 16
[NeMo I 2025-04-17 01:45:49 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:45:49 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:45:49 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:45:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:45:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:49 collections:880] Dataset successfully loaded with 2066 items and total duration provided from manifest is  0.85 hours.
[NeMo I 2025-04-17 01:45:49 collections:886] # 2066 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:02,  1.95s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.51it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:06,  4.03it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.58it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  7.98it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.53it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 12.85it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 14.75it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:03<00:00, 16.37it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 17.29it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 17.03it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 17.68it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 18.12it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  9.27it/s]
[NeMo I 2025-04-17 01:45:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:45:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:52 collections:880] Dataset successfully loaded with 2271 items and total duration provided from manifest is  0.89 hours.
[NeMo I 2025-04-17 01:45:52 collections:886] # 2271 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:48,  1.39s/it][2/6] extract embeddings:  11%|█         | 4/36 [00:01<00:09,  3.24it/s][2/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  5.95it/s][2/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:03,  8.56it/s][2/6] extract embeddings:  36%|███▌      | 13/36 [00:01<00:02, 10.96it/s][2/6] extract embeddings:  44%|████▍     | 16/36 [00:02<00:01, 13.52it/s][2/6] extract embeddings:  53%|█████▎    | 19/36 [00:02<00:01, 15.52it/s][2/6] extract embeddings:  61%|██████    | 22/36 [00:02<00:00, 16.42it/s][2/6] extract embeddings:  69%|██████▉   | 25/36 [00:02<00:00, 17.56it/s][2/6] extract embeddings:  78%|███████▊  | 28/36 [00:02<00:00, 18.16it/s][2/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 18.56it/s][2/6] extract embeddings:  92%|█████████▏| 33/36 [00:02<00:00, 18.87it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 20.54it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 11.52it/s]
[NeMo I 2025-04-17 01:45:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:45:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:56 collections:880] Dataset successfully loaded with 2590 items and total duration provided from manifest is  0.94 hours.
[NeMo I 2025-04-17 01:45:56 collections:886] # 2590 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:45,  1.15s/it][3/6] extract embeddings:  10%|▉         | 4/41 [00:01<00:09,  3.95it/s][3/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:04,  6.93it/s][3/6] extract embeddings:  24%|██▍       | 10/41 [00:01<00:03,  9.86it/s][3/6] extract embeddings:  29%|██▉       | 12/41 [00:01<00:02, 11.50it/s][3/6] extract embeddings:  37%|███▋      | 15/41 [00:01<00:01, 13.93it/s][3/6] extract embeddings:  44%|████▍     | 18/41 [00:01<00:01, 16.06it/s][3/6] extract embeddings:  51%|█████     | 21/41 [00:02<00:01, 17.77it/s][3/6] extract embeddings:  59%|█████▊    | 24/41 [00:02<00:00, 19.35it/s][3/6] extract embeddings:  66%|██████▌   | 27/41 [00:02<00:00, 19.28it/s][3/6] extract embeddings:  73%|███████▎  | 30/41 [00:02<00:00, 19.34it/s][3/6] extract embeddings:  80%|████████  | 33/41 [00:02<00:00, 19.40it/s][3/6] extract embeddings:  88%|████████▊ | 36/41 [00:02<00:00, 19.50it/s][3/6] extract embeddings:  95%|█████████▌| 39/41 [00:02<00:00, 20.28it/s][3/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 13.41it/s]
[NeMo I 2025-04-17 01:45:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:45:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:45:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:45:59 collections:880] Dataset successfully loaded with 3229 items and total duration provided from manifest is  1.01 hours.
[NeMo I 2025-04-17 01:45:59 collections:886] # 3229 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/51 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/51 [00:01<00:57,  1.15s/it][4/6] extract embeddings:   8%|▊         | 4/51 [00:01<00:11,  3.95it/s][4/6] extract embeddings:  14%|█▎        | 7/51 [00:01<00:06,  7.02it/s][4/6] extract embeddings:  20%|█▉        | 10/51 [00:01<00:04, 10.16it/s][4/6] extract embeddings:  25%|██▌       | 13/51 [00:01<00:02, 12.99it/s][4/6] extract embeddings:  31%|███▏      | 16/51 [00:01<00:02, 15.56it/s][4/6] extract embeddings:  37%|███▋      | 19/51 [00:01<00:01, 17.17it/s][4/6] extract embeddings:  43%|████▎     | 22/51 [00:02<00:01, 18.77it/s][4/6] extract embeddings:  49%|████▉     | 25/51 [00:02<00:01, 19.45it/s][4/6] extract embeddings:  55%|█████▍    | 28/51 [00:02<00:01, 20.15it/s][4/6] extract embeddings:  61%|██████    | 31/51 [00:02<00:00, 20.71it/s][4/6] extract embeddings:  67%|██████▋   | 34/51 [00:02<00:00, 20.65it/s][4/6] extract embeddings:  73%|███████▎  | 37/51 [00:02<00:00, 19.35it/s][4/6] extract embeddings:  78%|███████▊  | 40/51 [00:02<00:00, 20.51it/s][4/6] extract embeddings:  84%|████████▍ | 43/51 [00:03<00:00, 21.29it/s][4/6] extract embeddings:  90%|█████████ | 46/51 [00:03<00:00, 22.01it/s][4/6] extract embeddings:  96%|█████████▌| 49/51 [00:03<00:00, 22.83it/s][4/6] extract embeddings: 100%|██████████| 51/51 [00:03<00:00, 14.64it/s]
[NeMo I 2025-04-17 01:46:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:46:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:46:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:46:03 collections:880] Dataset successfully loaded with 4635 items and total duration provided from manifest is  1.10 hours.
[NeMo I 2025-04-17 01:46:03 collections:886] # 4635 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/73 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/73 [00:01<01:21,  1.14s/it][5/6] extract embeddings:   5%|▌         | 4/73 [00:01<00:16,  4.08it/s][5/6] extract embeddings:  10%|▉         | 7/73 [00:01<00:08,  7.53it/s][5/6] extract embeddings:  14%|█▎        | 10/73 [00:01<00:05, 11.09it/s][5/6] extract embeddings:  18%|█▊        | 13/73 [00:01<00:04, 13.16it/s][5/6] extract embeddings:  22%|██▏       | 16/73 [00:01<00:03, 14.28it/s][5/6] extract embeddings:  26%|██▌       | 19/73 [00:01<00:03, 14.82it/s][5/6] extract embeddings:  29%|██▉       | 21/73 [00:02<00:03, 15.22it/s][5/6] extract embeddings:  32%|███▏      | 23/73 [00:02<00:03, 15.60it/s][5/6] extract embeddings:  34%|███▍      | 25/73 [00:02<00:02, 16.40it/s][5/6] extract embeddings:  37%|███▋      | 27/73 [00:02<00:02, 16.17it/s][5/6] extract embeddings:  41%|████      | 30/73 [00:02<00:02, 16.79it/s][5/6] extract embeddings:  44%|████▍     | 32/73 [00:02<00:02, 17.50it/s][5/6] extract embeddings:  47%|████▋     | 34/73 [00:02<00:02, 16.95it/s][5/6] extract embeddings:  49%|████▉     | 36/73 [00:02<00:02, 17.36it/s][5/6] extract embeddings:  53%|█████▎    | 39/73 [00:03<00:01, 18.39it/s][5/6] extract embeddings:  56%|█████▌    | 41/73 [00:03<00:01, 17.45it/s][5/6] extract embeddings:  59%|█████▉    | 43/73 [00:03<00:01, 17.07it/s][5/6] extract embeddings:  62%|██████▏   | 45/73 [00:03<00:01, 17.28it/s][5/6] extract embeddings:  64%|██████▍   | 47/73 [00:03<00:01, 17.76it/s][5/6] extract embeddings:  68%|██████▊   | 50/73 [00:03<00:01, 18.77it/s][5/6] extract embeddings:  71%|███████   | 52/73 [00:03<00:01, 18.95it/s][5/6] extract embeddings:  75%|███████▌  | 55/73 [00:03<00:00, 21.21it/s][5/6] extract embeddings:  79%|███████▉  | 58/73 [00:04<00:00, 22.46it/s][5/6] extract embeddings:  84%|████████▎ | 61/73 [00:04<00:00, 23.28it/s][5/6] extract embeddings:  88%|████████▊ | 64/73 [00:04<00:00, 23.81it/s][5/6] extract embeddings:  92%|█████████▏| 67/73 [00:04<00:00, 24.80it/s][5/6] extract embeddings:  96%|█████████▌| 70/73 [00:04<00:00, 25.47it/s][5/6] extract embeddings: 100%|██████████| 73/73 [00:04<00:00, 15.76it/s]
[NeMo I 2025-04-17 01:46:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:46:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:46:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:46:08 collections:880] Dataset successfully loaded with 9265 items and total duration provided from manifest is  1.21 hours.
[NeMo I 2025-04-17 01:46:08 collections:886] # 9265 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/145 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/145 [00:01<02:56,  1.22s/it][6/6] extract embeddings:   3%|▎         | 5/145 [00:01<00:28,  4.85it/s][6/6] extract embeddings:   6%|▌         | 9/145 [00:01<00:15,  9.04it/s][6/6] extract embeddings:   9%|▉         | 13/145 [00:01<00:09, 13.22it/s][6/6] extract embeddings:  12%|█▏        | 17/145 [00:01<00:07, 17.36it/s][6/6] extract embeddings:  14%|█▍        | 21/145 [00:01<00:06, 20.57it/s][6/6] extract embeddings:  17%|█▋        | 25/145 [00:02<00:06, 19.85it/s][6/6] extract embeddings:  19%|█▉        | 28/145 [00:02<00:06, 19.19it/s][6/6] extract embeddings:  21%|██▏       | 31/145 [00:02<00:05, 19.94it/s][6/6] extract embeddings:  23%|██▎       | 34/145 [00:02<00:05, 19.37it/s][6/6] extract embeddings:  26%|██▌       | 37/145 [00:02<00:05, 20.05it/s][6/6] extract embeddings:  28%|██▊       | 40/145 [00:02<00:05, 19.75it/s][6/6] extract embeddings:  30%|██▉       | 43/145 [00:02<00:05, 19.97it/s][6/6] extract embeddings:  32%|███▏      | 46/145 [00:03<00:04, 20.31it/s][6/6] extract embeddings:  34%|███▍      | 49/145 [00:03<00:04, 19.40it/s][6/6] extract embeddings:  35%|███▌      | 51/145 [00:03<00:05, 18.64it/s][6/6] extract embeddings:  37%|███▋      | 54/145 [00:03<00:04, 19.09it/s][6/6] extract embeddings:  39%|███▊      | 56/145 [00:03<00:04, 19.22it/s][6/6] extract embeddings:  40%|████      | 58/145 [00:03<00:04, 18.68it/s][6/6] extract embeddings:  41%|████▏     | 60/145 [00:03<00:04, 18.73it/s][6/6] extract embeddings:  43%|████▎     | 62/145 [00:03<00:04, 19.02it/s][6/6] extract embeddings:  44%|████▍     | 64/145 [00:04<00:04, 18.73it/s][6/6] extract embeddings:  46%|████▌     | 66/145 [00:04<00:04, 18.34it/s][6/6] extract embeddings:  47%|████▋     | 68/145 [00:04<00:04, 17.57it/s][6/6] extract embeddings:  48%|████▊     | 70/145 [00:04<00:04, 17.47it/s][6/6] extract embeddings:  50%|████▉     | 72/145 [00:04<00:04, 17.77it/s][6/6] extract embeddings:  51%|█████     | 74/145 [00:04<00:03, 17.79it/s][6/6] extract embeddings:  53%|█████▎    | 77/145 [00:04<00:03, 18.50it/s][6/6] extract embeddings:  54%|█████▍    | 79/145 [00:04<00:03, 18.75it/s][6/6] extract embeddings:  56%|█████▌    | 81/145 [00:05<00:03, 18.25it/s][6/6] extract embeddings:  58%|█████▊    | 84/145 [00:05<00:03, 18.78it/s][6/6] extract embeddings:  59%|█████▉    | 86/145 [00:05<00:03, 18.71it/s][6/6] extract embeddings:  61%|██████▏   | 89/145 [00:05<00:02, 20.13it/s][6/6] extract embeddings:  63%|██████▎   | 92/145 [00:05<00:02, 19.38it/s][6/6] extract embeddings:  66%|██████▌   | 95/145 [00:05<00:02, 19.95it/s][6/6] extract embeddings:  67%|██████▋   | 97/145 [00:05<00:02, 19.89it/s][6/6] extract embeddings:  68%|██████▊   | 99/145 [00:05<00:02, 19.67it/s][6/6] extract embeddings:  70%|███████   | 102/145 [00:06<00:02, 20.39it/s][6/6] extract embeddings:  72%|███████▏  | 105/145 [00:06<00:01, 21.83it/s][6/6] extract embeddings:  75%|███████▌  | 109/145 [00:06<00:01, 24.47it/s][6/6] extract embeddings:  78%|███████▊  | 113/145 [00:06<00:01, 27.07it/s][6/6] extract embeddings:  81%|████████  | 117/145 [00:06<00:00, 29.67it/s][6/6] extract embeddings:  83%|████████▎ | 121/145 [00:06<00:00, 29.73it/s][6/6] extract embeddings:  86%|████████▌ | 124/145 [00:06<00:00, 29.54it/s][6/6] extract embeddings:  88%|████████▊ | 128/145 [00:06<00:00, 30.41it/s][6/6] extract embeddings:  91%|█████████ | 132/145 [00:07<00:00, 31.64it/s][6/6] extract embeddings:  94%|█████████▍| 136/145 [00:07<00:00, 30.80it/s][6/6] extract embeddings:  97%|█████████▋| 140/145 [00:07<00:00, 31.34it/s][6/6] extract embeddings:  99%|█████████▉| 144/145 [00:07<00:00, 31.53it/s][6/6] extract embeddings: 100%|██████████| 145/145 [00:07<00:00, 19.41it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.16it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.94it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.52it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.70it/s]
[NeMo I 2025-04-17 01:46:17 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:46:18 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              54.100232   444.120  ...  13.699960  3.084743
    Harker-ES                       49.202122  2178.782  ...  40.793765  1.872320
    Harker-MN                       54.978208   366.767  ...  26.285990  7.166945
    Longfellow-Block-1              44.645056   492.417  ...  10.328995  2.097611
    TOTAL                           49.790806  3482.086  ...  91.108710  2.616498
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:46:18 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0494 | MISS: 0.4224 | CER: 0.0262 | DER: 0.4979 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.71s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.89s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:46:30 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:46:30 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:46:30 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:46:30 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:46:30 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:46:30 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:46:30 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:46:30 features:305] PADDING: 16
[NeMo I 2025-04-17 01:46:31 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:46:31 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:46:31 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:46:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:46:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:46:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:46:31 collections:880] Dataset successfully loaded with 2070 items and total duration provided from manifest is  0.81 hours.
[NeMo I 2025-04-17 01:46:31 collections:886] # 2070 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:02,  1.95s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.51it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.71it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.31it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  8.10it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.62it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 12.94it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 14.96it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:03<00:00, 16.38it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 17.58it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 17.71it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 18.77it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  9.38it/s]
[NeMo I 2025-04-17 01:46:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:46:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:46:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:46:34 collections:880] Dataset successfully loaded with 2257 items and total duration provided from manifest is  0.85 hours.
[NeMo I 2025-04-17 01:46:34 collections:886] # 2257 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:48,  1.38s/it][2/6] extract embeddings:   8%|▊         | 3/36 [00:01<00:13,  2.52it/s][2/6] extract embeddings:  17%|█▋        | 6/36 [00:01<00:05,  5.44it/s][2/6] extract embeddings:  25%|██▌       | 9/36 [00:01<00:03,  8.26it/s][2/6] extract embeddings:  33%|███▎      | 12/36 [00:01<00:02, 10.83it/s][2/6] extract embeddings:  42%|████▏     | 15/36 [00:02<00:01, 13.46it/s][2/6] extract embeddings:  50%|█████     | 18/36 [00:02<00:01, 15.50it/s][2/6] extract embeddings:  58%|█████▊    | 21/36 [00:02<00:00, 17.34it/s][2/6] extract embeddings:  67%|██████▋   | 24/36 [00:02<00:00, 18.76it/s][2/6] extract embeddings:  75%|███████▌  | 27/36 [00:02<00:00, 19.42it/s][2/6] extract embeddings:  83%|████████▎ | 30/36 [00:02<00:00, 19.32it/s][2/6] extract embeddings:  92%|█████████▏| 33/36 [00:02<00:00, 19.83it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 21.14it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 11.79it/s]
[NeMo I 2025-04-17 01:46:37 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:46:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:46:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:46:38 collections:880] Dataset successfully loaded with 2552 items and total duration provided from manifest is  0.89 hours.
[NeMo I 2025-04-17 01:46:38 collections:886] # 2552 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:44,  1.14s/it][3/6] extract embeddings:  10%|█         | 4/40 [00:01<00:09,  3.92it/s][3/6] extract embeddings:  15%|█▌        | 6/40 [00:01<00:05,  5.98it/s][3/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  9.23it/s][3/6] extract embeddings:  30%|███       | 12/40 [00:01<00:02, 11.95it/s][3/6] extract embeddings:  38%|███▊      | 15/40 [00:01<00:01, 14.32it/s][3/6] extract embeddings:  42%|████▎     | 17/40 [00:01<00:01, 15.39it/s][3/6] extract embeddings:  50%|█████     | 20/40 [00:02<00:01, 17.71it/s][3/6] extract embeddings:  57%|█████▊    | 23/40 [00:02<00:00, 19.12it/s][3/6] extract embeddings:  65%|██████▌   | 26/40 [00:02<00:00, 19.24it/s][3/6] extract embeddings:  72%|███████▎  | 29/40 [00:02<00:00, 19.75it/s][3/6] extract embeddings:  80%|████████  | 32/40 [00:02<00:00, 20.20it/s][3/6] extract embeddings:  88%|████████▊ | 35/40 [00:02<00:00, 20.35it/s][3/6] extract embeddings:  95%|█████████▌| 38/40 [00:02<00:00, 20.21it/s][3/6] extract embeddings: 100%|██████████| 40/40 [00:03<00:00, 13.22it/s]
[NeMo I 2025-04-17 01:46:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:46:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:46:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:46:41 collections:880] Dataset successfully loaded with 3147 items and total duration provided from manifest is  0.96 hours.
[NeMo I 2025-04-17 01:46:41 collections:886] # 3147 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/50 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/50 [00:01<00:56,  1.14s/it][4/6] extract embeddings:   8%|▊         | 4/50 [00:01<00:11,  4.00it/s][4/6] extract embeddings:  14%|█▍        | 7/50 [00:01<00:05,  7.26it/s][4/6] extract embeddings:  20%|██        | 10/50 [00:01<00:03, 10.19it/s][4/6] extract embeddings:  26%|██▌       | 13/50 [00:01<00:02, 13.25it/s][4/6] extract embeddings:  32%|███▏      | 16/50 [00:01<00:02, 15.27it/s][4/6] extract embeddings:  38%|███▊      | 19/50 [00:01<00:01, 17.54it/s][4/6] extract embeddings:  44%|████▍     | 22/50 [00:02<00:01, 19.68it/s][4/6] extract embeddings:  50%|█████     | 25/50 [00:02<00:01, 20.64it/s][4/6] extract embeddings:  56%|█████▌    | 28/50 [00:02<00:01, 21.53it/s][4/6] extract embeddings:  62%|██████▏   | 31/50 [00:02<00:00, 21.54it/s][4/6] extract embeddings:  68%|██████▊   | 34/50 [00:02<00:00, 21.79it/s][4/6] extract embeddings:  74%|███████▍  | 37/50 [00:02<00:00, 22.12it/s][4/6] extract embeddings:  80%|████████  | 40/50 [00:02<00:00, 22.71it/s][4/6] extract embeddings:  86%|████████▌ | 43/50 [00:02<00:00, 22.11it/s][4/6] extract embeddings:  92%|█████████▏| 46/50 [00:03<00:00, 21.89it/s][4/6] extract embeddings:  98%|█████████▊| 49/50 [00:03<00:00, 22.15it/s][4/6] extract embeddings: 100%|██████████| 50/50 [00:03<00:00, 15.16it/s]
[NeMo I 2025-04-17 01:46:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:46:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:46:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:46:44 collections:880] Dataset successfully loaded with 4460 items and total duration provided from manifest is  1.04 hours.
[NeMo I 2025-04-17 01:46:44 collections:886] # 4460 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/70 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/70 [00:01<01:18,  1.13s/it][5/6] extract embeddings:   6%|▌         | 4/70 [00:01<00:16,  4.12it/s][5/6] extract embeddings:  10%|█         | 7/70 [00:01<00:08,  7.38it/s][5/6] extract embeddings:  14%|█▍        | 10/70 [00:01<00:05, 10.70it/s][5/6] extract embeddings:  19%|█▊        | 13/70 [00:01<00:04, 13.89it/s][5/6] extract embeddings:  23%|██▎       | 16/70 [00:01<00:03, 16.87it/s][5/6] extract embeddings:  27%|██▋       | 19/70 [00:01<00:02, 19.56it/s][5/6] extract embeddings:  31%|███▏      | 22/70 [00:01<00:02, 21.29it/s][5/6] extract embeddings:  36%|███▌      | 25/70 [00:02<00:02, 21.92it/s][5/6] extract embeddings:  40%|████      | 28/70 [00:02<00:01, 23.57it/s][5/6] extract embeddings:  44%|████▍     | 31/70 [00:02<00:01, 23.89it/s][5/6] extract embeddings:  49%|████▊     | 34/70 [00:02<00:01, 25.10it/s][5/6] extract embeddings:  53%|█████▎    | 37/70 [00:02<00:01, 26.19it/s][5/6] extract embeddings:  57%|█████▋    | 40/70 [00:02<00:01, 25.34it/s][5/6] extract embeddings:  61%|██████▏   | 43/70 [00:02<00:01, 25.54it/s][5/6] extract embeddings:  67%|██████▋   | 47/70 [00:02<00:00, 25.83it/s][5/6] extract embeddings:  71%|███████▏  | 50/70 [00:02<00:00, 26.21it/s][5/6] extract embeddings:  76%|███████▌  | 53/70 [00:03<00:00, 26.12it/s][5/6] extract embeddings:  80%|████████  | 56/70 [00:03<00:00, 26.85it/s][5/6] extract embeddings:  84%|████████▍ | 59/70 [00:03<00:00, 25.48it/s][5/6] extract embeddings:  89%|████████▊ | 62/70 [00:03<00:00, 26.19it/s][5/6] extract embeddings:  93%|█████████▎| 65/70 [00:03<00:00, 26.24it/s][5/6] extract embeddings:  97%|█████████▋| 68/70 [00:03<00:00, 26.86it/s][5/6] extract embeddings: 100%|██████████| 70/70 [00:03<00:00, 18.65it/s]
[NeMo I 2025-04-17 01:46:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:46:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:46:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:46:48 collections:880] Dataset successfully loaded with 8864 items and total duration provided from manifest is  1.16 hours.
[NeMo I 2025-04-17 01:46:48 collections:886] # 8864 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/139 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/139 [00:01<02:49,  1.23s/it][6/6] extract embeddings:   4%|▎         | 5/139 [00:01<00:27,  4.88it/s][6/6] extract embeddings:   6%|▋         | 9/139 [00:01<00:14,  9.22it/s][6/6] extract embeddings:   9%|▉         | 13/139 [00:01<00:09, 13.53it/s][6/6] extract embeddings:  12%|█▏        | 17/139 [00:01<00:07, 17.18it/s][6/6] extract embeddings:  15%|█▌        | 21/139 [00:01<00:05, 20.53it/s][6/6] extract embeddings:  18%|█▊        | 25/139 [00:01<00:04, 23.40it/s][6/6] extract embeddings:  21%|██        | 29/139 [00:02<00:04, 25.57it/s][6/6] extract embeddings:  24%|██▎       | 33/139 [00:02<00:03, 28.06it/s][6/6] extract embeddings:  27%|██▋       | 37/139 [00:02<00:03, 28.51it/s][6/6] extract embeddings:  29%|██▉       | 41/139 [00:02<00:03, 29.60it/s][6/6] extract embeddings:  32%|███▏      | 45/139 [00:02<00:03, 31.20it/s][6/6] extract embeddings:  35%|███▌      | 49/139 [00:02<00:02, 30.71it/s][6/6] extract embeddings:  38%|███▊      | 53/139 [00:02<00:02, 30.51it/s][6/6] extract embeddings:  41%|████      | 57/139 [00:02<00:02, 30.73it/s][6/6] extract embeddings:  44%|████▍     | 61/139 [00:03<00:02, 30.18it/s][6/6] extract embeddings:  47%|████▋     | 65/139 [00:03<00:02, 30.86it/s][6/6] extract embeddings:  50%|████▉     | 69/139 [00:03<00:02, 31.93it/s][6/6] extract embeddings:  53%|█████▎    | 73/139 [00:03<00:02, 31.04it/s][6/6] extract embeddings:  55%|█████▌    | 77/139 [00:03<00:02, 29.53it/s][6/6] extract embeddings:  58%|█████▊    | 81/139 [00:03<00:01, 29.20it/s][6/6] extract embeddings:  61%|██████    | 85/139 [00:03<00:01, 30.37it/s][6/6] extract embeddings:  64%|██████▍   | 89/139 [00:04<00:01, 30.65it/s][6/6] extract embeddings:  67%|██████▋   | 93/139 [00:04<00:01, 30.74it/s][6/6] extract embeddings:  70%|██████▉   | 97/139 [00:04<00:01, 31.14it/s][6/6] extract embeddings:  73%|███████▎  | 101/139 [00:04<00:01, 31.82it/s][6/6] extract embeddings:  76%|███████▌  | 105/139 [00:04<00:01, 31.70it/s][6/6] extract embeddings:  78%|███████▊  | 109/139 [00:04<00:00, 31.74it/s][6/6] extract embeddings:  81%|████████▏ | 113/139 [00:04<00:00, 32.21it/s][6/6] extract embeddings:  84%|████████▍ | 117/139 [00:04<00:00, 32.50it/s][6/6] extract embeddings:  87%|████████▋ | 121/139 [00:04<00:00, 33.24it/s][6/6] extract embeddings:  90%|████████▉ | 125/139 [00:05<00:00, 33.18it/s][6/6] extract embeddings:  93%|█████████▎| 129/139 [00:05<00:00, 33.39it/s][6/6] extract embeddings:  96%|█████████▌| 133/139 [00:05<00:00, 32.73it/s][6/6] extract embeddings:  99%|█████████▊| 137/139 [00:05<00:00, 33.00it/s][6/6] extract embeddings: 100%|██████████| 139/139 [00:05<00:00, 25.01it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.25it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.04it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.68it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.85it/s]
[NeMo I 2025-04-17 01:46:56 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:46:57 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              55.639161   444.120  ...  12.594985  2.835942
    Harker-ES                       51.637191  2178.782  ...  43.612922  2.001711
    Harker-MN                       57.150455   366.767  ...  27.616029  7.529584
    Longfellow-Block-1              46.952527   492.417  ...   9.468983  1.922960
    TOTAL                           52.065851  3482.086  ...  93.292919  2.679225
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:46:57 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0474 | MISS: 0.4464 | CER: 0.0268 | DER: 0.5207 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.73s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:47:08 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:47:08 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:47:08 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:47:08 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:47:08 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:47:09 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:47:09 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:47:09 features:305] PADDING: 16
[NeMo I 2025-04-17 01:47:09 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:47:09 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:47:09 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:47:09 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:47:09 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:09 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:09 collections:880] Dataset successfully loaded with 2051 items and total duration provided from manifest is  0.74 hours.
[NeMo I 2025-04-17 01:47:09 collections:886] # 2051 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:09,  2.16s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:12,  2.28it/s][1/6] extract embeddings:  18%|█▊        | 6/33 [00:02<00:07,  3.68it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.03it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  7.69it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.43it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 11.97it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:03<00:00, 14.12it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 15.55it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 16.88it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 17.33it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 18.57it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00, 19.66it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.82it/s]
[NeMo I 2025-04-17 01:47:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:47:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:13 collections:880] Dataset successfully loaded with 2219 items and total duration provided from manifest is  0.78 hours.
[NeMo I 2025-04-17 01:47:13 collections:886] # 2219 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:47,  1.40s/it][2/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:09,  3.30it/s][2/6] extract embeddings:  20%|██        | 7/35 [00:01<00:04,  6.02it/s][2/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02,  8.74it/s][2/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 11.36it/s][2/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 13.67it/s][2/6] extract embeddings:  54%|█████▍    | 19/35 [00:02<00:01, 15.94it/s][2/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 17.43it/s][2/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 18.76it/s][2/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 19.22it/s][2/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 19.83it/s][2/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 20.45it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 11.73it/s]
[NeMo I 2025-04-17 01:47:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:47:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:16 collections:880] Dataset successfully loaded with 2473 items and total duration provided from manifest is  0.82 hours.
[NeMo I 2025-04-17 01:47:16 collections:886] # 2473 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:43,  1.14s/it][3/6] extract embeddings:  10%|█         | 4/39 [00:01<00:09,  3.88it/s][3/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  6.95it/s][3/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:02,  9.78it/s][3/6] extract embeddings:  33%|███▎      | 13/39 [00:01<00:02, 12.42it/s][3/6] extract embeddings:  41%|████      | 16/39 [00:01<00:01, 14.69it/s][3/6] extract embeddings:  49%|████▊     | 19/39 [00:01<00:01, 16.93it/s][3/6] extract embeddings:  56%|█████▋    | 22/39 [00:02<00:00, 18.36it/s][3/6] extract embeddings:  64%|██████▍   | 25/39 [00:02<00:00, 19.61it/s][3/6] extract embeddings:  72%|███████▏  | 28/39 [00:02<00:00, 20.18it/s][3/6] extract embeddings:  79%|███████▉  | 31/39 [00:02<00:00, 20.95it/s][3/6] extract embeddings:  87%|████████▋ | 34/39 [00:02<00:00, 21.28it/s][3/6] extract embeddings:  95%|█████████▍| 37/39 [00:02<00:00, 21.04it/s][3/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 13.55it/s]
[NeMo I 2025-04-17 01:47:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:47:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:19 collections:880] Dataset successfully loaded with 2996 items and total duration provided from manifest is  0.88 hours.
[NeMo I 2025-04-17 01:47:19 collections:886] # 2996 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:52,  1.15s/it][4/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:11,  3.91it/s][4/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:05,  7.08it/s][4/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:03, 10.23it/s][4/6] extract embeddings:  28%|██▊       | 13/47 [00:01<00:02, 13.08it/s][4/6] extract embeddings:  34%|███▍      | 16/47 [00:01<00:02, 15.29it/s][4/6] extract embeddings:  40%|████      | 19/47 [00:01<00:01, 17.04it/s][4/6] extract embeddings:  47%|████▋     | 22/47 [00:02<00:01, 18.68it/s][4/6] extract embeddings:  53%|█████▎    | 25/47 [00:02<00:01, 19.32it/s][4/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:00, 20.27it/s][4/6] extract embeddings:  66%|██████▌   | 31/47 [00:02<00:00, 20.79it/s][4/6] extract embeddings:  72%|███████▏  | 34/47 [00:02<00:00, 21.72it/s][4/6] extract embeddings:  79%|███████▊  | 37/47 [00:02<00:00, 22.02it/s][4/6] extract embeddings:  85%|████████▌ | 40/47 [00:02<00:00, 22.43it/s][4/6] extract embeddings:  91%|█████████▏| 43/47 [00:02<00:00, 22.47it/s][4/6] extract embeddings:  98%|█████████▊| 46/47 [00:03<00:00, 22.90it/s][4/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 14.69it/s]
[NeMo I 2025-04-17 01:47:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:47:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:23 collections:880] Dataset successfully loaded with 4194 items and total duration provided from manifest is  0.96 hours.
[NeMo I 2025-04-17 01:47:23 collections:886] # 4194 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/66 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/66 [00:01<01:14,  1.14s/it][5/6] extract embeddings:   6%|▌         | 4/66 [00:01<00:15,  4.05it/s][5/6] extract embeddings:  11%|█         | 7/66 [00:01<00:07,  7.50it/s][5/6] extract embeddings:  15%|█▌        | 10/66 [00:01<00:05, 10.52it/s][5/6] extract embeddings:  20%|█▉        | 13/66 [00:01<00:03, 13.72it/s][5/6] extract embeddings:  24%|██▍       | 16/66 [00:01<00:03, 16.51it/s][5/6] extract embeddings:  29%|██▉       | 19/66 [00:01<00:02, 18.83it/s][5/6] extract embeddings:  33%|███▎      | 22/66 [00:01<00:02, 21.03it/s][5/6] extract embeddings:  38%|███▊      | 25/66 [00:02<00:01, 21.53it/s][5/6] extract embeddings:  42%|████▏     | 28/66 [00:02<00:01, 22.56it/s][5/6] extract embeddings:  47%|████▋     | 31/66 [00:02<00:01, 24.05it/s][5/6] extract embeddings:  52%|█████▏    | 34/66 [00:02<00:01, 24.03it/s][5/6] extract embeddings:  56%|█████▌    | 37/66 [00:02<00:01, 24.63it/s][5/6] extract embeddings:  61%|██████    | 40/66 [00:02<00:01, 25.51it/s][5/6] extract embeddings:  67%|██████▋   | 44/66 [00:02<00:00, 26.46it/s][5/6] extract embeddings:  71%|███████   | 47/66 [00:02<00:00, 27.30it/s][5/6] extract embeddings:  76%|███████▌  | 50/66 [00:03<00:00, 27.04it/s][5/6] extract embeddings:  80%|████████  | 53/66 [00:03<00:00, 27.05it/s][5/6] extract embeddings:  85%|████████▍ | 56/66 [00:03<00:00, 25.28it/s][5/6] extract embeddings:  89%|████████▉ | 59/66 [00:03<00:00, 26.26it/s][5/6] extract embeddings:  94%|█████████▍| 62/66 [00:03<00:00, 25.32it/s][5/6] extract embeddings:  98%|█████████▊| 65/66 [00:03<00:00, 26.30it/s][5/6] extract embeddings: 100%|██████████| 66/66 [00:03<00:00, 18.13it/s]
[NeMo I 2025-04-17 01:47:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:47:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:26 collections:880] Dataset successfully loaded with 8280 items and total duration provided from manifest is  1.07 hours.
[NeMo I 2025-04-17 01:47:26 collections:886] # 8280 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/130 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/130 [00:01<02:50,  1.32s/it][6/6] extract embeddings:   4%|▍         | 5/130 [00:01<00:27,  4.51it/s][6/6] extract embeddings:   7%|▋         | 9/130 [00:01<00:14,  8.50it/s][6/6] extract embeddings:  10%|█         | 13/130 [00:01<00:09, 12.67it/s][6/6] extract embeddings:  13%|█▎        | 17/130 [00:01<00:06, 16.59it/s][6/6] extract embeddings:  16%|█▌        | 21/130 [00:01<00:05, 20.50it/s][6/6] extract embeddings:  19%|█▉        | 25/130 [00:02<00:04, 23.55it/s][6/6] extract embeddings:  22%|██▏       | 29/130 [00:02<00:03, 25.30it/s][6/6] extract embeddings:  25%|██▌       | 33/130 [00:02<00:03, 27.49it/s][6/6] extract embeddings:  28%|██▊       | 37/130 [00:02<00:03, 28.82it/s][6/6] extract embeddings:  32%|███▏      | 41/130 [00:02<00:02, 29.73it/s][6/6] extract embeddings:  35%|███▍      | 45/130 [00:02<00:02, 30.65it/s][6/6] extract embeddings:  38%|███▊      | 49/130 [00:02<00:02, 31.63it/s][6/6] extract embeddings:  41%|████      | 53/130 [00:02<00:02, 31.95it/s][6/6] extract embeddings:  44%|████▍     | 57/130 [00:03<00:02, 30.98it/s][6/6] extract embeddings:  47%|████▋     | 61/130 [00:03<00:02, 31.78it/s][6/6] extract embeddings:  50%|█████     | 65/130 [00:03<00:01, 32.73it/s][6/6] extract embeddings:  53%|█████▎    | 69/130 [00:03<00:01, 32.67it/s][6/6] extract embeddings:  56%|█████▌    | 73/130 [00:03<00:01, 31.84it/s][6/6] extract embeddings:  59%|█████▉    | 77/130 [00:03<00:01, 32.18it/s][6/6] extract embeddings:  62%|██████▏   | 81/130 [00:03<00:01, 30.53it/s][6/6] extract embeddings:  65%|██████▌   | 85/130 [00:03<00:01, 31.02it/s][6/6] extract embeddings:  68%|██████▊   | 89/130 [00:04<00:01, 31.75it/s][6/6] extract embeddings:  72%|███████▏  | 93/130 [00:04<00:01, 31.73it/s][6/6] extract embeddings:  75%|███████▍  | 97/130 [00:04<00:01, 31.52it/s][6/6] extract embeddings:  78%|███████▊  | 101/130 [00:04<00:00, 31.89it/s][6/6] extract embeddings:  81%|████████  | 105/130 [00:04<00:00, 32.44it/s][6/6] extract embeddings:  84%|████████▍ | 109/130 [00:04<00:00, 32.99it/s][6/6] extract embeddings:  87%|████████▋ | 113/130 [00:04<00:00, 31.91it/s][6/6] extract embeddings:  90%|█████████ | 117/130 [00:04<00:00, 31.37it/s][6/6] extract embeddings:  93%|█████████▎| 121/130 [00:05<00:00, 32.12it/s][6/6] extract embeddings:  96%|█████████▌| 125/130 [00:05<00:00, 32.79it/s][6/6] extract embeddings:  99%|█████████▉| 129/130 [00:05<00:00, 32.03it/s][6/6] extract embeddings: 100%|██████████| 130/130 [00:05<00:00, 24.38it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.21it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.16it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.80it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.42it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.97it/s]
[NeMo I 2025-04-17 01:47:33 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:47:35 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              58.173365   444.120  ...  11.519922  2.593876
    Harker-ES                       53.842315  2178.782  ...  32.873613  1.508807
    Harker-MN                       58.259389   366.767  ...  25.722993  7.013443
    Longfellow-Block-1              50.295397   492.417  ...   9.565995  1.942661
    TOTAL                           54.358379  3482.086  ...  79.682523  2.288356
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:47:35 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0424 | MISS: 0.4783 | CER: 0.0229 | DER: 0.5436 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.35
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.35 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.86s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:47:46 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:47:46 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:47:46 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:47:46 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:47:46 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:47:46 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:47:46 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:47:46 features:305] PADDING: 16
[NeMo I 2025-04-17 01:47:47 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:47:47 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:47:47 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:47:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:47:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:47 collections:880] Dataset successfully loaded with 2033 items and total duration provided from manifest is  0.65 hours.
[NeMo I 2025-04-17 01:47:47 collections:886] # 2033 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:03,  2.05s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.40it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.55it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  6.87it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:02,  9.35it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 11.67it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.04it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.19it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 17.11it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.77it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 18.09it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.12it/s]
[NeMo I 2025-04-17 01:47:50 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:47:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:51 collections:880] Dataset successfully loaded with 2163 items and total duration provided from manifest is  0.68 hours.
[NeMo I 2025-04-17 01:47:51 collections:886] # 2163 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:46,  1.41s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:09,  3.33it/s][2/6] extract embeddings:  18%|█▊        | 6/34 [00:01<00:05,  5.18it/s][2/6] extract embeddings:  26%|██▋       | 9/34 [00:01<00:03,  8.22it/s][2/6] extract embeddings:  35%|███▌      | 12/34 [00:01<00:01, 11.16it/s][2/6] extract embeddings:  44%|████▍     | 15/34 [00:02<00:01, 13.72it/s][2/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 15.61it/s][2/6] extract embeddings:  62%|██████▏   | 21/34 [00:02<00:00, 17.54it/s][2/6] extract embeddings:  71%|███████   | 24/34 [00:02<00:00, 18.90it/s][2/6] extract embeddings:  79%|███████▉  | 27/34 [00:02<00:00, 19.49it/s][2/6] extract embeddings:  88%|████████▊ | 30/34 [00:02<00:00, 20.30it/s][2/6] extract embeddings:  97%|█████████▋| 33/34 [00:02<00:00, 20.03it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.57it/s]
[NeMo I 2025-04-17 01:47:54 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:47:54 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:54 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:54 collections:880] Dataset successfully loaded with 2376 items and total duration provided from manifest is  0.71 hours.
[NeMo I 2025-04-17 01:47:54 collections:886] # 2376 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:41,  1.12s/it][3/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  4.01it/s][3/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  7.26it/s][3/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02, 10.39it/s][3/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 12.86it/s][3/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 15.91it/s][3/6] extract embeddings:  50%|█████     | 19/38 [00:01<00:01, 17.23it/s][3/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 18.85it/s][3/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 19.57it/s][3/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 20.47it/s][3/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 21.83it/s][3/6] extract embeddings:  89%|████████▉ | 34/38 [00:02<00:00, 22.48it/s][3/6] extract embeddings:  97%|█████████▋| 37/38 [00:02<00:00, 22.90it/s][3/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 13.90it/s]
[NeMo I 2025-04-17 01:47:57 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:47:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:47:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:47:57 collections:880] Dataset successfully loaded with 2812 items and total duration provided from manifest is  0.77 hours.
[NeMo I 2025-04-17 01:47:57 collections:886] # 2812 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:47,  1.12s/it][4/6] extract embeddings:   9%|▉         | 4/44 [00:01<00:09,  4.00it/s][4/6] extract embeddings:  16%|█▌        | 7/44 [00:01<00:04,  7.44it/s][4/6] extract embeddings:  23%|██▎       | 10/44 [00:01<00:03, 10.66it/s][4/6] extract embeddings:  30%|██▉       | 13/44 [00:01<00:02, 13.97it/s][4/6] extract embeddings:  36%|███▋      | 16/44 [00:01<00:01, 16.06it/s][4/6] extract embeddings:  43%|████▎     | 19/44 [00:01<00:01, 18.20it/s][4/6] extract embeddings:  50%|█████     | 22/44 [00:01<00:01, 20.01it/s][4/6] extract embeddings:  57%|█████▋    | 25/44 [00:02<00:00, 21.48it/s][4/6] extract embeddings:  64%|██████▎   | 28/44 [00:02<00:00, 22.62it/s][4/6] extract embeddings:  70%|███████   | 31/44 [00:02<00:00, 22.37it/s][4/6] extract embeddings:  77%|███████▋  | 34/44 [00:02<00:00, 22.61it/s][4/6] extract embeddings:  84%|████████▍ | 37/44 [00:02<00:00, 23.02it/s][4/6] extract embeddings:  91%|█████████ | 40/44 [00:02<00:00, 23.55it/s][4/6] extract embeddings:  98%|█████████▊| 43/44 [00:02<00:00, 24.47it/s][4/6] extract embeddings: 100%|██████████| 44/44 [00:02<00:00, 15.19it/s]
[NeMo I 2025-04-17 01:48:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:48:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:48:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:48:00 collections:880] Dataset successfully loaded with 3844 items and total duration provided from manifest is  0.84 hours.
[NeMo I 2025-04-17 01:48:00 collections:886] # 3844 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/61 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/61 [00:01<01:07,  1.12s/it][5/6] extract embeddings:   7%|▋         | 4/61 [00:01<00:13,  4.16it/s][5/6] extract embeddings:  11%|█▏        | 7/61 [00:01<00:07,  7.45it/s][5/6] extract embeddings:  16%|█▋        | 10/61 [00:01<00:04, 10.87it/s][5/6] extract embeddings:  21%|██▏       | 13/61 [00:01<00:03, 14.08it/s][5/6] extract embeddings:  26%|██▌       | 16/61 [00:01<00:02, 16.65it/s][5/6] extract embeddings:  31%|███       | 19/61 [00:01<00:02, 19.35it/s][5/6] extract embeddings:  36%|███▌      | 22/61 [00:01<00:01, 21.68it/s][5/6] extract embeddings:  41%|████      | 25/61 [00:02<00:01, 23.73it/s][5/6] extract embeddings:  46%|████▌     | 28/61 [00:02<00:01, 25.22it/s][5/6] extract embeddings:  51%|█████     | 31/61 [00:02<00:01, 26.23it/s][5/6] extract embeddings:  56%|█████▌    | 34/61 [00:02<00:01, 26.12it/s][5/6] extract embeddings:  61%|██████    | 37/61 [00:02<00:00, 26.89it/s][5/6] extract embeddings:  66%|██████▌   | 40/61 [00:02<00:00, 27.33it/s][5/6] extract embeddings:  70%|███████   | 43/61 [00:02<00:00, 27.75it/s][5/6] extract embeddings:  75%|███████▌  | 46/61 [00:02<00:00, 28.25it/s][5/6] extract embeddings:  80%|████████  | 49/61 [00:02<00:00, 27.08it/s][5/6] extract embeddings:  85%|████████▌ | 52/61 [00:02<00:00, 26.72it/s][5/6] extract embeddings:  90%|█████████ | 55/61 [00:03<00:00, 26.48it/s][5/6] extract embeddings:  95%|█████████▌| 58/61 [00:03<00:00, 25.71it/s][5/6] extract embeddings: 100%|██████████| 61/61 [00:03<00:00, 24.38it/s][5/6] extract embeddings: 100%|██████████| 61/61 [00:03<00:00, 18.02it/s]
[NeMo I 2025-04-17 01:48:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:48:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:48:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:48:03 collections:880] Dataset successfully loaded with 7467 items and total duration provided from manifest is  0.95 hours.
[NeMo I 2025-04-17 01:48:03 collections:886] # 7467 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/117 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/117 [00:01<02:09,  1.12s/it][6/6] extract embeddings:   4%|▍         | 5/117 [00:01<00:21,  5.25it/s][6/6] extract embeddings:   8%|▊         | 9/117 [00:01<00:11,  9.73it/s][6/6] extract embeddings:  11%|█         | 13/117 [00:01<00:07, 14.38it/s][6/6] extract embeddings:  15%|█▍        | 17/117 [00:01<00:05, 18.21it/s][6/6] extract embeddings:  18%|█▊        | 21/117 [00:01<00:04, 21.78it/s][6/6] extract embeddings:  21%|██▏       | 25/117 [00:01<00:03, 24.93it/s][6/6] extract embeddings:  25%|██▍       | 29/117 [00:01<00:03, 27.57it/s][6/6] extract embeddings:  28%|██▊       | 33/117 [00:02<00:02, 29.75it/s][6/6] extract embeddings:  32%|███▏      | 37/117 [00:02<00:02, 30.49it/s][6/6] extract embeddings:  35%|███▌      | 41/117 [00:02<00:02, 31.93it/s][6/6] extract embeddings:  38%|███▊      | 45/117 [00:02<00:02, 32.67it/s][6/6] extract embeddings:  42%|████▏     | 49/117 [00:02<00:02, 32.54it/s][6/6] extract embeddings:  45%|████▌     | 53/117 [00:02<00:01, 32.46it/s][6/6] extract embeddings:  49%|████▊     | 57/117 [00:02<00:01, 30.60it/s][6/6] extract embeddings:  52%|█████▏    | 61/117 [00:02<00:01, 31.98it/s][6/6] extract embeddings:  56%|█████▌    | 65/117 [00:03<00:01, 31.16it/s][6/6] extract embeddings:  59%|█████▉    | 69/117 [00:03<00:01, 31.34it/s][6/6] extract embeddings:  62%|██████▏   | 73/117 [00:03<00:01, 31.89it/s][6/6] extract embeddings:  66%|██████▌   | 77/117 [00:03<00:01, 32.17it/s][6/6] extract embeddings:  69%|██████▉   | 81/117 [00:03<00:01, 33.16it/s][6/6] extract embeddings:  73%|███████▎  | 85/117 [00:03<00:00, 32.77it/s][6/6] extract embeddings:  76%|███████▌  | 89/117 [00:03<00:00, 32.77it/s][6/6] extract embeddings:  79%|███████▉  | 93/117 [00:03<00:00, 33.17it/s][6/6] extract embeddings:  83%|████████▎ | 97/117 [00:04<00:00, 32.76it/s][6/6] extract embeddings:  86%|████████▋ | 101/117 [00:04<00:00, 33.12it/s][6/6] extract embeddings:  90%|████████▉ | 105/117 [00:04<00:00, 33.51it/s][6/6] extract embeddings:  93%|█████████▎| 109/117 [00:04<00:00, 32.73it/s][6/6] extract embeddings:  97%|█████████▋| 113/117 [00:04<00:00, 33.22it/s][6/6] extract embeddings: 100%|██████████| 117/117 [00:04<00:00, 34.40it/s][6/6] extract embeddings: 100%|██████████| 117/117 [00:04<00:00, 25.29it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.29it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.39it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.11it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s]
[NeMo I 2025-04-17 01:48:10 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:48:11 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              61.559820   444.120  ...  11.899951  2.679445
    Harker-ES                       58.481767  2178.782  ...  33.063420  1.517519
    Harker-MN                       61.186789   366.767  ...  25.693907  7.005512
    Longfellow-Block-1              53.539060   492.417  ...   9.363047  1.901447
    TOTAL                           58.460304  3482.086  ...  80.020325  2.298057
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:48:11 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0370 | MISS: 0.5246 | CER: 0.0230 | DER: 0.5846 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.45, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.45, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.89s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:48:22 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:48:22 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:48:22 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:48:22 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:48:22 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:48:22 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:48:22 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:48:22 features:305] PADDING: 16
[NeMo I 2025-04-17 01:48:23 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:48:23 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:48:23 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:48:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:48:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:48:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:48:23 collections:880] Dataset successfully loaded with 2067 items and total duration provided from manifest is  0.93 hours.
[NeMo I 2025-04-17 01:48:23 collections:886] # 2067 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  1.99s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.46it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.68it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.21it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  7.88it/s][1/6] extract embeddings:  39%|███▉      | 13/33 [00:02<00:02,  9.68it/s][1/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 11.47it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 12.75it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:01, 13.94it/s][1/6] extract embeddings:  64%|██████▎   | 21/33 [00:03<00:00, 14.89it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:03<00:00, 16.10it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 16.50it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 16.98it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 17.44it/s][1/6] extract embeddings:  94%|█████████▍| 31/33 [00:03<00:00, 17.70it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  8.97it/s]
[NeMo I 2025-04-17 01:48:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:48:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:48:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:48:27 collections:880] Dataset successfully loaded with 2300 items and total duration provided from manifest is  0.98 hours.
[NeMo I 2025-04-17 01:48:27 collections:886] # 2300 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:52,  1.49s/it][2/6] extract embeddings:  11%|█         | 4/36 [00:01<00:10,  3.10it/s][2/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:05,  5.71it/s][2/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:03,  8.35it/s][2/6] extract embeddings:  33%|███▎      | 12/36 [00:02<00:02,  9.93it/s][2/6] extract embeddings:  39%|███▉      | 14/36 [00:02<00:01, 11.66it/s][2/6] extract embeddings:  47%|████▋     | 17/36 [00:02<00:01, 14.06it/s][2/6] extract embeddings:  56%|█████▌    | 20/36 [00:02<00:01, 15.95it/s][2/6] extract embeddings:  61%|██████    | 22/36 [00:02<00:00, 16.78it/s][2/6] extract embeddings:  69%|██████▉   | 25/36 [00:02<00:00, 18.00it/s][2/6] extract embeddings:  78%|███████▊  | 28/36 [00:02<00:00, 18.56it/s][2/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 19.00it/s][2/6] extract embeddings:  94%|█████████▍| 34/36 [00:03<00:00, 19.53it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 11.10it/s]
[NeMo I 2025-04-17 01:48:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:48:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:48:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:48:30 collections:880] Dataset successfully loaded with 2675 items and total duration provided from manifest is  1.03 hours.
[NeMo I 2025-04-17 01:48:30 collections:886] # 2675 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:46,  1.13s/it][3/6] extract embeddings:  10%|▉         | 4/42 [00:01<00:09,  3.95it/s][3/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:04,  7.04it/s][3/6] extract embeddings:  24%|██▍       | 10/42 [00:01<00:03,  9.98it/s][3/6] extract embeddings:  31%|███       | 13/42 [00:01<00:02, 12.34it/s][3/6] extract embeddings:  38%|███▊      | 16/42 [00:01<00:01, 14.49it/s][3/6] extract embeddings:  45%|████▌     | 19/42 [00:01<00:01, 16.20it/s][3/6] extract embeddings:  52%|█████▏    | 22/42 [00:02<00:01, 17.82it/s][3/6] extract embeddings:  60%|█████▉    | 25/42 [00:02<00:00, 18.21it/s][3/6] extract embeddings:  67%|██████▋   | 28/42 [00:02<00:00, 18.51it/s][3/6] extract embeddings:  74%|███████▍  | 31/42 [00:02<00:00, 19.38it/s][3/6] extract embeddings:  81%|████████  | 34/42 [00:02<00:00, 20.03it/s][3/6] extract embeddings:  88%|████████▊ | 37/42 [00:02<00:00, 19.24it/s][3/6] extract embeddings:  95%|█████████▌| 40/42 [00:03<00:00, 20.01it/s][3/6] extract embeddings: 100%|██████████| 42/42 [00:03<00:00, 13.37it/s]
[NeMo I 2025-04-17 01:48:33 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:48:33 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:48:33 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:48:33 collections:880] Dataset successfully loaded with 3364 items and total duration provided from manifest is  1.10 hours.
[NeMo I 2025-04-17 01:48:33 collections:886] # 3364 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/53 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/53 [00:01<00:59,  1.14s/it][4/6] extract embeddings:   8%|▊         | 4/53 [00:01<00:12,  4.02it/s][4/6] extract embeddings:  13%|█▎        | 7/53 [00:01<00:06,  7.28it/s][4/6] extract embeddings:  19%|█▉        | 10/53 [00:01<00:04, 10.45it/s][4/6] extract embeddings:  25%|██▍       | 13/53 [00:01<00:03, 12.95it/s][4/6] extract embeddings:  30%|███       | 16/53 [00:01<00:02, 15.34it/s][4/6] extract embeddings:  36%|███▌      | 19/53 [00:01<00:01, 17.09it/s][4/6] extract embeddings:  42%|████▏     | 22/53 [00:02<00:01, 19.04it/s][4/6] extract embeddings:  47%|████▋     | 25/53 [00:02<00:01, 20.07it/s][4/6] extract embeddings:  53%|█████▎    | 28/53 [00:02<00:01, 20.48it/s][4/6] extract embeddings:  58%|█████▊    | 31/53 [00:02<00:01, 21.27it/s][4/6] extract embeddings:  64%|██████▍   | 34/53 [00:02<00:00, 22.47it/s][4/6] extract embeddings:  70%|██████▉   | 37/53 [00:02<00:00, 22.28it/s][4/6] extract embeddings:  75%|███████▌  | 40/53 [00:02<00:00, 22.33it/s][4/6] extract embeddings:  81%|████████  | 43/53 [00:02<00:00, 22.70it/s][4/6] extract embeddings:  87%|████████▋ | 46/53 [00:03<00:00, 22.37it/s][4/6] extract embeddings:  92%|█████████▏| 49/53 [00:03<00:00, 21.31it/s][4/6] extract embeddings:  98%|█████████▊| 52/53 [00:03<00:00, 21.47it/s][4/6] extract embeddings: 100%|██████████| 53/53 [00:03<00:00, 15.42it/s]
[NeMo I 2025-04-17 01:48:37 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:48:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:48:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:48:37 collections:880] Dataset successfully loaded with 4911 items and total duration provided from manifest is  1.19 hours.
[NeMo I 2025-04-17 01:48:37 collections:886] # 4911 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/77 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/77 [00:01<01:24,  1.11s/it][5/6] extract embeddings:   5%|▌         | 4/77 [00:01<00:17,  4.19it/s][5/6] extract embeddings:   9%|▉         | 7/77 [00:01<00:09,  7.57it/s][5/6] extract embeddings:  13%|█▎        | 10/77 [00:01<00:06, 10.89it/s][5/6] extract embeddings:  17%|█▋        | 13/77 [00:01<00:04, 14.24it/s][5/6] extract embeddings:  21%|██        | 16/77 [00:01<00:03, 17.14it/s][5/6] extract embeddings:  25%|██▍       | 19/77 [00:01<00:02, 19.94it/s][5/6] extract embeddings:  29%|██▊       | 22/77 [00:01<00:02, 21.54it/s][5/6] extract embeddings:  32%|███▏      | 25/77 [00:01<00:02, 22.93it/s][5/6] extract embeddings:  36%|███▋      | 28/77 [00:02<00:02, 24.31it/s][5/6] extract embeddings:  40%|████      | 31/77 [00:02<00:01, 24.77it/s][5/6] extract embeddings:  44%|████▍     | 34/77 [00:02<00:01, 25.62it/s][5/6] extract embeddings:  48%|████▊     | 37/77 [00:02<00:01, 25.95it/s][5/6] extract embeddings:  52%|█████▏    | 40/77 [00:02<00:01, 26.53it/s][5/6] extract embeddings:  56%|█████▌    | 43/77 [00:02<00:01, 24.96it/s][5/6] extract embeddings:  60%|█████▉    | 46/77 [00:02<00:01, 24.68it/s][5/6] extract embeddings:  64%|██████▎   | 49/77 [00:02<00:01, 25.25it/s][5/6] extract embeddings:  68%|██████▊   | 52/77 [00:03<00:00, 25.15it/s][5/6] extract embeddings:  71%|███████▏  | 55/77 [00:03<00:00, 26.00it/s][5/6] extract embeddings:  75%|███████▌  | 58/77 [00:03<00:00, 26.32it/s][5/6] extract embeddings:  79%|███████▉  | 61/77 [00:03<00:00, 25.56it/s][5/6] extract embeddings:  83%|████████▎ | 64/77 [00:03<00:00, 26.46it/s][5/6] extract embeddings:  87%|████████▋ | 67/77 [00:03<00:00, 26.72it/s][5/6] extract embeddings:  91%|█████████ | 70/77 [00:03<00:00, 27.34it/s][5/6] extract embeddings:  95%|█████████▍| 73/77 [00:03<00:00, 27.45it/s][5/6] extract embeddings:  99%|█████████▊| 76/77 [00:03<00:00, 27.17it/s][5/6] extract embeddings: 100%|██████████| 77/77 [00:03<00:00, 19.33it/s]
[NeMo I 2025-04-17 01:48:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:48:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:48:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:48:41 collections:880] Dataset successfully loaded with 9876 items and total duration provided from manifest is  1.30 hours.
[NeMo I 2025-04-17 01:48:41 collections:886] # 9876 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/155 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/155 [00:01<02:50,  1.11s/it][6/6] extract embeddings:   3%|▎         | 5/155 [00:01<00:28,  5.33it/s][6/6] extract embeddings:   6%|▌         | 9/155 [00:01<00:14,  9.99it/s][6/6] extract embeddings:   8%|▊         | 13/155 [00:01<00:09, 14.61it/s][6/6] extract embeddings:  11%|█         | 17/155 [00:01<00:07, 19.00it/s][6/6] extract embeddings:  14%|█▎        | 21/155 [00:01<00:06, 22.01it/s][6/6] extract embeddings:  16%|█▌        | 25/155 [00:01<00:05, 24.28it/s][6/6] extract embeddings:  19%|█▊        | 29/155 [00:01<00:04, 26.44it/s][6/6] extract embeddings:  21%|██▏       | 33/155 [00:02<00:04, 28.29it/s][6/6] extract embeddings:  24%|██▍       | 37/155 [00:02<00:04, 28.69it/s][6/6] extract embeddings:  26%|██▋       | 41/155 [00:02<00:03, 29.52it/s][6/6] extract embeddings:  29%|██▉       | 45/155 [00:02<00:03, 30.15it/s][6/6] extract embeddings:  32%|███▏      | 49/155 [00:02<00:03, 30.00it/s][6/6] extract embeddings:  34%|███▍      | 53/155 [00:02<00:03, 30.81it/s][6/6] extract embeddings:  37%|███▋      | 57/155 [00:02<00:03, 31.62it/s][6/6] extract embeddings:  39%|███▉      | 61/155 [00:02<00:02, 31.68it/s][6/6] extract embeddings:  42%|████▏     | 65/155 [00:03<00:02, 31.94it/s][6/6] extract embeddings:  45%|████▍     | 69/155 [00:03<00:02, 32.38it/s][6/6] extract embeddings:  47%|████▋     | 73/155 [00:03<00:02, 32.63it/s][6/6] extract embeddings:  50%|████▉     | 77/155 [00:03<00:02, 31.69it/s][6/6] extract embeddings:  52%|█████▏    | 81/155 [00:03<00:02, 31.27it/s][6/6] extract embeddings:  55%|█████▍    | 85/155 [00:03<00:02, 30.90it/s][6/6] extract embeddings:  57%|█████▋    | 89/155 [00:03<00:02, 31.41it/s][6/6] extract embeddings:  60%|██████    | 93/155 [00:03<00:01, 31.98it/s][6/6] extract embeddings:  63%|██████▎   | 97/155 [00:04<00:01, 32.32it/s][6/6] extract embeddings:  65%|██████▌   | 101/155 [00:04<00:01, 31.88it/s][6/6] extract embeddings:  68%|██████▊   | 105/155 [00:04<00:01, 32.18it/s][6/6] extract embeddings:  70%|███████   | 109/155 [00:04<00:01, 31.79it/s][6/6] extract embeddings:  73%|███████▎  | 113/155 [00:04<00:01, 32.36it/s][6/6] extract embeddings:  75%|███████▌  | 117/155 [00:04<00:01, 32.62it/s][6/6] extract embeddings:  78%|███████▊  | 121/155 [00:04<00:01, 32.28it/s][6/6] extract embeddings:  81%|████████  | 125/155 [00:04<00:00, 32.82it/s][6/6] extract embeddings:  83%|████████▎ | 129/155 [00:05<00:00, 33.11it/s][6/6] extract embeddings:  86%|████████▌ | 133/155 [00:05<00:00, 32.22it/s][6/6] extract embeddings:  88%|████████▊ | 137/155 [00:05<00:00, 32.17it/s][6/6] extract embeddings:  91%|█████████ | 141/155 [00:05<00:00, 32.91it/s][6/6] extract embeddings:  94%|█████████▎| 145/155 [00:05<00:00, 31.62it/s][6/6] extract embeddings:  96%|█████████▌| 149/155 [00:05<00:00, 31.91it/s][6/6] extract embeddings:  99%|█████████▊| 153/155 [00:05<00:00, 33.21it/s][6/6] extract embeddings: 100%|██████████| 155/155 [00:05<00:00, 26.35it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.10it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.82it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.55it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.65it/s]
[NeMo I 2025-04-17 01:48:49 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:48:50 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              50.923225   444.120  ...  13.450055  3.028473
    Harker-ES                       45.836883  2178.782  ...  38.263937  1.756208
    Harker-MN                       54.086690   366.767  ...  26.884011  7.329997
    Longfellow-Block-1              40.402108   492.417  ...   7.600959  1.543602
    TOTAL                           46.586011  3482.086  ...  86.198961  2.475498
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:48:50 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0519 | MISS: 0.3892 | CER: 0.0248 | DER: 0.4659 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.50, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.5, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.69s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.86s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:49:02 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:49:02 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:49:02 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:49:02 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:49:02 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:49:02 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:49:02 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:49:02 features:305] PADDING: 16
[NeMo I 2025-04-17 01:49:03 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:49:03 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:49:03 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:49:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:49:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:03 collections:880] Dataset successfully loaded with 2059 items and total duration provided from manifest is  0.91 hours.
[NeMo I 2025-04-17 01:49:03 collections:886] # 2059 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:03,  1.98s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.47it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.64it/s][1/6] extract embeddings:  27%|██▋       | 9/33 [00:02<00:03,  6.26it/s][1/6] extract embeddings:  33%|███▎      | 11/33 [00:02<00:02,  7.87it/s][1/6] extract embeddings:  39%|███▉      | 13/33 [00:02<00:02,  9.63it/s][1/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 11.08it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 12.83it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 14.97it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:03<00:00, 16.03it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 16.61it/s][1/6] extract embeddings:  82%|████████▏ | 27/33 [00:03<00:00, 17.26it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 17.13it/s][1/6] extract embeddings:  94%|█████████▍| 31/33 [00:03<00:00, 17.31it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  9.01it/s]
[NeMo I 2025-04-17 01:49:06 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:49:06 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:06 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:06 collections:880] Dataset successfully loaded with 2290 items and total duration provided from manifest is  0.96 hours.
[NeMo I 2025-04-17 01:49:06 collections:886] # 2290 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:48,  1.37s/it][2/6] extract embeddings:  11%|█         | 4/36 [00:01<00:09,  3.33it/s][2/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  6.02it/s][2/6] extract embeddings:  25%|██▌       | 9/36 [00:01<00:03,  7.78it/s][2/6] extract embeddings:  31%|███       | 11/36 [00:01<00:02,  9.61it/s][2/6] extract embeddings:  36%|███▌      | 13/36 [00:02<00:02, 11.12it/s][2/6] extract embeddings:  42%|████▏     | 15/36 [00:02<00:01, 12.86it/s][2/6] extract embeddings:  47%|████▋     | 17/36 [00:02<00:01, 14.18it/s][2/6] extract embeddings:  53%|█████▎    | 19/36 [00:02<00:01, 15.13it/s][2/6] extract embeddings:  58%|█████▊    | 21/36 [00:02<00:00, 16.04it/s][2/6] extract embeddings:  67%|██████▋   | 24/36 [00:02<00:00, 17.37it/s][2/6] extract embeddings:  75%|███████▌  | 27/36 [00:02<00:00, 18.27it/s][2/6] extract embeddings:  83%|████████▎ | 30/36 [00:02<00:00, 18.61it/s][2/6] extract embeddings:  89%|████████▉ | 32/36 [00:03<00:00, 18.30it/s][2/6] extract embeddings:  97%|█████████▋| 35/36 [00:03<00:00, 19.18it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 11.20it/s]
[NeMo I 2025-04-17 01:49:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:49:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:10 collections:880] Dataset successfully loaded with 2649 items and total duration provided from manifest is  1.01 hours.
[NeMo I 2025-04-17 01:49:10 collections:886] # 2649 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:46,  1.12s/it][3/6] extract embeddings:  10%|▉         | 4/42 [00:01<00:09,  4.02it/s][3/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:04,  7.13it/s][3/6] extract embeddings:  24%|██▍       | 10/42 [00:01<00:03, 10.10it/s][3/6] extract embeddings:  31%|███       | 13/42 [00:01<00:02, 12.68it/s][3/6] extract embeddings:  38%|███▊      | 16/42 [00:01<00:01, 14.85it/s][3/6] extract embeddings:  45%|████▌     | 19/42 [00:01<00:01, 16.32it/s][3/6] extract embeddings:  52%|█████▏    | 22/42 [00:02<00:01, 18.00it/s][3/6] extract embeddings:  60%|█████▉    | 25/42 [00:02<00:00, 18.19it/s][3/6] extract embeddings:  67%|██████▋   | 28/42 [00:02<00:00, 18.61it/s][3/6] extract embeddings:  74%|███████▍  | 31/42 [00:02<00:00, 18.82it/s][3/6] extract embeddings:  81%|████████  | 34/42 [00:02<00:00, 19.61it/s][3/6] extract embeddings:  88%|████████▊ | 37/42 [00:02<00:00, 18.98it/s][3/6] extract embeddings:  95%|█████████▌| 40/42 [00:03<00:00, 19.10it/s][3/6] extract embeddings: 100%|██████████| 42/42 [00:03<00:00, 13.46it/s]
[NeMo I 2025-04-17 01:49:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:49:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:13 collections:880] Dataset successfully loaded with 3328 items and total duration provided from manifest is  1.08 hours.
[NeMo I 2025-04-17 01:49:13 collections:886] # 3328 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/52 [00:01<00:59,  1.16s/it][4/6] extract embeddings:   8%|▊         | 4/52 [00:01<00:12,  3.95it/s][4/6] extract embeddings:  13%|█▎        | 7/52 [00:01<00:06,  7.10it/s][4/6] extract embeddings:  19%|█▉        | 10/52 [00:01<00:04, 10.05it/s][4/6] extract embeddings:  25%|██▌       | 13/52 [00:01<00:03, 12.45it/s][4/6] extract embeddings:  31%|███       | 16/52 [00:01<00:02, 14.90it/s][4/6] extract embeddings:  37%|███▋      | 19/52 [00:01<00:01, 17.19it/s][4/6] extract embeddings:  42%|████▏     | 22/52 [00:02<00:01, 18.52it/s][4/6] extract embeddings:  48%|████▊     | 25/52 [00:02<00:01, 19.88it/s][4/6] extract embeddings:  54%|█████▍    | 28/52 [00:02<00:01, 21.31it/s][4/6] extract embeddings:  60%|█████▉    | 31/52 [00:02<00:00, 21.69it/s][4/6] extract embeddings:  65%|██████▌   | 34/52 [00:02<00:00, 22.03it/s][4/6] extract embeddings:  71%|███████   | 37/52 [00:02<00:00, 23.08it/s][4/6] extract embeddings:  77%|███████▋  | 40/52 [00:02<00:00, 21.47it/s][4/6] extract embeddings:  83%|████████▎ | 43/52 [00:03<00:00, 22.20it/s][4/6] extract embeddings:  88%|████████▊ | 46/52 [00:03<00:00, 22.02it/s][4/6] extract embeddings:  94%|█████████▍| 49/52 [00:03<00:00, 22.59it/s][4/6] extract embeddings: 100%|██████████| 52/52 [00:03<00:00, 22.80it/s][4/6] extract embeddings: 100%|██████████| 52/52 [00:03<00:00, 15.20it/s]
[NeMo I 2025-04-17 01:49:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:49:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:17 collections:880] Dataset successfully loaded with 4848 items and total duration provided from manifest is  1.17 hours.
[NeMo I 2025-04-17 01:49:17 collections:886] # 4848 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/76 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/76 [00:01<01:24,  1.13s/it][5/6] extract embeddings:   5%|▌         | 4/76 [00:01<00:17,  4.14it/s][5/6] extract embeddings:   9%|▉         | 7/76 [00:01<00:09,  7.50it/s][5/6] extract embeddings:  13%|█▎        | 10/76 [00:01<00:06, 10.65it/s][5/6] extract embeddings:  17%|█▋        | 13/76 [00:01<00:04, 13.65it/s][5/6] extract embeddings:  21%|██        | 16/76 [00:01<00:03, 16.59it/s][5/6] extract embeddings:  26%|██▋       | 20/76 [00:01<00:02, 20.13it/s][5/6] extract embeddings:  30%|███       | 23/76 [00:01<00:02, 21.55it/s][5/6] extract embeddings:  34%|███▍      | 26/76 [00:02<00:02, 21.59it/s][5/6] extract embeddings:  38%|███▊      | 29/76 [00:02<00:02, 22.90it/s][5/6] extract embeddings:  42%|████▏     | 32/76 [00:02<00:01, 23.97it/s][5/6] extract embeddings:  46%|████▌     | 35/76 [00:02<00:01, 24.14it/s][5/6] extract embeddings:  50%|█████     | 38/76 [00:02<00:01, 23.83it/s][5/6] extract embeddings:  54%|█████▍    | 41/76 [00:02<00:01, 24.40it/s][5/6] extract embeddings:  58%|█████▊    | 44/76 [00:02<00:01, 25.09it/s][5/6] extract embeddings:  62%|██████▏   | 47/76 [00:02<00:01, 25.04it/s][5/6] extract embeddings:  66%|██████▌   | 50/76 [00:03<00:01, 25.81it/s][5/6] extract embeddings:  70%|██████▉   | 53/76 [00:03<00:00, 26.53it/s][5/6] extract embeddings:  74%|███████▎  | 56/76 [00:03<00:00, 25.95it/s][5/6] extract embeddings:  78%|███████▊  | 59/76 [00:03<00:00, 25.87it/s][5/6] extract embeddings:  82%|████████▏ | 62/76 [00:03<00:00, 25.18it/s][5/6] extract embeddings:  86%|████████▌ | 65/76 [00:03<00:00, 26.21it/s][5/6] extract embeddings:  91%|█████████ | 69/76 [00:03<00:00, 27.43it/s][5/6] extract embeddings:  95%|█████████▍| 72/76 [00:03<00:00, 27.69it/s][5/6] extract embeddings:  99%|█████████▊| 75/76 [00:03<00:00, 27.75it/s][5/6] extract embeddings: 100%|██████████| 76/76 [00:04<00:00, 18.92it/s]
[NeMo I 2025-04-17 01:49:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:49:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:21 collections:880] Dataset successfully loaded with 9746 items and total duration provided from manifest is  1.29 hours.
[NeMo I 2025-04-17 01:49:21 collections:886] # 9746 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/153 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/153 [00:01<03:02,  1.20s/it][6/6] extract embeddings:   3%|▎         | 5/153 [00:01<00:30,  4.87it/s][6/6] extract embeddings:   6%|▌         | 9/153 [00:01<00:15,  9.14it/s][6/6] extract embeddings:   8%|▊         | 13/153 [00:01<00:10, 13.10it/s][6/6] extract embeddings:  11%|█         | 17/153 [00:01<00:08, 16.78it/s][6/6] extract embeddings:  14%|█▎        | 21/153 [00:01<00:06, 20.41it/s][6/6] extract embeddings:  16%|█▋        | 25/153 [00:01<00:05, 23.15it/s][6/6] extract embeddings:  19%|█▉        | 29/153 [00:02<00:04, 26.25it/s][6/6] extract embeddings:  22%|██▏       | 33/153 [00:02<00:04, 27.57it/s][6/6] extract embeddings:  24%|██▍       | 37/153 [00:02<00:03, 29.50it/s][6/6] extract embeddings:  27%|██▋       | 41/153 [00:02<00:03, 30.20it/s][6/6] extract embeddings:  29%|██▉       | 45/153 [00:02<00:03, 30.33it/s][6/6] extract embeddings:  32%|███▏      | 49/153 [00:02<00:03, 31.61it/s][6/6] extract embeddings:  35%|███▍      | 53/153 [00:02<00:03, 31.91it/s][6/6] extract embeddings:  37%|███▋      | 57/153 [00:02<00:02, 32.72it/s][6/6] extract embeddings:  40%|███▉      | 61/153 [00:03<00:02, 31.36it/s][6/6] extract embeddings:  42%|████▏     | 65/153 [00:03<00:02, 31.92it/s][6/6] extract embeddings:  45%|████▌     | 69/153 [00:03<00:02, 32.02it/s][6/6] extract embeddings:  48%|████▊     | 73/153 [00:03<00:02, 31.67it/s][6/6] extract embeddings:  50%|█████     | 77/153 [00:03<00:02, 32.27it/s][6/6] extract embeddings:  53%|█████▎    | 81/153 [00:03<00:02, 32.19it/s][6/6] extract embeddings:  56%|█████▌    | 85/153 [00:03<00:02, 32.66it/s][6/6] extract embeddings:  58%|█████▊    | 89/153 [00:03<00:01, 32.80it/s][6/6] extract embeddings:  61%|██████    | 93/153 [00:04<00:01, 32.46it/s][6/6] extract embeddings:  63%|██████▎   | 97/153 [00:04<00:01, 32.57it/s][6/6] extract embeddings:  66%|██████▌   | 101/153 [00:04<00:01, 32.57it/s][6/6] extract embeddings:  69%|██████▊   | 105/153 [00:04<00:01, 32.99it/s][6/6] extract embeddings:  71%|███████   | 109/153 [00:04<00:01, 32.99it/s][6/6] extract embeddings:  74%|███████▍  | 113/153 [00:04<00:01, 31.75it/s][6/6] extract embeddings:  76%|███████▋  | 117/153 [00:04<00:01, 32.93it/s][6/6] extract embeddings:  79%|███████▉  | 121/153 [00:04<00:00, 32.86it/s][6/6] extract embeddings:  82%|████████▏ | 125/153 [00:05<00:00, 33.18it/s][6/6] extract embeddings:  84%|████████▍ | 129/153 [00:05<00:00, 31.76it/s][6/6] extract embeddings:  87%|████████▋ | 133/153 [00:05<00:00, 32.47it/s][6/6] extract embeddings:  90%|████████▉ | 137/153 [00:05<00:00, 32.49it/s][6/6] extract embeddings:  92%|█████████▏| 141/153 [00:05<00:00, 31.67it/s][6/6] extract embeddings:  95%|█████████▍| 145/153 [00:05<00:00, 32.29it/s][6/6] extract embeddings:  97%|█████████▋| 149/153 [00:05<00:00, 32.92it/s][6/6] extract embeddings: 100%|██████████| 153/153 [00:05<00:00, 32.80it/s][6/6] extract embeddings: 100%|██████████| 153/153 [00:05<00:00, 25.86it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.18it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.88it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.43it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.62it/s]
[NeMo I 2025-04-17 01:49:29 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:49:30 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              50.779118   444.120  ...  11.730043  2.641188
    Harker-ES                       46.501129  2178.782  ...  36.819697  1.689921
    Harker-MN                       53.887103   366.767  ...  25.192005  6.868667
    Longfellow-Block-1              41.124914   492.417  ...   7.178996  1.457910
    TOTAL                           47.064450  3482.086  ...  80.920742  2.323916
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:49:30 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0510 | MISS: 0.3964 | CER: 0.0232 | DER: 0.4706 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.55, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.55, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.76s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:49:41 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:49:41 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:49:41 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:49:41 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:49:41 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:49:41 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:49:41 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:49:41 features:305] PADDING: 16
[NeMo I 2025-04-17 01:49:42 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:49:42 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:49:42 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:49:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:49:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:42 collections:880] Dataset successfully loaded with 2051 items and total duration provided from manifest is  0.89 hours.
[NeMo I 2025-04-17 01:49:42 collections:886] # 2051 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:02,  1.94s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.51it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.76it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.05it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  8.47it/s][1/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 10.13it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 12.67it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:01, 13.79it/s][1/6] extract embeddings:  64%|██████▎   | 21/33 [00:02<00:00, 14.76it/s][1/6] extract embeddings:  73%|███████▎  | 24/33 [00:03<00:00, 16.33it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 16.97it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 16.92it/s][1/6] extract embeddings:  91%|█████████ | 30/33 [00:03<00:00, 17.34it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 17.82it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  9.16it/s]
[NeMo I 2025-04-17 01:49:46 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:49:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:46 collections:880] Dataset successfully loaded with 2275 items and total duration provided from manifest is  0.93 hours.
[NeMo I 2025-04-17 01:49:46 collections:886] # 2275 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:48,  1.39s/it][2/6] extract embeddings:  11%|█         | 4/36 [00:01<00:09,  3.30it/s][2/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  6.02it/s][2/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:03,  8.66it/s][2/6] extract embeddings:  33%|███▎      | 12/36 [00:01<00:02, 10.26it/s][2/6] extract embeddings:  42%|████▏     | 15/36 [00:02<00:01, 12.39it/s][2/6] extract embeddings:  50%|█████     | 18/36 [00:02<00:01, 14.50it/s][2/6] extract embeddings:  58%|█████▊    | 21/36 [00:02<00:00, 16.06it/s][2/6] extract embeddings:  67%|██████▋   | 24/36 [00:02<00:00, 17.38it/s][2/6] extract embeddings:  72%|███████▏  | 26/36 [00:02<00:00, 17.35it/s][2/6] extract embeddings:  78%|███████▊  | 28/36 [00:02<00:00, 17.72it/s][2/6] extract embeddings:  83%|████████▎ | 30/36 [00:02<00:00, 18.09it/s][2/6] extract embeddings:  89%|████████▉ | 32/36 [00:02<00:00, 18.12it/s][2/6] extract embeddings:  97%|█████████▋| 35/36 [00:03<00:00, 18.76it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 11.33it/s]
[NeMo I 2025-04-17 01:49:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:49:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:49 collections:880] Dataset successfully loaded with 2621 items and total duration provided from manifest is  0.99 hours.
[NeMo I 2025-04-17 01:49:49 collections:886] # 2621 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:45,  1.13s/it][3/6] extract embeddings:  10%|▉         | 4/41 [00:01<00:09,  3.99it/s][3/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:04,  7.11it/s][3/6] extract embeddings:  22%|██▏       | 9/41 [00:01<00:03,  8.98it/s][3/6] extract embeddings:  27%|██▋       | 11/41 [00:01<00:02, 10.94it/s][3/6] extract embeddings:  34%|███▍      | 14/41 [00:01<00:01, 13.69it/s][3/6] extract embeddings:  41%|████▏     | 17/41 [00:01<00:01, 15.74it/s][3/6] extract embeddings:  49%|████▉     | 20/41 [00:02<00:01, 17.75it/s][3/6] extract embeddings:  56%|█████▌    | 23/41 [00:02<00:00, 18.94it/s][3/6] extract embeddings:  63%|██████▎   | 26/41 [00:02<00:00, 19.52it/s][3/6] extract embeddings:  71%|███████   | 29/41 [00:02<00:00, 19.82it/s][3/6] extract embeddings:  78%|███████▊  | 32/41 [00:02<00:00, 19.72it/s][3/6] extract embeddings:  85%|████████▌ | 35/41 [00:02<00:00, 19.88it/s][3/6] extract embeddings:  93%|█████████▎| 38/41 [00:02<00:00, 20.28it/s][3/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 20.56it/s][3/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 13.40it/s]
[NeMo I 2025-04-17 01:49:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:49:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:52 collections:880] Dataset successfully loaded with 3278 items and total duration provided from manifest is  1.05 hours.
[NeMo I 2025-04-17 01:49:52 collections:886] # 3278 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/52 [00:01<00:57,  1.13s/it][4/6] extract embeddings:   8%|▊         | 4/52 [00:01<00:11,  4.03it/s][4/6] extract embeddings:  13%|█▎        | 7/52 [00:01<00:06,  7.22it/s][4/6] extract embeddings:  19%|█▉        | 10/52 [00:01<00:03, 10.50it/s][4/6] extract embeddings:  25%|██▌       | 13/52 [00:01<00:02, 13.23it/s][4/6] extract embeddings:  31%|███       | 16/52 [00:01<00:02, 15.53it/s][4/6] extract embeddings:  37%|███▋      | 19/52 [00:01<00:01, 17.78it/s][4/6] extract embeddings:  42%|████▏     | 22/52 [00:02<00:01, 19.45it/s][4/6] extract embeddings:  48%|████▊     | 25/52 [00:02<00:01, 20.80it/s][4/6] extract embeddings:  54%|█████▍    | 28/52 [00:02<00:01, 21.30it/s][4/6] extract embeddings:  60%|█████▉    | 31/52 [00:02<00:00, 21.89it/s][4/6] extract embeddings:  65%|██████▌   | 34/52 [00:02<00:00, 22.59it/s][4/6] extract embeddings:  71%|███████   | 37/52 [00:02<00:00, 22.70it/s][4/6] extract embeddings:  77%|███████▋  | 40/52 [00:02<00:00, 22.94it/s][4/6] extract embeddings:  83%|████████▎ | 43/52 [00:02<00:00, 23.25it/s][4/6] extract embeddings:  88%|████████▊ | 46/52 [00:03<00:00, 23.69it/s][4/6] extract embeddings:  94%|█████████▍| 49/52 [00:03<00:00, 23.71it/s][4/6] extract embeddings: 100%|██████████| 52/52 [00:03<00:00, 24.61it/s][4/6] extract embeddings: 100%|██████████| 52/52 [00:03<00:00, 15.80it/s]
[NeMo I 2025-04-17 01:49:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:49:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:49:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:49:56 collections:880] Dataset successfully loaded with 4763 items and total duration provided from manifest is  1.14 hours.
[NeMo I 2025-04-17 01:49:56 collections:886] # 4763 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/75 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/75 [00:01<01:22,  1.11s/it][5/6] extract embeddings:   7%|▋         | 5/75 [00:01<00:13,  5.13it/s][5/6] extract embeddings:  11%|█         | 8/75 [00:01<00:07,  8.39it/s][5/6] extract embeddings:  15%|█▍        | 11/75 [00:01<00:05, 11.56it/s][5/6] extract embeddings:  19%|█▊        | 14/75 [00:01<00:04, 14.44it/s][5/6] extract embeddings:  23%|██▎       | 17/75 [00:01<00:03, 17.49it/s][5/6] extract embeddings:  27%|██▋       | 20/75 [00:01<00:02, 19.65it/s][5/6] extract embeddings:  31%|███       | 23/75 [00:01<00:02, 21.83it/s][5/6] extract embeddings:  35%|███▍      | 26/75 [00:02<00:02, 22.49it/s][5/6] extract embeddings:  39%|███▊      | 29/75 [00:02<00:01, 23.66it/s][5/6] extract embeddings:  43%|████▎     | 32/75 [00:02<00:01, 24.64it/s][5/6] extract embeddings:  47%|████▋     | 35/75 [00:02<00:01, 25.41it/s][5/6] extract embeddings:  51%|█████     | 38/75 [00:02<00:01, 26.36it/s][5/6] extract embeddings:  55%|█████▍    | 41/75 [00:02<00:01, 25.85it/s][5/6] extract embeddings:  59%|█████▊    | 44/75 [00:02<00:01, 25.29it/s][5/6] extract embeddings:  63%|██████▎   | 47/75 [00:02<00:01, 26.39it/s][5/6] extract embeddings:  67%|██████▋   | 50/75 [00:02<00:00, 26.62it/s][5/6] extract embeddings:  71%|███████   | 53/75 [00:03<00:00, 27.14it/s][5/6] extract embeddings:  75%|███████▍  | 56/75 [00:03<00:00, 26.75it/s][5/6] extract embeddings:  79%|███████▊  | 59/75 [00:03<00:00, 26.43it/s][5/6] extract embeddings:  83%|████████▎ | 62/75 [00:03<00:00, 25.98it/s][5/6] extract embeddings:  87%|████████▋ | 65/75 [00:03<00:00, 25.80it/s][5/6] extract embeddings:  91%|█████████ | 68/75 [00:03<00:00, 26.28it/s][5/6] extract embeddings:  95%|█████████▍| 71/75 [00:03<00:00, 26.24it/s][5/6] extract embeddings:  99%|█████████▊| 74/75 [00:03<00:00, 26.88it/s][5/6] extract embeddings: 100%|██████████| 75/75 [00:03<00:00, 19.24it/s]
[NeMo I 2025-04-17 01:50:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:50:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:50:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:50:00 collections:880] Dataset successfully loaded with 9569 items and total duration provided from manifest is  1.26 hours.
[NeMo I 2025-04-17 01:50:00 collections:886] # 9569 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/150 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/150 [00:01<03:23,  1.36s/it][6/6] extract embeddings:   3%|▎         | 5/150 [00:01<00:32,  4.45it/s][6/6] extract embeddings:   6%|▌         | 9/150 [00:01<00:16,  8.47it/s][6/6] extract embeddings:   9%|▊         | 13/150 [00:01<00:10, 12.53it/s][6/6] extract embeddings:  11%|█         | 16/150 [00:01<00:08, 15.40it/s][6/6] extract embeddings:  13%|█▎        | 20/150 [00:01<00:06, 19.63it/s][6/6] extract embeddings:  16%|█▌        | 24/150 [00:02<00:05, 22.91it/s][6/6] extract embeddings:  19%|█▊        | 28/150 [00:02<00:04, 24.57it/s][6/6] extract embeddings:  21%|██▏       | 32/150 [00:02<00:04, 25.64it/s][6/6] extract embeddings:  24%|██▍       | 36/150 [00:02<00:04, 26.59it/s][6/6] extract embeddings:  27%|██▋       | 40/150 [00:02<00:03, 28.64it/s][6/6] extract embeddings:  29%|██▉       | 44/150 [00:02<00:03, 29.94it/s][6/6] extract embeddings:  32%|███▏      | 48/150 [00:02<00:03, 29.59it/s][6/6] extract embeddings:  35%|███▍      | 52/150 [00:02<00:03, 28.93it/s][6/6] extract embeddings:  37%|███▋      | 56/150 [00:03<00:03, 28.96it/s][6/6] extract embeddings:  40%|████      | 60/150 [00:03<00:03, 29.95it/s][6/6] extract embeddings:  43%|████▎     | 64/150 [00:03<00:02, 30.95it/s][6/6] extract embeddings:  45%|████▌     | 68/150 [00:03<00:02, 31.46it/s][6/6] extract embeddings:  48%|████▊     | 72/150 [00:03<00:02, 32.14it/s][6/6] extract embeddings:  51%|█████     | 76/150 [00:03<00:02, 30.27it/s][6/6] extract embeddings:  53%|█████▎    | 80/150 [00:03<00:02, 31.92it/s][6/6] extract embeddings:  56%|█████▌    | 84/150 [00:03<00:02, 32.64it/s][6/6] extract embeddings:  59%|█████▊    | 88/150 [00:04<00:01, 32.46it/s][6/6] extract embeddings:  61%|██████▏   | 92/150 [00:04<00:01, 32.37it/s][6/6] extract embeddings:  64%|██████▍   | 96/150 [00:04<00:01, 32.24it/s][6/6] extract embeddings:  67%|██████▋   | 100/150 [00:04<00:01, 32.48it/s][6/6] extract embeddings:  69%|██████▉   | 104/150 [00:04<00:01, 33.02it/s][6/6] extract embeddings:  72%|███████▏  | 108/150 [00:04<00:01, 32.78it/s][6/6] extract embeddings:  75%|███████▍  | 112/150 [00:04<00:01, 32.46it/s][6/6] extract embeddings:  77%|███████▋  | 116/150 [00:04<00:01, 33.17it/s][6/6] extract embeddings:  80%|████████  | 120/150 [00:05<00:00, 32.93it/s][6/6] extract embeddings:  83%|████████▎ | 124/150 [00:05<00:00, 32.82it/s][6/6] extract embeddings:  85%|████████▌ | 128/150 [00:05<00:00, 31.83it/s][6/6] extract embeddings:  88%|████████▊ | 132/150 [00:05<00:00, 32.45it/s][6/6] extract embeddings:  91%|█████████ | 136/150 [00:05<00:00, 31.75it/s][6/6] extract embeddings:  93%|█████████▎| 140/150 [00:05<00:00, 32.16it/s][6/6] extract embeddings:  96%|█████████▌| 144/150 [00:05<00:00, 32.19it/s][6/6] extract embeddings:  99%|█████████▊| 148/150 [00:05<00:00, 32.89it/s][6/6] extract embeddings: 100%|██████████| 150/150 [00:06<00:00, 24.88it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.88it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.79it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.35it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.50it/s]
[NeMo I 2025-04-17 01:50:08 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:50:09 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              51.767567   444.120  ...  12.050061  2.713244
    Harker-ES                       47.793980  2178.782  ...  47.419358  2.176416
    Harker-MN                       54.055879   366.767  ...  24.574012  6.700170
    Longfellow-Block-1              41.957533   492.417  ...   6.424992  1.304787
    TOTAL                           48.134994  3482.086  ...  90.468421  2.598110
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:50:09 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0501 | MISS: 0.4053 | CER: 0.0260 | DER: 0.4813 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.67s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.84s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.18s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:50:21 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:50:21 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:50:21 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:50:21 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:50:21 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:50:21 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:50:21 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:50:21 features:305] PADDING: 16
[NeMo I 2025-04-17 01:50:21 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:50:21 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:50:21 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:50:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:50:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:50:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:50:21 collections:880] Dataset successfully loaded with 2044 items and total duration provided from manifest is  0.86 hours.
[NeMo I 2025-04-17 01:50:21 collections:886] # 2044 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:03,  2.04s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.41it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.59it/s][1/6] extract embeddings:  28%|██▊       | 9/32 [00:02<00:03,  6.16it/s][1/6] extract embeddings:  34%|███▍      | 11/32 [00:02<00:02,  7.84it/s][1/6] extract embeddings:  44%|████▍     | 14/32 [00:02<00:01, 10.59it/s][1/6] extract embeddings:  53%|█████▎    | 17/32 [00:02<00:01, 13.16it/s][1/6] extract embeddings:  62%|██████▎   | 20/32 [00:02<00:00, 15.04it/s][1/6] extract embeddings:  72%|███████▏  | 23/32 [00:03<00:00, 16.69it/s][1/6] extract embeddings:  81%|████████▏ | 26/32 [00:03<00:00, 17.05it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.63it/s][1/6] extract embeddings:  94%|█████████▍| 30/32 [00:03<00:00, 17.55it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  8.94it/s]
[NeMo I 2025-04-17 01:50:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:50:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:50:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:50:25 collections:880] Dataset successfully loaded with 2260 items and total duration provided from manifest is  0.91 hours.
[NeMo I 2025-04-17 01:50:25 collections:886] # 2260 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:48,  1.38s/it][2/6] extract embeddings:  11%|█         | 4/36 [00:01<00:09,  3.34it/s][2/6] extract embeddings:  17%|█▋        | 6/36 [00:01<00:05,  5.17it/s][2/6] extract embeddings:  22%|██▏       | 8/36 [00:01<00:03,  7.15it/s][2/6] extract embeddings:  31%|███       | 11/36 [00:01<00:02, 10.22it/s][2/6] extract embeddings:  36%|███▌      | 13/36 [00:01<00:01, 11.89it/s][2/6] extract embeddings:  44%|████▍     | 16/36 [00:02<00:01, 14.38it/s][2/6] extract embeddings:  50%|█████     | 18/36 [00:02<00:01, 15.53it/s][2/6] extract embeddings:  58%|█████▊    | 21/36 [00:02<00:00, 16.70it/s][2/6] extract embeddings:  67%|██████▋   | 24/36 [00:02<00:00, 18.20it/s][2/6] extract embeddings:  75%|███████▌  | 27/36 [00:02<00:00, 18.64it/s][2/6] extract embeddings:  83%|████████▎ | 30/36 [00:02<00:00, 18.72it/s][2/6] extract embeddings:  92%|█████████▏| 33/36 [00:02<00:00, 18.98it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 20.79it/s][2/6] extract embeddings: 100%|██████████| 36/36 [00:03<00:00, 11.51it/s]
[NeMo I 2025-04-17 01:50:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:50:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:50:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:50:28 collections:880] Dataset successfully loaded with 2591 items and total duration provided from manifest is  0.96 hours.
[NeMo I 2025-04-17 01:50:28 collections:886] # 2591 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:45,  1.13s/it][3/6] extract embeddings:  10%|▉         | 4/41 [00:01<00:09,  3.98it/s][3/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:04,  7.02it/s][3/6] extract embeddings:  24%|██▍       | 10/41 [00:01<00:03, 10.13it/s][3/6] extract embeddings:  32%|███▏      | 13/41 [00:01<00:02, 12.44it/s][3/6] extract embeddings:  37%|███▋      | 15/41 [00:01<00:01, 13.61it/s][3/6] extract embeddings:  44%|████▍     | 18/41 [00:01<00:01, 15.91it/s][3/6] extract embeddings:  51%|█████     | 21/41 [00:02<00:01, 17.89it/s][3/6] extract embeddings:  59%|█████▊    | 24/41 [00:02<00:00, 18.93it/s][3/6] extract embeddings:  66%|██████▌   | 27/41 [00:02<00:00, 19.66it/s][3/6] extract embeddings:  73%|███████▎  | 30/41 [00:02<00:00, 19.93it/s][3/6] extract embeddings:  80%|████████  | 33/41 [00:02<00:00, 20.40it/s][3/6] extract embeddings:  88%|████████▊ | 36/41 [00:02<00:00, 20.05it/s][3/6] extract embeddings:  95%|█████████▌| 39/41 [00:02<00:00, 20.01it/s][3/6] extract embeddings: 100%|██████████| 41/41 [00:03<00:00, 13.54it/s]
[NeMo I 2025-04-17 01:50:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:50:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:50:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:50:32 collections:880] Dataset successfully loaded with 3232 items and total duration provided from manifest is  1.03 hours.
[NeMo I 2025-04-17 01:50:32 collections:886] # 3232 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/51 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/51 [00:01<00:59,  1.19s/it][4/6] extract embeddings:   8%|▊         | 4/51 [00:01<00:12,  3.92it/s][4/6] extract embeddings:  14%|█▎        | 7/51 [00:01<00:06,  7.06it/s][4/6] extract embeddings:  20%|█▉        | 10/51 [00:01<00:04, 10.23it/s][4/6] extract embeddings:  25%|██▌       | 13/51 [00:01<00:02, 13.13it/s][4/6] extract embeddings:  31%|███▏      | 16/51 [00:01<00:02, 15.78it/s][4/6] extract embeddings:  37%|███▋      | 19/51 [00:01<00:01, 17.31it/s][4/6] extract embeddings:  43%|████▎     | 22/51 [00:02<00:01, 19.33it/s][4/6] extract embeddings:  49%|████▉     | 25/51 [00:02<00:01, 19.97it/s][4/6] extract embeddings:  55%|█████▍    | 28/51 [00:02<00:01, 21.19it/s][4/6] extract embeddings:  61%|██████    | 31/51 [00:02<00:00, 22.13it/s][4/6] extract embeddings:  67%|██████▋   | 34/51 [00:02<00:00, 22.72it/s][4/6] extract embeddings:  73%|███████▎  | 37/51 [00:02<00:00, 22.79it/s][4/6] extract embeddings:  78%|███████▊  | 40/51 [00:02<00:00, 23.39it/s][4/6] extract embeddings:  84%|████████▍ | 43/51 [00:02<00:00, 22.18it/s][4/6] extract embeddings:  90%|█████████ | 46/51 [00:03<00:00, 22.13it/s][4/6] extract embeddings:  96%|█████████▌| 49/51 [00:03<00:00, 22.70it/s][4/6] extract embeddings: 100%|██████████| 51/51 [00:03<00:00, 15.30it/s]
[NeMo I 2025-04-17 01:50:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:50:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:50:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:50:35 collections:880] Dataset successfully loaded with 4675 items and total duration provided from manifest is  1.12 hours.
[NeMo I 2025-04-17 01:50:35 collections:886] # 4675 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/74 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/74 [00:01<01:20,  1.10s/it][5/6] extract embeddings:   5%|▌         | 4/74 [00:01<00:16,  4.20it/s][5/6] extract embeddings:   9%|▉         | 7/74 [00:01<00:08,  7.76it/s][5/6] extract embeddings:  14%|█▎        | 10/74 [00:01<00:05, 11.06it/s][5/6] extract embeddings:  18%|█▊        | 13/74 [00:01<00:04, 14.19it/s][5/6] extract embeddings:  22%|██▏       | 16/74 [00:01<00:03, 16.72it/s][5/6] extract embeddings:  26%|██▌       | 19/74 [00:01<00:02, 19.00it/s][5/6] extract embeddings:  30%|██▉       | 22/74 [00:01<00:02, 20.74it/s][5/6] extract embeddings:  34%|███▍      | 25/74 [00:02<00:02, 22.39it/s][5/6] extract embeddings:  38%|███▊      | 28/74 [00:02<00:01, 24.07it/s][5/6] extract embeddings:  42%|████▏     | 31/74 [00:02<00:01, 23.64it/s][5/6] extract embeddings:  46%|████▌     | 34/74 [00:02<00:01, 24.51it/s][5/6] extract embeddings:  50%|█████     | 37/74 [00:02<00:01, 25.47it/s][5/6] extract embeddings:  54%|█████▍    | 40/74 [00:02<00:01, 24.70it/s][5/6] extract embeddings:  58%|█████▊    | 43/74 [00:02<00:01, 25.17it/s][5/6] extract embeddings:  62%|██████▏   | 46/74 [00:02<00:01, 25.75it/s][5/6] extract embeddings:  66%|██████▌   | 49/74 [00:02<00:00, 26.58it/s][5/6] extract embeddings:  70%|███████   | 52/74 [00:03<00:00, 26.47it/s][5/6] extract embeddings:  74%|███████▍  | 55/74 [00:03<00:00, 26.59it/s][5/6] extract embeddings:  78%|███████▊  | 58/74 [00:03<00:00, 26.49it/s][5/6] extract embeddings:  82%|████████▏ | 61/74 [00:03<00:00, 26.25it/s][5/6] extract embeddings:  86%|████████▋ | 64/74 [00:03<00:00, 26.90it/s][5/6] extract embeddings:  91%|█████████ | 67/74 [00:03<00:00, 26.69it/s][5/6] extract embeddings:  95%|█████████▍| 70/74 [00:03<00:00, 27.14it/s][5/6] extract embeddings:  99%|█████████▊| 73/74 [00:03<00:00, 27.17it/s][5/6] extract embeddings: 100%|██████████| 74/74 [00:03<00:00, 19.07it/s]
[NeMo I 2025-04-17 01:50:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:50:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:50:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:50:39 collections:880] Dataset successfully loaded with 9375 items and total duration provided from manifest is  1.23 hours.
[NeMo I 2025-04-17 01:50:39 collections:886] # 9375 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/147 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/147 [00:01<02:51,  1.17s/it][6/6] extract embeddings:   3%|▎         | 5/147 [00:01<00:28,  5.07it/s][6/6] extract embeddings:   6%|▌         | 9/147 [00:01<00:14,  9.40it/s][6/6] extract embeddings:   9%|▉         | 13/147 [00:01<00:09, 13.71it/s][6/6] extract embeddings:  12%|█▏        | 17/147 [00:01<00:07, 17.70it/s][6/6] extract embeddings:  14%|█▍        | 21/147 [00:01<00:05, 21.05it/s][6/6] extract embeddings:  17%|█▋        | 25/147 [00:01<00:05, 24.23it/s][6/6] extract embeddings:  20%|█▉        | 29/147 [00:02<00:04, 26.65it/s][6/6] extract embeddings:  22%|██▏       | 33/147 [00:02<00:04, 28.17it/s][6/6] extract embeddings:  25%|██▌       | 37/147 [00:02<00:03, 28.57it/s][6/6] extract embeddings:  28%|██▊       | 41/147 [00:02<00:03, 30.83it/s][6/6] extract embeddings:  31%|███       | 45/147 [00:02<00:03, 30.60it/s][6/6] extract embeddings:  33%|███▎      | 49/147 [00:02<00:03, 29.94it/s][6/6] extract embeddings:  36%|███▌      | 53/147 [00:02<00:03, 31.31it/s][6/6] extract embeddings:  39%|███▉      | 57/147 [00:02<00:02, 31.52it/s][6/6] extract embeddings:  41%|████▏     | 61/147 [00:03<00:02, 32.20it/s][6/6] extract embeddings:  44%|████▍     | 65/147 [00:03<00:02, 32.86it/s][6/6] extract embeddings:  47%|████▋     | 69/147 [00:03<00:02, 32.30it/s][6/6] extract embeddings:  50%|████▉     | 73/147 [00:03<00:02, 31.21it/s][6/6] extract embeddings:  52%|█████▏    | 77/147 [00:03<00:02, 31.96it/s][6/6] extract embeddings:  55%|█████▌    | 81/147 [00:03<00:02, 32.05it/s][6/6] extract embeddings:  58%|█████▊    | 85/147 [00:03<00:01, 31.73it/s][6/6] extract embeddings:  61%|██████    | 89/147 [00:03<00:01, 32.52it/s][6/6] extract embeddings:  63%|██████▎   | 93/147 [00:04<00:01, 32.03it/s][6/6] extract embeddings:  66%|██████▌   | 97/147 [00:04<00:01, 32.26it/s][6/6] extract embeddings:  69%|██████▊   | 101/147 [00:04<00:01, 32.54it/s][6/6] extract embeddings:  71%|███████▏  | 105/147 [00:04<00:01, 30.05it/s][6/6] extract embeddings:  74%|███████▍  | 109/147 [00:04<00:01, 30.89it/s][6/6] extract embeddings:  77%|███████▋  | 113/147 [00:04<00:01, 30.60it/s][6/6] extract embeddings:  80%|███████▉  | 117/147 [00:04<00:00, 31.25it/s][6/6] extract embeddings:  82%|████████▏ | 121/147 [00:04<00:00, 31.37it/s][6/6] extract embeddings:  85%|████████▌ | 125/147 [00:05<00:00, 31.59it/s][6/6] extract embeddings:  88%|████████▊ | 129/147 [00:05<00:00, 32.77it/s][6/6] extract embeddings:  90%|█████████ | 133/147 [00:05<00:00, 31.75it/s][6/6] extract embeddings:  93%|█████████▎| 137/147 [00:05<00:00, 32.55it/s][6/6] extract embeddings:  96%|█████████▌| 141/147 [00:05<00:00, 32.37it/s][6/6] extract embeddings:  99%|█████████▊| 145/147 [00:05<00:00, 33.55it/s][6/6] extract embeddings: 100%|██████████| 147/147 [00:05<00:00, 25.72it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.19it/s]clustering:  50%|█████     | 2/4 [00:00<00:01,  1.98it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.58it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s]
[NeMo I 2025-04-17 01:50:47 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:50:48 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              53.160240   444.120  ...  13.585041  3.058867
    Harker-ES                       48.535222  2178.782  ...  37.402016  1.716648
    Harker-MN                       54.725793   366.767  ...  25.438001  6.935739
    Longfellow-Block-1              42.536519   492.417  ...   6.584995  1.337280
    TOTAL                           48.928865  3482.086  ...  83.010052  2.383917
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:50:48 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0490 | MISS: 0.4164 | CER: 0.0238 | DER: 0.4893 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.86s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:50:59 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:50:59 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:50:59 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:50:59 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:50:59 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:50:59 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:50:59 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:50:59 features:305] PADDING: 16
[NeMo I 2025-04-17 01:51:00 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:51:00 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:51:00 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:51:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:51:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:00 collections:880] Dataset successfully loaded with 2035 items and total duration provided from manifest is  0.83 hours.
[NeMo I 2025-04-17 01:51:00 collections:886] # 2035 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:59,  1.93s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.52it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.80it/s][1/6] extract embeddings:  28%|██▊       | 9/32 [00:02<00:03,  6.34it/s][1/6] extract embeddings:  34%|███▍      | 11/32 [00:02<00:02,  8.12it/s][1/6] extract embeddings:  44%|████▍     | 14/32 [00:02<00:01, 10.83it/s][1/6] extract embeddings:  53%|█████▎    | 17/32 [00:02<00:01, 13.20it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.42it/s][1/6] extract embeddings:  66%|██████▌   | 21/32 [00:02<00:00, 15.57it/s][1/6] extract embeddings:  75%|███████▌  | 24/32 [00:03<00:00, 16.83it/s][1/6] extract embeddings:  81%|████████▏ | 26/32 [00:03<00:00, 16.86it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.08it/s][1/6] extract embeddings:  94%|█████████▍| 30/32 [00:03<00:00, 17.53it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.14it/s]
[NeMo I 2025-04-17 01:51:03 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:51:03 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:03 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:03 collections:880] Dataset successfully loaded with 2240 items and total duration provided from manifest is  0.88 hours.
[NeMo I 2025-04-17 01:51:03 collections:886] # 2240 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:55,  1.64s/it][2/6] extract embeddings:   9%|▊         | 3/35 [00:01<00:14,  2.15it/s][2/6] extract embeddings:  17%|█▋        | 6/35 [00:01<00:06,  4.80it/s][2/6] extract embeddings:  26%|██▌       | 9/35 [00:02<00:03,  7.57it/s][2/6] extract embeddings:  34%|███▍      | 12/35 [00:02<00:02, 10.10it/s][2/6] extract embeddings:  43%|████▎     | 15/35 [00:02<00:01, 12.51it/s][2/6] extract embeddings:  51%|█████▏    | 18/35 [00:02<00:01, 14.69it/s][2/6] extract embeddings:  60%|██████    | 21/35 [00:02<00:00, 16.13it/s][2/6] extract embeddings:  69%|██████▊   | 24/35 [00:02<00:00, 17.02it/s][2/6] extract embeddings:  77%|███████▋  | 27/35 [00:02<00:00, 18.32it/s][2/6] extract embeddings:  86%|████████▌ | 30/35 [00:03<00:00, 18.41it/s][2/6] extract embeddings:  94%|█████████▍| 33/35 [00:03<00:00, 18.79it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 10.55it/s]
[NeMo I 2025-04-17 01:51:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:51:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:07 collections:880] Dataset successfully loaded with 2552 items and total duration provided from manifest is  0.93 hours.
[NeMo I 2025-04-17 01:51:07 collections:886] # 2552 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:44,  1.13s/it][3/6] extract embeddings:  10%|█         | 4/40 [00:01<00:08,  4.04it/s][3/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:04,  7.22it/s][3/6] extract embeddings:  25%|██▌       | 10/40 [00:01<00:02, 10.12it/s][3/6] extract embeddings:  32%|███▎      | 13/40 [00:01<00:02, 12.54it/s][3/6] extract embeddings:  40%|████      | 16/40 [00:01<00:01, 14.65it/s][3/6] extract embeddings:  48%|████▊     | 19/40 [00:01<00:01, 16.94it/s][3/6] extract embeddings:  55%|█████▌    | 22/40 [00:02<00:00, 18.74it/s][3/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:00, 19.38it/s][3/6] extract embeddings:  70%|███████   | 28/40 [00:02<00:00, 19.78it/s][3/6] extract embeddings:  78%|███████▊  | 31/40 [00:02<00:00, 20.46it/s][3/6] extract embeddings:  85%|████████▌ | 34/40 [00:02<00:00, 20.45it/s][3/6] extract embeddings:  92%|█████████▎| 37/40 [00:02<00:00, 21.04it/s][3/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 21.49it/s][3/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 13.66it/s]
[NeMo I 2025-04-17 01:51:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:51:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:10 collections:880] Dataset successfully loaded with 3180 items and total duration provided from manifest is  0.99 hours.
[NeMo I 2025-04-17 01:51:10 collections:886] # 3180 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/50 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/50 [00:01<00:55,  1.13s/it][4/6] extract embeddings:   8%|▊         | 4/50 [00:01<00:11,  3.99it/s][4/6] extract embeddings:  14%|█▍        | 7/50 [00:01<00:05,  7.26it/s][4/6] extract embeddings:  20%|██        | 10/50 [00:01<00:03, 10.43it/s][4/6] extract embeddings:  26%|██▌       | 13/50 [00:01<00:02, 13.33it/s][4/6] extract embeddings:  32%|███▏      | 16/50 [00:01<00:02, 15.34it/s][4/6] extract embeddings:  38%|███▊      | 19/50 [00:01<00:01, 17.14it/s][4/6] extract embeddings:  44%|████▍     | 22/50 [00:02<00:01, 18.60it/s][4/6] extract embeddings:  50%|█████     | 25/50 [00:02<00:01, 19.86it/s][4/6] extract embeddings:  56%|█████▌    | 28/50 [00:02<00:01, 20.78it/s][4/6] extract embeddings:  62%|██████▏   | 31/50 [00:02<00:00, 20.47it/s][4/6] extract embeddings:  68%|██████▊   | 34/50 [00:02<00:00, 21.60it/s][4/6] extract embeddings:  74%|███████▍  | 37/50 [00:02<00:00, 21.96it/s][4/6] extract embeddings:  80%|████████  | 40/50 [00:02<00:00, 22.26it/s][4/6] extract embeddings:  86%|████████▌ | 43/50 [00:02<00:00, 22.91it/s][4/6] extract embeddings:  92%|█████████▏| 46/50 [00:03<00:00, 23.39it/s][4/6] extract embeddings:  98%|█████████▊| 49/50 [00:03<00:00, 23.64it/s][4/6] extract embeddings: 100%|██████████| 50/50 [00:03<00:00, 15.36it/s]
[NeMo I 2025-04-17 01:51:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:51:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:13 collections:880] Dataset successfully loaded with 4576 items and total duration provided from manifest is  1.08 hours.
[NeMo I 2025-04-17 01:51:13 collections:886] # 4576 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/72 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/72 [00:01<01:18,  1.10s/it][5/6] extract embeddings:   6%|▌         | 4/72 [00:01<00:16,  4.18it/s][5/6] extract embeddings:  10%|▉         | 7/72 [00:01<00:08,  7.65it/s][5/6] extract embeddings:  14%|█▍        | 10/72 [00:01<00:05, 11.16it/s][5/6] extract embeddings:  18%|█▊        | 13/72 [00:01<00:04, 14.45it/s][5/6] extract embeddings:  22%|██▏       | 16/72 [00:01<00:03, 17.41it/s][5/6] extract embeddings:  26%|██▋       | 19/72 [00:01<00:02, 19.52it/s][5/6] extract embeddings:  31%|███       | 22/72 [00:01<00:02, 21.82it/s][5/6] extract embeddings:  35%|███▍      | 25/72 [00:01<00:02, 22.78it/s][5/6] extract embeddings:  39%|███▉      | 28/72 [00:02<00:01, 23.63it/s][5/6] extract embeddings:  44%|████▍     | 32/72 [00:02<00:01, 25.52it/s][5/6] extract embeddings:  49%|████▊     | 35/72 [00:02<00:01, 26.14it/s][5/6] extract embeddings:  53%|█████▎    | 38/72 [00:02<00:01, 26.44it/s][5/6] extract embeddings:  57%|█████▋    | 41/72 [00:02<00:01, 25.77it/s][5/6] extract embeddings:  61%|██████    | 44/72 [00:02<00:01, 25.14it/s][5/6] extract embeddings:  65%|██████▌   | 47/72 [00:02<00:01, 24.25it/s][5/6] extract embeddings:  69%|██████▉   | 50/72 [00:02<00:00, 25.59it/s][5/6] extract embeddings:  74%|███████▎  | 53/72 [00:03<00:00, 25.93it/s][5/6] extract embeddings:  78%|███████▊  | 56/72 [00:03<00:00, 25.84it/s][5/6] extract embeddings:  82%|████████▏ | 59/72 [00:03<00:00, 26.60it/s][5/6] extract embeddings:  86%|████████▌ | 62/72 [00:03<00:00, 25.87it/s][5/6] extract embeddings:  90%|█████████ | 65/72 [00:03<00:00, 26.24it/s][5/6] extract embeddings:  94%|█████████▍| 68/72 [00:03<00:00, 26.97it/s][5/6] extract embeddings:  99%|█████████▊| 71/72 [00:03<00:00, 26.37it/s][5/6] extract embeddings: 100%|██████████| 72/72 [00:03<00:00, 19.02it/s]
[NeMo I 2025-04-17 01:51:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:51:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:18 collections:880] Dataset successfully loaded with 9154 items and total duration provided from manifest is  1.20 hours.
[NeMo I 2025-04-17 01:51:18 collections:886] # 9154 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/144 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/144 [00:01<02:39,  1.12s/it][6/6] extract embeddings:   3%|▎         | 5/144 [00:01<00:26,  5.31it/s][6/6] extract embeddings:   6%|▋         | 9/144 [00:01<00:13,  9.98it/s][6/6] extract embeddings:   9%|▉         | 13/144 [00:01<00:09, 14.21it/s][6/6] extract embeddings:  12%|█▏        | 17/144 [00:01<00:06, 18.57it/s][6/6] extract embeddings:  15%|█▍        | 21/144 [00:01<00:05, 22.35it/s][6/6] extract embeddings:  17%|█▋        | 25/144 [00:01<00:04, 23.90it/s][6/6] extract embeddings:  20%|██        | 29/144 [00:01<00:04, 25.77it/s][6/6] extract embeddings:  23%|██▎       | 33/144 [00:02<00:04, 27.44it/s][6/6] extract embeddings:  26%|██▌       | 37/144 [00:02<00:03, 29.45it/s][6/6] extract embeddings:  28%|██▊       | 41/144 [00:02<00:03, 30.97it/s][6/6] extract embeddings:  31%|███▏      | 45/144 [00:02<00:03, 30.35it/s][6/6] extract embeddings:  34%|███▍      | 49/144 [00:02<00:03, 31.59it/s][6/6] extract embeddings:  37%|███▋      | 53/144 [00:02<00:02, 32.10it/s][6/6] extract embeddings:  40%|███▉      | 57/144 [00:02<00:02, 31.54it/s][6/6] extract embeddings:  42%|████▏     | 61/144 [00:02<00:02, 32.69it/s][6/6] extract embeddings:  45%|████▌     | 65/144 [00:03<00:02, 32.14it/s][6/6] extract embeddings:  48%|████▊     | 69/144 [00:03<00:02, 32.91it/s][6/6] extract embeddings:  51%|█████     | 73/144 [00:03<00:02, 32.77it/s][6/6] extract embeddings:  53%|█████▎    | 77/144 [00:03<00:02, 32.58it/s][6/6] extract embeddings:  56%|█████▋    | 81/144 [00:03<00:01, 33.11it/s][6/6] extract embeddings:  59%|█████▉    | 85/144 [00:03<00:01, 33.51it/s][6/6] extract embeddings:  62%|██████▏   | 89/144 [00:03<00:01, 33.29it/s][6/6] extract embeddings:  65%|██████▍   | 93/144 [00:03<00:01, 33.19it/s][6/6] extract embeddings:  67%|██████▋   | 97/144 [00:04<00:01, 32.01it/s][6/6] extract embeddings:  70%|███████   | 101/144 [00:04<00:01, 31.70it/s][6/6] extract embeddings:  73%|███████▎  | 105/144 [00:04<00:01, 32.65it/s][6/6] extract embeddings:  76%|███████▌  | 109/144 [00:04<00:01, 32.76it/s][6/6] extract embeddings:  78%|███████▊  | 113/144 [00:04<00:00, 32.73it/s][6/6] extract embeddings:  81%|████████▏ | 117/144 [00:04<00:00, 33.34it/s][6/6] extract embeddings:  84%|████████▍ | 121/144 [00:04<00:00, 33.68it/s][6/6] extract embeddings:  87%|████████▋ | 125/144 [00:04<00:00, 34.26it/s][6/6] extract embeddings:  90%|████████▉ | 129/144 [00:04<00:00, 33.34it/s][6/6] extract embeddings:  92%|█████████▏| 133/144 [00:05<00:00, 32.02it/s][6/6] extract embeddings:  95%|█████████▌| 137/144 [00:05<00:00, 32.82it/s][6/6] extract embeddings:  98%|█████████▊| 141/144 [00:05<00:00, 32.57it/s][6/6] extract embeddings: 100%|██████████| 144/144 [00:05<00:00, 26.23it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.16it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.97it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.54it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.72it/s]
[NeMo I 2025-04-17 01:51:25 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:51:26 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              54.659802   444.120  ...  15.315044  3.448402
    Harker-ES                       50.022861  2178.782  ...  44.968763  2.063940
    Harker-MN                       55.452434   366.767  ...  26.676017  7.273287
    Longfellow-Block-1              44.084776   492.417  ...   7.308974  1.484306
    TOTAL                           50.346441  3482.086  ...  94.268798  2.707251
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:51:26 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0475 | MISS: 0.4289 | CER: 0.0271 | DER: 0.5035 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:04,  1.66s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.83s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.18s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:51:37 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:51:37 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:51:37 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:51:37 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:51:37 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:51:38 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:51:38 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:51:38 features:305] PADDING: 16
[NeMo I 2025-04-17 01:51:38 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:51:38 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:51:38 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:51:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:51:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:38 collections:880] Dataset successfully loaded with 2040 items and total duration provided from manifest is  0.80 hours.
[NeMo I 2025-04-17 01:51:38 collections:886] # 2040 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.96s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.50it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.73it/s][1/6] extract embeddings:  28%|██▊       | 9/32 [00:02<00:03,  6.29it/s][1/6] extract embeddings:  38%|███▊      | 12/32 [00:02<00:02,  8.78it/s][1/6] extract embeddings:  47%|████▋     | 15/32 [00:02<00:01, 11.17it/s][1/6] extract embeddings:  56%|█████▋    | 18/32 [00:02<00:01, 13.61it/s][1/6] extract embeddings:  66%|██████▌   | 21/32 [00:02<00:00, 15.04it/s][1/6] extract embeddings:  72%|███████▏  | 23/32 [00:03<00:00, 15.98it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 16.43it/s][1/6] extract embeddings:  84%|████████▍ | 27/32 [00:03<00:00, 16.88it/s][1/6] extract embeddings:  91%|█████████ | 29/32 [00:03<00:00, 17.51it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00, 18.93it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.13it/s]
[NeMo I 2025-04-17 01:51:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:51:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:42 collections:880] Dataset successfully loaded with 2233 items and total duration provided from manifest is  0.85 hours.
[NeMo I 2025-04-17 01:51:42 collections:886] # 2233 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:48,  1.42s/it][2/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:09,  3.29it/s][2/6] extract embeddings:  17%|█▋        | 6/35 [00:01<00:05,  5.11it/s][2/6] extract embeddings:  23%|██▎       | 8/35 [00:01<00:03,  6.93it/s][2/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02,  8.99it/s][2/6] extract embeddings:  37%|███▋      | 13/35 [00:02<00:01, 12.03it/s][2/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 14.54it/s][2/6] extract embeddings:  54%|█████▍    | 19/35 [00:02<00:00, 16.33it/s][2/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 17.27it/s][2/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 18.52it/s][2/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 17.96it/s][2/6] extract embeddings:  86%|████████▌ | 30/35 [00:02<00:00, 17.32it/s][2/6] extract embeddings:  94%|█████████▍| 33/35 [00:03<00:00, 19.05it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 18.94it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 11.05it/s]
[NeMo I 2025-04-17 01:51:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:51:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:45 collections:880] Dataset successfully loaded with 2520 items and total duration provided from manifest is  0.89 hours.
[NeMo I 2025-04-17 01:51:45 collections:886] # 2520 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:43,  1.12s/it][3/6] extract embeddings:  10%|█         | 4/40 [00:01<00:08,  4.00it/s][3/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:04,  7.07it/s][3/6] extract embeddings:  25%|██▌       | 10/40 [00:01<00:02, 10.18it/s][3/6] extract embeddings:  30%|███       | 12/40 [00:01<00:02, 11.84it/s][3/6] extract embeddings:  38%|███▊      | 15/40 [00:01<00:01, 14.35it/s][3/6] extract embeddings:  45%|████▌     | 18/40 [00:01<00:01, 17.07it/s][3/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 18.17it/s][3/6] extract embeddings:  60%|██████    | 24/40 [00:02<00:00, 19.05it/s][3/6] extract embeddings:  68%|██████▊   | 27/40 [00:02<00:00, 19.99it/s][3/6] extract embeddings:  75%|███████▌  | 30/40 [00:02<00:00, 20.76it/s][3/6] extract embeddings:  82%|████████▎ | 33/40 [00:02<00:00, 20.75it/s][3/6] extract embeddings:  90%|█████████ | 36/40 [00:02<00:00, 21.36it/s][3/6] extract embeddings:  98%|█████████▊| 39/40 [00:02<00:00, 21.36it/s][3/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 13.75it/s]
[NeMo I 2025-04-17 01:51:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:51:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:48 collections:880] Dataset successfully loaded with 3127 items and total duration provided from manifest is  0.96 hours.
[NeMo I 2025-04-17 01:51:48 collections:886] # 3127 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/49 [00:01<00:54,  1.13s/it][4/6] extract embeddings:   8%|▊         | 4/49 [00:01<00:11,  4.09it/s][4/6] extract embeddings:  12%|█▏        | 6/49 [00:01<00:06,  6.16it/s][4/6] extract embeddings:  18%|█▊        | 9/49 [00:01<00:04,  9.52it/s][4/6] extract embeddings:  24%|██▍       | 12/49 [00:01<00:02, 12.69it/s][4/6] extract embeddings:  31%|███       | 15/49 [00:01<00:02, 15.68it/s][4/6] extract embeddings:  37%|███▋      | 18/49 [00:01<00:01, 17.60it/s][4/6] extract embeddings:  43%|████▎     | 21/49 [00:01<00:01, 19.30it/s][4/6] extract embeddings:  49%|████▉     | 24/49 [00:02<00:01, 20.39it/s][4/6] extract embeddings:  55%|█████▌    | 27/49 [00:02<00:01, 21.92it/s][4/6] extract embeddings:  61%|██████    | 30/49 [00:02<00:00, 22.23it/s][4/6] extract embeddings:  67%|██████▋   | 33/49 [00:02<00:00, 23.14it/s][4/6] extract embeddings:  73%|███████▎  | 36/49 [00:02<00:00, 23.82it/s][4/6] extract embeddings:  80%|███████▉  | 39/49 [00:02<00:00, 23.82it/s][4/6] extract embeddings:  86%|████████▌ | 42/49 [00:02<00:00, 22.97it/s][4/6] extract embeddings:  92%|█████████▏| 45/49 [00:02<00:00, 23.51it/s][4/6] extract embeddings:  98%|█████████▊| 48/49 [00:03<00:00, 23.17it/s][4/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 15.39it/s]
[NeMo I 2025-04-17 01:51:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:51:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:52 collections:880] Dataset successfully loaded with 4466 items and total duration provided from manifest is  1.05 hours.
[NeMo I 2025-04-17 01:51:52 collections:886] # 4466 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/70 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/70 [00:01<01:17,  1.13s/it][5/6] extract embeddings:   6%|▌         | 4/70 [00:01<00:15,  4.15it/s][5/6] extract embeddings:  10%|█         | 7/70 [00:01<00:08,  7.61it/s][5/6] extract embeddings:  14%|█▍        | 10/70 [00:01<00:05, 10.86it/s][5/6] extract embeddings:  19%|█▊        | 13/70 [00:01<00:04, 14.16it/s][5/6] extract embeddings:  23%|██▎       | 16/70 [00:01<00:03, 16.33it/s][5/6] extract embeddings:  27%|██▋       | 19/70 [00:01<00:02, 18.37it/s][5/6] extract embeddings:  31%|███▏      | 22/70 [00:01<00:02, 20.31it/s][5/6] extract embeddings:  36%|███▌      | 25/70 [00:02<00:02, 22.09it/s][5/6] extract embeddings:  40%|████      | 28/70 [00:02<00:01, 23.34it/s][5/6] extract embeddings:  44%|████▍     | 31/70 [00:02<00:01, 24.42it/s][5/6] extract embeddings:  49%|████▊     | 34/70 [00:02<00:01, 24.85it/s][5/6] extract embeddings:  53%|█████▎    | 37/70 [00:02<00:01, 26.21it/s][5/6] extract embeddings:  57%|█████▋    | 40/70 [00:02<00:01, 26.00it/s][5/6] extract embeddings:  61%|██████▏   | 43/70 [00:02<00:00, 27.09it/s][5/6] extract embeddings:  66%|██████▌   | 46/70 [00:02<00:00, 26.68it/s][5/6] extract embeddings:  70%|███████   | 49/70 [00:02<00:00, 25.41it/s][5/6] extract embeddings:  74%|███████▍  | 52/70 [00:03<00:00, 26.44it/s][5/6] extract embeddings:  79%|███████▊  | 55/70 [00:03<00:00, 26.52it/s][5/6] extract embeddings:  83%|████████▎ | 58/70 [00:03<00:00, 27.19it/s][5/6] extract embeddings:  87%|████████▋ | 61/70 [00:03<00:00, 27.06it/s][5/6] extract embeddings:  91%|█████████▏| 64/70 [00:03<00:00, 27.28it/s][5/6] extract embeddings:  96%|█████████▌| 67/70 [00:03<00:00, 27.59it/s][5/6] extract embeddings: 100%|██████████| 70/70 [00:03<00:00, 28.14it/s][5/6] extract embeddings: 100%|██████████| 70/70 [00:03<00:00, 18.78it/s]
[NeMo I 2025-04-17 01:51:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:51:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:51:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:51:56 collections:880] Dataset successfully loaded with 8894 items and total duration provided from manifest is  1.16 hours.
[NeMo I 2025-04-17 01:51:56 collections:886] # 8894 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/139 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/139 [00:01<02:32,  1.11s/it][6/6] extract embeddings:   4%|▎         | 5/139 [00:01<00:25,  5.30it/s][6/6] extract embeddings:   6%|▋         | 9/139 [00:01<00:13,  9.81it/s][6/6] extract embeddings:   9%|▉         | 13/139 [00:01<00:08, 14.43it/s][6/6] extract embeddings:  12%|█▏        | 17/139 [00:01<00:06, 18.25it/s][6/6] extract embeddings:  15%|█▌        | 21/139 [00:01<00:05, 21.64it/s][6/6] extract embeddings:  18%|█▊        | 25/139 [00:01<00:04, 24.88it/s][6/6] extract embeddings:  21%|██        | 29/139 [00:01<00:04, 27.23it/s][6/6] extract embeddings:  24%|██▎       | 33/139 [00:02<00:03, 29.07it/s][6/6] extract embeddings:  27%|██▋       | 37/139 [00:02<00:03, 29.88it/s][6/6] extract embeddings:  29%|██▉       | 41/139 [00:02<00:03, 30.69it/s][6/6] extract embeddings:  32%|███▏      | 45/139 [00:02<00:02, 31.61it/s][6/6] extract embeddings:  35%|███▌      | 49/139 [00:02<00:02, 31.09it/s][6/6] extract embeddings:  38%|███▊      | 53/139 [00:02<00:02, 31.28it/s][6/6] extract embeddings:  41%|████      | 57/139 [00:02<00:02, 32.49it/s][6/6] extract embeddings:  44%|████▍     | 61/139 [00:02<00:02, 31.95it/s][6/6] extract embeddings:  47%|████▋     | 65/139 [00:03<00:02, 30.33it/s][6/6] extract embeddings:  50%|████▉     | 69/139 [00:03<00:02, 32.21it/s][6/6] extract embeddings:  53%|█████▎    | 73/139 [00:03<00:02, 32.52it/s][6/6] extract embeddings:  55%|█████▌    | 77/139 [00:03<00:01, 32.55it/s][6/6] extract embeddings:  58%|█████▊    | 81/139 [00:03<00:01, 32.80it/s][6/6] extract embeddings:  61%|██████    | 85/139 [00:03<00:01, 32.39it/s][6/6] extract embeddings:  64%|██████▍   | 89/139 [00:03<00:01, 33.36it/s][6/6] extract embeddings:  67%|██████▋   | 93/139 [00:03<00:01, 33.44it/s][6/6] extract embeddings:  70%|██████▉   | 97/139 [00:04<00:01, 33.64it/s][6/6] extract embeddings:  73%|███████▎  | 101/139 [00:04<00:01, 32.66it/s][6/6] extract embeddings:  76%|███████▌  | 105/139 [00:04<00:01, 32.54it/s][6/6] extract embeddings:  78%|███████▊  | 109/139 [00:04<00:00, 31.81it/s][6/6] extract embeddings:  81%|████████▏ | 113/139 [00:04<00:00, 32.91it/s][6/6] extract embeddings:  84%|████████▍ | 117/139 [00:04<00:00, 32.71it/s][6/6] extract embeddings:  87%|████████▋ | 121/139 [00:04<00:00, 32.23it/s][6/6] extract embeddings:  90%|████████▉ | 125/139 [00:04<00:00, 32.59it/s][6/6] extract embeddings:  93%|█████████▎| 129/139 [00:05<00:00, 32.49it/s][6/6] extract embeddings:  96%|█████████▌| 133/139 [00:05<00:00, 33.06it/s][6/6] extract embeddings:  99%|█████████▊| 137/139 [00:05<00:00, 32.15it/s][6/6] extract embeddings: 100%|██████████| 139/139 [00:05<00:00, 25.90it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:01<00:04,  1.47s/it]clustering:  50%|█████     | 2/4 [00:02<00:01,  1.08it/s]clustering:  75%|███████▌  | 3/4 [00:02<00:00,  1.59it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  2.17it/s]clustering: 100%|██████████| 4/4 [00:02<00:00,  1.60it/s]
[NeMo I 2025-04-17 01:52:04 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:52:05 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              55.709025   444.120  ...  15.104979  3.401103
    Harker-ES                       50.692582  2178.782  ...  37.549832  1.723432
    Harker-MN                       55.638352   366.767  ...  24.841015  6.772969
    Longfellow-Block-1              45.629187   492.417  ...   8.428956  1.711752
    TOTAL                           51.137300  3482.086  ...  85.924781  2.467624
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:52:05 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0453 | MISS: 0.4414 | CER: 0.0247 | DER: 0.5114 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.68s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.85s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:52:16 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:52:16 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:52:16 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:52:16 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:52:16 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:52:17 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:52:17 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:52:17 features:305] PADDING: 16
[NeMo I 2025-04-17 01:52:17 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:52:17 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:52:17 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:52:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:52:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:52:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:52:17 collections:880] Dataset successfully loaded with 2044 items and total duration provided from manifest is  0.77 hours.
[NeMo I 2025-04-17 01:52:17 collections:886] # 2044 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.94s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.52it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.74it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.15it/s][1/6] extract embeddings:  38%|███▊      | 12/32 [00:02<00:02,  8.54it/s][1/6] extract embeddings:  47%|████▋     | 15/32 [00:02<00:01, 11.12it/s][1/6] extract embeddings:  56%|█████▋    | 18/32 [00:02<00:01, 13.23it/s][1/6] extract embeddings:  66%|██████▌   | 21/32 [00:02<00:00, 14.98it/s][1/6] extract embeddings:  75%|███████▌  | 24/32 [00:03<00:00, 16.40it/s][1/6] extract embeddings:  84%|████████▍ | 27/32 [00:03<00:00, 17.27it/s][1/6] extract embeddings:  94%|█████████▍| 30/32 [00:03<00:00, 17.72it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.17it/s]
[NeMo I 2025-04-17 01:52:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:52:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:52:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:52:21 collections:880] Dataset successfully loaded with 2223 items and total duration provided from manifest is  0.81 hours.
[NeMo I 2025-04-17 01:52:21 collections:886] # 2223 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:46,  1.37s/it][2/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:09,  3.35it/s][2/6] extract embeddings:  20%|██        | 7/35 [00:01<00:04,  6.04it/s][2/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02,  8.78it/s][2/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 11.26it/s][2/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 13.53it/s][2/6] extract embeddings:  54%|█████▍    | 19/35 [00:02<00:01, 15.65it/s][2/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 17.41it/s][2/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 18.66it/s][2/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 19.25it/s][2/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 19.73it/s][2/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 20.29it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 11.75it/s]
[NeMo I 2025-04-17 01:52:24 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:52:24 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:52:24 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:52:24 collections:880] Dataset successfully loaded with 2488 items and total duration provided from manifest is  0.85 hours.
[NeMo I 2025-04-17 01:52:24 collections:886] # 2488 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:43,  1.14s/it][3/6] extract embeddings:  10%|█         | 4/39 [00:01<00:08,  3.96it/s][3/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  7.02it/s][3/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:02, 10.17it/s][3/6] extract embeddings:  33%|███▎      | 13/39 [00:01<00:02, 12.73it/s][3/6] extract embeddings:  41%|████      | 16/39 [00:01<00:01, 14.85it/s][3/6] extract embeddings:  49%|████▊     | 19/39 [00:01<00:01, 16.63it/s][3/6] extract embeddings:  56%|█████▋    | 22/39 [00:02<00:00, 18.45it/s][3/6] extract embeddings:  64%|██████▍   | 25/39 [00:02<00:00, 18.86it/s][3/6] extract embeddings:  72%|███████▏  | 28/39 [00:02<00:00, 20.13it/s][3/6] extract embeddings:  79%|███████▉  | 31/39 [00:02<00:00, 20.04it/s][3/6] extract embeddings:  87%|████████▋ | 34/39 [00:02<00:00, 21.20it/s][3/6] extract embeddings:  95%|█████████▍| 37/39 [00:02<00:00, 21.62it/s][3/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 13.46it/s]
[NeMo I 2025-04-17 01:52:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:52:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:52:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:52:27 collections:880] Dataset successfully loaded with 3057 items and total duration provided from manifest is  0.91 hours.
[NeMo I 2025-04-17 01:52:27 collections:886] # 3057 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/48 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/48 [00:01<00:52,  1.12s/it][4/6] extract embeddings:   8%|▊         | 4/48 [00:01<00:10,  4.04it/s][4/6] extract embeddings:  15%|█▍        | 7/48 [00:01<00:05,  7.35it/s][4/6] extract embeddings:  21%|██        | 10/48 [00:01<00:03, 10.60it/s][4/6] extract embeddings:  27%|██▋       | 13/48 [00:01<00:02, 13.14it/s][4/6] extract embeddings:  33%|███▎      | 16/48 [00:01<00:02, 15.59it/s][4/6] extract embeddings:  40%|███▉      | 19/48 [00:01<00:01, 16.96it/s][4/6] extract embeddings:  46%|████▌     | 22/48 [00:02<00:01, 19.44it/s][4/6] extract embeddings:  52%|█████▏    | 25/48 [00:02<00:01, 21.11it/s][4/6] extract embeddings:  58%|█████▊    | 28/48 [00:02<00:00, 21.39it/s][4/6] extract embeddings:  65%|██████▍   | 31/48 [00:02<00:00, 22.02it/s][4/6] extract embeddings:  71%|███████   | 34/48 [00:02<00:00, 22.20it/s][4/6] extract embeddings:  77%|███████▋  | 37/48 [00:02<00:00, 22.96it/s][4/6] extract embeddings:  83%|████████▎ | 40/48 [00:02<00:00, 23.47it/s][4/6] extract embeddings:  90%|████████▉ | 43/48 [00:02<00:00, 23.33it/s][4/6] extract embeddings:  96%|█████████▌| 46/48 [00:03<00:00, 23.25it/s][4/6] extract embeddings: 100%|██████████| 48/48 [00:03<00:00, 15.30it/s]
[NeMo I 2025-04-17 01:52:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:52:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:52:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:52:30 collections:880] Dataset successfully loaded with 4327 items and total duration provided from manifest is  1.00 hours.
[NeMo I 2025-04-17 01:52:30 collections:886] # 4327 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/68 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/68 [00:01<01:17,  1.16s/it][5/6] extract embeddings:   6%|▌         | 4/68 [00:01<00:15,  4.04it/s][5/6] extract embeddings:  10%|█         | 7/68 [00:01<00:08,  7.26it/s][5/6] extract embeddings:  16%|█▌        | 11/68 [00:01<00:04, 11.80it/s][5/6] extract embeddings:  21%|██        | 14/68 [00:01<00:03, 14.60it/s][5/6] extract embeddings:  25%|██▌       | 17/68 [00:01<00:03, 16.42it/s][5/6] extract embeddings:  29%|██▉       | 20/68 [00:01<00:02, 18.63it/s][5/6] extract embeddings:  34%|███▍      | 23/68 [00:01<00:02, 21.16it/s][5/6] extract embeddings:  38%|███▊      | 26/68 [00:02<00:01, 22.85it/s][5/6] extract embeddings:  43%|████▎     | 29/68 [00:02<00:01, 23.80it/s][5/6] extract embeddings:  47%|████▋     | 32/68 [00:02<00:01, 24.74it/s][5/6] extract embeddings:  51%|█████▏    | 35/68 [00:02<00:01, 25.57it/s][5/6] extract embeddings:  56%|█████▌    | 38/68 [00:02<00:01, 26.38it/s][5/6] extract embeddings:  60%|██████    | 41/68 [00:02<00:01, 26.50it/s][5/6] extract embeddings:  65%|██████▍   | 44/68 [00:02<00:00, 27.04it/s][5/6] extract embeddings:  69%|██████▉   | 47/68 [00:02<00:00, 27.18it/s][5/6] extract embeddings:  74%|███████▎  | 50/68 [00:02<00:00, 27.18it/s][5/6] extract embeddings:  78%|███████▊  | 53/68 [00:03<00:00, 27.20it/s][5/6] extract embeddings:  82%|████████▏ | 56/68 [00:03<00:00, 26.73it/s][5/6] extract embeddings:  87%|████████▋ | 59/68 [00:03<00:00, 26.53it/s][5/6] extract embeddings:  91%|█████████ | 62/68 [00:03<00:00, 25.72it/s][5/6] extract embeddings:  96%|█████████▌| 65/68 [00:03<00:00, 26.20it/s][5/6] extract embeddings: 100%|██████████| 68/68 [00:03<00:00, 18.50it/s]
[NeMo I 2025-04-17 01:52:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:52:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:52:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:52:34 collections:880] Dataset successfully loaded with 8578 items and total duration provided from manifest is  1.11 hours.
[NeMo I 2025-04-17 01:52:34 collections:886] # 8578 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/135 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/135 [00:01<02:35,  1.16s/it][6/6] extract embeddings:   4%|▎         | 5/135 [00:01<00:25,  5.01it/s][6/6] extract embeddings:   7%|▋         | 9/135 [00:01<00:13,  9.35it/s][6/6] extract embeddings:  10%|▉         | 13/135 [00:01<00:08, 13.79it/s][6/6] extract embeddings:  13%|█▎        | 17/135 [00:01<00:06, 17.46it/s][6/6] extract embeddings:  16%|█▌        | 21/135 [00:01<00:05, 21.32it/s][6/6] extract embeddings:  19%|█▊        | 25/135 [00:01<00:04, 24.24it/s][6/6] extract embeddings:  21%|██▏       | 29/135 [00:02<00:03, 26.84it/s][6/6] extract embeddings:  24%|██▍       | 33/135 [00:02<00:03, 29.14it/s][6/6] extract embeddings:  27%|██▋       | 37/135 [00:02<00:03, 29.79it/s][6/6] extract embeddings:  30%|███       | 41/135 [00:02<00:03, 29.75it/s][6/6] extract embeddings:  33%|███▎      | 45/135 [00:02<00:02, 30.05it/s][6/6] extract embeddings:  36%|███▋      | 49/135 [00:02<00:02, 30.61it/s][6/6] extract embeddings:  39%|███▉      | 53/135 [00:02<00:02, 30.82it/s][6/6] extract embeddings:  42%|████▏     | 57/135 [00:02<00:02, 31.54it/s][6/6] extract embeddings:  45%|████▌     | 61/135 [00:03<00:02, 31.27it/s][6/6] extract embeddings:  48%|████▊     | 65/135 [00:03<00:02, 31.28it/s][6/6] extract embeddings:  51%|█████     | 69/135 [00:03<00:02, 31.77it/s][6/6] extract embeddings:  54%|█████▍    | 73/135 [00:03<00:02, 30.91it/s][6/6] extract embeddings:  57%|█████▋    | 77/135 [00:03<00:01, 31.18it/s][6/6] extract embeddings:  60%|██████    | 81/135 [00:03<00:01, 32.41it/s][6/6] extract embeddings:  63%|██████▎   | 85/135 [00:03<00:01, 31.57it/s][6/6] extract embeddings:  66%|██████▌   | 89/135 [00:03<00:01, 31.98it/s][6/6] extract embeddings:  69%|██████▉   | 93/135 [00:04<00:01, 33.04it/s][6/6] extract embeddings:  72%|███████▏  | 97/135 [00:04<00:01, 32.48it/s][6/6] extract embeddings:  75%|███████▍  | 101/135 [00:04<00:01, 32.06it/s][6/6] extract embeddings:  78%|███████▊  | 105/135 [00:04<00:00, 32.47it/s][6/6] extract embeddings:  81%|████████  | 109/135 [00:04<00:00, 32.10it/s][6/6] extract embeddings:  84%|████████▎ | 113/135 [00:04<00:00, 32.36it/s][6/6] extract embeddings:  87%|████████▋ | 117/135 [00:04<00:00, 33.06it/s][6/6] extract embeddings:  90%|████████▉ | 121/135 [00:04<00:00, 33.34it/s][6/6] extract embeddings:  93%|█████████▎| 125/135 [00:04<00:00, 33.71it/s][6/6] extract embeddings:  96%|█████████▌| 129/135 [00:05<00:00, 34.11it/s][6/6] extract embeddings:  99%|█████████▊| 133/135 [00:05<00:00, 33.92it/s][6/6] extract embeddings: 100%|██████████| 135/135 [00:05<00:00, 25.49it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.22it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.12it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.76it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.36it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s]
[NeMo I 2025-04-17 01:52:41 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:52:42 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              56.536497   444.120  ...  13.480003  3.035216
    Harker-ES                       52.307640  2178.782  ...  37.589415  1.725249
    Harker-MN                       57.805366   366.767  ...  25.573975  6.972812
    Longfellow-Block-1              48.122002   492.417  ...  10.303971  2.092529
    TOTAL                           52.834171  3482.086  ...  86.947364  2.496991
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:52:42 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0438 | MISS: 0.4595 | CER: 0.0250 | DER: 0.5283 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.73s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:52:54 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:52:54 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:52:54 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:52:54 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:52:54 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:52:54 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:52:54 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:52:54 features:305] PADDING: 16
[NeMo I 2025-04-17 01:52:55 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:52:55 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:52:55 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:52:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:52:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:52:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:52:55 collections:880] Dataset successfully loaded with 2061 items and total duration provided from manifest is  0.73 hours.
[NeMo I 2025-04-17 01:52:55 collections:886] # 2061 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:01<01:01,  1.93s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.52it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.85it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.26it/s][1/6] extract embeddings:  36%|███▋      | 12/33 [00:02<00:02,  8.79it/s][1/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 11.29it/s][1/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:01, 12.78it/s][1/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 15.00it/s][1/6] extract embeddings:  70%|██████▉   | 23/33 [00:02<00:00, 17.14it/s][1/6] extract embeddings:  79%|███████▉  | 26/33 [00:03<00:00, 18.20it/s][1/6] extract embeddings:  88%|████████▊ | 29/33 [00:03<00:00, 18.70it/s][1/6] extract embeddings:  97%|█████████▋| 32/33 [00:03<00:00, 19.21it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  9.61it/s]
[NeMo I 2025-04-17 01:52:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:52:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:52:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:52:58 collections:880] Dataset successfully loaded with 2225 items and total duration provided from manifest is  0.76 hours.
[NeMo I 2025-04-17 01:52:58 collections:886] # 2225 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:46,  1.36s/it][2/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:09,  3.38it/s][2/6] extract embeddings:  20%|██        | 7/35 [00:01<00:04,  6.11it/s][2/6] extract embeddings:  26%|██▌       | 9/35 [00:01<00:03,  7.80it/s][2/6] extract embeddings:  34%|███▍      | 12/35 [00:01<00:02, 10.68it/s][2/6] extract embeddings:  43%|████▎     | 15/35 [00:02<00:01, 13.23it/s][2/6] extract embeddings:  51%|█████▏    | 18/35 [00:02<00:01, 15.54it/s][2/6] extract embeddings:  60%|██████    | 21/35 [00:02<00:00, 16.86it/s][2/6] extract embeddings:  69%|██████▊   | 24/35 [00:02<00:00, 18.51it/s][2/6] extract embeddings:  77%|███████▋  | 27/35 [00:02<00:00, 18.97it/s][2/6] extract embeddings:  86%|████████▌ | 30/35 [00:02<00:00, 19.39it/s][2/6] extract embeddings:  94%|█████████▍| 33/35 [00:02<00:00, 20.57it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 11.71it/s]
[NeMo I 2025-04-17 01:53:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:53:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:02 collections:880] Dataset successfully loaded with 2467 items and total duration provided from manifest is  0.80 hours.
[NeMo I 2025-04-17 01:53:02 collections:886] # 2467 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:42,  1.12s/it][3/6] extract embeddings:  10%|█         | 4/39 [00:01<00:08,  4.02it/s][3/6] extract embeddings:  15%|█▌        | 6/39 [00:01<00:05,  6.17it/s][3/6] extract embeddings:  23%|██▎       | 9/39 [00:01<00:03,  9.50it/s][3/6] extract embeddings:  31%|███       | 12/39 [00:01<00:02, 12.37it/s][3/6] extract embeddings:  38%|███▊      | 15/39 [00:01<00:01, 14.85it/s][3/6] extract embeddings:  46%|████▌     | 18/39 [00:01<00:01, 16.10it/s][3/6] extract embeddings:  54%|█████▍    | 21/39 [00:02<00:00, 18.27it/s][3/6] extract embeddings:  62%|██████▏   | 24/39 [00:02<00:00, 19.12it/s][3/6] extract embeddings:  69%|██████▉   | 27/39 [00:02<00:00, 20.67it/s][3/6] extract embeddings:  77%|███████▋  | 30/39 [00:02<00:00, 21.14it/s][3/6] extract embeddings:  85%|████████▍ | 33/39 [00:02<00:00, 20.10it/s][3/6] extract embeddings:  92%|█████████▏| 36/39 [00:02<00:00, 20.59it/s][3/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 21.92it/s][3/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 13.56it/s]
[NeMo I 2025-04-17 01:53:05 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:53:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:05 collections:880] Dataset successfully loaded with 2991 items and total duration provided from manifest is  0.86 hours.
[NeMo I 2025-04-17 01:53:05 collections:886] # 2991 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:51,  1.11s/it][4/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:10,  4.13it/s][4/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:05,  7.43it/s][4/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:03, 10.60it/s][4/6] extract embeddings:  28%|██▊       | 13/47 [00:01<00:02, 13.50it/s][4/6] extract embeddings:  34%|███▍      | 16/47 [00:01<00:01, 15.95it/s][4/6] extract embeddings:  40%|████      | 19/47 [00:01<00:01, 18.29it/s][4/6] extract embeddings:  47%|████▋     | 22/47 [00:01<00:01, 20.40it/s][4/6] extract embeddings:  53%|█████▎    | 25/47 [00:02<00:01, 21.62it/s][4/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:00, 22.73it/s][4/6] extract embeddings:  66%|██████▌   | 31/47 [00:02<00:00, 23.00it/s][4/6] extract embeddings:  72%|███████▏  | 34/47 [00:02<00:00, 23.40it/s][4/6] extract embeddings:  79%|███████▊  | 37/47 [00:02<00:00, 23.89it/s][4/6] extract embeddings:  85%|████████▌ | 40/47 [00:02<00:00, 22.89it/s][4/6] extract embeddings:  91%|█████████▏| 43/47 [00:02<00:00, 22.81it/s][4/6] extract embeddings:  98%|█████████▊| 46/47 [00:02<00:00, 22.69it/s][4/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 15.42it/s]
[NeMo I 2025-04-17 01:53:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:53:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:08 collections:880] Dataset successfully loaded with 4168 items and total duration provided from manifest is  0.94 hours.
[NeMo I 2025-04-17 01:53:08 collections:886] # 4168 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/66 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/66 [00:01<01:14,  1.15s/it][5/6] extract embeddings:   6%|▌         | 4/66 [00:01<00:15,  4.08it/s][5/6] extract embeddings:  11%|█         | 7/66 [00:01<00:07,  7.43it/s][5/6] extract embeddings:  15%|█▌        | 10/66 [00:01<00:05, 10.49it/s][5/6] extract embeddings:  21%|██        | 14/66 [00:01<00:03, 14.56it/s][5/6] extract embeddings:  26%|██▌       | 17/66 [00:01<00:02, 16.70it/s][5/6] extract embeddings:  30%|███       | 20/66 [00:01<00:02, 19.32it/s][5/6] extract embeddings:  35%|███▍      | 23/66 [00:01<00:02, 21.35it/s][5/6] extract embeddings:  39%|███▉      | 26/66 [00:02<00:01, 22.17it/s][5/6] extract embeddings:  44%|████▍     | 29/66 [00:02<00:01, 22.86it/s][5/6] extract embeddings:  48%|████▊     | 32/66 [00:02<00:01, 23.97it/s][5/6] extract embeddings:  55%|█████▍    | 36/66 [00:02<00:01, 26.02it/s][5/6] extract embeddings:  59%|█████▉    | 39/66 [00:02<00:01, 26.10it/s][5/6] extract embeddings:  64%|██████▎   | 42/66 [00:02<00:00, 26.17it/s][5/6] extract embeddings:  68%|██████▊   | 45/66 [00:02<00:00, 25.48it/s][5/6] extract embeddings:  73%|███████▎  | 48/66 [00:02<00:00, 25.91it/s][5/6] extract embeddings:  79%|███████▉  | 52/66 [00:03<00:00, 27.09it/s][5/6] extract embeddings:  83%|████████▎ | 55/66 [00:03<00:00, 26.19it/s][5/6] extract embeddings:  88%|████████▊ | 58/66 [00:03<00:00, 26.68it/s][5/6] extract embeddings:  92%|█████████▏| 61/66 [00:03<00:00, 27.24it/s][5/6] extract embeddings:  97%|█████████▋| 64/66 [00:03<00:00, 27.39it/s][5/6] extract embeddings: 100%|██████████| 66/66 [00:03<00:00, 18.30it/s]
[NeMo I 2025-04-17 01:53:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:53:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:12 collections:880] Dataset successfully loaded with 8198 items and total duration provided from manifest is  1.06 hours.
[NeMo I 2025-04-17 01:53:12 collections:886] # 8198 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/129 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/129 [00:01<02:21,  1.11s/it][6/6] extract embeddings:   4%|▍         | 5/129 [00:01<00:23,  5.30it/s][6/6] extract embeddings:   6%|▌         | 8/129 [00:01<00:14,  8.64it/s][6/6] extract embeddings:   9%|▉         | 12/129 [00:01<00:08, 13.54it/s][6/6] extract embeddings:  12%|█▏        | 16/129 [00:01<00:06, 17.40it/s][6/6] extract embeddings:  16%|█▌        | 20/129 [00:01<00:05, 20.93it/s][6/6] extract embeddings:  19%|█▊        | 24/129 [00:01<00:04, 24.12it/s][6/6] extract embeddings:  22%|██▏       | 28/129 [00:01<00:03, 26.95it/s][6/6] extract embeddings:  25%|██▍       | 32/129 [00:02<00:03, 28.61it/s][6/6] extract embeddings:  28%|██▊       | 36/129 [00:02<00:03, 29.04it/s][6/6] extract embeddings:  31%|███       | 40/129 [00:02<00:03, 29.50it/s][6/6] extract embeddings:  34%|███▍      | 44/129 [00:02<00:02, 30.74it/s][6/6] extract embeddings:  37%|███▋      | 48/129 [00:02<00:02, 31.13it/s][6/6] extract embeddings:  40%|████      | 52/129 [00:02<00:02, 31.35it/s][6/6] extract embeddings:  43%|████▎     | 56/129 [00:02<00:02, 30.46it/s][6/6] extract embeddings:  47%|████▋     | 60/129 [00:02<00:02, 30.32it/s][6/6] extract embeddings:  50%|████▉     | 64/129 [00:03<00:02, 30.49it/s][6/6] extract embeddings:  53%|█████▎    | 68/129 [00:03<00:01, 31.34it/s][6/6] extract embeddings:  56%|█████▌    | 72/129 [00:03<00:01, 31.73it/s][6/6] extract embeddings:  59%|█████▉    | 76/129 [00:03<00:01, 32.09it/s][6/6] extract embeddings:  62%|██████▏   | 80/129 [00:03<00:01, 32.22it/s][6/6] extract embeddings:  65%|██████▌   | 84/129 [00:03<00:01, 32.31it/s][6/6] extract embeddings:  68%|██████▊   | 88/129 [00:03<00:01, 32.53it/s][6/6] extract embeddings:  71%|███████▏  | 92/129 [00:03<00:01, 33.28it/s][6/6] extract embeddings:  74%|███████▍  | 96/129 [00:04<00:00, 33.52it/s][6/6] extract embeddings:  78%|███████▊  | 100/129 [00:04<00:00, 33.47it/s][6/6] extract embeddings:  81%|████████  | 104/129 [00:04<00:00, 34.51it/s][6/6] extract embeddings:  84%|████████▎ | 108/129 [00:04<00:00, 34.81it/s][6/6] extract embeddings:  87%|████████▋ | 112/129 [00:04<00:00, 33.39it/s][6/6] extract embeddings:  90%|████████▉ | 116/129 [00:04<00:00, 30.88it/s][6/6] extract embeddings:  93%|█████████▎| 120/129 [00:04<00:00, 32.46it/s][6/6] extract embeddings:  96%|█████████▌| 124/129 [00:04<00:00, 33.04it/s][6/6] extract embeddings:  99%|█████████▉| 128/129 [00:05<00:00, 32.97it/s][6/6] extract embeddings: 100%|██████████| 129/129 [00:05<00:00, 25.47it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.22it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.19it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.87it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.49it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s]
[NeMo I 2025-04-17 01:53:18 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:53:20 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              58.875910   444.120  ...  15.059987  3.390973
    Harker-ES                       54.458315  2178.782  ...  36.014052  1.652944
    Harker-MN                       59.048128   366.767  ...  25.045964  6.828849
    Longfellow-Block-1              50.481852   492.417  ...   9.822000  1.994651
    TOTAL                           54.942868  3482.086  ...  85.942004  2.468118
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:53:20 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0418 | MISS: 0.4829 | CER: 0.0247 | DER: 0.5494 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.85s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:53:31 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:53:31 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:53:31 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:53:31 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:53:31 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:53:31 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:53:31 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:53:31 features:305] PADDING: 16
[NeMo I 2025-04-17 01:53:31 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:53:31 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:53:31 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:53:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:53:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:32 collections:880] Dataset successfully loaded with 2055 items and total duration provided from manifest is  0.67 hours.
[NeMo I 2025-04-17 01:53:32 collections:886] # 2055 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/33 [00:02<01:04,  2.00s/it][1/6] extract embeddings:  12%|█▏        | 4/33 [00:02<00:11,  2.43it/s][1/6] extract embeddings:  21%|██        | 7/33 [00:02<00:05,  4.71it/s][1/6] extract embeddings:  30%|███       | 10/33 [00:02<00:03,  7.17it/s][1/6] extract embeddings:  39%|███▉      | 13/33 [00:02<00:02,  9.59it/s][1/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 12.13it/s][1/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 14.14it/s][1/6] extract embeddings:  67%|██████▋   | 22/33 [00:02<00:00, 16.27it/s][1/6] extract embeddings:  76%|███████▌  | 25/33 [00:03<00:00, 17.23it/s][1/6] extract embeddings:  85%|████████▍ | 28/33 [00:03<00:00, 17.88it/s][1/6] extract embeddings:  94%|█████████▍| 31/33 [00:03<00:00, 18.95it/s][1/6] extract embeddings: 100%|██████████| 33/33 [00:03<00:00,  9.53it/s]
[NeMo I 2025-04-17 01:53:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:53:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:35 collections:880] Dataset successfully loaded with 2193 items and total duration provided from manifest is  0.70 hours.
[NeMo I 2025-04-17 01:53:35 collections:886] # 2193 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:48,  1.43s/it][2/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:09,  3.27it/s][2/6] extract embeddings:  20%|██        | 7/35 [00:01<00:04,  5.97it/s][2/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02,  8.72it/s][2/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 11.43it/s][2/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 13.69it/s][2/6] extract embeddings:  54%|█████▍    | 19/35 [00:02<00:01, 15.58it/s][2/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 17.38it/s][2/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 18.16it/s][2/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 18.64it/s][2/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 20.04it/s][2/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 20.56it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 11.67it/s]
[NeMo I 2025-04-17 01:53:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:53:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:38 collections:880] Dataset successfully loaded with 2403 items and total duration provided from manifest is  0.74 hours.
[NeMo I 2025-04-17 01:53:38 collections:886] # 2403 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:41,  1.13s/it][3/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  4.03it/s][3/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  7.16it/s][3/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02, 10.29it/s][3/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 12.88it/s][3/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 15.09it/s][3/6] extract embeddings:  50%|█████     | 19/38 [00:01<00:01, 17.17it/s][3/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 19.18it/s][3/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 20.84it/s][3/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 21.01it/s][3/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 21.32it/s][3/6] extract embeddings:  89%|████████▉ | 34/38 [00:02<00:00, 21.80it/s][3/6] extract embeddings:  97%|█████████▋| 37/38 [00:02<00:00, 22.09it/s][3/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 13.81it/s]
[NeMo I 2025-04-17 01:53:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:53:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:41 collections:880] Dataset successfully loaded with 2867 items and total duration provided from manifest is  0.79 hours.
[NeMo I 2025-04-17 01:53:41 collections:886] # 2867 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/45 [00:01<00:49,  1.11s/it][4/6] extract embeddings:   9%|▉         | 4/45 [00:01<00:09,  4.12it/s][4/6] extract embeddings:  16%|█▌        | 7/45 [00:01<00:05,  7.48it/s][4/6] extract embeddings:  22%|██▏       | 10/45 [00:01<00:03, 10.75it/s][4/6] extract embeddings:  29%|██▉       | 13/45 [00:01<00:02, 13.75it/s][4/6] extract embeddings:  36%|███▌      | 16/45 [00:01<00:01, 15.73it/s][4/6] extract embeddings:  42%|████▏     | 19/45 [00:01<00:01, 17.80it/s][4/6] extract embeddings:  49%|████▉     | 22/45 [00:01<00:01, 19.85it/s][4/6] extract embeddings:  56%|█████▌    | 25/45 [00:02<00:00, 20.88it/s][4/6] extract embeddings:  62%|██████▏   | 28/45 [00:02<00:00, 21.79it/s][4/6] extract embeddings:  69%|██████▉   | 31/45 [00:02<00:00, 22.93it/s][4/6] extract embeddings:  76%|███████▌  | 34/45 [00:02<00:00, 22.79it/s][4/6] extract embeddings:  82%|████████▏ | 37/45 [00:02<00:00, 23.69it/s][4/6] extract embeddings:  89%|████████▉ | 40/45 [00:02<00:00, 24.39it/s][4/6] extract embeddings:  96%|█████████▌| 43/45 [00:02<00:00, 24.43it/s][4/6] extract embeddings: 100%|██████████| 45/45 [00:02<00:00, 15.29it/s]
[NeMo I 2025-04-17 01:53:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:53:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:44 collections:880] Dataset successfully loaded with 3943 items and total duration provided from manifest is  0.87 hours.
[NeMo I 2025-04-17 01:53:44 collections:886] # 3943 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/62 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/62 [00:01<01:07,  1.11s/it][5/6] extract embeddings:   8%|▊         | 5/62 [00:01<00:11,  5.18it/s][5/6] extract embeddings:  13%|█▎        | 8/62 [00:01<00:06,  8.37it/s][5/6] extract embeddings:  19%|█▉        | 12/62 [00:01<00:03, 12.73it/s][5/6] extract embeddings:  24%|██▍       | 15/62 [00:01<00:03, 15.20it/s][5/6] extract embeddings:  29%|██▉       | 18/62 [00:01<00:02, 17.06it/s][5/6] extract embeddings:  34%|███▍      | 21/62 [00:01<00:02, 19.53it/s][5/6] extract embeddings:  39%|███▊      | 24/62 [00:01<00:01, 21.75it/s][5/6] extract embeddings:  44%|████▎     | 27/62 [00:02<00:01, 23.47it/s][5/6] extract embeddings:  48%|████▊     | 30/62 [00:02<00:01, 24.22it/s][5/6] extract embeddings:  53%|█████▎    | 33/62 [00:02<00:01, 25.72it/s][5/6] extract embeddings:  58%|█████▊    | 36/62 [00:02<00:00, 26.52it/s][5/6] extract embeddings:  63%|██████▎   | 39/62 [00:02<00:00, 26.82it/s][5/6] extract embeddings:  69%|██████▉   | 43/62 [00:02<00:00, 27.54it/s][5/6] extract embeddings:  76%|███████▌  | 47/62 [00:02<00:00, 27.88it/s][5/6] extract embeddings:  81%|████████  | 50/62 [00:02<00:00, 27.47it/s][5/6] extract embeddings:  85%|████████▌ | 53/62 [00:03<00:00, 25.54it/s][5/6] extract embeddings:  90%|█████████ | 56/62 [00:03<00:00, 25.89it/s][5/6] extract embeddings:  95%|█████████▌| 59/62 [00:03<00:00, 26.89it/s][5/6] extract embeddings: 100%|██████████| 62/62 [00:03<00:00, 27.47it/s][5/6] extract embeddings: 100%|██████████| 62/62 [00:03<00:00, 18.44it/s]
[NeMo I 2025-04-17 01:53:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:53:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:53:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:53:48 collections:880] Dataset successfully loaded with 7685 items and total duration provided from manifest is  0.98 hours.
[NeMo I 2025-04-17 01:53:48 collections:886] # 7685 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/121 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/121 [00:01<02:11,  1.09s/it][6/6] extract embeddings:   4%|▍         | 5/121 [00:01<00:21,  5.38it/s][6/6] extract embeddings:   7%|▋         | 9/121 [00:01<00:11,  9.81it/s][6/6] extract embeddings:  11%|█         | 13/121 [00:01<00:07, 14.19it/s][6/6] extract embeddings:  14%|█▍        | 17/121 [00:01<00:05, 18.23it/s][6/6] extract embeddings:  17%|█▋        | 21/121 [00:01<00:04, 21.99it/s][6/6] extract embeddings:  21%|██        | 25/121 [00:01<00:03, 25.14it/s][6/6] extract embeddings:  24%|██▍       | 29/121 [00:01<00:03, 27.55it/s][6/6] extract embeddings:  27%|██▋       | 33/121 [00:02<00:02, 29.44it/s][6/6] extract embeddings:  31%|███       | 37/121 [00:02<00:02, 31.18it/s][6/6] extract embeddings:  34%|███▍      | 41/121 [00:02<00:02, 30.98it/s][6/6] extract embeddings:  37%|███▋      | 45/121 [00:02<00:02, 31.23it/s][6/6] extract embeddings:  40%|████      | 49/121 [00:02<00:02, 32.81it/s][6/6] extract embeddings:  44%|████▍     | 53/121 [00:02<00:02, 32.96it/s][6/6] extract embeddings:  47%|████▋     | 57/121 [00:02<00:01, 32.12it/s][6/6] extract embeddings:  50%|█████     | 61/121 [00:02<00:01, 32.48it/s][6/6] extract embeddings:  54%|█████▎    | 65/121 [00:03<00:01, 32.73it/s][6/6] extract embeddings:  57%|█████▋    | 69/121 [00:03<00:01, 33.51it/s][6/6] extract embeddings:  60%|██████    | 73/121 [00:03<00:01, 32.89it/s][6/6] extract embeddings:  64%|██████▎   | 77/121 [00:03<00:01, 33.31it/s][6/6] extract embeddings:  67%|██████▋   | 81/121 [00:03<00:01, 33.22it/s][6/6] extract embeddings:  70%|███████   | 85/121 [00:03<00:01, 32.37it/s][6/6] extract embeddings:  74%|███████▎  | 89/121 [00:03<00:00, 33.63it/s][6/6] extract embeddings:  77%|███████▋  | 93/121 [00:03<00:00, 34.26it/s][6/6] extract embeddings:  80%|████████  | 97/121 [00:03<00:00, 33.98it/s][6/6] extract embeddings:  83%|████████▎ | 101/121 [00:04<00:00, 34.71it/s][6/6] extract embeddings:  87%|████████▋ | 105/121 [00:04<00:00, 33.52it/s][6/6] extract embeddings:  90%|█████████ | 109/121 [00:04<00:00, 32.99it/s][6/6] extract embeddings:  93%|█████████▎| 113/121 [00:04<00:00, 33.76it/s][6/6] extract embeddings:  97%|█████████▋| 117/121 [00:04<00:00, 34.33it/s][6/6] extract embeddings: 100%|██████████| 121/121 [00:04<00:00, 34.84it/s][6/6] extract embeddings: 100%|██████████| 121/121 [00:04<00:00, 25.87it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.28it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.32it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.03it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.70it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.19it/s]
[NeMo I 2025-04-17 01:53:54 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:53:55 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              61.436019   444.120  ...  12.199946  2.746993
    Harker-ES                       56.686233  2178.782  ...  29.946218  1.374448
    Harker-MN                       60.687104   366.767  ...  24.798990  6.761511
    Longfellow-Block-1              53.155377   492.417  ...  10.650015  2.162804
    TOTAL                           57.214137  3482.086  ...  77.595169  2.228410
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:53:55 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0380 | MISS: 0.5119 | CER: 0.0223 | DER: 0.5721 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.40
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.4 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:04,  1.67s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.83s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.18s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:54:07 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:54:07 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:54:07 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:54:07 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:54:07 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:54:07 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:54:07 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:54:07 features:305] PADDING: 16
[NeMo I 2025-04-17 01:54:08 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:54:08 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:54:08 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:54:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:54:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:08 collections:880] Dataset successfully loaded with 2025 items and total duration provided from manifest is  0.59 hours.
[NeMo I 2025-04-17 01:54:08 collections:886] # 2025 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.94s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.52it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.83it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:02,  7.40it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.77it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.15it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.62it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.17it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 17.98it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 18.74it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 20.00it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.67it/s]
[NeMo I 2025-04-17 01:54:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:54:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:11 collections:880] Dataset successfully loaded with 2126 items and total duration provided from manifest is  0.61 hours.
[NeMo I 2025-04-17 01:54:11 collections:886] # 2126 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:44,  1.36s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:08,  3.39it/s][2/6] extract embeddings:  21%|██        | 7/34 [00:01<00:04,  6.28it/s][2/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02,  9.26it/s][2/6] extract embeddings:  38%|███▊      | 13/34 [00:01<00:01, 12.02it/s][2/6] extract embeddings:  47%|████▋     | 16/34 [00:01<00:01, 14.90it/s][2/6] extract embeddings:  56%|█████▌    | 19/34 [00:02<00:00, 17.40it/s][2/6] extract embeddings:  65%|██████▍   | 22/34 [00:02<00:00, 19.10it/s][2/6] extract embeddings:  74%|███████▎  | 25/34 [00:02<00:00, 20.40it/s][2/6] extract embeddings:  82%|████████▏ | 28/34 [00:02<00:00, 21.03it/s][2/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 21.33it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 22.26it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 12.23it/s]
[NeMo I 2025-04-17 01:54:14 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:54:14 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:14 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:14 collections:880] Dataset successfully loaded with 2301 items and total duration provided from manifest is  0.64 hours.
[NeMo I 2025-04-17 01:54:14 collections:886] # 2301 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:38,  1.11s/it][3/6] extract embeddings:  11%|█         | 4/36 [00:01<00:07,  4.07it/s][3/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:03,  7.29it/s][3/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:02, 10.30it/s][3/6] extract embeddings:  36%|███▌      | 13/36 [00:01<00:01, 12.84it/s][3/6] extract embeddings:  44%|████▍     | 16/36 [00:01<00:01, 15.39it/s][3/6] extract embeddings:  53%|█████▎    | 19/36 [00:01<00:00, 17.51it/s][3/6] extract embeddings:  61%|██████    | 22/36 [00:02<00:00, 19.77it/s][3/6] extract embeddings:  69%|██████▉   | 25/36 [00:02<00:00, 21.19it/s][3/6] extract embeddings:  78%|███████▊  | 28/36 [00:02<00:00, 21.46it/s][3/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 21.84it/s][3/6] extract embeddings:  94%|█████████▍| 34/36 [00:02<00:00, 23.36it/s][3/6] extract embeddings: 100%|██████████| 36/36 [00:02<00:00, 13.72it/s]
[NeMo I 2025-04-17 01:54:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:54:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:17 collections:880] Dataset successfully loaded with 2688 items and total duration provided from manifest is  0.69 hours.
[NeMo I 2025-04-17 01:54:17 collections:886] # 2688 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:46,  1.14s/it][4/6] extract embeddings:  10%|▉         | 4/42 [00:01<00:09,  4.01it/s][4/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:04,  7.29it/s][4/6] extract embeddings:  24%|██▍       | 10/42 [00:01<00:03, 10.54it/s][4/6] extract embeddings:  31%|███       | 13/42 [00:01<00:02, 13.60it/s][4/6] extract embeddings:  38%|███▊      | 16/42 [00:01<00:01, 16.44it/s][4/6] extract embeddings:  45%|████▌     | 19/42 [00:01<00:01, 18.75it/s][4/6] extract embeddings:  52%|█████▏    | 22/42 [00:01<00:00, 20.52it/s][4/6] extract embeddings:  60%|█████▉    | 25/42 [00:02<00:00, 21.90it/s][4/6] extract embeddings:  67%|██████▋   | 28/42 [00:02<00:00, 23.60it/s][4/6] extract embeddings:  74%|███████▍  | 31/42 [00:02<00:00, 23.50it/s][4/6] extract embeddings:  81%|████████  | 34/42 [00:02<00:00, 23.00it/s][4/6] extract embeddings:  88%|████████▊ | 37/42 [00:02<00:00, 23.94it/s][4/6] extract embeddings:  95%|█████████▌| 40/42 [00:02<00:00, 24.21it/s][4/6] extract embeddings: 100%|██████████| 42/42 [00:02<00:00, 15.03it/s]
[NeMo I 2025-04-17 01:54:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:54:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:20 collections:880] Dataset successfully loaded with 3607 items and total duration provided from manifest is  0.76 hours.
[NeMo I 2025-04-17 01:54:20 collections:886] # 3607 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/57 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/57 [00:01<01:01,  1.10s/it][5/6] extract embeddings:   7%|▋         | 4/57 [00:01<00:12,  4.23it/s][5/6] extract embeddings:  12%|█▏        | 7/57 [00:01<00:06,  7.78it/s][5/6] extract embeddings:  18%|█▊        | 10/57 [00:01<00:04, 11.43it/s][5/6] extract embeddings:  23%|██▎       | 13/57 [00:01<00:02, 14.78it/s][5/6] extract embeddings:  28%|██▊       | 16/57 [00:01<00:02, 17.22it/s][5/6] extract embeddings:  33%|███▎      | 19/57 [00:01<00:01, 19.26it/s][5/6] extract embeddings:  39%|███▊      | 22/57 [00:01<00:01, 20.85it/s][5/6] extract embeddings:  46%|████▌     | 26/57 [00:02<00:01, 23.62it/s][5/6] extract embeddings:  51%|█████     | 29/57 [00:02<00:01, 25.14it/s][5/6] extract embeddings:  56%|█████▌    | 32/57 [00:02<00:00, 25.01it/s][5/6] extract embeddings:  61%|██████▏   | 35/57 [00:02<00:00, 25.90it/s][5/6] extract embeddings:  67%|██████▋   | 38/57 [00:02<00:00, 25.85it/s][5/6] extract embeddings:  72%|███████▏  | 41/57 [00:02<00:00, 26.12it/s][5/6] extract embeddings:  77%|███████▋  | 44/57 [00:02<00:00, 26.70it/s][5/6] extract embeddings:  82%|████████▏ | 47/57 [00:02<00:00, 27.43it/s][5/6] extract embeddings:  88%|████████▊ | 50/57 [00:02<00:00, 27.64it/s][5/6] extract embeddings:  93%|█████████▎| 53/57 [00:02<00:00, 27.79it/s][5/6] extract embeddings: 100%|██████████| 57/57 [00:03<00:00, 29.79it/s][5/6] extract embeddings: 100%|██████████| 57/57 [00:03<00:00, 18.18it/s]
[NeMo I 2025-04-17 01:54:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:54:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:23 collections:880] Dataset successfully loaded with 6925 items and total duration provided from manifest is  0.87 hours.
[NeMo I 2025-04-17 01:54:23 collections:886] # 6925 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/109 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/109 [00:01<01:59,  1.11s/it][6/6] extract embeddings:   5%|▍         | 5/109 [00:01<00:19,  5.30it/s][6/6] extract embeddings:   8%|▊         | 9/109 [00:01<00:10, 10.00it/s][6/6] extract embeddings:  12%|█▏        | 13/109 [00:01<00:06, 14.48it/s][6/6] extract embeddings:  16%|█▌        | 17/109 [00:01<00:04, 18.47it/s][6/6] extract embeddings:  19%|█▉        | 21/109 [00:01<00:03, 22.46it/s][6/6] extract embeddings:  23%|██▎       | 25/109 [00:01<00:03, 25.45it/s][6/6] extract embeddings:  27%|██▋       | 29/109 [00:01<00:02, 27.57it/s][6/6] extract embeddings:  30%|███       | 33/109 [00:02<00:02, 29.79it/s][6/6] extract embeddings:  34%|███▍      | 37/109 [00:02<00:02, 31.00it/s][6/6] extract embeddings:  38%|███▊      | 41/109 [00:02<00:02, 32.03it/s][6/6] extract embeddings:  41%|████▏     | 45/109 [00:02<00:01, 33.07it/s][6/6] extract embeddings:  45%|████▍     | 49/109 [00:02<00:01, 32.89it/s][6/6] extract embeddings:  49%|████▊     | 53/109 [00:02<00:01, 33.41it/s][6/6] extract embeddings:  52%|█████▏    | 57/109 [00:02<00:01, 33.97it/s][6/6] extract embeddings:  56%|█████▌    | 61/109 [00:02<00:01, 32.86it/s][6/6] extract embeddings:  60%|█████▉    | 65/109 [00:02<00:01, 30.95it/s][6/6] extract embeddings:  63%|██████▎   | 69/109 [00:03<00:01, 32.04it/s][6/6] extract embeddings:  67%|██████▋   | 73/109 [00:03<00:01, 32.95it/s][6/6] extract embeddings:  71%|███████   | 77/109 [00:03<00:00, 33.29it/s][6/6] extract embeddings:  74%|███████▍  | 81/109 [00:03<00:00, 32.33it/s][6/6] extract embeddings:  78%|███████▊  | 85/109 [00:03<00:00, 32.84it/s][6/6] extract embeddings:  82%|████████▏ | 89/109 [00:03<00:00, 32.90it/s][6/6] extract embeddings:  85%|████████▌ | 93/109 [00:03<00:00, 33.11it/s][6/6] extract embeddings:  89%|████████▉ | 97/109 [00:03<00:00, 33.40it/s][6/6] extract embeddings:  93%|█████████▎| 101/109 [00:04<00:00, 32.51it/s][6/6] extract embeddings:  96%|█████████▋| 105/109 [00:04<00:00, 33.11it/s][6/6] extract embeddings: 100%|██████████| 109/109 [00:04<00:00, 32.75it/s][6/6] extract embeddings: 100%|██████████| 109/109 [00:04<00:00, 25.07it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.86it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.25it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.04it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s]
[NeMo I 2025-04-17 01:54:29 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:54:30 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              64.858499   444.120  ...  13.409976  3.019449
    Harker-ES                       61.064094  2178.782  ...  30.522692  1.400906
    Harker-MN                       65.069134   366.767  ...  27.245956  7.428682
    Longfellow-Block-1              56.741215   492.417  ...  11.666039  2.369138
    TOTAL                           61.358581  3482.086  ...  82.844663  2.379168
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:54:30 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0330 | MISS: 0.5568 | CER: 0.0238 | DER: 0.6136 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.50, offset=0.45
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.5, <class 'float'> offset=0.45 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.68s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.85s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:54:42 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:54:42 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:54:42 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:54:42 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:54:42 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:54:42 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:54:42 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:54:42 features:305] PADDING: 16
[NeMo I 2025-04-17 01:54:43 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:54:43 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:54:43 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:54:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:54:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:43 collections:880] Dataset successfully loaded with 2040 items and total duration provided from manifest is  0.81 hours.
[NeMo I 2025-04-17 01:54:43 collections:886] # 2040 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.95s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.50it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.81it/s][1/6] extract embeddings:  28%|██▊       | 9/32 [00:02<00:03,  6.39it/s][1/6] extract embeddings:  34%|███▍      | 11/32 [00:02<00:02,  8.18it/s][1/6] extract embeddings:  44%|████▍     | 14/32 [00:02<00:01, 10.74it/s][1/6] extract embeddings:  53%|█████▎    | 17/32 [00:02<00:01, 12.84it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 13.88it/s][1/6] extract embeddings:  66%|██████▌   | 21/32 [00:02<00:00, 15.14it/s][1/6] extract embeddings:  75%|███████▌  | 24/32 [00:03<00:00, 16.57it/s][1/6] extract embeddings:  81%|████████▏ | 26/32 [00:03<00:00, 17.12it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.61it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 18.78it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.15it/s]
[NeMo I 2025-04-17 01:54:46 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:54:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:46 collections:880] Dataset successfully loaded with 2231 items and total duration provided from manifest is  0.85 hours.
[NeMo I 2025-04-17 01:54:46 collections:886] # 2231 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:47,  1.39s/it][2/6] extract embeddings:   9%|▊         | 3/35 [00:01<00:12,  2.51it/s][2/6] extract embeddings:  14%|█▍        | 5/35 [00:01<00:06,  4.55it/s][2/6] extract embeddings:  23%|██▎       | 8/35 [00:01<00:03,  7.74it/s][2/6] extract embeddings:  31%|███▏      | 11/35 [00:01<00:02, 10.40it/s][2/6] extract embeddings:  40%|████      | 14/35 [00:02<00:01, 12.94it/s][2/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 14.25it/s][2/6] extract embeddings:  54%|█████▍    | 19/35 [00:02<00:00, 16.25it/s][2/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 17.83it/s][2/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 19.21it/s][2/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 19.46it/s][2/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 19.86it/s][2/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 20.87it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 11.56it/s]
[NeMo I 2025-04-17 01:54:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:54:50 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:50 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:50 collections:880] Dataset successfully loaded with 2527 items and total duration provided from manifest is  0.90 hours.
[NeMo I 2025-04-17 01:54:50 collections:886] # 2527 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:43,  1.12s/it][3/6] extract embeddings:  10%|█         | 4/40 [00:01<00:09,  3.94it/s][3/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:04,  6.99it/s][3/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  8.93it/s][3/6] extract embeddings:  30%|███       | 12/40 [00:01<00:02, 11.84it/s][3/6] extract embeddings:  38%|███▊      | 15/40 [00:01<00:01, 14.36it/s][3/6] extract embeddings:  45%|████▌     | 18/40 [00:01<00:01, 16.62it/s][3/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 17.93it/s][3/6] extract embeddings:  60%|██████    | 24/40 [00:02<00:00, 18.39it/s][3/6] extract embeddings:  68%|██████▊   | 27/40 [00:02<00:00, 19.50it/s][3/6] extract embeddings:  75%|███████▌  | 30/40 [00:02<00:00, 20.01it/s][3/6] extract embeddings:  82%|████████▎ | 33/40 [00:02<00:00, 21.00it/s][3/6] extract embeddings:  90%|█████████ | 36/40 [00:02<00:00, 21.26it/s][3/6] extract embeddings:  98%|█████████▊| 39/40 [00:02<00:00, 22.12it/s][3/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 13.65it/s]
[NeMo I 2025-04-17 01:54:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:54:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:53 collections:880] Dataset successfully loaded with 3133 items and total duration provided from manifest is  0.97 hours.
[NeMo I 2025-04-17 01:54:53 collections:886] # 3133 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/49 [00:01<00:54,  1.13s/it][4/6] extract embeddings:   8%|▊         | 4/49 [00:01<00:11,  4.01it/s][4/6] extract embeddings:  14%|█▍        | 7/49 [00:01<00:05,  7.28it/s][4/6] extract embeddings:  20%|██        | 10/49 [00:01<00:03, 10.49it/s][4/6] extract embeddings:  27%|██▋       | 13/49 [00:01<00:02, 12.94it/s][4/6] extract embeddings:  33%|███▎      | 16/49 [00:01<00:02, 15.50it/s][4/6] extract embeddings:  39%|███▉      | 19/49 [00:01<00:01, 17.92it/s][4/6] extract embeddings:  45%|████▍     | 22/49 [00:02<00:01, 18.96it/s][4/6] extract embeddings:  51%|█████     | 25/49 [00:02<00:01, 20.25it/s][4/6] extract embeddings:  57%|█████▋    | 28/49 [00:02<00:01, 20.49it/s][4/6] extract embeddings:  63%|██████▎   | 31/49 [00:02<00:00, 21.30it/s][4/6] extract embeddings:  69%|██████▉   | 34/49 [00:02<00:00, 22.52it/s][4/6] extract embeddings:  76%|███████▌  | 37/49 [00:02<00:00, 22.51it/s][4/6] extract embeddings:  82%|████████▏ | 40/49 [00:02<00:00, 22.75it/s][4/6] extract embeddings:  88%|████████▊ | 43/49 [00:02<00:00, 21.95it/s][4/6] extract embeddings:  94%|█████████▍| 46/49 [00:03<00:00, 22.07it/s][4/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 21.46it/s][4/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 15.02it/s]
[NeMo I 2025-04-17 01:54:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:54:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:54:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:54:56 collections:880] Dataset successfully loaded with 4494 items and total duration provided from manifest is  1.05 hours.
[NeMo I 2025-04-17 01:54:56 collections:886] # 4494 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/71 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/71 [00:01<01:19,  1.13s/it][5/6] extract embeddings:   6%|▌         | 4/71 [00:01<00:16,  4.07it/s][5/6] extract embeddings:  10%|▉         | 7/71 [00:01<00:08,  7.37it/s][5/6] extract embeddings:  14%|█▍        | 10/71 [00:01<00:05, 10.65it/s][5/6] extract embeddings:  18%|█▊        | 13/71 [00:01<00:04, 13.96it/s][5/6] extract embeddings:  23%|██▎       | 16/71 [00:01<00:03, 16.95it/s][5/6] extract embeddings:  27%|██▋       | 19/71 [00:01<00:02, 19.44it/s][5/6] extract embeddings:  31%|███       | 22/71 [00:01<00:02, 21.60it/s][5/6] extract embeddings:  35%|███▌      | 25/71 [00:02<00:02, 22.63it/s][5/6] extract embeddings:  39%|███▉      | 28/71 [00:02<00:01, 23.85it/s][5/6] extract embeddings:  44%|████▎     | 31/71 [00:02<00:01, 24.96it/s][5/6] extract embeddings:  48%|████▊     | 34/71 [00:02<00:01, 24.80it/s][5/6] extract embeddings:  52%|█████▏    | 37/71 [00:02<00:01, 25.85it/s][5/6] extract embeddings:  56%|█████▋    | 40/71 [00:02<00:01, 26.34it/s][5/6] extract embeddings:  61%|██████    | 43/71 [00:02<00:01, 26.51it/s][5/6] extract embeddings:  65%|██████▍   | 46/71 [00:02<00:00, 26.88it/s][5/6] extract embeddings:  69%|██████▉   | 49/71 [00:02<00:00, 26.43it/s][5/6] extract embeddings:  73%|███████▎  | 52/71 [00:03<00:00, 25.32it/s][5/6] extract embeddings:  77%|███████▋  | 55/71 [00:03<00:00, 25.54it/s][5/6] extract embeddings:  83%|████████▎ | 59/71 [00:03<00:00, 27.00it/s][5/6] extract embeddings:  87%|████████▋ | 62/71 [00:03<00:00, 27.24it/s][5/6] extract embeddings:  92%|█████████▏| 65/71 [00:03<00:00, 27.32it/s][5/6] extract embeddings:  96%|█████████▌| 68/71 [00:03<00:00, 27.52it/s][5/6] extract embeddings: 100%|██████████| 71/71 [00:03<00:00, 27.94it/s][5/6] extract embeddings: 100%|██████████| 71/71 [00:03<00:00, 18.86it/s]
[NeMo I 2025-04-17 01:55:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:55:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:55:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:55:00 collections:880] Dataset successfully loaded with 8959 items and total duration provided from manifest is  1.17 hours.
[NeMo I 2025-04-17 01:55:00 collections:886] # 8959 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/140 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/140 [00:01<02:40,  1.15s/it][6/6] extract embeddings:   4%|▍         | 6/140 [00:01<00:21,  6.11it/s][6/6] extract embeddings:   7%|▋         | 10/140 [00:01<00:12, 10.37it/s][6/6] extract embeddings:   9%|▉         | 13/140 [00:01<00:09, 13.42it/s][6/6] extract embeddings:  12%|█▏        | 17/140 [00:01<00:07, 17.53it/s][6/6] extract embeddings:  15%|█▌        | 21/140 [00:01<00:05, 20.83it/s][6/6] extract embeddings:  18%|█▊        | 25/140 [00:01<00:04, 23.73it/s][6/6] extract embeddings:  21%|██        | 29/140 [00:02<00:04, 24.92it/s][6/6] extract embeddings:  24%|██▎       | 33/140 [00:02<00:03, 27.15it/s][6/6] extract embeddings:  26%|██▋       | 37/140 [00:02<00:03, 27.99it/s][6/6] extract embeddings:  29%|██▉       | 41/140 [00:02<00:03, 27.95it/s][6/6] extract embeddings:  31%|███▏      | 44/140 [00:02<00:03, 28.33it/s][6/6] extract embeddings:  34%|███▍      | 48/140 [00:02<00:03, 30.17it/s][6/6] extract embeddings:  37%|███▋      | 52/140 [00:02<00:02, 31.72it/s][6/6] extract embeddings:  40%|████      | 56/140 [00:02<00:02, 31.88it/s][6/6] extract embeddings:  43%|████▎     | 60/140 [00:03<00:02, 30.64it/s][6/6] extract embeddings:  46%|████▌     | 64/140 [00:03<00:02, 31.87it/s][6/6] extract embeddings:  49%|████▊     | 68/140 [00:03<00:02, 31.44it/s][6/6] extract embeddings:  51%|█████▏    | 72/140 [00:03<00:02, 31.93it/s][6/6] extract embeddings:  54%|█████▍    | 76/140 [00:03<00:01, 32.91it/s][6/6] extract embeddings:  57%|█████▋    | 80/140 [00:03<00:01, 32.22it/s][6/6] extract embeddings:  60%|██████    | 84/140 [00:03<00:01, 31.00it/s][6/6] extract embeddings:  63%|██████▎   | 88/140 [00:03<00:01, 32.04it/s][6/6] extract embeddings:  66%|██████▌   | 92/140 [00:03<00:01, 32.94it/s][6/6] extract embeddings:  69%|██████▊   | 96/140 [00:04<00:01, 31.79it/s][6/6] extract embeddings:  71%|███████▏  | 100/140 [00:04<00:01, 31.63it/s][6/6] extract embeddings:  74%|███████▍  | 104/140 [00:04<00:01, 32.13it/s][6/6] extract embeddings:  77%|███████▋  | 108/140 [00:04<00:00, 32.02it/s][6/6] extract embeddings:  80%|████████  | 112/140 [00:04<00:00, 31.93it/s][6/6] extract embeddings:  83%|████████▎ | 116/140 [00:04<00:00, 31.88it/s][6/6] extract embeddings:  86%|████████▌ | 120/140 [00:04<00:00, 32.77it/s][6/6] extract embeddings:  89%|████████▊ | 124/140 [00:04<00:00, 32.47it/s][6/6] extract embeddings:  91%|█████████▏| 128/140 [00:05<00:00, 33.20it/s][6/6] extract embeddings:  94%|█████████▍| 132/140 [00:05<00:00, 32.58it/s][6/6] extract embeddings:  97%|█████████▋| 136/140 [00:05<00:00, 32.37it/s][6/6] extract embeddings: 100%|██████████| 140/140 [00:05<00:00, 33.10it/s][6/6] extract embeddings: 100%|██████████| 140/140 [00:05<00:00, 25.47it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.26it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.02it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.62it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.24it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s]
[NeMo I 2025-04-17 01:55:07 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:55:09 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              55.579605   444.120  ...  12.870043  2.897875
    Harker-ES                       50.784210  2178.782  ...  42.686847  1.959207
    Harker-MN                       55.725353   366.767  ...  26.025995  7.096057
    Longfellow-Block-1              46.738485   492.417  ...   7.696966  1.563099
    TOTAL                           51.344160  3482.086  ...  89.279851  2.563976
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:55:09 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0473 | MISS: 0.4405 | CER: 0.0256 | DER: 0.5134 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.55, offset=0.45
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.55, <class 'float'> offset=0.45 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:04,  1.65s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.84s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.18s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:55:20 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:55:20 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:55:20 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:55:20 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:55:20 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:55:20 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:55:20 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:55:20 features:305] PADDING: 16
[NeMo I 2025-04-17 01:55:20 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:55:20 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:55:20 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:55:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:55:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:55:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:55:21 collections:880] Dataset successfully loaded with 2034 items and total duration provided from manifest is  0.79 hours.
[NeMo I 2025-04-17 01:55:21 collections:886] # 2034 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:59,  1.93s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.53it/s][1/6] extract embeddings:  19%|█▉        | 6/32 [00:02<00:06,  4.05it/s][1/6] extract embeddings:  25%|██▌       | 8/32 [00:02<00:04,  5.83it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:02,  7.74it/s][1/6] extract embeddings:  38%|███▊      | 12/32 [00:02<00:02,  9.58it/s][1/6] extract embeddings:  47%|████▋     | 15/32 [00:02<00:01, 12.21it/s][1/6] extract embeddings:  56%|█████▋    | 18/32 [00:02<00:00, 14.44it/s][1/6] extract embeddings:  66%|██████▌   | 21/32 [00:02<00:00, 16.25it/s][1/6] extract embeddings:  75%|███████▌  | 24/32 [00:03<00:00, 16.92it/s][1/6] extract embeddings:  81%|████████▏ | 26/32 [00:03<00:00, 17.40it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.65it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 18.40it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.17it/s]
[NeMo I 2025-04-17 01:55:24 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:55:24 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:55:24 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:55:24 collections:880] Dataset successfully loaded with 2217 items and total duration provided from manifest is  0.83 hours.
[NeMo I 2025-04-17 01:55:24 collections:886] # 2217 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:46,  1.37s/it][2/6] extract embeddings:   9%|▊         | 3/35 [00:01<00:12,  2.54it/s][2/6] extract embeddings:  17%|█▋        | 6/35 [00:01<00:05,  5.41it/s][2/6] extract embeddings:  26%|██▌       | 9/35 [00:01<00:03,  8.38it/s][2/6] extract embeddings:  31%|███▏      | 11/35 [00:01<00:02, 10.18it/s][2/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 11.78it/s][2/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 14.62it/s][2/6] extract embeddings:  54%|█████▍    | 19/35 [00:02<00:00, 16.11it/s][2/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 17.85it/s][2/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 18.79it/s][2/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 19.02it/s][2/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 18.96it/s][2/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 19.47it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 11.46it/s]
[NeMo I 2025-04-17 01:55:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:55:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:55:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:55:27 collections:880] Dataset successfully loaded with 2503 items and total duration provided from manifest is  0.88 hours.
[NeMo I 2025-04-17 01:55:27 collections:886] # 2503 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][3/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:43,  1.12s/it][3/6] extract embeddings:  10%|█         | 4/40 [00:01<00:09,  3.98it/s][3/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:04,  7.10it/s][3/6] extract embeddings:  25%|██▌       | 10/40 [00:01<00:02, 10.16it/s][3/6] extract embeddings:  30%|███       | 12/40 [00:01<00:02, 11.73it/s][3/6] extract embeddings:  38%|███▊      | 15/40 [00:01<00:01, 13.88it/s][3/6] extract embeddings:  45%|████▌     | 18/40 [00:01<00:01, 16.01it/s][3/6] extract embeddings:  52%|█████▎    | 21/40 [00:02<00:01, 17.56it/s][3/6] extract embeddings:  60%|██████    | 24/40 [00:02<00:00, 18.74it/s][3/6] extract embeddings:  68%|██████▊   | 27/40 [00:02<00:00, 19.76it/s][3/6] extract embeddings:  75%|███████▌  | 30/40 [00:02<00:00, 20.12it/s][3/6] extract embeddings:  82%|████████▎ | 33/40 [00:02<00:00, 20.90it/s][3/6] extract embeddings:  90%|█████████ | 36/40 [00:02<00:00, 21.00it/s][3/6] extract embeddings:  98%|█████████▊| 39/40 [00:02<00:00, 20.90it/s][3/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 13.49it/s]
[NeMo I 2025-04-17 01:55:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:55:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:55:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:55:31 collections:880] Dataset successfully loaded with 3094 items and total duration provided from manifest is  0.95 hours.
[NeMo I 2025-04-17 01:55:31 collections:886] # 3094 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/49 [00:01<00:53,  1.12s/it][4/6] extract embeddings:   8%|▊         | 4/49 [00:01<00:11,  4.05it/s][4/6] extract embeddings:  14%|█▍        | 7/49 [00:01<00:05,  7.37it/s][4/6] extract embeddings:  20%|██        | 10/49 [00:01<00:03, 10.55it/s][4/6] extract embeddings:  27%|██▋       | 13/49 [00:01<00:02, 13.44it/s][4/6] extract embeddings:  33%|███▎      | 16/49 [00:01<00:02, 15.67it/s][4/6] extract embeddings:  39%|███▉      | 19/49 [00:01<00:01, 18.07it/s][4/6] extract embeddings:  45%|████▍     | 22/49 [00:01<00:01, 19.43it/s][4/6] extract embeddings:  51%|█████     | 25/49 [00:02<00:01, 20.19it/s][4/6] extract embeddings:  57%|█████▋    | 28/49 [00:02<00:01, 20.86it/s][4/6] extract embeddings:  63%|██████▎   | 31/49 [00:02<00:00, 22.05it/s][4/6] extract embeddings:  69%|██████▉   | 34/49 [00:02<00:00, 22.87it/s][4/6] extract embeddings:  76%|███████▌  | 37/49 [00:02<00:00, 22.25it/s][4/6] extract embeddings:  82%|████████▏ | 40/49 [00:02<00:00, 22.95it/s][4/6] extract embeddings:  88%|████████▊ | 43/49 [00:02<00:00, 21.69it/s][4/6] extract embeddings:  94%|█████████▍| 46/49 [00:03<00:00, 23.02it/s][4/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 23.63it/s][4/6] extract embeddings: 100%|██████████| 49/49 [00:03<00:00, 15.39it/s]
[NeMo I 2025-04-17 01:55:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:55:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:55:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:55:34 collections:880] Dataset successfully loaded with 4424 items and total duration provided from manifest is  1.03 hours.
[NeMo I 2025-04-17 01:55:34 collections:886] # 4424 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/70 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/70 [00:01<01:17,  1.12s/it][5/6] extract embeddings:   6%|▌         | 4/70 [00:01<00:16,  4.12it/s][5/6] extract embeddings:  10%|█         | 7/70 [00:01<00:08,  7.56it/s][5/6] extract embeddings:  16%|█▌        | 11/70 [00:01<00:04, 11.92it/s][5/6] extract embeddings:  21%|██▏       | 15/70 [00:01<00:03, 15.73it/s][5/6] extract embeddings:  26%|██▌       | 18/70 [00:01<00:02, 18.21it/s][5/6] extract embeddings:  30%|███       | 21/70 [00:01<00:02, 20.48it/s][5/6] extract embeddings:  34%|███▍      | 24/70 [00:01<00:02, 22.19it/s][5/6] extract embeddings:  39%|███▊      | 27/70 [00:02<00:01, 23.20it/s][5/6] extract embeddings:  43%|████▎     | 30/70 [00:02<00:01, 24.61it/s][5/6] extract embeddings:  47%|████▋     | 33/70 [00:02<00:01, 25.27it/s][5/6] extract embeddings:  51%|█████▏    | 36/70 [00:02<00:01, 25.82it/s][5/6] extract embeddings:  56%|█████▌    | 39/70 [00:02<00:01, 25.46it/s][5/6] extract embeddings:  60%|██████    | 42/70 [00:02<00:01, 25.59it/s][5/6] extract embeddings:  64%|██████▍   | 45/70 [00:02<00:00, 25.92it/s][5/6] extract embeddings:  69%|██████▊   | 48/70 [00:02<00:00, 26.36it/s][5/6] extract embeddings:  73%|███████▎  | 51/70 [00:02<00:00, 24.92it/s][5/6] extract embeddings:  77%|███████▋  | 54/70 [00:03<00:00, 24.80it/s][5/6] extract embeddings:  81%|████████▏ | 57/70 [00:03<00:00, 24.82it/s][5/6] extract embeddings:  86%|████████▌ | 60/70 [00:03<00:00, 25.44it/s][5/6] extract embeddings:  90%|█████████ | 63/70 [00:03<00:00, 26.04it/s][5/6] extract embeddings:  94%|█████████▍| 66/70 [00:03<00:00, 26.53it/s][5/6] extract embeddings:  99%|█████████▊| 69/70 [00:03<00:00, 26.90it/s][5/6] extract embeddings: 100%|██████████| 70/70 [00:03<00:00, 18.80it/s]
[NeMo I 2025-04-17 01:55:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:55:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:55:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:55:38 collections:880] Dataset successfully loaded with 8810 items and total duration provided from manifest is  1.15 hours.
[NeMo I 2025-04-17 01:55:38 collections:886] # 8810 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/138 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/138 [00:01<02:33,  1.12s/it][6/6] extract embeddings:   4%|▎         | 5/138 [00:01<00:25,  5.28it/s][6/6] extract embeddings:   7%|▋         | 9/138 [00:01<00:12,  9.96it/s][6/6] extract embeddings:   9%|▉         | 13/138 [00:01<00:08, 14.35it/s][6/6] extract embeddings:  12%|█▏        | 17/138 [00:01<00:06, 18.28it/s][6/6] extract embeddings:  15%|█▌        | 21/138 [00:01<00:05, 21.85it/s][6/6] extract embeddings:  18%|█▊        | 25/138 [00:01<00:04, 24.71it/s][6/6] extract embeddings:  21%|██        | 29/138 [00:01<00:04, 26.69it/s][6/6] extract embeddings:  24%|██▍       | 33/138 [00:02<00:03, 28.18it/s][6/6] extract embeddings:  27%|██▋       | 37/138 [00:02<00:03, 30.29it/s][6/6] extract embeddings:  30%|██▉       | 41/138 [00:02<00:03, 31.30it/s][6/6] extract embeddings:  33%|███▎      | 45/138 [00:02<00:02, 31.64it/s][6/6] extract embeddings:  36%|███▌      | 49/138 [00:02<00:02, 30.44it/s][6/6] extract embeddings:  38%|███▊      | 53/138 [00:02<00:02, 31.17it/s][6/6] extract embeddings:  41%|████▏     | 57/138 [00:02<00:02, 31.31it/s][6/6] extract embeddings:  44%|████▍     | 61/138 [00:02<00:02, 31.89it/s][6/6] extract embeddings:  47%|████▋     | 65/138 [00:03<00:02, 32.31it/s][6/6] extract embeddings:  50%|█████     | 69/138 [00:03<00:02, 32.30it/s][6/6] extract embeddings:  53%|█████▎    | 73/138 [00:03<00:01, 32.65it/s][6/6] extract embeddings:  56%|█████▌    | 77/138 [00:03<00:01, 32.80it/s][6/6] extract embeddings:  59%|█████▊    | 81/138 [00:03<00:01, 33.03it/s][6/6] extract embeddings:  62%|██████▏   | 85/138 [00:03<00:01, 33.05it/s][6/6] extract embeddings:  64%|██████▍   | 89/138 [00:03<00:01, 32.15it/s][6/6] extract embeddings:  67%|██████▋   | 93/138 [00:03<00:01, 33.17it/s][6/6] extract embeddings:  70%|███████   | 97/138 [00:04<00:01, 33.36it/s][6/6] extract embeddings:  73%|███████▎  | 101/138 [00:04<00:01, 33.88it/s][6/6] extract embeddings:  76%|███████▌  | 105/138 [00:04<00:00, 33.72it/s][6/6] extract embeddings:  79%|███████▉  | 109/138 [00:04<00:00, 32.77it/s][6/6] extract embeddings:  82%|████████▏ | 113/138 [00:04<00:00, 32.84it/s][6/6] extract embeddings:  85%|████████▍ | 117/138 [00:04<00:00, 32.31it/s][6/6] extract embeddings:  88%|████████▊ | 121/138 [00:04<00:00, 32.55it/s][6/6] extract embeddings:  91%|█████████ | 125/138 [00:04<00:00, 32.90it/s][6/6] extract embeddings:  93%|█████████▎| 129/138 [00:05<00:00, 31.75it/s][6/6] extract embeddings:  96%|█████████▋| 133/138 [00:05<00:00, 33.18it/s][6/6] extract embeddings:  99%|█████████▉| 137/138 [00:05<00:00, 31.13it/s][6/6] extract embeddings: 100%|██████████| 138/138 [00:05<00:00, 25.98it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.22it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.05it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.64it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.84it/s]
[NeMo I 2025-04-17 01:55:45 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:55:46 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              55.852046   444.120  ...  11.960063  2.692980
    Harker-ES                       50.812269  2178.782  ...  30.154280  1.383997
    Harker-MN                       55.682555   366.767  ...  24.561987  6.696891
    Longfellow-Block-1              47.598943   492.417  ...   7.767970  1.577519
    TOTAL                           51.513639  3482.086  ...  74.444299  2.137922
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:55:46 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0461 | MISS: 0.4476 | CER: 0.0214 | DER: 0.5151 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.45
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.45 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.85s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:55:57 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:55:57 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:55:57 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:55:57 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:55:57 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:55:57 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:55:57 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:55:57 features:305] PADDING: 16
[NeMo I 2025-04-17 01:55:58 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:55:58 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:55:58 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:55:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:55:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:55:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:55:58 collections:880] Dataset successfully loaded with 2031 items and total duration provided from manifest is  0.77 hours.
[NeMo I 2025-04-17 01:55:58 collections:886] # 2031 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:59,  1.93s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.52it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.81it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.07it/s][1/6] extract embeddings:  38%|███▊      | 12/32 [00:02<00:02,  8.64it/s][1/6] extract embeddings:  47%|████▋     | 15/32 [00:02<00:01, 11.26it/s][1/6] extract embeddings:  53%|█████▎    | 17/32 [00:02<00:01, 12.58it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 13.47it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 15.56it/s][1/6] extract embeddings:  75%|███████▌  | 24/32 [00:03<00:00, 16.03it/s][1/6] extract embeddings:  84%|████████▍ | 27/32 [00:03<00:00, 17.26it/s][1/6] extract embeddings:  91%|█████████ | 29/32 [00:03<00:00, 17.55it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00, 19.25it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.17it/s]
[NeMo I 2025-04-17 01:56:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:56:01 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:01 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:01 collections:880] Dataset successfully loaded with 2208 items and total duration provided from manifest is  0.81 hours.
[NeMo I 2025-04-17 01:56:01 collections:886] # 2208 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:48,  1.44s/it][2/6] extract embeddings:  14%|█▍        | 5/35 [00:01<00:07,  4.03it/s][2/6] extract embeddings:  23%|██▎       | 8/35 [00:01<00:04,  6.62it/s][2/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02,  8.35it/s][2/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:02, 10.93it/s][2/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 13.61it/s][2/6] extract embeddings:  54%|█████▍    | 19/35 [00:02<00:01, 15.89it/s][2/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 17.50it/s][2/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 18.96it/s][2/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 19.55it/s][2/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 19.87it/s][2/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 20.60it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 11.73it/s]
[NeMo I 2025-04-17 01:56:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:56:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:05 collections:880] Dataset successfully loaded with 2484 items and total duration provided from manifest is  0.86 hours.
[NeMo I 2025-04-17 01:56:05 collections:886] # 2484 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:41,  1.10s/it][3/6] extract embeddings:  10%|█         | 4/39 [00:01<00:08,  4.07it/s][3/6] extract embeddings:  15%|█▌        | 6/39 [00:01<00:05,  6.23it/s][3/6] extract embeddings:  23%|██▎       | 9/39 [00:01<00:03,  9.47it/s][3/6] extract embeddings:  31%|███       | 12/39 [00:01<00:02, 12.29it/s][3/6] extract embeddings:  38%|███▊      | 15/39 [00:01<00:01, 15.01it/s][3/6] extract embeddings:  46%|████▌     | 18/39 [00:01<00:01, 16.75it/s][3/6] extract embeddings:  54%|█████▍    | 21/39 [00:02<00:00, 18.19it/s][3/6] extract embeddings:  62%|██████▏   | 24/39 [00:02<00:00, 18.96it/s][3/6] extract embeddings:  69%|██████▉   | 27/39 [00:02<00:00, 20.52it/s][3/6] extract embeddings:  77%|███████▋  | 30/39 [00:02<00:00, 20.74it/s][3/6] extract embeddings:  85%|████████▍ | 33/39 [00:02<00:00, 21.18it/s][3/6] extract embeddings:  92%|█████████▏| 36/39 [00:02<00:00, 20.33it/s][3/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 21.47it/s][3/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 13.60it/s]
[NeMo I 2025-04-17 01:56:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:56:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:08 collections:880] Dataset successfully loaded with 3055 items and total duration provided from manifest is  0.92 hours.
[NeMo I 2025-04-17 01:56:08 collections:886] # 3055 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/48 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/48 [00:01<00:52,  1.13s/it][4/6] extract embeddings:   8%|▊         | 4/48 [00:01<00:10,  4.05it/s][4/6] extract embeddings:  15%|█▍        | 7/48 [00:01<00:05,  7.26it/s][4/6] extract embeddings:  21%|██        | 10/48 [00:01<00:03, 10.30it/s][4/6] extract embeddings:  27%|██▋       | 13/48 [00:01<00:02, 13.04it/s][4/6] extract embeddings:  33%|███▎      | 16/48 [00:01<00:02, 15.64it/s][4/6] extract embeddings:  40%|███▉      | 19/48 [00:01<00:01, 17.66it/s][4/6] extract embeddings:  46%|████▌     | 22/48 [00:02<00:01, 19.85it/s][4/6] extract embeddings:  52%|█████▏    | 25/48 [00:02<00:01, 20.88it/s][4/6] extract embeddings:  58%|█████▊    | 28/48 [00:02<00:00, 21.99it/s][4/6] extract embeddings:  65%|██████▍   | 31/48 [00:02<00:00, 22.79it/s][4/6] extract embeddings:  71%|███████   | 34/48 [00:02<00:00, 23.61it/s][4/6] extract embeddings:  77%|███████▋  | 37/48 [00:02<00:00, 23.72it/s][4/6] extract embeddings:  83%|████████▎ | 40/48 [00:02<00:00, 22.70it/s][4/6] extract embeddings:  90%|████████▉ | 43/48 [00:02<00:00, 23.35it/s][4/6] extract embeddings:  96%|█████████▌| 46/48 [00:03<00:00, 23.60it/s][4/6] extract embeddings: 100%|██████████| 48/48 [00:03<00:00, 15.34it/s]
[NeMo I 2025-04-17 01:56:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:56:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:11 collections:880] Dataset successfully loaded with 4354 items and total duration provided from manifest is  1.01 hours.
[NeMo I 2025-04-17 01:56:11 collections:886] # 4354 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/69 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/69 [00:01<01:15,  1.11s/it][5/6] extract embeddings:   7%|▋         | 5/69 [00:01<00:12,  5.13it/s][5/6] extract embeddings:  12%|█▏        | 8/69 [00:01<00:07,  8.38it/s][5/6] extract embeddings:  16%|█▌        | 11/69 [00:01<00:04, 11.68it/s][5/6] extract embeddings:  20%|██        | 14/69 [00:01<00:03, 14.52it/s][5/6] extract embeddings:  25%|██▍       | 17/69 [00:01<00:02, 17.44it/s][5/6] extract embeddings:  29%|██▉       | 20/69 [00:01<00:02, 19.48it/s][5/6] extract embeddings:  33%|███▎      | 23/69 [00:01<00:02, 20.97it/s][5/6] extract embeddings:  38%|███▊      | 26/69 [00:02<00:01, 22.30it/s][5/6] extract embeddings:  42%|████▏     | 29/69 [00:02<00:01, 23.75it/s][5/6] extract embeddings:  46%|████▋     | 32/69 [00:02<00:01, 24.12it/s][5/6] extract embeddings:  51%|█████     | 35/69 [00:02<00:01, 25.13it/s][5/6] extract embeddings:  55%|█████▌    | 38/69 [00:02<00:01, 25.91it/s][5/6] extract embeddings:  59%|█████▉    | 41/69 [00:02<00:01, 26.74it/s][5/6] extract embeddings:  64%|██████▍   | 44/69 [00:02<00:00, 26.22it/s][5/6] extract embeddings:  68%|██████▊   | 47/69 [00:02<00:00, 26.92it/s][5/6] extract embeddings:  72%|███████▏  | 50/69 [00:02<00:00, 26.83it/s][5/6] extract embeddings:  78%|███████▊  | 54/69 [00:03<00:00, 27.43it/s][5/6] extract embeddings:  83%|████████▎ | 57/69 [00:03<00:00, 27.35it/s][5/6] extract embeddings:  87%|████████▋ | 60/69 [00:03<00:00, 26.43it/s][5/6] extract embeddings:  91%|█████████▏| 63/69 [00:03<00:00, 27.03it/s][5/6] extract embeddings:  96%|█████████▌| 66/69 [00:03<00:00, 26.31it/s][5/6] extract embeddings: 100%|██████████| 69/69 [00:03<00:00, 27.10it/s][5/6] extract embeddings: 100%|██████████| 69/69 [00:03<00:00, 18.84it/s]
[NeMo I 2025-04-17 01:56:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:56:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:15 collections:880] Dataset successfully loaded with 8649 items and total duration provided from manifest is  1.13 hours.
[NeMo I 2025-04-17 01:56:15 collections:886] # 8649 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/136 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/136 [00:01<02:29,  1.11s/it][6/6] extract embeddings:   4%|▎         | 5/136 [00:01<00:24,  5.34it/s][6/6] extract embeddings:   7%|▋         | 9/136 [00:01<00:12,  9.83it/s][6/6] extract embeddings:  10%|▉         | 13/136 [00:01<00:08, 14.08it/s][6/6] extract embeddings:  12%|█▎        | 17/136 [00:01<00:06, 17.88it/s][6/6] extract embeddings:  15%|█▌        | 21/136 [00:01<00:05, 21.39it/s][6/6] extract embeddings:  18%|█▊        | 25/136 [00:01<00:04, 24.17it/s][6/6] extract embeddings:  21%|██▏       | 29/136 [00:01<00:04, 26.54it/s][6/6] extract embeddings:  24%|██▍       | 33/136 [00:02<00:03, 28.21it/s][6/6] extract embeddings:  27%|██▋       | 37/136 [00:02<00:03, 29.30it/s][6/6] extract embeddings:  30%|███       | 41/136 [00:02<00:03, 30.46it/s][6/6] extract embeddings:  33%|███▎      | 45/136 [00:02<00:02, 31.80it/s][6/6] extract embeddings:  36%|███▌      | 49/136 [00:02<00:02, 31.62it/s][6/6] extract embeddings:  39%|███▉      | 53/136 [00:02<00:02, 30.83it/s][6/6] extract embeddings:  42%|████▏     | 57/136 [00:02<00:02, 31.97it/s][6/6] extract embeddings:  45%|████▍     | 61/136 [00:02<00:02, 32.37it/s][6/6] extract embeddings:  48%|████▊     | 65/136 [00:03<00:02, 32.46it/s][6/6] extract embeddings:  51%|█████     | 69/136 [00:03<00:02, 32.35it/s][6/6] extract embeddings:  54%|█████▎    | 73/136 [00:03<00:01, 32.57it/s][6/6] extract embeddings:  57%|█████▋    | 77/136 [00:03<00:01, 32.44it/s][6/6] extract embeddings:  60%|█████▉    | 81/136 [00:03<00:01, 32.65it/s][6/6] extract embeddings:  62%|██████▎   | 85/136 [00:03<00:01, 33.26it/s][6/6] extract embeddings:  65%|██████▌   | 89/136 [00:03<00:01, 33.96it/s][6/6] extract embeddings:  68%|██████▊   | 93/136 [00:03<00:01, 33.94it/s][6/6] extract embeddings:  71%|███████▏  | 97/136 [00:04<00:01, 33.16it/s][6/6] extract embeddings:  74%|███████▍  | 101/136 [00:04<00:01, 33.21it/s][6/6] extract embeddings:  77%|███████▋  | 105/136 [00:04<00:00, 34.03it/s][6/6] extract embeddings:  80%|████████  | 109/136 [00:04<00:00, 32.18it/s][6/6] extract embeddings:  83%|████████▎ | 113/136 [00:04<00:00, 32.21it/s][6/6] extract embeddings:  86%|████████▌ | 117/136 [00:04<00:00, 33.52it/s][6/6] extract embeddings:  89%|████████▉ | 121/136 [00:04<00:00, 33.26it/s][6/6] extract embeddings:  92%|█████████▏| 125/136 [00:04<00:00, 33.83it/s][6/6] extract embeddings:  95%|█████████▍| 129/136 [00:04<00:00, 34.02it/s][6/6] extract embeddings:  98%|█████████▊| 133/136 [00:05<00:00, 33.87it/s][6/6] extract embeddings: 100%|██████████| 136/136 [00:05<00:00, 26.10it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.15it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.06it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.65it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.84it/s]
[NeMo I 2025-04-17 01:56:22 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:56:23 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              57.081468   444.120  ...  13.810019  3.109524
    Harker-ES                       52.266413  2178.782  ...  38.534306  1.768617
    Harker-MN                       55.908596   366.767  ...  22.594001  6.160315
    Longfellow-Block-1              48.102778   492.417  ...   8.177973  1.660782
    TOTAL                           52.675377  3482.086  ...  83.116300  2.386969
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:56:23 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0454 | MISS: 0.4575 | CER: 0.0239 | DER: 0.5268 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.45
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.45 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.81s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:56:34 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:56:34 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:56:34 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:56:34 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:56:34 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:56:35 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:56:35 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:56:35 features:305] PADDING: 16
[NeMo I 2025-04-17 01:56:35 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:56:35 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:56:35 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:56:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:56:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:35 collections:880] Dataset successfully loaded with 2017 items and total duration provided from manifest is  0.75 hours.
[NeMo I 2025-04-17 01:56:35 collections:886] # 2017 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:03,  2.04s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.41it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.65it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.04it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:02,  9.17it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 11.49it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 13.22it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:03<00:00, 14.94it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 16.45it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.19it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 18.08it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.08it/s]
[NeMo I 2025-04-17 01:56:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:56:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:39 collections:880] Dataset successfully loaded with 2190 items and total duration provided from manifest is  0.79 hours.
[NeMo I 2025-04-17 01:56:39 collections:886] # 2190 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:46,  1.38s/it][2/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:09,  3.34it/s][2/6] extract embeddings:  20%|██        | 7/35 [00:01<00:04,  6.13it/s][2/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02,  8.75it/s][2/6] extract embeddings:  34%|███▍      | 12/35 [00:01<00:02, 10.25it/s][2/6] extract embeddings:  43%|████▎     | 15/35 [00:02<00:01, 13.02it/s][2/6] extract embeddings:  49%|████▊     | 17/35 [00:02<00:01, 14.16it/s][2/6] extract embeddings:  57%|█████▋    | 20/35 [00:02<00:00, 15.75it/s][2/6] extract embeddings:  66%|██████▌   | 23/35 [00:02<00:00, 17.81it/s][2/6] extract embeddings:  74%|███████▍  | 26/35 [00:02<00:00, 18.64it/s][2/6] extract embeddings:  83%|████████▎ | 29/35 [00:02<00:00, 19.26it/s][2/6] extract embeddings:  91%|█████████▏| 32/35 [00:02<00:00, 20.33it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 21.51it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:03<00:00, 11.62it/s]
[NeMo I 2025-04-17 01:56:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:56:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:42 collections:880] Dataset successfully loaded with 2452 items and total duration provided from manifest is  0.83 hours.
[NeMo I 2025-04-17 01:56:42 collections:886] # 2452 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:42,  1.11s/it][3/6] extract embeddings:  10%|█         | 4/39 [00:01<00:08,  4.05it/s][3/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  7.25it/s][3/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:02, 10.37it/s][3/6] extract embeddings:  33%|███▎      | 13/39 [00:01<00:01, 13.01it/s][3/6] extract embeddings:  41%|████      | 16/39 [00:01<00:01, 14.78it/s][3/6] extract embeddings:  49%|████▊     | 19/39 [00:01<00:01, 16.77it/s][3/6] extract embeddings:  56%|█████▋    | 22/39 [00:02<00:00, 18.43it/s][3/6] extract embeddings:  64%|██████▍   | 25/39 [00:02<00:00, 19.57it/s][3/6] extract embeddings:  72%|███████▏  | 28/39 [00:02<00:00, 20.43it/s][3/6] extract embeddings:  79%|███████▉  | 31/39 [00:02<00:00, 20.38it/s][3/6] extract embeddings:  87%|████████▋ | 34/39 [00:02<00:00, 20.25it/s][3/6] extract embeddings:  95%|█████████▍| 37/39 [00:02<00:00, 20.72it/s][3/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 13.70it/s]
[NeMo I 2025-04-17 01:56:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:56:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:45 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:45 collections:880] Dataset successfully loaded with 3008 items and total duration provided from manifest is  0.89 hours.
[NeMo I 2025-04-17 01:56:45 collections:886] # 3008 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:50,  1.10s/it][4/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:10,  4.16it/s][4/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:05,  7.48it/s][4/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:03, 10.72it/s][4/6] extract embeddings:  28%|██▊       | 13/47 [00:01<00:02, 13.71it/s][4/6] extract embeddings:  34%|███▍      | 16/47 [00:01<00:01, 16.01it/s][4/6] extract embeddings:  40%|████      | 19/47 [00:01<00:01, 18.33it/s][4/6] extract embeddings:  47%|████▋     | 22/47 [00:01<00:01, 20.36it/s][4/6] extract embeddings:  53%|█████▎    | 25/47 [00:02<00:01, 20.33it/s][4/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:00, 21.83it/s][4/6] extract embeddings:  66%|██████▌   | 31/47 [00:02<00:00, 22.73it/s][4/6] extract embeddings:  72%|███████▏  | 34/47 [00:02<00:00, 22.54it/s][4/6] extract embeddings:  79%|███████▊  | 37/47 [00:02<00:00, 23.00it/s][4/6] extract embeddings:  85%|████████▌ | 40/47 [00:02<00:00, 23.20it/s][4/6] extract embeddings:  91%|█████████▏| 43/47 [00:02<00:00, 23.43it/s][4/6] extract embeddings:  98%|█████████▊| 46/47 [00:02<00:00, 23.99it/s][4/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 15.53it/s]
[NeMo I 2025-04-17 01:56:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:56:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:48 collections:880] Dataset successfully loaded with 4266 items and total duration provided from manifest is  0.98 hours.
[NeMo I 2025-04-17 01:56:48 collections:886] # 4266 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/67 [00:00<?, ?it/s][5/6] extract embeddings:   1%|▏         | 1/67 [00:01<01:19,  1.20s/it][5/6] extract embeddings:   6%|▌         | 4/67 [00:01<00:16,  3.90it/s][5/6] extract embeddings:  10%|█         | 7/67 [00:01<00:08,  7.22it/s][5/6] extract embeddings:  15%|█▍        | 10/67 [00:01<00:05, 10.45it/s][5/6] extract embeddings:  19%|█▉        | 13/67 [00:01<00:03, 13.68it/s][5/6] extract embeddings:  24%|██▍       | 16/67 [00:01<00:03, 16.37it/s][5/6] extract embeddings:  28%|██▊       | 19/67 [00:01<00:02, 18.82it/s][5/6] extract embeddings:  33%|███▎      | 22/67 [00:01<00:02, 20.86it/s][5/6] extract embeddings:  37%|███▋      | 25/67 [00:02<00:01, 22.57it/s][5/6] extract embeddings:  42%|████▏     | 28/67 [00:02<00:01, 23.42it/s][5/6] extract embeddings:  46%|████▋     | 31/67 [00:02<00:01, 24.95it/s][5/6] extract embeddings:  51%|█████     | 34/67 [00:02<00:01, 25.58it/s][5/6] extract embeddings:  55%|█████▌    | 37/67 [00:02<00:01, 26.24it/s][5/6] extract embeddings:  60%|█████▉    | 40/67 [00:02<00:01, 26.05it/s][5/6] extract embeddings:  64%|██████▍   | 43/67 [00:02<00:00, 26.78it/s][5/6] extract embeddings:  69%|██████▊   | 46/67 [00:02<00:00, 26.05it/s][5/6] extract embeddings:  73%|███████▎  | 49/67 [00:02<00:00, 26.69it/s][5/6] extract embeddings:  78%|███████▊  | 52/67 [00:03<00:00, 26.40it/s][5/6] extract embeddings:  82%|████████▏ | 55/67 [00:03<00:00, 26.83it/s][5/6] extract embeddings:  87%|████████▋ | 58/67 [00:03<00:00, 26.58it/s][5/6] extract embeddings:  91%|█████████ | 61/67 [00:03<00:00, 27.21it/s][5/6] extract embeddings:  96%|█████████▌| 64/67 [00:03<00:00, 26.79it/s][5/6] extract embeddings: 100%|██████████| 67/67 [00:03<00:00, 26.25it/s][5/6] extract embeddings: 100%|██████████| 67/67 [00:03<00:00, 18.14it/s]
[NeMo I 2025-04-17 01:56:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:56:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:56:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:56:52 collections:880] Dataset successfully loaded with 8446 items and total duration provided from manifest is  1.10 hours.
[NeMo I 2025-04-17 01:56:52 collections:886] # 8446 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/132 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/132 [00:01<02:26,  1.12s/it][6/6] extract embeddings:   4%|▍         | 5/132 [00:01<00:23,  5.30it/s][6/6] extract embeddings:   7%|▋         | 9/132 [00:01<00:12,  9.79it/s][6/6] extract embeddings:  10%|▉         | 13/132 [00:01<00:08, 14.29it/s][6/6] extract embeddings:  13%|█▎        | 17/132 [00:01<00:06, 18.33it/s][6/6] extract embeddings:  16%|█▌        | 21/132 [00:01<00:05, 21.92it/s][6/6] extract embeddings:  19%|█▉        | 25/132 [00:01<00:04, 25.07it/s][6/6] extract embeddings:  22%|██▏       | 29/132 [00:01<00:03, 27.44it/s][6/6] extract embeddings:  25%|██▌       | 33/132 [00:02<00:03, 29.44it/s][6/6] extract embeddings:  28%|██▊       | 37/132 [00:02<00:03, 28.95it/s][6/6] extract embeddings:  31%|███       | 41/132 [00:02<00:03, 29.55it/s][6/6] extract embeddings:  34%|███▍      | 45/132 [00:02<00:02, 30.05it/s][6/6] extract embeddings:  37%|███▋      | 49/132 [00:02<00:02, 29.84it/s][6/6] extract embeddings:  40%|████      | 53/132 [00:02<00:02, 31.26it/s][6/6] extract embeddings:  43%|████▎     | 57/132 [00:02<00:02, 32.02it/s][6/6] extract embeddings:  46%|████▌     | 61/132 [00:02<00:02, 31.40it/s][6/6] extract embeddings:  49%|████▉     | 65/132 [00:03<00:02, 32.68it/s][6/6] extract embeddings:  52%|█████▏    | 69/132 [00:03<00:01, 32.63it/s][6/6] extract embeddings:  55%|█████▌    | 73/132 [00:03<00:01, 33.08it/s][6/6] extract embeddings:  58%|█████▊    | 77/132 [00:03<00:01, 33.48it/s][6/6] extract embeddings:  61%|██████▏   | 81/132 [00:03<00:01, 33.34it/s][6/6] extract embeddings:  64%|██████▍   | 85/132 [00:03<00:01, 33.06it/s][6/6] extract embeddings:  67%|██████▋   | 89/132 [00:03<00:01, 33.52it/s][6/6] extract embeddings:  70%|███████   | 93/132 [00:03<00:01, 33.47it/s][6/6] extract embeddings:  73%|███████▎  | 97/132 [00:04<00:01, 32.25it/s][6/6] extract embeddings:  77%|███████▋  | 101/132 [00:04<00:00, 32.77it/s][6/6] extract embeddings:  80%|███████▉  | 105/132 [00:04<00:00, 30.98it/s][6/6] extract embeddings:  83%|████████▎ | 109/132 [00:04<00:00, 31.23it/s][6/6] extract embeddings:  86%|████████▌ | 113/132 [00:04<00:00, 31.64it/s][6/6] extract embeddings:  89%|████████▊ | 117/132 [00:04<00:00, 32.58it/s][6/6] extract embeddings:  92%|█████████▏| 121/132 [00:04<00:00, 32.39it/s][6/6] extract embeddings:  95%|█████████▍| 125/132 [00:04<00:00, 33.36it/s][6/6] extract embeddings:  98%|█████████▊| 129/132 [00:05<00:00, 33.41it/s][6/6] extract embeddings: 100%|██████████| 132/132 [00:05<00:00, 25.73it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.31it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.19it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.80it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.44it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.00it/s]
[NeMo I 2025-04-17 01:56:59 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:57:00 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              58.484219   444.120  ...  15.420075  3.472051
    Harker-ES                       53.041079  2178.782  ...  32.237430  1.479608
    Harker-MN                       56.881155   366.767  ...  24.834042  6.771068
    Longfellow-Block-1              49.330169   492.417  ...   9.278956  1.884370
    TOTAL                           53.615018  3482.086  ...  81.770503  2.348319
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:57:00 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0438 | MISS: 0.4689 | CER: 0.0235 | DER: 0.5362 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.45
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.45 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.69s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.84s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.18s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:57:11 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:57:11 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:57:11 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:57:11 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:57:11 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:57:12 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:57:12 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:57:12 features:305] PADDING: 16
[NeMo I 2025-04-17 01:57:12 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:57:12 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:57:12 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:57:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:57:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:12 collections:880] Dataset successfully loaded with 2013 items and total duration provided from manifest is  0.72 hours.
[NeMo I 2025-04-17 01:57:12 collections:886] # 2013 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.94s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.51it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.84it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.26it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.67it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.25it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.21it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.00it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 17.24it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.62it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 19.02it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.50it/s]
[NeMo I 2025-04-17 01:57:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:57:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:16 collections:880] Dataset successfully loaded with 2178 items and total duration provided from manifest is  0.76 hours.
[NeMo I 2025-04-17 01:57:16 collections:886] # 2178 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:46,  1.36s/it][2/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:09,  3.33it/s][2/6] extract embeddings:  20%|██        | 7/35 [00:01<00:04,  6.10it/s][2/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02,  8.87it/s][2/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 11.26it/s][2/6] extract embeddings:  46%|████▌     | 16/35 [00:02<00:01, 13.71it/s][2/6] extract embeddings:  54%|█████▍    | 19/35 [00:02<00:01, 15.94it/s][2/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 17.50it/s][2/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 18.01it/s][2/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 18.95it/s][2/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 19.23it/s][2/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 20.13it/s][2/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 11.69it/s]
[NeMo I 2025-04-17 01:57:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:57:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:19 collections:880] Dataset successfully loaded with 2422 items and total duration provided from manifest is  0.80 hours.
[NeMo I 2025-04-17 01:57:19 collections:886] # 2422 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:41,  1.12s/it][3/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  4.03it/s][3/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  7.17it/s][3/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02,  9.92it/s][3/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 12.74it/s][3/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 15.12it/s][3/6] extract embeddings:  50%|█████     | 19/38 [00:01<00:01, 16.92it/s][3/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 18.19it/s][3/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 19.96it/s][3/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 20.56it/s][3/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 21.20it/s][3/6] extract embeddings:  89%|████████▉ | 34/38 [00:02<00:00, 20.90it/s][3/6] extract embeddings:  97%|█████████▋| 37/38 [00:02<00:00, 21.52it/s][3/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 13.51it/s]
[NeMo I 2025-04-17 01:57:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:57:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:22 collections:880] Dataset successfully loaded with 2955 items and total duration provided from manifest is  0.86 hours.
[NeMo I 2025-04-17 01:57:22 collections:886] # 2955 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:50,  1.11s/it][4/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:10,  4.17it/s][4/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:05,  7.38it/s][4/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:03, 10.78it/s][4/6] extract embeddings:  28%|██▊       | 13/47 [00:01<00:02, 13.05it/s][4/6] extract embeddings:  34%|███▍      | 16/47 [00:01<00:02, 15.37it/s][4/6] extract embeddings:  40%|████      | 19/47 [00:01<00:01, 17.31it/s][4/6] extract embeddings:  47%|████▋     | 22/47 [00:01<00:01, 19.26it/s][4/6] extract embeddings:  53%|█████▎    | 25/47 [00:02<00:01, 20.76it/s][4/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:00, 21.82it/s][4/6] extract embeddings:  66%|██████▌   | 31/47 [00:02<00:00, 22.65it/s][4/6] extract embeddings:  72%|███████▏  | 34/47 [00:02<00:00, 22.39it/s][4/6] extract embeddings:  79%|███████▊  | 37/47 [00:02<00:00, 22.51it/s][4/6] extract embeddings:  85%|████████▌ | 40/47 [00:02<00:00, 22.43it/s][4/6] extract embeddings:  91%|█████████▏| 43/47 [00:02<00:00, 22.94it/s][4/6] extract embeddings:  98%|█████████▊| 46/47 [00:03<00:00, 23.85it/s][4/6] extract embeddings: 100%|██████████| 47/47 [00:03<00:00, 15.33it/s]
[NeMo I 2025-04-17 01:57:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:57:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:25 collections:880] Dataset successfully loaded with 4167 items and total duration provided from manifest is  0.95 hours.
[NeMo I 2025-04-17 01:57:25 collections:886] # 4167 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/66 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/66 [00:01<01:12,  1.11s/it][5/6] extract embeddings:   6%|▌         | 4/66 [00:01<00:14,  4.21it/s][5/6] extract embeddings:  11%|█         | 7/66 [00:01<00:07,  7.63it/s][5/6] extract embeddings:  17%|█▋        | 11/66 [00:01<00:04, 12.23it/s][5/6] extract embeddings:  21%|██        | 14/66 [00:01<00:03, 14.96it/s][5/6] extract embeddings:  26%|██▌       | 17/66 [00:01<00:02, 17.78it/s][5/6] extract embeddings:  30%|███       | 20/66 [00:01<00:02, 19.76it/s][5/6] extract embeddings:  35%|███▍      | 23/66 [00:01<00:01, 21.81it/s][5/6] extract embeddings:  39%|███▉      | 26/66 [00:02<00:01, 22.66it/s][5/6] extract embeddings:  44%|████▍     | 29/66 [00:02<00:01, 24.19it/s][5/6] extract embeddings:  48%|████▊     | 32/66 [00:02<00:01, 24.73it/s][5/6] extract embeddings:  53%|█████▎    | 35/66 [00:02<00:01, 24.91it/s][5/6] extract embeddings:  58%|█████▊    | 38/66 [00:02<00:01, 23.96it/s][5/6] extract embeddings:  64%|██████▎   | 42/66 [00:02<00:00, 26.08it/s][5/6] extract embeddings:  68%|██████▊   | 45/66 [00:02<00:00, 25.81it/s][5/6] extract embeddings:  73%|███████▎  | 48/66 [00:02<00:00, 25.07it/s][5/6] extract embeddings:  79%|███████▉  | 52/66 [00:03<00:00, 26.43it/s][5/6] extract embeddings:  83%|████████▎ | 55/66 [00:03<00:00, 26.97it/s][5/6] extract embeddings:  88%|████████▊ | 58/66 [00:03<00:00, 27.41it/s][5/6] extract embeddings:  92%|█████████▏| 61/66 [00:03<00:00, 26.18it/s][5/6] extract embeddings:  97%|█████████▋| 64/66 [00:03<00:00, 26.49it/s][5/6] extract embeddings: 100%|██████████| 66/66 [00:03<00:00, 18.50it/s]
[NeMo I 2025-04-17 01:57:29 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:57:29 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:29 collections:880] Dataset successfully loaded with 8225 items and total duration provided from manifest is  1.06 hours.
[NeMo I 2025-04-17 01:57:29 collections:886] # 8225 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/129 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/129 [00:01<02:25,  1.14s/it][6/6] extract embeddings:   4%|▍         | 5/129 [00:01<00:24,  5.16it/s][6/6] extract embeddings:   7%|▋         | 9/129 [00:01<00:12,  9.57it/s][6/6] extract embeddings:   9%|▉         | 12/129 [00:01<00:09, 12.75it/s][6/6] extract embeddings:  12%|█▏        | 16/129 [00:01<00:06, 17.05it/s][6/6] extract embeddings:  16%|█▌        | 20/129 [00:01<00:05, 21.07it/s][6/6] extract embeddings:  19%|█▊        | 24/129 [00:01<00:04, 24.06it/s][6/6] extract embeddings:  22%|██▏       | 28/129 [00:01<00:03, 26.64it/s][6/6] extract embeddings:  25%|██▍       | 32/129 [00:02<00:03, 26.99it/s][6/6] extract embeddings:  28%|██▊       | 36/129 [00:02<00:03, 27.95it/s][6/6] extract embeddings:  31%|███       | 40/129 [00:02<00:03, 29.58it/s][6/6] extract embeddings:  34%|███▍      | 44/129 [00:02<00:02, 30.94it/s][6/6] extract embeddings:  37%|███▋      | 48/129 [00:02<00:02, 31.63it/s][6/6] extract embeddings:  40%|████      | 52/129 [00:02<00:02, 31.51it/s][6/6] extract embeddings:  43%|████▎     | 56/129 [00:02<00:02, 31.93it/s][6/6] extract embeddings:  47%|████▋     | 60/129 [00:02<00:02, 32.38it/s][6/6] extract embeddings:  50%|████▉     | 64/129 [00:03<00:01, 32.95it/s][6/6] extract embeddings:  53%|█████▎    | 68/129 [00:03<00:01, 33.68it/s][6/6] extract embeddings:  56%|█████▌    | 72/129 [00:03<00:01, 33.75it/s][6/6] extract embeddings:  59%|█████▉    | 76/129 [00:03<00:01, 33.18it/s][6/6] extract embeddings:  62%|██████▏   | 80/129 [00:03<00:01, 33.33it/s][6/6] extract embeddings:  65%|██████▌   | 84/129 [00:03<00:01, 33.20it/s][6/6] extract embeddings:  68%|██████▊   | 88/129 [00:03<00:01, 34.23it/s][6/6] extract embeddings:  71%|███████▏  | 92/129 [00:03<00:01, 32.16it/s][6/6] extract embeddings:  74%|███████▍  | 96/129 [00:04<00:01, 30.79it/s][6/6] extract embeddings:  78%|███████▊  | 100/129 [00:04<00:00, 31.13it/s][6/6] extract embeddings:  81%|████████  | 104/129 [00:04<00:00, 31.43it/s][6/6] extract embeddings:  84%|████████▎ | 108/129 [00:04<00:00, 32.14it/s][6/6] extract embeddings:  87%|████████▋ | 112/129 [00:04<00:00, 32.61it/s][6/6] extract embeddings:  90%|████████▉ | 116/129 [00:04<00:00, 31.74it/s][6/6] extract embeddings:  93%|█████████▎| 120/129 [00:04<00:00, 32.75it/s][6/6] extract embeddings:  96%|█████████▌| 124/129 [00:04<00:00, 33.58it/s][6/6] extract embeddings:  99%|█████████▉| 128/129 [00:05<00:00, 32.63it/s][6/6] extract embeddings: 100%|██████████| 129/129 [00:05<00:00, 25.37it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.29it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.21it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.85it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.50it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s]
[NeMo I 2025-04-17 01:57:36 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:57:37 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              58.671101   444.120  ...  12.499977  2.814549
    Harker-ES                       53.858429  2178.782  ...  30.081222  1.380644
    Harker-MN                       57.200452   366.767  ...  23.827995  6.496766
    Longfellow-Block-1              49.772471   492.417  ...   8.657987  1.758263
    TOTAL                           54.246458  3482.086  ...  75.067181  2.155811
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:57:37 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0415 | MISS: 0.4794 | CER: 0.0216 | DER: 0.5425 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.45
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.45 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.75s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:57:48 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:57:48 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:57:48 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:57:48 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:57:48 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:57:49 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:57:49 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:57:49 features:305] PADDING: 16
[NeMo I 2025-04-17 01:57:49 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:57:49 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:57:49 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:57:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:57:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:49 collections:880] Dataset successfully loaded with 2024 items and total duration provided from manifest is  0.69 hours.
[NeMo I 2025-04-17 01:57:49 collections:886] # 2024 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:03,  2.06s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.39it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.55it/s][1/6] extract embeddings:  28%|██▊       | 9/32 [00:02<00:03,  6.15it/s][1/6] extract embeddings:  34%|███▍      | 11/32 [00:02<00:02,  7.89it/s][1/6] extract embeddings:  44%|████▍     | 14/32 [00:02<00:01, 10.94it/s][1/6] extract embeddings:  53%|█████▎    | 17/32 [00:02<00:01, 13.54it/s][1/6] extract embeddings:  62%|██████▎   | 20/32 [00:02<00:00, 15.57it/s][1/6] extract embeddings:  72%|███████▏  | 23/32 [00:03<00:00, 16.86it/s][1/6] extract embeddings:  81%|████████▏ | 26/32 [00:03<00:00, 17.80it/s][1/6] extract embeddings:  91%|█████████ | 29/32 [00:03<00:00, 18.58it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00, 19.90it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.13it/s]
[NeMo I 2025-04-17 01:57:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:57:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:53 collections:880] Dataset successfully loaded with 2176 items and total duration provided from manifest is  0.73 hours.
[NeMo I 2025-04-17 01:57:53 collections:886] # 2176 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:45,  1.38s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:09,  3.31it/s][2/6] extract embeddings:  21%|██        | 7/34 [00:01<00:04,  6.09it/s][2/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02,  8.93it/s][2/6] extract embeddings:  38%|███▊      | 13/34 [00:01<00:01, 11.53it/s][2/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 13.98it/s][2/6] extract embeddings:  56%|█████▌    | 19/34 [00:02<00:00, 16.29it/s][2/6] extract embeddings:  65%|██████▍   | 22/34 [00:02<00:00, 17.15it/s][2/6] extract embeddings:  74%|███████▎  | 25/34 [00:02<00:00, 18.62it/s][2/6] extract embeddings:  82%|████████▏ | 28/34 [00:02<00:00, 19.07it/s][2/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 19.90it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 20.74it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.62it/s]
[NeMo I 2025-04-17 01:57:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:57:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:56 collections:880] Dataset successfully loaded with 2397 items and total duration provided from manifest is  0.76 hours.
[NeMo I 2025-04-17 01:57:56 collections:886] # 2397 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:41,  1.12s/it][3/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  4.03it/s][3/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  7.19it/s][3/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02, 10.41it/s][3/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 13.22it/s][3/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 15.67it/s][3/6] extract embeddings:  50%|█████     | 19/38 [00:01<00:01, 17.29it/s][3/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 18.90it/s][3/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 20.04it/s][3/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 20.40it/s][3/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 20.60it/s][3/6] extract embeddings:  89%|████████▉ | 34/38 [00:02<00:00, 20.63it/s][3/6] extract embeddings:  97%|█████████▋| 37/38 [00:02<00:00, 21.69it/s][3/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 13.75it/s]
[NeMo I 2025-04-17 01:57:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:57:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:57:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:57:59 collections:880] Dataset successfully loaded with 2897 items and total duration provided from manifest is  0.82 hours.
[NeMo I 2025-04-17 01:57:59 collections:886] # 2897 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:49,  1.11s/it][4/6] extract embeddings:   9%|▊         | 4/46 [00:01<00:10,  4.17it/s][4/6] extract embeddings:  15%|█▌        | 7/46 [00:01<00:05,  7.59it/s][4/6] extract embeddings:  22%|██▏       | 10/46 [00:01<00:03, 10.87it/s][4/6] extract embeddings:  28%|██▊       | 13/46 [00:01<00:02, 13.26it/s][4/6] extract embeddings:  35%|███▍      | 16/46 [00:01<00:01, 16.05it/s][4/6] extract embeddings:  41%|████▏     | 19/46 [00:01<00:01, 18.11it/s][4/6] extract embeddings:  48%|████▊     | 22/46 [00:01<00:01, 19.15it/s][4/6] extract embeddings:  54%|█████▍    | 25/46 [00:02<00:00, 21.17it/s][4/6] extract embeddings:  61%|██████    | 28/46 [00:02<00:00, 22.03it/s][4/6] extract embeddings:  67%|██████▋   | 31/46 [00:02<00:00, 23.08it/s][4/6] extract embeddings:  74%|███████▍  | 34/46 [00:02<00:00, 22.89it/s][4/6] extract embeddings:  80%|████████  | 37/46 [00:02<00:00, 22.50it/s][4/6] extract embeddings:  87%|████████▋ | 40/46 [00:02<00:00, 22.99it/s][4/6] extract embeddings:  93%|█████████▎| 43/46 [00:02<00:00, 23.34it/s][4/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 21.53it/s][4/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 15.14it/s]
[NeMo I 2025-04-17 01:58:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:58:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:58:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:58:02 collections:880] Dataset successfully loaded with 4043 items and total duration provided from manifest is  0.91 hours.
[NeMo I 2025-04-17 01:58:02 collections:886] # 4043 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/64 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/64 [00:01<01:10,  1.11s/it][5/6] extract embeddings:   8%|▊         | 5/64 [00:01<00:11,  5.18it/s][5/6] extract embeddings:  12%|█▎        | 8/64 [00:01<00:06,  8.49it/s][5/6] extract embeddings:  17%|█▋        | 11/64 [00:01<00:04, 11.92it/s][5/6] extract embeddings:  22%|██▏       | 14/64 [00:01<00:03, 15.16it/s][5/6] extract embeddings:  27%|██▋       | 17/64 [00:01<00:02, 17.68it/s][5/6] extract embeddings:  31%|███▏      | 20/64 [00:01<00:02, 19.98it/s][5/6] extract embeddings:  36%|███▌      | 23/64 [00:01<00:01, 22.35it/s][5/6] extract embeddings:  41%|████      | 26/64 [00:02<00:01, 23.10it/s][5/6] extract embeddings:  45%|████▌     | 29/64 [00:02<00:01, 24.69it/s][5/6] extract embeddings:  50%|█████     | 32/64 [00:02<00:01, 24.54it/s][5/6] extract embeddings:  55%|█████▍    | 35/64 [00:02<00:01, 25.48it/s][5/6] extract embeddings:  59%|█████▉    | 38/64 [00:02<00:01, 25.94it/s][5/6] extract embeddings:  64%|██████▍   | 41/64 [00:02<00:00, 26.19it/s][5/6] extract embeddings:  69%|██████▉   | 44/64 [00:02<00:00, 26.09it/s][5/6] extract embeddings:  73%|███████▎  | 47/64 [00:02<00:00, 25.71it/s][5/6] extract embeddings:  78%|███████▊  | 50/64 [00:02<00:00, 26.48it/s][5/6] extract embeddings:  83%|████████▎ | 53/64 [00:03<00:00, 27.00it/s][5/6] extract embeddings:  88%|████████▊ | 56/64 [00:03<00:00, 27.56it/s][5/6] extract embeddings:  92%|█████████▏| 59/64 [00:03<00:00, 28.22it/s][5/6] extract embeddings:  97%|█████████▋| 62/64 [00:03<00:00, 27.97it/s][5/6] extract embeddings: 100%|██████████| 64/64 [00:03<00:00, 18.71it/s]
[NeMo I 2025-04-17 01:58:06 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:58:06 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:58:06 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:58:06 collections:880] Dataset successfully loaded with 7930 items and total duration provided from manifest is  1.02 hours.
[NeMo I 2025-04-17 01:58:06 collections:886] # 7930 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/124 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/124 [00:01<02:15,  1.11s/it][6/6] extract embeddings:   5%|▍         | 6/124 [00:01<00:18,  6.30it/s][6/6] extract embeddings:   8%|▊         | 10/124 [00:01<00:10, 10.71it/s][6/6] extract embeddings:  11%|█▏        | 14/124 [00:01<00:07, 15.19it/s][6/6] extract embeddings:  15%|█▍        | 18/124 [00:01<00:05, 18.95it/s][6/6] extract embeddings:  18%|█▊        | 22/124 [00:01<00:04, 22.38it/s][6/6] extract embeddings:  21%|██        | 26/124 [00:01<00:03, 25.08it/s][6/6] extract embeddings:  24%|██▍       | 30/124 [00:01<00:03, 26.37it/s][6/6] extract embeddings:  27%|██▋       | 34/124 [00:02<00:03, 28.48it/s][6/6] extract embeddings:  31%|███       | 38/124 [00:02<00:02, 29.83it/s][6/6] extract embeddings:  34%|███▍      | 42/124 [00:02<00:02, 30.86it/s][6/6] extract embeddings:  37%|███▋      | 46/124 [00:02<00:02, 30.94it/s][6/6] extract embeddings:  40%|████      | 50/124 [00:02<00:02, 31.94it/s][6/6] extract embeddings:  44%|████▎     | 54/124 [00:02<00:02, 31.69it/s][6/6] extract embeddings:  47%|████▋     | 58/124 [00:02<00:02, 32.59it/s][6/6] extract embeddings:  50%|█████     | 62/124 [00:02<00:01, 33.51it/s][6/6] extract embeddings:  53%|█████▎    | 66/124 [00:03<00:01, 31.81it/s][6/6] extract embeddings:  56%|█████▋    | 70/124 [00:03<00:01, 32.65it/s][6/6] extract embeddings:  60%|█████▉    | 74/124 [00:03<00:01, 31.90it/s][6/6] extract embeddings:  63%|██████▎   | 78/124 [00:03<00:01, 32.50it/s][6/6] extract embeddings:  66%|██████▌   | 82/124 [00:03<00:01, 31.36it/s][6/6] extract embeddings:  69%|██████▉   | 86/124 [00:03<00:01, 32.17it/s][6/6] extract embeddings:  73%|███████▎  | 90/124 [00:03<00:01, 32.74it/s][6/6] extract embeddings:  76%|███████▌  | 94/124 [00:03<00:00, 32.56it/s][6/6] extract embeddings:  79%|███████▉  | 98/124 [00:04<00:00, 32.98it/s][6/6] extract embeddings:  82%|████████▏ | 102/124 [00:04<00:00, 33.40it/s][6/6] extract embeddings:  85%|████████▌ | 106/124 [00:04<00:00, 33.71it/s][6/6] extract embeddings:  89%|████████▊ | 110/124 [00:04<00:00, 32.45it/s][6/6] extract embeddings:  92%|█████████▏| 114/124 [00:04<00:00, 32.74it/s][6/6] extract embeddings:  95%|█████████▌| 118/124 [00:04<00:00, 33.24it/s][6/6] extract embeddings:  98%|█████████▊| 122/124 [00:04<00:00, 32.30it/s][6/6] extract embeddings: 100%|██████████| 124/124 [00:04<00:00, 25.53it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.38it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.24it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.92it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.60it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s]
[NeMo I 2025-04-17 01:58:12 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:58:13 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              60.402602   444.120  ...  14.619956  3.291893
    Harker-ES                       55.946484  2178.782  ...  43.185443  1.982091
    Harker-MN                       59.950626   366.767  ...  26.132930  7.125213
    Longfellow-Block-1              51.605879   492.417  ...  10.018016  2.034458
    TOTAL                           56.322767  3482.086  ...  93.956345  2.698278
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:58:13 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0403 | MISS: 0.4959 | CER: 0.0270 | DER: 0.5632 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.45
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.45 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.73s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.85s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:58:25 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:58:25 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:58:25 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:58:25 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:58:25 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:58:25 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:58:25 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:58:25 features:305] PADDING: 16
[NeMo I 2025-04-17 01:58:25 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:58:25 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:58:25 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:58:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:58:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:58:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:58:25 collections:880] Dataset successfully loaded with 2032 items and total duration provided from manifest is  0.66 hours.
[NeMo I 2025-04-17 01:58:25 collections:886] # 2032 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.94s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.52it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.86it/s][1/6] extract embeddings:  28%|██▊       | 9/32 [00:02<00:03,  6.47it/s][1/6] extract embeddings:  38%|███▊      | 12/32 [00:02<00:02,  9.15it/s][1/6] extract embeddings:  47%|████▋     | 15/32 [00:02<00:01, 11.71it/s][1/6] extract embeddings:  56%|█████▋    | 18/32 [00:02<00:00, 14.01it/s][1/6] extract embeddings:  66%|██████▌   | 21/32 [00:02<00:00, 15.56it/s][1/6] extract embeddings:  75%|███████▌  | 24/32 [00:02<00:00, 17.09it/s][1/6] extract embeddings:  84%|████████▍ | 27/32 [00:03<00:00, 18.64it/s][1/6] extract embeddings:  94%|█████████▍| 30/32 [00:03<00:00, 19.06it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.48it/s]
[NeMo I 2025-04-17 01:58:29 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:58:29 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:58:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:58:29 collections:880] Dataset successfully loaded with 2167 items and total duration provided from manifest is  0.69 hours.
[NeMo I 2025-04-17 01:58:29 collections:886] # 2167 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:45,  1.36s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:08,  3.40it/s][2/6] extract embeddings:  21%|██        | 7/34 [00:01<00:04,  6.32it/s][2/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02,  9.08it/s][2/6] extract embeddings:  38%|███▊      | 13/34 [00:01<00:01, 11.80it/s][2/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 13.77it/s][2/6] extract embeddings:  56%|█████▌    | 19/34 [00:02<00:00, 15.62it/s][2/6] extract embeddings:  65%|██████▍   | 22/34 [00:02<00:00, 17.24it/s][2/6] extract embeddings:  74%|███████▎  | 25/34 [00:02<00:00, 18.17it/s][2/6] extract embeddings:  82%|████████▏ | 28/34 [00:02<00:00, 19.51it/s][2/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 20.06it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 20.27it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.68it/s]
[NeMo I 2025-04-17 01:58:32 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:58:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:58:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:58:32 collections:880] Dataset successfully loaded with 2372 items and total duration provided from manifest is  0.72 hours.
[NeMo I 2025-04-17 01:58:32 collections:886] # 2372 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:41,  1.12s/it][3/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  4.00it/s][3/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  7.27it/s][3/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02, 10.37it/s][3/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 13.27it/s][3/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 15.34it/s][3/6] extract embeddings:  50%|█████     | 19/38 [00:01<00:01, 17.77it/s][3/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 18.43it/s][3/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 20.02it/s][3/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 20.21it/s][3/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 21.54it/s][3/6] extract embeddings:  89%|████████▉ | 34/38 [00:02<00:00, 21.51it/s][3/6] extract embeddings:  97%|█████████▋| 37/38 [00:02<00:00, 22.08it/s][3/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 13.71it/s]
[NeMo I 2025-04-17 01:58:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:58:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:58:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:58:35 collections:880] Dataset successfully loaded with 2833 items and total duration provided from manifest is  0.78 hours.
[NeMo I 2025-04-17 01:58:35 collections:886] # 2833 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/45 [00:01<00:49,  1.12s/it][4/6] extract embeddings:   9%|▉         | 4/45 [00:01<00:09,  4.11it/s][4/6] extract embeddings:  16%|█▌        | 7/45 [00:01<00:05,  7.46it/s][4/6] extract embeddings:  22%|██▏       | 10/45 [00:01<00:03, 10.72it/s][4/6] extract embeddings:  29%|██▉       | 13/45 [00:01<00:02, 13.30it/s][4/6] extract embeddings:  36%|███▌      | 16/45 [00:01<00:01, 15.89it/s][4/6] extract embeddings:  42%|████▏     | 19/45 [00:01<00:01, 18.08it/s][4/6] extract embeddings:  49%|████▉     | 22/45 [00:01<00:01, 20.24it/s][4/6] extract embeddings:  56%|█████▌    | 25/45 [00:02<00:00, 20.71it/s][4/6] extract embeddings:  62%|██████▏   | 28/45 [00:02<00:00, 22.25it/s][4/6] extract embeddings:  69%|██████▉   | 31/45 [00:02<00:00, 23.05it/s][4/6] extract embeddings:  76%|███████▌  | 34/45 [00:02<00:00, 21.99it/s][4/6] extract embeddings:  82%|████████▏ | 37/45 [00:02<00:00, 22.89it/s][4/6] extract embeddings:  89%|████████▉ | 40/45 [00:02<00:00, 23.10it/s][4/6] extract embeddings:  96%|█████████▌| 43/45 [00:02<00:00, 24.34it/s][4/6] extract embeddings: 100%|██████████| 45/45 [00:02<00:00, 15.35it/s]
[NeMo I 2025-04-17 01:58:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:58:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:58:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:58:38 collections:880] Dataset successfully loaded with 3900 items and total duration provided from manifest is  0.86 hours.
[NeMo I 2025-04-17 01:58:38 collections:886] # 3900 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/61 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/61 [00:01<01:08,  1.14s/it][5/6] extract embeddings:   8%|▊         | 5/61 [00:01<00:11,  5.03it/s][5/6] extract embeddings:  13%|█▎        | 8/61 [00:01<00:06,  8.07it/s][5/6] extract embeddings:  18%|█▊        | 11/61 [00:01<00:04, 11.09it/s][5/6] extract embeddings:  25%|██▍       | 15/61 [00:01<00:03, 15.12it/s][5/6] extract embeddings:  30%|██▉       | 18/61 [00:01<00:02, 17.39it/s][5/6] extract embeddings:  34%|███▍      | 21/61 [00:01<00:02, 19.50it/s][5/6] extract embeddings:  41%|████      | 25/61 [00:02<00:01, 21.90it/s][5/6] extract embeddings:  46%|████▌     | 28/61 [00:02<00:01, 23.16it/s][5/6] extract embeddings:  51%|█████     | 31/61 [00:02<00:01, 24.12it/s][5/6] extract embeddings:  56%|█████▌    | 34/61 [00:02<00:01, 25.29it/s][5/6] extract embeddings:  61%|██████    | 37/61 [00:02<00:00, 24.56it/s][5/6] extract embeddings:  66%|██████▌   | 40/61 [00:02<00:00, 25.57it/s][5/6] extract embeddings:  70%|███████   | 43/61 [00:02<00:00, 26.56it/s][5/6] extract embeddings:  75%|███████▌  | 46/61 [00:02<00:00, 26.17it/s][5/6] extract embeddings:  80%|████████  | 49/61 [00:02<00:00, 26.36it/s][5/6] extract embeddings:  85%|████████▌ | 52/61 [00:03<00:00, 24.44it/s][5/6] extract embeddings:  92%|█████████▏| 56/61 [00:03<00:00, 26.02it/s][5/6] extract embeddings:  98%|█████████▊| 60/61 [00:03<00:00, 27.08it/s][5/6] extract embeddings: 100%|██████████| 61/61 [00:03<00:00, 17.90it/s]
[NeMo I 2025-04-17 01:58:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:58:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:58:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:58:42 collections:880] Dataset successfully loaded with 7589 items and total duration provided from manifest is  0.97 hours.
[NeMo I 2025-04-17 01:58:42 collections:886] # 7589 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/119 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/119 [00:01<02:12,  1.13s/it][6/6] extract embeddings:   4%|▍         | 5/119 [00:01<00:21,  5.21it/s][6/6] extract embeddings:   8%|▊         | 9/119 [00:01<00:11,  9.78it/s][6/6] extract embeddings:  10%|█         | 12/119 [00:01<00:08, 12.83it/s][6/6] extract embeddings:  13%|█▎        | 16/119 [00:01<00:06, 17.08it/s][6/6] extract embeddings:  17%|█▋        | 20/119 [00:01<00:04, 21.07it/s][6/6] extract embeddings:  20%|██        | 24/119 [00:01<00:03, 24.46it/s][6/6] extract embeddings:  24%|██▎       | 28/119 [00:01<00:03, 26.98it/s][6/6] extract embeddings:  27%|██▋       | 32/119 [00:02<00:03, 28.40it/s][6/6] extract embeddings:  30%|███       | 36/119 [00:02<00:02, 30.44it/s][6/6] extract embeddings:  34%|███▎      | 40/119 [00:02<00:02, 31.16it/s][6/6] extract embeddings:  37%|███▋      | 44/119 [00:02<00:02, 32.13it/s][6/6] extract embeddings:  40%|████      | 48/119 [00:02<00:02, 32.48it/s][6/6] extract embeddings:  44%|████▎     | 52/119 [00:02<00:02, 33.01it/s][6/6] extract embeddings:  47%|████▋     | 56/119 [00:02<00:01, 33.28it/s][6/6] extract embeddings:  50%|█████     | 60/119 [00:02<00:01, 33.58it/s][6/6] extract embeddings:  54%|█████▍    | 64/119 [00:02<00:01, 33.72it/s][6/6] extract embeddings:  57%|█████▋    | 68/119 [00:03<00:01, 32.89it/s][6/6] extract embeddings:  61%|██████    | 72/119 [00:03<00:01, 33.28it/s][6/6] extract embeddings:  64%|██████▍   | 76/119 [00:03<00:01, 32.54it/s][6/6] extract embeddings:  67%|██████▋   | 80/119 [00:03<00:01, 33.34it/s][6/6] extract embeddings:  71%|███████   | 84/119 [00:03<00:01, 33.26it/s][6/6] extract embeddings:  74%|███████▍  | 88/119 [00:03<00:00, 33.30it/s][6/6] extract embeddings:  77%|███████▋  | 92/119 [00:03<00:00, 31.93it/s][6/6] extract embeddings:  81%|████████  | 96/119 [00:03<00:00, 32.62it/s][6/6] extract embeddings:  84%|████████▍ | 100/119 [00:04<00:00, 33.17it/s][6/6] extract embeddings:  87%|████████▋ | 104/119 [00:04<00:00, 32.59it/s][6/6] extract embeddings:  91%|█████████ | 108/119 [00:04<00:00, 33.01it/s][6/6] extract embeddings:  94%|█████████▍| 112/119 [00:04<00:00, 33.69it/s][6/6] extract embeddings:  97%|█████████▋| 116/119 [00:04<00:00, 33.69it/s][6/6] extract embeddings: 100%|██████████| 119/119 [00:04<00:00, 25.44it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.33it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.34it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.04it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.71it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s]
[NeMo I 2025-04-17 01:58:48 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:58:49 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              61.676993   444.120  ...  12.949987  2.915876
    Harker-ES                       57.288128  2178.782  ...  29.994479  1.376663
    Harker-MN                       60.865941   366.767  ...  23.670962  6.453951
    Longfellow-Block-1              53.319508   492.417  ...   9.167005  1.861635
    TOTAL                           57.663532  3482.086  ...  75.782433  2.176352
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:58:49 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0382 | MISS: 0.5167 | CER: 0.0218 | DER: 0.5766 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.45
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.45 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.78s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.89s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:59:01 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:59:01 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:59:01 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:59:01 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:59:01 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:59:01 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:59:01 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:59:01 features:305] PADDING: 16
[NeMo I 2025-04-17 01:59:01 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:59:01 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:59:01 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:59:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:59:01 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:01 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:01 collections:880] Dataset successfully loaded with 2032 items and total duration provided from manifest is  0.61 hours.
[NeMo I 2025-04-17 01:59:01 collections:886] # 2032 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.95s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.51it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.84it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:02,  7.35it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.72it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.32it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.37it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 15.97it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 17.31it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 18.09it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 19.75it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.57it/s]
[NeMo I 2025-04-17 01:59:05 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:59:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:05 collections:880] Dataset successfully loaded with 2140 items and total duration provided from manifest is  0.64 hours.
[NeMo I 2025-04-17 01:59:05 collections:886] # 2140 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:45,  1.39s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:08,  3.36it/s][2/6] extract embeddings:  21%|██        | 7/34 [00:01<00:04,  6.19it/s][2/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02,  9.14it/s][2/6] extract embeddings:  38%|███▊      | 13/34 [00:01<00:01, 12.00it/s][2/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 14.76it/s][2/6] extract embeddings:  56%|█████▌    | 19/34 [00:02<00:00, 17.16it/s][2/6] extract embeddings:  65%|██████▍   | 22/34 [00:02<00:00, 19.27it/s][2/6] extract embeddings:  74%|███████▎  | 25/34 [00:02<00:00, 20.96it/s][2/6] extract embeddings:  82%|████████▏ | 28/34 [00:02<00:00, 21.83it/s][2/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 22.55it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 24.30it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 12.38it/s]
[NeMo I 2025-04-17 01:59:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:59:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:08 collections:880] Dataset successfully loaded with 2324 items and total duration provided from manifest is  0.67 hours.
[NeMo I 2025-04-17 01:59:08 collections:886] # 2324 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:40,  1.12s/it][3/6] extract embeddings:  11%|█         | 4/37 [00:01<00:08,  4.10it/s][3/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  7.34it/s][3/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02, 10.55it/s][3/6] extract embeddings:  35%|███▌      | 13/37 [00:01<00:01, 12.93it/s][3/6] extract embeddings:  43%|████▎     | 16/37 [00:01<00:01, 15.63it/s][3/6] extract embeddings:  51%|█████▏    | 19/37 [00:01<00:01, 16.94it/s][3/6] extract embeddings:  59%|█████▉    | 22/37 [00:02<00:00, 18.62it/s][3/6] extract embeddings:  68%|██████▊   | 25/37 [00:02<00:00, 20.36it/s][3/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 21.64it/s][3/6] extract embeddings:  84%|████████▍ | 31/37 [00:02<00:00, 21.80it/s][3/6] extract embeddings:  92%|█████████▏| 34/37 [00:02<00:00, 22.72it/s][3/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 23.31it/s][3/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 13.82it/s]
[NeMo I 2025-04-17 01:59:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:59:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:11 collections:880] Dataset successfully loaded with 2719 items and total duration provided from manifest is  0.72 hours.
[NeMo I 2025-04-17 01:59:11 collections:886] # 2719 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:47,  1.13s/it][4/6] extract embeddings:   9%|▉         | 4/43 [00:01<00:09,  4.05it/s][4/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:04,  7.39it/s][4/6] extract embeddings:  23%|██▎       | 10/43 [00:01<00:03, 10.59it/s][4/6] extract embeddings:  30%|███       | 13/43 [00:01<00:02, 13.77it/s][4/6] extract embeddings:  37%|███▋      | 16/43 [00:01<00:01, 16.35it/s][4/6] extract embeddings:  44%|████▍     | 19/43 [00:01<00:01, 18.96it/s][4/6] extract embeddings:  51%|█████     | 22/43 [00:01<00:01, 20.98it/s][4/6] extract embeddings:  58%|█████▊    | 25/43 [00:02<00:00, 22.30it/s][4/6] extract embeddings:  67%|██████▋   | 29/43 [00:02<00:00, 24.21it/s][4/6] extract embeddings:  74%|███████▍  | 32/43 [00:02<00:00, 23.97it/s][4/6] extract embeddings:  81%|████████▏ | 35/43 [00:02<00:00, 23.90it/s][4/6] extract embeddings:  88%|████████▊ | 38/43 [00:02<00:00, 24.01it/s][4/6] extract embeddings:  95%|█████████▌| 41/43 [00:02<00:00, 24.77it/s][4/6] extract embeddings: 100%|██████████| 43/43 [00:02<00:00, 15.38it/s]
[NeMo I 2025-04-17 01:59:14 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:59:14 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:14 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:14 collections:880] Dataset successfully loaded with 3692 items and total duration provided from manifest is  0.79 hours.
[NeMo I 2025-04-17 01:59:14 collections:886] # 3692 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/58 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/58 [00:01<01:03,  1.11s/it][5/6] extract embeddings:   7%|▋         | 4/58 [00:01<00:12,  4.19it/s][5/6] extract embeddings:  12%|█▏        | 7/58 [00:01<00:06,  7.74it/s][5/6] extract embeddings:  17%|█▋        | 10/58 [00:01<00:04, 11.22it/s][5/6] extract embeddings:  22%|██▏       | 13/58 [00:01<00:03, 13.86it/s][5/6] extract embeddings:  28%|██▊       | 16/58 [00:01<00:02, 16.71it/s][5/6] extract embeddings:  34%|███▍      | 20/58 [00:01<00:01, 20.09it/s][5/6] extract embeddings:  40%|███▉      | 23/58 [00:01<00:01, 22.11it/s][5/6] extract embeddings:  45%|████▍     | 26/58 [00:02<00:01, 23.34it/s][5/6] extract embeddings:  52%|█████▏    | 30/58 [00:02<00:01, 25.06it/s][5/6] extract embeddings:  57%|█████▋    | 33/58 [00:02<00:00, 25.96it/s][5/6] extract embeddings:  62%|██████▏   | 36/58 [00:02<00:00, 26.42it/s][5/6] extract embeddings:  67%|██████▋   | 39/58 [00:02<00:00, 26.56it/s][5/6] extract embeddings:  72%|███████▏  | 42/58 [00:02<00:00, 26.63it/s][5/6] extract embeddings:  78%|███████▊  | 45/58 [00:02<00:00, 26.04it/s][5/6] extract embeddings:  83%|████████▎ | 48/58 [00:02<00:00, 26.32it/s][5/6] extract embeddings:  88%|████████▊ | 51/58 [00:02<00:00, 27.03it/s][5/6] extract embeddings:  93%|█████████▎| 54/58 [00:03<00:00, 27.37it/s][5/6] extract embeddings:  98%|█████████▊| 57/58 [00:03<00:00, 27.11it/s][5/6] extract embeddings: 100%|██████████| 58/58 [00:03<00:00, 18.01it/s]
[NeMo I 2025-04-17 01:59:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:59:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:17 collections:880] Dataset successfully loaded with 7114 items and total duration provided from manifest is  0.90 hours.
[NeMo I 2025-04-17 01:59:17 collections:886] # 7114 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/112 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/112 [00:01<02:04,  1.12s/it][6/6] extract embeddings:   4%|▍         | 5/112 [00:01<00:20,  5.21it/s][6/6] extract embeddings:   8%|▊         | 9/112 [00:01<00:10,  9.56it/s][6/6] extract embeddings:  12%|█▏        | 13/112 [00:01<00:07, 13.91it/s][6/6] extract embeddings:  15%|█▌        | 17/112 [00:01<00:05, 18.01it/s][6/6] extract embeddings:  19%|█▉        | 21/112 [00:01<00:04, 21.00it/s][6/6] extract embeddings:  22%|██▏       | 25/112 [00:01<00:03, 24.20it/s][6/6] extract embeddings:  26%|██▌       | 29/112 [00:01<00:03, 26.01it/s][6/6] extract embeddings:  29%|██▉       | 33/112 [00:02<00:02, 28.58it/s][6/6] extract embeddings:  33%|███▎      | 37/112 [00:02<00:02, 29.64it/s][6/6] extract embeddings:  37%|███▋      | 41/112 [00:02<00:02, 30.98it/s][6/6] extract embeddings:  40%|████      | 45/112 [00:02<00:02, 32.28it/s][6/6] extract embeddings:  44%|████▍     | 49/112 [00:02<00:01, 32.28it/s][6/6] extract embeddings:  47%|████▋     | 53/112 [00:02<00:01, 33.25it/s][6/6] extract embeddings:  51%|█████     | 57/112 [00:02<00:01, 33.61it/s][6/6] extract embeddings:  54%|█████▍    | 61/112 [00:02<00:01, 33.26it/s][6/6] extract embeddings:  58%|█████▊    | 65/112 [00:03<00:01, 33.86it/s][6/6] extract embeddings:  62%|██████▏   | 69/112 [00:03<00:01, 33.91it/s][6/6] extract embeddings:  65%|██████▌   | 73/112 [00:03<00:01, 34.12it/s][6/6] extract embeddings:  69%|██████▉   | 77/112 [00:03<00:01, 32.95it/s][6/6] extract embeddings:  72%|███████▏  | 81/112 [00:03<00:00, 33.06it/s][6/6] extract embeddings:  76%|███████▌  | 85/112 [00:03<00:00, 34.21it/s][6/6] extract embeddings:  79%|███████▉  | 89/112 [00:03<00:00, 33.27it/s][6/6] extract embeddings:  83%|████████▎ | 93/112 [00:03<00:00, 33.24it/s][6/6] extract embeddings:  87%|████████▋ | 97/112 [00:04<00:00, 32.57it/s][6/6] extract embeddings:  90%|█████████ | 101/112 [00:04<00:00, 32.89it/s][6/6] extract embeddings:  94%|█████████▍| 105/112 [00:04<00:00, 33.29it/s][6/6] extract embeddings:  97%|█████████▋| 109/112 [00:04<00:00, 32.39it/s][6/6] extract embeddings: 100%|██████████| 112/112 [00:04<00:00, 24.96it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.89it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.22it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.97it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.81it/s]
[NeMo I 2025-04-17 01:59:23 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:59:24 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              64.330529   444.120  ...  11.604988  2.613030
    Harker-ES                       59.594948  2178.782  ...  27.071916  1.242525
    Harker-MN                       62.647237   366.767  ...  24.448011  6.665815
    Longfellow-Block-1              55.991235   492.417  ...   9.898010  2.010087
    TOTAL                           60.010824  3482.086  ...  73.022925  2.097103
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:59:24 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0349 | MISS: 0.5443 | CER: 0.0210 | DER: 0.6001 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.45
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.45 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.85s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 01:59:36 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 01:59:36 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 01:59:36 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 01:59:36 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 01:59:36 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 01:59:36 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 01:59:36 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 01:59:36 features:305] PADDING: 16
[NeMo I 2025-04-17 01:59:36 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 01:59:36 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 01:59:36 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 01:59:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 01:59:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:36 collections:880] Dataset successfully loaded with 2000 items and total duration provided from manifest is  0.54 hours.
[NeMo I 2025-04-17 01:59:36 collections:886] # 2000 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:59,  1.92s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.52it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.86it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:02,  7.41it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.91it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.49it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 15.14it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 17.49it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 18.07it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 19.23it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 20.36it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.83it/s]
[NeMo I 2025-04-17 01:59:40 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 01:59:40 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:40 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:40 collections:880] Dataset successfully loaded with 2077 items and total duration provided from manifest is  0.56 hours.
[NeMo I 2025-04-17 01:59:40 collections:886] # 2077 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:43,  1.37s/it][2/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:08,  3.36it/s][2/6] extract embeddings:  21%|██        | 7/33 [00:01<00:04,  6.27it/s][2/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02,  9.01it/s][2/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 11.82it/s][2/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 14.43it/s][2/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 16.81it/s][2/6] extract embeddings:  67%|██████▋   | 22/33 [00:02<00:00, 18.87it/s][2/6] extract embeddings:  76%|███████▌  | 25/33 [00:02<00:00, 20.36it/s][2/6] extract embeddings:  85%|████████▍ | 28/33 [00:02<00:00, 21.45it/s][2/6] extract embeddings:  94%|█████████▍| 31/33 [00:02<00:00, 22.36it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 12.08it/s]
[NeMo I 2025-04-17 01:59:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 01:59:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:43 collections:880] Dataset successfully loaded with 2226 items and total duration provided from manifest is  0.58 hours.
[NeMo I 2025-04-17 01:59:43 collections:886] # 2226 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:38,  1.12s/it][3/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:07,  4.11it/s][3/6] extract embeddings:  20%|██        | 7/35 [00:01<00:03,  7.28it/s][3/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02, 10.52it/s][3/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 13.16it/s][3/6] extract embeddings:  46%|████▌     | 16/35 [00:01<00:01, 15.93it/s][3/6] extract embeddings:  54%|█████▍    | 19/35 [00:01<00:00, 18.31it/s][3/6] extract embeddings:  63%|██████▎   | 22/35 [00:01<00:00, 20.37it/s][3/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 21.20it/s][3/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 21.90it/s][3/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 22.15it/s][3/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 22.66it/s][3/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 13.74it/s]
[NeMo I 2025-04-17 01:59:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 01:59:45 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:46 collections:880] Dataset successfully loaded with 2558 items and total duration provided from manifest is  0.63 hours.
[NeMo I 2025-04-17 01:59:46 collections:886] # 2558 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:43,  1.12s/it][4/6] extract embeddings:  10%|█         | 4/40 [00:01<00:08,  4.15it/s][4/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:04,  7.53it/s][4/6] extract embeddings:  25%|██▌       | 10/40 [00:01<00:02, 10.79it/s][4/6] extract embeddings:  32%|███▎      | 13/40 [00:01<00:01, 13.66it/s][4/6] extract embeddings:  40%|████      | 16/40 [00:01<00:01, 16.47it/s][4/6] extract embeddings:  48%|████▊     | 19/40 [00:01<00:01, 18.95it/s][4/6] extract embeddings:  55%|█████▌    | 22/40 [00:01<00:00, 21.08it/s][4/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:00, 22.55it/s][4/6] extract embeddings:  70%|███████   | 28/40 [00:02<00:00, 23.13it/s][4/6] extract embeddings:  78%|███████▊  | 31/40 [00:02<00:00, 23.90it/s][4/6] extract embeddings:  85%|████████▌ | 34/40 [00:02<00:00, 23.78it/s][4/6] extract embeddings:  92%|█████████▎| 37/40 [00:02<00:00, 24.41it/s][4/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 24.74it/s][4/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 15.01it/s]
[NeMo I 2025-04-17 01:59:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 01:59:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:48 collections:880] Dataset successfully loaded with 3376 items and total duration provided from manifest is  0.69 hours.
[NeMo I 2025-04-17 01:59:48 collections:886] # 3376 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/53 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/53 [00:01<00:58,  1.12s/it][5/6] extract embeddings:   8%|▊         | 4/53 [00:01<00:11,  4.15it/s][5/6] extract embeddings:  13%|█▎        | 7/53 [00:01<00:06,  7.44it/s][5/6] extract embeddings:  19%|█▉        | 10/53 [00:01<00:03, 10.97it/s][5/6] extract embeddings:  25%|██▍       | 13/53 [00:01<00:02, 14.38it/s][5/6] extract embeddings:  30%|███       | 16/53 [00:01<00:02, 17.20it/s][5/6] extract embeddings:  36%|███▌      | 19/53 [00:01<00:01, 19.81it/s][5/6] extract embeddings:  42%|████▏     | 22/53 [00:01<00:01, 21.33it/s][5/6] extract embeddings:  49%|████▉     | 26/53 [00:02<00:01, 24.42it/s][5/6] extract embeddings:  55%|█████▍    | 29/53 [00:02<00:00, 25.24it/s][5/6] extract embeddings:  60%|██████    | 32/53 [00:02<00:00, 25.66it/s][5/6] extract embeddings:  66%|██████▌   | 35/53 [00:02<00:00, 26.18it/s][5/6] extract embeddings:  72%|███████▏  | 38/53 [00:02<00:00, 27.13it/s][5/6] extract embeddings:  79%|███████▉  | 42/53 [00:02<00:00, 27.68it/s][5/6] extract embeddings:  85%|████████▍ | 45/53 [00:02<00:00, 27.71it/s][5/6] extract embeddings:  91%|█████████ | 48/53 [00:02<00:00, 28.27it/s][5/6] extract embeddings:  96%|█████████▌| 51/53 [00:02<00:00, 27.42it/s][5/6] extract embeddings: 100%|██████████| 53/53 [00:03<00:00, 17.59it/s]
[NeMo I 2025-04-17 01:59:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 01:59:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 01:59:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 01:59:51 collections:880] Dataset successfully loaded with 6409 items and total duration provided from manifest is  0.80 hours.
[NeMo I 2025-04-17 01:59:51 collections:886] # 6409 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/101 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/101 [00:01<02:00,  1.21s/it][6/6] extract embeddings:   5%|▍         | 5/101 [00:01<00:19,  4.90it/s][6/6] extract embeddings:   9%|▉         | 9/101 [00:01<00:09,  9.26it/s][6/6] extract embeddings:  13%|█▎        | 13/101 [00:01<00:06, 13.51it/s][6/6] extract embeddings:  16%|█▌        | 16/101 [00:01<00:05, 16.23it/s][6/6] extract embeddings:  20%|█▉        | 20/101 [00:01<00:03, 20.60it/s][6/6] extract embeddings:  24%|██▍       | 24/101 [00:01<00:03, 23.37it/s][6/6] extract embeddings:  28%|██▊       | 28/101 [00:02<00:02, 26.16it/s][6/6] extract embeddings:  32%|███▏      | 32/101 [00:02<00:02, 28.33it/s][6/6] extract embeddings:  36%|███▌      | 36/101 [00:02<00:02, 28.68it/s][6/6] extract embeddings:  40%|███▉      | 40/101 [00:02<00:02, 30.48it/s][6/6] extract embeddings:  44%|████▎     | 44/101 [00:02<00:01, 30.45it/s][6/6] extract embeddings:  48%|████▊     | 48/101 [00:02<00:01, 31.52it/s][6/6] extract embeddings:  51%|█████▏    | 52/101 [00:02<00:01, 32.45it/s][6/6] extract embeddings:  55%|█████▌    | 56/101 [00:02<00:01, 33.43it/s][6/6] extract embeddings:  59%|█████▉    | 60/101 [00:02<00:01, 32.79it/s][6/6] extract embeddings:  63%|██████▎   | 64/101 [00:03<00:01, 33.32it/s][6/6] extract embeddings:  67%|██████▋   | 68/101 [00:03<00:01, 32.70it/s][6/6] extract embeddings:  71%|███████▏  | 72/101 [00:03<00:00, 32.51it/s][6/6] extract embeddings:  75%|███████▌  | 76/101 [00:03<00:00, 32.64it/s][6/6] extract embeddings:  79%|███████▉  | 80/101 [00:03<00:00, 32.50it/s][6/6] extract embeddings:  83%|████████▎ | 84/101 [00:03<00:00, 32.14it/s][6/6] extract embeddings:  87%|████████▋ | 88/101 [00:03<00:00, 32.81it/s][6/6] extract embeddings:  91%|█████████ | 92/101 [00:03<00:00, 33.29it/s][6/6] extract embeddings:  95%|█████████▌| 96/101 [00:04<00:00, 32.92it/s][6/6] extract embeddings:  99%|█████████▉| 100/101 [00:04<00:00, 33.54it/s][6/6] extract embeddings: 100%|██████████| 101/101 [00:04<00:00, 23.70it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:02,  1.11it/s]clustering:  50%|█████     | 2/4 [00:01<00:01,  1.72it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.52it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.33it/s]
[NeMo I 2025-04-17 01:59:58 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 01:59:59 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              67.581884   444.120  ...  12.824913  2.887713
    Harker-ES                       63.695307  2178.782  ...  27.762979  1.274243
    Harker-MN                       66.223818   366.767  ...  23.533982  6.416603
    Longfellow-Block-1              59.386956   492.417  ...  11.388016  2.312677
    TOTAL                           63.848082  3482.086  ...  75.509890  2.168525
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 01:59:59 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0305 | MISS: 0.5863 | CER: 0.0217 | DER: 0.6385 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.55, offset=0.50
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.55, <class 'float'> offset=0.5 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:00:11 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:00:11 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:00:11 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:00:11 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:00:11 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:00:11 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:00:11 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:00:11 features:305] PADDING: 16
[NeMo I 2025-04-17 02:00:11 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:00:11 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:00:11 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:00:11 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:00:11 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:11 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:11 collections:880] Dataset successfully loaded with 2015 items and total duration provided from manifest is  0.70 hours.
[NeMo I 2025-04-17 02:00:11 collections:886] # 2015 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:59,  1.94s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.52it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.84it/s][1/6] extract embeddings:  28%|██▊       | 9/32 [00:02<00:03,  6.45it/s][1/6] extract embeddings:  34%|███▍      | 11/32 [00:02<00:02,  8.23it/s][1/6] extract embeddings:  44%|████▍     | 14/32 [00:02<00:01, 11.09it/s][1/6] extract embeddings:  53%|█████▎    | 17/32 [00:02<00:01, 13.35it/s][1/6] extract embeddings:  62%|██████▎   | 20/32 [00:02<00:00, 15.40it/s][1/6] extract embeddings:  72%|███████▏  | 23/32 [00:02<00:00, 17.40it/s][1/6] extract embeddings:  81%|████████▏ | 26/32 [00:03<00:00, 17.86it/s][1/6] extract embeddings:  91%|█████████ | 29/32 [00:03<00:00, 18.49it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00, 20.47it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.46it/s]
[NeMo I 2025-04-17 02:00:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:00:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:15 collections:880] Dataset successfully loaded with 2172 items and total duration provided from manifest is  0.74 hours.
[NeMo I 2025-04-17 02:00:15 collections:886] # 2172 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:44,  1.36s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:08,  3.38it/s][2/6] extract embeddings:  21%|██        | 7/34 [00:01<00:04,  6.32it/s][2/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02,  9.12it/s][2/6] extract embeddings:  38%|███▊      | 13/34 [00:01<00:01, 11.83it/s][2/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 14.18it/s][2/6] extract embeddings:  56%|█████▌    | 19/34 [00:02<00:00, 16.62it/s][2/6] extract embeddings:  65%|██████▍   | 22/34 [00:02<00:00, 18.04it/s][2/6] extract embeddings:  74%|███████▎  | 25/34 [00:02<00:00, 19.86it/s][2/6] extract embeddings:  82%|████████▏ | 28/34 [00:02<00:00, 20.05it/s][2/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 20.11it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 21.09it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.91it/s]
[NeMo I 2025-04-17 02:00:18 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:00:18 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:18 collections:880] Dataset successfully loaded with 2413 items and total duration provided from manifest is  0.78 hours.
[NeMo I 2025-04-17 02:00:18 collections:886] # 2413 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:41,  1.13s/it][3/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  3.97it/s][3/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  7.06it/s][3/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02, 10.13it/s][3/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 12.83it/s][3/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 15.50it/s][3/6] extract embeddings:  50%|█████     | 19/38 [00:01<00:01, 17.57it/s][3/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 19.34it/s][3/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 20.83it/s][3/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 21.56it/s][3/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 21.39it/s][3/6] extract embeddings:  89%|████████▉ | 34/38 [00:02<00:00, 21.82it/s][3/6] extract embeddings:  97%|█████████▋| 37/38 [00:02<00:00, 22.30it/s][3/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 13.84it/s]
[NeMo I 2025-04-17 02:00:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:00:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:21 collections:880] Dataset successfully loaded with 2928 items and total duration provided from manifest is  0.84 hours.
[NeMo I 2025-04-17 02:00:21 collections:886] # 2928 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:50,  1.12s/it][4/6] extract embeddings:   9%|▊         | 4/46 [00:01<00:10,  4.08it/s][4/6] extract embeddings:  15%|█▌        | 7/46 [00:01<00:05,  7.48it/s][4/6] extract embeddings:  22%|██▏       | 10/46 [00:01<00:03, 10.64it/s][4/6] extract embeddings:  28%|██▊       | 13/46 [00:01<00:02, 13.64it/s][4/6] extract embeddings:  35%|███▍      | 16/46 [00:01<00:01, 15.69it/s][4/6] extract embeddings:  41%|████▏     | 19/46 [00:01<00:01, 17.97it/s][4/6] extract embeddings:  48%|████▊     | 22/46 [00:01<00:01, 20.00it/s][4/6] extract embeddings:  54%|█████▍    | 25/46 [00:02<00:00, 21.35it/s][4/6] extract embeddings:  61%|██████    | 28/46 [00:02<00:00, 21.71it/s][4/6] extract embeddings:  67%|██████▋   | 31/46 [00:02<00:00, 22.61it/s][4/6] extract embeddings:  74%|███████▍  | 34/46 [00:02<00:00, 22.99it/s][4/6] extract embeddings:  80%|████████  | 37/46 [00:02<00:00, 22.45it/s][4/6] extract embeddings:  87%|████████▋ | 40/46 [00:02<00:00, 22.73it/s][4/6] extract embeddings:  93%|█████████▎| 43/46 [00:02<00:00, 22.94it/s][4/6] extract embeddings: 100%|██████████| 46/46 [00:02<00:00, 23.58it/s][4/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 15.24it/s]
[NeMo I 2025-04-17 02:00:24 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:00:24 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:24 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:24 collections:880] Dataset successfully loaded with 4096 items and total duration provided from manifest is  0.93 hours.
[NeMo I 2025-04-17 02:00:24 collections:886] # 4096 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/64 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/64 [00:01<01:10,  1.12s/it][5/6] extract embeddings:   6%|▋         | 4/64 [00:01<00:14,  4.10it/s][5/6] extract embeddings:  11%|█         | 7/64 [00:01<00:07,  7.59it/s][5/6] extract embeddings:  16%|█▌        | 10/64 [00:01<00:04, 11.13it/s][5/6] extract embeddings:  20%|██        | 13/64 [00:01<00:03, 14.41it/s][5/6] extract embeddings:  25%|██▌       | 16/64 [00:01<00:02, 17.23it/s][5/6] extract embeddings:  30%|██▉       | 19/64 [00:01<00:02, 19.69it/s][5/6] extract embeddings:  34%|███▍      | 22/64 [00:01<00:01, 21.70it/s][5/6] extract embeddings:  39%|███▉      | 25/64 [00:01<00:01, 23.29it/s][5/6] extract embeddings:  44%|████▍     | 28/64 [00:02<00:01, 24.79it/s][5/6] extract embeddings:  48%|████▊     | 31/64 [00:02<00:01, 25.98it/s][5/6] extract embeddings:  53%|█████▎    | 34/64 [00:02<00:01, 26.29it/s][5/6] extract embeddings:  58%|█████▊    | 37/64 [00:02<00:01, 26.55it/s][5/6] extract embeddings:  62%|██████▎   | 40/64 [00:02<00:00, 26.41it/s][5/6] extract embeddings:  67%|██████▋   | 43/64 [00:02<00:00, 26.50it/s][5/6] extract embeddings:  72%|███████▏  | 46/64 [00:02<00:00, 26.91it/s][5/6] extract embeddings:  77%|███████▋  | 49/64 [00:02<00:00, 26.62it/s][5/6] extract embeddings:  81%|████████▏ | 52/64 [00:02<00:00, 27.53it/s][5/6] extract embeddings:  86%|████████▌ | 55/64 [00:03<00:00, 25.46it/s][5/6] extract embeddings:  91%|█████████ | 58/64 [00:03<00:00, 25.23it/s][5/6] extract embeddings:  97%|█████████▋| 62/64 [00:03<00:00, 26.39it/s][5/6] extract embeddings: 100%|██████████| 64/64 [00:03<00:00, 18.45it/s]
[NeMo I 2025-04-17 02:00:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:00:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:28 collections:880] Dataset successfully loaded with 8088 items and total duration provided from manifest is  1.04 hours.
[NeMo I 2025-04-17 02:00:28 collections:886] # 8088 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/127 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/127 [00:01<02:22,  1.13s/it][6/6] extract embeddings:   4%|▍         | 5/127 [00:01<00:23,  5.26it/s][6/6] extract embeddings:   7%|▋         | 9/127 [00:01<00:12,  9.72it/s][6/6] extract embeddings:   9%|▉         | 12/127 [00:01<00:08, 12.84it/s][6/6] extract embeddings:  13%|█▎        | 16/127 [00:01<00:06, 17.35it/s][6/6] extract embeddings:  16%|█▌        | 20/127 [00:01<00:05, 21.14it/s][6/6] extract embeddings:  19%|█▉        | 24/127 [00:01<00:04, 24.27it/s][6/6] extract embeddings:  22%|██▏       | 28/127 [00:01<00:03, 25.81it/s][6/6] extract embeddings:  25%|██▌       | 32/127 [00:02<00:03, 28.67it/s][6/6] extract embeddings:  28%|██▊       | 36/127 [00:02<00:03, 28.66it/s][6/6] extract embeddings:  31%|███▏      | 40/127 [00:02<00:02, 30.07it/s][6/6] extract embeddings:  35%|███▍      | 44/127 [00:02<00:02, 30.93it/s][6/6] extract embeddings:  38%|███▊      | 48/127 [00:02<00:02, 31.78it/s][6/6] extract embeddings:  41%|████      | 52/127 [00:02<00:02, 32.17it/s][6/6] extract embeddings:  44%|████▍     | 56/127 [00:02<00:02, 32.01it/s][6/6] extract embeddings:  47%|████▋     | 60/127 [00:02<00:02, 30.20it/s][6/6] extract embeddings:  50%|█████     | 64/127 [00:03<00:02, 31.06it/s][6/6] extract embeddings:  54%|█████▎    | 68/127 [00:03<00:01, 30.58it/s][6/6] extract embeddings:  57%|█████▋    | 72/127 [00:03<00:01, 30.30it/s][6/6] extract embeddings:  60%|█████▉    | 76/127 [00:03<00:01, 31.11it/s][6/6] extract embeddings:  63%|██████▎   | 80/127 [00:03<00:01, 30.24it/s][6/6] extract embeddings:  66%|██████▌   | 84/127 [00:03<00:01, 30.83it/s][6/6] extract embeddings:  69%|██████▉   | 88/127 [00:03<00:01, 31.64it/s][6/6] extract embeddings:  72%|███████▏  | 92/127 [00:03<00:01, 30.91it/s][6/6] extract embeddings:  76%|███████▌  | 96/127 [00:04<00:00, 31.98it/s][6/6] extract embeddings:  79%|███████▊  | 100/127 [00:04<00:00, 32.36it/s][6/6] extract embeddings:  82%|████████▏ | 104/127 [00:04<00:00, 33.17it/s][6/6] extract embeddings:  85%|████████▌ | 108/127 [00:04<00:00, 32.23it/s][6/6] extract embeddings:  88%|████████▊ | 112/127 [00:04<00:00, 31.47it/s][6/6] extract embeddings:  91%|█████████▏| 116/127 [00:04<00:00, 31.86it/s][6/6] extract embeddings:  94%|█████████▍| 120/127 [00:04<00:00, 31.68it/s][6/6] extract embeddings:  98%|█████████▊| 124/127 [00:04<00:00, 31.68it/s][6/6] extract embeddings: 100%|██████████| 127/127 [00:05<00:00, 24.96it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.38it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.22it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.85it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.52it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s]
[NeMo I 2025-04-17 02:00:35 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:00:36 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              57.948343   444.120  ...   9.269997  2.087273
    Harker-ES                       54.839075  2178.782  ...  31.678619  1.453960
    Harker-MN                       58.674370   366.767  ...  23.386007  6.376257
    Longfellow-Block-1              51.614018   492.417  ...  10.156998  2.062682
    TOTAL                           55.183545  3482.086  ...  74.491620  2.139281
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:00:36 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0415 | MISS: 0.4889 | CER: 0.0214 | DER: 0.5518 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.50
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.5 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.68s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.85s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:00:47 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:00:47 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:00:47 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:00:47 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:00:47 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:00:47 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:00:47 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:00:47 features:305] PADDING: 16
[NeMo I 2025-04-17 02:00:48 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:00:48 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:00:48 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:00:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:00:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:48 collections:880] Dataset successfully loaded with 2014 items and total duration provided from manifest is  0.68 hours.
[NeMo I 2025-04-17 02:00:48 collections:886] # 2014 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.94s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.53it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.78it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.16it/s][1/6] extract embeddings:  38%|███▊      | 12/32 [00:02<00:02,  8.74it/s][1/6] extract embeddings:  47%|████▋     | 15/32 [00:02<00:01, 11.45it/s][1/6] extract embeddings:  56%|█████▋    | 18/32 [00:02<00:01, 13.35it/s][1/6] extract embeddings:  66%|██████▌   | 21/32 [00:02<00:00, 15.51it/s][1/6] extract embeddings:  75%|███████▌  | 24/32 [00:03<00:00, 16.29it/s][1/6] extract embeddings:  84%|████████▍ | 27/32 [00:03<00:00, 17.10it/s][1/6] extract embeddings:  94%|█████████▍| 30/32 [00:03<00:00, 18.39it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.33it/s]
[NeMo I 2025-04-17 02:00:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:00:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:52 collections:880] Dataset successfully loaded with 2161 items and total duration provided from manifest is  0.72 hours.
[NeMo I 2025-04-17 02:00:52 collections:886] # 2161 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:45,  1.37s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:09,  3.32it/s][2/6] extract embeddings:  21%|██        | 7/34 [00:01<00:04,  6.18it/s][2/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02,  8.81it/s][2/6] extract embeddings:  35%|███▌      | 12/34 [00:01<00:02, 10.22it/s][2/6] extract embeddings:  44%|████▍     | 15/34 [00:02<00:01, 13.22it/s][2/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 14.83it/s][2/6] extract embeddings:  62%|██████▏   | 21/34 [00:02<00:00, 16.86it/s][2/6] extract embeddings:  71%|███████   | 24/34 [00:02<00:00, 18.33it/s][2/6] extract embeddings:  79%|███████▉  | 27/34 [00:02<00:00, 19.37it/s][2/6] extract embeddings:  88%|████████▊ | 30/34 [00:02<00:00, 19.83it/s][2/6] extract embeddings:  97%|█████████▋| 33/34 [00:02<00:00, 20.57it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.55it/s]
[NeMo I 2025-04-17 02:00:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:00:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:55 collections:880] Dataset successfully loaded with 2395 items and total duration provided from manifest is  0.76 hours.
[NeMo I 2025-04-17 02:00:55 collections:886] # 2395 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:43,  1.17s/it][3/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  3.83it/s][3/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  7.03it/s][3/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02, 10.22it/s][3/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 12.63it/s][3/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 15.31it/s][3/6] extract embeddings:  50%|█████     | 19/38 [00:01<00:01, 17.06it/s][3/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 18.55it/s][3/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 20.51it/s][3/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 20.66it/s][3/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 20.69it/s][3/6] extract embeddings:  89%|████████▉ | 34/38 [00:02<00:00, 21.54it/s][3/6] extract embeddings:  97%|█████████▋| 37/38 [00:02<00:00, 21.64it/s][3/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 13.52it/s]
[NeMo I 2025-04-17 02:00:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:00:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:00:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:00:58 collections:880] Dataset successfully loaded with 2890 items and total duration provided from manifest is  0.82 hours.
[NeMo I 2025-04-17 02:00:58 collections:886] # 2890 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:51,  1.14s/it][4/6] extract embeddings:   9%|▊         | 4/46 [00:01<00:10,  3.95it/s][4/6] extract embeddings:  15%|█▌        | 7/46 [00:01<00:05,  7.00it/s][4/6] extract embeddings:  22%|██▏       | 10/46 [00:01<00:03, 10.40it/s][4/6] extract embeddings:  28%|██▊       | 13/46 [00:01<00:02, 13.18it/s][4/6] extract embeddings:  35%|███▍      | 16/46 [00:01<00:01, 15.80it/s][4/6] extract embeddings:  41%|████▏     | 19/46 [00:01<00:01, 18.16it/s][4/6] extract embeddings:  48%|████▊     | 22/46 [00:02<00:01, 19.94it/s][4/6] extract embeddings:  54%|█████▍    | 25/46 [00:02<00:01, 20.92it/s][4/6] extract embeddings:  61%|██████    | 28/46 [00:02<00:00, 21.96it/s][4/6] extract embeddings:  67%|██████▋   | 31/46 [00:02<00:00, 22.12it/s][4/6] extract embeddings:  74%|███████▍  | 34/46 [00:02<00:00, 22.73it/s][4/6] extract embeddings:  80%|████████  | 37/46 [00:02<00:00, 23.66it/s][4/6] extract embeddings:  87%|████████▋ | 40/46 [00:02<00:00, 23.69it/s][4/6] extract embeddings:  93%|█████████▎| 43/46 [00:02<00:00, 24.56it/s][4/6] extract embeddings: 100%|██████████| 46/46 [00:02<00:00, 25.49it/s][4/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 15.29it/s]
[NeMo I 2025-04-17 02:01:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:01:01 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:01:01 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:01:01 collections:880] Dataset successfully loaded with 4028 items and total duration provided from manifest is  0.90 hours.
[NeMo I 2025-04-17 02:01:01 collections:886] # 4028 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/63 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/63 [00:01<01:08,  1.11s/it][5/6] extract embeddings:   6%|▋         | 4/63 [00:01<00:14,  4.21it/s][5/6] extract embeddings:  11%|█         | 7/63 [00:01<00:07,  7.63it/s][5/6] extract embeddings:  16%|█▌        | 10/63 [00:01<00:04, 11.00it/s][5/6] extract embeddings:  22%|██▏       | 14/63 [00:01<00:03, 15.25it/s][5/6] extract embeddings:  27%|██▋       | 17/63 [00:01<00:02, 17.79it/s][5/6] extract embeddings:  32%|███▏      | 20/63 [00:01<00:02, 20.20it/s][5/6] extract embeddings:  37%|███▋      | 23/63 [00:01<00:01, 22.43it/s][5/6] extract embeddings:  41%|████▏     | 26/63 [00:02<00:01, 23.89it/s][5/6] extract embeddings:  46%|████▌     | 29/63 [00:02<00:01, 24.46it/s][5/6] extract embeddings:  51%|█████     | 32/63 [00:02<00:01, 25.16it/s][5/6] extract embeddings:  56%|█████▌    | 35/63 [00:02<00:01, 25.41it/s][5/6] extract embeddings:  60%|██████    | 38/63 [00:02<00:01, 24.91it/s][5/6] extract embeddings:  65%|██████▌   | 41/63 [00:02<00:00, 25.62it/s][5/6] extract embeddings:  70%|██████▉   | 44/63 [00:02<00:00, 26.10it/s][5/6] extract embeddings:  75%|███████▍  | 47/63 [00:02<00:00, 26.43it/s][5/6] extract embeddings:  79%|███████▉  | 50/63 [00:02<00:00, 26.06it/s][5/6] extract embeddings:  84%|████████▍ | 53/63 [00:03<00:00, 25.54it/s][5/6] extract embeddings:  89%|████████▉ | 56/63 [00:03<00:00, 25.37it/s][5/6] extract embeddings:  94%|█████████▎| 59/63 [00:03<00:00, 25.78it/s][5/6] extract embeddings:  98%|█████████▊| 62/63 [00:03<00:00, 26.02it/s][5/6] extract embeddings: 100%|██████████| 63/63 [00:03<00:00, 18.24it/s]
[NeMo I 2025-04-17 02:01:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:01:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:01:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:01:05 collections:880] Dataset successfully loaded with 7916 items and total duration provided from manifest is  1.02 hours.
[NeMo I 2025-04-17 02:01:05 collections:886] # 7916 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/124 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/124 [00:01<02:17,  1.12s/it][6/6] extract embeddings:   4%|▍         | 5/124 [00:01<00:22,  5.28it/s][6/6] extract embeddings:   6%|▋         | 8/124 [00:01<00:13,  8.57it/s][6/6] extract embeddings:  10%|▉         | 12/124 [00:01<00:08, 13.13it/s][6/6] extract embeddings:  13%|█▎        | 16/124 [00:01<00:06, 17.41it/s][6/6] extract embeddings:  16%|█▌        | 20/124 [00:01<00:04, 21.10it/s][6/6] extract embeddings:  19%|█▉        | 24/124 [00:01<00:04, 24.27it/s][6/6] extract embeddings:  23%|██▎       | 28/124 [00:01<00:03, 26.52it/s][6/6] extract embeddings:  26%|██▌       | 32/124 [00:02<00:03, 28.12it/s][6/6] extract embeddings:  29%|██▉       | 36/124 [00:02<00:02, 29.35it/s][6/6] extract embeddings:  32%|███▏      | 40/124 [00:02<00:02, 30.91it/s][6/6] extract embeddings:  35%|███▌      | 44/124 [00:02<00:02, 31.80it/s][6/6] extract embeddings:  39%|███▊      | 48/124 [00:02<00:02, 32.42it/s][6/6] extract embeddings:  42%|████▏     | 52/124 [00:02<00:02, 31.39it/s][6/6] extract embeddings:  45%|████▌     | 56/124 [00:02<00:02, 31.58it/s][6/6] extract embeddings:  48%|████▊     | 60/124 [00:02<00:01, 32.82it/s][6/6] extract embeddings:  52%|█████▏    | 64/124 [00:03<00:01, 32.12it/s][6/6] extract embeddings:  55%|█████▍    | 68/124 [00:03<00:01, 32.79it/s][6/6] extract embeddings:  58%|█████▊    | 72/124 [00:03<00:01, 32.62it/s][6/6] extract embeddings:  61%|██████▏   | 76/124 [00:03<00:01, 31.52it/s][6/6] extract embeddings:  65%|██████▍   | 80/124 [00:03<00:01, 32.47it/s][6/6] extract embeddings:  68%|██████▊   | 84/124 [00:03<00:01, 33.01it/s][6/6] extract embeddings:  71%|███████   | 88/124 [00:03<00:01, 32.47it/s][6/6] extract embeddings:  74%|███████▍  | 92/124 [00:03<00:01, 31.79it/s][6/6] extract embeddings:  77%|███████▋  | 96/124 [00:04<00:00, 31.44it/s][6/6] extract embeddings:  81%|████████  | 100/124 [00:04<00:00, 32.81it/s][6/6] extract embeddings:  84%|████████▍ | 104/124 [00:04<00:00, 33.19it/s][6/6] extract embeddings:  87%|████████▋ | 108/124 [00:04<00:00, 32.84it/s][6/6] extract embeddings:  90%|█████████ | 112/124 [00:04<00:00, 31.58it/s][6/6] extract embeddings:  94%|█████████▎| 116/124 [00:04<00:00, 30.34it/s][6/6] extract embeddings:  97%|█████████▋| 120/124 [00:04<00:00, 31.02it/s][6/6] extract embeddings: 100%|██████████| 124/124 [00:04<00:00, 32.38it/s][6/6] extract embeddings: 100%|██████████| 124/124 [00:04<00:00, 25.13it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.34it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.25it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.91it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.59it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s]
[NeMo I 2025-04-17 02:01:11 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:01:12 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              59.124862   444.120  ...  10.964974  2.468921
    Harker-ES                       56.006005  2178.782  ...  34.205704  1.569946
    Harker-MN                       58.858958   366.767  ...  22.301010  6.080430
    Longfellow-Block-1              52.322363   492.417  ...  10.483992  2.129088
    TOTAL                           56.183378  3482.086  ...  77.955680  2.238764
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:01:12 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0405 | MISS: 0.4990 | CER: 0.0224 | DER: 0.5618 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.50
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.5 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.71s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.86s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:01:24 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:01:24 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:01:24 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:01:24 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:01:24 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:01:24 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:01:24 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:01:24 features:305] PADDING: 16
[NeMo I 2025-04-17 02:01:25 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:01:25 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:01:25 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:01:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:01:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:01:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:01:25 collections:880] Dataset successfully loaded with 2010 items and total duration provided from manifest is  0.66 hours.
[NeMo I 2025-04-17 02:01:25 collections:886] # 2010 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:59,  1.91s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:10,  2.55it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.87it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.31it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.62it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.14it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.12it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.13it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 17.59it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.87it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 18.76it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.56it/s]
[NeMo I 2025-04-17 02:01:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:01:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:01:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:01:28 collections:880] Dataset successfully loaded with 2153 items and total duration provided from manifest is  0.70 hours.
[NeMo I 2025-04-17 02:01:28 collections:886] # 2153 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:44,  1.35s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:08,  3.36it/s][2/6] extract embeddings:  21%|██        | 7/34 [00:01<00:04,  6.28it/s][2/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02,  9.08it/s][2/6] extract embeddings:  38%|███▊      | 13/34 [00:01<00:01, 11.62it/s][2/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 13.97it/s][2/6] extract embeddings:  56%|█████▌    | 19/34 [00:02<00:00, 15.34it/s][2/6] extract embeddings:  65%|██████▍   | 22/34 [00:02<00:00, 17.19it/s][2/6] extract embeddings:  74%|███████▎  | 25/34 [00:02<00:00, 18.11it/s][2/6] extract embeddings:  82%|████████▏ | 28/34 [00:02<00:00, 18.72it/s][2/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 18.78it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 20.36it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.60it/s]
[NeMo I 2025-04-17 02:01:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:01:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:01:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:01:31 collections:880] Dataset successfully loaded with 2375 items and total duration provided from manifest is  0.74 hours.
[NeMo I 2025-04-17 02:01:31 collections:886] # 2375 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:41,  1.12s/it][3/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  4.03it/s][3/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  7.19it/s][3/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02, 10.40it/s][3/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 12.77it/s][3/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 15.55it/s][3/6] extract embeddings:  50%|█████     | 19/38 [00:01<00:01, 17.25it/s][3/6] extract embeddings:  58%|█████▊    | 22/38 [00:02<00:00, 18.72it/s][3/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 20.30it/s][3/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 21.41it/s][3/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 21.92it/s][3/6] extract embeddings:  89%|████████▉ | 34/38 [00:02<00:00, 22.34it/s][3/6] extract embeddings:  97%|█████████▋| 37/38 [00:02<00:00, 21.99it/s][3/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 13.85it/s]
[NeMo I 2025-04-17 02:01:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:01:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:01:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:01:34 collections:880] Dataset successfully loaded with 2854 items and total duration provided from manifest is  0.80 hours.
[NeMo I 2025-04-17 02:01:34 collections:886] # 2854 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/45 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/45 [00:01<00:49,  1.11s/it][4/6] extract embeddings:   9%|▉         | 4/45 [00:01<00:10,  4.08it/s][4/6] extract embeddings:  16%|█▌        | 7/45 [00:01<00:05,  7.36it/s][4/6] extract embeddings:  22%|██▏       | 10/45 [00:01<00:03, 10.54it/s][4/6] extract embeddings:  29%|██▉       | 13/45 [00:01<00:02, 13.33it/s][4/6] extract embeddings:  36%|███▌      | 16/45 [00:01<00:01, 15.81it/s][4/6] extract embeddings:  42%|████▏     | 19/45 [00:01<00:01, 18.37it/s][4/6] extract embeddings:  49%|████▉     | 22/45 [00:01<00:01, 20.51it/s][4/6] extract embeddings:  56%|█████▌    | 25/45 [00:02<00:00, 21.74it/s][4/6] extract embeddings:  62%|██████▏   | 28/45 [00:02<00:00, 21.83it/s][4/6] extract embeddings:  69%|██████▉   | 31/45 [00:02<00:00, 22.58it/s][4/6] extract embeddings:  76%|███████▌  | 34/45 [00:02<00:00, 23.59it/s][4/6] extract embeddings:  82%|████████▏ | 37/45 [00:02<00:00, 23.78it/s][4/6] extract embeddings:  89%|████████▉ | 40/45 [00:02<00:00, 24.43it/s][4/6] extract embeddings:  96%|█████████▌| 43/45 [00:02<00:00, 23.89it/s][4/6] extract embeddings: 100%|██████████| 45/45 [00:02<00:00, 15.42it/s]
[NeMo I 2025-04-17 02:01:37 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:01:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:01:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:01:37 collections:880] Dataset successfully loaded with 3964 items and total duration provided from manifest is  0.88 hours.
[NeMo I 2025-04-17 02:01:37 collections:886] # 3964 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/62 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/62 [00:01<01:07,  1.11s/it][5/6] extract embeddings:   6%|▋         | 4/62 [00:01<00:13,  4.20it/s][5/6] extract embeddings:  13%|█▎        | 8/62 [00:01<00:06,  8.64it/s][5/6] extract embeddings:  18%|█▊        | 11/62 [00:01<00:04, 11.75it/s][5/6] extract embeddings:  23%|██▎       | 14/62 [00:01<00:03, 14.40it/s][5/6] extract embeddings:  27%|██▋       | 17/62 [00:01<00:02, 17.29it/s][5/6] extract embeddings:  32%|███▏      | 20/62 [00:01<00:02, 19.46it/s][5/6] extract embeddings:  37%|███▋      | 23/62 [00:01<00:01, 21.57it/s][5/6] extract embeddings:  42%|████▏     | 26/62 [00:02<00:01, 23.28it/s][5/6] extract embeddings:  47%|████▋     | 29/62 [00:02<00:01, 24.67it/s][5/6] extract embeddings:  53%|█████▎    | 33/62 [00:02<00:01, 25.95it/s][5/6] extract embeddings:  58%|█████▊    | 36/62 [00:02<00:00, 26.46it/s][5/6] extract embeddings:  65%|██████▍   | 40/62 [00:02<00:00, 27.29it/s][5/6] extract embeddings:  69%|██████▉   | 43/62 [00:02<00:00, 27.26it/s][5/6] extract embeddings:  74%|███████▍  | 46/62 [00:02<00:00, 27.46it/s][5/6] extract embeddings:  79%|███████▉  | 49/62 [00:02<00:00, 28.12it/s][5/6] extract embeddings:  84%|████████▍ | 52/62 [00:02<00:00, 27.04it/s][5/6] extract embeddings:  89%|████████▊ | 55/62 [00:03<00:00, 25.70it/s][5/6] extract embeddings:  94%|█████████▎| 58/62 [00:03<00:00, 25.85it/s][5/6] extract embeddings:  98%|█████████▊| 61/62 [00:03<00:00, 26.72it/s][5/6] extract embeddings: 100%|██████████| 62/62 [00:03<00:00, 18.30it/s]
[NeMo I 2025-04-17 02:01:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:01:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:01:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:01:41 collections:880] Dataset successfully loaded with 7760 items and total duration provided from manifest is  0.99 hours.
[NeMo I 2025-04-17 02:01:41 collections:886] # 7760 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/122 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/122 [00:01<02:16,  1.13s/it][6/6] extract embeddings:   4%|▍         | 5/122 [00:01<00:22,  5.26it/s][6/6] extract embeddings:   7%|▋         | 9/122 [00:01<00:11,  9.65it/s][6/6] extract embeddings:  11%|█         | 13/122 [00:01<00:07, 14.11it/s][6/6] extract embeddings:  14%|█▍        | 17/122 [00:01<00:05, 18.15it/s][6/6] extract embeddings:  17%|█▋        | 21/122 [00:01<00:04, 21.44it/s][6/6] extract embeddings:  20%|██        | 25/122 [00:01<00:04, 24.14it/s][6/6] extract embeddings:  24%|██▍       | 29/122 [00:01<00:03, 26.63it/s][6/6] extract embeddings:  27%|██▋       | 33/122 [00:02<00:03, 28.54it/s][6/6] extract embeddings:  30%|███       | 37/122 [00:02<00:02, 29.35it/s][6/6] extract embeddings:  34%|███▎      | 41/122 [00:02<00:02, 30.86it/s][6/6] extract embeddings:  37%|███▋      | 45/122 [00:02<00:02, 31.78it/s][6/6] extract embeddings:  40%|████      | 49/122 [00:02<00:02, 32.57it/s][6/6] extract embeddings:  43%|████▎     | 53/122 [00:02<00:02, 31.55it/s][6/6] extract embeddings:  47%|████▋     | 57/122 [00:02<00:02, 31.15it/s][6/6] extract embeddings:  50%|█████     | 61/122 [00:02<00:01, 31.48it/s][6/6] extract embeddings:  53%|█████▎    | 65/122 [00:03<00:01, 32.32it/s][6/6] extract embeddings:  57%|█████▋    | 69/122 [00:03<00:01, 32.94it/s][6/6] extract embeddings:  60%|█████▉    | 73/122 [00:03<00:01, 33.07it/s][6/6] extract embeddings:  63%|██████▎   | 77/122 [00:03<00:01, 33.83it/s][6/6] extract embeddings:  66%|██████▋   | 81/122 [00:03<00:01, 32.99it/s][6/6] extract embeddings:  70%|██████▉   | 85/122 [00:03<00:01, 33.76it/s][6/6] extract embeddings:  73%|███████▎  | 89/122 [00:03<00:01, 32.40it/s][6/6] extract embeddings:  76%|███████▌  | 93/122 [00:03<00:00, 33.00it/s][6/6] extract embeddings:  80%|███████▉  | 97/122 [00:04<00:00, 33.35it/s][6/6] extract embeddings:  83%|████████▎ | 101/122 [00:04<00:00, 33.34it/s][6/6] extract embeddings:  86%|████████▌ | 105/122 [00:04<00:00, 32.69it/s][6/6] extract embeddings:  89%|████████▉ | 109/122 [00:04<00:00, 32.50it/s][6/6] extract embeddings:  93%|█████████▎| 113/122 [00:04<00:00, 33.25it/s][6/6] extract embeddings:  96%|█████████▌| 117/122 [00:04<00:00, 33.64it/s][6/6] extract embeddings:  99%|█████████▉| 121/122 [00:04<00:00, 34.08it/s][6/6] extract embeddings: 100%|██████████| 122/122 [00:04<00:00, 25.46it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.40it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.36it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.04it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.72it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s]
[NeMo I 2025-04-17 02:01:47 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:01:48 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              59.847601   444.120  ...  11.525012  2.595022
    Harker-ES                       57.213837  2178.782  ...  39.536575  1.814618
    Harker-MN                       59.366656   366.767  ...  23.954056  6.531137
    Longfellow-Block-1              53.073712   492.417  ...   9.503990  1.930069
    TOTAL                           57.191041  3482.086  ...  84.519633  2.427270
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:01:48 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0390 | MISS: 0.5086 | CER: 0.0243 | DER: 0.5719 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.50
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.5 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.71s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.86s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:02:00 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:02:00 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:02:00 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:02:00 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:02:00 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:02:00 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:02:00 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:02:00 features:305] PADDING: 16
[NeMo I 2025-04-17 02:02:01 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:02:01 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:02:01 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:02:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:02:01 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:01 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:01 collections:880] Dataset successfully loaded with 2004 items and total duration provided from manifest is  0.64 hours.
[NeMo I 2025-04-17 02:02:01 collections:886] # 2004 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:04,  2.09s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.35it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.58it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.01it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.61it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 11.91it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.17it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 15.98it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 17.23it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 18.07it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 19.29it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.23it/s]
[NeMo I 2025-04-17 02:02:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:02:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:04 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:04 collections:880] Dataset successfully loaded with 2138 items and total duration provided from manifest is  0.68 hours.
[NeMo I 2025-04-17 02:02:04 collections:886] # 2138 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:45,  1.38s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:08,  3.34it/s][2/6] extract embeddings:  18%|█▊        | 6/34 [00:01<00:05,  5.23it/s][2/6] extract embeddings:  26%|██▋       | 9/34 [00:01<00:02,  8.34it/s][2/6] extract embeddings:  35%|███▌      | 12/34 [00:01<00:01, 11.43it/s][2/6] extract embeddings:  44%|████▍     | 15/34 [00:02<00:01, 14.04it/s][2/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 15.88it/s][2/6] extract embeddings:  62%|██████▏   | 21/34 [00:02<00:00, 17.52it/s][2/6] extract embeddings:  71%|███████   | 24/34 [00:02<00:00, 18.42it/s][2/6] extract embeddings:  79%|███████▉  | 27/34 [00:02<00:00, 18.67it/s][2/6] extract embeddings:  88%|████████▊ | 30/34 [00:02<00:00, 18.96it/s][2/6] extract embeddings:  97%|█████████▋| 33/34 [00:02<00:00, 20.00it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.61it/s]
[NeMo I 2025-04-17 02:02:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:02:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:07 collections:880] Dataset successfully loaded with 2345 items and total duration provided from manifest is  0.71 hours.
[NeMo I 2025-04-17 02:02:07 collections:886] # 2345 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:40,  1.13s/it][3/6] extract embeddings:  11%|█         | 4/37 [00:01<00:08,  4.06it/s][3/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  7.37it/s][3/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02, 10.02it/s][3/6] extract embeddings:  35%|███▌      | 13/37 [00:01<00:01, 12.58it/s][3/6] extract embeddings:  43%|████▎     | 16/37 [00:01<00:01, 15.26it/s][3/6] extract embeddings:  51%|█████▏    | 19/37 [00:01<00:01, 16.79it/s][3/6] extract embeddings:  59%|█████▉    | 22/37 [00:02<00:00, 17.84it/s][3/6] extract embeddings:  68%|██████▊   | 25/37 [00:02<00:00, 19.20it/s][3/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 19.85it/s][3/6] extract embeddings:  84%|████████▍ | 31/37 [00:02<00:00, 20.51it/s][3/6] extract embeddings:  92%|█████████▏| 34/37 [00:02<00:00, 21.24it/s][3/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 22.18it/s][3/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 13.38it/s]
[NeMo I 2025-04-17 02:02:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:02:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:10 collections:880] Dataset successfully loaded with 2814 items and total duration provided from manifest is  0.77 hours.
[NeMo I 2025-04-17 02:02:10 collections:886] # 2814 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:48,  1.12s/it][4/6] extract embeddings:   9%|▉         | 4/44 [00:01<00:09,  4.09it/s][4/6] extract embeddings:  16%|█▌        | 7/44 [00:01<00:04,  7.47it/s][4/6] extract embeddings:  23%|██▎       | 10/44 [00:01<00:03, 10.74it/s][4/6] extract embeddings:  30%|██▉       | 13/44 [00:01<00:02, 13.71it/s][4/6] extract embeddings:  36%|███▋      | 16/44 [00:01<00:01, 16.35it/s][4/6] extract embeddings:  43%|████▎     | 19/44 [00:01<00:01, 18.72it/s][4/6] extract embeddings:  50%|█████     | 22/44 [00:01<00:01, 20.50it/s][4/6] extract embeddings:  57%|█████▋    | 25/44 [00:02<00:00, 21.93it/s][4/6] extract embeddings:  64%|██████▎   | 28/44 [00:02<00:00, 22.01it/s][4/6] extract embeddings:  70%|███████   | 31/44 [00:02<00:00, 22.58it/s][4/6] extract embeddings:  77%|███████▋  | 34/44 [00:02<00:00, 23.28it/s][4/6] extract embeddings:  84%|████████▍ | 37/44 [00:02<00:00, 23.89it/s][4/6] extract embeddings:  91%|█████████ | 40/44 [00:02<00:00, 23.85it/s][4/6] extract embeddings:  98%|█████████▊| 43/44 [00:02<00:00, 24.12it/s][4/6] extract embeddings: 100%|██████████| 44/44 [00:02<00:00, 15.26it/s]
[NeMo I 2025-04-17 02:02:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:02:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:13 collections:880] Dataset successfully loaded with 3879 items and total duration provided from manifest is  0.85 hours.
[NeMo I 2025-04-17 02:02:13 collections:886] # 3879 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/61 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/61 [00:01<01:07,  1.12s/it][5/6] extract embeddings:   8%|▊         | 5/61 [00:01<00:10,  5.09it/s][5/6] extract embeddings:  13%|█▎        | 8/61 [00:01<00:06,  8.36it/s][5/6] extract embeddings:  18%|█▊        | 11/61 [00:01<00:04, 11.64it/s][5/6] extract embeddings:  23%|██▎       | 14/61 [00:01<00:03, 14.60it/s][5/6] extract embeddings:  28%|██▊       | 17/61 [00:01<00:02, 17.60it/s][5/6] extract embeddings:  33%|███▎      | 20/61 [00:01<00:02, 18.98it/s][5/6] extract embeddings:  38%|███▊      | 23/61 [00:01<00:01, 21.08it/s][5/6] extract embeddings:  44%|████▍     | 27/61 [00:02<00:01, 23.04it/s][5/6] extract embeddings:  49%|████▉     | 30/61 [00:02<00:01, 23.84it/s][5/6] extract embeddings:  54%|█████▍    | 33/61 [00:02<00:01, 24.23it/s][5/6] extract embeddings:  59%|█████▉    | 36/61 [00:02<00:01, 23.72it/s][5/6] extract embeddings:  64%|██████▍   | 39/61 [00:02<00:00, 25.00it/s][5/6] extract embeddings:  69%|██████▉   | 42/61 [00:02<00:00, 26.03it/s][5/6] extract embeddings:  74%|███████▍  | 45/61 [00:02<00:00, 27.07it/s][5/6] extract embeddings:  79%|███████▊  | 48/61 [00:02<00:00, 26.22it/s][5/6] extract embeddings:  84%|████████▎ | 51/61 [00:02<00:00, 26.80it/s][5/6] extract embeddings:  89%|████████▊ | 54/61 [00:03<00:00, 27.24it/s][5/6] extract embeddings:  93%|█████████▎| 57/61 [00:03<00:00, 26.81it/s][5/6] extract embeddings:  98%|█████████▊| 60/61 [00:03<00:00, 26.80it/s][5/6] extract embeddings: 100%|██████████| 61/61 [00:03<00:00, 18.10it/s]
[NeMo I 2025-04-17 02:02:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:02:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:17 collections:880] Dataset successfully loaded with 7556 items and total duration provided from manifest is  0.97 hours.
[NeMo I 2025-04-17 02:02:17 collections:886] # 7556 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/119 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/119 [00:01<02:11,  1.11s/it][6/6] extract embeddings:   4%|▍         | 5/119 [00:01<00:21,  5.29it/s][6/6] extract embeddings:   8%|▊         | 9/119 [00:01<00:11,  9.93it/s][6/6] extract embeddings:  11%|█         | 13/119 [00:01<00:07, 14.45it/s][6/6] extract embeddings:  14%|█▍        | 17/119 [00:01<00:05, 18.49it/s][6/6] extract embeddings:  18%|█▊        | 21/119 [00:01<00:04, 21.80it/s][6/6] extract embeddings:  21%|██        | 25/119 [00:01<00:03, 24.35it/s][6/6] extract embeddings:  24%|██▍       | 29/119 [00:01<00:03, 26.51it/s][6/6] extract embeddings:  28%|██▊       | 33/119 [00:02<00:03, 26.64it/s][6/6] extract embeddings:  31%|███       | 37/119 [00:02<00:02, 27.55it/s][6/6] extract embeddings:  34%|███▍      | 41/119 [00:02<00:02, 28.10it/s][6/6] extract embeddings:  37%|███▋      | 44/119 [00:02<00:02, 28.46it/s][6/6] extract embeddings:  40%|████      | 48/119 [00:02<00:02, 28.85it/s][6/6] extract embeddings:  44%|████▎     | 52/119 [00:02<00:02, 30.10it/s][6/6] extract embeddings:  47%|████▋     | 56/119 [00:02<00:01, 31.67it/s][6/6] extract embeddings:  50%|█████     | 60/119 [00:02<00:01, 32.03it/s][6/6] extract embeddings:  54%|█████▍    | 64/119 [00:03<00:01, 32.70it/s][6/6] extract embeddings:  57%|█████▋    | 68/119 [00:03<00:01, 33.40it/s][6/6] extract embeddings:  61%|██████    | 72/119 [00:03<00:01, 33.05it/s][6/6] extract embeddings:  64%|██████▍   | 76/119 [00:03<00:01, 33.47it/s][6/6] extract embeddings:  67%|██████▋   | 80/119 [00:03<00:01, 33.03it/s][6/6] extract embeddings:  71%|███████   | 84/119 [00:03<00:01, 33.58it/s][6/6] extract embeddings:  74%|███████▍  | 88/119 [00:03<00:00, 34.13it/s][6/6] extract embeddings:  77%|███████▋  | 92/119 [00:03<00:00, 33.89it/s][6/6] extract embeddings:  81%|████████  | 96/119 [00:04<00:00, 34.07it/s][6/6] extract embeddings:  84%|████████▍ | 100/119 [00:04<00:00, 33.41it/s][6/6] extract embeddings:  87%|████████▋ | 104/119 [00:04<00:00, 32.85it/s][6/6] extract embeddings:  91%|█████████ | 108/119 [00:04<00:00, 32.10it/s][6/6] extract embeddings:  94%|█████████▍| 112/119 [00:04<00:00, 30.74it/s][6/6] extract embeddings:  97%|█████████▋| 116/119 [00:04<00:00, 32.29it/s][6/6] extract embeddings: 100%|██████████| 119/119 [00:04<00:00, 25.01it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.23it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.32it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.01it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.70it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s]
[NeMo I 2025-04-17 02:02:23 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:02:24 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              60.539979   444.120  ...  11.219975  2.526339
    Harker-ES                       57.786338  2178.782  ...  34.988558  1.605877
    Harker-MN                       60.498170   366.767  ...  23.387000  6.376528
    Longfellow-Block-1              53.976806   492.417  ...  10.252017  2.081979
    TOTAL                           57.884463  3482.086  ...  79.847550  2.293095
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:02:24 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0372 | MISS: 0.5187 | CER: 0.0229 | DER: 0.5788 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.50
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.5 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.79s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.89s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:02:36 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:02:36 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:02:36 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:02:36 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:02:36 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:02:36 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:02:36 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:02:36 features:305] PADDING: 16
[NeMo I 2025-04-17 02:02:37 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:02:37 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:02:37 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:02:37 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:02:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:37 collections:880] Dataset successfully loaded with 2005 items and total duration provided from manifest is  0.62 hours.
[NeMo I 2025-04-17 02:02:37 collections:886] # 2005 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:05,  2.11s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:12,  2.33it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.53it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  6.95it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:02,  9.20it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 11.72it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 13.56it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:03<00:00, 15.47it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 17.11it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 18.54it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 19.04it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.11it/s]
[NeMo I 2025-04-17 02:02:40 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:02:40 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:40 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:40 collections:880] Dataset successfully loaded with 2127 items and total duration provided from manifest is  0.65 hours.
[NeMo I 2025-04-17 02:02:40 collections:886] # 2127 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:45,  1.39s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:08,  3.33it/s][2/6] extract embeddings:  18%|█▊        | 6/34 [00:01<00:05,  5.22it/s][2/6] extract embeddings:  26%|██▋       | 9/34 [00:01<00:02,  8.36it/s][2/6] extract embeddings:  35%|███▌      | 12/34 [00:01<00:01, 11.22it/s][2/6] extract embeddings:  44%|████▍     | 15/34 [00:02<00:01, 14.15it/s][2/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:00, 16.23it/s][2/6] extract embeddings:  62%|██████▏   | 21/34 [00:02<00:00, 17.97it/s][2/6] extract embeddings:  71%|███████   | 24/34 [00:02<00:00, 19.31it/s][2/6] extract embeddings:  79%|███████▉  | 27/34 [00:02<00:00, 20.67it/s][2/6] extract embeddings:  88%|████████▊ | 30/34 [00:02<00:00, 20.13it/s][2/6] extract embeddings:  97%|█████████▋| 33/34 [00:02<00:00, 21.30it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.84it/s]
[NeMo I 2025-04-17 02:02:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:02:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:44 collections:880] Dataset successfully loaded with 2320 items and total duration provided from manifest is  0.68 hours.
[NeMo I 2025-04-17 02:02:44 collections:886] # 2320 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:41,  1.15s/it][3/6] extract embeddings:  11%|█         | 4/37 [00:01<00:08,  3.96it/s][3/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  7.16it/s][3/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02, 10.04it/s][3/6] extract embeddings:  35%|███▌      | 13/37 [00:01<00:01, 12.67it/s][3/6] extract embeddings:  43%|████▎     | 16/37 [00:01<00:01, 15.70it/s][3/6] extract embeddings:  51%|█████▏    | 19/37 [00:01<00:01, 17.29it/s][3/6] extract embeddings:  59%|█████▉    | 22/37 [00:02<00:00, 19.28it/s][3/6] extract embeddings:  68%|██████▊   | 25/37 [00:02<00:00, 20.98it/s][3/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 22.07it/s][3/6] extract embeddings:  84%|████████▍ | 31/37 [00:02<00:00, 21.23it/s][3/6] extract embeddings:  92%|█████████▏| 34/37 [00:02<00:00, 21.62it/s][3/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 13.68it/s]
[NeMo I 2025-04-17 02:02:46 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:02:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:46 collections:880] Dataset successfully loaded with 2756 items and total duration provided from manifest is  0.74 hours.
[NeMo I 2025-04-17 02:02:46 collections:886] # 2756 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/44 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/44 [00:01<00:49,  1.14s/it][4/6] extract embeddings:   9%|▉         | 4/44 [00:01<00:09,  4.01it/s][4/6] extract embeddings:  16%|█▌        | 7/44 [00:01<00:05,  7.29it/s][4/6] extract embeddings:  23%|██▎       | 10/44 [00:01<00:03, 10.42it/s][4/6] extract embeddings:  30%|██▉       | 13/44 [00:01<00:02, 13.48it/s][4/6] extract embeddings:  36%|███▋      | 16/44 [00:01<00:01, 15.89it/s][4/6] extract embeddings:  43%|████▎     | 19/44 [00:01<00:01, 18.36it/s][4/6] extract embeddings:  50%|█████     | 22/44 [00:01<00:01, 20.14it/s][4/6] extract embeddings:  57%|█████▋    | 25/44 [00:02<00:00, 21.28it/s][4/6] extract embeddings:  64%|██████▎   | 28/44 [00:02<00:00, 22.59it/s][4/6] extract embeddings:  70%|███████   | 31/44 [00:02<00:00, 23.54it/s][4/6] extract embeddings:  77%|███████▋  | 34/44 [00:02<00:00, 22.97it/s][4/6] extract embeddings:  84%|████████▍ | 37/44 [00:02<00:00, 24.05it/s][4/6] extract embeddings:  91%|█████████ | 40/44 [00:02<00:00, 24.45it/s][4/6] extract embeddings:  98%|█████████▊| 43/44 [00:02<00:00, 24.34it/s][4/6] extract embeddings: 100%|██████████| 44/44 [00:02<00:00, 15.12it/s]
[NeMo I 2025-04-17 02:02:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:02:50 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:50 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:50 collections:880] Dataset successfully loaded with 3766 items and total duration provided from manifest is  0.82 hours.
[NeMo I 2025-04-17 02:02:50 collections:886] # 3766 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/59 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/59 [00:01<01:05,  1.13s/it][5/6] extract embeddings:   7%|▋         | 4/59 [00:01<00:13,  4.13it/s][5/6] extract embeddings:  12%|█▏        | 7/59 [00:01<00:06,  7.53it/s][5/6] extract embeddings:  17%|█▋        | 10/59 [00:01<00:04, 11.15it/s][5/6] extract embeddings:  22%|██▏       | 13/59 [00:01<00:03, 14.57it/s][5/6] extract embeddings:  27%|██▋       | 16/59 [00:01<00:02, 17.09it/s][5/6] extract embeddings:  32%|███▏      | 19/59 [00:01<00:02, 19.43it/s][5/6] extract embeddings:  37%|███▋      | 22/59 [00:01<00:01, 21.75it/s][5/6] extract embeddings:  42%|████▏     | 25/59 [00:01<00:01, 23.53it/s][5/6] extract embeddings:  49%|████▉     | 29/59 [00:02<00:01, 24.81it/s][5/6] extract embeddings:  54%|█████▍    | 32/59 [00:02<00:01, 26.09it/s][5/6] extract embeddings:  59%|█████▉    | 35/59 [00:02<00:00, 26.29it/s][5/6] extract embeddings:  64%|██████▍   | 38/59 [00:02<00:00, 27.07it/s][5/6] extract embeddings:  69%|██████▉   | 41/59 [00:02<00:00, 26.98it/s][5/6] extract embeddings:  75%|███████▍  | 44/59 [00:02<00:00, 27.47it/s][5/6] extract embeddings:  80%|███████▉  | 47/59 [00:02<00:00, 27.52it/s][5/6] extract embeddings:  85%|████████▍ | 50/59 [00:02<00:00, 27.60it/s][5/6] extract embeddings:  90%|████████▉ | 53/59 [00:03<00:00, 27.19it/s][5/6] extract embeddings:  95%|█████████▍| 56/59 [00:03<00:00, 27.48it/s][5/6] extract embeddings: 100%|██████████| 59/59 [00:03<00:00, 27.59it/s][5/6] extract embeddings: 100%|██████████| 59/59 [00:03<00:00, 18.14it/s]
[NeMo I 2025-04-17 02:02:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:02:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:02:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:02:53 collections:880] Dataset successfully loaded with 7305 items and total duration provided from manifest is  0.93 hours.
[NeMo I 2025-04-17 02:02:53 collections:886] # 7305 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/115 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/115 [00:01<02:13,  1.17s/it][6/6] extract embeddings:   4%|▍         | 5/115 [00:01<00:21,  5.08it/s][6/6] extract embeddings:   8%|▊         | 9/115 [00:01<00:11,  9.55it/s][6/6] extract embeddings:  11%|█▏        | 13/115 [00:01<00:07, 13.92it/s][6/6] extract embeddings:  15%|█▍        | 17/115 [00:01<00:05, 17.73it/s][6/6] extract embeddings:  18%|█▊        | 21/115 [00:01<00:04, 20.90it/s][6/6] extract embeddings:  22%|██▏       | 25/115 [00:01<00:03, 23.81it/s][6/6] extract embeddings:  25%|██▌       | 29/115 [00:02<00:03, 25.91it/s][6/6] extract embeddings:  29%|██▊       | 33/115 [00:02<00:02, 27.63it/s][6/6] extract embeddings:  32%|███▏      | 37/115 [00:02<00:02, 28.06it/s][6/6] extract embeddings:  36%|███▌      | 41/115 [00:02<00:02, 30.16it/s][6/6] extract embeddings:  39%|███▉      | 45/115 [00:02<00:02, 31.07it/s][6/6] extract embeddings:  43%|████▎     | 49/115 [00:02<00:02, 31.12it/s][6/6] extract embeddings:  46%|████▌     | 53/115 [00:02<00:01, 31.53it/s][6/6] extract embeddings:  50%|████▉     | 57/115 [00:02<00:01, 32.19it/s][6/6] extract embeddings:  53%|█████▎    | 61/115 [00:02<00:01, 32.95it/s][6/6] extract embeddings:  57%|█████▋    | 65/115 [00:03<00:01, 33.07it/s][6/6] extract embeddings:  60%|██████    | 69/115 [00:03<00:01, 33.63it/s][6/6] extract embeddings:  63%|██████▎   | 73/115 [00:03<00:01, 33.66it/s][6/6] extract embeddings:  67%|██████▋   | 77/115 [00:03<00:01, 33.45it/s][6/6] extract embeddings:  70%|███████   | 81/115 [00:03<00:00, 34.29it/s][6/6] extract embeddings:  74%|███████▍  | 85/115 [00:03<00:00, 33.49it/s][6/6] extract embeddings:  77%|███████▋  | 89/115 [00:03<00:00, 33.48it/s][6/6] extract embeddings:  81%|████████  | 93/115 [00:03<00:00, 33.00it/s][6/6] extract embeddings:  84%|████████▍ | 97/115 [00:04<00:00, 32.30it/s][6/6] extract embeddings:  88%|████████▊ | 101/115 [00:04<00:00, 32.39it/s][6/6] extract embeddings:  91%|█████████▏| 105/115 [00:04<00:00, 32.31it/s][6/6] extract embeddings:  95%|█████████▍| 109/115 [00:04<00:00, 32.45it/s][6/6] extract embeddings:  98%|█████████▊| 113/115 [00:04<00:00, 32.03it/s][6/6] extract embeddings: 100%|██████████| 115/115 [00:04<00:00, 24.71it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.36it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.37it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.10it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.96it/s]
[NeMo I 2025-04-17 02:02:59 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:03:01 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              61.991176   444.120  ...  11.955071  2.691856
    Harker-ES                       59.018669  2178.782  ...  32.891551  1.509630
    Harker-MN                       62.172467   366.767  ...  23.540985  6.418512
    Longfellow-Block-1              55.229202   492.417  ...  10.011002  2.033033
    TOTAL                           59.194099  3482.086  ...  78.398610  2.251484
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:03:01 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0360 | MISS: 0.5334 | CER: 0.0225 | DER: 0.5919 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.50
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.5 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.79s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:03:12 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:03:12 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:03:12 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:03:12 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:03:12 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:03:12 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:03:12 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:03:12 features:305] PADDING: 16
[NeMo I 2025-04-17 02:03:13 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:03:13 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:03:13 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:03:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:03:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:13 collections:880] Dataset successfully loaded with 2005 items and total duration provided from manifest is  0.59 hours.
[NeMo I 2025-04-17 02:03:13 collections:886] # 2005 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:59,  1.93s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.53it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.81it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.30it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.72it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.29it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.52it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.26it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 18.12it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 18.51it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 19.27it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.61it/s]
[NeMo I 2025-04-17 02:03:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:03:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:16 collections:880] Dataset successfully loaded with 2111 items and total duration provided from manifest is  0.62 hours.
[NeMo I 2025-04-17 02:03:16 collections:886] # 2111 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:44,  1.38s/it][2/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:08,  3.39it/s][2/6] extract embeddings:  18%|█▊        | 6/33 [00:01<00:05,  5.30it/s][2/6] extract embeddings:  27%|██▋       | 9/33 [00:01<00:02,  8.44it/s][2/6] extract embeddings:  36%|███▋      | 12/33 [00:01<00:01, 11.37it/s][2/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 13.69it/s][2/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:00, 16.02it/s][2/6] extract embeddings:  64%|██████▎   | 21/33 [00:02<00:00, 18.07it/s][2/6] extract embeddings:  73%|███████▎  | 24/33 [00:02<00:00, 19.24it/s][2/6] extract embeddings:  82%|████████▏ | 27/33 [00:02<00:00, 20.16it/s][2/6] extract embeddings:  91%|█████████ | 30/33 [00:02<00:00, 21.19it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 21.44it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 11.68it/s]
[NeMo I 2025-04-17 02:03:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:03:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:19 collections:880] Dataset successfully loaded with 2286 items and total duration provided from manifest is  0.65 hours.
[NeMo I 2025-04-17 02:03:19 collections:886] # 2286 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:39,  1.13s/it][3/6] extract embeddings:  11%|█         | 4/36 [00:01<00:07,  4.00it/s][3/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  7.18it/s][3/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:02, 10.28it/s][3/6] extract embeddings:  36%|███▌      | 13/36 [00:01<00:01, 12.96it/s][3/6] extract embeddings:  44%|████▍     | 16/36 [00:01<00:01, 15.22it/s][3/6] extract embeddings:  53%|█████▎    | 19/36 [00:01<00:00, 17.59it/s][3/6] extract embeddings:  61%|██████    | 22/36 [00:02<00:00, 18.72it/s][3/6] extract embeddings:  69%|██████▉   | 25/36 [00:02<00:00, 19.95it/s][3/6] extract embeddings:  78%|███████▊  | 28/36 [00:02<00:00, 20.82it/s][3/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 20.94it/s][3/6] extract embeddings:  94%|█████████▍| 34/36 [00:02<00:00, 21.86it/s][3/6] extract embeddings: 100%|██████████| 36/36 [00:02<00:00, 13.51it/s]
[NeMo I 2025-04-17 02:03:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:03:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:22 collections:880] Dataset successfully loaded with 2685 items and total duration provided from manifest is  0.70 hours.
[NeMo I 2025-04-17 02:03:22 collections:886] # 2685 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:46,  1.12s/it][4/6] extract embeddings:  10%|▉         | 4/42 [00:01<00:09,  4.07it/s][4/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:04,  7.39it/s][4/6] extract embeddings:  21%|██▏       | 9/42 [00:01<00:03,  9.32it/s][4/6] extract embeddings:  29%|██▊       | 12/42 [00:01<00:02, 12.71it/s][4/6] extract embeddings:  36%|███▌      | 15/42 [00:01<00:01, 15.51it/s][4/6] extract embeddings:  43%|████▎     | 18/42 [00:01<00:01, 17.73it/s][4/6] extract embeddings:  50%|█████     | 21/42 [00:01<00:01, 19.65it/s][4/6] extract embeddings:  57%|█████▋    | 24/42 [00:02<00:00, 21.47it/s][4/6] extract embeddings:  64%|██████▍   | 27/42 [00:02<00:00, 22.89it/s][4/6] extract embeddings:  71%|███████▏  | 30/42 [00:02<00:00, 23.08it/s][4/6] extract embeddings:  79%|███████▊  | 33/42 [00:02<00:00, 24.10it/s][4/6] extract embeddings:  86%|████████▌ | 36/42 [00:02<00:00, 24.13it/s][4/6] extract embeddings:  93%|█████████▎| 39/42 [00:02<00:00, 24.15it/s][4/6] extract embeddings: 100%|██████████| 42/42 [00:02<00:00, 23.77it/s][4/6] extract embeddings: 100%|██████████| 42/42 [00:02<00:00, 14.84it/s]
[NeMo I 2025-04-17 02:03:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:03:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:25 collections:880] Dataset successfully loaded with 3626 items and total duration provided from manifest is  0.77 hours.
[NeMo I 2025-04-17 02:03:25 collections:886] # 3626 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/57 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/57 [00:01<01:02,  1.11s/it][5/6] extract embeddings:   7%|▋         | 4/57 [00:01<00:12,  4.15it/s][5/6] extract embeddings:  12%|█▏        | 7/57 [00:01<00:06,  7.55it/s][5/6] extract embeddings:  18%|█▊        | 10/57 [00:01<00:04, 10.88it/s][5/6] extract embeddings:  23%|██▎       | 13/57 [00:01<00:03, 14.14it/s][5/6] extract embeddings:  28%|██▊       | 16/57 [00:01<00:02, 17.03it/s][5/6] extract embeddings:  33%|███▎      | 19/57 [00:01<00:01, 19.87it/s][5/6] extract embeddings:  39%|███▊      | 22/57 [00:01<00:01, 21.82it/s][5/6] extract embeddings:  44%|████▍     | 25/57 [00:02<00:01, 23.16it/s][5/6] extract embeddings:  49%|████▉     | 28/57 [00:02<00:01, 24.64it/s][5/6] extract embeddings:  54%|█████▍    | 31/57 [00:02<00:01, 24.78it/s][5/6] extract embeddings:  60%|█████▉    | 34/57 [00:02<00:00, 25.63it/s][5/6] extract embeddings:  65%|██████▍   | 37/57 [00:02<00:00, 26.15it/s][5/6] extract embeddings:  72%|███████▏  | 41/57 [00:02<00:00, 26.58it/s][5/6] extract embeddings:  79%|███████▉  | 45/57 [00:02<00:00, 27.46it/s][5/6] extract embeddings:  84%|████████▍ | 48/57 [00:02<00:00, 26.75it/s][5/6] extract embeddings:  89%|████████▉ | 51/57 [00:02<00:00, 26.60it/s][5/6] extract embeddings:  95%|█████████▍| 54/57 [00:03<00:00, 26.40it/s][5/6] extract embeddings: 100%|██████████| 57/57 [00:03<00:00, 26.56it/s][5/6] extract embeddings: 100%|██████████| 57/57 [00:03<00:00, 17.71it/s]
[NeMo I 2025-04-17 02:03:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:03:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:28 collections:880] Dataset successfully loaded with 6981 items and total duration provided from manifest is  0.88 hours.
[NeMo I 2025-04-17 02:03:28 collections:886] # 6981 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/110 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/110 [00:01<02:01,  1.12s/it][6/6] extract embeddings:   4%|▎         | 4/110 [00:01<00:25,  4.19it/s][6/6] extract embeddings:   7%|▋         | 8/110 [00:01<00:11,  8.98it/s][6/6] extract embeddings:  11%|█         | 12/110 [00:01<00:07, 13.54it/s][6/6] extract embeddings:  15%|█▍        | 16/110 [00:01<00:05, 17.90it/s][6/6] extract embeddings:  18%|█▊        | 20/110 [00:01<00:04, 21.42it/s][6/6] extract embeddings:  22%|██▏       | 24/110 [00:01<00:03, 24.35it/s][6/6] extract embeddings:  25%|██▌       | 28/110 [00:01<00:03, 27.07it/s][6/6] extract embeddings:  29%|██▉       | 32/110 [00:02<00:02, 27.81it/s][6/6] extract embeddings:  33%|███▎      | 36/110 [00:02<00:02, 29.75it/s][6/6] extract embeddings:  36%|███▋      | 40/110 [00:02<00:02, 29.65it/s][6/6] extract embeddings:  40%|████      | 44/110 [00:02<00:02, 30.54it/s][6/6] extract embeddings:  44%|████▎     | 48/110 [00:02<00:01, 31.13it/s][6/6] extract embeddings:  47%|████▋     | 52/110 [00:02<00:01, 31.82it/s][6/6] extract embeddings:  51%|█████     | 56/110 [00:02<00:01, 30.78it/s][6/6] extract embeddings:  55%|█████▍    | 60/110 [00:02<00:01, 30.83it/s][6/6] extract embeddings:  58%|█████▊    | 64/110 [00:03<00:01, 31.85it/s][6/6] extract embeddings:  62%|██████▏   | 68/110 [00:03<00:01, 31.73it/s][6/6] extract embeddings:  65%|██████▌   | 72/110 [00:03<00:01, 32.50it/s][6/6] extract embeddings:  69%|██████▉   | 76/110 [00:03<00:01, 32.94it/s][6/6] extract embeddings:  73%|███████▎  | 80/110 [00:03<00:00, 33.40it/s][6/6] extract embeddings:  76%|███████▋  | 84/110 [00:03<00:00, 34.32it/s][6/6] extract embeddings:  80%|████████  | 88/110 [00:03<00:00, 32.97it/s][6/6] extract embeddings:  84%|████████▎ | 92/110 [00:03<00:00, 32.88it/s][6/6] extract embeddings:  87%|████████▋ | 96/110 [00:04<00:00, 33.50it/s][6/6] extract embeddings:  91%|█████████ | 100/110 [00:04<00:00, 33.50it/s][6/6] extract embeddings:  95%|█████████▍| 104/110 [00:04<00:00, 32.51it/s][6/6] extract embeddings:  98%|█████████▊| 108/110 [00:04<00:00, 32.99it/s][6/6] extract embeddings: 100%|██████████| 110/110 [00:04<00:00, 24.60it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.81it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.20it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.97it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s]
[NeMo I 2025-04-17 02:03:35 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:03:36 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              63.518878   444.120  ...  11.050019  2.488070
    Harker-ES                       60.592298  2178.782  ...  29.589936  1.358095
    Harker-MN                       63.361218   366.767  ...  21.361962  5.824396
    Longfellow-Block-1              56.720029   492.417  ...   9.422955  1.913613
    TOTAL                           60.709621  3482.086  ...  71.424871  2.051209
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:03:36 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0341 | MISS: 0.5525 | CER: 0.0205 | DER: 0.6071 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.50
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.5 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:03:47 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:03:47 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:03:47 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:03:47 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:03:47 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:03:48 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:03:48 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:03:48 features:305] PADDING: 16
[NeMo I 2025-04-17 02:03:48 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:03:48 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:03:48 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:03:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:03:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:48 collections:880] Dataset successfully loaded with 2010 items and total duration provided from manifest is  0.55 hours.
[NeMo I 2025-04-17 02:03:48 collections:886] # 2010 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.96s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.48it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.82it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:02,  7.35it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.86it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.49it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.97it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 17.08it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 18.77it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 19.89it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 20.91it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.81it/s]
[NeMo I 2025-04-17 02:03:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:03:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:52 collections:880] Dataset successfully loaded with 2095 items and total duration provided from manifest is  0.57 hours.
[NeMo I 2025-04-17 02:03:52 collections:886] # 2095 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:44,  1.38s/it][2/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:08,  3.37it/s][2/6] extract embeddings:  21%|██        | 7/33 [00:01<00:04,  6.24it/s][2/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02,  9.15it/s][2/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 11.78it/s][2/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 14.99it/s][2/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 16.95it/s][2/6] extract embeddings:  67%|██████▋   | 22/33 [00:02<00:00, 19.08it/s][2/6] extract embeddings:  76%|███████▌  | 25/33 [00:02<00:00, 20.27it/s][2/6] extract embeddings:  85%|████████▍ | 28/33 [00:02<00:00, 20.98it/s][2/6] extract embeddings:  94%|█████████▍| 31/33 [00:02<00:00, 21.87it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 11.99it/s]
[NeMo I 2025-04-17 02:03:54 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:03:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:55 collections:880] Dataset successfully loaded with 2247 items and total duration provided from manifest is  0.60 hours.
[NeMo I 2025-04-17 02:03:55 collections:886] # 2247 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:41,  1.18s/it][3/6] extract embeddings:  11%|█         | 4/36 [00:01<00:08,  3.91it/s][3/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  7.09it/s][3/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:02, 10.47it/s][3/6] extract embeddings:  36%|███▌      | 13/36 [00:01<00:01, 12.94it/s][3/6] extract embeddings:  44%|████▍     | 16/36 [00:01<00:01, 15.75it/s][3/6] extract embeddings:  53%|█████▎    | 19/36 [00:01<00:00, 17.80it/s][3/6] extract embeddings:  61%|██████    | 22/36 [00:02<00:00, 20.23it/s][3/6] extract embeddings:  69%|██████▉   | 25/36 [00:02<00:00, 20.65it/s][3/6] extract embeddings:  78%|███████▊  | 28/36 [00:02<00:00, 20.88it/s][3/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 21.95it/s][3/6] extract embeddings:  94%|█████████▍| 34/36 [00:02<00:00, 22.75it/s][3/6] extract embeddings: 100%|██████████| 36/36 [00:02<00:00, 13.58it/s]
[NeMo I 2025-04-17 02:03:57 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:03:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:03:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:03:57 collections:880] Dataset successfully loaded with 2594 items and total duration provided from manifest is  0.64 hours.
[NeMo I 2025-04-17 02:03:57 collections:886] # 2594 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:45,  1.13s/it][4/6] extract embeddings:  10%|▉         | 4/41 [00:01<00:08,  4.12it/s][4/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:04,  7.49it/s][4/6] extract embeddings:  24%|██▍       | 10/41 [00:01<00:02, 10.77it/s][4/6] extract embeddings:  32%|███▏      | 13/41 [00:01<00:02, 13.60it/s][4/6] extract embeddings:  39%|███▉      | 16/41 [00:01<00:01, 16.29it/s][4/6] extract embeddings:  46%|████▋     | 19/41 [00:01<00:01, 18.59it/s][4/6] extract embeddings:  54%|█████▎    | 22/41 [00:01<00:00, 20.24it/s][4/6] extract embeddings:  61%|██████    | 25/41 [00:02<00:00, 21.22it/s][4/6] extract embeddings:  68%|██████▊   | 28/41 [00:02<00:00, 23.08it/s][4/6] extract embeddings:  76%|███████▌  | 31/41 [00:02<00:00, 23.34it/s][4/6] extract embeddings:  83%|████████▎ | 34/41 [00:02<00:00, 23.67it/s][4/6] extract embeddings:  90%|█████████ | 37/41 [00:02<00:00, 23.95it/s][4/6] extract embeddings:  98%|█████████▊| 40/41 [00:02<00:00, 23.90it/s][4/6] extract embeddings: 100%|██████████| 41/41 [00:02<00:00, 14.97it/s]
[NeMo I 2025-04-17 02:04:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:04:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:04:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:04:00 collections:880] Dataset successfully loaded with 3453 items and total duration provided from manifest is  0.71 hours.
[NeMo I 2025-04-17 02:04:00 collections:886] # 3453 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/54 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/54 [00:01<01:05,  1.24s/it][5/6] extract embeddings:  11%|█         | 6/54 [00:01<00:08,  5.66it/s][5/6] extract embeddings:  17%|█▋        | 9/54 [00:01<00:05,  8.65it/s][5/6] extract embeddings:  22%|██▏       | 12/54 [00:01<00:03, 11.70it/s][5/6] extract embeddings:  28%|██▊       | 15/54 [00:01<00:02, 14.49it/s][5/6] extract embeddings:  33%|███▎      | 18/54 [00:01<00:02, 17.10it/s][5/6] extract embeddings:  39%|███▉      | 21/54 [00:01<00:01, 19.67it/s][5/6] extract embeddings:  46%|████▋     | 25/54 [00:02<00:01, 22.00it/s][5/6] extract embeddings:  52%|█████▏    | 28/54 [00:02<00:01, 23.44it/s][5/6] extract embeddings:  57%|█████▋    | 31/54 [00:02<00:00, 24.07it/s][5/6] extract embeddings:  63%|██████▎   | 34/54 [00:02<00:00, 25.36it/s][5/6] extract embeddings:  69%|██████▊   | 37/54 [00:02<00:00, 25.53it/s][5/6] extract embeddings:  74%|███████▍  | 40/54 [00:02<00:00, 25.70it/s][5/6] extract embeddings:  81%|████████▏ | 44/54 [00:02<00:00, 26.14it/s][5/6] extract embeddings:  87%|████████▋ | 47/54 [00:02<00:00, 26.88it/s][5/6] extract embeddings:  93%|█████████▎| 50/54 [00:02<00:00, 27.24it/s][5/6] extract embeddings:  98%|█████████▊| 53/54 [00:03<00:00, 26.73it/s][5/6] extract embeddings: 100%|██████████| 54/54 [00:03<00:00, 16.98it/s]
[NeMo I 2025-04-17 02:04:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:04:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:04:04 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:04:04 collections:880] Dataset successfully loaded with 6557 items and total duration provided from manifest is  0.82 hours.
[NeMo I 2025-04-17 02:04:04 collections:886] # 6557 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/103 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/103 [00:01<02:05,  1.23s/it][6/6] extract embeddings:   5%|▍         | 5/103 [00:01<00:20,  4.83it/s][6/6] extract embeddings:   9%|▊         | 9/103 [00:01<00:10,  9.07it/s][6/6] extract embeddings:  13%|█▎        | 13/103 [00:01<00:06, 13.51it/s][6/6] extract embeddings:  17%|█▋        | 17/103 [00:01<00:04, 17.71it/s][6/6] extract embeddings:  20%|██        | 21/103 [00:01<00:03, 21.64it/s][6/6] extract embeddings:  24%|██▍       | 25/103 [00:01<00:03, 24.07it/s][6/6] extract embeddings:  28%|██▊       | 29/103 [00:02<00:02, 25.99it/s][6/6] extract embeddings:  32%|███▏      | 33/103 [00:02<00:02, 27.63it/s][6/6] extract embeddings:  36%|███▌      | 37/103 [00:02<00:02, 28.70it/s][6/6] extract embeddings:  40%|███▉      | 41/103 [00:02<00:02, 30.02it/s][6/6] extract embeddings:  44%|████▎     | 45/103 [00:02<00:01, 30.96it/s][6/6] extract embeddings:  48%|████▊     | 49/103 [00:02<00:01, 31.25it/s][6/6] extract embeddings:  51%|█████▏    | 53/103 [00:02<00:01, 31.84it/s][6/6] extract embeddings:  55%|█████▌    | 57/103 [00:02<00:01, 32.71it/s][6/6] extract embeddings:  59%|█████▉    | 61/103 [00:03<00:01, 32.57it/s][6/6] extract embeddings:  63%|██████▎   | 65/103 [00:03<00:01, 31.59it/s][6/6] extract embeddings:  67%|██████▋   | 69/103 [00:03<00:01, 32.02it/s][6/6] extract embeddings:  71%|███████   | 73/103 [00:03<00:00, 32.76it/s][6/6] extract embeddings:  75%|███████▍  | 77/103 [00:03<00:00, 31.69it/s][6/6] extract embeddings:  79%|███████▊  | 81/103 [00:03<00:00, 32.39it/s][6/6] extract embeddings:  83%|████████▎ | 85/103 [00:03<00:00, 32.94it/s][6/6] extract embeddings:  86%|████████▋ | 89/103 [00:03<00:00, 33.29it/s][6/6] extract embeddings:  90%|█████████ | 93/103 [00:04<00:00, 33.81it/s][6/6] extract embeddings:  94%|█████████▍| 97/103 [00:04<00:00, 33.16it/s][6/6] extract embeddings:  98%|█████████▊| 101/103 [00:04<00:00, 33.73it/s][6/6] extract embeddings: 100%|██████████| 103/103 [00:04<00:00, 23.76it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.96it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.38it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.20it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s]
[NeMo I 2025-04-17 02:04:10 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:04:11 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              67.455858   444.120  ...  13.875037  3.124164
    Harker-ES                       62.822012  2178.782  ...  29.083818  1.334866
    Harker-MN                       64.464167   366.767  ...  20.663055  5.633837
    Longfellow-Block-1              58.936675   492.417  ...   9.694988  1.968857
    TOTAL                           63.036558  3482.086  ...  73.316897  2.105545
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:04:11 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0317 | MISS: 0.5776 | CER: 0.0211 | DER: 0.6304 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.50
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.5 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.87s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:04:22 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:04:22 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:04:22 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:04:22 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:04:22 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:04:22 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:04:22 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:04:22 features:305] PADDING: 16
[NeMo I 2025-04-17 02:04:23 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:04:23 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:04:23 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:04:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:04:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:04:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:04:23 collections:880] Dataset successfully loaded with 1962 items and total duration provided from manifest is  0.49 hours.
[NeMo I 2025-04-17 02:04:23 collections:886] # 1962 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:58,  1.96s/it][1/6] extract embeddings:  13%|█▎        | 4/31 [00:02<00:10,  2.49it/s][1/6] extract embeddings:  23%|██▎       | 7/31 [00:02<00:04,  4.82it/s][1/6] extract embeddings:  32%|███▏      | 10/31 [00:02<00:02,  7.44it/s][1/6] extract embeddings:  42%|████▏     | 13/31 [00:02<00:01, 10.07it/s][1/6] extract embeddings:  52%|█████▏    | 16/31 [00:02<00:01, 12.67it/s][1/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 15.02it/s][1/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 17.13it/s][1/6] extract embeddings:  81%|████████  | 25/31 [00:02<00:00, 18.15it/s][1/6] extract embeddings:  90%|█████████ | 28/31 [00:03<00:00, 19.50it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00, 21.71it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00,  9.63it/s]
[NeMo I 2025-04-17 02:04:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:04:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:04:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:04:26 collections:880] Dataset successfully loaded with 2026 items and total duration provided from manifest is  0.50 hours.
[NeMo I 2025-04-17 02:04:26 collections:886] # 2026 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:42,  1.37s/it][2/6] extract embeddings:  12%|█▎        | 4/32 [00:01<00:08,  3.40it/s][2/6] extract embeddings:  22%|██▏       | 7/32 [00:01<00:03,  6.27it/s][2/6] extract embeddings:  31%|███▏      | 10/32 [00:01<00:02,  9.22it/s][2/6] extract embeddings:  41%|████      | 13/32 [00:01<00:01, 12.01it/s][2/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 14.61it/s][2/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 17.10it/s][2/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 18.53it/s][2/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 19.93it/s][2/6] extract embeddings:  88%|████████▊ | 28/32 [00:02<00:00, 20.72it/s][2/6] extract embeddings:  97%|█████████▋| 31/32 [00:02<00:00, 22.05it/s][2/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 11.89it/s]
[NeMo I 2025-04-17 02:04:29 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:04:29 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:04:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:04:29 collections:880] Dataset successfully loaded with 2151 items and total duration provided from manifest is  0.53 hours.
[NeMo I 2025-04-17 02:04:29 collections:886] # 2151 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:37,  1.14s/it][3/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:07,  4.07it/s][3/6] extract embeddings:  21%|██        | 7/34 [00:01<00:03,  7.48it/s][3/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02, 10.71it/s][3/6] extract embeddings:  38%|███▊      | 13/34 [00:01<00:01, 13.73it/s][3/6] extract embeddings:  47%|████▋     | 16/34 [00:01<00:01, 16.02it/s][3/6] extract embeddings:  56%|█████▌    | 19/34 [00:01<00:00, 18.11it/s][3/6] extract embeddings:  65%|██████▍   | 22/34 [00:01<00:00, 20.40it/s][3/6] extract embeddings:  74%|███████▎  | 25/34 [00:02<00:00, 21.32it/s][3/6] extract embeddings:  82%|████████▏ | 28/34 [00:02<00:00, 22.60it/s][3/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 21.75it/s][3/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 23.27it/s][3/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 13.61it/s]
[NeMo I 2025-04-17 02:04:32 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:04:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:04:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:04:32 collections:880] Dataset successfully loaded with 2433 items and total duration provided from manifest is  0.57 hours.
[NeMo I 2025-04-17 02:04:32 collections:886] # 2433 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:42,  1.13s/it][4/6] extract embeddings:  10%|█         | 4/39 [00:01<00:08,  4.16it/s][4/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  7.53it/s][4/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:02, 10.83it/s][4/6] extract embeddings:  33%|███▎      | 13/39 [00:01<00:01, 13.69it/s][4/6] extract embeddings:  41%|████      | 16/39 [00:01<00:01, 16.73it/s][4/6] extract embeddings:  49%|████▊     | 19/39 [00:01<00:01, 18.77it/s][4/6] extract embeddings:  56%|█████▋    | 22/39 [00:01<00:00, 20.78it/s][4/6] extract embeddings:  64%|██████▍   | 25/39 [00:02<00:00, 22.80it/s][4/6] extract embeddings:  72%|███████▏  | 28/39 [00:02<00:00, 23.90it/s][4/6] extract embeddings:  79%|███████▉  | 31/39 [00:02<00:00, 24.34it/s][4/6] extract embeddings:  87%|████████▋ | 34/39 [00:02<00:00, 24.93it/s][4/6] extract embeddings:  95%|█████████▍| 37/39 [00:02<00:00, 24.09it/s][4/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 14.81it/s]
[NeMo I 2025-04-17 02:04:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:04:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:04:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:04:35 collections:880] Dataset successfully loaded with 3169 items and total duration provided from manifest is  0.63 hours.
[NeMo I 2025-04-17 02:04:35 collections:886] # 3169 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/50 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/50 [00:01<00:54,  1.12s/it][5/6] extract embeddings:   8%|▊         | 4/50 [00:01<00:10,  4.19it/s][5/6] extract embeddings:  14%|█▍        | 7/50 [00:01<00:05,  7.65it/s][5/6] extract embeddings:  20%|██        | 10/50 [00:01<00:03, 11.23it/s][5/6] extract embeddings:  26%|██▌       | 13/50 [00:01<00:02, 14.59it/s][5/6] extract embeddings:  32%|███▏      | 16/50 [00:01<00:01, 17.48it/s][5/6] extract embeddings:  38%|███▊      | 19/50 [00:01<00:01, 19.95it/s][5/6] extract embeddings:  46%|████▌     | 23/50 [00:01<00:01, 22.80it/s][5/6] extract embeddings:  52%|█████▏    | 26/50 [00:02<00:01, 22.70it/s][5/6] extract embeddings:  58%|█████▊    | 29/50 [00:02<00:00, 24.26it/s][5/6] extract embeddings:  66%|██████▌   | 33/50 [00:02<00:00, 26.24it/s][5/6] extract embeddings:  72%|███████▏  | 36/50 [00:02<00:00, 26.81it/s][5/6] extract embeddings:  78%|███████▊  | 39/50 [00:02<00:00, 27.46it/s][5/6] extract embeddings:  84%|████████▍ | 42/50 [00:02<00:00, 26.14it/s][5/6] extract embeddings:  90%|█████████ | 45/50 [00:02<00:00, 27.14it/s][5/6] extract embeddings:  96%|█████████▌| 48/50 [00:02<00:00, 26.87it/s][5/6] extract embeddings: 100%|██████████| 50/50 [00:02<00:00, 17.30it/s]
[NeMo I 2025-04-17 02:04:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:04:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:04:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:04:38 collections:880] Dataset successfully loaded with 5935 items and total duration provided from manifest is  0.73 hours.
[NeMo I 2025-04-17 02:04:38 collections:886] # 5935 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/93 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/93 [00:01<01:43,  1.13s/it][6/6] extract embeddings:   6%|▋         | 6/93 [00:01<00:13,  6.21it/s][6/6] extract embeddings:  11%|█         | 10/93 [00:01<00:08, 10.32it/s][6/6] extract embeddings:  15%|█▌        | 14/93 [00:01<00:05, 14.77it/s][6/6] extract embeddings:  19%|█▉        | 18/93 [00:01<00:04, 18.71it/s][6/6] extract embeddings:  24%|██▎       | 22/93 [00:01<00:03, 22.21it/s][6/6] extract embeddings:  28%|██▊       | 26/93 [00:01<00:02, 24.56it/s][6/6] extract embeddings:  32%|███▏      | 30/93 [00:01<00:02, 27.54it/s][6/6] extract embeddings:  37%|███▋      | 34/93 [00:02<00:02, 27.73it/s][6/6] extract embeddings:  41%|████      | 38/93 [00:02<00:01, 29.14it/s][6/6] extract embeddings:  45%|████▌     | 42/93 [00:02<00:01, 29.90it/s][6/6] extract embeddings:  49%|████▉     | 46/93 [00:02<00:01, 31.05it/s][6/6] extract embeddings:  54%|█████▍    | 50/93 [00:02<00:01, 30.48it/s][6/6] extract embeddings:  58%|█████▊    | 54/93 [00:02<00:01, 31.69it/s][6/6] extract embeddings:  62%|██████▏   | 58/93 [00:02<00:01, 32.68it/s][6/6] extract embeddings:  67%|██████▋   | 62/93 [00:02<00:00, 33.06it/s][6/6] extract embeddings:  71%|███████   | 66/93 [00:03<00:00, 33.76it/s][6/6] extract embeddings:  75%|███████▌  | 70/93 [00:03<00:00, 33.88it/s][6/6] extract embeddings:  80%|███████▉  | 74/93 [00:03<00:00, 32.48it/s][6/6] extract embeddings:  84%|████████▍ | 78/93 [00:03<00:00, 33.06it/s][6/6] extract embeddings:  88%|████████▊ | 82/93 [00:03<00:00, 33.04it/s][6/6] extract embeddings:  92%|█████████▏| 86/93 [00:03<00:00, 33.35it/s][6/6] extract embeddings:  97%|█████████▋| 90/93 [00:03<00:00, 33.56it/s][6/6] extract embeddings: 100%|██████████| 93/93 [00:03<00:00, 23.77it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.92it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.41it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.74it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.81it/s]
[NeMo I 2025-04-17 02:04:43 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:04:45 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              69.767113   444.120  ...  12.689905  2.857315
    Harker-ES                       66.647292  2178.782  ...  32.469522  1.490260
    Harker-MN                       68.033402   366.767  ...  20.832022  5.679906
    Longfellow-Block-1              62.374240   492.417  ...  12.419008  2.522051
    TOTAL                           66.586935  3482.086  ...  78.410457  2.251824
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:04:45 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0279 | MISS: 0.6155 | CER: 0.0225 | DER: 0.6659 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.60, offset=0.55
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.6, <class 'float'> offset=0.55 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.74s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:04:56 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:04:56 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:04:56 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:04:56 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:04:56 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:04:57 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:04:57 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:04:57 features:305] PADDING: 16
[NeMo I 2025-04-17 02:04:57 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:04:57 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:04:57 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:04:57 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:04:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:04:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:04:57 collections:880] Dataset successfully loaded with 2030 items and total duration provided from manifest is  0.61 hours.
[NeMo I 2025-04-17 02:04:57 collections:886] # 2030 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:02,  2.03s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.41it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.68it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.17it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.80it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.21it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.18it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.33it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 17.58it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.87it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 19.59it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.39it/s]
[NeMo I 2025-04-17 02:05:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:05:01 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:01 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:01 collections:880] Dataset successfully loaded with 2140 items and total duration provided from manifest is  0.63 hours.
[NeMo I 2025-04-17 02:05:01 collections:886] # 2140 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:45,  1.38s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:08,  3.36it/s][2/6] extract embeddings:  21%|██        | 7/34 [00:01<00:04,  6.26it/s][2/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02,  9.06it/s][2/6] extract embeddings:  38%|███▊      | 13/34 [00:01<00:01, 11.77it/s][2/6] extract embeddings:  47%|████▋     | 16/34 [00:02<00:01, 13.88it/s][2/6] extract embeddings:  56%|█████▌    | 19/34 [00:02<00:00, 16.22it/s][2/6] extract embeddings:  65%|██████▍   | 22/34 [00:02<00:00, 18.12it/s][2/6] extract embeddings:  74%|███████▎  | 25/34 [00:02<00:00, 19.41it/s][2/6] extract embeddings:  82%|████████▏ | 28/34 [00:02<00:00, 20.17it/s][2/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 20.43it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.94it/s]
[NeMo I 2025-04-17 02:05:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:05:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:04 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:04 collections:880] Dataset successfully loaded with 2330 items and total duration provided from manifest is  0.67 hours.
[NeMo I 2025-04-17 02:05:04 collections:886] # 2330 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:43,  1.20s/it][3/6] extract embeddings:  11%|█         | 4/37 [00:01<00:08,  3.83it/s][3/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  6.97it/s][3/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02,  9.99it/s][3/6] extract embeddings:  35%|███▌      | 13/37 [00:01<00:01, 12.62it/s][3/6] extract embeddings:  43%|████▎     | 16/37 [00:01<00:01, 15.54it/s][3/6] extract embeddings:  51%|█████▏    | 19/37 [00:01<00:01, 17.60it/s][3/6] extract embeddings:  59%|█████▉    | 22/37 [00:02<00:00, 19.71it/s][3/6] extract embeddings:  68%|██████▊   | 25/37 [00:02<00:00, 21.12it/s][3/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 21.50it/s][3/6] extract embeddings:  84%|████████▍ | 31/37 [00:02<00:00, 21.96it/s][3/6] extract embeddings:  92%|█████████▏| 34/37 [00:02<00:00, 22.50it/s][3/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 13.64it/s]
[NeMo I 2025-04-17 02:05:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:05:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:07 collections:880] Dataset successfully loaded with 2733 items and total duration provided from manifest is  0.72 hours.
[NeMo I 2025-04-17 02:05:07 collections:886] # 2733 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:47,  1.14s/it][4/6] extract embeddings:   9%|▉         | 4/43 [00:01<00:09,  4.04it/s][4/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:04,  7.28it/s][4/6] extract embeddings:  23%|██▎       | 10/43 [00:01<00:03, 10.51it/s][4/6] extract embeddings:  30%|███       | 13/43 [00:01<00:02, 13.62it/s][4/6] extract embeddings:  37%|███▋      | 16/43 [00:01<00:01, 15.83it/s][4/6] extract embeddings:  44%|████▍     | 19/43 [00:01<00:01, 17.76it/s][4/6] extract embeddings:  51%|█████     | 22/43 [00:01<00:01, 20.12it/s][4/6] extract embeddings:  58%|█████▊    | 25/43 [00:02<00:00, 21.42it/s][4/6] extract embeddings:  65%|██████▌   | 28/43 [00:02<00:00, 23.31it/s][4/6] extract embeddings:  72%|███████▏  | 31/43 [00:02<00:00, 22.87it/s][4/6] extract embeddings:  79%|███████▉  | 34/43 [00:02<00:00, 22.94it/s][4/6] extract embeddings:  86%|████████▌ | 37/43 [00:02<00:00, 22.80it/s][4/6] extract embeddings:  93%|█████████▎| 40/43 [00:02<00:00, 23.34it/s][4/6] extract embeddings: 100%|██████████| 43/43 [00:02<00:00, 22.88it/s][4/6] extract embeddings: 100%|██████████| 43/43 [00:02<00:00, 14.81it/s]
[NeMo I 2025-04-17 02:05:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:05:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:10 collections:880] Dataset successfully loaded with 3718 items and total duration provided from manifest is  0.80 hours.
[NeMo I 2025-04-17 02:05:10 collections:886] # 3718 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/59 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/59 [00:01<01:05,  1.13s/it][5/6] extract embeddings:   7%|▋         | 4/59 [00:01<00:13,  4.11it/s][5/6] extract embeddings:  12%|█▏        | 7/59 [00:01<00:06,  7.63it/s][5/6] extract embeddings:  19%|█▊        | 11/59 [00:01<00:03, 12.24it/s][5/6] extract embeddings:  25%|██▌       | 15/59 [00:01<00:02, 16.18it/s][5/6] extract embeddings:  31%|███       | 18/59 [00:01<00:02, 18.31it/s][5/6] extract embeddings:  36%|███▌      | 21/59 [00:01<00:01, 20.52it/s][5/6] extract embeddings:  41%|████      | 24/59 [00:01<00:01, 21.15it/s][5/6] extract embeddings:  46%|████▌     | 27/59 [00:02<00:01, 22.80it/s][5/6] extract embeddings:  51%|█████     | 30/59 [00:02<00:01, 23.87it/s][5/6] extract embeddings:  56%|█████▌    | 33/59 [00:02<00:01, 23.40it/s][5/6] extract embeddings:  61%|██████    | 36/59 [00:02<00:00, 24.31it/s][5/6] extract embeddings:  68%|██████▊   | 40/59 [00:02<00:00, 26.28it/s][5/6] extract embeddings:  73%|███████▎  | 43/59 [00:02<00:00, 26.95it/s][5/6] extract embeddings:  78%|███████▊  | 46/59 [00:02<00:00, 26.83it/s][5/6] extract embeddings:  85%|████████▍ | 50/59 [00:02<00:00, 26.78it/s][5/6] extract embeddings:  90%|████████▉ | 53/59 [00:03<00:00, 26.63it/s][5/6] extract embeddings:  95%|█████████▍| 56/59 [00:03<00:00, 27.38it/s][5/6] extract embeddings: 100%|██████████| 59/59 [00:03<00:00, 27.34it/s][5/6] extract embeddings: 100%|██████████| 59/59 [00:03<00:00, 17.91it/s]
[NeMo I 2025-04-17 02:05:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:05:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:13 collections:880] Dataset successfully loaded with 7157 items and total duration provided from manifest is  0.91 hours.
[NeMo I 2025-04-17 02:05:13 collections:886] # 7157 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/112 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/112 [00:01<02:04,  1.12s/it][6/6] extract embeddings:   4%|▍         | 5/112 [00:01<00:20,  5.23it/s][6/6] extract embeddings:   8%|▊         | 9/112 [00:01<00:10,  9.84it/s][6/6] extract embeddings:  12%|█▏        | 13/112 [00:01<00:06, 14.20it/s][6/6] extract embeddings:  15%|█▌        | 17/112 [00:01<00:05, 18.46it/s][6/6] extract embeddings:  19%|█▉        | 21/112 [00:01<00:04, 22.28it/s][6/6] extract embeddings:  22%|██▏       | 25/112 [00:01<00:03, 25.23it/s][6/6] extract embeddings:  26%|██▌       | 29/112 [00:01<00:03, 27.36it/s][6/6] extract embeddings:  29%|██▉       | 33/112 [00:02<00:02, 28.78it/s][6/6] extract embeddings:  33%|███▎      | 37/112 [00:02<00:02, 30.03it/s][6/6] extract embeddings:  37%|███▋      | 41/112 [00:02<00:02, 30.64it/s][6/6] extract embeddings:  40%|████      | 45/112 [00:02<00:02, 31.58it/s][6/6] extract embeddings:  44%|████▍     | 49/112 [00:02<00:01, 32.64it/s][6/6] extract embeddings:  47%|████▋     | 53/112 [00:02<00:01, 32.00it/s][6/6] extract embeddings:  51%|█████     | 57/112 [00:02<00:01, 33.06it/s][6/6] extract embeddings:  54%|█████▍    | 61/112 [00:02<00:01, 32.36it/s][6/6] extract embeddings:  58%|█████▊    | 65/112 [00:03<00:01, 32.54it/s][6/6] extract embeddings:  62%|██████▏   | 69/112 [00:03<00:01, 33.03it/s][6/6] extract embeddings:  65%|██████▌   | 73/112 [00:03<00:01, 33.77it/s][6/6] extract embeddings:  69%|██████▉   | 77/112 [00:03<00:01, 33.18it/s][6/6] extract embeddings:  72%|███████▏  | 81/112 [00:03<00:00, 33.05it/s][6/6] extract embeddings:  76%|███████▌  | 85/112 [00:03<00:00, 33.14it/s][6/6] extract embeddings:  79%|███████▉  | 89/112 [00:03<00:00, 33.37it/s][6/6] extract embeddings:  83%|████████▎ | 93/112 [00:03<00:00, 33.68it/s][6/6] extract embeddings:  87%|████████▋ | 97/112 [00:03<00:00, 33.20it/s][6/6] extract embeddings:  90%|█████████ | 101/112 [00:04<00:00, 33.97it/s][6/6] extract embeddings:  94%|█████████▍| 105/112 [00:04<00:00, 34.18it/s][6/6] extract embeddings:  97%|█████████▋| 109/112 [00:04<00:00, 33.19it/s][6/6] extract embeddings: 100%|██████████| 112/112 [00:04<00:00, 25.11it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.85it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.16it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.88it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s]
[NeMo I 2025-04-17 02:05:19 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:05:21 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              62.056493   444.120  ...   8.734994  1.966810
    Harker-ES                       59.587656  2178.782  ...  30.637962  1.406197
    Harker-MN                       62.845699   366.767  ...  21.882967  5.966449
    Longfellow-Block-1              55.841927   492.417  ...  11.561978  2.348006
    TOTAL                           59.716011  3482.086  ...  72.817902  2.091215
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:05:21 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0343 | MISS: 0.5419 | CER: 0.0209 | DER: 0.5972 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.55
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.55 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.68s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.86s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:05:32 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:05:32 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:05:32 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:05:32 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:05:32 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:05:32 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:05:32 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:05:32 features:305] PADDING: 16
[NeMo I 2025-04-17 02:05:33 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:05:33 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:05:33 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:05:33 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:05:33 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:33 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:33 collections:880] Dataset successfully loaded with 2027 items and total duration provided from manifest is  0.59 hours.
[NeMo I 2025-04-17 02:05:33 collections:886] # 2027 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:01,  1.99s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.46it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.74it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.31it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.65it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.34it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.32it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.28it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 17.44it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 17.93it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 19.62it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.49it/s]
[NeMo I 2025-04-17 02:05:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:05:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:37 collections:880] Dataset successfully loaded with 2134 items and total duration provided from manifest is  0.62 hours.
[NeMo I 2025-04-17 02:05:37 collections:886] # 2134 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:46,  1.41s/it][2/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:09,  3.30it/s][2/6] extract embeddings:  21%|██        | 7/34 [00:01<00:04,  6.14it/s][2/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02,  8.87it/s][2/6] extract embeddings:  35%|███▌      | 12/34 [00:01<00:02, 10.54it/s][2/6] extract embeddings:  44%|████▍     | 15/34 [00:02<00:01, 13.12it/s][2/6] extract embeddings:  53%|█████▎    | 18/34 [00:02<00:01, 15.60it/s][2/6] extract embeddings:  62%|██████▏   | 21/34 [00:02<00:00, 17.39it/s][2/6] extract embeddings:  71%|███████   | 24/34 [00:02<00:00, 19.50it/s][2/6] extract embeddings:  79%|███████▉  | 27/34 [00:02<00:00, 20.13it/s][2/6] extract embeddings:  88%|████████▊ | 30/34 [00:02<00:00, 19.95it/s][2/6] extract embeddings:  97%|█████████▋| 33/34 [00:02<00:00, 21.17it/s][2/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 11.73it/s]
[NeMo I 2025-04-17 02:05:40 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:05:40 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:40 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:40 collections:880] Dataset successfully loaded with 2314 items and total duration provided from manifest is  0.65 hours.
[NeMo I 2025-04-17 02:05:40 collections:886] # 2314 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:40,  1.12s/it][3/6] extract embeddings:  11%|█         | 4/37 [00:01<00:08,  4.05it/s][3/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  7.26it/s][3/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02, 10.43it/s][3/6] extract embeddings:  35%|███▌      | 13/37 [00:01<00:01, 13.39it/s][3/6] extract embeddings:  43%|████▎     | 16/37 [00:01<00:01, 15.77it/s][3/6] extract embeddings:  51%|█████▏    | 19/37 [00:01<00:01, 17.37it/s][3/6] extract embeddings:  59%|█████▉    | 22/37 [00:02<00:00, 18.96it/s][3/6] extract embeddings:  68%|██████▊   | 25/37 [00:02<00:00, 21.13it/s][3/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 21.55it/s][3/6] extract embeddings:  84%|████████▍ | 31/37 [00:02<00:00, 21.21it/s][3/6] extract embeddings:  92%|█████████▏| 34/37 [00:02<00:00, 22.54it/s][3/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 22.42it/s][3/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 13.77it/s]
[NeMo I 2025-04-17 02:05:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:05:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:43 collections:880] Dataset successfully loaded with 2705 items and total duration provided from manifest is  0.70 hours.
[NeMo I 2025-04-17 02:05:43 collections:886] # 2705 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:47,  1.13s/it][4/6] extract embeddings:   9%|▉         | 4/43 [00:01<00:09,  4.02it/s][4/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:04,  7.44it/s][4/6] extract embeddings:  23%|██▎       | 10/43 [00:01<00:03, 10.53it/s][4/6] extract embeddings:  30%|███       | 13/43 [00:01<00:02, 13.59it/s][4/6] extract embeddings:  37%|███▋      | 16/43 [00:01<00:01, 16.20it/s][4/6] extract embeddings:  44%|████▍     | 19/43 [00:01<00:01, 18.46it/s][4/6] extract embeddings:  51%|█████     | 22/43 [00:01<00:01, 20.29it/s][4/6] extract embeddings:  58%|█████▊    | 25/43 [00:02<00:00, 21.56it/s][4/6] extract embeddings:  65%|██████▌   | 28/43 [00:02<00:00, 23.37it/s][4/6] extract embeddings:  72%|███████▏  | 31/43 [00:02<00:00, 23.51it/s][4/6] extract embeddings:  79%|███████▉  | 34/43 [00:02<00:00, 23.13it/s][4/6] extract embeddings:  86%|████████▌ | 37/43 [00:02<00:00, 24.13it/s][4/6] extract embeddings:  93%|█████████▎| 40/43 [00:02<00:00, 23.72it/s][4/6] extract embeddings: 100%|██████████| 43/43 [00:02<00:00, 25.10it/s][4/6] extract embeddings: 100%|██████████| 43/43 [00:02<00:00, 15.15it/s]
[NeMo I 2025-04-17 02:05:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:05:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:46 collections:880] Dataset successfully loaded with 3661 items and total duration provided from manifest is  0.78 hours.
[NeMo I 2025-04-17 02:05:46 collections:886] # 3661 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/58 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/58 [00:01<01:03,  1.11s/it][5/6] extract embeddings:   7%|▋         | 4/58 [00:01<00:12,  4.17it/s][5/6] extract embeddings:  12%|█▏        | 7/58 [00:01<00:06,  7.64it/s][5/6] extract embeddings:  19%|█▉        | 11/58 [00:01<00:03, 12.26it/s][5/6] extract embeddings:  24%|██▍       | 14/58 [00:01<00:02, 15.10it/s][5/6] extract embeddings:  29%|██▉       | 17/58 [00:01<00:02, 17.66it/s][5/6] extract embeddings:  34%|███▍      | 20/58 [00:01<00:01, 20.19it/s][5/6] extract embeddings:  40%|███▉      | 23/58 [00:01<00:01, 21.58it/s][5/6] extract embeddings:  47%|████▋     | 27/58 [00:02<00:01, 24.23it/s][5/6] extract embeddings:  52%|█████▏    | 30/58 [00:02<00:01, 24.97it/s][5/6] extract embeddings:  59%|█████▊    | 34/58 [00:02<00:00, 26.51it/s][5/6] extract embeddings:  64%|██████▍   | 37/58 [00:02<00:00, 27.22it/s][5/6] extract embeddings:  69%|██████▉   | 40/58 [00:02<00:00, 27.35it/s][5/6] extract embeddings:  74%|███████▍  | 43/58 [00:02<00:00, 26.59it/s][5/6] extract embeddings:  79%|███████▉  | 46/58 [00:02<00:00, 26.83it/s][5/6] extract embeddings:  84%|████████▍ | 49/58 [00:02<00:00, 27.14it/s][5/6] extract embeddings:  90%|████████▉ | 52/58 [00:02<00:00, 27.53it/s][5/6] extract embeddings:  95%|█████████▍| 55/58 [00:03<00:00, 28.06it/s][5/6] extract embeddings: 100%|██████████| 58/58 [00:03<00:00, 18.28it/s]
[NeMo I 2025-04-17 02:05:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:05:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:05:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:05:49 collections:880] Dataset successfully loaded with 7022 items and total duration provided from manifest is  0.89 hours.
[NeMo I 2025-04-17 02:05:49 collections:886] # 7022 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/110 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/110 [00:01<02:02,  1.13s/it][6/6] extract embeddings:   5%|▍         | 5/110 [00:01<00:19,  5.25it/s][6/6] extract embeddings:   8%|▊         | 9/110 [00:01<00:10,  9.77it/s][6/6] extract embeddings:  12%|█▏        | 13/110 [00:01<00:06, 14.21it/s][6/6] extract embeddings:  15%|█▌        | 17/110 [00:01<00:05, 18.34it/s][6/6] extract embeddings:  19%|█▉        | 21/110 [00:01<00:04, 21.72it/s][6/6] extract embeddings:  23%|██▎       | 25/110 [00:01<00:03, 24.91it/s][6/6] extract embeddings:  26%|██▋       | 29/110 [00:01<00:02, 27.23it/s][6/6] extract embeddings:  30%|███       | 33/110 [00:02<00:02, 28.81it/s][6/6] extract embeddings:  34%|███▎      | 37/110 [00:02<00:02, 29.42it/s][6/6] extract embeddings:  37%|███▋      | 41/110 [00:02<00:02, 30.12it/s][6/6] extract embeddings:  41%|████      | 45/110 [00:02<00:02, 30.32it/s][6/6] extract embeddings:  45%|████▍     | 49/110 [00:02<00:01, 30.73it/s][6/6] extract embeddings:  48%|████▊     | 53/110 [00:02<00:01, 31.10it/s][6/6] extract embeddings:  52%|█████▏    | 57/110 [00:02<00:01, 32.26it/s][6/6] extract embeddings:  55%|█████▌    | 61/110 [00:02<00:01, 32.08it/s][6/6] extract embeddings:  59%|█████▉    | 65/110 [00:03<00:01, 32.39it/s][6/6] extract embeddings:  63%|██████▎   | 69/110 [00:03<00:01, 33.15it/s][6/6] extract embeddings:  66%|██████▋   | 73/110 [00:03<00:01, 33.20it/s][6/6] extract embeddings:  70%|███████   | 77/110 [00:03<00:00, 33.03it/s][6/6] extract embeddings:  74%|███████▎  | 81/110 [00:03<00:00, 32.63it/s][6/6] extract embeddings:  77%|███████▋  | 85/110 [00:03<00:00, 33.81it/s][6/6] extract embeddings:  81%|████████  | 89/110 [00:03<00:00, 33.51it/s][6/6] extract embeddings:  85%|████████▍ | 93/110 [00:03<00:00, 33.32it/s][6/6] extract embeddings:  88%|████████▊ | 97/110 [00:04<00:00, 33.88it/s][6/6] extract embeddings:  92%|█████████▏| 101/110 [00:04<00:00, 32.31it/s][6/6] extract embeddings:  95%|█████████▌| 105/110 [00:04<00:00, 32.12it/s][6/6] extract embeddings:  99%|█████████▉| 109/110 [00:04<00:00, 32.23it/s][6/6] extract embeddings: 100%|██████████| 110/110 [00:04<00:00, 24.64it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.81it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.14it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.89it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s]
[NeMo I 2025-04-17 02:05:55 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:05:56 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              62.798374   444.120  ...   9.770041  2.199865
    Harker-ES                       60.460429  2178.782  ...  33.696090  1.546556
    Harker-MN                       63.597958   366.767  ...  23.671052  6.453975
    Longfellow-Block-1              56.789269   492.417  ...  10.550034  2.142500
    TOTAL                           60.569941  3482.086  ...  77.687216  2.231054
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:05:56 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0329 | MISS: 0.5505 | CER: 0.0223 | DER: 0.6057 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.55
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.55 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.73s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:06:08 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:06:08 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:06:08 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:06:08 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:06:08 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:06:08 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:06:08 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:06:08 features:305] PADDING: 16
[NeMo I 2025-04-17 02:06:09 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:06:09 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:06:09 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:06:09 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:06:09 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:09 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:09 collections:880] Dataset successfully loaded with 2008 items and total duration provided from manifest is  0.57 hours.
[NeMo I 2025-04-17 02:06:09 collections:886] # 2008 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:03,  2.06s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.38it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.62it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.10it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.71it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.23it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.85it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 17.05it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 18.33it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 19.33it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 19.19it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.41it/s]
[NeMo I 2025-04-17 02:06:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:06:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:13 collections:880] Dataset successfully loaded with 2109 items and total duration provided from manifest is  0.60 hours.
[NeMo I 2025-04-17 02:06:13 collections:886] # 2109 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:44,  1.38s/it][2/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:08,  3.38it/s][2/6] extract embeddings:  21%|██        | 7/33 [00:01<00:04,  6.22it/s][2/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02,  9.15it/s][2/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 11.70it/s][2/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 13.90it/s][2/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 15.77it/s][2/6] extract embeddings:  67%|██████▋   | 22/33 [00:02<00:00, 17.67it/s][2/6] extract embeddings:  76%|███████▌  | 25/33 [00:02<00:00, 19.16it/s][2/6] extract embeddings:  85%|████████▍ | 28/33 [00:02<00:00, 19.63it/s][2/6] extract embeddings:  94%|█████████▍| 31/33 [00:02<00:00, 20.14it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 11.61it/s]
[NeMo I 2025-04-17 02:06:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:06:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:16 collections:880] Dataset successfully loaded with 2282 items and total duration provided from manifest is  0.63 hours.
[NeMo I 2025-04-17 02:06:16 collections:886] # 2282 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:40,  1.15s/it][3/6] extract embeddings:  11%|█         | 4/36 [00:01<00:08,  3.89it/s][3/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  7.10it/s][3/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:02, 10.19it/s][3/6] extract embeddings:  36%|███▌      | 13/36 [00:01<00:01, 12.92it/s][3/6] extract embeddings:  44%|████▍     | 16/36 [00:01<00:01, 15.89it/s][3/6] extract embeddings:  53%|█████▎    | 19/36 [00:01<00:00, 17.85it/s][3/6] extract embeddings:  61%|██████    | 22/36 [00:02<00:00, 19.67it/s][3/6] extract embeddings:  69%|██████▉   | 25/36 [00:02<00:00, 20.36it/s][3/6] extract embeddings:  78%|███████▊  | 28/36 [00:02<00:00, 21.74it/s][3/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 22.61it/s][3/6] extract embeddings:  94%|█████████▍| 34/36 [00:02<00:00, 22.23it/s][3/6] extract embeddings: 100%|██████████| 36/36 [00:02<00:00, 13.66it/s]
[NeMo I 2025-04-17 02:06:18 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:06:18 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:18 collections:880] Dataset successfully loaded with 2654 items and total duration provided from manifest is  0.68 hours.
[NeMo I 2025-04-17 02:06:18 collections:886] # 2654 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:46,  1.12s/it][4/6] extract embeddings:  10%|▉         | 4/42 [00:01<00:09,  4.10it/s][4/6] extract embeddings:  17%|█▋        | 7/42 [00:01<00:04,  7.33it/s][4/6] extract embeddings:  24%|██▍       | 10/42 [00:01<00:02, 10.75it/s][4/6] extract embeddings:  31%|███       | 13/42 [00:01<00:02, 13.81it/s][4/6] extract embeddings:  38%|███▊      | 16/42 [00:01<00:01, 16.28it/s][4/6] extract embeddings:  45%|████▌     | 19/42 [00:01<00:01, 18.28it/s][4/6] extract embeddings:  52%|█████▏    | 22/42 [00:01<00:01, 19.99it/s][4/6] extract embeddings:  60%|█████▉    | 25/42 [00:02<00:00, 21.32it/s][4/6] extract embeddings:  67%|██████▋   | 28/42 [00:02<00:00, 22.32it/s][4/6] extract embeddings:  74%|███████▍  | 31/42 [00:02<00:00, 22.65it/s][4/6] extract embeddings:  81%|████████  | 34/42 [00:02<00:00, 23.63it/s][4/6] extract embeddings:  88%|████████▊ | 37/42 [00:02<00:00, 23.79it/s][4/6] extract embeddings:  95%|█████████▌| 40/42 [00:02<00:00, 24.35it/s][4/6] extract embeddings: 100%|██████████| 42/42 [00:02<00:00, 15.11it/s]
[NeMo I 2025-04-17 02:06:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:06:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:21 collections:880] Dataset successfully loaded with 3583 items and total duration provided from manifest is  0.75 hours.
[NeMo I 2025-04-17 02:06:21 collections:886] # 3583 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/56 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/56 [00:01<01:02,  1.13s/it][5/6] extract embeddings:   7%|▋         | 4/56 [00:01<00:12,  4.01it/s][5/6] extract embeddings:  12%|█▎        | 7/56 [00:01<00:06,  7.45it/s][5/6] extract embeddings:  20%|█▉        | 11/56 [00:01<00:03, 12.10it/s][5/6] extract embeddings:  25%|██▌       | 14/56 [00:01<00:02, 15.11it/s][5/6] extract embeddings:  30%|███       | 17/56 [00:01<00:02, 17.53it/s][5/6] extract embeddings:  36%|███▌      | 20/56 [00:01<00:01, 19.98it/s][5/6] extract embeddings:  41%|████      | 23/56 [00:01<00:01, 22.05it/s][5/6] extract embeddings:  46%|████▋     | 26/56 [00:02<00:01, 23.98it/s][5/6] extract embeddings:  52%|█████▏    | 29/56 [00:02<00:01, 25.06it/s][5/6] extract embeddings:  57%|█████▋    | 32/56 [00:02<00:00, 25.83it/s][5/6] extract embeddings:  62%|██████▎   | 35/56 [00:02<00:00, 25.06it/s][5/6] extract embeddings:  68%|██████▊   | 38/56 [00:02<00:00, 25.82it/s][5/6] extract embeddings:  73%|███████▎  | 41/56 [00:02<00:00, 24.91it/s][5/6] extract embeddings:  79%|███████▊  | 44/56 [00:02<00:00, 25.70it/s][5/6] extract embeddings:  84%|████████▍ | 47/56 [00:02<00:00, 25.52it/s][5/6] extract embeddings:  91%|█████████ | 51/56 [00:02<00:00, 27.21it/s][5/6] extract embeddings:  96%|█████████▋| 54/56 [00:03<00:00, 27.23it/s][5/6] extract embeddings: 100%|██████████| 56/56 [00:03<00:00, 17.56it/s]
[NeMo I 2025-04-17 02:06:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:06:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:25 collections:880] Dataset successfully loaded with 6844 items and total duration provided from manifest is  0.86 hours.
[NeMo I 2025-04-17 02:06:25 collections:886] # 6844 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/107 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/107 [00:01<02:04,  1.18s/it][6/6] extract embeddings:   2%|▏         | 2/107 [00:01<00:58,  1.79it/s][6/6] extract embeddings:   7%|▋         | 7/107 [00:01<00:12,  7.92it/s][6/6] extract embeddings:  10%|█         | 11/107 [00:01<00:07, 12.59it/s][6/6] extract embeddings:  14%|█▍        | 15/107 [00:01<00:05, 16.79it/s][6/6] extract embeddings:  18%|█▊        | 19/107 [00:01<00:04, 20.29it/s][6/6] extract embeddings:  21%|██▏       | 23/107 [00:01<00:03, 23.88it/s][6/6] extract embeddings:  25%|██▌       | 27/107 [00:02<00:02, 26.76it/s][6/6] extract embeddings:  29%|██▉       | 31/107 [00:02<00:02, 27.77it/s][6/6] extract embeddings:  33%|███▎      | 35/107 [00:02<00:02, 28.26it/s][6/6] extract embeddings:  36%|███▋      | 39/107 [00:02<00:02, 29.08it/s][6/6] extract embeddings:  40%|████      | 43/107 [00:02<00:02, 30.34it/s][6/6] extract embeddings:  44%|████▍     | 47/107 [00:02<00:01, 31.43it/s][6/6] extract embeddings:  48%|████▊     | 51/107 [00:02<00:01, 31.74it/s][6/6] extract embeddings:  51%|█████▏    | 55/107 [00:02<00:01, 32.63it/s][6/6] extract embeddings:  55%|█████▌    | 59/107 [00:02<00:01, 33.16it/s][6/6] extract embeddings:  59%|█████▉    | 63/107 [00:03<00:01, 31.99it/s][6/6] extract embeddings:  63%|██████▎   | 67/107 [00:03<00:01, 32.89it/s][6/6] extract embeddings:  66%|██████▋   | 71/107 [00:03<00:01, 33.75it/s][6/6] extract embeddings:  70%|███████   | 75/107 [00:03<00:00, 33.77it/s][6/6] extract embeddings:  74%|███████▍  | 79/107 [00:03<00:00, 33.82it/s][6/6] extract embeddings:  78%|███████▊  | 83/107 [00:03<00:00, 32.95it/s][6/6] extract embeddings:  81%|████████▏ | 87/107 [00:03<00:00, 33.13it/s][6/6] extract embeddings:  85%|████████▌ | 91/107 [00:03<00:00, 34.02it/s][6/6] extract embeddings:  89%|████████▉ | 95/107 [00:04<00:00, 33.93it/s][6/6] extract embeddings:  93%|█████████▎| 99/107 [00:04<00:00, 32.47it/s][6/6] extract embeddings:  96%|█████████▋| 103/107 [00:04<00:00, 32.44it/s][6/6] extract embeddings: 100%|██████████| 107/107 [00:04<00:00, 31.69it/s][6/6] extract embeddings: 100%|██████████| 107/107 [00:04<00:00, 23.82it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.85it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.22it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.03it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s]
[NeMo I 2025-04-17 02:06:31 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:06:32 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              62.944727   444.120  ...   8.089993  1.821578
    Harker-ES                       61.084655  2178.782  ...  31.172167  1.430715
    Harker-MN                       64.378835   366.767  ...  22.896994  6.242926
    Longfellow-Block-1              57.408054   492.417  ...   9.619027  1.953431
    TOTAL                           61.148947  3482.086  ...  71.778181  2.061356
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:06:32 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0316 | MISS: 0.5593 | CER: 0.0206 | DER: 0.6115 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.55
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.55 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.68s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.87s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:06:44 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:06:44 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:06:44 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:06:44 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:06:44 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:06:44 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:06:44 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:06:44 features:305] PADDING: 16
[NeMo I 2025-04-17 02:06:44 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:06:44 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:06:44 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:06:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:06:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:44 collections:880] Dataset successfully loaded with 1998 items and total duration provided from manifest is  0.55 hours.
[NeMo I 2025-04-17 02:06:44 collections:886] # 1998 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:01,  1.97s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.48it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.79it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.26it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.70it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.31it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.79it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 17.22it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 18.28it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 19.42it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 20.83it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.73it/s]
[NeMo I 2025-04-17 02:06:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:06:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:48 collections:880] Dataset successfully loaded with 2093 items and total duration provided from manifest is  0.58 hours.
[NeMo I 2025-04-17 02:06:48 collections:886] # 2093 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:44,  1.39s/it][2/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:08,  3.32it/s][2/6] extract embeddings:  21%|██        | 7/33 [00:01<00:04,  6.14it/s][2/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02,  8.97it/s][2/6] extract embeddings:  36%|███▋      | 12/33 [00:01<00:01, 10.66it/s][2/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 13.71it/s][2/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:00, 16.62it/s][2/6] extract embeddings:  64%|██████▎   | 21/33 [00:02<00:00, 18.27it/s][2/6] extract embeddings:  73%|███████▎  | 24/33 [00:02<00:00, 20.41it/s][2/6] extract embeddings:  82%|████████▏ | 27/33 [00:02<00:00, 20.94it/s][2/6] extract embeddings:  91%|█████████ | 30/33 [00:02<00:00, 21.43it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 22.99it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 11.86it/s]
[NeMo I 2025-04-17 02:06:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:06:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:51 collections:880] Dataset successfully loaded with 2253 items and total duration provided from manifest is  0.61 hours.
[NeMo I 2025-04-17 02:06:51 collections:886] # 2253 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:39,  1.12s/it][3/6] extract embeddings:  11%|█         | 4/36 [00:01<00:07,  4.07it/s][3/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:03,  7.25it/s][3/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:02, 10.58it/s][3/6] extract embeddings:  36%|███▌      | 13/36 [00:01<00:01, 13.48it/s][3/6] extract embeddings:  44%|████▍     | 16/36 [00:01<00:01, 16.17it/s][3/6] extract embeddings:  53%|█████▎    | 19/36 [00:01<00:00, 18.44it/s][3/6] extract embeddings:  61%|██████    | 22/36 [00:01<00:00, 19.51it/s][3/6] extract embeddings:  69%|██████▉   | 25/36 [00:02<00:00, 20.86it/s][3/6] extract embeddings:  78%|███████▊  | 28/36 [00:02<00:00, 21.25it/s][3/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 21.46it/s][3/6] extract embeddings:  94%|█████████▍| 34/36 [00:02<00:00, 22.47it/s][3/6] extract embeddings: 100%|██████████| 36/36 [00:02<00:00, 13.78it/s]
[NeMo I 2025-04-17 02:06:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:06:54 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:54 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:54 collections:880] Dataset successfully loaded with 2604 items and total duration provided from manifest is  0.65 hours.
[NeMo I 2025-04-17 02:06:54 collections:886] # 2604 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:45,  1.13s/it][4/6] extract embeddings:  10%|▉         | 4/41 [00:01<00:09,  4.06it/s][4/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:04,  7.47it/s][4/6] extract embeddings:  24%|██▍       | 10/41 [00:01<00:02, 10.77it/s][4/6] extract embeddings:  32%|███▏      | 13/41 [00:01<00:02, 13.82it/s][4/6] extract embeddings:  39%|███▉      | 16/41 [00:01<00:01, 16.58it/s][4/6] extract embeddings:  46%|████▋     | 19/41 [00:01<00:01, 19.23it/s][4/6] extract embeddings:  54%|█████▎    | 22/41 [00:01<00:00, 20.96it/s][4/6] extract embeddings:  61%|██████    | 25/41 [00:02<00:00, 22.55it/s][4/6] extract embeddings:  68%|██████▊   | 28/41 [00:02<00:00, 24.18it/s][4/6] extract embeddings:  76%|███████▌  | 31/41 [00:02<00:00, 24.11it/s][4/6] extract embeddings:  83%|████████▎ | 34/41 [00:02<00:00, 24.84it/s][4/6] extract embeddings:  90%|█████████ | 37/41 [00:02<00:00, 24.73it/s][4/6] extract embeddings:  98%|█████████▊| 40/41 [00:02<00:00, 25.08it/s][4/6] extract embeddings: 100%|██████████| 41/41 [00:02<00:00, 15.24it/s]
[NeMo I 2025-04-17 02:06:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:06:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:06:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:06:56 collections:880] Dataset successfully loaded with 3481 items and total duration provided from manifest is  0.72 hours.
[NeMo I 2025-04-17 02:06:56 collections:886] # 3481 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/55 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/55 [00:01<01:00,  1.12s/it][5/6] extract embeddings:   7%|▋         | 4/55 [00:01<00:12,  4.10it/s][5/6] extract embeddings:  13%|█▎        | 7/55 [00:01<00:06,  7.47it/s][5/6] extract embeddings:  18%|█▊        | 10/55 [00:01<00:04, 10.79it/s][5/6] extract embeddings:  24%|██▎       | 13/55 [00:01<00:02, 14.08it/s][5/6] extract embeddings:  29%|██▉       | 16/55 [00:01<00:02, 16.85it/s][5/6] extract embeddings:  35%|███▍      | 19/55 [00:01<00:01, 19.42it/s][5/6] extract embeddings:  40%|████      | 22/55 [00:01<00:01, 21.12it/s][5/6] extract embeddings:  45%|████▌     | 25/55 [00:02<00:01, 22.44it/s][5/6] extract embeddings:  51%|█████     | 28/55 [00:02<00:01, 24.02it/s][5/6] extract embeddings:  56%|█████▋    | 31/55 [00:02<00:00, 24.98it/s][5/6] extract embeddings:  62%|██████▏   | 34/55 [00:02<00:00, 26.27it/s][5/6] extract embeddings:  67%|██████▋   | 37/55 [00:02<00:00, 26.92it/s][5/6] extract embeddings:  73%|███████▎  | 40/55 [00:02<00:00, 27.43it/s][5/6] extract embeddings:  78%|███████▊  | 43/55 [00:02<00:00, 27.24it/s][5/6] extract embeddings:  85%|████████▌ | 47/55 [00:02<00:00, 27.91it/s][5/6] extract embeddings:  91%|█████████ | 50/55 [00:02<00:00, 28.25it/s][5/6] extract embeddings:  96%|█████████▋| 53/55 [00:03<00:00, 28.28it/s][5/6] extract embeddings: 100%|██████████| 55/55 [00:03<00:00, 17.72it/s]
[NeMo I 2025-04-17 02:07:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:07:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:07:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:07:00 collections:880] Dataset successfully loaded with 6621 items and total duration provided from manifest is  0.83 hours.
[NeMo I 2025-04-17 02:07:00 collections:886] # 6621 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/104 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/104 [00:01<01:59,  1.16s/it][6/6] extract embeddings:   5%|▍         | 5/104 [00:01<00:19,  5.13it/s][6/6] extract embeddings:   9%|▊         | 9/104 [00:01<00:09,  9.56it/s][6/6] extract embeddings:  12%|█▎        | 13/104 [00:01<00:06, 13.93it/s][6/6] extract embeddings:  16%|█▋        | 17/104 [00:01<00:04, 17.83it/s][6/6] extract embeddings:  20%|██        | 21/104 [00:01<00:03, 21.55it/s][6/6] extract embeddings:  24%|██▍       | 25/104 [00:01<00:03, 24.42it/s][6/6] extract embeddings:  28%|██▊       | 29/104 [00:01<00:02, 26.96it/s][6/6] extract embeddings:  32%|███▏      | 33/104 [00:02<00:02, 29.29it/s][6/6] extract embeddings:  36%|███▌      | 37/104 [00:02<00:02, 30.07it/s][6/6] extract embeddings:  39%|███▉      | 41/104 [00:02<00:02, 29.95it/s][6/6] extract embeddings:  43%|████▎     | 45/104 [00:02<00:01, 31.11it/s][6/6] extract embeddings:  47%|████▋     | 49/104 [00:02<00:01, 31.20it/s][6/6] extract embeddings:  51%|█████     | 53/104 [00:02<00:01, 30.85it/s][6/6] extract embeddings:  55%|█████▍    | 57/104 [00:02<00:01, 31.98it/s][6/6] extract embeddings:  59%|█████▊    | 61/104 [00:02<00:01, 32.02it/s][6/6] extract embeddings:  62%|██████▎   | 65/104 [00:03<00:01, 32.95it/s][6/6] extract embeddings:  66%|██████▋   | 69/104 [00:03<00:01, 31.90it/s][6/6] extract embeddings:  70%|███████   | 73/104 [00:03<00:00, 32.67it/s][6/6] extract embeddings:  74%|███████▍  | 77/104 [00:03<00:00, 33.53it/s][6/6] extract embeddings:  78%|███████▊  | 81/104 [00:03<00:00, 33.48it/s][6/6] extract embeddings:  82%|████████▏ | 85/104 [00:03<00:00, 33.43it/s][6/6] extract embeddings:  86%|████████▌ | 89/104 [00:03<00:00, 33.40it/s][6/6] extract embeddings:  89%|████████▉ | 93/104 [00:03<00:00, 33.38it/s][6/6] extract embeddings:  93%|█████████▎| 97/104 [00:04<00:00, 33.55it/s][6/6] extract embeddings:  97%|█████████▋| 101/104 [00:04<00:00, 33.64it/s][6/6] extract embeddings: 100%|██████████| 104/104 [00:04<00:00, 24.26it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.86it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.28it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.11it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s]
[NeMo I 2025-04-17 02:07:06 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:07:07 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              64.458947   444.120  ...   9.375038  2.110924
    Harker-ES                       62.223312  2178.782  ...  29.838076  1.369484
    Harker-MN                       65.718334   366.767  ...  21.611997  5.892568
    Longfellow-Block-1              59.069044   492.417  ...  11.828000  2.402029
    TOTAL                           62.430525  3482.086  ...  72.653110  2.086482
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:07:07 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0306 | MISS: 0.5728 | CER: 0.0209 | DER: 0.6243 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.55
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.55 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.73s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:07:18 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:07:18 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:07:18 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:07:18 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:07:18 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:07:19 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:07:19 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:07:19 features:305] PADDING: 16
[NeMo I 2025-04-17 02:07:19 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:07:19 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:07:19 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:07:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:07:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:07:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:07:19 collections:880] Dataset successfully loaded with 1997 items and total duration provided from manifest is  0.53 hours.
[NeMo I 2025-04-17 02:07:19 collections:886] # 1997 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:01,  1.97s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.47it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.77it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.25it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.77it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.34it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.88it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.96it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 18.93it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 20.13it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 21.53it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.75it/s]
[NeMo I 2025-04-17 02:07:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:07:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:07:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:07:23 collections:880] Dataset successfully loaded with 2073 items and total duration provided from manifest is  0.54 hours.
[NeMo I 2025-04-17 02:07:23 collections:886] # 2073 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:44,  1.38s/it][2/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:08,  3.36it/s][2/6] extract embeddings:  21%|██        | 7/33 [00:01<00:04,  6.16it/s][2/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02,  9.09it/s][2/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 11.81it/s][2/6] extract embeddings:  48%|████▊     | 16/33 [00:02<00:01, 14.64it/s][2/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 16.83it/s][2/6] extract embeddings:  67%|██████▋   | 22/33 [00:02<00:00, 18.28it/s][2/6] extract embeddings:  76%|███████▌  | 25/33 [00:02<00:00, 19.93it/s][2/6] extract embeddings:  85%|████████▍ | 28/33 [00:02<00:00, 19.88it/s][2/6] extract embeddings:  94%|█████████▍| 31/33 [00:02<00:00, 21.17it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 11.90it/s]
[NeMo I 2025-04-17 02:07:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:07:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:07:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:07:26 collections:880] Dataset successfully loaded with 2216 items and total duration provided from manifest is  0.57 hours.
[NeMo I 2025-04-17 02:07:26 collections:886] # 2216 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:38,  1.13s/it][3/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:07,  4.10it/s][3/6] extract embeddings:  20%|██        | 7/35 [00:01<00:03,  7.39it/s][3/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02, 10.46it/s][3/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 13.43it/s][3/6] extract embeddings:  46%|████▌     | 16/35 [00:01<00:01, 16.19it/s][3/6] extract embeddings:  54%|█████▍    | 19/35 [00:01<00:00, 18.80it/s][3/6] extract embeddings:  63%|██████▎   | 22/35 [00:01<00:00, 20.07it/s][3/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 22.10it/s][3/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 21.65it/s][3/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 23.21it/s][3/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 23.30it/s][3/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 13.88it/s]
[NeMo I 2025-04-17 02:07:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:07:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:07:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:07:28 collections:880] Dataset successfully loaded with 2546 items and total duration provided from manifest is  0.62 hours.
[NeMo I 2025-04-17 02:07:28 collections:886] # 2546 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:44,  1.13s/it][4/6] extract embeddings:  10%|█         | 4/40 [00:01<00:08,  4.14it/s][4/6] extract embeddings:  18%|█▊        | 7/40 [00:01<00:04,  7.45it/s][4/6] extract embeddings:  25%|██▌       | 10/40 [00:01<00:02, 10.80it/s][4/6] extract embeddings:  32%|███▎      | 13/40 [00:01<00:01, 13.80it/s][4/6] extract embeddings:  40%|████      | 16/40 [00:01<00:01, 16.27it/s][4/6] extract embeddings:  48%|████▊     | 19/40 [00:01<00:01, 19.02it/s][4/6] extract embeddings:  55%|█████▌    | 22/40 [00:01<00:00, 20.49it/s][4/6] extract embeddings:  62%|██████▎   | 25/40 [00:02<00:00, 22.38it/s][4/6] extract embeddings:  70%|███████   | 28/40 [00:02<00:00, 24.01it/s][4/6] extract embeddings:  78%|███████▊  | 31/40 [00:02<00:00, 24.53it/s][4/6] extract embeddings:  85%|████████▌ | 34/40 [00:02<00:00, 24.15it/s][4/6] extract embeddings:  92%|█████████▎| 37/40 [00:02<00:00, 24.16it/s][4/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 25.36it/s][4/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 15.01it/s]
[NeMo I 2025-04-17 02:07:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:07:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:07:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:07:31 collections:880] Dataset successfully loaded with 3348 items and total duration provided from manifest is  0.68 hours.
[NeMo I 2025-04-17 02:07:31 collections:886] # 3348 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/53 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/53 [00:01<00:59,  1.15s/it][5/6] extract embeddings:   8%|▊         | 4/53 [00:01<00:11,  4.09it/s][5/6] extract embeddings:  13%|█▎        | 7/53 [00:01<00:06,  7.38it/s][5/6] extract embeddings:  19%|█▉        | 10/53 [00:01<00:03, 10.92it/s][5/6] extract embeddings:  26%|██▋       | 14/53 [00:01<00:02, 15.29it/s][5/6] extract embeddings:  34%|███▍      | 18/53 [00:01<00:01, 18.79it/s][5/6] extract embeddings:  40%|███▉      | 21/53 [00:01<00:01, 20.77it/s][5/6] extract embeddings:  45%|████▌     | 24/53 [00:01<00:01, 22.59it/s][5/6] extract embeddings:  51%|█████     | 27/53 [00:02<00:01, 24.12it/s][5/6] extract embeddings:  57%|█████▋    | 30/53 [00:02<00:00, 25.11it/s][5/6] extract embeddings:  64%|██████▍   | 34/53 [00:02<00:00, 26.51it/s][5/6] extract embeddings:  70%|██████▉   | 37/53 [00:02<00:00, 27.01it/s][5/6] extract embeddings:  75%|███████▌  | 40/53 [00:02<00:00, 26.25it/s][5/6] extract embeddings:  81%|████████  | 43/53 [00:02<00:00, 26.89it/s][5/6] extract embeddings:  87%|████████▋ | 46/53 [00:02<00:00, 26.65it/s][5/6] extract embeddings:  92%|█████████▏| 49/53 [00:02<00:00, 27.55it/s][5/6] extract embeddings:  98%|█████████▊| 52/53 [00:02<00:00, 27.62it/s][5/6] extract embeddings: 100%|██████████| 53/53 [00:03<00:00, 17.50it/s]
[NeMo I 2025-04-17 02:07:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:07:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:07:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:07:34 collections:880] Dataset successfully loaded with 6312 items and total duration provided from manifest is  0.79 hours.
[NeMo I 2025-04-17 02:07:34 collections:886] # 6312 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/99 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/99 [00:01<01:49,  1.12s/it][6/6] extract embeddings:   5%|▌         | 5/99 [00:01<00:17,  5.28it/s][6/6] extract embeddings:   9%|▉         | 9/99 [00:01<00:09,  9.69it/s][6/6] extract embeddings:  13%|█▎        | 13/99 [00:01<00:06, 14.26it/s][6/6] extract embeddings:  17%|█▋        | 17/99 [00:01<00:04, 18.21it/s][6/6] extract embeddings:  21%|██        | 21/99 [00:01<00:03, 21.93it/s][6/6] extract embeddings:  25%|██▌       | 25/99 [00:01<00:03, 24.06it/s][6/6] extract embeddings:  29%|██▉       | 29/99 [00:01<00:02, 26.80it/s][6/6] extract embeddings:  33%|███▎      | 33/99 [00:02<00:02, 28.82it/s][6/6] extract embeddings:  37%|███▋      | 37/99 [00:02<00:02, 30.23it/s][6/6] extract embeddings:  41%|████▏     | 41/99 [00:02<00:01, 31.02it/s][6/6] extract embeddings:  45%|████▌     | 45/99 [00:02<00:01, 31.70it/s][6/6] extract embeddings:  49%|████▉     | 49/99 [00:02<00:01, 31.04it/s][6/6] extract embeddings:  54%|█████▎    | 53/99 [00:02<00:01, 32.23it/s][6/6] extract embeddings:  58%|█████▊    | 57/99 [00:02<00:01, 32.24it/s][6/6] extract embeddings:  62%|██████▏   | 61/99 [00:02<00:01, 33.00it/s][6/6] extract embeddings:  66%|██████▌   | 65/99 [00:03<00:01, 31.13it/s][6/6] extract embeddings:  70%|██████▉   | 69/99 [00:03<00:00, 32.70it/s][6/6] extract embeddings:  74%|███████▎  | 73/99 [00:03<00:00, 32.56it/s][6/6] extract embeddings:  78%|███████▊  | 77/99 [00:03<00:00, 33.11it/s][6/6] extract embeddings:  82%|████████▏ | 81/99 [00:03<00:00, 31.91it/s][6/6] extract embeddings:  86%|████████▌ | 85/99 [00:03<00:00, 32.55it/s][6/6] extract embeddings:  90%|████████▉ | 89/99 [00:03<00:00, 32.88it/s][6/6] extract embeddings:  94%|█████████▍| 93/99 [00:03<00:00, 34.02it/s][6/6] extract embeddings:  98%|█████████▊| 97/99 [00:04<00:00, 33.73it/s][6/6] extract embeddings: 100%|██████████| 99/99 [00:04<00:00, 24.21it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.96it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.33it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.18it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.38it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s]
[NeMo I 2025-04-17 02:07:40 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:07:41 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              65.905589   444.120  ...   9.490004  2.136811
    Harker-ES                       63.806222  2178.782  ...  28.713818  1.317884
    Harker-MN                       67.412571   366.767  ...  20.678021  5.637917
    Longfellow-Block-1              60.010747   492.417  ...   9.216028  1.871590
    TOTAL                           63.917105  3482.086  ...  68.097871  1.955663
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:07:41 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0286 | MISS: 0.5911 | CER: 0.0196 | DER: 0.6392 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.55
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.55 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.68s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.86s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:07:52 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:07:52 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:07:52 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:07:52 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:07:52 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:07:53 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:07:53 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:07:53 features:305] PADDING: 16
[NeMo I 2025-04-17 02:07:53 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:07:53 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:07:53 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:07:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:07:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:07:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:07:53 collections:880] Dataset successfully loaded with 1996 items and total duration provided from manifest is  0.49 hours.
[NeMo I 2025-04-17 02:07:53 collections:886] # 1996 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.96s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.49it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.74it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.33it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.94it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.57it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 15.05it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 17.17it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 18.83it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 20.39it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 20.34it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.77it/s]
[NeMo I 2025-04-17 02:07:57 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:07:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:07:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:07:57 collections:880] Dataset successfully loaded with 2058 items and total duration provided from manifest is  0.50 hours.
[NeMo I 2025-04-17 02:07:57 collections:886] # 2058 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:43,  1.37s/it][2/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:08,  3.45it/s][2/6] extract embeddings:  21%|██        | 7/33 [00:01<00:04,  6.40it/s][2/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02,  9.24it/s][2/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 12.26it/s][2/6] extract embeddings:  48%|████▊     | 16/33 [00:01<00:01, 14.88it/s][2/6] extract embeddings:  58%|█████▊    | 19/33 [00:02<00:00, 17.53it/s][2/6] extract embeddings:  67%|██████▋   | 22/33 [00:02<00:00, 19.55it/s][2/6] extract embeddings:  76%|███████▌  | 25/33 [00:02<00:00, 20.79it/s][2/6] extract embeddings:  85%|████████▍ | 28/33 [00:02<00:00, 22.08it/s][2/6] extract embeddings:  94%|█████████▍| 31/33 [00:02<00:00, 22.37it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 12.24it/s]
[NeMo I 2025-04-17 02:07:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:08:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:00 collections:880] Dataset successfully loaded with 2177 items and total duration provided from manifest is  0.53 hours.
[NeMo I 2025-04-17 02:08:00 collections:886] # 2177 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:38,  1.12s/it][3/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:07,  3.97it/s][3/6] extract embeddings:  20%|██        | 7/35 [00:01<00:03,  7.08it/s][3/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02, 10.14it/s][3/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 13.35it/s][3/6] extract embeddings:  46%|████▌     | 16/35 [00:01<00:01, 16.23it/s][3/6] extract embeddings:  54%|█████▍    | 19/35 [00:01<00:00, 18.21it/s][3/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 19.67it/s][3/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 21.67it/s][3/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 22.35it/s][3/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 24.07it/s][3/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 24.29it/s][3/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 13.74it/s]
[NeMo I 2025-04-17 02:08:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:08:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:02 collections:880] Dataset successfully loaded with 2463 items and total duration provided from manifest is  0.57 hours.
[NeMo I 2025-04-17 02:08:02 collections:886] # 2463 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:45,  1.20s/it][4/6] extract embeddings:  10%|█         | 4/39 [00:01<00:09,  3.87it/s][4/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  7.12it/s][4/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:02, 10.46it/s][4/6] extract embeddings:  33%|███▎      | 13/39 [00:01<00:01, 13.45it/s][4/6] extract embeddings:  41%|████      | 16/39 [00:01<00:01, 16.07it/s][4/6] extract embeddings:  49%|████▊     | 19/39 [00:01<00:01, 18.78it/s][4/6] extract embeddings:  56%|█████▋    | 22/39 [00:02<00:00, 20.54it/s][4/6] extract embeddings:  64%|██████▍   | 25/39 [00:02<00:00, 22.38it/s][4/6] extract embeddings:  72%|███████▏  | 28/39 [00:02<00:00, 23.49it/s][4/6] extract embeddings:  79%|███████▉  | 31/39 [00:02<00:00, 23.57it/s][4/6] extract embeddings:  87%|████████▋ | 34/39 [00:02<00:00, 24.20it/s][4/6] extract embeddings:  95%|█████████▍| 37/39 [00:02<00:00, 25.21it/s][4/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 14.47it/s]
[NeMo I 2025-04-17 02:08:05 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:08:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:05 collections:880] Dataset successfully loaded with 3188 items and total duration provided from manifest is  0.63 hours.
[NeMo I 2025-04-17 02:08:05 collections:886] # 3188 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/50 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/50 [00:01<00:55,  1.13s/it][5/6] extract embeddings:   8%|▊         | 4/50 [00:01<00:11,  4.13it/s][5/6] extract embeddings:  14%|█▍        | 7/50 [00:01<00:05,  7.61it/s][5/6] extract embeddings:  20%|██        | 10/50 [00:01<00:03, 11.04it/s][5/6] extract embeddings:  26%|██▌       | 13/50 [00:01<00:02, 14.46it/s][5/6] extract embeddings:  32%|███▏      | 16/50 [00:01<00:01, 17.50it/s][5/6] extract embeddings:  40%|████      | 20/50 [00:01<00:01, 21.06it/s][5/6] extract embeddings:  46%|████▌     | 23/50 [00:01<00:01, 23.04it/s][5/6] extract embeddings:  52%|█████▏    | 26/50 [00:02<00:00, 24.56it/s][5/6] extract embeddings:  60%|██████    | 30/50 [00:02<00:00, 26.47it/s][5/6] extract embeddings:  66%|██████▌   | 33/50 [00:02<00:00, 27.18it/s][5/6] extract embeddings:  72%|███████▏  | 36/50 [00:02<00:00, 27.85it/s][5/6] extract embeddings:  78%|███████▊  | 39/50 [00:02<00:00, 27.09it/s][5/6] extract embeddings:  84%|████████▍ | 42/50 [00:02<00:00, 27.41it/s][5/6] extract embeddings:  92%|█████████▏| 46/50 [00:02<00:00, 28.08it/s][5/6] extract embeddings:  98%|█████████▊| 49/50 [00:02<00:00, 27.37it/s][5/6] extract embeddings: 100%|██████████| 50/50 [00:02<00:00, 17.39it/s]
[NeMo I 2025-04-17 02:08:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:08:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:08 collections:880] Dataset successfully loaded with 5928 items and total duration provided from manifest is  0.73 hours.
[NeMo I 2025-04-17 02:08:08 collections:886] # 5928 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/93 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/93 [00:01<01:48,  1.17s/it][6/6] extract embeddings:   5%|▌         | 5/93 [00:01<00:17,  5.01it/s][6/6] extract embeddings:  10%|▉         | 9/93 [00:01<00:09,  9.31it/s][6/6] extract embeddings:  14%|█▍        | 13/93 [00:01<00:05, 13.83it/s][6/6] extract embeddings:  18%|█▊        | 17/93 [00:01<00:04, 17.62it/s][6/6] extract embeddings:  23%|██▎       | 21/93 [00:01<00:03, 21.48it/s][6/6] extract embeddings:  27%|██▋       | 25/93 [00:01<00:02, 24.36it/s][6/6] extract embeddings:  31%|███       | 29/93 [00:02<00:02, 26.83it/s][6/6] extract embeddings:  35%|███▌      | 33/93 [00:02<00:02, 28.62it/s][6/6] extract embeddings:  40%|███▉      | 37/93 [00:02<00:01, 29.34it/s][6/6] extract embeddings:  44%|████▍     | 41/93 [00:02<00:01, 30.76it/s][6/6] extract embeddings:  48%|████▊     | 45/93 [00:02<00:01, 29.82it/s][6/6] extract embeddings:  53%|█████▎    | 49/93 [00:02<00:01, 31.58it/s][6/6] extract embeddings:  57%|█████▋    | 53/93 [00:02<00:01, 30.89it/s][6/6] extract embeddings:  61%|██████▏   | 57/93 [00:02<00:01, 31.19it/s][6/6] extract embeddings:  66%|██████▌   | 61/93 [00:03<00:01, 31.38it/s][6/6] extract embeddings:  70%|██████▉   | 65/93 [00:03<00:00, 31.57it/s][6/6] extract embeddings:  74%|███████▍  | 69/93 [00:03<00:00, 31.28it/s][6/6] extract embeddings:  78%|███████▊  | 73/93 [00:03<00:00, 31.86it/s][6/6] extract embeddings:  83%|████████▎ | 77/93 [00:03<00:00, 32.50it/s][6/6] extract embeddings:  87%|████████▋ | 81/93 [00:03<00:00, 31.58it/s][6/6] extract embeddings:  91%|█████████▏| 85/93 [00:03<00:00, 32.32it/s][6/6] extract embeddings:  96%|█████████▌| 89/93 [00:03<00:00, 31.80it/s][6/6] extract embeddings: 100%|██████████| 93/93 [00:03<00:00, 32.81it/s][6/6] extract embeddings: 100%|██████████| 93/93 [00:04<00:00, 23.06it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.97it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.45it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.77it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.83it/s]
[NeMo I 2025-04-17 02:08:14 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:08:15 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              67.953449   444.120  ...   8.714972  1.962301
    Harker-ES                       65.933026  2178.782  ...  26.380562  1.210794
    Harker-MN                       68.280186   366.767  ...  19.824048  5.405080
    Longfellow-Block-1              62.510473   492.417  ...   9.842069  1.998726
    TOTAL                           65.953947  3482.086  ...  64.761652  1.859852
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:08:15 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0268 | MISS: 0.6141 | CER: 0.0186 | DER: 0.6595 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.55
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.55 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.74s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:08:27 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:08:27 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:08:27 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:08:27 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:08:27 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:08:27 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:08:27 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:08:27 features:305] PADDING: 16
[NeMo I 2025-04-17 02:08:27 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:08:27 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:08:27 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:08:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:08:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:27 collections:880] Dataset successfully loaded with 1945 items and total duration provided from manifest is  0.44 hours.
[NeMo I 2025-04-17 02:08:27 collections:886] # 1945 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/31 [00:02<01:00,  2.00s/it][1/6] extract embeddings:  13%|█▎        | 4/31 [00:02<00:11,  2.43it/s][1/6] extract embeddings:  23%|██▎       | 7/31 [00:02<00:05,  4.68it/s][1/6] extract embeddings:  32%|███▏      | 10/31 [00:02<00:02,  7.20it/s][1/6] extract embeddings:  42%|████▏     | 13/31 [00:02<00:01,  9.77it/s][1/6] extract embeddings:  52%|█████▏    | 16/31 [00:02<00:01, 12.40it/s][1/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 13.97it/s][1/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 15.03it/s][1/6] extract embeddings:  81%|████████  | 25/31 [00:03<00:00, 16.62it/s][1/6] extract embeddings:  90%|█████████ | 28/31 [00:03<00:00, 18.47it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00, 20.52it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00,  9.24it/s]
[NeMo I 2025-04-17 02:08:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:08:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:31 collections:880] Dataset successfully loaded with 1992 items and total duration provided from manifest is  0.45 hours.
[NeMo I 2025-04-17 02:08:31 collections:886] # 1992 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:42,  1.37s/it][2/6] extract embeddings:   9%|▉         | 3/32 [00:01<00:11,  2.54it/s][2/6] extract embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.59it/s][2/6] extract embeddings:  25%|██▌       | 8/32 [00:01<00:02,  8.07it/s][2/6] extract embeddings:  34%|███▍      | 11/32 [00:01<00:01, 11.12it/s][2/6] extract embeddings:  44%|████▍     | 14/32 [00:01<00:01, 14.01it/s][2/6] extract embeddings:  53%|█████▎    | 17/32 [00:02<00:00, 17.00it/s][2/6] extract embeddings:  62%|██████▎   | 20/32 [00:02<00:00, 19.18it/s][2/6] extract embeddings:  72%|███████▏  | 23/32 [00:02<00:00, 21.35it/s][2/6] extract embeddings:  81%|████████▏ | 26/32 [00:02<00:00, 22.13it/s][2/6] extract embeddings:  91%|█████████ | 29/32 [00:02<00:00, 22.81it/s][2/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 24.07it/s][2/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 11.96it/s]
[NeMo I 2025-04-17 02:08:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:08:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:34 collections:880] Dataset successfully loaded with 2093 items and total duration provided from manifest is  0.47 hours.
[NeMo I 2025-04-17 02:08:34 collections:886] # 2093 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:36,  1.13s/it][3/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:07,  3.91it/s][3/6] extract embeddings:  21%|██        | 7/33 [00:01<00:03,  7.20it/s][3/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02, 10.30it/s][3/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 13.46it/s][3/6] extract embeddings:  48%|████▊     | 16/33 [00:01<00:01, 15.74it/s][3/6] extract embeddings:  58%|█████▊    | 19/33 [00:01<00:00, 17.82it/s][3/6] extract embeddings:  67%|██████▋   | 22/33 [00:02<00:00, 19.53it/s][3/6] extract embeddings:  76%|███████▌  | 25/33 [00:02<00:00, 21.49it/s][3/6] extract embeddings:  85%|████████▍ | 28/33 [00:02<00:00, 21.48it/s][3/6] extract embeddings:  94%|█████████▍| 31/33 [00:02<00:00, 22.94it/s][3/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 13.35it/s]
[NeMo I 2025-04-17 02:08:36 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:08:36 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:36 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:36 collections:880] Dataset successfully loaded with 2326 items and total duration provided from manifest is  0.50 hours.
[NeMo I 2025-04-17 02:08:36 collections:886] # 2326 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:41,  1.16s/it][4/6] extract embeddings:  11%|█         | 4/37 [00:01<00:08,  4.00it/s][4/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  7.27it/s][4/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02, 10.80it/s][4/6] extract embeddings:  35%|███▌      | 13/37 [00:01<00:01, 13.67it/s][4/6] extract embeddings:  43%|████▎     | 16/37 [00:01<00:01, 16.53it/s][4/6] extract embeddings:  54%|█████▍    | 20/37 [00:01<00:00, 20.04it/s][4/6] extract embeddings:  62%|██████▏   | 23/37 [00:01<00:00, 21.92it/s][4/6] extract embeddings:  73%|███████▎  | 27/37 [00:02<00:00, 23.97it/s][4/6] extract embeddings:  81%|████████  | 30/37 [00:02<00:00, 24.47it/s][4/6] extract embeddings:  89%|████████▉ | 33/37 [00:02<00:00, 25.34it/s][4/6] extract embeddings:  97%|█████████▋| 36/37 [00:02<00:00, 26.04it/s][4/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 14.79it/s]
[NeMo I 2025-04-17 02:08:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:08:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:39 collections:880] Dataset successfully loaded with 2955 items and total duration provided from manifest is  0.56 hours.
[NeMo I 2025-04-17 02:08:39 collections:886] # 2955 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:52,  1.14s/it][5/6] extract embeddings:  11%|█         | 5/47 [00:01<00:08,  5.10it/s][5/6] extract embeddings:  17%|█▋        | 8/47 [00:01<00:04,  8.36it/s][5/6] extract embeddings:  26%|██▌       | 12/47 [00:01<00:02, 12.83it/s][5/6] extract embeddings:  32%|███▏      | 15/47 [00:01<00:02, 15.68it/s][5/6] extract embeddings:  40%|████      | 19/47 [00:01<00:01, 19.62it/s][5/6] extract embeddings:  47%|████▋     | 22/47 [00:01<00:01, 21.45it/s][5/6] extract embeddings:  55%|█████▌    | 26/47 [00:01<00:00, 23.86it/s][5/6] extract embeddings:  64%|██████▍   | 30/47 [00:02<00:00, 25.74it/s][5/6] extract embeddings:  72%|███████▏  | 34/47 [00:02<00:00, 27.04it/s][5/6] extract embeddings:  79%|███████▊  | 37/47 [00:02<00:00, 27.45it/s][5/6] extract embeddings:  85%|████████▌ | 40/47 [00:02<00:00, 28.06it/s][5/6] extract embeddings:  94%|█████████▎| 44/47 [00:02<00:00, 28.54it/s][5/6] extract embeddings: 100%|██████████| 47/47 [00:02<00:00, 17.46it/s]
[NeMo I 2025-04-17 02:08:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:08:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:08:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:08:42 collections:880] Dataset successfully loaded with 5396 items and total duration provided from manifest is  0.66 hours.
[NeMo I 2025-04-17 02:08:42 collections:886] # 5396 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/85 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/85 [00:01<01:36,  1.15s/it][6/6] extract embeddings:   6%|▌         | 5/85 [00:01<00:15,  5.14it/s][6/6] extract embeddings:  11%|█         | 9/85 [00:01<00:07,  9.71it/s][6/6] extract embeddings:  15%|█▌        | 13/85 [00:01<00:05, 14.11it/s][6/6] extract embeddings:  20%|██        | 17/85 [00:01<00:03, 17.92it/s][6/6] extract embeddings:  25%|██▍       | 21/85 [00:01<00:02, 21.58it/s][6/6] extract embeddings:  29%|██▉       | 25/85 [00:01<00:02, 24.31it/s][6/6] extract embeddings:  34%|███▍      | 29/85 [00:01<00:02, 27.15it/s][6/6] extract embeddings:  39%|███▉      | 33/85 [00:02<00:01, 28.94it/s][6/6] extract embeddings:  44%|████▎     | 37/85 [00:02<00:01, 30.84it/s][6/6] extract embeddings:  48%|████▊     | 41/85 [00:02<00:01, 30.20it/s][6/6] extract embeddings:  53%|█████▎    | 45/85 [00:02<00:01, 31.65it/s][6/6] extract embeddings:  58%|█████▊    | 49/85 [00:02<00:01, 32.52it/s][6/6] extract embeddings:  62%|██████▏   | 53/85 [00:02<00:00, 32.23it/s][6/6] extract embeddings:  67%|██████▋   | 57/85 [00:02<00:00, 32.87it/s][6/6] extract embeddings:  72%|███████▏  | 61/85 [00:02<00:00, 33.68it/s][6/6] extract embeddings:  76%|███████▋  | 65/85 [00:03<00:00, 32.83it/s][6/6] extract embeddings:  81%|████████  | 69/85 [00:03<00:00, 33.39it/s][6/6] extract embeddings:  86%|████████▌ | 73/85 [00:03<00:00, 32.87it/s][6/6] extract embeddings:  91%|█████████ | 77/85 [00:03<00:00, 33.86it/s][6/6] extract embeddings:  95%|█████████▌| 81/85 [00:03<00:00, 32.43it/s][6/6] extract embeddings: 100%|██████████| 85/85 [00:03<00:00, 33.92it/s][6/6] extract embeddings: 100%|██████████| 85/85 [00:03<00:00, 23.16it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.08it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.55it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.95it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.38it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s]
[NeMo I 2025-04-17 02:08:47 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:08:48 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              70.930075   444.120  ...  10.274951  2.313553
    Harker-ES                       69.401334  2178.782  ...  27.055341  1.241764
    Harker-MN                       69.918210   366.767  ...  18.449032  5.030178
    Longfellow-Block-1              65.452520   492.417  ...  10.215078  2.074477
    TOTAL                           69.092339  3482.086  ...  65.994401  1.895255
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:08:48 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0239 | MISS: 0.6481 | CER: 0.0190 | DER: 0.6909 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.65, offset=0.60
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.65, <class 'float'> offset=0.6 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.69s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.87s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:09:00 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:09:00 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:09:00 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:09:00 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:09:00 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:09:00 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:09:00 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:09:00 features:305] PADDING: 16
[NeMo I 2025-04-17 02:09:00 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:09:00 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:09:00 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:09:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:09:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:00 collections:880] Dataset successfully loaded with 2002 items and total duration provided from manifest is  0.53 hours.
[NeMo I 2025-04-17 02:09:00 collections:886] # 2002 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:01<01:00,  1.96s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.48it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.76it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.18it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:01,  9.77it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.29it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.82it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.67it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 18.54it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 20.07it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 21.00it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.72it/s]
[NeMo I 2025-04-17 02:09:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:09:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:04 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:04 collections:880] Dataset successfully loaded with 2088 items and total duration provided from manifest is  0.55 hours.
[NeMo I 2025-04-17 02:09:04 collections:886] # 2088 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:46,  1.45s/it][2/6] extract embeddings:   9%|▉         | 3/33 [00:01<00:12,  2.40it/s][2/6] extract embeddings:  15%|█▌        | 5/33 [00:01<00:06,  4.33it/s][2/6] extract embeddings:  24%|██▍       | 8/33 [00:01<00:03,  7.67it/s][2/6] extract embeddings:  33%|███▎      | 11/33 [00:01<00:02, 10.47it/s][2/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 13.41it/s][2/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:00, 16.12it/s][2/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 17.77it/s][2/6] extract embeddings:  70%|██████▉   | 23/33 [00:02<00:00, 19.33it/s][2/6] extract embeddings:  79%|███████▉  | 26/33 [00:02<00:00, 20.58it/s][2/6] extract embeddings:  88%|████████▊ | 29/33 [00:02<00:00, 20.31it/s][2/6] extract embeddings:  97%|█████████▋| 32/33 [00:02<00:00, 21.55it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 11.38it/s]
[NeMo I 2025-04-17 02:09:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:09:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:07 collections:880] Dataset successfully loaded with 2236 items and total duration provided from manifest is  0.58 hours.
[NeMo I 2025-04-17 02:09:07 collections:886] # 2236 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:38,  1.13s/it][3/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:07,  4.08it/s][3/6] extract embeddings:  20%|██        | 7/35 [00:01<00:03,  7.36it/s][3/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02, 10.61it/s][3/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 13.31it/s][3/6] extract embeddings:  46%|████▌     | 16/35 [00:01<00:01, 15.74it/s][3/6] extract embeddings:  54%|█████▍    | 19/35 [00:01<00:00, 18.34it/s][3/6] extract embeddings:  63%|██████▎   | 22/35 [00:01<00:00, 20.20it/s][3/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 21.18it/s][3/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 21.95it/s][3/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 22.36it/s][3/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 23.24it/s][3/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 13.72it/s]
[NeMo I 2025-04-17 02:09:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:09:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:10 collections:880] Dataset successfully loaded with 2567 items and total duration provided from manifest is  0.62 hours.
[NeMo I 2025-04-17 02:09:10 collections:886] # 2567 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/41 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▏         | 1/41 [00:01<00:47,  1.18s/it][4/6] extract embeddings:  10%|▉         | 4/41 [00:01<00:09,  3.92it/s][4/6] extract embeddings:  17%|█▋        | 7/41 [00:01<00:04,  7.03it/s][4/6] extract embeddings:  24%|██▍       | 10/41 [00:01<00:03, 10.30it/s][4/6] extract embeddings:  32%|███▏      | 13/41 [00:01<00:02, 13.12it/s][4/6] extract embeddings:  39%|███▉      | 16/41 [00:01<00:01, 15.80it/s][4/6] extract embeddings:  46%|████▋     | 19/41 [00:01<00:01, 18.58it/s][4/6] extract embeddings:  54%|█████▎    | 22/41 [00:02<00:00, 20.70it/s][4/6] extract embeddings:  61%|██████    | 25/41 [00:02<00:00, 21.09it/s][4/6] extract embeddings:  68%|██████▊   | 28/41 [00:02<00:00, 21.58it/s][4/6] extract embeddings:  76%|███████▌  | 31/41 [00:02<00:00, 22.89it/s][4/6] extract embeddings:  83%|████████▎ | 34/41 [00:02<00:00, 23.31it/s][4/6] extract embeddings:  90%|█████████ | 37/41 [00:02<00:00, 24.08it/s][4/6] extract embeddings:  98%|█████████▊| 40/41 [00:02<00:00, 24.67it/s][4/6] extract embeddings: 100%|██████████| 41/41 [00:02<00:00, 14.54it/s]
[NeMo I 2025-04-17 02:09:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:09:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:13 collections:880] Dataset successfully loaded with 3386 items and total duration provided from manifest is  0.69 hours.
[NeMo I 2025-04-17 02:09:13 collections:886] # 3386 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/53 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/53 [00:01<00:58,  1.13s/it][5/6] extract embeddings:   8%|▊         | 4/53 [00:01<00:12,  4.03it/s][5/6] extract embeddings:  11%|█▏        | 6/53 [00:01<00:07,  6.11it/s][5/6] extract embeddings:  17%|█▋        | 9/53 [00:01<00:04,  9.44it/s][5/6] extract embeddings:  23%|██▎       | 12/53 [00:01<00:03, 12.75it/s][5/6] extract embeddings:  28%|██▊       | 15/53 [00:01<00:02, 16.06it/s][5/6] extract embeddings:  34%|███▍      | 18/53 [00:01<00:01, 18.82it/s][5/6] extract embeddings:  40%|███▉      | 21/53 [00:01<00:01, 20.99it/s][5/6] extract embeddings:  47%|████▋     | 25/53 [00:02<00:01, 23.42it/s][5/6] extract embeddings:  55%|█████▍    | 29/53 [00:02<00:00, 25.25it/s][5/6] extract embeddings:  60%|██████    | 32/53 [00:02<00:00, 25.66it/s][5/6] extract embeddings:  66%|██████▌   | 35/53 [00:02<00:00, 25.07it/s][5/6] extract embeddings:  72%|███████▏  | 38/53 [00:02<00:00, 25.96it/s][5/6] extract embeddings:  77%|███████▋  | 41/53 [00:02<00:00, 26.47it/s][5/6] extract embeddings:  83%|████████▎ | 44/53 [00:02<00:00, 26.84it/s][5/6] extract embeddings:  89%|████████▊ | 47/53 [00:02<00:00, 27.01it/s][5/6] extract embeddings:  96%|█████████▌| 51/53 [00:03<00:00, 27.70it/s][5/6] extract embeddings: 100%|██████████| 53/53 [00:03<00:00, 17.00it/s]
[NeMo I 2025-04-17 02:09:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:09:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:16 collections:880] Dataset successfully loaded with 6363 items and total duration provided from manifest is  0.79 hours.
[NeMo I 2025-04-17 02:09:16 collections:886] # 6363 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/100 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/100 [00:01<01:53,  1.14s/it][6/6] extract embeddings:   5%|▌         | 5/100 [00:01<00:18,  5.16it/s][6/6] extract embeddings:   9%|▉         | 9/100 [00:01<00:09,  9.72it/s][6/6] extract embeddings:  12%|█▏        | 12/100 [00:01<00:06, 12.90it/s][6/6] extract embeddings:  16%|█▌        | 16/100 [00:01<00:04, 17.48it/s][6/6] extract embeddings:  20%|██        | 20/100 [00:01<00:03, 21.60it/s][6/6] extract embeddings:  24%|██▍       | 24/100 [00:01<00:03, 24.39it/s][6/6] extract embeddings:  28%|██▊       | 28/100 [00:01<00:02, 27.12it/s][6/6] extract embeddings:  32%|███▏      | 32/100 [00:02<00:02, 29.32it/s][6/6] extract embeddings:  36%|███▌      | 36/100 [00:02<00:02, 30.91it/s][6/6] extract embeddings:  40%|████      | 40/100 [00:02<00:01, 31.73it/s][6/6] extract embeddings:  44%|████▍     | 44/100 [00:02<00:01, 32.52it/s][6/6] extract embeddings:  48%|████▊     | 48/100 [00:02<00:01, 31.78it/s][6/6] extract embeddings:  52%|█████▏    | 52/100 [00:02<00:01, 32.71it/s][6/6] extract embeddings:  56%|█████▌    | 56/100 [00:02<00:01, 33.22it/s][6/6] extract embeddings:  60%|██████    | 60/100 [00:02<00:01, 33.47it/s][6/6] extract embeddings:  64%|██████▍   | 64/100 [00:02<00:01, 33.24it/s][6/6] extract embeddings:  68%|██████▊   | 68/100 [00:03<00:00, 33.76it/s][6/6] extract embeddings:  72%|███████▏  | 72/100 [00:03<00:00, 34.71it/s][6/6] extract embeddings:  76%|███████▌  | 76/100 [00:03<00:00, 33.26it/s][6/6] extract embeddings:  80%|████████  | 80/100 [00:03<00:00, 33.63it/s][6/6] extract embeddings:  84%|████████▍ | 84/100 [00:03<00:00, 34.37it/s][6/6] extract embeddings:  88%|████████▊ | 88/100 [00:03<00:00, 34.26it/s][6/6] extract embeddings:  92%|█████████▏| 92/100 [00:03<00:00, 34.23it/s][6/6] extract embeddings:  96%|█████████▌| 96/100 [00:03<00:00, 34.41it/s][6/6] extract embeddings: 100%|██████████| 100/100 [00:04<00:00, 34.34it/s][6/6] extract embeddings: 100%|██████████| 100/100 [00:04<00:00, 24.53it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.89it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.30it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.14it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.35it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.97it/s]
[NeMo I 2025-04-17 02:09:22 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:09:23 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              65.420403   444.120  ...   8.034994  1.809194
    Harker-ES                       64.071120  2178.782  ...  27.914708  1.281207
    Harker-MN                       65.521739   366.767  ...  21.160013  5.769334
    Longfellow-Block-1              60.005672   492.417  ...   7.927007  1.609816
    TOTAL                           63.821093  3482.086  ...  65.036722  1.867752
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:09:23 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0287 | MISS: 0.5909 | CER: 0.0187 | DER: 0.6382 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.60
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.6 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.71s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:09:34 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:09:34 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:09:34 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:09:34 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:09:34 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:09:35 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:09:35 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:09:35 features:305] PADDING: 16
[NeMo I 2025-04-17 02:09:35 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:09:35 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:09:35 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:09:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:09:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:35 collections:880] Dataset successfully loaded with 1985 items and total duration provided from manifest is  0.51 hours.
[NeMo I 2025-04-17 02:09:35 collections:886] # 1985 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/32 [00:02<01:03,  2.05s/it][1/6] extract embeddings:  12%|█▎        | 4/32 [00:02<00:11,  2.38it/s][1/6] extract embeddings:  22%|██▏       | 7/32 [00:02<00:05,  4.60it/s][1/6] extract embeddings:  31%|███▏      | 10/32 [00:02<00:03,  7.03it/s][1/6] extract embeddings:  41%|████      | 13/32 [00:02<00:02,  9.46it/s][1/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 12.20it/s][1/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 14.28it/s][1/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 16.58it/s][1/6] extract embeddings:  78%|███████▊  | 25/32 [00:03<00:00, 17.74it/s][1/6] extract embeddings:  88%|████████▊ | 28/32 [00:03<00:00, 19.03it/s][1/6] extract embeddings:  97%|█████████▋| 31/32 [00:03<00:00, 20.41it/s][1/6] extract embeddings: 100%|██████████| 32/32 [00:03<00:00,  9.32it/s]
[NeMo I 2025-04-17 02:09:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:09:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:39 collections:880] Dataset successfully loaded with 2067 items and total duration provided from manifest is  0.53 hours.
[NeMo I 2025-04-17 02:09:39 collections:886] # 2067 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:45,  1.41s/it][2/6] extract embeddings:   9%|▉         | 3/33 [00:01<00:12,  2.47it/s][2/6] extract embeddings:  15%|█▌        | 5/33 [00:01<00:06,  4.43it/s][2/6] extract embeddings:  24%|██▍       | 8/33 [00:01<00:03,  7.77it/s][2/6] extract embeddings:  33%|███▎      | 11/33 [00:01<00:02, 10.73it/s][2/6] extract embeddings:  42%|████▏     | 14/33 [00:02<00:01, 13.75it/s][2/6] extract embeddings:  52%|█████▏    | 17/33 [00:02<00:00, 16.42it/s][2/6] extract embeddings:  61%|██████    | 20/33 [00:02<00:00, 18.82it/s][2/6] extract embeddings:  70%|██████▉   | 23/33 [00:02<00:00, 21.33it/s][2/6] extract embeddings:  79%|███████▉  | 26/33 [00:02<00:00, 21.82it/s][2/6] extract embeddings:  88%|████████▊ | 29/33 [00:02<00:00, 22.00it/s][2/6] extract embeddings:  97%|█████████▋| 32/33 [00:02<00:00, 23.28it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 11.85it/s]
[NeMo I 2025-04-17 02:09:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:09:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:42 collections:880] Dataset successfully loaded with 2208 items and total duration provided from manifest is  0.56 hours.
[NeMo I 2025-04-17 02:09:42 collections:886] # 2208 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:38,  1.15s/it][3/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:07,  3.90it/s][3/6] extract embeddings:  17%|█▋        | 6/35 [00:01<00:04,  5.96it/s][3/6] extract embeddings:  26%|██▌       | 9/35 [00:01<00:02,  9.59it/s][3/6] extract embeddings:  34%|███▍      | 12/35 [00:01<00:01, 12.24it/s][3/6] extract embeddings:  43%|████▎     | 15/35 [00:01<00:01, 15.55it/s][3/6] extract embeddings:  51%|█████▏    | 18/35 [00:01<00:00, 17.93it/s][3/6] extract embeddings:  60%|██████    | 21/35 [00:01<00:00, 19.70it/s][3/6] extract embeddings:  69%|██████▊   | 24/35 [00:02<00:00, 21.65it/s][3/6] extract embeddings:  77%|███████▋  | 27/35 [00:02<00:00, 22.22it/s][3/6] extract embeddings:  86%|████████▌ | 30/35 [00:02<00:00, 23.16it/s][3/6] extract embeddings:  94%|█████████▍| 33/35 [00:02<00:00, 23.43it/s][3/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 13.60it/s]
[NeMo I 2025-04-17 02:09:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:09:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:44 collections:880] Dataset successfully loaded with 2517 items and total duration provided from manifest is  0.60 hours.
[NeMo I 2025-04-17 02:09:44 collections:886] # 2517 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][4/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:45,  1.16s/it][4/6] extract embeddings:  10%|█         | 4/40 [00:01<00:09,  3.86it/s][4/6] extract embeddings:  15%|█▌        | 6/40 [00:01<00:05,  5.83it/s][4/6] extract embeddings:  22%|██▎       | 9/40 [00:01<00:03,  9.20it/s][4/6] extract embeddings:  30%|███       | 12/40 [00:01<00:02, 12.47it/s][4/6] extract embeddings:  38%|███▊      | 15/40 [00:01<00:01, 15.51it/s][4/6] extract embeddings:  45%|████▌     | 18/40 [00:01<00:01, 18.32it/s][4/6] extract embeddings:  52%|█████▎    | 21/40 [00:01<00:00, 20.87it/s][4/6] extract embeddings:  60%|██████    | 24/40 [00:02<00:00, 22.47it/s][4/6] extract embeddings:  68%|██████▊   | 27/40 [00:02<00:00, 23.62it/s][4/6] extract embeddings:  75%|███████▌  | 30/40 [00:02<00:00, 23.60it/s][4/6] extract embeddings:  82%|████████▎ | 33/40 [00:02<00:00, 23.64it/s][4/6] extract embeddings:  90%|█████████ | 36/40 [00:02<00:00, 23.88it/s][4/6] extract embeddings:  98%|█████████▊| 39/40 [00:02<00:00, 24.96it/s][4/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 14.50it/s]
[NeMo I 2025-04-17 02:09:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:09:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:47 collections:880] Dataset successfully loaded with 3314 items and total duration provided from manifest is  0.67 hours.
[NeMo I 2025-04-17 02:09:47 collections:886] # 3314 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/52 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/52 [00:01<00:59,  1.16s/it][5/6] extract embeddings:   8%|▊         | 4/52 [00:01<00:12,  3.94it/s][5/6] extract embeddings:  12%|█▏        | 6/52 [00:01<00:07,  5.94it/s][5/6] extract embeddings:  17%|█▋        | 9/52 [00:01<00:04,  9.17it/s][5/6] extract embeddings:  23%|██▎       | 12/52 [00:01<00:03, 12.21it/s][5/6] extract embeddings:  29%|██▉       | 15/52 [00:01<00:02, 15.37it/s][5/6] extract embeddings:  35%|███▍      | 18/52 [00:01<00:01, 18.30it/s][5/6] extract embeddings:  40%|████      | 21/52 [00:02<00:01, 19.98it/s][5/6] extract embeddings:  46%|████▌     | 24/52 [00:02<00:01, 22.36it/s][5/6] extract embeddings:  52%|█████▏    | 27/52 [00:02<00:01, 23.85it/s][5/6] extract embeddings:  58%|█████▊    | 30/52 [00:02<00:00, 25.42it/s][5/6] extract embeddings:  65%|██████▌   | 34/52 [00:02<00:00, 27.27it/s][5/6] extract embeddings:  73%|███████▎  | 38/52 [00:02<00:00, 27.76it/s][5/6] extract embeddings:  79%|███████▉  | 41/52 [00:02<00:00, 27.76it/s][5/6] extract embeddings:  85%|████████▍ | 44/52 [00:02<00:00, 27.21it/s][5/6] extract embeddings:  92%|█████████▏| 48/52 [00:02<00:00, 28.77it/s][5/6] extract embeddings: 100%|██████████| 52/52 [00:03<00:00, 29.12it/s][5/6] extract embeddings: 100%|██████████| 52/52 [00:03<00:00, 16.76it/s]
[NeMo I 2025-04-17 02:09:50 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:09:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:09:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:09:51 collections:880] Dataset successfully loaded with 6210 items and total duration provided from manifest is  0.77 hours.
[NeMo I 2025-04-17 02:09:51 collections:886] # 6210 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/98 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/98 [00:01<01:51,  1.15s/it][6/6] extract embeddings:   4%|▍         | 4/98 [00:01<00:24,  3.86it/s][6/6] extract embeddings:   7%|▋         | 7/98 [00:01<00:13,  6.85it/s][6/6] extract embeddings:   9%|▉         | 9/98 [00:01<00:10,  8.63it/s][6/6] extract embeddings:  12%|█▏        | 12/98 [00:01<00:07, 11.41it/s][6/6] extract embeddings:  15%|█▌        | 15/98 [00:01<00:05, 14.55it/s][6/6] extract embeddings:  19%|█▉        | 19/98 [00:01<00:04, 18.94it/s][6/6] extract embeddings:  23%|██▎       | 23/98 [00:02<00:03, 23.05it/s][6/6] extract embeddings:  28%|██▊       | 27/98 [00:02<00:02, 26.30it/s][6/6] extract embeddings:  32%|███▏      | 31/98 [00:02<00:02, 28.55it/s][6/6] extract embeddings:  36%|███▌      | 35/98 [00:02<00:02, 29.76it/s][6/6] extract embeddings:  40%|███▉      | 39/98 [00:02<00:01, 31.73it/s][6/6] extract embeddings:  44%|████▍     | 43/98 [00:02<00:01, 32.06it/s][6/6] extract embeddings:  48%|████▊     | 47/98 [00:02<00:01, 32.03it/s][6/6] extract embeddings:  52%|█████▏    | 51/98 [00:02<00:01, 32.20it/s][6/6] extract embeddings:  56%|█████▌    | 55/98 [00:03<00:01, 32.66it/s][6/6] extract embeddings:  60%|██████    | 59/98 [00:03<00:01, 33.40it/s][6/6] extract embeddings:  64%|██████▍   | 63/98 [00:03<00:01, 33.65it/s][6/6] extract embeddings:  68%|██████▊   | 67/98 [00:03<00:00, 33.50it/s][6/6] extract embeddings:  72%|███████▏  | 71/98 [00:03<00:00, 33.64it/s][6/6] extract embeddings:  77%|███████▋  | 75/98 [00:03<00:00, 33.15it/s][6/6] extract embeddings:  81%|████████  | 79/98 [00:03<00:00, 33.20it/s][6/6] extract embeddings:  85%|████████▍ | 83/98 [00:03<00:00, 32.59it/s][6/6] extract embeddings:  89%|████████▉ | 87/98 [00:03<00:00, 32.43it/s][6/6] extract embeddings:  93%|█████████▎| 91/98 [00:04<00:00, 33.29it/s][6/6] extract embeddings:  97%|█████████▋| 95/98 [00:04<00:00, 32.45it/s][6/6] extract embeddings: 100%|██████████| 98/98 [00:04<00:00, 22.61it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.00it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.40it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.72it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s]
[NeMo I 2025-04-17 02:09:57 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:09:58 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              66.324418   444.120  ...   7.819933  1.760770
    Harker-ES                       64.730144  2178.782  ...  29.796778  1.367589
    Harker-MN                       66.297688   366.767  ...  20.041991  5.464502
    Longfellow-Block-1              60.854935   492.417  ...   7.862016  1.596618
    TOTAL                           64.550583  3482.086  ...  65.520718  1.881651
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:09:58 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0277 | MISS: 0.5990 | CER: 0.0188 | DER: 0.6455 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.60
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.6 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.71s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.87s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:10:09 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:10:09 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:10:09 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:10:09 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:10:09 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:10:09 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:10:09 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:10:09 features:305] PADDING: 16
[NeMo I 2025-04-17 02:10:10 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:10:10 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:10:10 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:10:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:10:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:10 collections:880] Dataset successfully loaded with 1979 items and total duration provided from manifest is  0.50 hours.
[NeMo I 2025-04-17 02:10:10 collections:886] # 1979 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/31 [00:02<01:02,  2.08s/it][1/6] extract embeddings:  13%|█▎        | 4/31 [00:02<00:11,  2.35it/s][1/6] extract embeddings:  23%|██▎       | 7/31 [00:02<00:05,  4.54it/s][1/6] extract embeddings:  32%|███▏      | 10/31 [00:02<00:02,  7.03it/s][1/6] extract embeddings:  42%|████▏     | 13/31 [00:02<00:01,  9.62it/s][1/6] extract embeddings:  52%|█████▏    | 16/31 [00:02<00:01, 12.23it/s][1/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 14.79it/s][1/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 17.00it/s][1/6] extract embeddings:  81%|████████  | 25/31 [00:03<00:00, 18.76it/s][1/6] extract embeddings:  90%|█████████ | 28/31 [00:03<00:00, 19.70it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00, 20.72it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00,  9.24it/s]
[NeMo I 2025-04-17 02:10:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:10:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:13 collections:880] Dataset successfully loaded with 2055 items and total duration provided from manifest is  0.52 hours.
[NeMo I 2025-04-17 02:10:13 collections:886] # 2055 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:45,  1.42s/it][2/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:09,  3.21it/s][2/6] extract embeddings:  21%|██        | 7/33 [00:01<00:04,  5.95it/s][2/6] extract embeddings:  27%|██▋       | 9/33 [00:01<00:03,  7.64it/s][2/6] extract embeddings:  36%|███▋      | 12/33 [00:01<00:01, 10.65it/s][2/6] extract embeddings:  45%|████▌     | 15/33 [00:02<00:01, 13.63it/s][2/6] extract embeddings:  55%|█████▍    | 18/33 [00:02<00:00, 16.43it/s][2/6] extract embeddings:  64%|██████▎   | 21/33 [00:02<00:00, 18.05it/s][2/6] extract embeddings:  73%|███████▎  | 24/33 [00:02<00:00, 20.15it/s][2/6] extract embeddings:  82%|████████▏ | 27/33 [00:02<00:00, 20.52it/s][2/6] extract embeddings:  91%|█████████ | 30/33 [00:02<00:00, 21.94it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 22.35it/s][2/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 11.57it/s]
[NeMo I 2025-04-17 02:10:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:10:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:17 collections:880] Dataset successfully loaded with 2187 items and total duration provided from manifest is  0.54 hours.
[NeMo I 2025-04-17 02:10:17 collections:886] # 2187 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:39,  1.15s/it][3/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:07,  3.88it/s][3/6] extract embeddings:  20%|██        | 7/35 [00:01<00:03,  7.00it/s][3/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02, 10.27it/s][3/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 13.35it/s][3/6] extract embeddings:  46%|████▌     | 16/35 [00:01<00:01, 16.11it/s][3/6] extract embeddings:  54%|█████▍    | 19/35 [00:01<00:00, 18.35it/s][3/6] extract embeddings:  63%|██████▎   | 22/35 [00:02<00:00, 20.55it/s][3/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 22.00it/s][3/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 22.83it/s][3/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 23.71it/s][3/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 24.54it/s][3/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 13.85it/s]
[NeMo I 2025-04-17 02:10:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:10:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:20 collections:880] Dataset successfully loaded with 2482 items and total duration provided from manifest is  0.58 hours.
[NeMo I 2025-04-17 02:10:20 collections:886] # 2482 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/39 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/39 [00:01<00:47,  1.24s/it][4/6] extract embeddings:  10%|█         | 4/39 [00:01<00:09,  3.66it/s][4/6] extract embeddings:  18%|█▊        | 7/39 [00:01<00:04,  6.66it/s][4/6] extract embeddings:  26%|██▌       | 10/39 [00:01<00:02,  9.78it/s][4/6] extract embeddings:  33%|███▎      | 13/39 [00:01<00:02, 12.84it/s][4/6] extract embeddings:  41%|████      | 16/39 [00:01<00:01, 15.62it/s][4/6] extract embeddings:  49%|████▊     | 19/39 [00:01<00:01, 17.87it/s][4/6] extract embeddings:  59%|█████▉    | 23/39 [00:02<00:00, 20.65it/s][4/6] extract embeddings:  67%|██████▋   | 26/39 [00:02<00:00, 22.46it/s][4/6] extract embeddings:  74%|███████▍  | 29/39 [00:02<00:00, 23.68it/s][4/6] extract embeddings:  82%|████████▏ | 32/39 [00:02<00:00, 23.35it/s][4/6] extract embeddings:  90%|████████▉ | 35/39 [00:02<00:00, 23.57it/s][4/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 25.45it/s][4/6] extract embeddings: 100%|██████████| 39/39 [00:02<00:00, 14.06it/s]
[NeMo I 2025-04-17 02:10:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:10:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:23 collections:880] Dataset successfully loaded with 3235 items and total duration provided from manifest is  0.64 hours.
[NeMo I 2025-04-17 02:10:23 collections:886] # 3235 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/51 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/51 [00:01<00:57,  1.14s/it][5/6] extract embeddings:   8%|▊         | 4/51 [00:01<00:12,  3.89it/s][5/6] extract embeddings:  12%|█▏        | 6/51 [00:01<00:07,  5.98it/s][5/6] extract embeddings:  18%|█▊        | 9/51 [00:01<00:04,  9.26it/s][5/6] extract embeddings:  24%|██▎       | 12/51 [00:01<00:03, 12.65it/s][5/6] extract embeddings:  29%|██▉       | 15/51 [00:01<00:02, 15.70it/s][5/6] extract embeddings:  35%|███▌      | 18/51 [00:01<00:01, 18.16it/s][5/6] extract embeddings:  41%|████      | 21/51 [00:01<00:01, 20.45it/s][5/6] extract embeddings:  49%|████▉     | 25/51 [00:02<00:01, 23.14it/s][5/6] extract embeddings:  57%|█████▋    | 29/51 [00:02<00:00, 24.68it/s][5/6] extract embeddings:  65%|██████▍   | 33/51 [00:02<00:00, 26.79it/s][5/6] extract embeddings:  71%|███████   | 36/51 [00:02<00:00, 27.05it/s][5/6] extract embeddings:  76%|███████▋  | 39/51 [00:02<00:00, 26.61it/s][5/6] extract embeddings:  84%|████████▍ | 43/51 [00:02<00:00, 27.79it/s][5/6] extract embeddings:  90%|█████████ | 46/51 [00:02<00:00, 28.07it/s][5/6] extract embeddings:  96%|█████████▌| 49/51 [00:02<00:00, 27.61it/s][5/6] extract embeddings: 100%|██████████| 51/51 [00:03<00:00, 16.77it/s]
[NeMo I 2025-04-17 02:10:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:10:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:26 collections:880] Dataset successfully loaded with 6023 items and total duration provided from manifest is  0.74 hours.
[NeMo I 2025-04-17 02:10:26 collections:886] # 6023 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/95 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/95 [00:01<01:53,  1.20s/it][6/6] extract embeddings:   5%|▌         | 5/95 [00:01<00:18,  4.97it/s][6/6] extract embeddings:   9%|▉         | 9/95 [00:01<00:09,  9.24it/s][6/6] extract embeddings:  14%|█▎        | 13/95 [00:01<00:05, 13.75it/s][6/6] extract embeddings:  18%|█▊        | 17/95 [00:01<00:04, 17.75it/s][6/6] extract embeddings:  22%|██▏       | 21/95 [00:01<00:03, 21.33it/s][6/6] extract embeddings:  26%|██▋       | 25/95 [00:01<00:02, 24.66it/s][6/6] extract embeddings:  31%|███       | 29/95 [00:02<00:02, 26.72it/s][6/6] extract embeddings:  35%|███▍      | 33/95 [00:02<00:02, 27.08it/s][6/6] extract embeddings:  39%|███▉      | 37/95 [00:02<00:02, 27.58it/s][6/6] extract embeddings:  43%|████▎     | 41/95 [00:02<00:01, 28.78it/s][6/6] extract embeddings:  47%|████▋     | 45/95 [00:02<00:01, 29.23it/s][6/6] extract embeddings:  52%|█████▏    | 49/95 [00:02<00:01, 31.06it/s][6/6] extract embeddings:  56%|█████▌    | 53/95 [00:02<00:01, 31.04it/s][6/6] extract embeddings:  60%|██████    | 57/95 [00:02<00:01, 31.57it/s][6/6] extract embeddings:  64%|██████▍   | 61/95 [00:03<00:01, 31.85it/s][6/6] extract embeddings:  68%|██████▊   | 65/95 [00:03<00:00, 32.29it/s][6/6] extract embeddings:  73%|███████▎  | 69/95 [00:03<00:00, 32.68it/s][6/6] extract embeddings:  77%|███████▋  | 73/95 [00:03<00:00, 32.47it/s][6/6] extract embeddings:  81%|████████  | 77/95 [00:03<00:00, 32.54it/s][6/6] extract embeddings:  85%|████████▌ | 81/95 [00:03<00:00, 32.80it/s][6/6] extract embeddings:  89%|████████▉ | 85/95 [00:03<00:00, 33.61it/s][6/6] extract embeddings:  94%|█████████▎| 89/95 [00:03<00:00, 34.17it/s][6/6] extract embeddings:  98%|█████████▊| 93/95 [00:03<00:00, 34.14it/s][6/6] extract embeddings: 100%|██████████| 95/95 [00:04<00:00, 23.28it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.92it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.41it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.72it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s]
[NeMo I 2025-04-17 02:10:32 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:10:33 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              67.965871   444.120  ...   9.740005  2.193102
    Harker-ES                       65.881113  2178.782  ...  31.360945  1.439380
    Harker-MN                       68.012900   366.767  ...  20.144000  5.492315
    Longfellow-Block-1              61.776299   492.417  ...   8.828978  1.792988
    TOTAL                           65.791072  3482.086  ...  70.073927  2.012412
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:10:33 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0272 | MISS: 0.6106 | CER: 0.0201 | DER: 0.6579 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.60
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.6 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:10:45 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:10:45 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:10:45 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:10:45 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:10:45 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:10:45 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:10:45 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:10:45 features:305] PADDING: 16
[NeMo I 2025-04-17 02:10:45 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:10:45 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:10:45 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:10:45 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:10:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:46 collections:880] Dataset successfully loaded with 1972 items and total duration provided from manifest is  0.47 hours.
[NeMo I 2025-04-17 02:10:46 collections:886] # 1972 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/31 [00:02<01:01,  2.04s/it][1/6] extract embeddings:  13%|█▎        | 4/31 [00:02<00:11,  2.39it/s][1/6] extract embeddings:  23%|██▎       | 7/31 [00:02<00:05,  4.64it/s][1/6] extract embeddings:  32%|███▏      | 10/31 [00:02<00:02,  7.18it/s][1/6] extract embeddings:  42%|████▏     | 13/31 [00:02<00:01,  9.72it/s][1/6] extract embeddings:  52%|█████▏    | 16/31 [00:02<00:01, 12.22it/s][1/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 14.87it/s][1/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 16.67it/s][1/6] extract embeddings:  81%|████████  | 25/31 [00:03<00:00, 17.96it/s][1/6] extract embeddings:  90%|█████████ | 28/31 [00:03<00:00, 19.53it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00, 20.91it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00,  9.32it/s]
[NeMo I 2025-04-17 02:10:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:10:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:49 collections:880] Dataset successfully loaded with 2034 items and total duration provided from manifest is  0.49 hours.
[NeMo I 2025-04-17 02:10:49 collections:886] # 2034 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:43,  1.40s/it][2/6] extract embeddings:  12%|█▎        | 4/32 [00:01<00:08,  3.38it/s][2/6] extract embeddings:  22%|██▏       | 7/32 [00:01<00:04,  6.22it/s][2/6] extract embeddings:  31%|███▏      | 10/32 [00:01<00:02,  9.33it/s][2/6] extract embeddings:  41%|████      | 13/32 [00:01<00:01, 11.87it/s][2/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 14.56it/s][2/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 16.75it/s][2/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 19.07it/s][2/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 20.09it/s][2/6] extract embeddings:  88%|████████▊ | 28/32 [00:02<00:00, 20.11it/s][2/6] extract embeddings:  97%|█████████▋| 31/32 [00:02<00:00, 21.28it/s][2/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 11.70it/s]
[NeMo I 2025-04-17 02:10:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:10:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:52 collections:880] Dataset successfully loaded with 2154 items and total duration provided from manifest is  0.51 hours.
[NeMo I 2025-04-17 02:10:52 collections:886] # 2154 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:37,  1.13s/it][3/6] extract embeddings:  12%|█▏        | 4/34 [00:01<00:07,  3.96it/s][3/6] extract embeddings:  21%|██        | 7/34 [00:01<00:03,  7.07it/s][3/6] extract embeddings:  29%|██▉       | 10/34 [00:01<00:02, 10.27it/s][3/6] extract embeddings:  38%|███▊      | 13/34 [00:01<00:01, 13.34it/s][3/6] extract embeddings:  47%|████▋     | 16/34 [00:01<00:01, 16.34it/s][3/6] extract embeddings:  56%|█████▌    | 19/34 [00:01<00:00, 18.71it/s][3/6] extract embeddings:  65%|██████▍   | 22/34 [00:02<00:00, 19.71it/s][3/6] extract embeddings:  74%|███████▎  | 25/34 [00:02<00:00, 21.10it/s][3/6] extract embeddings:  82%|████████▏ | 28/34 [00:02<00:00, 22.92it/s][3/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 23.47it/s][3/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 24.65it/s][3/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 13.64it/s]
[NeMo I 2025-04-17 02:10:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:10:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:55 collections:880] Dataset successfully loaded with 2431 items and total duration provided from manifest is  0.55 hours.
[NeMo I 2025-04-17 02:10:55 collections:886] # 2431 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:42,  1.15s/it][4/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  4.04it/s][4/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  7.44it/s][4/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02, 10.77it/s][4/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 13.77it/s][4/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 16.84it/s][4/6] extract embeddings:  50%|█████     | 19/38 [00:01<00:00, 19.71it/s][4/6] extract embeddings:  58%|█████▊    | 22/38 [00:01<00:00, 21.82it/s][4/6] extract embeddings:  66%|██████▌   | 25/38 [00:02<00:00, 23.47it/s][4/6] extract embeddings:  74%|███████▎  | 28/38 [00:02<00:00, 24.62it/s][4/6] extract embeddings:  82%|████████▏ | 31/38 [00:02<00:00, 25.12it/s][4/6] extract embeddings:  89%|████████▉ | 34/38 [00:02<00:00, 25.15it/s][4/6] extract embeddings:  97%|█████████▋| 37/38 [00:02<00:00, 26.34it/s][4/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 14.92it/s]
[NeMo I 2025-04-17 02:10:57 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:10:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:10:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:10:57 collections:880] Dataset successfully loaded with 3119 items and total duration provided from manifest is  0.61 hours.
[NeMo I 2025-04-17 02:10:57 collections:886] # 3119 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/49 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/49 [00:01<00:53,  1.12s/it][5/6] extract embeddings:   8%|▊         | 4/49 [00:01<00:10,  4.16it/s][5/6] extract embeddings:  14%|█▍        | 7/49 [00:01<00:05,  7.62it/s][5/6] extract embeddings:  20%|██        | 10/49 [00:01<00:03, 11.11it/s][5/6] extract embeddings:  27%|██▋       | 13/49 [00:01<00:02, 14.45it/s][5/6] extract embeddings:  33%|███▎      | 16/49 [00:01<00:01, 16.77it/s][5/6] extract embeddings:  39%|███▉      | 19/49 [00:01<00:01, 19.52it/s][5/6] extract embeddings:  45%|████▍     | 22/49 [00:01<00:01, 21.63it/s][5/6] extract embeddings:  51%|█████     | 25/49 [00:02<00:01, 22.98it/s][5/6] extract embeddings:  59%|█████▉    | 29/49 [00:02<00:00, 24.71it/s][5/6] extract embeddings:  67%|██████▋   | 33/49 [00:02<00:00, 26.12it/s][5/6] extract embeddings:  73%|███████▎  | 36/49 [00:02<00:00, 25.51it/s][5/6] extract embeddings:  80%|███████▉  | 39/49 [00:02<00:00, 26.57it/s][5/6] extract embeddings:  86%|████████▌ | 42/49 [00:02<00:00, 27.33it/s][5/6] extract embeddings:  92%|█████████▏| 45/49 [00:02<00:00, 27.79it/s][5/6] extract embeddings:  98%|█████████▊| 48/49 [00:02<00:00, 27.38it/s][5/6] extract embeddings: 100%|██████████| 49/49 [00:02<00:00, 16.97it/s]
[NeMo I 2025-04-17 02:11:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:11:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:00 collections:880] Dataset successfully loaded with 5743 items and total duration provided from manifest is  0.70 hours.
[NeMo I 2025-04-17 02:11:00 collections:886] # 5743 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/90 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/90 [00:01<01:40,  1.13s/it][6/6] extract embeddings:   4%|▍         | 4/90 [00:01<00:21,  4.03it/s][6/6] extract embeddings:   7%|▋         | 6/90 [00:01<00:13,  6.13it/s][6/6] extract embeddings:   9%|▉         | 8/90 [00:01<00:09,  8.33it/s][6/6] extract embeddings:  12%|█▏        | 11/90 [00:01<00:06, 11.72it/s][6/6] extract embeddings:  16%|█▌        | 14/90 [00:01<00:05, 14.61it/s][6/6] extract embeddings:  20%|██        | 18/90 [00:01<00:03, 18.93it/s][6/6] extract embeddings:  24%|██▍       | 22/90 [00:01<00:03, 22.14it/s][6/6] extract embeddings:  29%|██▉       | 26/90 [00:02<00:02, 25.44it/s][6/6] extract embeddings:  32%|███▏      | 29/90 [00:02<00:02, 26.04it/s][6/6] extract embeddings:  36%|███▌      | 32/90 [00:02<00:02, 26.49it/s][6/6] extract embeddings:  39%|███▉      | 35/90 [00:02<00:02, 26.96it/s][6/6] extract embeddings:  43%|████▎     | 39/90 [00:02<00:01, 29.44it/s][6/6] extract embeddings:  48%|████▊     | 43/90 [00:02<00:01, 30.89it/s][6/6] extract embeddings:  52%|█████▏    | 47/90 [00:02<00:01, 31.32it/s][6/6] extract embeddings:  57%|█████▋    | 51/90 [00:02<00:01, 32.96it/s][6/6] extract embeddings:  61%|██████    | 55/90 [00:03<00:01, 32.25it/s][6/6] extract embeddings:  66%|██████▌   | 59/90 [00:03<00:00, 33.16it/s][6/6] extract embeddings:  70%|███████   | 63/90 [00:03<00:00, 33.40it/s][6/6] extract embeddings:  74%|███████▍  | 67/90 [00:03<00:00, 33.93it/s][6/6] extract embeddings:  79%|███████▉  | 71/90 [00:03<00:00, 33.96it/s][6/6] extract embeddings:  83%|████████▎ | 75/90 [00:03<00:00, 33.42it/s][6/6] extract embeddings:  88%|████████▊ | 79/90 [00:03<00:00, 32.93it/s][6/6] extract embeddings:  92%|█████████▏| 83/90 [00:03<00:00, 31.99it/s][6/6] extract embeddings:  97%|█████████▋| 87/90 [00:03<00:00, 32.49it/s][6/6] extract embeddings: 100%|██████████| 90/90 [00:04<00:00, 21.96it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.02it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.52it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.63it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.79it/s]
[NeMo I 2025-04-17 02:11:06 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:11:07 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              69.026352   444.120  ...   8.799943  1.981434
    Harker-ES                       67.326405  2178.782  ...  26.730733  1.226866
    Harker-MN                       69.165944   366.767  ...  19.574967  5.337167
    Longfellow-Block-1              62.872547   492.417  ...   8.375998  1.700997
    TOTAL                           67.107142  3482.086  ...  63.481641  1.823092
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:11:07 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0255 | MISS: 0.6274 | CER: 0.0182 | DER: 0.6711 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.60
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.6 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:11:19 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:11:19 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:11:19 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:11:19 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:11:19 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:11:19 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:11:19 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:11:19 features:305] PADDING: 16
[NeMo I 2025-04-17 02:11:19 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:11:19 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:11:19 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:11:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:11:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:19 collections:880] Dataset successfully loaded with 1954 items and total duration provided from manifest is  0.44 hours.
[NeMo I 2025-04-17 02:11:19 collections:886] # 1954 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/31 [00:02<01:01,  2.03s/it][1/6] extract embeddings:  13%|█▎        | 4/31 [00:02<00:11,  2.40it/s][1/6] extract embeddings:  23%|██▎       | 7/31 [00:02<00:05,  4.61it/s][1/6] extract embeddings:  32%|███▏      | 10/31 [00:02<00:02,  7.14it/s][1/6] extract embeddings:  42%|████▏     | 13/31 [00:02<00:01,  9.88it/s][1/6] extract embeddings:  52%|█████▏    | 16/31 [00:02<00:01, 12.62it/s][1/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 15.10it/s][1/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 17.57it/s][1/6] extract embeddings:  81%|████████  | 25/31 [00:02<00:00, 19.34it/s][1/6] extract embeddings:  90%|█████████ | 28/31 [00:03<00:00, 21.00it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00, 22.64it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00,  9.55it/s]
[NeMo I 2025-04-17 02:11:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:11:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:23 collections:880] Dataset successfully loaded with 2005 items and total duration provided from manifest is  0.45 hours.
[NeMo I 2025-04-17 02:11:23 collections:886] # 2005 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:42,  1.39s/it][2/6] extract embeddings:  12%|█▎        | 4/32 [00:01<00:08,  3.29it/s][2/6] extract embeddings:  22%|██▏       | 7/32 [00:01<00:04,  6.12it/s][2/6] extract embeddings:  31%|███▏      | 10/32 [00:01<00:02,  8.79it/s][2/6] extract embeddings:  41%|████      | 13/32 [00:01<00:01, 11.58it/s][2/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 14.45it/s][2/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 16.90it/s][2/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 19.08it/s][2/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 20.90it/s][2/6] extract embeddings:  88%|████████▊ | 28/32 [00:02<00:00, 21.39it/s][2/6] extract embeddings:  97%|█████████▋| 31/32 [00:02<00:00, 21.65it/s][2/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 11.68it/s]
[NeMo I 2025-04-17 02:11:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:11:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:26 collections:880] Dataset successfully loaded with 2102 items and total duration provided from manifest is  0.47 hours.
[NeMo I 2025-04-17 02:11:26 collections:886] # 2102 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:36,  1.13s/it][3/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:07,  4.08it/s][3/6] extract embeddings:  21%|██        | 7/33 [00:01<00:03,  7.43it/s][3/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02, 10.87it/s][3/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 13.44it/s][3/6] extract embeddings:  48%|████▊     | 16/33 [00:01<00:01, 16.12it/s][3/6] extract embeddings:  58%|█████▊    | 19/33 [00:01<00:00, 18.05it/s][3/6] extract embeddings:  70%|██████▉   | 23/33 [00:01<00:00, 21.33it/s][3/6] extract embeddings:  79%|███████▉  | 26/33 [00:02<00:00, 22.29it/s][3/6] extract embeddings:  88%|████████▊ | 29/33 [00:02<00:00, 22.71it/s][3/6] extract embeddings:  97%|█████████▋| 32/33 [00:02<00:00, 23.73it/s][3/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 13.66it/s]
[NeMo I 2025-04-17 02:11:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:11:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:28 collections:880] Dataset successfully loaded with 2350 items and total duration provided from manifest is  0.51 hours.
[NeMo I 2025-04-17 02:11:28 collections:886] # 2350 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:41,  1.15s/it][4/6] extract embeddings:  11%|█         | 4/37 [00:01<00:08,  3.95it/s][4/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  7.13it/s][4/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02, 10.13it/s][4/6] extract embeddings:  35%|███▌      | 13/37 [00:01<00:01, 13.31it/s][4/6] extract embeddings:  43%|████▎     | 16/37 [00:01<00:01, 16.26it/s][4/6] extract embeddings:  54%|█████▍    | 20/37 [00:01<00:00, 19.77it/s][4/6] extract embeddings:  62%|██████▏   | 23/37 [00:02<00:00, 21.27it/s][4/6] extract embeddings:  73%|███████▎  | 27/37 [00:02<00:00, 23.43it/s][4/6] extract embeddings:  81%|████████  | 30/37 [00:02<00:00, 24.47it/s][4/6] extract embeddings:  89%|████████▉ | 33/37 [00:02<00:00, 25.29it/s][4/6] extract embeddings:  97%|█████████▋| 36/37 [00:02<00:00, 25.34it/s][4/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 14.48it/s]
[NeMo I 2025-04-17 02:11:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:11:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:31 collections:880] Dataset successfully loaded with 2970 items and total duration provided from manifest is  0.56 hours.
[NeMo I 2025-04-17 02:11:31 collections:886] # 2970 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:52,  1.13s/it][5/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:11,  3.90it/s][5/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:05,  7.03it/s][5/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:03, 10.34it/s][5/6] extract embeddings:  28%|██▊       | 13/47 [00:01<00:02, 13.34it/s][5/6] extract embeddings:  36%|███▌      | 17/47 [00:01<00:01, 17.68it/s][5/6] extract embeddings:  43%|████▎     | 20/47 [00:01<00:01, 19.82it/s][5/6] extract embeddings:  49%|████▉     | 23/47 [00:01<00:01, 21.86it/s][5/6] extract embeddings:  57%|█████▋    | 27/47 [00:02<00:00, 24.25it/s][5/6] extract embeddings:  66%|██████▌   | 31/47 [00:02<00:00, 26.64it/s][5/6] extract embeddings:  72%|███████▏  | 34/47 [00:02<00:00, 27.46it/s][5/6] extract embeddings:  79%|███████▊  | 37/47 [00:02<00:00, 27.34it/s][5/6] extract embeddings:  85%|████████▌ | 40/47 [00:02<00:00, 27.60it/s][5/6] extract embeddings:  91%|█████████▏| 43/47 [00:02<00:00, 27.75it/s][5/6] extract embeddings:  98%|█████████▊| 46/47 [00:02<00:00, 28.33it/s][5/6] extract embeddings: 100%|██████████| 47/47 [00:02<00:00, 16.63it/s]
[NeMo I 2025-04-17 02:11:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:11:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:34 collections:880] Dataset successfully loaded with 5403 items and total duration provided from manifest is  0.65 hours.
[NeMo I 2025-04-17 02:11:34 collections:886] # 5403 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/85 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/85 [00:01<01:35,  1.13s/it][6/6] extract embeddings:   6%|▌         | 5/85 [00:01<00:15,  5.18it/s][6/6] extract embeddings:  11%|█         | 9/85 [00:01<00:07,  9.65it/s][6/6] extract embeddings:  15%|█▌        | 13/85 [00:01<00:05, 13.45it/s][6/6] extract embeddings:  20%|██        | 17/85 [00:01<00:03, 17.77it/s][6/6] extract embeddings:  25%|██▍       | 21/85 [00:01<00:02, 21.38it/s][6/6] extract embeddings:  29%|██▉       | 25/85 [00:01<00:02, 24.12it/s][6/6] extract embeddings:  34%|███▍      | 29/85 [00:01<00:02, 26.73it/s][6/6] extract embeddings:  39%|███▉      | 33/85 [00:02<00:01, 29.04it/s][6/6] extract embeddings:  44%|████▎     | 37/85 [00:02<00:01, 30.36it/s][6/6] extract embeddings:  48%|████▊     | 41/85 [00:02<00:01, 31.11it/s][6/6] extract embeddings:  53%|█████▎    | 45/85 [00:02<00:01, 31.30it/s][6/6] extract embeddings:  58%|█████▊    | 49/85 [00:02<00:01, 31.74it/s][6/6] extract embeddings:  62%|██████▏   | 53/85 [00:02<00:01, 31.70it/s][6/6] extract embeddings:  67%|██████▋   | 57/85 [00:02<00:00, 33.27it/s][6/6] extract embeddings:  72%|███████▏  | 61/85 [00:02<00:00, 33.81it/s][6/6] extract embeddings:  76%|███████▋  | 65/85 [00:03<00:00, 34.26it/s][6/6] extract embeddings:  81%|████████  | 69/85 [00:03<00:00, 34.33it/s][6/6] extract embeddings:  86%|████████▌ | 73/85 [00:03<00:00, 33.40it/s][6/6] extract embeddings:  91%|█████████ | 77/85 [00:03<00:00, 34.02it/s][6/6] extract embeddings:  95%|█████████▌| 81/85 [00:03<00:00, 33.94it/s][6/6] extract embeddings: 100%|██████████| 85/85 [00:03<00:00, 34.33it/s][6/6] extract embeddings: 100%|██████████| 85/85 [00:03<00:00, 23.20it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.07it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.52it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.92it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.34it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.00it/s]
[NeMo I 2025-04-17 02:11:39 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:11:40 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              71.041583   444.120  ...   9.039992  2.035484
    Harker-ES                       69.262185  2178.782  ...  26.627216  1.222115
    Harker-MN                       70.335693   366.767  ...  17.991026  4.905301
    Longfellow-Block-1              64.775618   492.417  ...   8.304018  1.686379
    TOTAL                           68.967744  3482.086  ...  61.962253  1.779458
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:11:40 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0238 | MISS: 0.6481 | CER: 0.0178 | DER: 0.6897 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.60
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.6 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.71s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:11:52 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:11:52 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:11:52 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:11:52 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:11:52 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:11:52 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:11:52 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:11:52 features:305] PADDING: 16
[NeMo I 2025-04-17 02:11:53 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:11:53 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:11:53 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:11:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:11:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:53 collections:880] Dataset successfully loaded with 1904 items and total duration provided from manifest is  0.39 hours.
[NeMo I 2025-04-17 02:11:53 collections:886] # 1904 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/30 [00:02<00:58,  2.02s/it][1/6] extract embeddings:  13%|█▎        | 4/30 [00:02<00:10,  2.41it/s][1/6] extract embeddings:  23%|██▎       | 7/30 [00:02<00:04,  4.66it/s][1/6] extract embeddings:  33%|███▎      | 10/30 [00:02<00:02,  7.20it/s][1/6] extract embeddings:  43%|████▎     | 13/30 [00:02<00:01,  9.84it/s][1/6] extract embeddings:  53%|█████▎    | 16/30 [00:02<00:01, 12.58it/s][1/6] extract embeddings:  63%|██████▎   | 19/30 [00:02<00:00, 15.38it/s][1/6] extract embeddings:  73%|███████▎  | 22/30 [00:02<00:00, 17.63it/s][1/6] extract embeddings:  83%|████████▎ | 25/30 [00:02<00:00, 19.65it/s][1/6] extract embeddings:  93%|█████████▎| 28/30 [00:03<00:00, 20.96it/s][1/6] extract embeddings: 100%|██████████| 30/30 [00:03<00:00,  9.42it/s]
[NeMo I 2025-04-17 02:11:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:11:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:56 collections:880] Dataset successfully loaded with 1937 items and total duration provided from manifest is  0.40 hours.
[NeMo I 2025-04-17 02:11:56 collections:886] # 1937 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:41,  1.38s/it][2/6] extract embeddings:  13%|█▎        | 4/31 [00:01<00:07,  3.42it/s][2/6] extract embeddings:  23%|██▎       | 7/31 [00:01<00:03,  6.42it/s][2/6] extract embeddings:  32%|███▏      | 10/31 [00:01<00:02,  9.24it/s][2/6] extract embeddings:  42%|████▏     | 13/31 [00:01<00:01, 12.27it/s][2/6] extract embeddings:  52%|█████▏    | 16/31 [00:01<00:01, 14.84it/s][2/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 17.24it/s][2/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 18.82it/s][2/6] extract embeddings:  81%|████████  | 25/31 [00:02<00:00, 20.56it/s][2/6] extract embeddings:  90%|█████████ | 28/31 [00:02<00:00, 21.19it/s][2/6] extract embeddings: 100%|██████████| 31/31 [00:02<00:00, 11.88it/s]
[NeMo I 2025-04-17 02:11:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:11:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:11:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:11:59 collections:880] Dataset successfully loaded with 2019 items and total duration provided from manifest is  0.42 hours.
[NeMo I 2025-04-17 02:11:59 collections:886] # 2019 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:35,  1.13s/it][3/6] extract embeddings:  12%|█▎        | 4/32 [00:01<00:06,  4.05it/s][3/6] extract embeddings:  22%|██▏       | 7/32 [00:01<00:03,  7.53it/s][3/6] extract embeddings:  31%|███▏      | 10/32 [00:01<00:02, 10.91it/s][3/6] extract embeddings:  41%|████      | 13/32 [00:01<00:01, 14.01it/s][3/6] extract embeddings:  50%|█████     | 16/32 [00:01<00:00, 16.67it/s][3/6] extract embeddings:  59%|█████▉    | 19/32 [00:01<00:00, 18.64it/s][3/6] extract embeddings:  72%|███████▏  | 23/32 [00:01<00:00, 21.74it/s][3/6] extract embeddings:  81%|████████▏ | 26/32 [00:02<00:00, 22.83it/s][3/6] extract embeddings:  91%|█████████ | 29/32 [00:02<00:00, 23.49it/s][3/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 25.04it/s][3/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 13.73it/s]
[NeMo I 2025-04-17 02:12:01 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:12:01 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:01 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:01 collections:880] Dataset successfully loaded with 2223 items and total duration provided from manifest is  0.45 hours.
[NeMo I 2025-04-17 02:12:01 collections:886] # 2223 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:38,  1.14s/it][4/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:07,  3.91it/s][4/6] extract embeddings:  17%|█▋        | 6/35 [00:01<00:04,  5.97it/s][4/6] extract embeddings:  26%|██▌       | 9/35 [00:01<00:02,  9.72it/s][4/6] extract embeddings:  34%|███▍      | 12/35 [00:01<00:01, 12.99it/s][4/6] extract embeddings:  43%|████▎     | 15/35 [00:01<00:01, 16.07it/s][4/6] extract embeddings:  54%|█████▍    | 19/35 [00:01<00:00, 19.68it/s][4/6] extract embeddings:  63%|██████▎   | 22/35 [00:01<00:00, 21.28it/s][4/6] extract embeddings:  71%|███████▏  | 25/35 [00:02<00:00, 23.28it/s][4/6] extract embeddings:  80%|████████  | 28/35 [00:02<00:00, 24.55it/s][4/6] extract embeddings:  89%|████████▊ | 31/35 [00:02<00:00, 25.32it/s][4/6] extract embeddings:  97%|█████████▋| 34/35 [00:02<00:00, 26.40it/s][4/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 14.16it/s]
[NeMo I 2025-04-17 02:12:04 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:12:04 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:04 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:04 collections:880] Dataset successfully loaded with 2743 items and total duration provided from manifest is  0.50 hours.
[NeMo I 2025-04-17 02:12:04 collections:886] # 2743 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:47,  1.14s/it][5/6] extract embeddings:   9%|▉         | 4/43 [00:01<00:09,  3.98it/s][5/6] extract embeddings:  16%|█▋        | 7/43 [00:01<00:04,  7.22it/s][5/6] extract embeddings:  23%|██▎       | 10/43 [00:01<00:03, 10.60it/s][5/6] extract embeddings:  33%|███▎      | 14/43 [00:01<00:01, 15.17it/s][5/6] extract embeddings:  42%|████▏     | 18/43 [00:01<00:01, 18.33it/s][5/6] extract embeddings:  51%|█████     | 22/43 [00:01<00:00, 21.02it/s][5/6] extract embeddings:  58%|█████▊    | 25/43 [00:02<00:00, 21.89it/s][5/6] extract embeddings:  67%|██████▋   | 29/43 [00:02<00:00, 24.36it/s][5/6] extract embeddings:  74%|███████▍  | 32/43 [00:02<00:00, 25.38it/s][5/6] extract embeddings:  84%|████████▎ | 36/43 [00:02<00:00, 27.42it/s][5/6] extract embeddings:  93%|█████████▎| 40/43 [00:02<00:00, 28.45it/s][5/6] extract embeddings: 100%|██████████| 43/43 [00:02<00:00, 16.16it/s]
[NeMo I 2025-04-17 02:12:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:12:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:07 collections:880] Dataset successfully loaded with 4885 items and total duration provided from manifest is  0.58 hours.
[NeMo I 2025-04-17 02:12:07 collections:886] # 4885 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/77 [00:00<?, ?it/s][6/6] extract embeddings:   1%|▏         | 1/77 [00:01<01:26,  1.14s/it][6/6] extract embeddings:   5%|▌         | 4/77 [00:01<00:18,  3.97it/s][6/6] extract embeddings:   9%|▉         | 7/77 [00:01<00:09,  7.02it/s][6/6] extract embeddings:  12%|█▏        | 9/77 [00:01<00:07,  8.99it/s][6/6] extract embeddings:  16%|█▌        | 12/77 [00:01<00:05, 12.69it/s][6/6] extract embeddings:  21%|██        | 16/77 [00:01<00:03, 17.34it/s][6/6] extract embeddings:  26%|██▌       | 20/77 [00:01<00:02, 21.25it/s][6/6] extract embeddings:  31%|███       | 24/77 [00:01<00:02, 24.81it/s][6/6] extract embeddings:  36%|███▋      | 28/77 [00:02<00:01, 26.64it/s][6/6] extract embeddings:  42%|████▏     | 32/77 [00:02<00:01, 28.89it/s][6/6] extract embeddings:  47%|████▋     | 36/77 [00:02<00:01, 30.76it/s][6/6] extract embeddings:  52%|█████▏    | 40/77 [00:02<00:01, 31.82it/s][6/6] extract embeddings:  57%|█████▋    | 44/77 [00:02<00:01, 32.93it/s][6/6] extract embeddings:  62%|██████▏   | 48/77 [00:02<00:00, 33.29it/s][6/6] extract embeddings:  68%|██████▊   | 52/77 [00:02<00:00, 34.13it/s][6/6] extract embeddings:  73%|███████▎  | 56/77 [00:02<00:00, 34.20it/s][6/6] extract embeddings:  78%|███████▊  | 60/77 [00:03<00:00, 34.11it/s][6/6] extract embeddings:  83%|████████▎ | 64/77 [00:03<00:00, 34.24it/s][6/6] extract embeddings:  88%|████████▊ | 68/77 [00:03<00:00, 34.90it/s][6/6] extract embeddings:  94%|█████████▎| 72/77 [00:03<00:00, 35.07it/s][6/6] extract embeddings:  99%|█████████▊| 76/77 [00:03<00:00, 34.24it/s][6/6] extract embeddings: 100%|██████████| 77/77 [00:03<00:00, 21.66it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.23it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.79it/s]clustering:  75%|███████▌  | 3/4 [00:00<00:00,  3.23it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.71it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.32it/s]
[NeMo I 2025-04-17 02:12:12 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:12:13 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              73.308946   444.120  ...   7.979949  1.796800
    Harker-ES                       72.622698  2178.782  ...  24.779454  1.137308
    Harker-MN                       72.523428   366.767  ...  17.833002  4.862215
    Longfellow-Block-1              67.879740   492.417  ...   8.636029  1.753804
    TOTAL                           72.029046  3482.086  ...  59.228434  1.700947
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:12:13 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0218 | MISS: 0.6815 | CER: 0.0170 | DER: 0.7203 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.70, offset=0.65
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.7, <class 'float'> offset=0.65 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]VAD segmentation complete.
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:12:24 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:12:24 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:12:24 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:12:24 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:12:24 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:12:24 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:12:24 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:12:24 features:305] PADDING: 16
[NeMo I 2025-04-17 02:12:25 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:12:25 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:12:25 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:12:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:12:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:25 collections:880] Dataset successfully loaded with 1959 items and total duration provided from manifest is  0.45 hours.
[NeMo I 2025-04-17 02:12:25 collections:886] # 1959 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:59,  1.98s/it][1/6] extract embeddings:  13%|█▎        | 4/31 [00:02<00:10,  2.47it/s][1/6] extract embeddings:  23%|██▎       | 7/31 [00:02<00:05,  4.78it/s][1/6] extract embeddings:  32%|███▏      | 10/31 [00:02<00:02,  7.37it/s][1/6] extract embeddings:  42%|████▏     | 13/31 [00:02<00:01,  9.96it/s][1/6] extract embeddings:  52%|█████▏    | 16/31 [00:02<00:01, 12.61it/s][1/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 15.23it/s][1/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 17.29it/s][1/6] extract embeddings:  81%|████████  | 25/31 [00:02<00:00, 19.03it/s][1/6] extract embeddings:  90%|█████████ | 28/31 [00:03<00:00, 20.70it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00,  9.69it/s]
[NeMo I 2025-04-17 02:12:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:12:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:28 collections:880] Dataset successfully loaded with 2026 items and total duration provided from manifest is  0.47 hours.
[NeMo I 2025-04-17 02:12:28 collections:886] # 2026 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:43,  1.40s/it][2/6] extract embeddings:  12%|█▎        | 4/32 [00:01<00:08,  3.23it/s][2/6] extract embeddings:  22%|██▏       | 7/32 [00:01<00:04,  6.03it/s][2/6] extract embeddings:  31%|███▏      | 10/32 [00:01<00:02,  8.96it/s][2/6] extract embeddings:  41%|████      | 13/32 [00:01<00:01, 11.77it/s][2/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 14.33it/s][2/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 16.50it/s][2/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 18.90it/s][2/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 20.04it/s][2/6] extract embeddings:  88%|████████▊ | 28/32 [00:02<00:00, 20.94it/s][2/6] extract embeddings:  97%|█████████▋| 31/32 [00:02<00:00, 22.34it/s][2/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 11.68it/s]
[NeMo I 2025-04-17 02:12:31 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:12:31 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:31 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:31 collections:880] Dataset successfully loaded with 2133 items and total duration provided from manifest is  0.49 hours.
[NeMo I 2025-04-17 02:12:31 collections:886] # 2133 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:37,  1.14s/it][3/6] extract embeddings:   9%|▉         | 3/34 [00:01<00:10,  3.01it/s][3/6] extract embeddings:  15%|█▍        | 5/34 [00:01<00:05,  5.26it/s][3/6] extract embeddings:  24%|██▎       | 8/34 [00:01<00:02,  8.89it/s][3/6] extract embeddings:  32%|███▏      | 11/34 [00:01<00:01, 11.96it/s][3/6] extract embeddings:  41%|████      | 14/34 [00:01<00:01, 15.25it/s][3/6] extract embeddings:  50%|█████     | 17/34 [00:01<00:00, 17.81it/s][3/6] extract embeddings:  59%|█████▉    | 20/34 [00:01<00:00, 19.75it/s][3/6] extract embeddings:  68%|██████▊   | 23/34 [00:02<00:00, 22.18it/s][3/6] extract embeddings:  76%|███████▋  | 26/34 [00:02<00:00, 23.52it/s][3/6] extract embeddings:  85%|████████▌ | 29/34 [00:02<00:00, 22.82it/s][3/6] extract embeddings:  94%|█████████▍| 32/34 [00:02<00:00, 24.17it/s][3/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 13.56it/s]
[NeMo I 2025-04-17 02:12:34 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:12:34 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:34 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:34 collections:880] Dataset successfully loaded with 2382 items and total duration provided from manifest is  0.52 hours.
[NeMo I 2025-04-17 02:12:34 collections:886] # 2382 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:42,  1.15s/it][4/6] extract embeddings:  11%|█         | 4/38 [00:01<00:08,  3.83it/s][4/6] extract embeddings:  18%|█▊        | 7/38 [00:01<00:04,  6.94it/s][4/6] extract embeddings:  26%|██▋       | 10/38 [00:01<00:02, 10.21it/s][4/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 13.27it/s][4/6] extract embeddings:  45%|████▍     | 17/38 [00:01<00:01, 17.42it/s][4/6] extract embeddings:  53%|█████▎    | 20/38 [00:01<00:00, 19.42it/s][4/6] extract embeddings:  61%|██████    | 23/38 [00:02<00:00, 21.75it/s][4/6] extract embeddings:  68%|██████▊   | 26/38 [00:02<00:00, 23.29it/s][4/6] extract embeddings:  76%|███████▋  | 29/38 [00:02<00:00, 24.32it/s][4/6] extract embeddings:  84%|████████▍ | 32/38 [00:02<00:00, 24.51it/s][4/6] extract embeddings:  92%|█████████▏| 35/38 [00:02<00:00, 25.69it/s][4/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 25.66it/s][4/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 14.55it/s]
[NeMo I 2025-04-17 02:12:37 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:12:37 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:37 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:37 collections:880] Dataset successfully loaded with 3061 items and total duration provided from manifest is  0.58 hours.
[NeMo I 2025-04-17 02:12:37 collections:886] # 3061 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/48 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/48 [00:01<00:53,  1.13s/it][5/6] extract embeddings:  10%|█         | 5/48 [00:01<00:08,  5.09it/s][5/6] extract embeddings:  17%|█▋        | 8/48 [00:01<00:04,  8.37it/s][5/6] extract embeddings:  23%|██▎       | 11/48 [00:01<00:03, 11.81it/s][5/6] extract embeddings:  29%|██▉       | 14/48 [00:01<00:02, 14.82it/s][5/6] extract embeddings:  38%|███▊      | 18/48 [00:01<00:01, 18.55it/s][5/6] extract embeddings:  44%|████▍     | 21/48 [00:01<00:01, 20.97it/s][5/6] extract embeddings:  52%|█████▏    | 25/48 [00:01<00:01, 22.79it/s][5/6] extract embeddings:  58%|█████▊    | 28/48 [00:02<00:00, 24.23it/s][5/6] extract embeddings:  65%|██████▍   | 31/48 [00:02<00:00, 24.99it/s][5/6] extract embeddings:  71%|███████   | 34/48 [00:02<00:00, 26.18it/s][5/6] extract embeddings:  77%|███████▋  | 37/48 [00:02<00:00, 26.91it/s][5/6] extract embeddings:  83%|████████▎ | 40/48 [00:02<00:00, 26.94it/s][5/6] extract embeddings:  92%|█████████▏| 44/48 [00:02<00:00, 27.51it/s][5/6] extract embeddings:  98%|█████████▊| 47/48 [00:02<00:00, 27.08it/s][5/6] extract embeddings: 100%|██████████| 48/48 [00:02<00:00, 17.01it/s]
[NeMo I 2025-04-17 02:12:40 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:12:40 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:40 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:40 collections:880] Dataset successfully loaded with 5574 items and total duration provided from manifest is  0.68 hours.
[NeMo I 2025-04-17 02:12:40 collections:886] # 5574 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/88 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/88 [00:01<01:37,  1.13s/it][6/6] extract embeddings:   5%|▍         | 4/88 [00:01<00:20,  4.02it/s][6/6] extract embeddings:   7%|▋         | 6/88 [00:01<00:13,  6.04it/s][6/6] extract embeddings:  10%|█         | 9/88 [00:01<00:08,  9.27it/s][6/6] extract embeddings:  12%|█▎        | 11/88 [00:01<00:07, 10.79it/s][6/6] extract embeddings:  16%|█▌        | 14/88 [00:01<00:05, 14.50it/s][6/6] extract embeddings:  20%|██        | 18/88 [00:01<00:03, 19.39it/s][6/6] extract embeddings:  25%|██▌       | 22/88 [00:01<00:02, 23.14it/s][6/6] extract embeddings:  30%|██▉       | 26/88 [00:02<00:02, 26.04it/s][6/6] extract embeddings:  34%|███▍      | 30/88 [00:02<00:02, 27.84it/s][6/6] extract embeddings:  39%|███▊      | 34/88 [00:02<00:01, 29.39it/s][6/6] extract embeddings:  43%|████▎     | 38/88 [00:02<00:01, 30.89it/s][6/6] extract embeddings:  48%|████▊     | 42/88 [00:02<00:01, 32.29it/s][6/6] extract embeddings:  52%|█████▏    | 46/88 [00:02<00:01, 32.20it/s][6/6] extract embeddings:  57%|█████▋    | 50/88 [00:02<00:01, 33.05it/s][6/6] extract embeddings:  61%|██████▏   | 54/88 [00:02<00:01, 33.53it/s][6/6] extract embeddings:  66%|██████▌   | 58/88 [00:03<00:00, 33.22it/s][6/6] extract embeddings:  70%|███████   | 62/88 [00:03<00:00, 33.25it/s][6/6] extract embeddings:  75%|███████▌  | 66/88 [00:03<00:00, 33.75it/s][6/6] extract embeddings:  80%|███████▉  | 70/88 [00:03<00:00, 33.75it/s][6/6] extract embeddings:  84%|████████▍ | 74/88 [00:03<00:00, 32.73it/s][6/6] extract embeddings:  89%|████████▊ | 78/88 [00:03<00:00, 32.53it/s][6/6] extract embeddings:  93%|█████████▎| 82/88 [00:03<00:00, 32.44it/s][6/6] extract embeddings:  98%|█████████▊| 86/88 [00:03<00:00, 32.16it/s][6/6] extract embeddings: 100%|██████████| 88/88 [00:03<00:00, 22.16it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.00it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.58it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.94it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.36it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s]
[NeMo I 2025-04-17 02:12:45 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:12:46 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              69.878651   444.120  ...   7.524998  1.694361
    Harker-ES                       68.453525  2178.782  ...  26.537684  1.218005
    Harker-MN                       69.564563   366.767  ...  19.611007  5.346993
    Longfellow-Block-1              64.936637   492.417  ...   9.714991  1.972919
    TOTAL                           68.254978  3482.086  ...  63.388680  1.820423
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:12:46 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0241 | MISS: 0.6402 | CER: 0.0182 | DER: 0.6825 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.65
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.65 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.92s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:12:58 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:12:58 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:12:58 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:12:58 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:12:58 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:12:58 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:12:58 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:12:58 features:305] PADDING: 16
[NeMo I 2025-04-17 02:12:59 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:12:59 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:12:59 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:12:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:12:59 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:12:59 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:12:59 collections:880] Dataset successfully loaded with 1950 items and total duration provided from manifest is  0.44 hours.
[NeMo I 2025-04-17 02:12:59 collections:886] # 1950 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:58,  1.95s/it][1/6] extract embeddings:  13%|█▎        | 4/31 [00:02<00:10,  2.48it/s][1/6] extract embeddings:  23%|██▎       | 7/31 [00:02<00:04,  4.81it/s][1/6] extract embeddings:  32%|███▏      | 10/31 [00:02<00:02,  7.38it/s][1/6] extract embeddings:  42%|████▏     | 13/31 [00:02<00:01,  9.88it/s][1/6] extract embeddings:  52%|█████▏    | 16/31 [00:02<00:01, 12.59it/s][1/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 15.19it/s][1/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 17.68it/s][1/6] extract embeddings:  81%|████████  | 25/31 [00:02<00:00, 19.18it/s][1/6] extract embeddings:  90%|█████████ | 28/31 [00:03<00:00, 20.52it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00, 22.62it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00,  9.73it/s]
[NeMo I 2025-04-17 02:13:02 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:13:02 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:02 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:02 collections:880] Dataset successfully loaded with 2013 items and total duration provided from manifest is  0.45 hours.
[NeMo I 2025-04-17 02:13:02 collections:886] # 2013 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:43,  1.40s/it][2/6] extract embeddings:  12%|█▎        | 4/32 [00:01<00:08,  3.25it/s][2/6] extract embeddings:  22%|██▏       | 7/32 [00:01<00:04,  5.99it/s][2/6] extract embeddings:  31%|███▏      | 10/32 [00:01<00:02,  8.82it/s][2/6] extract embeddings:  41%|████      | 13/32 [00:01<00:01, 11.83it/s][2/6] extract embeddings:  50%|█████     | 16/32 [00:02<00:01, 14.84it/s][2/6] extract embeddings:  59%|█████▉    | 19/32 [00:02<00:00, 17.24it/s][2/6] extract embeddings:  69%|██████▉   | 22/32 [00:02<00:00, 19.59it/s][2/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 20.95it/s][2/6] extract embeddings:  88%|████████▊ | 28/32 [00:02<00:00, 21.36it/s][2/6] extract embeddings:  97%|█████████▋| 31/32 [00:02<00:00, 22.57it/s][2/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 11.81it/s]
[NeMo I 2025-04-17 02:13:05 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:13:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:05 collections:880] Dataset successfully loaded with 2110 items and total duration provided from manifest is  0.47 hours.
[NeMo I 2025-04-17 02:13:05 collections:886] # 2110 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:36,  1.13s/it][3/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:07,  3.96it/s][3/6] extract embeddings:  21%|██        | 7/33 [00:01<00:03,  7.22it/s][3/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02, 10.58it/s][3/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 13.77it/s][3/6] extract embeddings:  48%|████▊     | 16/33 [00:01<00:01, 16.68it/s][3/6] extract embeddings:  58%|█████▊    | 19/33 [00:01<00:00, 18.97it/s][3/6] extract embeddings:  67%|██████▋   | 22/33 [00:01<00:00, 20.00it/s][3/6] extract embeddings:  76%|███████▌  | 25/33 [00:02<00:00, 21.90it/s][3/6] extract embeddings:  85%|████████▍ | 28/33 [00:02<00:00, 22.81it/s][3/6] extract embeddings:  94%|█████████▍| 31/33 [00:02<00:00, 24.02it/s][3/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 13.59it/s]
[NeMo I 2025-04-17 02:13:07 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:13:07 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:07 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:07 collections:880] Dataset successfully loaded with 2352 items and total duration provided from manifest is  0.51 hours.
[NeMo I 2025-04-17 02:13:07 collections:886] # 2352 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:41,  1.15s/it][4/6] extract embeddings:  11%|█         | 4/37 [00:01<00:08,  3.90it/s][4/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:04,  7.12it/s][4/6] extract embeddings:  27%|██▋       | 10/37 [00:01<00:02, 10.36it/s][4/6] extract embeddings:  35%|███▌      | 13/37 [00:01<00:01, 13.68it/s][4/6] extract embeddings:  43%|████▎     | 16/37 [00:01<00:01, 16.80it/s][4/6] extract embeddings:  51%|█████▏    | 19/37 [00:01<00:00, 19.42it/s][4/6] extract embeddings:  59%|█████▉    | 22/37 [00:01<00:00, 21.81it/s][4/6] extract embeddings:  68%|██████▊   | 25/37 [00:02<00:00, 22.93it/s][4/6] extract embeddings:  76%|███████▌  | 28/37 [00:02<00:00, 22.72it/s][4/6] extract embeddings:  84%|████████▍ | 31/37 [00:02<00:00, 23.54it/s][4/6] extract embeddings:  92%|█████████▏| 34/37 [00:02<00:00, 24.27it/s][4/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 24.98it/s][4/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 14.33it/s]
[NeMo I 2025-04-17 02:13:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:13:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:10 collections:880] Dataset successfully loaded with 2994 items and total duration provided from manifest is  0.56 hours.
[NeMo I 2025-04-17 02:13:10 collections:886] # 2994 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/47 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/47 [00:01<00:52,  1.13s/it][5/6] extract embeddings:   9%|▊         | 4/47 [00:01<00:10,  4.00it/s][5/6] extract embeddings:  15%|█▍        | 7/47 [00:01<00:05,  7.14it/s][5/6] extract embeddings:  21%|██▏       | 10/47 [00:01<00:03, 10.65it/s][5/6] extract embeddings:  28%|██▊       | 13/47 [00:01<00:02, 14.07it/s][5/6] extract embeddings:  34%|███▍      | 16/47 [00:01<00:01, 17.28it/s][5/6] extract embeddings:  40%|████      | 19/47 [00:01<00:01, 20.04it/s][5/6] extract embeddings:  47%|████▋     | 22/47 [00:01<00:01, 22.41it/s][5/6] extract embeddings:  53%|█████▎    | 25/47 [00:02<00:00, 24.24it/s][5/6] extract embeddings:  60%|█████▉    | 28/47 [00:02<00:00, 25.64it/s][5/6] extract embeddings:  66%|██████▌   | 31/47 [00:02<00:00, 26.26it/s][5/6] extract embeddings:  72%|███████▏  | 34/47 [00:02<00:00, 26.51it/s][5/6] extract embeddings:  81%|████████  | 38/47 [00:02<00:00, 27.40it/s][5/6] extract embeddings:  87%|████████▋ | 41/47 [00:02<00:00, 28.02it/s][5/6] extract embeddings:  96%|█████████▌| 45/47 [00:02<00:00, 28.39it/s][5/6] extract embeddings: 100%|██████████| 47/47 [00:02<00:00, 16.77it/s]
[NeMo I 2025-04-17 02:13:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:13:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:13 collections:880] Dataset successfully loaded with 5423 items and total duration provided from manifest is  0.65 hours.
[NeMo I 2025-04-17 02:13:13 collections:886] # 5423 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/85 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/85 [00:01<01:35,  1.14s/it][6/6] extract embeddings:   5%|▍         | 4/85 [00:01<00:20,  3.98it/s][6/6] extract embeddings:   8%|▊         | 7/85 [00:01<00:10,  7.17it/s][6/6] extract embeddings:  12%|█▏        | 10/85 [00:01<00:07, 10.24it/s][6/6] extract embeddings:  15%|█▌        | 13/85 [00:01<00:05, 13.37it/s][6/6] extract embeddings:  20%|██        | 17/85 [00:01<00:03, 17.83it/s][6/6] extract embeddings:  25%|██▍       | 21/85 [00:01<00:02, 21.48it/s][6/6] extract embeddings:  28%|██▊       | 24/85 [00:01<00:02, 23.23it/s][6/6] extract embeddings:  33%|███▎      | 28/85 [00:02<00:02, 25.39it/s][6/6] extract embeddings:  38%|███▊      | 32/85 [00:02<00:01, 27.19it/s][6/6] extract embeddings:  42%|████▏     | 36/85 [00:02<00:01, 28.89it/s][6/6] extract embeddings:  47%|████▋     | 40/85 [00:02<00:01, 30.55it/s][6/6] extract embeddings:  52%|█████▏    | 44/85 [00:02<00:01, 31.27it/s][6/6] extract embeddings:  56%|█████▋    | 48/85 [00:02<00:01, 32.19it/s][6/6] extract embeddings:  61%|██████    | 52/85 [00:02<00:01, 32.02it/s][6/6] extract embeddings:  66%|██████▌   | 56/85 [00:02<00:00, 33.01it/s][6/6] extract embeddings:  71%|███████   | 60/85 [00:03<00:00, 31.98it/s][6/6] extract embeddings:  75%|███████▌  | 64/85 [00:03<00:00, 31.84it/s][6/6] extract embeddings:  80%|████████  | 68/85 [00:03<00:00, 32.77it/s][6/6] extract embeddings:  85%|████████▍ | 72/85 [00:03<00:00, 33.08it/s][6/6] extract embeddings:  89%|████████▉ | 76/85 [00:03<00:00, 32.82it/s][6/6] extract embeddings:  94%|█████████▍| 80/85 [00:03<00:00, 33.30it/s][6/6] extract embeddings:  99%|█████████▉| 84/85 [00:03<00:00, 33.20it/s][6/6] extract embeddings: 100%|██████████| 85/85 [00:03<00:00, 21.96it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.05it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.49it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.92it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.32it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.99it/s]
[NeMo I 2025-04-17 02:13:19 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:13:20 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              70.598026   444.120  ...   7.150016  1.609929
    Harker-ES                       69.728354  2178.782  ...  31.064855  1.425790
    Harker-MN                       70.875999   366.767  ...  18.315017  4.993638
    Longfellow-Block-1              65.115147   492.417  ...   9.546983  1.938801
    TOTAL                           69.307783  3482.086  ...  66.076872  1.897623
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:13:20 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0237 | MISS: 0.6504 | CER: 0.0190 | DER: 0.6931 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.65
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.65 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.80s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.92s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:13:31 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:13:31 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:13:31 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:13:31 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:13:31 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:13:31 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:13:31 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:13:31 features:305] PADDING: 16
[NeMo I 2025-04-17 02:13:32 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:13:32 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:13:32 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:13:32 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:13:32 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:32 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:32 collections:880] Dataset successfully loaded with 1929 items and total duration provided from manifest is  0.42 hours.
[NeMo I 2025-04-17 02:13:32 collections:886] # 1929 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:59,  1.99s/it][1/6] extract embeddings:  13%|█▎        | 4/31 [00:02<00:11,  2.44it/s][1/6] extract embeddings:  23%|██▎       | 7/31 [00:02<00:05,  4.73it/s][1/6] extract embeddings:  32%|███▏      | 10/31 [00:02<00:02,  7.33it/s][1/6] extract embeddings:  42%|████▏     | 13/31 [00:02<00:01, 10.12it/s][1/6] extract embeddings:  52%|█████▏    | 16/31 [00:02<00:01, 12.86it/s][1/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 15.37it/s][1/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 17.55it/s][1/6] extract embeddings:  81%|████████  | 25/31 [00:02<00:00, 19.23it/s][1/6] extract embeddings:  90%|█████████ | 28/31 [00:03<00:00, 20.72it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00, 22.36it/s][1/6] extract embeddings: 100%|██████████| 31/31 [00:03<00:00,  9.67it/s]
[NeMo I 2025-04-17 02:13:35 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:13:35 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:35 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:35 collections:880] Dataset successfully loaded with 1981 items and total duration provided from manifest is  0.43 hours.
[NeMo I 2025-04-17 02:13:35 collections:886] # 1981 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:42,  1.40s/it][2/6] extract embeddings:  13%|█▎        | 4/31 [00:01<00:08,  3.27it/s][2/6] extract embeddings:  23%|██▎       | 7/31 [00:01<00:03,  6.19it/s][2/6] extract embeddings:  32%|███▏      | 10/31 [00:01<00:02,  9.14it/s][2/6] extract embeddings:  42%|████▏     | 13/31 [00:01<00:01, 12.22it/s][2/6] extract embeddings:  52%|█████▏    | 16/31 [00:02<00:00, 15.31it/s][2/6] extract embeddings:  61%|██████▏   | 19/31 [00:02<00:00, 17.70it/s][2/6] extract embeddings:  71%|███████   | 22/31 [00:02<00:00, 20.16it/s][2/6] extract embeddings:  81%|████████  | 25/31 [00:02<00:00, 21.24it/s][2/6] extract embeddings:  90%|█████████ | 28/31 [00:02<00:00, 22.29it/s][2/6] extract embeddings: 100%|██████████| 31/31 [00:02<00:00, 23.59it/s][2/6] extract embeddings: 100%|██████████| 31/31 [00:02<00:00, 11.83it/s]
[NeMo I 2025-04-17 02:13:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:13:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:38 collections:880] Dataset successfully loaded with 2069 items and total duration provided from manifest is  0.45 hours.
[NeMo I 2025-04-17 02:13:38 collections:886] # 2069 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:37,  1.16s/it][3/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:07,  3.97it/s][3/6] extract embeddings:  21%|██        | 7/33 [00:01<00:03,  7.35it/s][3/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02, 10.40it/s][3/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 13.51it/s][3/6] extract embeddings:  48%|████▊     | 16/33 [00:01<00:01, 16.51it/s][3/6] extract embeddings:  58%|█████▊    | 19/33 [00:01<00:00, 17.84it/s][3/6] extract embeddings:  67%|██████▋   | 22/33 [00:01<00:00, 19.84it/s][3/6] extract embeddings:  76%|███████▌  | 25/33 [00:02<00:00, 22.01it/s][3/6] extract embeddings:  85%|████████▍ | 28/33 [00:02<00:00, 22.26it/s][3/6] extract embeddings:  94%|█████████▍| 31/33 [00:02<00:00, 23.17it/s][3/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 13.45it/s]
[NeMo I 2025-04-17 02:13:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:13:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:41 collections:880] Dataset successfully loaded with 2298 items and total duration provided from manifest is  0.48 hours.
[NeMo I 2025-04-17 02:13:41 collections:886] # 2298 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:39,  1.12s/it][4/6] extract embeddings:  11%|█         | 4/36 [00:01<00:08,  3.97it/s][4/6] extract embeddings:  19%|█▉        | 7/36 [00:01<00:04,  7.20it/s][4/6] extract embeddings:  28%|██▊       | 10/36 [00:01<00:02, 10.49it/s][4/6] extract embeddings:  36%|███▌      | 13/36 [00:01<00:01, 13.69it/s][4/6] extract embeddings:  44%|████▍     | 16/36 [00:01<00:01, 16.67it/s][4/6] extract embeddings:  53%|█████▎    | 19/36 [00:01<00:00, 19.56it/s][4/6] extract embeddings:  61%|██████    | 22/36 [00:01<00:00, 21.45it/s][4/6] extract embeddings:  69%|██████▉   | 25/36 [00:02<00:00, 22.48it/s][4/6] extract embeddings:  78%|███████▊  | 28/36 [00:02<00:00, 22.37it/s][4/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 23.42it/s][4/6] extract embeddings:  94%|█████████▍| 34/36 [00:02<00:00, 24.67it/s][4/6] extract embeddings: 100%|██████████| 36/36 [00:02<00:00, 14.30it/s]
[NeMo I 2025-04-17 02:13:43 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:13:43 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:43 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:43 collections:880] Dataset successfully loaded with 2882 items and total duration provided from manifest is  0.53 hours.
[NeMo I 2025-04-17 02:13:43 collections:886] # 2882 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:51,  1.13s/it][5/6] extract embeddings:   9%|▊         | 4/46 [00:01<00:10,  4.12it/s][5/6] extract embeddings:  15%|█▌        | 7/46 [00:01<00:05,  7.62it/s][5/6] extract embeddings:  24%|██▍       | 11/46 [00:01<00:02, 12.30it/s][5/6] extract embeddings:  33%|███▎      | 15/46 [00:01<00:01, 16.39it/s][5/6] extract embeddings:  41%|████▏     | 19/46 [00:01<00:01, 19.94it/s][5/6] extract embeddings:  50%|█████     | 23/46 [00:01<00:01, 22.91it/s][5/6] extract embeddings:  57%|█████▋    | 26/46 [00:01<00:00, 24.45it/s][5/6] extract embeddings:  65%|██████▌   | 30/46 [00:02<00:00, 26.58it/s][5/6] extract embeddings:  74%|███████▍  | 34/46 [00:02<00:00, 27.59it/s][5/6] extract embeddings:  83%|████████▎ | 38/46 [00:02<00:00, 28.76it/s][5/6] extract embeddings:  91%|█████████▏| 42/46 [00:02<00:00, 29.36it/s][5/6] extract embeddings: 100%|██████████| 46/46 [00:02<00:00, 29.00it/s][5/6] extract embeddings: 100%|██████████| 46/46 [00:02<00:00, 17.38it/s]
[NeMo I 2025-04-17 02:13:46 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:13:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:13:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:13:46 collections:880] Dataset successfully loaded with 5175 items and total duration provided from manifest is  0.62 hours.
[NeMo I 2025-04-17 02:13:46 collections:886] # 5175 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/81 [00:00<?, ?it/s][6/6] extract embeddings:   1%|          | 1/81 [00:01<01:29,  1.12s/it][6/6] extract embeddings:   5%|▍         | 4/81 [00:01<00:18,  4.06it/s][6/6] extract embeddings:   7%|▋         | 6/81 [00:01<00:12,  6.15it/s][6/6] extract embeddings:  11%|█         | 9/81 [00:01<00:07,  9.38it/s][6/6] extract embeddings:  14%|█▎        | 11/81 [00:01<00:06, 11.26it/s][6/6] extract embeddings:  19%|█▊        | 15/81 [00:01<00:04, 16.17it/s][6/6] extract embeddings:  23%|██▎       | 19/81 [00:01<00:02, 20.69it/s][6/6] extract embeddings:  28%|██▊       | 23/81 [00:01<00:02, 23.86it/s][6/6] extract embeddings:  33%|███▎      | 27/81 [00:02<00:02, 25.90it/s][6/6] extract embeddings:  38%|███▊      | 31/81 [00:02<00:01, 28.26it/s][6/6] extract embeddings:  43%|████▎     | 35/81 [00:02<00:01, 29.83it/s][6/6] extract embeddings:  48%|████▊     | 39/81 [00:02<00:01, 31.38it/s][6/6] extract embeddings:  53%|█████▎    | 43/81 [00:02<00:01, 31.96it/s][6/6] extract embeddings:  58%|█████▊    | 47/81 [00:02<00:01, 32.37it/s][6/6] extract embeddings:  63%|██████▎   | 51/81 [00:02<00:00, 31.04it/s][6/6] extract embeddings:  68%|██████▊   | 55/81 [00:02<00:00, 32.08it/s][6/6] extract embeddings:  73%|███████▎  | 59/81 [00:03<00:00, 31.82it/s][6/6] extract embeddings:  78%|███████▊  | 63/81 [00:03<00:00, 32.26it/s][6/6] extract embeddings:  83%|████████▎ | 67/81 [00:03<00:00, 33.21it/s][6/6] extract embeddings:  88%|████████▊ | 71/81 [00:03<00:00, 33.78it/s][6/6] extract embeddings:  93%|█████████▎| 75/81 [00:03<00:00, 34.88it/s][6/6] extract embeddings:  98%|█████████▊| 79/81 [00:03<00:00, 34.76it/s][6/6] extract embeddings: 100%|██████████| 81/81 [00:03<00:00, 21.71it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.01it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.56it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.03it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.47it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s]
[NeMo I 2025-04-17 02:13:51 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:13:53 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              71.851048   444.120  ...   8.114971  1.827202
    Harker-ES                       71.267345  2178.782  ...  30.788344  1.413099
    Harker-MN                       71.948105   366.767  ...  17.379028  4.738438
    Longfellow-Block-1              66.317614   492.417  ...   9.695974  1.969058
    TOTAL                           70.713534  3482.086  ...  65.978317  1.894793
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:13:53 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0227 | MISS: 0.6655 | CER: 0.0189 | DER: 0.7071 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.65
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.65 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.69s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.87s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:14:04 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:14:04 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:14:04 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:14:04 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:14:04 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:14:04 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:14:04 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:14:04 features:305] PADDING: 16
[NeMo I 2025-04-17 02:14:05 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:14:05 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:14:05 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:14:05 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:14:05 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:05 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:05 collections:880] Dataset successfully loaded with 1901 items and total duration provided from manifest is  0.39 hours.
[NeMo I 2025-04-17 02:14:05 collections:886] # 1901 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/30 [00:02<00:58,  2.03s/it][1/6] extract embeddings:  13%|█▎        | 4/30 [00:02<00:10,  2.39it/s][1/6] extract embeddings:  23%|██▎       | 7/30 [00:02<00:04,  4.64it/s][1/6] extract embeddings:  30%|███       | 9/30 [00:02<00:03,  6.16it/s][1/6] extract embeddings:  37%|███▋      | 11/30 [00:02<00:02,  7.85it/s][1/6] extract embeddings:  47%|████▋     | 14/30 [00:02<00:01, 10.47it/s][1/6] extract embeddings:  53%|█████▎    | 16/30 [00:02<00:01, 11.86it/s][1/6] extract embeddings:  60%|██████    | 18/30 [00:02<00:00, 13.27it/s][1/6] extract embeddings:  67%|██████▋   | 20/30 [00:02<00:00, 14.53it/s][1/6] extract embeddings:  77%|███████▋  | 23/30 [00:03<00:00, 16.92it/s][1/6] extract embeddings:  87%|████████▋ | 26/30 [00:03<00:00, 19.03it/s][1/6] extract embeddings:  97%|█████████▋| 29/30 [00:03<00:00, 20.50it/s][1/6] extract embeddings: 100%|██████████| 30/30 [00:03<00:00,  8.78it/s]
[NeMo I 2025-04-17 02:14:08 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:14:08 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:08 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:08 collections:880] Dataset successfully loaded with 1939 items and total duration provided from manifest is  0.40 hours.
[NeMo I 2025-04-17 02:14:08 collections:886] # 1939 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:42,  1.41s/it][2/6] extract embeddings:  13%|█▎        | 4/31 [00:01<00:07,  3.40it/s][2/6] extract embeddings:  19%|█▉        | 6/31 [00:01<00:04,  5.25it/s][2/6] extract embeddings:  26%|██▌       | 8/31 [00:01<00:03,  7.26it/s][2/6] extract embeddings:  32%|███▏      | 10/31 [00:01<00:02,  8.98it/s][2/6] extract embeddings:  39%|███▊      | 12/31 [00:01<00:01, 10.80it/s][2/6] extract embeddings:  48%|████▊     | 15/31 [00:02<00:01, 14.14it/s][2/6] extract embeddings:  58%|█████▊    | 18/31 [00:02<00:00, 16.80it/s][2/6] extract embeddings:  68%|██████▊   | 21/31 [00:02<00:00, 19.19it/s][2/6] extract embeddings:  77%|███████▋  | 24/31 [00:02<00:00, 21.05it/s][2/6] extract embeddings:  87%|████████▋ | 27/31 [00:02<00:00, 22.28it/s][2/6] extract embeddings:  97%|█████████▋| 30/31 [00:02<00:00, 23.88it/s][2/6] extract embeddings: 100%|██████████| 31/31 [00:02<00:00, 11.32it/s]
[NeMo I 2025-04-17 02:14:12 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:14:12 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:12 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:12 collections:880] Dataset successfully loaded with 2016 items and total duration provided from manifest is  0.41 hours.
[NeMo I 2025-04-17 02:14:12 collections:886] # 2016 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:35,  1.15s/it][3/6] extract embeddings:  12%|█▎        | 4/32 [00:01<00:06,  4.02it/s][3/6] extract embeddings:  22%|██▏       | 7/32 [00:01<00:03,  7.42it/s][3/6] extract embeddings:  31%|███▏      | 10/32 [00:01<00:02, 10.86it/s][3/6] extract embeddings:  41%|████      | 13/32 [00:01<00:01, 14.28it/s][3/6] extract embeddings:  50%|█████     | 16/32 [00:01<00:00, 16.91it/s][3/6] extract embeddings:  59%|█████▉    | 19/32 [00:01<00:00, 19.10it/s][3/6] extract embeddings:  69%|██████▉   | 22/32 [00:01<00:00, 21.20it/s][3/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 22.25it/s][3/6] extract embeddings:  88%|████████▊ | 28/32 [00:02<00:00, 21.08it/s][3/6] extract embeddings:  97%|█████████▋| 31/32 [00:02<00:00, 22.67it/s][3/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 13.44it/s]
[NeMo I 2025-04-17 02:14:14 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:14:14 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:14 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:14 collections:880] Dataset successfully loaded with 2221 items and total duration provided from manifest is  0.45 hours.
[NeMo I 2025-04-17 02:14:14 collections:886] # 2221 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:38,  1.14s/it][4/6] extract embeddings:  11%|█▏        | 4/35 [00:01<00:07,  4.09it/s][4/6] extract embeddings:  20%|██        | 7/35 [00:01<00:03,  7.49it/s][4/6] extract embeddings:  29%|██▊       | 10/35 [00:01<00:02, 11.02it/s][4/6] extract embeddings:  37%|███▋      | 13/35 [00:01<00:01, 14.26it/s][4/6] extract embeddings:  46%|████▌     | 16/35 [00:01<00:01, 16.95it/s][4/6] extract embeddings:  57%|█████▋    | 20/35 [00:01<00:00, 20.42it/s][4/6] extract embeddings:  66%|██████▌   | 23/35 [00:01<00:00, 22.56it/s][4/6] extract embeddings:  74%|███████▍  | 26/35 [00:02<00:00, 22.99it/s][4/6] extract embeddings:  83%|████████▎ | 29/35 [00:02<00:00, 21.05it/s][4/6] extract embeddings:  91%|█████████▏| 32/35 [00:02<00:00, 21.49it/s][4/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 14.05it/s]
[NeMo I 2025-04-17 02:14:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:14:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:17 collections:880] Dataset successfully loaded with 2743 items and total duration provided from manifest is  0.49 hours.
[NeMo I 2025-04-17 02:14:17 collections:886] # 2743 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:47,  1.13s/it][5/6] extract embeddings:  12%|█▏        | 5/43 [00:01<00:07,  5.15it/s][5/6] extract embeddings:  19%|█▊        | 8/43 [00:01<00:04,  8.35it/s][5/6] extract embeddings:  26%|██▌       | 11/43 [00:01<00:02, 11.75it/s][5/6] extract embeddings:  33%|███▎      | 14/43 [00:01<00:01, 14.84it/s][5/6] extract embeddings:  42%|████▏     | 18/43 [00:01<00:01, 18.77it/s][5/6] extract embeddings:  49%|████▉     | 21/43 [00:01<00:01, 20.43it/s][5/6] extract embeddings:  58%|█████▊    | 25/43 [00:01<00:00, 23.07it/s][5/6] extract embeddings:  67%|██████▋   | 29/43 [00:02<00:00, 25.75it/s][5/6] extract embeddings:  74%|███████▍  | 32/43 [00:02<00:00, 23.80it/s][5/6] extract embeddings:  81%|████████▏ | 35/43 [00:02<00:00, 22.32it/s][5/6] extract embeddings:  88%|████████▊ | 38/43 [00:02<00:00, 22.20it/s][5/6] extract embeddings:  98%|█████████▊| 42/43 [00:02<00:00, 24.64it/s][5/6] extract embeddings: 100%|██████████| 43/43 [00:02<00:00, 15.77it/s]
[NeMo I 2025-04-17 02:14:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:14:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:19 collections:880] Dataset successfully loaded with 4874 items and total duration provided from manifest is  0.58 hours.
[NeMo I 2025-04-17 02:14:19 collections:886] # 4874 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/77 [00:00<?, ?it/s][6/6] extract embeddings:   1%|▏         | 1/77 [00:01<01:25,  1.12s/it][6/6] extract embeddings:   8%|▊         | 6/77 [00:01<00:11,  6.27it/s][6/6] extract embeddings:  13%|█▎        | 10/77 [00:01<00:06, 10.62it/s][6/6] extract embeddings:  17%|█▋        | 13/77 [00:01<00:04, 13.68it/s][6/6] extract embeddings:  22%|██▏       | 17/77 [00:01<00:03, 17.72it/s][6/6] extract embeddings:  27%|██▋       | 21/77 [00:01<00:02, 21.57it/s][6/6] extract embeddings:  32%|███▏      | 25/77 [00:01<00:02, 23.74it/s][6/6] extract embeddings:  38%|███▊      | 29/77 [00:01<00:01, 26.09it/s][6/6] extract embeddings:  43%|████▎     | 33/77 [00:02<00:01, 28.11it/s][6/6] extract embeddings:  48%|████▊     | 37/77 [00:02<00:01, 29.99it/s][6/6] extract embeddings:  53%|█████▎    | 41/77 [00:02<00:01, 30.41it/s][6/6] extract embeddings:  58%|█████▊    | 45/77 [00:02<00:01, 29.99it/s][6/6] extract embeddings:  64%|██████▎   | 49/77 [00:02<00:00, 31.56it/s][6/6] extract embeddings:  69%|██████▉   | 53/77 [00:02<00:00, 30.26it/s][6/6] extract embeddings:  74%|███████▍  | 57/77 [00:02<00:00, 27.82it/s][6/6] extract embeddings:  78%|███████▊  | 60/77 [00:03<00:00, 26.63it/s][6/6] extract embeddings:  82%|████████▏ | 63/77 [00:03<00:00, 25.27it/s][6/6] extract embeddings:  86%|████████▌ | 66/77 [00:03<00:00, 25.43it/s][6/6] extract embeddings:  91%|█████████ | 70/77 [00:03<00:00, 28.19it/s][6/6] extract embeddings:  95%|█████████▍| 73/77 [00:03<00:00, 28.09it/s][6/6] extract embeddings: 100%|██████████| 77/77 [00:03<00:00, 29.07it/s][6/6] extract embeddings: 100%|██████████| 77/77 [00:03<00:00, 21.12it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.13it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.73it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.22it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.67it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s]
[NeMo I 2025-04-17 02:14:25 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:14:26 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              72.637976   444.120  ...   7.100019  1.598671
    Harker-ES                       73.369937  2178.782  ...  33.491495  1.537166
    Harker-MN                       73.320680   366.767  ...  16.922022  4.613834
    Longfellow-Block-1              67.648175   492.417  ...   8.922986  1.812079
    TOTAL                           72.462252  3482.086  ...  66.436522  1.907952
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:14:26 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0211 | MISS: 0.6845 | CER: 0.0191 | DER: 0.7246 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.65
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.65 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.77s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.23s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:14:37 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:14:37 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:14:37 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:14:37 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:14:37 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:14:37 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:14:37 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:14:37 features:305] PADDING: 16
[NeMo I 2025-04-17 02:14:38 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:14:38 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:14:38 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:14:38 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:14:38 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:38 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:38 collections:880] Dataset successfully loaded with 1847 items and total duration provided from manifest is  0.35 hours.
[NeMo I 2025-04-17 02:14:38 collections:886] # 1847 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/29 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/29 [00:01<00:54,  1.96s/it][1/6] extract embeddings:  14%|█▍        | 4/29 [00:02<00:10,  2.48it/s][1/6] extract embeddings:  24%|██▍       | 7/29 [00:02<00:04,  4.79it/s][1/6] extract embeddings:  34%|███▍      | 10/29 [00:02<00:02,  7.39it/s][1/6] extract embeddings:  48%|████▊     | 14/29 [00:02<00:01, 11.07it/s][1/6] extract embeddings:  59%|█████▊    | 17/29 [00:02<00:00, 13.38it/s][1/6] extract embeddings:  69%|██████▉   | 20/29 [00:02<00:00, 15.74it/s][1/6] extract embeddings:  79%|███████▉  | 23/29 [00:02<00:00, 17.66it/s][1/6] extract embeddings:  90%|████████▉ | 26/29 [00:02<00:00, 19.35it/s][1/6] extract embeddings: 100%|██████████| 29/29 [00:03<00:00, 21.69it/s][1/6] extract embeddings: 100%|██████████| 29/29 [00:03<00:00,  9.40it/s]
[NeMo I 2025-04-17 02:14:41 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:14:41 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:41 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:41 collections:880] Dataset successfully loaded with 1869 items and total duration provided from manifest is  0.36 hours.
[NeMo I 2025-04-17 02:14:41 collections:886] # 1869 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/30 [00:01<00:39,  1.37s/it][2/6] extract embeddings:  13%|█▎        | 4/30 [00:01<00:07,  3.45it/s][2/6] extract embeddings:  23%|██▎       | 7/30 [00:01<00:03,  6.54it/s][2/6] extract embeddings:  33%|███▎      | 10/30 [00:01<00:02,  9.32it/s][2/6] extract embeddings:  43%|████▎     | 13/30 [00:01<00:01, 12.48it/s][2/6] extract embeddings:  53%|█████▎    | 16/30 [00:01<00:00, 15.59it/s][2/6] extract embeddings:  63%|██████▎   | 19/30 [00:02<00:00, 18.20it/s][2/6] extract embeddings:  73%|███████▎  | 22/30 [00:02<00:00, 19.08it/s][2/6] extract embeddings:  83%|████████▎ | 25/30 [00:02<00:00, 19.00it/s][2/6] extract embeddings:  93%|█████████▎| 28/30 [00:02<00:00, 21.01it/s][2/6] extract embeddings: 100%|██████████| 30/30 [00:02<00:00, 11.69it/s]
[NeMo I 2025-04-17 02:14:44 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:14:44 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:44 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:44 collections:880] Dataset successfully loaded with 1938 items and total duration provided from manifest is  0.37 hours.
[NeMo I 2025-04-17 02:14:44 collections:886] # 1938 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:33,  1.13s/it][3/6] extract embeddings:  13%|█▎        | 4/31 [00:01<00:06,  4.12it/s][3/6] extract embeddings:  23%|██▎       | 7/31 [00:01<00:03,  7.62it/s][3/6] extract embeddings:  32%|███▏      | 10/31 [00:01<00:01, 10.87it/s][3/6] extract embeddings:  42%|████▏     | 13/31 [00:01<00:01, 14.26it/s][3/6] extract embeddings:  52%|█████▏    | 16/31 [00:01<00:00, 17.04it/s][3/6] extract embeddings:  65%|██████▍   | 20/31 [00:01<00:00, 20.43it/s][3/6] extract embeddings:  74%|███████▍  | 23/31 [00:01<00:00, 21.71it/s][3/6] extract embeddings:  84%|████████▍ | 26/31 [00:02<00:00, 20.84it/s][3/6] extract embeddings:  94%|█████████▎| 29/31 [00:02<00:00, 22.57it/s][3/6] extract embeddings: 100%|██████████| 31/31 [00:02<00:00, 13.47it/s]
[NeMo I 2025-04-17 02:14:46 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:14:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:46 collections:880] Dataset successfully loaded with 2112 items and total duration provided from manifest is  0.40 hours.
[NeMo I 2025-04-17 02:14:46 collections:886] # 2112 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:36,  1.13s/it][4/6] extract embeddings:  12%|█▏        | 4/33 [00:01<00:07,  4.10it/s][4/6] extract embeddings:  21%|██        | 7/33 [00:01<00:03,  7.52it/s][4/6] extract embeddings:  30%|███       | 10/33 [00:01<00:02, 10.89it/s][4/6] extract embeddings:  39%|███▉      | 13/33 [00:01<00:01, 13.91it/s][4/6] extract embeddings:  52%|█████▏    | 17/33 [00:01<00:00, 17.86it/s][4/6] extract embeddings:  61%|██████    | 20/33 [00:01<00:00, 20.08it/s][4/6] extract embeddings:  70%|██████▉   | 23/33 [00:01<00:00, 21.95it/s][4/6] extract embeddings:  79%|███████▉  | 26/33 [00:02<00:00, 21.05it/s][4/6] extract embeddings:  88%|████████▊ | 29/33 [00:02<00:00, 21.01it/s][4/6] extract embeddings:  97%|█████████▋| 32/33 [00:02<00:00, 23.06it/s][4/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 13.74it/s]
[NeMo I 2025-04-17 02:14:49 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:14:49 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:49 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:49 collections:880] Dataset successfully loaded with 2555 items and total duration provided from manifest is  0.44 hours.
[NeMo I 2025-04-17 02:14:49 collections:886] # 2555 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:44,  1.13s/it][5/6] extract embeddings:  12%|█▎        | 5/40 [00:01<00:06,  5.06it/s][5/6] extract embeddings:  20%|██        | 8/40 [00:01<00:03,  8.25it/s][5/6] extract embeddings:  28%|██▊       | 11/40 [00:01<00:02, 11.52it/s][5/6] extract embeddings:  38%|███▊      | 15/40 [00:01<00:01, 15.57it/s][5/6] extract embeddings:  48%|████▊     | 19/40 [00:01<00:01, 19.31it/s][5/6] extract embeddings:  55%|█████▌    | 22/40 [00:01<00:00, 21.48it/s][5/6] extract embeddings:  62%|██████▎   | 25/40 [00:01<00:00, 23.12it/s][5/6] extract embeddings:  72%|███████▎  | 29/40 [00:02<00:00, 23.69it/s][5/6] extract embeddings:  80%|████████  | 32/40 [00:02<00:00, 21.82it/s][5/6] extract embeddings:  88%|████████▊ | 35/40 [00:02<00:00, 21.82it/s][5/6] extract embeddings:  95%|█████████▌| 38/40 [00:02<00:00, 23.21it/s][5/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 15.18it/s]
[NeMo I 2025-04-17 02:14:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:14:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:14:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:14:52 collections:880] Dataset successfully loaded with 4444 items and total duration provided from manifest is  0.52 hours.
[NeMo I 2025-04-17 02:14:52 collections:886] # 4444 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/70 [00:00<?, ?it/s][6/6] extract embeddings:   1%|▏         | 1/70 [00:01<01:16,  1.11s/it][6/6] extract embeddings:   7%|▋         | 5/70 [00:01<00:12,  5.31it/s][6/6] extract embeddings:  13%|█▎        | 9/70 [00:01<00:06,  9.90it/s][6/6] extract embeddings:  19%|█▊        | 13/70 [00:01<00:03, 14.42it/s][6/6] extract embeddings:  24%|██▍       | 17/70 [00:01<00:02, 18.44it/s][6/6] extract embeddings:  30%|███       | 21/70 [00:01<00:02, 22.47it/s][6/6] extract embeddings:  36%|███▌      | 25/70 [00:01<00:01, 24.90it/s][6/6] extract embeddings:  41%|████▏     | 29/70 [00:01<00:01, 26.94it/s][6/6] extract embeddings:  47%|████▋     | 33/70 [00:02<00:01, 28.27it/s][6/6] extract embeddings:  53%|█████▎    | 37/70 [00:02<00:01, 29.40it/s][6/6] extract embeddings:  59%|█████▊    | 41/70 [00:02<00:00, 30.68it/s][6/6] extract embeddings:  64%|██████▍   | 45/70 [00:02<00:00, 32.19it/s][6/6] extract embeddings:  70%|███████   | 49/70 [00:02<00:00, 30.59it/s][6/6] extract embeddings:  76%|███████▌  | 53/70 [00:02<00:00, 26.19it/s][6/6] extract embeddings:  80%|████████  | 56/70 [00:02<00:00, 25.44it/s][6/6] extract embeddings:  84%|████████▍ | 59/70 [00:03<00:00, 24.63it/s][6/6] extract embeddings:  90%|█████████ | 63/70 [00:03<00:00, 27.13it/s][6/6] extract embeddings:  96%|█████████▌| 67/70 [00:03<00:00, 29.08it/s][6/6] extract embeddings: 100%|██████████| 70/70 [00:03<00:00, 20.79it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.16it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.74it/s]clustering:  75%|███████▌  | 3/4 [00:00<00:00,  3.25it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.81it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.36it/s]
[NeMo I 2025-04-17 02:14:56 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:14:58 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              75.173291   444.120  ...   7.640048  1.720267
    Harker-ES                       76.151680  2178.782  ...  35.052031  1.608790
    Harker-MN                       73.825607   366.767  ...  15.320093  4.177064
    Longfellow-Block-1              70.464928   492.417  ...   7.696037  1.562911
    TOTAL                           74.977699  3482.086  ...  65.708210  1.887036
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:14:58 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0190 | MISS: 0.7119 | CER: 0.0189 | DER: 0.7498 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.75, offset=0.70
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.75, <class 'float'> offset=0.7 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.90s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:15:09 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:15:09 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:15:09 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:15:09 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:15:09 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:15:10 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:15:10 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:15:10 features:305] PADDING: 16
[NeMo I 2025-04-17 02:15:10 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:15:10 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:15:10 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:15:10 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:15:10 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:10 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:10 collections:880] Dataset successfully loaded with 1901 items and total duration provided from manifest is  0.38 hours.
[NeMo I 2025-04-17 02:15:10 collections:886] # 1901 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/30 [00:01<00:57,  1.99s/it][1/6] extract embeddings:  13%|█▎        | 4/30 [00:02<00:10,  2.43it/s][1/6] extract embeddings:  23%|██▎       | 7/30 [00:02<00:04,  4.76it/s][1/6] extract embeddings:  33%|███▎      | 10/30 [00:02<00:02,  7.43it/s][1/6] extract embeddings:  43%|████▎     | 13/30 [00:02<00:01,  9.84it/s][1/6] extract embeddings:  53%|█████▎    | 16/30 [00:02<00:01, 12.36it/s][1/6] extract embeddings:  63%|██████▎   | 19/30 [00:02<00:00, 14.36it/s][1/6] extract embeddings:  73%|███████▎  | 22/30 [00:02<00:00, 16.49it/s][1/6] extract embeddings:  83%|████████▎ | 25/30 [00:03<00:00, 16.89it/s][1/6] extract embeddings:  93%|█████████▎| 28/30 [00:03<00:00, 18.59it/s][1/6] extract embeddings: 100%|██████████| 30/30 [00:03<00:00,  9.17it/s]
[NeMo I 2025-04-17 02:15:13 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:15:13 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:13 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:13 collections:880] Dataset successfully loaded with 1940 items and total duration provided from manifest is  0.39 hours.
[NeMo I 2025-04-17 02:15:13 collections:886] # 1940 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:40,  1.36s/it][2/6] extract embeddings:  13%|█▎        | 4/31 [00:01<00:07,  3.49it/s][2/6] extract embeddings:  26%|██▌       | 8/31 [00:01<00:03,  7.42it/s][2/6] extract embeddings:  35%|███▌      | 11/31 [00:01<00:01, 10.33it/s][2/6] extract embeddings:  45%|████▌     | 14/31 [00:01<00:01, 12.98it/s][2/6] extract embeddings:  55%|█████▍    | 17/31 [00:01<00:00, 15.31it/s][2/6] extract embeddings:  65%|██████▍   | 20/31 [00:02<00:00, 17.99it/s][2/6] extract embeddings:  74%|███████▍  | 23/31 [00:02<00:00, 18.43it/s][2/6] extract embeddings:  84%|████████▍ | 26/31 [00:02<00:00, 19.33it/s][2/6] extract embeddings:  94%|█████████▎| 29/31 [00:02<00:00, 21.15it/s][2/6] extract embeddings: 100%|██████████| 31/31 [00:02<00:00, 11.93it/s]
[NeMo I 2025-04-17 02:15:16 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:15:16 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:16 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:16 collections:880] Dataset successfully loaded with 2022 items and total duration provided from manifest is  0.41 hours.
[NeMo I 2025-04-17 02:15:16 collections:886] # 2022 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:34,  1.13s/it][3/6] extract embeddings:  12%|█▎        | 4/32 [00:01<00:07,  3.97it/s][3/6] extract embeddings:  22%|██▏       | 7/32 [00:01<00:03,  7.38it/s][3/6] extract embeddings:  31%|███▏      | 10/32 [00:01<00:02, 10.74it/s][3/6] extract embeddings:  41%|████      | 13/32 [00:01<00:01, 13.93it/s][3/6] extract embeddings:  50%|█████     | 16/32 [00:01<00:00, 16.26it/s][3/6] extract embeddings:  59%|█████▉    | 19/32 [00:01<00:00, 19.17it/s][3/6] extract embeddings:  69%|██████▉   | 22/32 [00:01<00:00, 21.16it/s][3/6] extract embeddings:  78%|███████▊  | 25/32 [00:02<00:00, 20.16it/s][3/6] extract embeddings:  88%|████████▊ | 28/32 [00:02<00:00, 20.17it/s][3/6] extract embeddings:  97%|█████████▋| 31/32 [00:02<00:00, 22.04it/s][3/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 13.22it/s]
[NeMo I 2025-04-17 02:15:19 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:15:19 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:19 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:19 collections:880] Dataset successfully loaded with 2205 items and total duration provided from manifest is  0.44 hours.
[NeMo I 2025-04-17 02:15:19 collections:886] # 2205 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/35 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/35 [00:01<00:38,  1.12s/it][4/6] extract embeddings:  14%|█▍        | 5/35 [00:01<00:05,  5.02it/s][4/6] extract embeddings:  26%|██▌       | 9/35 [00:01<00:02,  9.21it/s][4/6] extract embeddings:  34%|███▍      | 12/35 [00:01<00:01, 12.05it/s][4/6] extract embeddings:  43%|████▎     | 15/35 [00:01<00:01, 15.16it/s][4/6] extract embeddings:  51%|█████▏    | 18/35 [00:01<00:00, 17.91it/s][4/6] extract embeddings:  60%|██████    | 21/35 [00:01<00:00, 20.47it/s][4/6] extract embeddings:  69%|██████▊   | 24/35 [00:01<00:00, 22.33it/s][4/6] extract embeddings:  77%|███████▋  | 27/35 [00:02<00:00, 21.26it/s][4/6] extract embeddings:  86%|████████▌ | 30/35 [00:02<00:00, 20.06it/s][4/6] extract embeddings:  94%|█████████▍| 33/35 [00:02<00:00, 21.39it/s][4/6] extract embeddings: 100%|██████████| 35/35 [00:02<00:00, 14.08it/s]
[NeMo I 2025-04-17 02:15:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:15:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:21 collections:880] Dataset successfully loaded with 2731 items and total duration provided from manifest is  0.48 hours.
[NeMo I 2025-04-17 02:15:21 collections:886] # 2731 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/43 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/43 [00:01<00:46,  1.11s/it][5/6] extract embeddings:  12%|█▏        | 5/43 [00:01<00:07,  5.29it/s][5/6] extract embeddings:  19%|█▊        | 8/43 [00:01<00:04,  8.71it/s][5/6] extract embeddings:  26%|██▌       | 11/43 [00:01<00:02, 12.08it/s][5/6] extract embeddings:  33%|███▎      | 14/43 [00:01<00:01, 15.45it/s][5/6] extract embeddings:  42%|████▏     | 18/43 [00:01<00:01, 19.52it/s][5/6] extract embeddings:  51%|█████     | 22/43 [00:01<00:00, 22.79it/s][5/6] extract embeddings:  60%|██████    | 26/43 [00:01<00:00, 25.20it/s][5/6] extract embeddings:  70%|██████▉   | 30/43 [00:02<00:00, 26.63it/s][5/6] extract embeddings:  79%|███████▉  | 34/43 [00:02<00:00, 23.60it/s][5/6] extract embeddings:  86%|████████▌ | 37/43 [00:02<00:00, 23.06it/s][5/6] extract embeddings:  93%|█████████▎| 40/43 [00:02<00:00, 23.79it/s][5/6] extract embeddings: 100%|██████████| 43/43 [00:02<00:00, 16.32it/s]
[NeMo I 2025-04-17 02:15:24 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:15:24 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:24 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:24 collections:880] Dataset successfully loaded with 4802 items and total duration provided from manifest is  0.57 hours.
[NeMo I 2025-04-17 02:15:24 collections:886] # 4802 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/76 [00:00<?, ?it/s][6/6] extract embeddings:   1%|▏         | 1/76 [00:01<01:24,  1.12s/it][6/6] extract embeddings:   7%|▋         | 5/76 [00:01<00:13,  5.25it/s][6/6] extract embeddings:  12%|█▏        | 9/76 [00:01<00:06,  9.89it/s][6/6] extract embeddings:  17%|█▋        | 13/76 [00:01<00:04, 14.30it/s][6/6] extract embeddings:  22%|██▏       | 17/76 [00:01<00:03, 18.38it/s][6/6] extract embeddings:  28%|██▊       | 21/76 [00:01<00:02, 22.30it/s][6/6] extract embeddings:  33%|███▎      | 25/76 [00:01<00:01, 25.54it/s][6/6] extract embeddings:  38%|███▊      | 29/76 [00:01<00:01, 28.17it/s][6/6] extract embeddings:  43%|████▎     | 33/76 [00:02<00:01, 29.63it/s][6/6] extract embeddings:  49%|████▊     | 37/76 [00:02<00:01, 30.99it/s][6/6] extract embeddings:  54%|█████▍    | 41/76 [00:02<00:01, 31.23it/s][6/6] extract embeddings:  59%|█████▉    | 45/76 [00:02<00:00, 32.39it/s][6/6] extract embeddings:  64%|██████▍   | 49/76 [00:02<00:00, 31.04it/s][6/6] extract embeddings:  70%|██████▉   | 53/76 [00:02<00:00, 31.40it/s][6/6] extract embeddings:  75%|███████▌  | 57/76 [00:02<00:00, 30.31it/s][6/6] extract embeddings:  80%|████████  | 61/76 [00:02<00:00, 31.65it/s][6/6] extract embeddings:  86%|████████▌ | 65/76 [00:03<00:00, 32.67it/s][6/6] extract embeddings:  91%|█████████ | 69/76 [00:03<00:00, 33.98it/s][6/6] extract embeddings:  96%|█████████▌| 73/76 [00:03<00:00, 33.78it/s][6/6] extract embeddings: 100%|██████████| 76/76 [00:03<00:00, 22.59it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.18it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.80it/s]clustering:  75%|███████▌  | 3/4 [00:00<00:00,  3.27it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.78it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.36it/s]
[NeMo I 2025-04-17 02:15:29 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:15:30 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              74.056543   444.120  ...  10.289990  2.316939
    Harker-ES                       73.496911  2178.782  ...  28.307287  1.299225
    Harker-MN                       74.031658   366.767  ...  18.717025  5.103247
    Longfellow-Block-1              69.753282   492.417  ...  10.004988  2.031812
    TOTAL                           73.095211  3482.086  ...  67.319291  1.933304
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:15:30 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0210 | MISS: 0.6906 | CER: 0.0193 | DER: 0.7310 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.70
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.7 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.76s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:15:41 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:15:41 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:15:41 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:15:41 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:15:41 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:15:42 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:15:42 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:15:42 features:305] PADDING: 16
[NeMo I 2025-04-17 02:15:42 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:15:42 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:15:42 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:15:42 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:15:42 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:42 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:42 collections:880] Dataset successfully loaded with 1879 items and total duration provided from manifest is  0.36 hours.
[NeMo I 2025-04-17 02:15:42 collections:886] # 1879 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/30 [00:02<01:00,  2.08s/it][1/6] extract embeddings:  13%|█▎        | 4/30 [00:02<00:11,  2.35it/s][1/6] extract embeddings:  23%|██▎       | 7/30 [00:02<00:05,  4.55it/s][1/6] extract embeddings:  33%|███▎      | 10/30 [00:02<00:02,  7.06it/s][1/6] extract embeddings:  43%|████▎     | 13/30 [00:02<00:01,  9.71it/s][1/6] extract embeddings:  53%|█████▎    | 16/30 [00:02<00:01, 12.38it/s][1/6] extract embeddings:  63%|██████▎   | 19/30 [00:02<00:00, 14.93it/s][1/6] extract embeddings:  73%|███████▎  | 22/30 [00:02<00:00, 17.06it/s][1/6] extract embeddings:  83%|████████▎ | 25/30 [00:03<00:00, 18.73it/s][1/6] extract embeddings:  93%|█████████▎| 28/30 [00:03<00:00, 20.20it/s][1/6] extract embeddings: 100%|██████████| 30/30 [00:03<00:00,  9.20it/s]
[NeMo I 2025-04-17 02:15:46 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:15:46 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:46 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:46 collections:880] Dataset successfully loaded with 1912 items and total duration provided from manifest is  0.37 hours.
[NeMo I 2025-04-17 02:15:46 collections:886] # 1912 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/30 [00:01<00:40,  1.39s/it][2/6] extract embeddings:  13%|█▎        | 4/30 [00:01<00:07,  3.39it/s][2/6] extract embeddings:  23%|██▎       | 7/30 [00:01<00:03,  6.33it/s][2/6] extract embeddings:  33%|███▎      | 10/30 [00:01<00:02,  9.47it/s][2/6] extract embeddings:  43%|████▎     | 13/30 [00:01<00:01, 12.45it/s][2/6] extract embeddings:  53%|█████▎    | 16/30 [00:01<00:00, 15.49it/s][2/6] extract embeddings:  63%|██████▎   | 19/30 [00:02<00:00, 17.98it/s][2/6] extract embeddings:  73%|███████▎  | 22/30 [00:02<00:00, 20.46it/s][2/6] extract embeddings:  83%|████████▎ | 25/30 [00:02<00:00, 21.92it/s][2/6] extract embeddings:  93%|█████████▎| 28/30 [00:02<00:00, 23.36it/s][2/6] extract embeddings: 100%|██████████| 30/30 [00:02<00:00, 11.97it/s]
[NeMo I 2025-04-17 02:15:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:15:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:48 collections:880] Dataset successfully loaded with 1981 items and total duration provided from manifest is  0.39 hours.
[NeMo I 2025-04-17 02:15:48 collections:886] # 1981 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:34,  1.15s/it][3/6] extract embeddings:  13%|█▎        | 4/31 [00:01<00:06,  3.96it/s][3/6] extract embeddings:  23%|██▎       | 7/31 [00:01<00:03,  7.28it/s][3/6] extract embeddings:  32%|███▏      | 10/31 [00:01<00:01, 10.65it/s][3/6] extract embeddings:  42%|████▏     | 13/31 [00:01<00:01, 13.91it/s][3/6] extract embeddings:  52%|█████▏    | 16/31 [00:01<00:00, 17.01it/s][3/6] extract embeddings:  61%|██████▏   | 19/31 [00:01<00:00, 19.89it/s][3/6] extract embeddings:  71%|███████   | 22/31 [00:01<00:00, 21.82it/s][3/6] extract embeddings:  81%|████████  | 25/31 [00:02<00:00, 23.31it/s][3/6] extract embeddings:  90%|█████████ | 28/31 [00:02<00:00, 24.05it/s][3/6] extract embeddings: 100%|██████████| 31/31 [00:02<00:00, 23.22it/s][3/6] extract embeddings: 100%|██████████| 31/31 [00:02<00:00, 13.34it/s]
[NeMo I 2025-04-17 02:15:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:15:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:51 collections:880] Dataset successfully loaded with 2157 items and total duration provided from manifest is  0.41 hours.
[NeMo I 2025-04-17 02:15:51 collections:886] # 2157 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:37,  1.14s/it][4/6] extract embeddings:  15%|█▍        | 5/34 [00:01<00:05,  5.00it/s][4/6] extract embeddings:  24%|██▎       | 8/34 [00:01<00:03,  8.17it/s][4/6] extract embeddings:  32%|███▏      | 11/34 [00:01<00:02, 11.24it/s][4/6] extract embeddings:  44%|████▍     | 15/34 [00:01<00:01, 15.28it/s][4/6] extract embeddings:  53%|█████▎    | 18/34 [00:01<00:00, 18.01it/s][4/6] extract embeddings:  62%|██████▏   | 21/34 [00:01<00:00, 20.10it/s][4/6] extract embeddings:  71%|███████   | 24/34 [00:01<00:00, 22.07it/s][4/6] extract embeddings:  79%|███████▉  | 27/34 [00:02<00:00, 23.74it/s][4/6] extract embeddings:  88%|████████▊ | 30/34 [00:02<00:00, 24.29it/s][4/6] extract embeddings:  97%|█████████▋| 33/34 [00:02<00:00, 25.28it/s][4/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 14.32it/s]
[NeMo I 2025-04-17 02:15:54 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:15:54 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:54 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:54 collections:880] Dataset successfully loaded with 2639 items and total duration provided from manifest is  0.46 hours.
[NeMo I 2025-04-17 02:15:54 collections:886] # 2639 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/42 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▏         | 1/42 [00:01<00:46,  1.13s/it][5/6] extract embeddings:  12%|█▏        | 5/42 [00:01<00:07,  5.16it/s][5/6] extract embeddings:  21%|██▏       | 9/42 [00:01<00:03,  9.55it/s][5/6] extract embeddings:  29%|██▊       | 12/42 [00:01<00:02, 12.76it/s][5/6] extract embeddings:  36%|███▌      | 15/42 [00:01<00:01, 15.85it/s][5/6] extract embeddings:  45%|████▌     | 19/42 [00:01<00:01, 19.90it/s][5/6] extract embeddings:  55%|█████▍    | 23/42 [00:01<00:00, 23.22it/s][5/6] extract embeddings:  64%|██████▍   | 27/42 [00:01<00:00, 24.67it/s][5/6] extract embeddings:  74%|███████▍  | 31/42 [00:02<00:00, 26.82it/s][5/6] extract embeddings:  83%|████████▎ | 35/42 [00:02<00:00, 28.15it/s][5/6] extract embeddings:  93%|█████████▎| 39/42 [00:02<00:00, 29.05it/s][5/6] extract embeddings: 100%|██████████| 42/42 [00:02<00:00, 16.94it/s]
[NeMo I 2025-04-17 02:15:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:15:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:15:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:15:56 collections:880] Dataset successfully loaded with 4591 items and total duration provided from manifest is  0.54 hours.
[NeMo I 2025-04-17 02:15:56 collections:886] # 4591 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/72 [00:00<?, ?it/s][6/6] extract embeddings:   1%|▏         | 1/72 [00:01<01:20,  1.14s/it][6/6] extract embeddings:   7%|▋         | 5/72 [00:01<00:12,  5.20it/s][6/6] extract embeddings:  12%|█▎        | 9/72 [00:01<00:06,  9.64it/s][6/6] extract embeddings:  18%|█▊        | 13/72 [00:01<00:04, 14.02it/s][6/6] extract embeddings:  24%|██▎       | 17/72 [00:01<00:02, 18.44it/s][6/6] extract embeddings:  29%|██▉       | 21/72 [00:01<00:02, 22.34it/s][6/6] extract embeddings:  35%|███▍      | 25/72 [00:01<00:01, 24.17it/s][6/6] extract embeddings:  40%|████      | 29/72 [00:01<00:01, 26.17it/s][6/6] extract embeddings:  46%|████▌     | 33/72 [00:02<00:01, 28.09it/s][6/6] extract embeddings:  51%|█████▏    | 37/72 [00:02<00:01, 29.24it/s][6/6] extract embeddings:  57%|█████▋    | 41/72 [00:02<00:01, 30.68it/s][6/6] extract embeddings:  62%|██████▎   | 45/72 [00:02<00:00, 31.44it/s][6/6] extract embeddings:  68%|██████▊   | 49/72 [00:02<00:00, 31.47it/s][6/6] extract embeddings:  74%|███████▎  | 53/72 [00:02<00:00, 32.44it/s][6/6] extract embeddings:  79%|███████▉  | 57/72 [00:02<00:00, 32.31it/s][6/6] extract embeddings:  85%|████████▍ | 61/72 [00:02<00:00, 33.28it/s][6/6] extract embeddings:  90%|█████████ | 65/72 [00:03<00:00, 34.08it/s][6/6] extract embeddings:  96%|█████████▌| 69/72 [00:03<00:00, 34.28it/s][6/6] extract embeddings: 100%|██████████| 72/72 [00:03<00:00, 21.97it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.21it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.71it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.22it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.71it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s]
[NeMo I 2025-04-17 02:16:01 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:16:02 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              74.575550   444.120  ...   9.524966  2.144683
    Harker-ES                       75.181732  2178.782  ...  36.453218  1.673101
    Harker-MN                       75.569187   366.767  ...  19.576049  5.337462
    Longfellow-Block-1              71.088546   492.417  ...   9.078014  1.843562
    TOTAL                           74.566392  3482.086  ...  74.632247  2.143320
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:16:02 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0199 | MISS: 0.7043 | CER: 0.0214 | DER: 0.7457 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.70
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.7 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.74s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:16:14 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:16:14 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:16:14 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:16:14 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:16:14 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:16:15 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:16:15 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:16:15 features:305] PADDING: 16
[NeMo I 2025-04-17 02:16:15 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:16:15 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:16:15 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:16:15 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:16:15 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:15 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:15 collections:880] Dataset successfully loaded with 1837 items and total duration provided from manifest is  0.34 hours.
[NeMo I 2025-04-17 02:16:15 collections:886] # 1837 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/29 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/29 [00:02<00:57,  2.04s/it][1/6] extract embeddings:  14%|█▍        | 4/29 [00:02<00:10,  2.39it/s][1/6] extract embeddings:  24%|██▍       | 7/29 [00:02<00:04,  4.64it/s][1/6] extract embeddings:  34%|███▍      | 10/29 [00:02<00:02,  7.17it/s][1/6] extract embeddings:  45%|████▍     | 13/29 [00:02<00:01, 10.04it/s][1/6] extract embeddings:  55%|█████▌    | 16/29 [00:02<00:01, 12.62it/s][1/6] extract embeddings:  66%|██████▌   | 19/29 [00:02<00:00, 15.14it/s][1/6] extract embeddings:  76%|███████▌  | 22/29 [00:02<00:00, 17.91it/s][1/6] extract embeddings:  86%|████████▌ | 25/29 [00:02<00:00, 19.13it/s][1/6] extract embeddings:  97%|█████████▋| 28/29 [00:03<00:00, 21.23it/s][1/6] extract embeddings: 100%|██████████| 29/29 [00:03<00:00,  9.19it/s]
[NeMo I 2025-04-17 02:16:18 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:16:18 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:18 collections:880] Dataset successfully loaded with 1863 items and total duration provided from manifest is  0.35 hours.
[NeMo I 2025-04-17 02:16:18 collections:886] # 1863 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/30 [00:01<00:40,  1.41s/it][2/6] extract embeddings:  13%|█▎        | 4/30 [00:01<00:07,  3.37it/s][2/6] extract embeddings:  23%|██▎       | 7/30 [00:01<00:03,  6.30it/s][2/6] extract embeddings:  33%|███▎      | 10/30 [00:01<00:02,  9.18it/s][2/6] extract embeddings:  47%|████▋     | 14/30 [00:01<00:01, 13.57it/s][2/6] extract embeddings:  57%|█████▋    | 17/30 [00:02<00:00, 15.75it/s][2/6] extract embeddings:  67%|██████▋   | 20/30 [00:02<00:00, 18.13it/s][2/6] extract embeddings:  77%|███████▋  | 23/30 [00:02<00:00, 19.40it/s][2/6] extract embeddings:  87%|████████▋ | 26/30 [00:02<00:00, 20.76it/s][2/6] extract embeddings:  97%|█████████▋| 29/30 [00:02<00:00, 22.77it/s][2/6] extract embeddings: 100%|██████████| 30/30 [00:02<00:00, 11.66it/s]
[NeMo I 2025-04-17 02:16:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:16:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:21 collections:880] Dataset successfully loaded with 1920 items and total duration provided from manifest is  0.36 hours.
[NeMo I 2025-04-17 02:16:21 collections:886] # 1920 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/30 [00:01<00:34,  1.17s/it][3/6] extract embeddings:  13%|█▎        | 4/30 [00:01<00:06,  3.97it/s][3/6] extract embeddings:  23%|██▎       | 7/30 [00:01<00:03,  7.39it/s][3/6] extract embeddings:  33%|███▎      | 10/30 [00:01<00:01, 10.58it/s][3/6] extract embeddings:  43%|████▎     | 13/30 [00:01<00:01, 13.86it/s][3/6] extract embeddings:  53%|█████▎    | 16/30 [00:01<00:00, 16.57it/s][3/6] extract embeddings:  67%|██████▋   | 20/30 [00:01<00:00, 20.27it/s][3/6] extract embeddings:  77%|███████▋  | 23/30 [00:01<00:00, 22.44it/s][3/6] extract embeddings:  87%|████████▋ | 26/30 [00:02<00:00, 23.62it/s][3/6] extract embeddings:  97%|█████████▋| 29/30 [00:02<00:00, 24.88it/s][3/6] extract embeddings: 100%|██████████| 30/30 [00:02<00:00, 13.30it/s]
[NeMo I 2025-04-17 02:16:24 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:16:24 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:24 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:24 collections:880] Dataset successfully loaded with 2077 items and total duration provided from manifest is  0.38 hours.
[NeMo I 2025-04-17 02:16:24 collections:886] # 2077 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/33 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/33 [00:01<00:36,  1.14s/it][4/6] extract embeddings:  15%|█▌        | 5/33 [00:01<00:05,  5.01it/s][4/6] extract embeddings:  24%|██▍       | 8/33 [00:01<00:03,  8.19it/s][4/6] extract embeddings:  33%|███▎      | 11/33 [00:01<00:01, 11.46it/s][4/6] extract embeddings:  45%|████▌     | 15/33 [00:01<00:01, 15.83it/s][4/6] extract embeddings:  58%|█████▊    | 19/33 [00:01<00:00, 19.10it/s][4/6] extract embeddings:  67%|██████▋   | 22/33 [00:01<00:00, 20.79it/s][4/6] extract embeddings:  76%|███████▌  | 25/33 [00:01<00:00, 22.66it/s][4/6] extract embeddings:  85%|████████▍ | 28/33 [00:02<00:00, 24.20it/s][4/6] extract embeddings:  94%|█████████▍| 31/33 [00:02<00:00, 25.40it/s][4/6] extract embeddings: 100%|██████████| 33/33 [00:02<00:00, 14.50it/s]
[NeMo I 2025-04-17 02:16:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:16:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:26 collections:880] Dataset successfully loaded with 2510 items and total duration provided from manifest is  0.42 hours.
[NeMo I 2025-04-17 02:16:26 collections:886] # 2510 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/40 [00:00<?, ?it/s][5/6] extract embeddings:   2%|▎         | 1/40 [00:01<00:43,  1.12s/it][5/6] extract embeddings:  12%|█▎        | 5/40 [00:01<00:06,  5.17it/s][5/6] extract embeddings:  20%|██        | 8/40 [00:01<00:03,  8.54it/s][5/6] extract embeddings:  28%|██▊       | 11/40 [00:01<00:02, 11.95it/s][5/6] extract embeddings:  35%|███▌      | 14/40 [00:01<00:01, 15.10it/s][5/6] extract embeddings:  45%|████▌     | 18/40 [00:01<00:01, 19.28it/s][5/6] extract embeddings:  55%|█████▌    | 22/40 [00:01<00:00, 22.55it/s][5/6] extract embeddings:  62%|██████▎   | 25/40 [00:01<00:00, 24.16it/s][5/6] extract embeddings:  70%|███████   | 28/40 [00:02<00:00, 24.70it/s][5/6] extract embeddings:  78%|███████▊  | 31/40 [00:02<00:00, 25.81it/s][5/6] extract embeddings:  88%|████████▊ | 35/40 [00:02<00:00, 27.49it/s][5/6] extract embeddings:  95%|█████████▌| 38/40 [00:02<00:00, 27.68it/s][5/6] extract embeddings: 100%|██████████| 40/40 [00:02<00:00, 16.38it/s]
[NeMo I 2025-04-17 02:16:29 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:16:29 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:29 collections:880] Dataset successfully loaded with 4317 items and total duration provided from manifest is  0.50 hours.
[NeMo I 2025-04-17 02:16:29 collections:886] # 4317 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/68 [00:00<?, ?it/s][6/6] extract embeddings:   1%|▏         | 1/68 [00:01<01:15,  1.13s/it][6/6] extract embeddings:   7%|▋         | 5/68 [00:01<00:12,  5.21it/s][6/6] extract embeddings:  13%|█▎        | 9/68 [00:01<00:06,  9.69it/s][6/6] extract embeddings:  18%|█▊        | 12/68 [00:01<00:04, 12.83it/s][6/6] extract embeddings:  24%|██▎       | 16/68 [00:01<00:03, 17.21it/s][6/6] extract embeddings:  29%|██▉       | 20/68 [00:01<00:02, 21.21it/s][6/6] extract embeddings:  35%|███▌      | 24/68 [00:01<00:01, 24.68it/s][6/6] extract embeddings:  41%|████      | 28/68 [00:01<00:01, 25.74it/s][6/6] extract embeddings:  47%|████▋     | 32/68 [00:02<00:01, 28.39it/s][6/6] extract embeddings:  53%|█████▎    | 36/68 [00:02<00:01, 30.84it/s][6/6] extract embeddings:  59%|█████▉    | 40/68 [00:02<00:00, 31.49it/s][6/6] extract embeddings:  65%|██████▍   | 44/68 [00:02<00:00, 31.35it/s][6/6] extract embeddings:  71%|███████   | 48/68 [00:02<00:00, 32.40it/s][6/6] extract embeddings:  76%|███████▋  | 52/68 [00:02<00:00, 33.18it/s][6/6] extract embeddings:  82%|████████▏ | 56/68 [00:02<00:00, 33.38it/s][6/6] extract embeddings:  88%|████████▊ | 60/68 [00:02<00:00, 34.05it/s][6/6] extract embeddings:  94%|█████████▍| 64/68 [00:02<00:00, 34.18it/s][6/6] extract embeddings: 100%|██████████| 68/68 [00:03<00:00, 35.35it/s][6/6] extract embeddings: 100%|██████████| 68/68 [00:03<00:00, 21.71it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.22it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.81it/s]clustering:  75%|███████▌  | 3/4 [00:00<00:00,  3.38it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.97it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.48it/s]
[NeMo I 2025-04-17 02:16:33 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:16:34 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              74.659966   444.120  ...   5.750008  1.294697
    Harker-ES                       76.457696  2178.782  ...  26.292802  1.206766
    Harker-MN                       76.461911   366.767  ...  18.143021  4.946743
    Longfellow-Block-1              73.298075   492.417  ...  12.740014  2.587241
    TOTAL                           75.782034  3482.086  ...  62.925844  1.807131
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:16:34 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0186 | MISS: 0.7212 | CER: 0.0181 | DER: 0.7578 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.70
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.7 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.80s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.91s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.11it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.15s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:16:46 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:16:46 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:16:46 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:16:46 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:16:46 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:16:46 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:16:46 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:16:46 features:305] PADDING: 16
[NeMo I 2025-04-17 02:16:47 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:16:47 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:16:47 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:16:47 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:16:47 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:47 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:47 collections:880] Dataset successfully loaded with 1781 items and total duration provided from manifest is  0.31 hours.
[NeMo I 2025-04-17 02:16:47 collections:886] # 1781 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/28 [00:00<?, ?it/s][1/6] extract embeddings:   4%|▎         | 1/28 [00:01<00:52,  1.94s/it][1/6] extract embeddings:  14%|█▍        | 4/28 [00:02<00:09,  2.50it/s][1/6] extract embeddings:  25%|██▌       | 7/28 [00:02<00:04,  4.86it/s][1/6] extract embeddings:  36%|███▌      | 10/28 [00:02<00:02,  7.43it/s][1/6] extract embeddings:  46%|████▋     | 13/28 [00:02<00:01, 10.27it/s][1/6] extract embeddings:  57%|█████▋    | 16/28 [00:02<00:00, 12.90it/s][1/6] extract embeddings:  68%|██████▊   | 19/28 [00:02<00:00, 15.86it/s][1/6] extract embeddings:  79%|███████▊  | 22/28 [00:02<00:00, 18.12it/s][1/6] extract embeddings:  89%|████████▉ | 25/28 [00:02<00:00, 19.87it/s][1/6] extract embeddings: 100%|██████████| 28/28 [00:02<00:00, 22.15it/s][1/6] extract embeddings: 100%|██████████| 28/28 [00:03<00:00,  9.31it/s]
[NeMo I 2025-04-17 02:16:50 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:16:50 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:50 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:50 collections:880] Dataset successfully loaded with 1799 items and total duration provided from manifest is  0.31 hours.
[NeMo I 2025-04-17 02:16:50 collections:886] # 1799 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/29 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/29 [00:01<00:37,  1.34s/it][2/6] extract embeddings:  14%|█▍        | 4/29 [00:01<00:07,  3.53it/s][2/6] extract embeddings:  24%|██▍       | 7/29 [00:01<00:03,  6.65it/s][2/6] extract embeddings:  34%|███▍      | 10/29 [00:01<00:01,  9.75it/s][2/6] extract embeddings:  45%|████▍     | 13/29 [00:01<00:01, 13.10it/s][2/6] extract embeddings:  55%|█████▌    | 16/29 [00:01<00:00, 15.76it/s][2/6] extract embeddings:  66%|██████▌   | 19/29 [00:02<00:00, 18.15it/s][2/6] extract embeddings:  79%|███████▉  | 23/29 [00:02<00:00, 21.27it/s][2/6] extract embeddings:  90%|████████▉ | 26/29 [00:02<00:00, 22.37it/s][2/6] extract embeddings: 100%|██████████| 29/29 [00:02<00:00, 24.01it/s][2/6] extract embeddings: 100%|██████████| 29/29 [00:02<00:00, 12.03it/s]
[NeMo I 2025-04-17 02:16:52 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:16:52 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:52 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:52 collections:880] Dataset successfully loaded with 1850 items and total duration provided from manifest is  0.32 hours.
[NeMo I 2025-04-17 02:16:52 collections:886] # 1850 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/29 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/29 [00:01<00:31,  1.12s/it][3/6] extract embeddings:  14%|█▍        | 4/29 [00:01<00:06,  4.05it/s][3/6] extract embeddings:  24%|██▍       | 7/29 [00:01<00:02,  7.53it/s][3/6] extract embeddings:  34%|███▍      | 10/29 [00:01<00:01, 11.00it/s][3/6] extract embeddings:  48%|████▊     | 14/29 [00:01<00:00, 15.26it/s][3/6] extract embeddings:  62%|██████▏   | 18/29 [00:01<00:00, 18.83it/s][3/6] extract embeddings:  72%|███████▏  | 21/29 [00:01<00:00, 20.46it/s][3/6] extract embeddings:  83%|████████▎ | 24/29 [00:01<00:00, 22.20it/s][3/6] extract embeddings:  97%|█████████▋| 28/29 [00:02<00:00, 24.85it/s][3/6] extract embeddings: 100%|██████████| 29/29 [00:02<00:00, 13.48it/s]
[NeMo I 2025-04-17 02:16:55 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:16:55 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:55 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:55 collections:880] Dataset successfully loaded with 1985 items and total duration provided from manifest is  0.35 hours.
[NeMo I 2025-04-17 02:16:55 collections:886] # 1985 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:34,  1.12s/it][4/6] extract embeddings:  16%|█▌        | 5/32 [00:01<00:05,  5.14it/s][4/6] extract embeddings:  25%|██▌       | 8/32 [00:01<00:02,  8.34it/s][4/6] extract embeddings:  34%|███▍      | 11/32 [00:01<00:01, 11.66it/s][4/6] extract embeddings:  44%|████▍     | 14/32 [00:01<00:01, 14.91it/s][4/6] extract embeddings:  53%|█████▎    | 17/32 [00:01<00:00, 17.64it/s][4/6] extract embeddings:  66%|██████▌   | 21/32 [00:01<00:00, 21.31it/s][4/6] extract embeddings:  75%|███████▌  | 24/32 [00:01<00:00, 23.20it/s][4/6] extract embeddings:  84%|████████▍ | 27/32 [00:02<00:00, 24.76it/s][4/6] extract embeddings:  94%|█████████▍| 30/32 [00:02<00:00, 25.73it/s][4/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 14.26it/s]
[NeMo I 2025-04-17 02:16:57 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:16:57 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:16:57 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:16:57 collections:880] Dataset successfully loaded with 2346 items and total duration provided from manifest is  0.38 hours.
[NeMo I 2025-04-17 02:16:57 collections:886] # 2346 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/37 [00:00<?, ?it/s][5/6] extract embeddings:   3%|▎         | 1/37 [00:01<00:40,  1.12s/it][5/6] extract embeddings:  11%|█         | 4/37 [00:01<00:07,  4.18it/s][5/6] extract embeddings:  19%|█▉        | 7/37 [00:01<00:03,  7.71it/s][5/6] extract embeddings:  30%|██▉       | 11/37 [00:01<00:02, 12.37it/s][5/6] extract embeddings:  41%|████      | 15/37 [00:01<00:01, 16.52it/s][5/6] extract embeddings:  51%|█████▏    | 19/37 [00:01<00:00, 19.81it/s][5/6] extract embeddings:  62%|██████▏   | 23/37 [00:01<00:00, 23.47it/s][5/6] extract embeddings:  73%|███████▎  | 27/37 [00:01<00:00, 24.95it/s][5/6] extract embeddings:  84%|████████▍ | 31/37 [00:02<00:00, 26.44it/s][5/6] extract embeddings:  95%|█████████▍| 35/37 [00:02<00:00, 27.29it/s][5/6] extract embeddings: 100%|██████████| 37/37 [00:02<00:00, 15.95it/s]
[NeMo I 2025-04-17 02:16:59 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:17:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:00 collections:880] Dataset successfully loaded with 3943 items and total duration provided from manifest is  0.45 hours.
[NeMo I 2025-04-17 02:17:00 collections:886] # 3943 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/62 [00:00<?, ?it/s][6/6] extract embeddings:   2%|▏         | 1/62 [00:01<01:07,  1.11s/it][6/6] extract embeddings:   8%|▊         | 5/62 [00:01<00:10,  5.37it/s][6/6] extract embeddings:  13%|█▎        | 8/62 [00:01<00:06,  8.77it/s][6/6] extract embeddings:  19%|█▉        | 12/62 [00:01<00:03, 13.57it/s][6/6] extract embeddings:  26%|██▌       | 16/62 [00:01<00:02, 18.14it/s][6/6] extract embeddings:  32%|███▏      | 20/62 [00:01<00:01, 22.02it/s][6/6] extract embeddings:  39%|███▊      | 24/62 [00:01<00:01, 24.92it/s][6/6] extract embeddings:  45%|████▌     | 28/62 [00:01<00:01, 27.02it/s][6/6] extract embeddings:  52%|█████▏    | 32/62 [00:02<00:01, 28.96it/s][6/6] extract embeddings:  58%|█████▊    | 36/62 [00:02<00:00, 29.34it/s][6/6] extract embeddings:  65%|██████▍   | 40/62 [00:02<00:00, 31.31it/s][6/6] extract embeddings:  71%|███████   | 44/62 [00:02<00:00, 31.96it/s][6/6] extract embeddings:  77%|███████▋  | 48/62 [00:02<00:00, 32.69it/s][6/6] extract embeddings:  84%|████████▍ | 52/62 [00:02<00:00, 33.13it/s][6/6] extract embeddings:  90%|█████████ | 56/62 [00:02<00:00, 33.96it/s][6/6] extract embeddings:  97%|█████████▋| 60/62 [00:02<00:00, 33.89it/s][6/6] extract embeddings: 100%|██████████| 62/62 [00:02<00:00, 21.15it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.22it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.94it/s]clustering:  75%|███████▌  | 3/4 [00:00<00:00,  3.55it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  4.17it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.63it/s]
[NeMo I 2025-04-17 02:17:04 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:17:05 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              77.028661   444.120  ...   6.299987  1.418533
    Harker-ES                       78.721077  2178.782  ...  25.749382  1.181825
    Harker-MN                       77.458165   366.767  ...  17.630064  4.806884
    Longfellow-Block-1              75.127011   492.417  ...   7.979011  1.620377
    TOTAL                           77.863945  3482.086  ...  57.658444  1.655859
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:17:05 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0166 | MISS: 0.7455 | CER: 0.0166 | DER: 0.7786 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.80, offset=0.75
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.8, <class 'float'> offset=0.75 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.74s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.88s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:17:16 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:17:16 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:17:16 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:17:16 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:17:16 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:17:16 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:17:16 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:17:16 features:305] PADDING: 16
[NeMo I 2025-04-17 02:17:17 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:17:17 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:17:17 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:17:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:17:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:17 collections:880] Dataset successfully loaded with 1802 items and total duration provided from manifest is  0.31 hours.
[NeMo I 2025-04-17 02:17:17 collections:886] # 1802 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/29 [00:00<?, ?it/s][1/6] extract embeddings:   3%|▎         | 1/29 [00:01<00:54,  1.96s/it][1/6] extract embeddings:  14%|█▍        | 4/29 [00:02<00:10,  2.49it/s][1/6] extract embeddings:  24%|██▍       | 7/29 [00:02<00:04,  4.77it/s][1/6] extract embeddings:  34%|███▍      | 10/29 [00:02<00:02,  7.39it/s][1/6] extract embeddings:  45%|████▍     | 13/29 [00:02<00:01, 10.12it/s][1/6] extract embeddings:  55%|█████▌    | 16/29 [00:02<00:01, 12.90it/s][1/6] extract embeddings:  66%|██████▌   | 19/29 [00:02<00:00, 15.64it/s][1/6] extract embeddings:  76%|███████▌  | 22/29 [00:02<00:00, 17.62it/s][1/6] extract embeddings:  86%|████████▌ | 25/29 [00:02<00:00, 20.15it/s][1/6] extract embeddings:  97%|█████████▋| 28/29 [00:03<00:00, 22.07it/s][1/6] extract embeddings: 100%|██████████| 29/29 [00:03<00:00,  9.41it/s]
[NeMo I 2025-04-17 02:17:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:17:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:20 collections:880] Dataset successfully loaded with 1823 items and total duration provided from manifest is  0.31 hours.
[NeMo I 2025-04-17 02:17:20 collections:886] # 1823 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/29 [00:00<?, ?it/s][2/6] extract embeddings:   3%|▎         | 1/29 [00:01<00:38,  1.37s/it][2/6] extract embeddings:  14%|█▍        | 4/29 [00:01<00:07,  3.44it/s][2/6] extract embeddings:  24%|██▍       | 7/29 [00:01<00:03,  6.49it/s][2/6] extract embeddings:  34%|███▍      | 10/29 [00:01<00:01,  9.66it/s][2/6] extract embeddings:  48%|████▊     | 14/29 [00:01<00:01, 13.90it/s][2/6] extract embeddings:  62%|██████▏   | 18/29 [00:01<00:00, 17.59it/s][2/6] extract embeddings:  76%|███████▌  | 22/29 [00:02<00:00, 20.60it/s][2/6] extract embeddings:  86%|████████▌ | 25/29 [00:02<00:00, 22.52it/s][2/6] extract embeddings: 100%|██████████| 29/29 [00:02<00:00, 25.44it/s][2/6] extract embeddings: 100%|██████████| 29/29 [00:02<00:00, 12.24it/s]
[NeMo I 2025-04-17 02:17:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:17:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:23 collections:880] Dataset successfully loaded with 1870 items and total duration provided from manifest is  0.32 hours.
[NeMo I 2025-04-17 02:17:23 collections:886] # 1870 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/30 [00:01<00:32,  1.11s/it][3/6] extract embeddings:  13%|█▎        | 4/30 [00:01<00:06,  4.19it/s][3/6] extract embeddings:  23%|██▎       | 7/30 [00:01<00:02,  7.78it/s][3/6] extract embeddings:  33%|███▎      | 10/30 [00:01<00:01, 11.20it/s][3/6] extract embeddings:  43%|████▎     | 13/30 [00:01<00:01, 14.40it/s][3/6] extract embeddings:  53%|█████▎    | 16/30 [00:01<00:00, 17.07it/s][3/6] extract embeddings:  63%|██████▎   | 19/30 [00:01<00:00, 19.90it/s][3/6] extract embeddings:  77%|███████▋  | 23/30 [00:01<00:00, 22.49it/s][3/6] extract embeddings:  87%|████████▋ | 26/30 [00:02<00:00, 24.04it/s][3/6] extract embeddings:  97%|█████████▋| 29/30 [00:02<00:00, 25.30it/s][3/6] extract embeddings: 100%|██████████| 30/30 [00:02<00:00, 13.84it/s]
[NeMo I 2025-04-17 02:17:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:17:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:25 collections:880] Dataset successfully loaded with 1999 items and total duration provided from manifest is  0.34 hours.
[NeMo I 2025-04-17 02:17:25 collections:886] # 1999 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:34,  1.12s/it][4/6] extract embeddings:  12%|█▎        | 4/32 [00:01<00:06,  4.17it/s][4/6] extract embeddings:  22%|██▏       | 7/32 [00:01<00:03,  7.70it/s][4/6] extract embeddings:  34%|███▍      | 11/32 [00:01<00:01, 12.27it/s][4/6] extract embeddings:  47%|████▋     | 15/32 [00:01<00:01, 16.33it/s][4/6] extract embeddings:  59%|█████▉    | 19/32 [00:01<00:00, 19.85it/s][4/6] extract embeddings:  72%|███████▏  | 23/32 [00:01<00:00, 22.92it/s][4/6] extract embeddings:  81%|████████▏ | 26/32 [00:01<00:00, 23.59it/s][4/6] extract embeddings:  91%|█████████ | 29/32 [00:02<00:00, 25.07it/s][4/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 14.56it/s]
[NeMo I 2025-04-17 02:17:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:17:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:27 collections:880] Dataset successfully loaded with 2370 items and total duration provided from manifest is  0.38 hours.
[NeMo I 2025-04-17 02:17:27 collections:886] # 2370 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/38 [00:00<?, ?it/s][5/6] extract embeddings:   3%|▎         | 1/38 [00:01<00:41,  1.13s/it][5/6] extract embeddings:  13%|█▎        | 5/38 [00:01<00:06,  5.21it/s][5/6] extract embeddings:  24%|██▎       | 9/38 [00:01<00:03,  9.57it/s][5/6] extract embeddings:  34%|███▍      | 13/38 [00:01<00:01, 13.80it/s][5/6] extract embeddings:  42%|████▏     | 16/38 [00:01<00:01, 16.62it/s][5/6] extract embeddings:  53%|█████▎    | 20/38 [00:01<00:00, 20.60it/s][5/6] extract embeddings:  63%|██████▎   | 24/38 [00:01<00:00, 23.79it/s][5/6] extract embeddings:  74%|███████▎  | 28/38 [00:01<00:00, 25.55it/s][5/6] extract embeddings:  84%|████████▍ | 32/38 [00:02<00:00, 25.94it/s][5/6] extract embeddings:  92%|█████████▏| 35/38 [00:02<00:00, 26.52it/s][5/6] extract embeddings: 100%|██████████| 38/38 [00:02<00:00, 16.18it/s]
[NeMo I 2025-04-17 02:17:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:17:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:30 collections:880] Dataset successfully loaded with 3978 items and total duration provided from manifest is  0.45 hours.
[NeMo I 2025-04-17 02:17:30 collections:886] # 3978 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/63 [00:00<?, ?it/s][6/6] extract embeddings:   2%|▏         | 1/63 [00:01<01:09,  1.12s/it][6/6] extract embeddings:   8%|▊         | 5/63 [00:01<00:11,  5.22it/s][6/6] extract embeddings:  14%|█▍        | 9/63 [00:01<00:05,  9.77it/s][6/6] extract embeddings:  21%|██        | 13/63 [00:01<00:03, 13.88it/s][6/6] extract embeddings:  27%|██▋       | 17/63 [00:01<00:02, 18.04it/s][6/6] extract embeddings:  33%|███▎      | 21/63 [00:01<00:01, 21.61it/s][6/6] extract embeddings:  40%|███▉      | 25/63 [00:01<00:01, 24.69it/s][6/6] extract embeddings:  46%|████▌     | 29/63 [00:01<00:01, 26.94it/s][6/6] extract embeddings:  52%|█████▏    | 33/63 [00:02<00:01, 28.71it/s][6/6] extract embeddings:  59%|█████▊    | 37/63 [00:02<00:00, 30.90it/s][6/6] extract embeddings:  65%|██████▌   | 41/63 [00:02<00:00, 31.93it/s][6/6] extract embeddings:  71%|███████▏  | 45/63 [00:02<00:00, 31.77it/s][6/6] extract embeddings:  78%|███████▊  | 49/63 [00:02<00:00, 30.79it/s][6/6] extract embeddings:  84%|████████▍ | 53/63 [00:02<00:00, 31.40it/s][6/6] extract embeddings:  90%|█████████ | 57/63 [00:02<00:00, 31.65it/s][6/6] extract embeddings:  97%|█████████▋| 61/63 [00:02<00:00, 32.10it/s][6/6] extract embeddings: 100%|██████████| 63/63 [00:03<00:00, 20.89it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.19it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.90it/s]clustering:  75%|███████▌  | 3/4 [00:00<00:00,  3.54it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  4.17it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.62it/s]
[NeMo I 2025-04-17 02:17:34 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:17:35 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              76.765206   444.120  ...   6.019987  1.355487
    Harker-ES                       78.461388  2178.782  ...  24.225390  1.111878
    Harker-MN                       79.259026   366.767  ...  18.897201  5.152372
    Longfellow-Block-1              74.663116   492.417  ...   9.694022  1.968661
    TOTAL                           77.791935  3482.086  ...  58.836601  1.689694
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:17:35 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0171 | MISS: 0.7439 | CER: 0.0169 | DER: 0.7779 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.75
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.75 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.75s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.89s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:17:47 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:17:47 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:17:47 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:17:47 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:17:47 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:17:47 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:17:47 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:17:47 features:305] PADDING: 16
[NeMo I 2025-04-17 02:17:48 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:17:48 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:17:48 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:17:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:17:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:48 collections:880] Dataset successfully loaded with 1767 items and total duration provided from manifest is  0.29 hours.
[NeMo I 2025-04-17 02:17:48 collections:886] # 1767 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/28 [00:00<?, ?it/s][1/6] extract embeddings:   4%|▎         | 1/28 [00:01<00:51,  1.92s/it][1/6] extract embeddings:  14%|█▍        | 4/28 [00:02<00:09,  2.53it/s][1/6] extract embeddings:  25%|██▌       | 7/28 [00:02<00:04,  4.91it/s][1/6] extract embeddings:  36%|███▌      | 10/28 [00:02<00:02,  7.53it/s][1/6] extract embeddings:  46%|████▋     | 13/28 [00:02<00:01, 10.35it/s][1/6] extract embeddings:  57%|█████▋    | 16/28 [00:02<00:00, 13.24it/s][1/6] extract embeddings:  68%|██████▊   | 19/28 [00:02<00:00, 16.09it/s][1/6] extract embeddings:  79%|███████▊  | 22/28 [00:02<00:00, 18.41it/s][1/6] extract embeddings:  89%|████████▉ | 25/28 [00:02<00:00, 20.47it/s][1/6] extract embeddings: 100%|██████████| 28/28 [00:02<00:00,  9.47it/s]
[NeMo I 2025-04-17 02:17:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:17:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:51 collections:880] Dataset successfully loaded with 1784 items and total duration provided from manifest is  0.30 hours.
[NeMo I 2025-04-17 02:17:51 collections:886] # 1784 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/28 [00:00<?, ?it/s][2/6] extract embeddings:   4%|▎         | 1/28 [00:01<00:36,  1.36s/it][2/6] extract embeddings:  14%|█▍        | 4/28 [00:01<00:06,  3.49it/s][2/6] extract embeddings:  25%|██▌       | 7/28 [00:01<00:03,  6.61it/s][2/6] extract embeddings:  36%|███▌      | 10/28 [00:01<00:01,  9.76it/s][2/6] extract embeddings:  46%|████▋     | 13/28 [00:01<00:01, 12.99it/s][2/6] extract embeddings:  57%|█████▋    | 16/28 [00:01<00:00, 16.25it/s][2/6] extract embeddings:  68%|██████▊   | 19/28 [00:02<00:00, 18.96it/s][2/6] extract embeddings:  82%|████████▏ | 23/28 [00:02<00:00, 21.74it/s][2/6] extract embeddings:  93%|█████████▎| 26/28 [00:02<00:00, 23.15it/s][2/6] extract embeddings: 100%|██████████| 28/28 [00:02<00:00, 11.88it/s]
[NeMo I 2025-04-17 02:17:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:17:53 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:53 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:53 collections:880] Dataset successfully loaded with 1824 items and total duration provided from manifest is  0.31 hours.
[NeMo I 2025-04-17 02:17:53 collections:886] # 1824 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/29 [00:00<?, ?it/s][3/6] extract embeddings:   3%|▎         | 1/29 [00:01<00:31,  1.13s/it][3/6] extract embeddings:  14%|█▍        | 4/29 [00:01<00:06,  4.12it/s][3/6] extract embeddings:  24%|██▍       | 7/29 [00:01<00:02,  7.62it/s][3/6] extract embeddings:  34%|███▍      | 10/29 [00:01<00:01, 11.15it/s][3/6] extract embeddings:  45%|████▍     | 13/29 [00:01<00:01, 14.54it/s][3/6] extract embeddings:  55%|█████▌    | 16/29 [00:01<00:00, 17.34it/s][3/6] extract embeddings:  66%|██████▌   | 19/29 [00:01<00:00, 19.99it/s][3/6] extract embeddings:  79%|███████▉  | 23/29 [00:01<00:00, 23.29it/s][3/6] extract embeddings:  90%|████████▉ | 26/29 [00:02<00:00, 24.40it/s][3/6] extract embeddings: 100%|██████████| 29/29 [00:02<00:00, 13.55it/s]
[NeMo I 2025-04-17 02:17:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:17:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:56 collections:880] Dataset successfully loaded with 1937 items and total duration provided from manifest is  0.32 hours.
[NeMo I 2025-04-17 02:17:56 collections:886] # 1937 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/31 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/31 [00:01<00:33,  1.13s/it][4/6] extract embeddings:  13%|█▎        | 4/31 [00:01<00:06,  4.08it/s][4/6] extract embeddings:  26%|██▌       | 8/31 [00:01<00:02,  8.74it/s][4/6] extract embeddings:  35%|███▌      | 11/31 [00:01<00:01, 11.80it/s][4/6] extract embeddings:  45%|████▌     | 14/31 [00:01<00:01, 15.04it/s][4/6] extract embeddings:  58%|█████▊    | 18/31 [00:01<00:00, 18.59it/s][4/6] extract embeddings:  71%|███████   | 22/31 [00:01<00:00, 21.77it/s][4/6] extract embeddings:  84%|████████▍ | 26/31 [00:01<00:00, 24.19it/s][4/6] extract embeddings:  94%|█████████▎| 29/31 [00:02<00:00, 25.29it/s][4/6] extract embeddings: 100%|██████████| 31/31 [00:02<00:00, 14.30it/s]
[NeMo I 2025-04-17 02:17:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:17:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:17:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:17:58 collections:880] Dataset successfully loaded with 2275 items and total duration provided from manifest is  0.36 hours.
[NeMo I 2025-04-17 02:17:58 collections:886] # 2275 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/36 [00:00<?, ?it/s][5/6] extract embeddings:   3%|▎         | 1/36 [00:01<00:38,  1.11s/it][5/6] extract embeddings:  14%|█▍        | 5/36 [00:01<00:06,  5.16it/s][5/6] extract embeddings:  25%|██▌       | 9/36 [00:01<00:02,  9.57it/s][5/6] extract embeddings:  36%|███▌      | 13/36 [00:01<00:01, 13.64it/s][5/6] extract embeddings:  44%|████▍     | 16/36 [00:01<00:01, 16.49it/s][5/6] extract embeddings:  56%|█████▌    | 20/36 [00:01<00:00, 20.23it/s][5/6] extract embeddings:  67%|██████▋   | 24/36 [00:01<00:00, 23.10it/s][5/6] extract embeddings:  75%|███████▌  | 27/36 [00:01<00:00, 24.64it/s][5/6] extract embeddings:  86%|████████▌ | 31/36 [00:02<00:00, 26.53it/s][5/6] extract embeddings:  97%|█████████▋| 35/36 [00:02<00:00, 26.95it/s][5/6] extract embeddings: 100%|██████████| 36/36 [00:02<00:00, 15.75it/s]
[NeMo I 2025-04-17 02:18:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:18:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:00 collections:880] Dataset successfully loaded with 3780 items and total duration provided from manifest is  0.43 hours.
[NeMo I 2025-04-17 02:18:00 collections:886] # 3780 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/60 [00:00<?, ?it/s][6/6] extract embeddings:   2%|▏         | 1/60 [00:01<01:08,  1.15s/it][6/6] extract embeddings:   8%|▊         | 5/60 [00:01<00:10,  5.14it/s][6/6] extract embeddings:  13%|█▎        | 8/60 [00:01<00:07,  6.56it/s][6/6] extract embeddings:  22%|██▏       | 13/60 [00:01<00:03, 11.87it/s][6/6] extract embeddings:  28%|██▊       | 17/60 [00:01<00:02, 15.87it/s][6/6] extract embeddings:  35%|███▌      | 21/60 [00:01<00:02, 19.28it/s][6/6] extract embeddings:  42%|████▏     | 25/60 [00:02<00:01, 22.82it/s][6/6] extract embeddings:  48%|████▊     | 29/60 [00:02<00:01, 25.18it/s][6/6] extract embeddings:  55%|█████▌    | 33/60 [00:02<00:00, 27.08it/s][6/6] extract embeddings:  62%|██████▏   | 37/60 [00:02<00:00, 28.10it/s][6/6] extract embeddings:  68%|██████▊   | 41/60 [00:02<00:00, 30.13it/s][6/6] extract embeddings:  75%|███████▌  | 45/60 [00:02<00:00, 32.26it/s][6/6] extract embeddings:  82%|████████▏ | 49/60 [00:02<00:00, 32.09it/s][6/6] extract embeddings:  88%|████████▊ | 53/60 [00:02<00:00, 33.07it/s][6/6] extract embeddings:  95%|█████████▌| 57/60 [00:02<00:00, 33.50it/s][6/6] extract embeddings: 100%|██████████| 60/60 [00:03<00:00, 19.16it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  2.19it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.76it/s]clustering:  75%|███████▌  | 3/4 [00:00<00:00,  3.49it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  4.19it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.59it/s]
[NeMo I 2025-04-17 02:18:05 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:18:06 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              77.636608   444.120  ...   6.210036  1.398279
    Harker-ES                       79.798244  2178.782  ...  26.346559  1.209233
    Harker-MN                       79.737875   366.767  ...  17.247182  4.702490
    Longfellow-Block-1              75.529460   492.417  ...   6.838957  1.388855
    TOTAL                           78.912514  3482.086  ...  56.642733  1.626690
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:18:06 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0162 | MISS: 0.7567 | CER: 0.0163 | DER: 0.7891 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.75
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.75 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.68s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.85s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.19s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:18:17 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:18:17 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:18:17 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:18:17 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:18:17 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:18:17 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:18:17 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:18:17 features:305] PADDING: 16
[NeMo I 2025-04-17 02:18:18 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:18:18 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:18:18 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:18:18 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:18:18 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:18 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:18 collections:880] Dataset successfully loaded with 1704 items and total duration provided from manifest is  0.27 hours.
[NeMo I 2025-04-17 02:18:18 collections:886] # 1704 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/27 [00:00<?, ?it/s][1/6] extract embeddings:   4%|▎         | 1/27 [00:01<00:50,  1.95s/it][1/6] extract embeddings:  15%|█▍        | 4/27 [00:02<00:09,  2.49it/s][1/6] extract embeddings:  26%|██▌       | 7/27 [00:02<00:04,  4.84it/s][1/6] extract embeddings:  37%|███▋      | 10/27 [00:02<00:02,  7.49it/s][1/6] extract embeddings:  52%|█████▏    | 14/27 [00:02<00:01, 11.34it/s][1/6] extract embeddings:  63%|██████▎   | 17/27 [00:02<00:00, 14.00it/s][1/6] extract embeddings:  74%|███████▍  | 20/27 [00:02<00:00, 16.73it/s][1/6] extract embeddings:  85%|████████▌ | 23/27 [00:02<00:00, 18.41it/s][1/6] extract embeddings:  96%|█████████▋| 26/27 [00:02<00:00, 20.63it/s][1/6] extract embeddings: 100%|██████████| 27/27 [00:02<00:00,  9.20it/s]
[NeMo I 2025-04-17 02:18:21 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:18:21 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:21 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:21 collections:880] Dataset successfully loaded with 1715 items and total duration provided from manifest is  0.27 hours.
[NeMo I 2025-04-17 02:18:21 collections:886] # 1715 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/27 [00:00<?, ?it/s][2/6] extract embeddings:   4%|▎         | 1/27 [00:01<00:35,  1.38s/it][2/6] extract embeddings:  15%|█▍        | 4/27 [00:01<00:06,  3.43it/s][2/6] extract embeddings:  26%|██▌       | 7/27 [00:01<00:03,  6.45it/s][2/6] extract embeddings:  37%|███▋      | 10/27 [00:01<00:01,  9.62it/s][2/6] extract embeddings:  52%|█████▏    | 14/27 [00:01<00:00, 14.09it/s][2/6] extract embeddings:  63%|██████▎   | 17/27 [00:01<00:00, 16.64it/s][2/6] extract embeddings:  74%|███████▍  | 20/27 [00:02<00:00, 19.11it/s][2/6] extract embeddings:  85%|████████▌ | 23/27 [00:02<00:00, 20.82it/s][2/6] extract embeddings:  96%|█████████▋| 26/27 [00:02<00:00, 22.96it/s][2/6] extract embeddings: 100%|██████████| 27/27 [00:02<00:00, 11.52it/s]
[NeMo I 2025-04-17 02:18:23 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:18:24 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:24 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:24 collections:880] Dataset successfully loaded with 1750 items and total duration provided from manifest is  0.28 hours.
[NeMo I 2025-04-17 02:18:24 collections:886] # 1750 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/28 [00:00<?, ?it/s][3/6] extract embeddings:   4%|▎         | 1/28 [00:01<00:30,  1.12s/it][3/6] extract embeddings:  18%|█▊        | 5/28 [00:01<00:04,  5.16it/s][3/6] extract embeddings:  29%|██▊       | 8/28 [00:01<00:02,  8.44it/s][3/6] extract embeddings:  43%|████▎     | 12/28 [00:01<00:01, 12.91it/s][3/6] extract embeddings:  54%|█████▎    | 15/28 [00:01<00:00, 15.70it/s][3/6] extract embeddings:  64%|██████▍   | 18/28 [00:01<00:00, 18.45it/s][3/6] extract embeddings:  75%|███████▌  | 21/28 [00:01<00:00, 20.64it/s][3/6] extract embeddings:  86%|████████▌ | 24/28 [00:01<00:00, 22.54it/s][3/6] extract embeddings: 100%|██████████| 28/28 [00:02<00:00, 25.10it/s][3/6] extract embeddings: 100%|██████████| 28/28 [00:02<00:00, 13.50it/s]
[NeMo I 2025-04-17 02:18:26 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:18:26 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:26 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:26 collections:880] Dataset successfully loaded with 1846 items and total duration provided from manifest is  0.29 hours.
[NeMo I 2025-04-17 02:18:26 collections:886] # 1846 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/29 [00:00<?, ?it/s][4/6] extract embeddings:   3%|▎         | 1/29 [00:01<00:31,  1.12s/it][4/6] extract embeddings:  14%|█▍        | 4/29 [00:01<00:05,  4.19it/s][4/6] extract embeddings:  24%|██▍       | 7/29 [00:01<00:02,  7.66it/s][4/6] extract embeddings:  34%|███▍      | 10/29 [00:01<00:01, 11.27it/s][4/6] extract embeddings:  45%|████▍     | 13/29 [00:01<00:01, 14.80it/s][4/6] extract embeddings:  55%|█████▌    | 16/29 [00:01<00:00, 17.99it/s][4/6] extract embeddings:  69%|██████▉   | 20/29 [00:01<00:00, 22.11it/s][4/6] extract embeddings:  79%|███████▉  | 23/29 [00:01<00:00, 23.56it/s][4/6] extract embeddings:  93%|█████████▎| 27/29 [00:01<00:00, 25.54it/s][4/6] extract embeddings: 100%|██████████| 29/29 [00:02<00:00, 13.92it/s]
[NeMo I 2025-04-17 02:18:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:18:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:28 collections:880] Dataset successfully loaded with 2127 items and total duration provided from manifest is  0.32 hours.
[NeMo I 2025-04-17 02:18:28 collections:886] # 2127 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/34 [00:00<?, ?it/s][5/6] extract embeddings:   3%|▎         | 1/34 [00:01<00:36,  1.12s/it][5/6] extract embeddings:  15%|█▍        | 5/34 [00:01<00:05,  5.15it/s][5/6] extract embeddings:  24%|██▎       | 8/34 [00:01<00:03,  8.49it/s][5/6] extract embeddings:  32%|███▏      | 11/34 [00:01<00:01, 11.97it/s][5/6] extract embeddings:  44%|████▍     | 15/34 [00:01<00:01, 16.61it/s][5/6] extract embeddings:  53%|█████▎    | 18/34 [00:01<00:00, 19.06it/s][5/6] extract embeddings:  62%|██████▏   | 21/34 [00:01<00:00, 21.38it/s][5/6] extract embeddings:  71%|███████   | 24/34 [00:01<00:00, 23.39it/s][5/6] extract embeddings:  79%|███████▉  | 27/34 [00:01<00:00, 24.60it/s][5/6] extract embeddings:  91%|█████████ | 31/34 [00:02<00:00, 26.15it/s][5/6] extract embeddings: 100%|██████████| 34/34 [00:02<00:00, 15.03it/s]
[NeMo I 2025-04-17 02:18:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:18:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:30 collections:880] Dataset successfully loaded with 3449 items and total duration provided from manifest is  0.38 hours.
[NeMo I 2025-04-17 02:18:30 collections:886] # 3449 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/54 [00:00<?, ?it/s][6/6] extract embeddings:   2%|▏         | 1/54 [00:01<01:00,  1.13s/it][6/6] extract embeddings:  11%|█         | 6/54 [00:01<00:07,  6.18it/s][6/6] extract embeddings:  19%|█▊        | 10/54 [00:01<00:04, 10.49it/s][6/6] extract embeddings:  26%|██▌       | 14/54 [00:01<00:02, 14.45it/s][6/6] extract embeddings:  33%|███▎      | 18/54 [00:01<00:01, 18.42it/s][6/6] extract embeddings:  41%|████      | 22/54 [00:01<00:01, 21.81it/s][6/6] extract embeddings:  48%|████▊     | 26/54 [00:01<00:01, 24.12it/s][6/6] extract embeddings:  56%|█████▌    | 30/54 [00:01<00:00, 26.54it/s][6/6] extract embeddings:  63%|██████▎   | 34/54 [00:02<00:00, 27.28it/s][6/6] extract embeddings:  70%|███████   | 38/54 [00:02<00:00, 29.82it/s][6/6] extract embeddings:  78%|███████▊  | 42/54 [00:02<00:00, 29.52it/s][6/6] extract embeddings:  85%|████████▌ | 46/54 [00:02<00:00, 29.65it/s][6/6] extract embeddings:  93%|█████████▎| 50/54 [00:02<00:00, 30.42it/s][6/6] extract embeddings: 100%|██████████| 54/54 [00:02<00:00, 31.24it/s][6/6] extract embeddings: 100%|██████████| 54/54 [00:02<00:00, 19.37it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.81it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.49it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  3.29it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s]
[NeMo I 2025-04-17 02:18:35 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:18:36 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              80.697683   444.120  ...   7.645035  1.721390
    Harker-ES                       81.767216  2178.782  ...  23.577520  1.082142
    Harker-MN                       79.963330   366.767  ...  15.135176  4.126646
    Longfellow-Block-1              78.831175   492.417  ...  12.201990  2.477979
    TOTAL                           81.025602  3482.086  ...  58.559721  1.681743
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:18:36 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0150 | MISS: 0.7785 | CER: 0.0168 | DER: 0.8103 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.85, offset=0.80
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.85, <class 'float'> offset=0.8 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.78s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.89s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.21s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.14s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:18:47 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:18:47 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:18:47 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:18:47 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:18:47 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:18:47 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:18:47 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:18:47 features:305] PADDING: 16
[NeMo I 2025-04-17 02:18:48 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:18:48 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:18:48 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:18:48 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:18:48 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:48 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:48 collections:880] Dataset successfully loaded with 1661 items and total duration provided from manifest is  0.24 hours.
[NeMo I 2025-04-17 02:18:48 collections:886] # 1661 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/26 [00:00<?, ?it/s][1/6] extract embeddings:   4%|▍         | 1/26 [00:01<00:49,  1.98s/it][1/6] extract embeddings:  15%|█▌        | 4/26 [00:02<00:08,  2.47it/s][1/6] extract embeddings:  27%|██▋       | 7/26 [00:02<00:03,  4.83it/s][1/6] extract embeddings:  38%|███▊      | 10/26 [00:02<00:02,  7.37it/s][1/6] extract embeddings:  50%|█████     | 13/26 [00:02<00:01, 10.04it/s][1/6] extract embeddings:  62%|██████▏   | 16/26 [00:02<00:00, 12.73it/s][1/6] extract embeddings:  73%|███████▎  | 19/26 [00:02<00:00, 15.30it/s][1/6] extract embeddings:  85%|████████▍ | 22/26 [00:02<00:00, 17.38it/s][1/6] extract embeddings: 100%|██████████| 26/26 [00:02<00:00, 21.18it/s][1/6] extract embeddings: 100%|██████████| 26/26 [00:02<00:00,  8.76it/s]
[NeMo I 2025-04-17 02:18:51 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:18:51 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:51 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:51 collections:880] Dataset successfully loaded with 1673 items and total duration provided from manifest is  0.25 hours.
[NeMo I 2025-04-17 02:18:51 collections:886] # 1673 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/27 [00:00<?, ?it/s][2/6] extract embeddings:   4%|▎         | 1/27 [00:01<00:35,  1.36s/it][2/6] extract embeddings:  15%|█▍        | 4/27 [00:01<00:06,  3.50it/s][2/6] extract embeddings:  26%|██▌       | 7/27 [00:01<00:03,  6.59it/s][2/6] extract embeddings:  37%|███▋      | 10/27 [00:01<00:01,  9.87it/s][2/6] extract embeddings:  52%|█████▏    | 14/27 [00:01<00:00, 14.40it/s][2/6] extract embeddings:  63%|██████▎   | 17/27 [00:01<00:00, 16.95it/s][2/6] extract embeddings:  74%|███████▍  | 20/27 [00:02<00:00, 19.40it/s][2/6] extract embeddings:  85%|████████▌ | 23/27 [00:02<00:00, 21.61it/s][2/6] extract embeddings: 100%|██████████| 27/27 [00:02<00:00, 24.55it/s][2/6] extract embeddings: 100%|██████████| 27/27 [00:02<00:00, 11.81it/s]
[NeMo I 2025-04-17 02:18:53 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:18:54 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:54 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:54 collections:880] Dataset successfully loaded with 1699 items and total duration provided from manifest is  0.25 hours.
[NeMo I 2025-04-17 02:18:54 collections:886] # 1699 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/27 [00:00<?, ?it/s][3/6] extract embeddings:   4%|▎         | 1/27 [00:01<00:28,  1.11s/it][3/6] extract embeddings:  15%|█▍        | 4/27 [00:01<00:05,  4.16it/s][3/6] extract embeddings:  26%|██▌       | 7/27 [00:01<00:02,  7.72it/s][3/6] extract embeddings:  41%|████      | 11/27 [00:01<00:01, 12.14it/s][3/6] extract embeddings:  56%|█████▌    | 15/27 [00:01<00:00, 16.34it/s][3/6] extract embeddings:  70%|███████   | 19/27 [00:01<00:00, 19.58it/s][3/6] extract embeddings:  85%|████████▌ | 23/27 [00:01<00:00, 22.47it/s][3/6] extract embeddings:  96%|█████████▋| 26/27 [00:01<00:00, 24.12it/s][3/6] extract embeddings: 100%|██████████| 27/27 [00:02<00:00, 13.33it/s]
[NeMo I 2025-04-17 02:18:56 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:18:56 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:56 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:56 collections:880] Dataset successfully loaded with 1780 items and total duration provided from manifest is  0.27 hours.
[NeMo I 2025-04-17 02:18:56 collections:886] # 1780 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/28 [00:00<?, ?it/s][4/6] extract embeddings:   4%|▎         | 1/28 [00:01<00:31,  1.15s/it][4/6] extract embeddings:  18%|█▊        | 5/28 [00:01<00:04,  5.00it/s][4/6] extract embeddings:  32%|███▏      | 9/28 [00:01<00:02,  9.19it/s][4/6] extract embeddings:  43%|████▎     | 12/28 [00:01<00:01, 12.23it/s][4/6] extract embeddings:  57%|█████▋    | 16/28 [00:01<00:00, 16.44it/s][4/6] extract embeddings:  71%|███████▏  | 20/28 [00:01<00:00, 19.83it/s][4/6] extract embeddings:  82%|████████▏ | 23/28 [00:01<00:00, 21.47it/s][4/6] extract embeddings:  93%|█████████▎| 26/28 [00:02<00:00, 22.88it/s][4/6] extract embeddings: 100%|██████████| 28/28 [00:02<00:00, 13.42it/s]
[NeMo I 2025-04-17 02:18:58 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:18:58 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:18:58 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:18:58 collections:880] Dataset successfully loaded with 2030 items and total duration provided from manifest is  0.29 hours.
[NeMo I 2025-04-17 02:18:58 collections:886] # 2030 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/32 [00:00<?, ?it/s][5/6] extract embeddings:   3%|▎         | 1/32 [00:01<00:34,  1.11s/it][5/6] extract embeddings:  16%|█▌        | 5/32 [00:01<00:05,  5.16it/s][5/6] extract embeddings:  28%|██▊       | 9/32 [00:01<00:02,  9.40it/s][5/6] extract embeddings:  38%|███▊      | 12/32 [00:01<00:01, 12.43it/s][5/6] extract embeddings:  50%|█████     | 16/32 [00:01<00:00, 17.03it/s][5/6] extract embeddings:  59%|█████▉    | 19/32 [00:01<00:00, 19.29it/s][5/6] extract embeddings:  69%|██████▉   | 22/32 [00:01<00:00, 21.46it/s][5/6] extract embeddings:  81%|████████▏ | 26/32 [00:01<00:00, 24.28it/s][5/6] extract embeddings:  94%|█████████▍| 30/32 [00:02<00:00, 27.45it/s][5/6] extract embeddings: 100%|██████████| 32/32 [00:02<00:00, 14.93it/s]
[NeMo I 2025-04-17 02:19:00 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:19:00 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:19:00 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:19:00 collections:880] Dataset successfully loaded with 3201 items and total duration provided from manifest is  0.35 hours.
[NeMo I 2025-04-17 02:19:00 collections:886] # 3201 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/51 [00:00<?, ?it/s][6/6] extract embeddings:   2%|▏         | 1/51 [00:01<00:55,  1.12s/it][6/6] extract embeddings:  10%|▉         | 5/51 [00:01<00:08,  5.26it/s][6/6] extract embeddings:  18%|█▊        | 9/51 [00:01<00:04,  9.71it/s][6/6] extract embeddings:  25%|██▌       | 13/51 [00:01<00:02, 13.99it/s][6/6] extract embeddings:  33%|███▎      | 17/51 [00:01<00:01, 18.28it/s][6/6] extract embeddings:  41%|████      | 21/51 [00:01<00:01, 22.17it/s][6/6] extract embeddings:  49%|████▉     | 25/51 [00:01<00:01, 25.03it/s][6/6] extract embeddings:  57%|█████▋    | 29/51 [00:01<00:00, 27.78it/s][6/6] extract embeddings:  65%|██████▍   | 33/51 [00:02<00:00, 28.94it/s][6/6] extract embeddings:  73%|███████▎  | 37/51 [00:02<00:00, 30.55it/s][6/6] extract embeddings:  80%|████████  | 41/51 [00:02<00:00, 31.28it/s][6/6] extract embeddings:  88%|████████▊ | 45/51 [00:02<00:00, 32.83it/s][6/6] extract embeddings:  96%|█████████▌| 49/51 [00:02<00:00, 33.66it/s][6/6] extract embeddings: 100%|██████████| 51/51 [00:02<00:00, 19.42it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.79it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.60it/s]clustering:  75%|███████▌  | 3/4 [00:00<00:00,  3.49it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.46it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s]
[NeMo I 2025-04-17 02:19:04 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:19:05 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              80.557027   444.120  ...   6.390010  1.438803
    Harker-ES                       83.754273  2178.782  ...  26.956976  1.237250
    Harker-MN                       81.852815   366.767  ...  13.114128  3.575602
    Longfellow-Block-1              78.913400   492.417  ...   5.516977  1.120387
    TOTAL                           82.461634  3482.086  ...  51.978091  1.492729
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:19:05 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0132 | MISS: 0.7965 | CER: 0.0149 | DER: 0.8246 | Spk. Count Acc. 1.0000
    
--------------------------------------------------
Running with alpha=1.0, onset=0.90, offset=0.80
--------------------------------------------------
Loaded 4 lines from /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
Starting VAD segmentation...
USING: onset:0.9, <class 'float'> offset=0.8 <class 'float'>
Processing Audio:   0%|          | 0/4 [00:00<?, ?it/s][0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
[0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
COMB: [0.8426 0.6179 0.465  ... 0.3614 0.0502 0.1702]
Processing Audio:  25%|██▌       | 1/4 [00:01<00:05,  1.69s/it][6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
[6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
COMB: [6.093e-01 2.670e-01 5.309e-01 ... 1.750e-02 3.000e-04 2.149e-01]
Processing Audio:  50%|█████     | 2/4 [00:03<00:03,  1.86s/it][0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
[0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
COMB: [0.0034 0.0062 0.0267 ... 0.5529 0.5152 0.6555]
Processing Audio:  75%|███████▌  | 3/4 [00:04<00:01,  1.20s/it][0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
[0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
COMB: [0.0988 0.0435 0.028  ... 0.8743 0.8347 0.8165]
Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.13it/s]Processing Audio: 100%|██████████| 4/4 [00:04<00:00,  1.12s/it]
VAD segmentation complete.
[rank: 0] Seed set to 42
[NeMo I 2025-04-17 02:19:16 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_2s_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-17 02:19:16 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-17 02:19:16 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-17 02:19:16 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-17 02:19:16 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-17 02:19:16 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-17 02:19:16 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-17 02:19:16 features:305] PADDING: 16
[NeMo I 2025-04-17 02:19:17 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-17 02:19:17 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-17 02:19:17 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-17 02:19:17 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-17 02:19:17 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:19:17 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:19:17 collections:880] Dataset successfully loaded with 1590 items and total duration provided from manifest is  0.22 hours.
[NeMo I 2025-04-17 02:19:17 collections:886] # 1590 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/25 [00:00<?, ?it/s][1/6] extract embeddings:   4%|▍         | 1/25 [00:02<00:54,  2.28s/it][1/6] extract embeddings:  16%|█▌        | 4/25 [00:02<00:09,  2.18it/s][1/6] extract embeddings:  28%|██▊       | 7/25 [00:02<00:04,  4.26it/s][1/6] extract embeddings:  40%|████      | 10/25 [00:02<00:02,  6.72it/s][1/6] extract embeddings:  52%|█████▏    | 13/25 [00:02<00:01,  9.48it/s][1/6] extract embeddings:  64%|██████▍   | 16/25 [00:02<00:00, 12.27it/s][1/6] extract embeddings:  76%|███████▌  | 19/25 [00:02<00:00, 14.88it/s][1/6] extract embeddings:  88%|████████▊ | 22/25 [00:03<00:00, 17.20it/s][1/6] extract embeddings: 100%|██████████| 25/25 [00:03<00:00,  7.82it/s]
[NeMo I 2025-04-17 02:19:20 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-17 02:19:20 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:19:20 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:19:20 collections:880] Dataset successfully loaded with 1599 items and total duration provided from manifest is  0.22 hours.
[NeMo I 2025-04-17 02:19:20 collections:886] # 1599 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/25 [00:00<?, ?it/s][2/6] extract embeddings:   4%|▍         | 1/25 [00:01<00:32,  1.36s/it][2/6] extract embeddings:  16%|█▌        | 4/25 [00:01<00:06,  3.49it/s][2/6] extract embeddings:  28%|██▊       | 7/25 [00:01<00:02,  6.50it/s][2/6] extract embeddings:  40%|████      | 10/25 [00:01<00:01,  9.84it/s][2/6] extract embeddings:  56%|█████▌    | 14/25 [00:01<00:00, 14.16it/s][2/6] extract embeddings:  72%|███████▏  | 18/25 [00:01<00:00, 17.86it/s][2/6] extract embeddings:  84%|████████▍ | 21/25 [00:02<00:00, 20.14it/s][2/6] extract embeddings: 100%|██████████| 25/25 [00:02<00:00, 23.10it/s][2/6] extract embeddings: 100%|██████████| 25/25 [00:02<00:00, 11.25it/s]
[NeMo I 2025-04-17 02:19:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-17 02:19:23 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:19:23 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:19:23 collections:880] Dataset successfully loaded with 1621 items and total duration provided from manifest is  0.23 hours.
[NeMo I 2025-04-17 02:19:23 collections:886] # 1621 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/26 [00:00<?, ?it/s][3/6] extract embeddings:   4%|▍         | 1/26 [00:01<00:27,  1.12s/it][3/6] extract embeddings:  19%|█▉        | 5/26 [00:01<00:04,  5.17it/s][3/6] extract embeddings:  35%|███▍      | 9/26 [00:01<00:01,  9.45it/s][3/6] extract embeddings:  46%|████▌     | 12/26 [00:01<00:01, 12.61it/s][3/6] extract embeddings:  58%|█████▊    | 15/26 [00:01<00:00, 15.29it/s][3/6] extract embeddings:  69%|██████▉   | 18/26 [00:01<00:00, 18.24it/s][3/6] extract embeddings:  85%|████████▍ | 22/26 [00:01<00:00, 21.77it/s][3/6] extract embeddings: 100%|██████████| 26/26 [00:01<00:00, 25.07it/s][3/6] extract embeddings: 100%|██████████| 26/26 [00:01<00:00, 13.14it/s]
[NeMo I 2025-04-17 02:19:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-17 02:19:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:19:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:19:25 collections:880] Dataset successfully loaded with 1693 items and total duration provided from manifest is  0.24 hours.
[NeMo I 2025-04-17 02:19:25 collections:886] # 1693 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/27 [00:00<?, ?it/s][4/6] extract embeddings:   4%|▎         | 1/27 [00:01<00:29,  1.12s/it][4/6] extract embeddings:  19%|█▊        | 5/27 [00:01<00:04,  5.21it/s][4/6] extract embeddings:  33%|███▎      | 9/27 [00:01<00:01,  9.60it/s][4/6] extract embeddings:  44%|████▍     | 12/27 [00:01<00:01, 12.73it/s][4/6] extract embeddings:  59%|█████▉    | 16/27 [00:01<00:00, 16.90it/s][4/6] extract embeddings:  74%|███████▍  | 20/27 [00:01<00:00, 20.55it/s][4/6] extract embeddings:  85%|████████▌ | 23/27 [00:01<00:00, 22.04it/s][4/6] extract embeddings:  96%|█████████▋| 26/27 [00:01<00:00, 23.37it/s][4/6] extract embeddings: 100%|██████████| 27/27 [00:01<00:00, 13.53it/s]
[NeMo I 2025-04-17 02:19:27 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-17 02:19:27 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:19:27 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:19:27 collections:880] Dataset successfully loaded with 1901 items and total duration provided from manifest is  0.26 hours.
[NeMo I 2025-04-17 02:19:27 collections:886] # 1901 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][5/6] extract embeddings:   3%|▎         | 1/30 [00:01<00:32,  1.12s/it][5/6] extract embeddings:  17%|█▋        | 5/30 [00:01<00:04,  5.21it/s][5/6] extract embeddings:  30%|███       | 9/30 [00:01<00:02,  9.58it/s][5/6] extract embeddings:  43%|████▎     | 13/30 [00:01<00:01, 13.87it/s][5/6] extract embeddings:  57%|█████▋    | 17/30 [00:01<00:00, 17.58it/s][5/6] extract embeddings:  67%|██████▋   | 20/30 [00:01<00:00, 19.77it/s][5/6] extract embeddings:  80%|████████  | 24/30 [00:01<00:00, 22.94it/s][5/6] extract embeddings:  93%|█████████▎| 28/30 [00:01<00:00, 25.51it/s][5/6] extract embeddings: 100%|██████████| 30/30 [00:02<00:00, 14.53it/s]
[NeMo I 2025-04-17 02:19:29 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-17 02:19:29 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-17 02:19:29 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-17 02:19:29 collections:880] Dataset successfully loaded with 2935 items and total duration provided from manifest is  0.31 hours.
[NeMo I 2025-04-17 02:19:29 collections:886] # 2935 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][6/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:50,  1.12s/it][6/6] extract embeddings:  11%|█         | 5/46 [00:01<00:07,  5.26it/s][6/6] extract embeddings:  20%|█▉        | 9/46 [00:01<00:03,  9.72it/s][6/6] extract embeddings:  28%|██▊       | 13/46 [00:01<00:02, 14.01it/s][6/6] extract embeddings:  37%|███▋      | 17/46 [00:01<00:01, 17.85it/s][6/6] extract embeddings:  46%|████▌     | 21/46 [00:01<00:01, 21.23it/s][6/6] extract embeddings:  54%|█████▍    | 25/46 [00:01<00:00, 24.36it/s][6/6] extract embeddings:  63%|██████▎   | 29/46 [00:01<00:00, 27.36it/s][6/6] extract embeddings:  72%|███████▏  | 33/46 [00:02<00:00, 28.67it/s][6/6] extract embeddings:  80%|████████  | 37/46 [00:02<00:00, 30.25it/s][6/6] extract embeddings:  89%|████████▉ | 41/46 [00:02<00:00, 32.56it/s][6/6] extract embeddings:  98%|█████████▊| 45/46 [00:02<00:00, 33.14it/s][6/6] extract embeddings: 100%|██████████| 46/46 [00:02<00:00, 18.56it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:01,  1.93it/s]clustering:  50%|█████     | 2/4 [00:00<00:00,  2.82it/s]clustering:  75%|███████▌  | 3/4 [00:00<00:00,  3.70it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.75it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.36it/s]
[NeMo I 2025-04-17 02:19:33 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-17 02:19:34 der:208] 
                       diarization error rate     total  ...  confusion          
                                            %            ...                    %
    item                                                 ...                     
    Longfellow-Block-2              83.349045   444.120  ...   7.010011  1.578405
    Harker-ES                       85.443593  2178.782  ...  29.908793  1.372730
    Harker-MN                       82.256305   366.767  ...  12.326173  3.360764
    Longfellow-Block-1              83.318622   492.417  ...  17.402884  3.534176
    TOTAL                           84.540228  3482.086  ...  66.647861  1.914021
    
    [5 rows x 10 columns]
[NeMo I 2025-04-17 02:19:34 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0120 | MISS: 0.8143 | CER: 0.0191 | DER: 0.8454 | Spk. Count Acc. 1.0000
    
All experiments completed. Results stored in DER_results.txt.
###############################
end time: 2025-04-17 02:19:37.615684
elapsed time: 1:41:35.747964
