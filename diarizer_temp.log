[rank: 0] Seed set to 42
[NeMo I 2025-04-18 09:18:21 offline_diar_infer:41] Hydra config: name: ClusterDiarizer
    num_workers: 1
    sample_rate: 16000
    batch_size: 64
    device: null
    verbose: true
    diarizer:
      manifest_filepath: /nlp/scr/askhan1/clipped_umd/UMD_clipped_test_manifest_all_speaker_noisy.json
      out_dir: diarization_output
      oracle_vad: false
      collar: 0.25
      ignore_overlap: true
      vad:
        model_path: null
        external_vad_manifest: ./vad_outs.json
        parameters:
          window_length_in_sec: 0.63
          shift_length_in_sec: 0.01
          smoothing: false
          overlap: 0.5
          onset: 0.9
          offset: 0.5
          pad_onset: 0
          pad_offset: 0
          min_duration_on: 0
          min_duration_off: 0.6
          filter_speech_first: true
      speaker_embeddings:
        model_path: titanet_large
        parameters:
          window_length_in_sec:
          - 3.0
          - 2.5
          - 2.0
          - 1.5
          - 1.0
          - 0.5
          shift_length_in_sec:
          - 1.5
          - 1.25
          - 1.0
          - 0.75
          - 0.5
          - 0.25
          multiscale_weights:
          - 1
          - 1
          - 1
          - 1
          - 1
          - 1
          save_embeddings: false
      clustering:
        parameters:
          oracle_num_speakers: true
          max_num_speakers: 8
          enhanced_count_thres: 80
          max_rp_threshold: 0.25
          sparse_search_volume: 30
          maj_vote_spk_count: false
          chunk_cluster_count: 50
          embeddings_per_chunk: 10000
      msdd_model:
        model_path: null
        parameters:
          use_speaker_model_from_ckpt: true
          infer_batch_size: 25
          sigmoid_threshold:
          - 0.7
          seq_eval_mode: false
          split_infer: true
          diar_window_length: 50
          overlap_infer_spk_limit: 5
      asr:
        model_path: stt_en_quartznet15x5
        parameters:
          asr_based_vad: false
          asr_based_vad_threshold: 1.0
          asr_batch_size: null
          decoder_delay_in_sec: null
          word_ts_anchor_offset: null
          word_ts_anchor_pos: start
          fix_word_ts_with_VAD: false
          colored_text: false
          print_time: true
          break_lines: false
        ctc_decoder_parameters:
          pretrained_language_model: null
          beam_width: 256
          alpha: 2.0
          beta: 1.5
        realigning_lm_parameters:
          arpa_language_model: null
          min_number_of_words: 1
          max_number_of_words: 25
          logprob_diff_threshold: 1.2
    
[NeMo I 2025-04-18 09:18:21 clustering_diarizer:150] Loading pretrained titanet_large model from NGC
[NeMo I 2025-04-18 09:18:21 cloud:58] Found existing object /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo I 2025-04-18 09:18:21 cloud:64] Re-using file from: /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo
[NeMo I 2025-04-18 09:18:21 common:826] Instantiating model from pre-trained checkpoint
[NeMo W 2025-04-18 09:18:21 modelPT:176] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/train.json
    sample_rate: 16000
    labels: null
    batch_size: 64
    shuffle: true
    is_tarred: false
    tarred_audio_filepaths: null
    tarred_shard_strategy: scatter
    augmentor:
      noise:
        manifest_path: /manifests/noise/rir_noise_manifest.json
        prob: 0.5
        min_snr_db: 0
        max_snr_db: 15
      speed:
        prob: 0.5
        sr: 16000
        resample_type: kaiser_fast
        min_speed_rate: 0.95
        max_speed_rate: 1.05
    num_workers: 15
    pin_memory: true
    
[NeMo W 2025-04-18 09:18:21 modelPT:183] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    manifest_filepath: /manifests/combined_fisher_swbd_voxceleb12_librispeech/dev.json
    sample_rate: 16000
    labels: null
    batch_size: 128
    shuffle: false
    num_workers: 15
    pin_memory: true
    
[NeMo I 2025-04-18 09:18:21 features:305] PADDING: 16
[NeMo I 2025-04-18 09:18:22 save_restore_connector:275] Model EncDecSpeakerLabelModel was successfully restored from /sailhome/askhan1/.cache/torch/NeMo/NeMo_2.2.0/titanet-l/11ba0924fdf87c049e339adbf6899d48/titanet-l.nemo.
[NeMo W 2025-04-18 09:18:22 clustering_diarizer:398] Deleting previous clustering diarizer outputs.
[NeMo I 2025-04-18 09:18:22 speaker_utils:92] Number of files to diarize: 4
[NeMo I 2025-04-18 09:18:22 clustering_diarizer:281] Subsegmentation for embedding extraction: scale0, diarization_output/speaker_outputs/subsegments_scale0.json
[NeMo I 2025-04-18 09:18:22 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-18 09:18:22 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-18 09:18:22 collections:880] Dataset successfully loaded with 1590 items and total duration provided from manifest is  0.22 hours.
[NeMo I 2025-04-18 09:18:22 collections:886] # 1590 files loaded accounting to # 1 labels
[1/6] extract embeddings:   0%|          | 0/25 [00:00<?, ?it/s][1/6] extract embeddings:   4%|▍         | 1/25 [00:02<00:48,  2.04s/it][1/6] extract embeddings:  16%|█▌        | 4/25 [00:02<00:08,  2.41it/s][1/6] extract embeddings:  24%|██▍       | 6/25 [00:02<00:04,  3.90it/s][1/6] extract embeddings:  36%|███▌      | 9/25 [00:02<00:02,  6.55it/s][1/6] extract embeddings:  48%|████▊     | 12/25 [00:02<00:01,  9.28it/s][1/6] extract embeddings:  60%|██████    | 15/25 [00:02<00:00, 11.94it/s][1/6] extract embeddings:  72%|███████▏  | 18/25 [00:02<00:00, 13.65it/s][1/6] extract embeddings:  84%|████████▍ | 21/25 [00:02<00:00, 15.33it/s][1/6] extract embeddings:  96%|█████████▌| 24/25 [00:03<00:00, 17.80it/s][1/6] extract embeddings: 100%|██████████| 25/25 [00:03<00:00,  8.04it/s]
[NeMo I 2025-04-18 09:18:25 clustering_diarizer:281] Subsegmentation for embedding extraction: scale1, diarization_output/speaker_outputs/subsegments_scale1.json
[NeMo I 2025-04-18 09:18:25 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-18 09:18:25 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-18 09:18:25 collections:880] Dataset successfully loaded with 1599 items and total duration provided from manifest is  0.22 hours.
[NeMo I 2025-04-18 09:18:25 collections:886] # 1599 files loaded accounting to # 1 labels
[2/6] extract embeddings:   0%|          | 0/25 [00:00<?, ?it/s][2/6] extract embeddings:   4%|▍         | 1/25 [00:01<00:34,  1.45s/it][2/6] extract embeddings:  16%|█▌        | 4/25 [00:01<00:06,  3.26it/s][2/6] extract embeddings:  28%|██▊       | 7/25 [00:01<00:03,  5.99it/s][2/6] extract embeddings:  44%|████▍     | 11/25 [00:01<00:01, 10.14it/s][2/6] extract embeddings:  56%|█████▌    | 14/25 [00:01<00:00, 12.87it/s][2/6] extract embeddings:  68%|██████▊   | 17/25 [00:02<00:00, 13.92it/s][2/6] extract embeddings:  80%|████████  | 20/25 [00:02<00:00, 15.74it/s][2/6] extract embeddings:  92%|█████████▏| 23/25 [00:02<00:00, 17.22it/s][2/6] extract embeddings: 100%|██████████| 25/25 [00:02<00:00,  9.83it/s]
[NeMo I 2025-04-18 09:18:28 clustering_diarizer:281] Subsegmentation for embedding extraction: scale2, diarization_output/speaker_outputs/subsegments_scale2.json
[NeMo I 2025-04-18 09:18:28 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-18 09:18:28 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-18 09:18:28 collections:880] Dataset successfully loaded with 1621 items and total duration provided from manifest is  0.23 hours.
[NeMo I 2025-04-18 09:18:28 collections:886] # 1621 files loaded accounting to # 1 labels
[3/6] extract embeddings:   0%|          | 0/26 [00:00<?, ?it/s][3/6] extract embeddings:   4%|▍         | 1/26 [00:01<00:29,  1.18s/it][3/6] extract embeddings:  15%|█▌        | 4/26 [00:01<00:05,  3.83it/s][3/6] extract embeddings:  27%|██▋       | 7/26 [00:01<00:02,  7.09it/s][3/6] extract embeddings:  38%|███▊      | 10/26 [00:01<00:01, 10.41it/s][3/6] extract embeddings:  50%|█████     | 13/26 [00:01<00:00, 13.14it/s][3/6] extract embeddings:  62%|██████▏   | 16/26 [00:01<00:00, 14.69it/s][3/6] extract embeddings:  73%|███████▎  | 19/26 [00:01<00:00, 16.16it/s][3/6] extract embeddings:  85%|████████▍ | 22/26 [00:02<00:00, 17.56it/s][3/6] extract embeddings:  96%|█████████▌| 25/26 [00:02<00:00, 18.65it/s][3/6] extract embeddings: 100%|██████████| 26/26 [00:02<00:00, 11.19it/s]
[NeMo I 2025-04-18 09:18:30 clustering_diarizer:281] Subsegmentation for embedding extraction: scale3, diarization_output/speaker_outputs/subsegments_scale3.json
[NeMo I 2025-04-18 09:18:30 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-18 09:18:30 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-18 09:18:30 collections:880] Dataset successfully loaded with 1693 items and total duration provided from manifest is  0.24 hours.
[NeMo I 2025-04-18 09:18:30 collections:886] # 1693 files loaded accounting to # 1 labels
[4/6] extract embeddings:   0%|          | 0/27 [00:00<?, ?it/s][4/6] extract embeddings:   4%|▎         | 1/27 [00:01<00:31,  1.22s/it][4/6] extract embeddings:  15%|█▍        | 4/27 [00:01<00:06,  3.71it/s][4/6] extract embeddings:  26%|██▌       | 7/27 [00:01<00:02,  6.82it/s][4/6] extract embeddings:  41%|████      | 11/27 [00:01<00:01, 11.46it/s][4/6] extract embeddings:  52%|█████▏    | 14/27 [00:01<00:00, 13.45it/s][4/6] extract embeddings:  63%|██████▎   | 17/27 [00:01<00:00, 15.22it/s][4/6] extract embeddings:  74%|███████▍  | 20/27 [00:02<00:00, 16.47it/s][4/6] extract embeddings:  85%|████████▌ | 23/27 [00:02<00:00, 17.60it/s][4/6] extract embeddings:  96%|█████████▋| 26/27 [00:02<00:00, 18.70it/s][4/6] extract embeddings: 100%|██████████| 27/27 [00:02<00:00, 11.24it/s]
[NeMo I 2025-04-18 09:18:33 clustering_diarizer:281] Subsegmentation for embedding extraction: scale4, diarization_output/speaker_outputs/subsegments_scale4.json
[NeMo I 2025-04-18 09:18:33 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-18 09:18:33 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-18 09:18:33 collections:880] Dataset successfully loaded with 1901 items and total duration provided from manifest is  0.26 hours.
[NeMo I 2025-04-18 09:18:33 collections:886] # 1901 files loaded accounting to # 1 labels
[5/6] extract embeddings:   0%|          | 0/30 [00:00<?, ?it/s][5/6] extract embeddings:   3%|▎         | 1/30 [00:01<00:34,  1.19s/it][5/6] extract embeddings:  13%|█▎        | 4/30 [00:01<00:06,  3.84it/s][5/6] extract embeddings:  23%|██▎       | 7/30 [00:01<00:03,  7.21it/s][5/6] extract embeddings:  37%|███▋      | 11/30 [00:01<00:01, 11.93it/s][5/6] extract embeddings:  50%|█████     | 15/30 [00:01<00:00, 15.47it/s][5/6] extract embeddings:  60%|██████    | 18/30 [00:01<00:00, 16.76it/s][5/6] extract embeddings:  70%|███████   | 21/30 [00:01<00:00, 17.69it/s][5/6] extract embeddings:  80%|████████  | 24/30 [00:02<00:00, 18.74it/s][5/6] extract embeddings:  90%|█████████ | 27/30 [00:02<00:00, 19.67it/s][5/6] extract embeddings: 100%|██████████| 30/30 [00:02<00:00, 19.75it/s][5/6] extract embeddings: 100%|██████████| 30/30 [00:02<00:00, 12.27it/s]
[NeMo I 2025-04-18 09:18:39 clustering_diarizer:281] Subsegmentation for embedding extraction: scale5, diarization_output/speaker_outputs/subsegments_scale5.json
[NeMo I 2025-04-18 09:18:39 clustering_diarizer:337] Extracting embeddings for Diarization
[NeMo I 2025-04-18 09:18:39 collections:879] Filtered duration for loading collection is  0.00 hours.
[NeMo I 2025-04-18 09:18:39 collections:880] Dataset successfully loaded with 2935 items and total duration provided from manifest is  0.31 hours.
[NeMo I 2025-04-18 09:18:39 collections:886] # 2935 files loaded accounting to # 1 labels
[6/6] extract embeddings:   0%|          | 0/46 [00:00<?, ?it/s][6/6] extract embeddings:   2%|▏         | 1/46 [00:01<00:57,  1.28s/it][6/6] extract embeddings:   9%|▊         | 4/46 [00:01<00:11,  3.59it/s][6/6] extract embeddings:  15%|█▌        | 7/46 [00:01<00:05,  6.54it/s][6/6] extract embeddings:  24%|██▍       | 11/46 [00:01<00:03, 10.93it/s][6/6] extract embeddings:  33%|███▎      | 15/46 [00:01<00:01, 15.52it/s][6/6] extract embeddings:  41%|████▏     | 19/46 [00:01<00:01, 19.54it/s][6/6] extract embeddings:  50%|█████     | 23/46 [00:02<00:01, 21.96it/s][6/6] extract embeddings:  57%|█████▋    | 26/46 [00:02<00:00, 21.64it/s][6/6] extract embeddings:  63%|██████▎   | 29/46 [00:02<00:00, 21.41it/s][6/6] extract embeddings:  70%|██████▉   | 32/46 [00:02<00:00, 20.48it/s][6/6] extract embeddings:  76%|███████▌  | 35/46 [00:02<00:00, 20.95it/s][6/6] extract embeddings:  83%|████████▎ | 38/46 [00:02<00:00, 22.26it/s][6/6] extract embeddings:  89%|████████▉ | 41/46 [00:02<00:00, 23.07it/s][6/6] extract embeddings:  96%|█████████▌| 44/46 [00:02<00:00, 22.86it/s][6/6] extract embeddings: 100%|██████████| 46/46 [00:03<00:00, 14.76it/s]
clustering:   0%|          | 0/4 [00:00<?, ?it/s]clustering:  25%|██▌       | 1/4 [00:00<00:02,  1.20it/s]clustering:  50%|█████     | 2/4 [00:01<00:00,  2.12it/s]clustering:  75%|███████▌  | 3/4 [00:01<00:00,  2.61it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s]clustering: 100%|██████████| 4/4 [00:01<00:00,  2.58it/s]
[NeMo I 2025-04-18 09:19:04 clustering_diarizer:451] Outputs are saved in /juice2/scr2/askhan1/post_edm_inference/edm25-nemo-classroom-diarization/diarization_output directory
[NeMo I 2025-04-18 09:19:04 der:182] Wrong Spk. Count with uniq_id:...ow-Block-1, Ref: 17, Hyp: 18
[NeMo I 2025-04-18 09:19:04 der:208] 
                       diarization error rate     total  ...   confusion           
                                            %            ...                      %
    item                                                 ...                       
    Longfellow-Block-1              92.749009   492.417  ...   63.839718  12.964564
    Harker-MN                       93.762751   366.767  ...   54.528021  14.867210
    Longfellow-Block-2              93.379004   444.120  ...   51.555065  11.608364
    Harker-ES                       91.517705  2178.782  ...  162.250470   7.446843
    TOTAL                           92.165697  3482.086  ...  332.173274   9.539491
    
    [5 rows x 10 columns]
[NeMo I 2025-04-18 09:19:04 der:209] Cumulative Results for collar 0.25 sec and ignore_overlap True: 
    | FA: 0.0120 | MISS: 0.8143 | CER: 0.0954 | DER: 0.9217 | Spk. Count Acc. 0.7500
    
